<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <title>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSA | Van1shçš„å°å±‹</title>
  <meta name="keywords" content=" Rsa ">
  <meta name="description" content="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSA | Van1shçš„å°å±‹">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="&amp;emsp;&amp;emsp; Van1shï¼Œä¹Ÿç”¨IDï¼šVã€Vanishï¼Œä¸»è¦æ˜¯æœ‰çš„ç½‘ç«™æ˜µç§°è‡³å°‘ä¸¤ä¸ªå­—ç¬¦ï¼ŒVanishä¹Ÿå®¹æ˜“è¢«æ³¨å†Œ&amp;emsp;ç°å°±è¯»äºæ­å·ç”µå­ç§‘æŠ€å¤§å­¦ã€‚æ˜¯ä¸€åªç©¶æå¤§èœé¸¡åŠ æ‡’ç‹—ã€‚è‡ª2019.2.14çš„2019Hctf-Gameæ¥è§¦CTFï¼Œç”±äºé›¶åŸºç¡€ï¼Œç›®å‰è¿˜èœçš„ä¸€æ‰¹ï¼Œå¯èƒ½è¿˜ä¼šç»§ç»­èœä¸‹å»ã€‚ç°åœ¨è¿˜åªä¼šåšä¸€ç‚¹Cryptoæ–¹å‘çš„é¢˜ï¼Œå…¶ä»–ä»€ä¹ˆWebï¼ŒPwnï¼ŒReverse, Miscâ€¦.ä¿ºéƒ½ä¸çŸ¥é“ã€‚">
<meta property="og:type" content="website">
<meta property="og:title" content="Van1shçš„å°å±‹">
<meta property="og:url" content="http://jayxv.github.io/about/index.html">
<meta property="og:site_name" content="Van1shçš„å°å±‹">
<meta property="og:description" content="&amp;emsp;&amp;emsp; Van1shï¼Œä¹Ÿç”¨IDï¼šVã€Vanishï¼Œä¸»è¦æ˜¯æœ‰çš„ç½‘ç«™æ˜µç§°è‡³å°‘ä¸¤ä¸ªå­—ç¬¦ï¼ŒVanishä¹Ÿå®¹æ˜“è¢«æ³¨å†Œ&amp;emsp;ç°å°±è¯»äºæ­å·ç”µå­ç§‘æŠ€å¤§å­¦ã€‚æ˜¯ä¸€åªç©¶æå¤§èœé¸¡åŠ æ‡’ç‹—ã€‚è‡ª2019.2.14çš„2019Hctf-Gameæ¥è§¦CTFï¼Œç”±äºé›¶åŸºç¡€ï¼Œç›®å‰è¿˜èœçš„ä¸€æ‰¹ï¼Œå¯èƒ½è¿˜ä¼šç»§ç»­èœä¸‹å»ã€‚ç°åœ¨è¿˜åªä¼šåšä¸€ç‚¹Cryptoæ–¹å‘çš„é¢˜ï¼Œå…¶ä»–ä»€ä¹ˆWebï¼ŒPwnï¼ŒReverse, Miscâ€¦.ä¿ºéƒ½ä¸çŸ¥é“ã€‚">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-04-30T11:44:34.852Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Van1shçš„å°å±‹">
<meta name="twitter:description" content="&amp;emsp;&amp;emsp; Van1shï¼Œä¹Ÿç”¨IDï¼šVã€Vanishï¼Œä¸»è¦æ˜¯æœ‰çš„ç½‘ç«™æ˜µç§°è‡³å°‘ä¸¤ä¸ªå­—ç¬¦ï¼ŒVanishä¹Ÿå®¹æ˜“è¢«æ³¨å†Œ&amp;emsp;ç°å°±è¯»äºæ­å·ç”µå­ç§‘æŠ€å¤§å­¦ã€‚æ˜¯ä¸€åªç©¶æå¤§èœé¸¡åŠ æ‡’ç‹—ã€‚è‡ª2019.2.14çš„2019Hctf-Gameæ¥è§¦CTFï¼Œç”±äºé›¶åŸºç¡€ï¼Œç›®å‰è¿˜èœçš„ä¸€æ‰¹ï¼Œå¯èƒ½è¿˜ä¼šç»§ç»­èœä¸‹å»ã€‚ç°åœ¨è¿˜åªä¼šåšä¸€ç‚¹Cryptoæ–¹å‘çš„é¢˜ï¼Œå…¶ä»–ä»€ä¹ˆWebï¼ŒPwnï¼ŒReverse, Miscâ€¦.ä¿ºéƒ½ä¸çŸ¥é“ã€‚">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/sublime.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1"></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

<script src="/js/iconfont.js?v=1.0.1"></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value>
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>Van1sh</span>
</div>

<div class="icon">
    
        
    
        
        <a title="github" href="https://github.com/JayxV" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
        <a title="email" href="mailto:643713081@qq.com" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-email"></use>
                </svg>
            
        </a>
        
    
        
        <a title="qq" href="http://wpa.qq.com/msgrd?v=3&uin=643713081&site=qq&menu=yes" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-qq"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
</div>




<ul>
    <li><div class="all active">å…¨éƒ¨æ–‡ç« <small>(25)</small></div></li>
    
        
            
            <li><div data-rel="æ¯”èµ›å°å±‹">æ¯”èµ›å°å±‹<small>(8)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="å·¥å…·å°å±‹">å·¥å…·å°å±‹<small>(5)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="å¯†ç å°å±‹"><i class="fold iconfont icon-right"></i>å¯†ç å°å±‹<small>(9)</small></div>
                
                    <ul class="sub hide">
                        
                        <li><div data-rel="Paillier">Paillier<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="ECC">ECC<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Lattice">Lattice<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Stream">Stream<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Rsa">Rsa<small>(2)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Block">Block<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="Basic">Basic<small>(1)</small></div>
                            
                        </li>
                            
                        <li><div data-rel="RSA">RSA<small>(1)</small></div>
                            
                        </li>
                            
                    </ul>
                
            </li>
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
            <li><div data-rel="ç§äººå°å±‹">ç§äººå°å±‹<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="å°ä¹¦å±‹">å°ä¹¦å±‹<small>(1)</small></div>
                
            </li>
            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">å…³äº</a><a style="width: 50%"  class="friends">å‹é“¾</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="25">
<input type="hidden" id="yelog_site_word_count" value="105.8k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        å‹æƒ…é“¾æ¥
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://www.fzwjscj.xyz/">fzwjscj</a></li>
            
            <li><a target="_blank" href="http://dldxz.cn/">DLDXZ</a></li>
            
            <li><a target="_blank" href="http://fanda.cloud/">fanda</a></li>
            
            <li><a target="_blank" href="http://passingfoam.com/">PassingFoam&#39;s blog</a></li>
            
            <li><a target="_blank" href="https://eqqie.cn/">èµ¤é“ä¼é¹…</a></li>
            
            <li><a target="_blank" href="http://blog.ragdoll.work/">å’²å¤œå—æ¢¦</a></li>
            
            <li><a target="_blank" href="https://www.zhaoj.in/">glzjin</a></li>
            
            <li><a target="_blank" href="https://coinc1dens.github.io/">Coinc1dens</a></li>
            
            <li><a target="_blank" href="http://blog.soreatu.com/">soreatu</a></li>
            
            <li><a target="_blank" href="http://www.ga1axy.top/">ç›–ä¹å¸Œ</a></li>
            
            <li><a target="_blank" href="https://shawroot.cc/">Root.</a></li>
            
            <li><a target="_blank" href="https://l1near.top/">l1near</a></li>
            
            <li><a target="_blank" href="https://0xdktb.top/">0xDktb</a></li>
            
            <li><a target="_blank" href="https://www.wootec.top/">Reverier</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode === 13){return false;}">
        <input id="local-search-input" class="search" type="text" placeholder="ä»¥ in: å¼€å¤´è¿›è¡Œå…¨æ–‡æœç´¢" />
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a class="color4">Write Up</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">Sage</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">docker</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Paillier</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">ECC</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">Lattice</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Dsa</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">LCG</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Rc4</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">SM4</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">Rsa</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">python</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">æ“ä½œæ¨¡å¼</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color2">Abstract algebra</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">private</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">Nmap</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color1">Linux</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">book</a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        <a id="top" class=""
           href="/2020/05/03/å¾…åŠäº‹é¡¹/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Van1sh çš„ å¾…åŠäº‹é¡¹">Van1sh çš„ å¾…åŠäº‹é¡¹</span>
            <span class="post-date" title="2020-05-03 13:18:35">2020/05/03</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ RSA "
           href="/2020/05/20/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹RSA/"
           data-tag="Rsa"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSA">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSA</span>
            <span class="post-date" title="2020-05-20 20:40:00">2020/05/20</span>
        </a>
        
        <a  class="å·¥å…·å°å±‹ "
           href="/2020/05/20/sageå¸¸ç”¨å‘½ä»¤/"
           data-tag="Sage"
           data-author="" >
            <span class="post-title" title="sageå¸¸ç”¨å‘½ä»¤">sageå¸¸ç”¨å‘½ä»¤</span>
            <span class="post-date" title="2020-05-20 11:22:00">2020/05/20</span>
        </a>
        
        <a  class="æ¯”èµ›å°å±‹ "
           href="/2020/05/10/2020ç½‘é¼æ¯/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2020 ç½‘é¼æ¯">2020 ç½‘é¼æ¯</span>
            <span class="post-date" title="2020-05-10 21:15:00">2020/05/10</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ Lattice "
           href="/2020/05/09/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹HNP/"
           data-tag="Lattice,Dsa,LCG"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ HNP">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ HNP</span>
            <span class="post-date" title="2020-05-09 15:05:00">2020/05/09</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ Paillier "
           href="/2020/05/08/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹ paillier cryptosystem/"
           data-tag="Paillier"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ paillier cryptosystem">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ paillier cryptosystem</span>
            <span class="post-date" title="2020-05-08 12:05:00">2020/05/08</span>
        </a>
        
        <a  class="æ¯”èµ›å°å±‹ "
           href="/2020/05/05/2020De1CTF/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2020 De1CTF">2020 De1CTF</span>
            <span class="post-date" title="2020-05-05 15:57:00">2020/05/05</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ ECC "
           href="/2020/05/05/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹NCCIP/"
           data-tag="ECC"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ NCCIP">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ NCCIP</span>
            <span class="post-date" title="2020-05-05 12:05:00">2020/05/05</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ Block "
           href="/2020/03/03/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹åˆ†ç»„å¯†ç æ“ä½œæ¨¡å¼/"
           data-tag="æ“ä½œæ¨¡å¼"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ åˆ†ç»„å¯†ç æ“ä½œæ¨¡å¼">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ åˆ†ç»„å¯†ç æ“ä½œæ¨¡å¼</span>
            <span class="post-date" title="2020-03-03 15:15:00">2020/03/03</span>
        </a>
        
        <a  class="æ¯”èµ›å°å±‹ "
           href="/2020/02/18/2020hgame_week1/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2020 hgame week1">2020 hgame week1</span>
            <span class="post-date" title="2020-02-18 16:22:35">2020/02/18</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ Stream "
           href="/2020/01/30/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹RC4ä¸SM4/"
           data-tag="Rc4,SM4"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RC4ä¸SM4">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RC4ä¸SM4</span>
            <span class="post-date" title="2020-01-30 00:05:00">2020/01/30</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ Rsa "
           href="/2019/12/04/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹æµ…æOn r-th Root Extraction Algorithm in Fq/"
           data-tag="Rsa"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æµ…æOn r-th Root Extraction Algorithm in Fq">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æµ…æOn r-th Root Extraction Algorithm in Fq</span>
            <span class="post-date" title="2019-12-04 15:45:00">2019/12/04</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ Rsa "
           href="/2019/11/11/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹æµ…æPollard's rho algorithmåŠå…¶åº”ç”¨/"
           data-tag="Rsa"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æµ…æPollard&#39;s rho algorithmåŠå…¶åº”ç”¨">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æµ…æPollard&#39;s rho algorithmåŠå…¶åº”ç”¨</span>
            <span class="post-date" title="2019-11-11 15:32:00">2019/11/11</span>
        </a>
        
        <a  class="å¯†ç å°å±‹ Basic "
           href="/2019/11/11/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹æ•°è®ºå››å¤§å®šç†åŠåº”ç”¨/"
           data-tag="Abstract algebra"
           data-author="" >
            <span class="post-title" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æ•°è®ºå››å¤§å®šç†åŠåº”ç”¨">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ æ•°è®ºå››å¤§å®šç†åŠåº”ç”¨</span>
            <span class="post-date" title="2019-11-11 15:30:00">2019/11/11</span>
        </a>
        
        <a  class="æ¯”èµ›å°å±‹ "
           href="/2019/11/11/2019UNCTF/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 UNCTF">2019 UNCTF</span>
            <span class="post-date" title="2019-11-11 15:12:35">2019/11/11</span>
        </a>
        
        <a  class="å·¥å…·å°å±‹ "
           href="/2019/11/01/dockerå’Œdocker-composeçš„å®‰è£…/"
           data-tag="docker"
           data-author="" >
            <span class="post-title" title="å®‰è£…Docker å’Œ Docker-Composeä»¥åŠdocker imagesçš„åˆ¶ä½œåŠä¸Šä¼ ">å®‰è£…Docker å’Œ Docker-Composeä»¥åŠdocker imagesçš„åˆ¶ä½œåŠä¸Šä¼ </span>
            <span class="post-date" title="2019-11-01 21:00:00">2019/11/01</span>
        </a>
        
        <a  class="ç§äººå°å±‹ "
           href="/2019/10/01/æ˜¯æŸä¸ªå¤±çœ çš„å¤œæ™š/"
           data-tag="private"
           data-author="" >
            <span class="post-title" title="æ˜¯æŸä¸ªå¤±çœ çš„å¤œæ™š">æ˜¯æŸä¸ªå¤±çœ çš„å¤œæ™š</span>
            <span class="post-date" title="2019-10-01 00:42:35">2019/10/01</span>
        </a>
        
        <a  class="å·¥å…·å°å±‹ "
           href="/2019/09/12/Linux åŸºåŸºåŸºåŸºåŸºåŸºç¡€/"
           data-tag="Linux"
           data-author="" >
            <span class="post-title" title="Linux åŸºåŸºåŸºåŸºåŸºåŸºç¡€">Linux åŸºåŸºåŸºåŸºåŸºåŸºç¡€</span>
            <span class="post-date" title="2019-09-12 00:17:00">2019/09/12</span>
        </a>
        
        <a  class="æ¯”èµ›å°å±‹ "
           href="/2019/08/29/2019ç¬¬äº”ç©ºé—´/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 ç¬¬äº”ç©ºé—´">2019 ç¬¬äº”ç©ºé—´</span>
            <span class="post-date" title="2019-08-29 12:18:35">2019/08/29</span>
        </a>
        
        <a  class="æ¯”èµ›å°å±‹ "
           href="/2019/08/27/2019OGeek/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 OGeek">2019 OGeek</span>
            <span class="post-date" title="2019-08-27 11:02:35">2019/08/27</span>
        </a>
        
        <a  class="æ¯”èµ›å°å±‹ "
           href="/2019/08/03/2019De1CTF/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 De1CTF">2019 De1CTF</span>
            <span class="post-date" title="2019-08-03 22:14:55">2019/08/03</span>
        </a>
        
        <a  class="å°ä¹¦å±‹ "
           href="/2019/08/02/ä¸‰ä½“/"
           data-tag="book"
           data-author="" >
            <span class="post-title" title="ä¸‰ä½“">ä¸‰ä½“</span>
            <span class="post-date" title="2019-08-02 12:56:00">2019/08/02</span>
        </a>
        
        <a  class="å·¥å…·å°å±‹ "
           href="/2019/07/22/nmap/"
           data-tag="Nmap"
           data-author="" >
            <span class="post-title" title="åˆé‡Nmap">åˆé‡Nmap</span>
            <span class="post-date" title="2019-07-22 16:07:55">2019/07/22</span>
        </a>
        
        <a  class="å·¥å…·å°å±‹ "
           href="/2019/07/21/python æ­£åˆ™/"
           data-tag="python"
           data-author="" >
            <span class="post-title" title="python ä¹‹ æ­£åˆ™">python ä¹‹ æ­£åˆ™</span>
            <span class="post-date" title="2019-07-21 22:30:35">2019/07/21</span>
        </a>
        
        <a  class="æ¯”èµ›å°å±‹ "
           href="/2019/07/14/2019èµ›åšæ¯/"
           data-tag="Write Up"
           data-author="" >
            <span class="post-title" title="2019 èµ›åšæ¯">2019 èµ›åšæ¯</span>
            <span class="post-date" title="2019-07-14 16:22:35">2019/07/14</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹RSA" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSA</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            
                <a  data-rel="å¯†ç å°å±‹">å¯†ç å°å±‹</a>/
            
                <a  data-rel="RSA">RSA</a>
            
        </span>
        
        
        <span class="tag">
            
            <a class="color4">Rsa</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        åˆ›å»ºæ—¶é—´:<time class="date" title='æ›´æ–°æ—¶é—´: 2020-05-20 22:17:18'>2020-05-20 20:40</time>
        
    </div>
    <div class="article-meta">
        
        <span>å­—æ•°:5.6k</span>
        
        
        <span id="busuanzi_container_page_pv">
            é˜…è¯»:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#è¯æ˜-m-equiv-c-d-pmod-n"><span class="toc-text">è¯æ˜$m \equiv c^d \pmod n$</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#på’Œqç›¸å·®è¿‡å¤§"><span class="toc-text">på’Œqç›¸å·®è¿‡å¤§</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ¨¡næœ‰å…¬çº¦æ•°"><span class="toc-text">æ¨¡næœ‰å…¬çº¦æ•°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å·²çŸ¥e-d-nåˆ†è§£æ¨¡æ±‚p-q"><span class="toc-text">å·²çŸ¥e,d,nåˆ†è§£æ¨¡æ±‚p,q</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#d-pã€d-q-æ³„éœ²"><span class="toc-text">$d_pã€d_q$æ³„éœ²</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#d-p-æ³„éœ²"><span class="toc-text">$d_p$æ³„éœ²</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#eä¸Ï†-n-ä¸äº’ç´ "><span class="toc-text">eä¸Ï†(n)ä¸äº’ç´ </span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ"><span class="toc-text">å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"><span class="toc-text">ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½è§£å¯†æŒ‡æ•°æ”»å‡»"><span class="toc-text">ä½è§£å¯†æŒ‡æ•°æ”»å‡»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å…±æ¨¡æ”»å‡»"><span class="toc-text">å…±æ¨¡æ”»å‡»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stereotyped-messages"><span class="toc-text">Stereotyped messages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Factoring-with-high-bits-known"><span class="toc-text">Factoring with high bits known</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Partial-Key-Exposure-Attack-éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»"><span class="toc-text">Partial Key Exposure Attack(éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Related-Message-Attack"><span class="toc-text">Related Message Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wienerâ€˜s-Attack"><span class="toc-text">wienerâ€˜s Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wienerâ€˜s-Attackå¤±æ•ˆæ—¶"><span class="toc-text">wienerâ€˜s Attackå¤±æ•ˆæ—¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA-LSB-Oracle-Attack"><span class="toc-text">RSA LSB Oracle Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é€‰æ‹©å¯†æ–‡æ”»å‡»"><span class="toc-text">é€‰æ‹©å¯†æ–‡æ”»å‡»</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>RSAè‡ªä½¿ç”¨ä»¥æ¥ï¼Œå·²ç»å‡ºç°äº†ä¸€å †å †å„ç§ç±»å‹çš„attackï¼Œå‡†å¤‡ç”¨è¿™ç¯‡ç¬”è®°æ¥è®°å½•ä¸‹è¿™äº›ç±»å‹ã€‚è¾¹å­¦è¾¹æ›´å­â€¦</p>
<h1 id="è¯æ˜-m-equiv-c-d-pmod-n"><a href="#è¯æ˜-m-equiv-c-d-pmod-n" class="headerlink" title="è¯æ˜$m \equiv c^d \pmod n$"></a>è¯æ˜$m \equiv c^d \pmod n$</h1><p>æ¬§æ‹‰å®šç†ï¼šè‹¥$a,n$ä¸ºæ­£æ•´æ•°ï¼Œä¸”$ğ‘,ğ‘›$äº’ç´ ï¼ˆå³$gcd(a,n) = 1$ï¼‰ï¼Œåˆ™$ğ‘^{ğœ‘(ğ‘›)} \equiv 1 \pmod n$ã€‚<br>å·²çŸ¥ $1 \equiv e\cdot d \pmod {Ï†(n)}ï¼Œğ‘š &lt; ğ‘›ï¼Œc \equiv  m^e \pmod nï¼Œgcd(ğ‘š,ğ‘›) = 1$ï¼Œæ±‚è¯$m \equiv c^d \pmod n$ </p>
<p>ç­‰å¼å·¦è¾¹ä¸ºm</p>
<p>ç­‰å¼å³è¾¹ä¸º$c^d \pmod{n}$<br>âˆµ $ğ‘ \equiv m^e\pmod n $$</p>
<p>âˆ´ $c^d \pmod n \equiv  (m^e \pmod n)^d \pmod n \equiv  m^{e\cdot d} \pmod n $</p>
<p>âˆµ $1 \equiv  e\cdot d \pmod {Ï†(n)} $</p>
<p>âˆ´ $e\cdot d \equiv  k\cdot Ï†(n) + 1 $</p>
<p>âˆ´ $c^d  \equiv  m^{e \cdot d}  \equiv m^{k\cdot Ï†(n)+1}  \equiv  m\cdot (m^{Ï†(n)})^k \pmod n $</p>
<p>âˆµ $gcd(m,n) \equiv  1$</p>
<p> âˆ´ $m^{Ï†(n)} \equiv  1 \pmod n $</p>
<p>âˆ´ $c^d  \equiv  m\cdot (m^{Ï†(n)})^k \equiv  m\cdot (1)^k \equiv  m \pmod n $</p>
<p>âˆµ $m&lt;n$</p>
<p> âˆ´ $m \pmod n \equiv  m$</p>
<p> âˆ´ $c^d \equiv  m \pmod n \equiv  m $</p>
<p>ç­‰å¼å³è¾¹ç­‰äºç­‰å¼å·¦è¾¹ï¼Œè¯æ¯•ã€‚</p>
<hr>
<h1 id="på’Œqç›¸å·®è¿‡å¤§"><a href="#på’Œqç›¸å·®è¿‡å¤§" class="headerlink" title="på’Œqç›¸å·®è¿‡å¤§"></a>på’Œqç›¸å·®è¿‡å¤§</h1><p>å¦‚æœé¢˜ç›®ç»™åˆ°p = nextprime(q)</p>
<p>é‚£ä¹ˆpå’Œqç‰¹åˆ«æ¥è¿‘ï¼Œæ‰€ä»¥å¯ä»¥çœ‹ä½œ$n  = p^2$</p>
<p>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å¯¹å¼€æ ¹å°±å¯ä»¥äº†</p>
<h1 id="æ¨¡næœ‰å…¬çº¦æ•°"><a href="#æ¨¡næœ‰å…¬çº¦æ•°" class="headerlink" title="æ¨¡næœ‰å…¬çº¦æ•°"></a>æ¨¡næœ‰å…¬çº¦æ•°</h1><p>æ¬§å‡ é‡Œå¾—è¾—è½¬ç›¸é™¤æ³•ï¼ˆgcdï¼‰å¾—å…¬çº¦æ•°</p>
<h1 id="å·²çŸ¥e-d-nåˆ†è§£æ¨¡æ±‚p-q"><a href="#å·²çŸ¥e-d-nåˆ†è§£æ¨¡æ±‚p-q" class="headerlink" title="å·²çŸ¥e,d,nåˆ†è§£æ¨¡æ±‚p,q"></a>å·²çŸ¥e,d,nåˆ†è§£æ¨¡æ±‚p,q</h1><p>åŸç†æ¥è‡ªè¿™ç¯‡<a href="https://paper.seebug.org/727/#11" target="_blank" rel="noopener">ç»¼è¿°</a></p>
<p>ç»™å®š$d$ï¼Œè®¡ç®—$k=d\cdot eâˆ’1$ã€‚æ ¹æ®$d$å’Œ$e$çš„å®šä¹‰æˆ‘ä»¬çŸ¥é“$k$æ˜¯$Ï†(N)$çš„å€æ•°ã€‚ç”±äº$Ï†(N)$æ˜¯å¶æ•°ï¼Œ$k=2^tr$å…¶ä¸­$r$ä¸ºå¥‡æ•°ä¸”$tâ‰¥1$ã€‚å¯¹äºæ¯ä¸ª$gâˆˆZâˆ—N$éƒ½æœ‰$g^k=1$ï¼Œå› æ­¤$g^{\frac{k}{2}}$æ˜¯å•ä½æ¨¡$N$çš„å¹³æ–¹æ ¹ã€‚æ ¹æ®ä¸­å›½å‰©ä½™å®šç†ï¼Œ1æœ‰å››ä¸ªå¹³æ–¹æ ¹æ¨¡$N=p\cdot q$ã€‚å…¶ä¸­ä¸¤ä¸ªå¹³æ–¹æ ¹æ˜¯$Â±1$ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯$Â±x$ï¼Œå…¶ä¸­xæ»¡è¶³$x\equiv 1 \pmod p$å’Œ$x\equiv âˆ’1 \pmod q$ã€‚ç”¨è¿™æœ€åä¸¤ä¸ªå¹³æ–¹æ ¹ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œé€šè¿‡è®¡ç®—$gcd(xâˆ’1,N)$æ¥æ­ç¤º$N$çš„å› å¼åˆ†è§£ã€‚ä¸€ä¸ªç›´æˆªäº†å½“çš„è®ºè¯è¡¨æ˜ï¼Œå¦‚æœä»$Z\cdot N$ä¸­éšæœºé€‰æ‹©$g$ï¼Œé‚£ä¹ˆåºåˆ—ä¸­çš„ä¸€ä¸ªå…ƒç´ $g^{\frac{k}{2}}ï¼Œg^{\frac{k}{4}},â€¦ï¼Œg^{\frac{k}{2^t}} \pmod N$æ˜¯ç»Ÿä¸€å¹³æ–¹æ ¹çš„æ¦‚ç‡è‡³å°‘ä¸º$\frac{1}{2}$ï¼Œä»è€Œæ­ç¤ºäº†$N$çš„åˆ†è§£ï¼Œåºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ å¯ä»¥åœ¨æ—¶é—´$O(n^3))$å†…æœ‰æ•ˆåœ°è®¡ç®—ï¼Œå…¶ä¸­$n=log_2N$ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor_n_with_ed</span><span class="params">(n,e,d)</span>:</span>  </span><br><span class="line">    p = <span class="number">1</span>  </span><br><span class="line">    q = <span class="number">1</span>  </span><br><span class="line">    <span class="keyword">while</span> p==<span class="number">1</span> <span class="keyword">and</span> q==<span class="number">1</span>:  </span><br><span class="line">        k = d * e - <span class="number">1</span>  </span><br><span class="line">        g = random.randint ( <span class="number">0</span> , n )  </span><br><span class="line">        <span class="keyword">while</span> p==<span class="number">1</span> <span class="keyword">and</span> q==<span class="number">1</span> <span class="keyword">and</span> k % <span class="number">2</span> == <span class="number">0</span>:  </span><br><span class="line">            k /= <span class="number">2</span>  </span><br><span class="line">            y = pow(g,k,n)  </span><br><span class="line">            <span class="keyword">if</span> y!=<span class="number">1</span> <span class="keyword">and</span> gcd(y<span class="number">-1</span>,n)&gt;<span class="number">1</span>:  </span><br><span class="line">                p = gcd(y<span class="number">-1</span>,n)  </span><br><span class="line">                q = n/p  </span><br><span class="line">    <span class="keyword">return</span> p,q</span><br></pre></td></tr></table></figure>

<h1 id="d-pã€d-q-æ³„éœ²"><a href="#d-pã€d-q-æ³„éœ²" class="headerlink" title="$d_pã€d_q$æ³„éœ²"></a>$d_pã€d_q$æ³„éœ²</h1><p>æ‘˜è‡ªè¿™ç¯‡<a href="https://code.felinae98.cn/ctf/crypto/rsa%E7%A7%81%E9%92%A5%E9%87%8D%E6%9E%84/" target="_blank" rel="noopener">ç§é’¥é‡æ„</a></p>
<p>é¦–å…ˆè¯´æ˜$d_p$å’Œ$d_q$çš„å«ä¹‰</p>
<p>$d_p \equiv d \pmod{Ï†(p)}$<br>$d_q \equiv d \pmod{Ï†(q)}$</p>
<p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥$pï¼Œqï¼Œd_pï¼Œd_qï¼Œc$ï¼Œæ— å…¬é’¥$e$ã€ç§é’¥$d$</p>
<p>è¯ï¼š</p>
<p>ç”±    $e\cdot d  \equiv 1 \pmod {(p-1)\cdot (q-1)}$</p>
<p>â€‹        $d_p \equiv d \pmod{Ï†(p)}$</p>
<p>å¾—    $e\cdot d_p \equiv  1 \pmod {Ï†(p)} $</p>
<p>è®¾$m_1  \equiv  m^{e\cdot d_p}  \equiv  c^{d_p} \pmod p$</p>
<p>åˆ™$m_1 \equiv  m^{k\cdot Ï†(p)+1} \pmod p $</p>
<p>ç”±è´¹é©¬å°å®šç†ï¼Œ$m^{Ï†(p)}  \equiv 1 \pmod p$</p>
<p>æ‰€ä»¥$ m_1  \equiv  m \pmod p$</p>
<p>åŒç† $m_2  \equiv  m  \equiv c^{d_q} \pmod q$</p>
<p>ç„¶åæˆ‘ä»¬å°±æœ‰åŒä½™å¼æ–¹ç¨‹ç»„ï¼š$m  \equiv  m_1  \pmod p$</p>
<p>â€‹                                                   $m  \equiv  m_2  \pmod q$</p>
<p>ç„¶åèµ°ä¸€æ³¢CRTæ¢å¤$m$å°±å¥½äº†ï¼ˆ$m &lt; p\cdot q$ï¼‰</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mp = pow(c,dp,p)</span><br><span class="line">mq = pow(c,dq,q)</span><br><span class="line">a = invert(p,q)</span><br><span class="line">b = invert(q,p)</span><br><span class="line">m = (mp*p*a+mq*q*b) % (p*q)</span><br></pre></td></tr></table></figure>

<h1 id="d-p-æ³„éœ²"><a href="#d-p-æ³„éœ²" class="headerlink" title="$d_p$æ³„éœ²"></a>$d_p$æ³„éœ²</h1><p>å·²çŸ¥ï¼šå…¬é’¥($n,e)$ä»¥åŠ$d_p$</p>
<p>æ±‚è§£ï¼š$d$</p>
<p>å·²çŸ¥æ¡ä»¶ï¼š</p>
<p>$c\equiv m^e \pmod n$<br>$m\equiv c^d \pmod n$<br>$Ï†(n)=(pâˆ’1)\cdot (qâˆ’1)$<br>$d\cdot e\equiv 1 \pmod {Ï†(n)}$</p>
<p>$d_p\equiv d \pmod {pâˆ’1}$</p>
<p> ç”±ä¸Šå¼å¯ä»¥å¾—åˆ°       $d_p\cdot e\equiv d\cdot e  \pmod {pâˆ’1}$</p>
<p>å³                                $d\cdot e = k_1\cdot (pâˆ’1)+d_p\cdot e$        â‘ </p>
<p>åˆ                                $d\cdot e\equiv 1 \pmod {(pâˆ’1)\cdot (qâˆ’1)}$            â‘¡</p>
<p>â‘ å¸¦å…¥â‘¡å¾—åˆ°ï¼š        $k_1\cdot (pâˆ’1)+d_p\cdot e \equiv  1\pmod { (pâˆ’1)\cdot (qâˆ’1)}$</p>
<p>å³                          $k_2\cdot (pâˆ’1)\cdot (qâˆ’1)+1=k_1\cdot (pâˆ’1)+d_p\cdot e$</p>
<p>æ•´ç†ä¸€ä¸‹    $(pâˆ’1)\cdot [k_2\cdot (qâˆ’1)âˆ’k_1]+1=d_p\cdot e$</p>
<p>å› ä¸º                                              $ d_p&lt;p-1$</p>
<p>æ‰€ä»¥                                        $e&gt;k_2\cdot (qâˆ’1)âˆ’k_1$</p>
<p>æˆ‘ä»¬å‡è®¾    $x = k_2\cdot (qâˆ’1)âˆ’k_1$</p>
<p>å³$    x$çš„èŒƒå›´ä¸º$(0,e)$</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥éå†$e$ç§å¯èƒ½å°±å¯ä»¥æ±‚å‡º$p-1 = \frac{d_p\cdot e -1} {x}$ï¼Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rsa_nedp</span><span class="params">(n,e,dp)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,e):</span><br><span class="line">        <span class="keyword">if</span> (dp*e<span class="number">-1</span>)%i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n%(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)==<span class="number">0</span>:</span><br><span class="line">                p=((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span></span><br><span class="line">                q=n/(((dp*e<span class="number">-1</span>)/i)+<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h2 id="eä¸Ï†-n-ä¸äº’ç´ "><a href="#eä¸Ï†-n-ä¸äº’ç´ " class="headerlink" title="eä¸Ï†(n)ä¸äº’ç´ "></a>eä¸Ï†(n)ä¸äº’ç´ </h2><p>åœºæ™¯ï¼šé¢˜ç›®ç»™å‡ºä¸¤ç»„å…¬é’¥n1,n2,e1,e2ä»¥åŠç¬¬ä¸€ç»„ã€ç¬¬äºŒç»„åŠ å¯†åçš„å¯†æ–‡c1,c2</p>
<p>(å…¶å®æœ¬è´¨å°±æ˜¯ç»™å‡ºe,q,pæ±‚d)</p>
<p>å…ˆç”©ä¸€ä¸ªè„šæœ¬</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">import gmpy2</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def gcd(a, b):</span><br><span class="line">    if a &lt; b:</span><br><span class="line">        a, b = b, a</span><br><span class="line">    while b != 0:</span><br><span class="line">        temp = a % b</span><br><span class="line">        a = b</span><br><span class="line">        b = temp</span><br><span class="line">    return a</span><br><span class="line"></span><br><span class="line">n1=0xbf510b8e2b169fbce366eb15a4f6c71b370f02f2108c7feb482234a386185bce1a740fa6498e04edbdf2a639e320619d9f39d3e740ebaf578af0426bc3e851001a1d599108a08725347f6680a7f5581a32d91505023701872c3df723e8de9f201d3b17059bebff944b915045870d757eb6d6d009eb4561cc7e4b89968e4433a9</span><br><span class="line">n2=0xba85d38d1bfc3fb281927c9246b5b771ac3344ca9fe1c2d9c793a886bffb5c84558f4a578cd5ba9e777a4e08f66d0cabe05b9aa2ae8d075778b5fbfff318a7f9b6f22e2eff6f79d8c1148941b3974f3e83a4a4f1520ad42336eddc572ec7ea04766eb798b2f1b1b52009b3eeea7741b2c55e3c7c11c5cf6a4e204c6b0d312f49</span><br><span class="line"></span><br><span class="line">p=gcd(n1,n2)</span><br><span class="line">q1=n1//p</span><br><span class="line">q2=n2//p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1=0x43e5cc4c99c3040aef2ccb0d4c45266f6b75cd7f9f1be105766689283f0886061c9cd52ac2b2b6c1b7d250c2079f354ca9b988db5556336201f3b5e489916b3b60b80c34bef8f608d7471fafaf14bee421b60630f42c5cc813356e786ff10e5efa334b8a73b7ea06afa6043f33be6a31010d306ba60516243add65c183da843a</span><br><span class="line">c2=0x79ec6350649377f69b475eca83a7d9d5356a1d62e29933e9c8e2b19b4b23626a581037aba3be6d7f73d5bed049350e41c1ed4cdc3e10ee34ec576ef3449be2f7d930c759612e1c23c4db71d0e5185a80b548031e3857dd93eca4af017fcd25895fcc4e8a2b36c1dd36b8cd9cc9200e2879f025928fe346e2cfae5200e66de6cc</span><br><span class="line">e1 =0x15d6439c6</span><br><span class="line">e2 =0x2c09848c6</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(gcd(e1,(p-1)*(q1-1)))</span></span><br><span class="line"><span class="comment">#print(gcd(e2,(p-1)*(q2-1)))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e1=e1//gcd(e1,(p-1)*(q1-1))</span><br><span class="line">e2=e2//gcd(e2,(p-1)*(q2-1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">phi1=(p-1)*(q1-1);phi2=(p-1)*(q2-1)</span><br><span class="line">d1=gmpy2.invert(e1,phi1)</span><br><span class="line">d2=gmpy2.invert(e2,phi2)</span><br><span class="line">f1=pow(c1,d1,n1)</span><br><span class="line">f2=pow(c2,d2,n2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def GCRT(mi, ai):</span><br><span class="line">    curm, cura = mi[0], ai[0]</span><br><span class="line">    for (m, a) in zip(mi[1:], ai[1:]):</span><br><span class="line">        d = gmpy2.gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        K = c // d * gmpy2.invert(curm // d, m // d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m // d</span><br><span class="line">        cura %= curm</span><br><span class="line">    return (cura % curm, curm)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f3,lcm = GCRT([n1,n2],[f1,f2])</span><br><span class="line">assert(f3%n1==f1)</span><br><span class="line">assert(f3%n2==f2)</span><br><span class="line">assert(lcm==q1*q2*p)</span><br><span class="line">n3=q1*q2</span><br><span class="line">c3=f3%n3</span><br><span class="line">phi3=(q1-1)*(q2-1)</span><br><span class="line"></span><br><span class="line">d3=gmpy2.invert(39929,phi3)<span class="comment">#39929æ˜¯79858//gcd((q1-1)*(q2-1),79858) å› ä¸ºæ–°çš„eå’ŒÏ†(n)è¿˜æ˜¯æœ‰å…¬å› æ•°2</span></span><br><span class="line">m3=pow(c3,d3,n3)</span><br><span class="line"></span><br><span class="line">if gmpy2.iroot(m3,2)[1] == 1:</span><br><span class="line">    flag=gmpy2.iroot(m3,2)[0]</span><br><span class="line"><span class="section">print(binascii.unhexlify(hex(flag)[2:].strip("L")))</span></span><br></pre></td></tr></table></figure>

<h1 id="å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ"><a href="#å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ" class="headerlink" title="å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ"></a>å…¬é’¥nç”±å¤šä¸ªç´ æ•°å› å­ç»„æˆ</h1><p>emmmï¼Œå› å­è¶Šå¤šï¼Œnåè€Œä¼šè¶Šå®¹æ˜“åˆ†è§£ã€‚</p>
<p>ä¸æ­£å¸¸è§£å¯†RSAæ— å¼‚ã€‚æ ¹æ®å®šä¹‰æ±‚$Ï†(n)$å°±å¥½ã€‚</p>
<h1 id="ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"><a href="#ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»" class="headerlink" title="ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»"></a>ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</h1><p>æ»¡è¶³æ¡ä»¶ï¼šm.bit_length*e &lt; âˆc.bit_length    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n =  []</span><br><span class="line">c =  []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRT</span><span class="params">(mi, ai)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> (reduce(gmpy2.gcd,mi)==<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> (isinstance(mi, list) <span class="keyword">and</span> isinstance(ai, list))</span><br><span class="line">    M = reduce(<span class="keyword">lambda</span> x, y: x * y, mi)</span><br><span class="line">    ai_ti_Mi = [a * (M / m) * gmpy2.invert(M / m, m) <span class="keyword">for</span> (m, a) <span class="keyword">in</span> zip(mi, ai)]</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x + y, ai_ti_Mi) % M</span><br><span class="line">e=<span class="number">0x7</span></span><br><span class="line">m=iroot(CRT(n, c), e)[<span class="number">0</span>]</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h2 id="ä½è§£å¯†æŒ‡æ•°æ”»å‡»"><a href="#ä½è§£å¯†æŒ‡æ•°æ”»å‡»" class="headerlink" title="ä½è§£å¯†æŒ‡æ•°æ”»å‡»"></a>ä½è§£å¯†æŒ‡æ•°æ”»å‡»</h2><p>ä¸»è¦åˆ©ç”¨çš„æ˜¯ç§é’¥då¾ˆå°ï¼Œè¡¨ç°å½¢å¼ä¸€èˆ¬æ˜¯eå¾ˆå¤§</p>
<p>åˆ©ç”¨æ¡ä»¶ï¼šç»™å‡ºnå’Œeï¼Œeæ¥è¿‘n</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rational_to_contfrac</span> <span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="string">''' </span></span><br><span class="line"><span class="string">    Converts a rational x/y fraction into</span></span><br><span class="line"><span class="string">    a list of partial quotients [a0, ..., an] </span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    a = x//y</span><br><span class="line">    <span class="keyword">if</span> a * y == x:</span><br><span class="line">        <span class="keyword">return</span> [a]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pquotients = rational_to_contfrac(y, x - a * y)</span><br><span class="line">        pquotients.insert(<span class="number">0</span>, a)</span><br><span class="line">        <span class="keyword">return</span> pquotients</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">convergents_from_contfrac</span><span class="params">(frac)</span>:</span>    </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    computes the list of convergents</span></span><br><span class="line"><span class="string">    using the list of partial quotients </span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    convs = [];</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(frac)):</span><br><span class="line">        convs.append(contfrac_to_rational(frac[<span class="number">0</span>:i]))</span><br><span class="line">    <span class="keyword">return</span> convs</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">contfrac_to_rational</span> <span class="params">(frac)</span>:</span></span><br><span class="line">    <span class="string">'''Converts a finite continued fraction [a0, ..., an]</span></span><br><span class="line"><span class="string">     to an x/y rational.</span></span><br><span class="line"><span class="string">     '''</span></span><br><span class="line">    <span class="keyword">if</span> len(frac) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">elif</span> len(frac) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> (frac[<span class="number">0</span>], <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        remainder = frac[<span class="number">1</span>:len(frac)]</span><br><span class="line">        (num, denom) = contfrac_to_rational(remainder)</span><br><span class="line">        <span class="comment"># fraction is now frac[0] + 1/(num/denom), which is </span></span><br><span class="line">        <span class="comment"># frac[0] + denom/num.</span></span><br><span class="line">        <span class="keyword">return</span> (frac[<span class="number">0</span>] * num + denom, num)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Extended Euclidean Algorithm</span></span><br><span class="line"><span class="string">    returns x, y, gcd(a,b) such that ax + by = gcd(a,b)</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    u, u1 = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    v, v1 = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        q = a // b</span><br><span class="line">        u, u1 = u1, u - q * u1</span><br><span class="line">        v, v1 = v1, v - q * v1</span><br><span class="line">        a, b = b, a - q * b</span><br><span class="line">    <span class="keyword">return</span> u, v, a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    2.8 times faster than egcd(a,b)[2]</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    a,b=(b,a) <span class="keyword">if</span> a&lt;b <span class="keyword">else</span> (a,b)</span><br><span class="line">    <span class="keyword">while</span> b:</span><br><span class="line">        a,b=b,a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> \<span class="title">pmodInverse</span><span class="params">(e,n)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    d such that de = 1 (\pmod n)</span></span><br><span class="line"><span class="string">    e must be coprime to n</span></span><br><span class="line"><span class="string">    this is assumed to be true</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">return</span> egcd(e,n)[<span class="number">0</span>]%n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">totient</span><span class="params">(p,q)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Calculates the totient of pq</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">return</span> (p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bitlength</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Calculates the bitlength of x</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">assert</span> x &gt;= <span class="number">0</span></span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        n = n+<span class="number">1</span></span><br><span class="line">        x = x&gt;&gt;<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isqrt</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Calculates the integer square root</span></span><br><span class="line"><span class="string">    for arbitrary large nonnegative integers</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'square root not defined for negative numbers'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    a, b = div\pmod(bitlength(n), <span class="number">2</span>)</span><br><span class="line">    x = <span class="number">2</span>**(a+b)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        y = (x + n//x)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> y &gt;= x:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        x = y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_perfect_square</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    If n is a perfect square it returns sqrt(n),</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    otherwise returns -1</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    h = n &amp; <span class="number">0xF</span>; <span class="comment">#last hexadecimal "digit"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> h &gt; <span class="number">9</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span> <span class="comment"># return immediately in 6 cases out of 16.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Take advantage of Boolean short-circuit evaluation</span></span><br><span class="line">    <span class="keyword">if</span> ( h != <span class="number">2</span> <span class="keyword">and</span> h != <span class="number">3</span> <span class="keyword">and</span> h != <span class="number">5</span> <span class="keyword">and</span> h != <span class="number">6</span> <span class="keyword">and</span> h != <span class="number">7</span> <span class="keyword">and</span> h != <span class="number">8</span> ):</span><br><span class="line">        <span class="comment"># take square root if you must</span></span><br><span class="line">        t = isqrt(n)</span><br><span class="line">        <span class="keyword">if</span> t*t == n:</span><br><span class="line">            <span class="keyword">return</span> t</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hack_RSA</span><span class="params">(e,n)</span>:</span></span><br><span class="line">    frac = rational_to_contfrac(e, n)</span><br><span class="line">    convergents = convergents_from_contfrac(frac)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (k,d) <span class="keyword">in</span> convergents:</span><br><span class="line">        <span class="comment">#check if d is actually the key</span></span><br><span class="line">        <span class="keyword">if</span> k!=<span class="number">0</span> <span class="keyword">and</span> (e*d<span class="number">-1</span>)%k == <span class="number">0</span>:</span><br><span class="line">            phi = (e*d<span class="number">-1</span>)//k</span><br><span class="line">            s = n - phi + <span class="number">1</span></span><br><span class="line">            <span class="comment"># check if the equation x^2 - s*x + n = 0</span></span><br><span class="line">            <span class="comment"># has integer roots</span></span><br><span class="line">            discr = s*s - <span class="number">4</span>*n</span><br><span class="line">            <span class="keyword">if</span>(discr&gt;=<span class="number">0</span>):</span><br><span class="line">                t = is_perfect_square(discr)</span><br><span class="line">                <span class="keyword">if</span> t!=<span class="number">-1</span> <span class="keyword">and</span> (s+t)%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">                    print(<span class="string">"\nHacked!"</span>)</span><br><span class="line">                    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    n = <span class="number">9247606623523847772698953161616455664821867183571218056970099751301682205123115716089486799837447397925308887976775994817175994945760278197527909621793469</span></span><br><span class="line">    e = <span class="number">27587468384672288862881213094354358587433516035212531881921186101712498639965289973292625430363076074737388345935775494312333025500409503290686394032069</span></span><br><span class="line">    d=hack_RSA(e,n)</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"d="</span>)</span><br><span class="line">    <span class="keyword">print</span> (d)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<h2 id="å…±æ¨¡æ”»å‡»"><a href="#å…±æ¨¡æ”»å‡»" class="headerlink" title="å…±æ¨¡æ”»å‡»"></a>å…±æ¨¡æ”»å‡»</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šè‹¥å¹²æ¬¡åŠ å¯†ï¼Œeä¸åŒï¼Œnç›¸åŒï¼Œmç›¸åŒã€‚å°±å¯ä»¥åœ¨ä¸åˆ†è§£nå’Œæ±‚dçš„å‰æä¸‹ï¼Œè§£å‡ºæ˜æ–‡mã€‚</p>
<p>é¦–å…ˆï¼Œä¸¤ä¸ªåŠ å¯†æŒ‡æ•°äº’è´¨ï¼š<br>gcd(e1,e2)=1</p>
<p>å³å­˜åœ¨s1ã€s2ä½¿å¾—ï¼š<br>s1*e1+s2*e2=1</p>
<p>åˆå› ä¸ºï¼š<br>c1\equiv m^e1^ \pmod n<br>c2\equiv m^e2^\pmod n</p>
<p>ä¸¤æ¡å¼å­åˆ†åˆ«æ±‚ä¸€ä¸ªï¼ˆs1,s2ï¼‰æ¬¡æ–¹ç„¶åç›¸ä¹˜ï¼ŒåŒ–ç®€å¯å¾—ï¼š<br>c1^s1^ * c2^s2^ \equiv  m \pmod n</p>
<p>å³å¯æ±‚å‡ºæ˜æ–‡</p>
<p>exp:</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">import</span> sys</span><br><span class="line"><span class="built_in">import</span> binascii</span><br><span class="line">sys.setrecursionlimit(<span class="number">1000000</span>)</span><br><span class="line">def egcd(a, b):</span><br><span class="line">    <span class="keyword">if</span> <span class="attr">a</span> == <span class="number">0</span>:</span><br><span class="line">      return (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      g, y, <span class="attr">x</span> = egcd(b % a, a)</span><br><span class="line">      return (g, x - (b // a) * y, y)</span><br><span class="line">def \pmodinv(a, m):</span><br><span class="line">    g, x, <span class="attr">y</span> = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">      raise Exception('\pmodular inverse does not exist')</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      return x % m</span><br><span class="line"></span><br><span class="line"><span class="attr">c1=</span></span><br><span class="line"><span class="attr">n=</span></span><br><span class="line"><span class="attr">e1=0xc21000af014a98b2455dec479</span></span><br><span class="line"><span class="attr">c2=</span></span><br><span class="line"><span class="attr">e2=0x9935842d63b75899ddd81b467</span></span><br><span class="line"></span><br><span class="line"><span class="attr">s</span> = egcd(e1, e2)</span><br><span class="line"><span class="attr">s1</span> = s[<span class="number">1</span>]</span><br><span class="line"><span class="attr">s2</span> = s[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">   <span class="attr">s1</span> = - s1</span><br><span class="line">   <span class="attr">c1</span> = \pmodinv(c1, n)</span><br><span class="line">elif s2&lt;<span class="number">0</span>:</span><br><span class="line">   <span class="attr">s2</span> = - s2</span><br><span class="line">   <span class="attr">c2</span> = \pmodinv(c2, n)</span><br><span class="line"><span class="attr">m=(pow(c1,s1,n)*pow(c2,s2,n))</span> % n</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<p> mï¼Œeç›¸åŒï¼Œä¸åŒçš„æ˜¯cå’Œnï¼Œæœ‰ï¼š<br>$c_1 \equiv m^e \pmod n_1$<br>$c_2 \equiv m^e \pmod n_2$<br>$c_3 \equiv m^e \pmod n_3$<br>â€¦<br>$c_n \equiv m^e \pmod n_n$ </p>
<p> $c_x \equiv m^n \pmod n_1n_2n_3\cdot\cdot\cdot n_n$ </p>
<h2 id="Stereotyped-messages"><a href="#Stereotyped-messages" class="headerlink" title="Stereotyped messages"></a>Stereotyped messages</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥æ¨¡Nï¼ŒåŠ å¯†æŒ‡æ•°eå’Œæ˜æ–‡mé«˜ä½ï¼Œä½ä½è¢«éšè—ï¼Œè¢«éšè—éƒ¨åˆ†ä½æ•°å°äºN^1/e^</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">load(<span class="string">"coppersmith.sage"</span>)</span><br><span class="line">N = <span class="comment">#Nçš„å€¼</span></span><br><span class="line">e = 3 <span class="comment">#eçš„å€¼ï¼Œè¶Šå°è¶Šå¥½</span></span><br><span class="line">m = <span class="comment">#mçš„å¤§æ¦‚å€¼</span></span><br><span class="line">c = <span class="comment">#cçš„å€¼</span></span><br><span class="line">Z\pmodN = Z\pmod(N)</span><br><span class="line">P.&lt;x&gt; = PolynomialRing(Z\pmodN)</span><br><span class="line">f = (m + x)^e - c</span><br><span class="line">dd = f.degree()</span><br><span class="line">beta = 1</span><br><span class="line">epsilon = beta / 7</span><br><span class="line">mm = ceil(beta**2 / (dd * epsilon))</span><br><span class="line">tt = floor(dd * mm * ((1/beta) - 1))</span><br><span class="line">XX = ceil(N**((beta**2/dd) - epsilon))</span><br><span class="line">roots = coppersmith_howgrave_univariate(f, N, beta, mm, tt, XX)</span><br></pre></td></tr></table></figure>

<h2 id="Factoring-with-high-bits-known"><a href="#Factoring-with-high-bits-known" class="headerlink" title="Factoring with high bits known"></a>Factoring with high bits known</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥æ¨¡Nï¼ŒåŠ å¯†æŒ‡æ•°eå’Œpçš„é«˜ä½ï¼Œä½ä½è¢«éšè—</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">n = 22696911229312659874738074899439457992248152730689278378819946543149357610634329627984531087669062301926875187991182013947223281619853855162918766480848703174390569130081348181282805736755296880728550799307081115704956570914024661831937343894022737660587549552490238277573409387371217121560461324557186812257740503722584510585462069159075200526635606677601131918281509060592393387176124235153517358363746584271646274866120051265119261146517578970232485246878726837916075299577720139317038118148106209530054587167536851896450431919312820852962596852961803405916618990419802746573064712215199008529683745905254572071511</span><br><span class="line"></span><br><span class="line">p = 147074002227133415720722266940278347837547446773140845973255972106195457070706386163214468466076525180963060306764217202402383643362009058035825033180123579226158735283108796018103129215920313383728956742526028603758044612649550810818410129300570667873028005104616597743709185068463293745855509286927802040320</span><br><span class="line">p_new = (p&gt;&gt;200)&lt;&lt;200</span><br><span class="line">pbits = 1024</span><br><span class="line">kbits = 200</span><br><span class="line">pbar = p_new &amp; (2^pbits-2^kbits)</span><br><span class="line">print <span class="string">"upper %d bits (of %d bits) is given"</span> % (pbits-kbits, pbits)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Z\pmod(n))</span><br><span class="line">f = x + pbar</span><br><span class="line">x0 = f.small_roots(X=2^kbits, beta=0.4)[0] <span class="comment"># find root &lt; 2^kbits with factor &gt;= n^0.4</span></span><br><span class="line">print x0 + pbar</span><br></pre></td></tr></table></figure>

<h2 id="Partial-Key-Exposure-Attack-éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»"><a href="#Partial-Key-Exposure-Attack-éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»" class="headerlink" title="Partial Key Exposure Attack(éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»)"></a>Partial Key Exposure Attack(éƒ¨åˆ†ç§é’¥æš´éœ²æ”»å‡»)</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥æ¨¡Nï¼ŒåŠ å¯†æŒ‡æ•°eå’Œdçš„ä½ä½ï¼Œé«˜ä½è¢«éšè—</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">def partial_p(p0, kbits, n):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Z\pmod(n))</span><br><span class="line">    <span class="attr">nbits</span> = n.nbits()</span><br><span class="line"></span><br><span class="line">    <span class="attr">f</span> = <span class="number">2</span>^kbits*x + p0</span><br><span class="line">    <span class="attr">f</span> = f.monic()</span><br><span class="line">    <span class="attr">roots</span> = f.small_roots(<span class="attr">X=2^(nbits//2-kbits),</span> <span class="attr">beta=0.3)</span>  <span class="comment"># find root &lt; 2^(nbits//2-kbits) with factor &gt;= n^0.3</span></span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        <span class="attr">x0</span> = roots[<span class="number">0</span>]</span><br><span class="line">        <span class="attr">p</span> = gcd(<span class="number">2</span>^kbits*x0 + p0, n)</span><br><span class="line">        return ZZ(p)</span><br><span class="line"></span><br><span class="line">def find_p(d0, kbits, e, n):</span><br><span class="line">    <span class="attr">X</span> = var('X')</span><br><span class="line"></span><br><span class="line">    for k <span class="keyword">in</span> xrange(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">        <span class="attr">results</span> = solve_\pmod([e*d0*X - k*X*(n-X+<span class="number">1</span>) + k*<span class="attr">n</span> == X], <span class="number">2</span>^kbits)</span><br><span class="line">        for x <span class="keyword">in</span> results:</span><br><span class="line">            <span class="attr">p0</span> = ZZ(x[<span class="number">0</span>])</span><br><span class="line">            <span class="attr">p</span> = partial_p(p0, kbits, n)</span><br><span class="line">            <span class="keyword">if</span> p:</span><br><span class="line">                return p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="attr">__name__</span> == '__main__':</span><br><span class="line">    <span class="attr">n</span> = <span class="comment">#Nçš„å€¼</span></span><br><span class="line">    <span class="attr">e</span> = <span class="number">3</span></span><br><span class="line">    <span class="attr">d</span> = <span class="comment">#dçš„è¿‘ä¼¼å€¼</span></span><br><span class="line">    <span class="attr">beta</span> = <span class="number">0.5</span></span><br><span class="line">    <span class="attr">epsilon</span> = beta^<span class="number">2</span>/<span class="number">7</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">nbits</span> = n.nbits()</span><br><span class="line">    <span class="attr">kbits</span> = <span class="number">511</span></span><br><span class="line">    <span class="attr">d0</span> = d &amp; (<span class="number">2</span>^kbits-<span class="number">1</span>)</span><br><span class="line">    print <span class="string">"lower %d bits (of %d bits) is given"</span> % (kbits, nbits)</span><br><span class="line"></span><br><span class="line">    <span class="attr">p</span> = find_p(d0, kbits, e, n)</span><br><span class="line">    print <span class="string">"found p: %d"</span> % p</span><br><span class="line">    <span class="attr">q</span> = n//p</span><br><span class="line">    print d</span><br><span class="line">    print inverse_\pmod(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<h2 id="Related-Message-Attack"><a href="#Related-Message-Attack" class="headerlink" title="Related Message Attack"></a>Related Message Attack</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥n,e=3,cä»¥åŠm+paddingçš„å¯†æ–‡xï¼Œæ±‚m        (å°æŒ‡æ•°)</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import gmpy</span><br><span class="line">def getM2(<span class="keyword">a</span>,b,c1,c2,n):</span><br><span class="line">    a3 = pow(<span class="keyword">a</span>,<span class="number">3</span>,n)</span><br><span class="line">    b3 = pow(b,<span class="number">3</span>,n)</span><br><span class="line">    <span class="keyword">first</span> = c1-a3*c2+<span class="number">2</span>*b3</span><br><span class="line">    <span class="keyword">first</span> = <span class="keyword">first</span> % n</span><br><span class="line">    <span class="keyword">second</span> = <span class="number">3</span>*b*(a3*c2-b3)</span><br><span class="line">    <span class="keyword">second</span> = <span class="keyword">second</span> % n</span><br><span class="line">    <span class="keyword">third</span> = <span class="keyword">second</span>*gmpy.invert(<span class="keyword">first</span>,n)</span><br><span class="line">    <span class="keyword">third</span> = <span class="keyword">third</span> % n</span><br><span class="line">    <span class="keyword">fourth</span> = (<span class="keyword">third</span>+b)*gmpy.invert(<span class="keyword">a</span>,n)</span><br><span class="line">    <span class="literal">return</span> <span class="keyword">fourth</span> % n</span><br><span class="line"></span><br><span class="line"><span class="keyword">a</span> = <span class="number">1</span></span><br><span class="line">b = <span class="number">-1</span>		<span class="comment">#b=padding1-padding2ï¼ˆpaddingæ˜¯åŠ å¯†çš„æ˜æ–‡ä¸æ˜æ–‡çš„å·®ï¼‰</span></span><br><span class="line">c1 = <span class="number">0x7175f2614b8d1a27b43f7c3873b3422658af28291ddc88b15f97f499e00cd4c5c4fd980f062376a61e5dd4c15d52d73262d3c066f1e8f46a04af6fead7c3960d2768a0d214bbc3e05d2f6e56aee158071574e55753624a19e094590fc3f9918a2065cd5ff7693e0d34517bc0072e6c9e444e66c4ece88d657f99e44bee48924</span>L</span><br><span class="line">c2 =<span class="number">0xd5f4af36b5391bd731cfa4313466024ab1bc3b455024a5d8b218faba0e956252f01c4d01bd36765035c33d73e5af7f178aeb2606edf86814d74082c64828fa4c1666b69d05fab69dd1ef47b243356290fdb74e001f54edec70681cf52319c73bce9acda4803a9e97597ca21d60072c2d2b516f161bec1f6a91baa2e24c7655b</span>L</span><br><span class="line">padding2 = <span class="number">1</span></span><br><span class="line">n = <span class="number">0xf2e5339236455e2bc1b1bd12e45b9341a3b223ddb02dec11c880fa4aa8835df9e463e4c446292cd5a2fe19b10017856654b6d6c3f3a94a95807712329f7dae2e1e6506094d5d2f9c8a05c35cbf3366330996db9bff930fe566016d5e850e232057d419292ce30df9c135d56ef1bb72c38838d4b127aa577ceb4aba94d4e0d55</span>L</span><br><span class="line">m = getM2(<span class="keyword">a</span>,b,c1,c2,n)-padding2</span><br><span class="line">print hex(m)</span><br></pre></td></tr></table></figure>

<figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Franklin-Reiter attack against RSA.</span></span><br><span class="line"><span class="comment"># If two messages differ only by a known fixed difference between the two messages</span></span><br><span class="line"><span class="comment"># and are RSA encrypted under the same RSA \pmodulus N</span></span><br><span class="line"><span class="comment"># then it is possible to recover both of them.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Inputs are \pmodulus, known difference, ciphertext 1, ciphertext2.</span></span><br><span class="line"><span class="comment"># Ciphertext 1 corresponds to smaller of the two plaintexts. (The one without the fixed difference added to it)</span></span><br><span class="line">def franklinReiter(n,e,r,c1,c2):</span><br><span class="line">    R.&lt;X&gt; = Z\pmod(n)[]</span><br><span class="line">    f1 = X^e - c1</span><br><span class="line">    f2 = (X + r)^e - c2</span><br><span class="line">    <span class="comment"># coefficient 0 = -m, which is what we wanted!</span></span><br><span class="line">    <span class="keyword">return</span> <span class="type">Integer</span>(n-(composite\pmodulusGCD(f1,f2)).coefficients()[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">  <span class="comment"># GCD is not implemented for rings over composite \pmodulus in Sage</span></span><br><span class="line">  <span class="comment"># so we do our own implementation. Its the exact same as standard GCD, but with</span></span><br><span class="line">  <span class="comment"># the polynomials monic representation</span></span><br><span class="line">def composite\pmodulusGCD(a, b):</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> a.monic()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> composite\pmodulusGCD(b, a % b)</span><br><span class="line"></span><br><span class="line">'''def <span class="type">CoppersmithShortPadAttack</span>(e,n,<span class="type">C1</span>,<span class="type">C2</span>,eps=<span class="number">1</span>/<span class="number">30</span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Coppersmith's Shortpad attack!</span></span><br><span class="line"><span class="string">    Figured out from: https://en.wikipedia.org/wiki/Coppersmith's_attack#Coppersmith.E2.80.99s_short-pad_attack</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">import</span> binascii</span><br><span class="line">    P.&lt;x,y&gt; = <span class="type">PolynomialRing</span>(<span class="type">ZZ</span>)</span><br><span class="line">    Z\pmodN = Z\pmod(n)</span><br><span class="line">    g1 = x^e - <span class="type">C1</span></span><br><span class="line">    g2 = (x+y)^e - <span class="type">C2</span></span><br><span class="line">    res = g1.resultant(g2)</span><br><span class="line">    P.&lt;y&gt; = <span class="type">PolynomialRing</span>(Z\pmodN)</span><br><span class="line">    <span class="comment"># Convert Multivariate Polynomial Ring to Univariate Polynomial Ring</span></span><br><span class="line">    rres = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(len(res.coefficients())):</span><br><span class="line">        rres += res.coefficients()[i]*(y^(res.exponents()[i][<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">    diff = rres.small_roots(epsilon=eps)</span><br><span class="line">    recoveredM1 = franklinReiter(n,e,diff[<span class="number">0</span>],<span class="type">C1</span>,<span class="type">C2</span>)</span><br><span class="line">    print(recoveredM1)</span><br><span class="line">    print(<span class="string">"Message is the following hex, but potentially missing some zeroes in the binary from the right end"</span>)</span><br><span class="line">    print(hex(recoveredM1))</span><br><span class="line">    print(<span class="string">"Message is one of:"</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        msg = hex(<span class="type">Integer</span>(recoveredM1*pow(<span class="number">2</span>,i)))</span><br><span class="line">        <span class="keyword">if</span>(len(msg)%<span class="number">2</span> == <span class="number">1</span>):</span><br><span class="line">            msg = '<span class="number">0</span>' + msg</span><br><span class="line">        <span class="keyword">if</span>(msg[:<span class="number">2</span>]=='<span class="number">0</span>x'):</span><br><span class="line">            msg = msg[:<span class="number">2</span>]</span><br><span class="line">        print(binascii.unhexlify(msg))</span><br><span class="line"></span><br><span class="line">def testCoppersmithShortPadAttack(eps=<span class="number">1</span>/<span class="number">25</span>):</span><br><span class="line">    <span class="keyword">from</span> <span class="type">Crypto</span>.<span class="type">PublicKey</span> <span class="keyword">import</span> <span class="type">RSA</span></span><br><span class="line">    <span class="keyword">import</span> random</span><br><span class="line">    <span class="keyword">import</span> math</span><br><span class="line">    <span class="keyword">import</span> binascii</span><br><span class="line">    M = <span class="string">"flag&#123;This_Msg_Is_2_1337&#125;"</span></span><br><span class="line">    M = <span class="built_in">int</span>(binascii.hexlify(M),<span class="number">16</span>)</span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    nBitSize =  <span class="number">8192</span></span><br><span class="line">    key = <span class="type">RSA</span>.generate(nBitSize)</span><br><span class="line">    <span class="comment">#Give a bit of room, otherwhise the epsilon has to be tiny, and small roots will take forever</span></span><br><span class="line">    m = <span class="built_in">int</span>(math.floor(nBitSize/(e*e))) - <span class="number">400</span></span><br><span class="line">    assert (m &lt; nBitSize - len(bin(M)[<span class="number">2</span>:]))</span><br><span class="line">    r1 = random.randint(<span class="number">1</span>,pow(<span class="number">2</span>,m))</span><br><span class="line">    r2 = random.randint(r1,pow(<span class="number">2</span>,m))</span><br><span class="line">    <span class="type">M1</span> = pow(<span class="number">2</span>,m)*M + r1</span><br><span class="line">    <span class="type">M2</span> = pow(<span class="number">2</span>,m)*M + r2</span><br><span class="line">    <span class="type">C1</span> = <span class="type">Integer</span>(pow(<span class="type">M1</span>,e,key.n))</span><br><span class="line">    <span class="type">C2</span> = <span class="type">Integer</span>(pow(<span class="type">M2</span>,e,key.n))</span><br><span class="line">    <span class="type">CoppersmithShortPadAttack</span>(e,key.n,<span class="type">C1</span>,<span class="type">C2</span>,eps)'''</span><br><span class="line"></span><br><span class="line">def testFranklinReiter():</span><br><span class="line">    p = random_prime(<span class="number">2</span>^<span class="number">512</span>)</span><br><span class="line">    q = random_prime(<span class="number">2</span>^<span class="number">512</span>)</span><br><span class="line">    n = p * q <span class="comment"># 1024-bit \pmodulus</span></span><br><span class="line">    e = <span class="number">11</span></span><br><span class="line"></span><br><span class="line">    m = randint(<span class="number">0</span>, n) <span class="comment"># some message we want to recover</span></span><br><span class="line">    r = randint(<span class="number">0</span>, n) <span class="comment"># random padding</span></span><br><span class="line"></span><br><span class="line">    c1 = pow(m + <span class="number">0</span>, e, n)</span><br><span class="line">    c2 = pow(m + r, e, n)</span><br><span class="line">    print(m)</span><br><span class="line">    recoveredM = franklinReiter(n,e,r,c1,c2)</span><br><span class="line">    print(recoveredM)</span><br><span class="line">    assert recoveredM==m</span><br><span class="line">    print(<span class="string">"They are equal!"</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="type">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">testFranklinReiter()</span><br></pre></td></tr></table></figure>

<h2 id="wienerâ€˜s-Attack"><a href="#wienerâ€˜s-Attack" class="headerlink" title="wienerâ€˜s Attack"></a>wienerâ€˜s Attack</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(x,y)</span>:</span>       <span class="comment">#ä½¿ç”¨è¾—è½¬ç›¸å¤„å°†åˆ†æ•° x/y è½¬ä¸ºè¿åˆ†æ•°çš„å½¢å¼</span></span><br><span class="line">    res=[]</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        res.append(x//y)</span><br><span class="line">        x,y=y,x%y</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">continued_fraction</span><span class="params">(sub_res)</span>:</span></span><br><span class="line">    numerator,denominator=<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> sub_res[::<span class="number">-1</span>]:      <span class="comment">#ä»sublistçš„åé¢å¾€å‰å¾ªç¯</span></span><br><span class="line">        denominator,numerator=numerator,i*numerator+denominator</span><br><span class="line">    <span class="keyword">return</span> denominator,numerator   <span class="comment">#å¾—åˆ°æ¸è¿›åˆ†æ•°çš„åˆ†æ¯å’Œåˆ†å­ï¼Œå¹¶è¿”å›</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">#æ±‚è§£æ¯ä¸ªæ¸è¿›åˆ†æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sub_fraction</span><span class="params">(x,y)</span>:</span></span><br><span class="line">    res=transform(x,y)</span><br><span class="line">    res=list(map(continued_fraction,(res[<span class="number">0</span>:i] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(res)))))  <span class="comment">#å°†è¿åˆ†æ•°çš„ç»“æœé€ä¸€æˆªå–ä»¥æ±‚æ¸è¿›åˆ†æ•°</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pq</span><span class="params">(a,b,c)</span>:</span>      <span class="comment">#ç”±p+qå’Œpqçš„å€¼é€šè¿‡ç»´è¾¾å®šç†æ¥æ±‚è§£på’Œq</span></span><br><span class="line">    par=gmpy2.isqrt(b*b<span class="number">-4</span>*a*c)   <span class="comment">#ç”±ä¸Šè¿°å¯å¾—ï¼Œå¼€æ ¹å·ä¸€å®šæ˜¯æ•´æ•°ï¼Œå› ä¸ºæœ‰è§£</span></span><br><span class="line">    x1,x2=(-b+par)//(<span class="number">2</span>*a),(-b-par)//(<span class="number">2</span>*a)</span><br><span class="line">    <span class="keyword">return</span> x1,x2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">wienerAttack</span><span class="params">(e,n)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> (d,k) <span class="keyword">in</span> sub_fraction(e,n):  <span class="comment">#ç”¨ä¸€ä¸ªforå¾ªç¯æ¥æ³¨æ„è¯•æ¢e/nçš„è¿ç»­å‡½æ•°çš„æ¸è¿›åˆ†æ•°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ¸è¿›åˆ†æ•°</span></span><br><span class="line">        <span class="keyword">if</span> k==<span class="number">0</span>:                     <span class="comment">#å¯èƒ½ä¼šå‡ºç°è¿åˆ†æ•°çš„ç¬¬ä¸€ä¸ªä¸º0çš„æƒ…å†µï¼Œæ’é™¤</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e*d<span class="number">-1</span>)%k!=<span class="number">0</span>:             <span class="comment">#ed=1 (\pmod Ï†(n)) å› æ­¤å¦‚æœæ‰¾åˆ°äº†dçš„è¯ï¼Œ(ed-1)ä¼šæ•´é™¤Ï†(n),ä¹Ÿå°±æ˜¯å­˜åœ¨kä½¿å¾—(e*d-1)//k=Ï†(n)</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        phi=(e*d<span class="number">-1</span>)//k               <span class="comment">#è¿™ä¸ªç»“æœå°±æ˜¯ Ï†(n)</span></span><br><span class="line">        px,qy=get_pq(<span class="number">1</span>,n-phi+<span class="number">1</span>,n)</span><br><span class="line">        <span class="keyword">if</span> px*qy==n:</span><br><span class="line">            p,q=abs(int(px)),abs(int(qy))     <span class="comment">#å¯èƒ½ä¼šå¾—åˆ°ä¸¤ä¸ªè´Ÿæ•°ï¼Œè´Ÿè´Ÿå¾—æ­£æœªå°ä¸ä¼šå‡ºç°</span></span><br><span class="line">            d=gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))     <span class="comment">#æ±‚ed=1 (\pmod  Ï†(n))çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯eå…³äº Ï†(n)çš„ä¹˜æ³•é€†å…ƒd</span></span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line">    print(<span class="string">"è¯¥æ–¹æ³•ä¸é€‚ç”¨"</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">e = <span class="number">14058695417015334071588010346586749790539913287499707802938898719199384604316115908373997739604466972535533733290829894940306314501336291780396644520926473</span></span><br><span class="line">n = <span class="number">33608051123287760315508423639768587307044110783252538766412788814888567164438282747809126528707329215122915093543085008547092423658991866313471837522758159</span></span><br><span class="line">d=wienerAttack(e,n)</span><br><span class="line">print(<span class="string">"d="</span>,d)</span><br></pre></td></tr></table></figure>

<h2 id="wienerâ€˜s-Attackå¤±æ•ˆæ—¶"><a href="#wienerâ€˜s-Attackå¤±æ•ˆæ—¶" class="headerlink" title="wienerâ€˜s Attackå¤±æ•ˆæ—¶"></a>wienerâ€˜s Attackå¤±æ•ˆæ—¶</h2><p>åˆ©ç”¨æ¡ä»¶ï¼šå·²çŸ¥ç»™å‡ºn,e,c  ï¼ˆeå¾ˆå¤§ï¼‰  (.sage)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Config</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Setting debug to true will display more informations</span></span><br><span class="line"><span class="string">about the lattice, the bounds, the vectors...</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Setting strict to true will stop the algorithm (and</span></span><br><span class="line"><span class="string">return (-1, -1)) if we don't have a correct </span></span><br><span class="line"><span class="string">upperbound on the determinant. Note that this </span></span><br><span class="line"><span class="string">doesn't necesseraly mean that no solutions </span></span><br><span class="line"><span class="string">will be found since the theoretical upperbound is</span></span><br><span class="line"><span class="string">usualy far away from actual results. That is why</span></span><br><span class="line"><span class="string">you should probably use `strict = False`</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">This is experimental, but has provided remarkable results</span></span><br><span class="line"><span class="string">so far. It tries to reduce the lattice as much as it can</span></span><br><span class="line"><span class="string">while keeping its efficiency. I see no reason not to use</span></span><br><span class="line"><span class="string">this option, but if things don't work, you should try</span></span><br><span class="line"><span class="string">disabling it</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># stop removing if lattice reaches that dimension</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Functions</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display stats on helpful vectors</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helpful_vectors</span><span class="params">(BB, \pmodulus)</span>:</span></span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= \pmodulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> nothelpful, <span class="string">"/"</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">" vectors are not helpful"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">matrix_overview</span><span class="params">(BB, bound)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">'%02d '</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">'0'</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">'X'</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">' '</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">'~'</span></span><br><span class="line">        <span class="keyword">print</span> a</span><br><span class="line"></span><br><span class="line"><span class="comment"># tries to remove unhelpful vectors</span></span><br><span class="line"><span class="comment"># we start at current = n-1 (last vector)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove_unhelpful</span><span class="params">(BB, monomials, bound, current)</span>:</span></span><br><span class="line">    <span class="comment"># end of our recursive function</span></span><br><span class="line">    <span class="keyword">if</span> current == <span class="number">-1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we start by checking from the end</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(current, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        <span class="comment"># if it is unhelpful:</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># let's check if it affects other vectors</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> range(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># if another vector is affected:</span></span><br><span class="line">                <span class="comment"># we increase the count</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:0</span></span><br><span class="line">            <span class="comment"># if no other vectors end up affected</span></span><br><span class="line">            <span class="comment"># we remove it</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"* removing unhelpful vector"</span>, ii</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii<span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:1</span></span><br><span class="line">            <span class="comment"># if just one was affected we check</span></span><br><span class="line">            <span class="comment"># if it is affecting someone else</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> range(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># if it is affecting even one vector</span></span><br><span class="line">                    <span class="comment"># we give up on this one</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># remove both it if no other vector was affected and</span></span><br><span class="line">                <span class="comment"># this helpful vector is not helpful enough</span></span><br><span class="line">                <span class="comment"># compared to our unhelpful one</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> abs(bound - BB[affected_vector_index, affected_vector_index]) &lt; abs(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="keyword">print</span> <span class="string">"* removing unhelpful vectors"</span>, ii, <span class="string">"and"</span>, affected_vector_index</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii<span class="number">-1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line"><span class="string">""" </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1,-1 if `strict=true`, and determinant doesn't bound</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">boneh_durfee</span><span class="params">(pol, \pmodulus, mm, tt, XX, YY)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * d &lt; N^delta</span></span><br><span class="line"><span class="string">    * |x| &lt; e^delta</span></span><br><span class="line"><span class="string">    * |y| &lt; e^0.5</span></span><br><span class="line"><span class="string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u) <span class="comment"># u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> range(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> range(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * \pmodulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts list of monomials</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials():</span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts (selected by Herrman and May)</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> range(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * \pmodulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts list of monomials</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> range(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    nn = len(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> range(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> range(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Prototype to reduce the lattice</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment"># automatically remove</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, \pmodulus^mm, nn<span class="number">-1</span>)</span><br><span class="line">        <span class="comment"># reset dimension</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"failure"</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if vectors are helpful</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, \pmodulus^mm)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># check if determinant is correctly bounded</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = \pmodulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"We do not have det &lt; bound. Solutions might not be found."</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Try with highers m and t."</span></span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"size det(L) - size e^(m*n) = "</span>, floor(diff)</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, \pmodulus^mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"optimizing basis of the lattice via LLL, this can take a long time"</span></span><br><span class="line"></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"LLL is done!"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"looking for independent vectors in the lattice"</span></span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> range(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> range(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line">            <span class="comment"># for i and j, create the two polynomials</span></span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> range(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># resultant</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># are these good polynomials?</span></span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">"found them, using vectors"</span>, pol1_idx, <span class="string">"and"</span>, pol2_idx</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"no independant vectors could be found. This should very rarely happen..."</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> len(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"Your prediction (delta) is too small"</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">example</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># How To Use This Script</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># The problem to solve (edit the following values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the \pmodulus</span></span><br><span class="line">    N = <span class="number">0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L</span></span><br><span class="line">    <span class="comment"># the public exponent</span></span><br><span class="line">    e = <span class="number">0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span></span><br><span class="line">    delta = <span class="number">.18</span> <span class="comment"># this means that d &lt; N^delta</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Lattice (tweak those values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span></span><br><span class="line">    m = <span class="number">4</span> <span class="comment"># size of the lattice (bigger the better/slower)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you need to be a lattice master to tweak these</span></span><br><span class="line">    t = int((<span class="number">1</span><span class="number">-2</span>*delta) * m)  <span class="comment"># optimization from Herrmann and May</span></span><br><span class="line">    X = <span class="number">2</span>*floor(N^delta)  <span class="comment"># this _might_ be too much</span></span><br><span class="line">    Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>))    <span class="comment"># correct if p, q are ~ same size</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Don't touch anything below</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Problem put in equation</span></span><br><span class="line">    P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    A = int((N+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">    pol = <span class="number">1</span> + x * (A + y)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Find the solutions!</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Checking bounds</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== checking values ==="</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* delta:"</span>, delta</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* delta &lt; 0.292"</span>, delta &lt; <span class="number">0.292</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* size of e:"</span>, int(log(e)/log(<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* size of N:"</span>, int(log(N)/log(<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"* m:"</span>, m, <span class="string">", t:"</span>, t</span><br><span class="line"></span><br><span class="line">    <span class="comment"># boneh_durfee</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== running algorithm ==="</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># found a solution?</span></span><br><span class="line">    <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== solution found ==="</span></span><br><span class="line">        <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"x:"</span>, solx</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"y:"</span>, soly</span><br><span class="line"></span><br><span class="line">        d = int(pol(solx, soly) / e)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"private key found:"</span>, d</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"=== no solution was found ==="</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        print(<span class="string">"=== %s seconds ==="</span> % (time.time() - start_time))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    example()</span><br></pre></td></tr></table></figure>

<h2 id="RSA-LSB-Oracle-Attack"><a href="#RSA-LSB-Oracle-Attack" class="headerlink" title="RSA LSB Oracle Attack"></a>RSA LSB Oracle Attack</h2><p>é€‚ç”¨æƒ…å†µï¼šå¯ä»¥é€‰æ‹©å¯†æ–‡å¹¶æ³„éœ²æœ€ä½ä½ã€‚</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åœ¨ä¸€æ¬¡RSAåŠ å¯†ä¸­ï¼Œæ˜æ–‡ä¸ºmï¼Œæ¨¡æ•°ä¸ºnï¼ŒåŠ å¯†æŒ‡æ•°ä¸ºeï¼Œå¯†æ–‡ä¸ºcã€‚æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºc'=((<span class="number">2</span>^e)*c)%n=((<span class="number">2</span>^e)*(m^e))%n=((<span class="number">2</span>*m)^e)%nï¼Œ å› ä¸ºmçš„ä¸¤å€å¯èƒ½å¤§äºnï¼Œæ‰€ä»¥ç»è¿‡è§£å¯†å¾—åˆ°çš„æ˜æ–‡æ˜¯ m'=(<span class="number">2</span>*m)%n ã€‚æˆ‘ä»¬è¿˜èƒ½å¤ŸçŸ¥é“ m' çš„æœ€ä½ä½lsb æ˜¯<span class="number">1</span>è¿˜æ˜¯<span class="number">0</span>ã€‚ å› ä¸ºnæ˜¯å¥‡æ•°ï¼Œè€Œ<span class="number">2</span>*mæ˜¯å¶æ•°ï¼Œæ‰€ä»¥å¦‚æœlsb æ˜¯<span class="number">0</span>ï¼Œè¯´æ˜(<span class="number">2</span>*m)%n æ˜¯å¶æ•°ï¼Œæ²¡æœ‰è¶…è¿‡nï¼Œå³m&lt;n/<span class="number">2.0</span>ï¼Œåä¹‹åˆ™m&gt;n/<span class="number">2.0</span> ã€‚</span><br><span class="line"></span><br><span class="line">ä¸¾ä¸ªä¾‹å­å°±èƒ½æ˜ç™½<span class="number">2</span>%<span class="number">3</span>=<span class="number">2</span> æ˜¯å¶æ•°ï¼Œè€Œ<span class="number">4</span>%<span class="number">3</span>=<span class="number">1</span> æ˜¯å¥‡æ•°ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ„é€ å¯†æ–‡c<span class="string">"=(4^e)*c)%n ä½¿å…¶è§£å¯†åä¸ºm"</span>=(<span class="number">4</span>*m)%n ï¼Œåˆ¤æ–­m<span class="string">" çš„å¥‡å¶æ€§å¯ä»¥çŸ¥é“m å’Œ n/4 çš„å¤§å°å…³ç³»ã€‚æ‰€ä»¥æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªäºŒåˆ†ç®—æ³•ï¼Œå¯ä»¥åœ¨å¯¹æ•°æ—¶é—´å†…å°†mçš„èŒƒå›´é€¼è¿‘åˆ°ä¸€ä¸ªè¶³å¤Ÿç‹­çª„çš„ç©ºé—´ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æ›´å¤šä¿¡æ¯å¯å‚è€ƒï¼šRSA Least-Significant-Bit Oracle Attack å’Œ RSA least significant bit oracle attack ã€‚</span></span><br></pre></td></tr></table></figure>

<p>exp:ï¼ˆå¾…éªŒè¯ï¼‰</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">def brute_flag(encrypted_flag, n, e):</span><br><span class="line"></span><br><span class="line">    <span class="attr">flag_count</span> = <span class="attr">n_count</span> = <span class="number">1</span></span><br><span class="line">    <span class="attr">flag_lower_bound</span> = <span class="number">0</span></span><br><span class="line">    <span class="attr">flag_upper_bound</span> = n</span><br><span class="line">    <span class="attr">ciphertext</span> = encrypted_flag</span><br><span class="line">    <span class="attr">mult</span> = <span class="number">1</span></span><br><span class="line">    while flag_upper_bound &gt; flag_lower_bound + <span class="number">1</span>:</span><br><span class="line">        sh.recvuntil(<span class="string">"input your option:"</span>)</span><br><span class="line">        sh.sendline(<span class="string">"D"</span>)</span><br><span class="line">        <span class="attr">ciphertext</span> = (ciphertext * pow(<span class="number">2</span>, e, n)) % n</span><br><span class="line">        flag_count *= <span class="number">2</span></span><br><span class="line">        <span class="attr">n_count</span> = n_count * <span class="number">2</span> - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        print(<span class="string">"bit = %d"</span> % mult)</span><br><span class="line">        mult += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        sh.recvuntil(<span class="string">"Your encrypted message:"</span>)</span><br><span class="line">        sh.sendline(str(ciphertext))</span><br><span class="line"></span><br><span class="line">        <span class="attr">data=sh.recvline()[:-1]</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="attr">data=='The</span> plain of your decrypted message is even!'):</span><br><span class="line">            <span class="attr">flag_upper_bound</span> = n * n_count / flag_count</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="attr">flag_lower_bound</span> = n * n_count / flag_count</span><br><span class="line">            n_count += <span class="number">1</span></span><br><span class="line">	return flag_upper_bound</span><br><span class="line">def main():</span><br><span class="line">    <span class="attr">n</span> = <span class="number">120357855677795403326899325832599223460081551820351966764960386843755808156627131345464795713923271678835256422889567749230248389850643801263972231981347496433824450373318688699355320061986161918732508402417281836789242987168090513784426195519707785324458125521673657185406738054328228404365636320530340758959</span></span><br><span class="line">    <span class="attr">ct</span> = <span class="number">2201077887205099886799419505257984908140690335465327695978150425602737431754769971309809434546937184700758848191008699273369652758836177602723960420562062515168299835193154932988833308912059796574355781073624762083196012981428684386588839182461902362533633141657081892129830969230482783192049720588548332813</span></span><br><span class="line">    print(long_to_bytes(brute_flag(ct, n, <span class="number">65537</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<h2 id="é€‰æ‹©å¯†æ–‡æ”»å‡»"><a href="#é€‰æ‹©å¯†æ–‡æ”»å‡»" class="headerlink" title="é€‰æ‹©å¯†æ–‡æ”»å‡»"></a>é€‰æ‹©å¯†æ–‡æ”»å‡»</h2><p>é€‚ç”¨æƒ…å†µï¼šå¯ä»¥æ„é€ ä»»æ„å¯†æ–‡å¹¶è·å¾—å¯¹åº”æ˜æ–‡ã€‚</p>
<p>è¿™ä¸ªå¥½ç†è§£ï¼Œåœ¨ä¸€ä¸ªRSAåŠ å¯†è¿‡ç¨‹ä¸­ï¼Œæ˜æ–‡ä¸ºmï¼Œå¯†æ–‡ä¸ºcï¼Œæ¨¡æ•°ä¸ºnï¼ŒåŠ å¯†æŒ‡æ•°ä¸ºeï¼Œé€‰å–xä»¥æ»¡è¶³gcd(x,n)==1 ä»è€Œä½¿xæ¨¡nçš„é€†å­˜åœ¨ï¼Œæ„é€ å¯†æ–‡câ€™=c*(x^e^) ä½¿è§£å¯†åæ˜æ–‡ä¸ºmâ€™=(m*x)%nï¼Œåˆ™m=mâ€™*x^-1^(\pmod n) ã€‚å¯å‚çœ‹æ¨¡æ„ä¹‰ä¸‹çš„è¿ç®—æ³•åˆ™éƒ¨åˆ†ã€‚(x^-1^=gmpy2.invert(x,n))</p>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 643713081@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">èµ</a>
</p>


<div class="article_copyright">
    <p><span class="copy-title">æ–‡ç« æ ‡é¢˜:</span>å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSA</p>
    <p><span class="copy-title">æ–‡ç« å­—æ•°:</span><span class="post-count">5.6k</span></p>
    <p><span class="copy-title">æœ¬æ–‡ä½œè€…:</span><a  title="Van1sh">Van1sh</a></p>
    <p><span class="copy-title">å‘å¸ƒæ—¶é—´:</span>2020-05-20, 20:40:00</p>
    <p><span class="copy-title">æœ€åæ›´æ–°:</span>2020-05-20, 22:17:18</p>
    <span class="copy-title">åŸå§‹é“¾æ¥:</span><a class="post-url" href="/2020/05/20/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹RSA/" title="å¯†ç å­¦å­¦ä¹ ç¬”è®° ä¹‹ RSA">http://jayxv.github.io/2020/05/20/å¯†ç å­¦å­¦ä¹ ç¬”è®°ä¹‹RSA/</a>
    <p>
        <span class="copy-title">ç‰ˆæƒå£°æ˜:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚
    </p>
</div>





    
        <!-- MathJaxé…ç½®ï¼Œå¯é€šè¿‡å•ç¾å…ƒç¬¦å·ä¹¦å†™è¡Œå†…å…¬å¼ç­‰ -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- ç»™MathJaxå…ƒç´ æ·»åŠ has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- é€šè¿‡è¿æ¥CDNåŠ è½½MathJaxçš„jsä»£ç  -->
<script type="text/javascript" async
        src="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<input type="hidden" id="MathJax-js"
        value="//cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</input>
    




    </div>
    <div class="copyright">
        <p class="footer-entry">Â©2020 Van1sh</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">ç›®å½•</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" ></a>

    </div>
</div>
<div class="acParent"></div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">Ã—</a>
    <div class="shang_tit">
        <p>å–œæ¬¢å°±ç‚¹èµ,ç–¼çˆ±å°±æ‰“èµ</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="æ‰«ç æ”¯æŒ">
            <img src="/img/weixin.jpg" class="weixin" title="æ‰«ç æ”¯æŒ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">æ”¯ä»˜å®</label></span><span><label><input type="radio" name="pay" value="weixin">å¾®ä¿¡</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*ä½œè€…ã€æ ‡ç­¾çš„è‡ªåŠ¨è¡¥å…¨*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#Write Up','#Sage','#docker','#Paillier','#ECC','#Lattice','#Dsa','#LCG','#Rc4','#SM4','#Rsa','#python','#æ“ä½œæ¨¡å¼','#Abstract algebra','#private','#Nmap','#Linux','#book',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
